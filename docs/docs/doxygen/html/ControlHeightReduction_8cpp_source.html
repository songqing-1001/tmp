<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Instrumentation/ControlHeightReduction.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_f844fca3b2393802daa002d01dc8623e.html">Instrumentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ControlHeightReduction.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ControlHeightReduction_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-- ControlHeightReduction.cpp - Control Height Reduction -------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This pass merges conditional blocks of code and reduces the number of</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// conditional branches in the hot paths based on profiles.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ControlHeightReduction_8h.html">llvm/Transforms/Instrumentation/ControlHeightReduction.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseSet_8h.html">llvm/ADT/DenseSet.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringSet_8h.html">llvm/ADT/StringSet.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BlockFrequencyInfo_8h.html">llvm/Analysis/BlockFrequencyInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalsModRef_8h.html">llvm/Analysis/GlobalsModRef.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProfileSummaryInfo_8h.html">llvm/Analysis/ProfileSummaryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RegionInfo_8h.html">llvm/Analysis/RegionInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RegionIterator_8h.html">llvm/Analysis/RegionIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2CFG_8h.html">llvm/IR/CFG.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MDBuilder_8h.html">llvm/IR/MDBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PassManager_8h.html">llvm/IR/PassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProfDataUtils_8h.html">llvm/IR/ProfDataUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BranchProbability_8h.html">llvm/Support/BranchProbability.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemoryBuffer_8h.html">llvm/Support/MemoryBuffer.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_8h.html">llvm/Transforms/Utils.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Cloning_8h.html">llvm/Transforms/Utils/Cloning.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueMapper_8h.html">llvm/Transforms/Utils/ValueMapper.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   48</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;chr&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">   50</a></span>&#160;<span class="preprocessor">#define CHR_DEBUG(X) LLVM_DEBUG(X)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#a14106e69b117dcbd5a7573af62d1cbeb">DisableCHR</a>(<span class="stringliteral">&quot;disable-chr&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable CHR for all functions&quot;</span>));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#a99011b332a9be6ee52906fa398be35e2">ForceCHR</a>(<span class="stringliteral">&quot;force-chr&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                              <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Apply CHR for all functions&quot;</span>));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;double&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#a2881475f3f9e1db0f814ff65d7c44e8e">CHRBiasThreshold</a>(</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="stringliteral">&quot;chr-bias-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0.99), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;CHR considers a branch bias greater than this ratio as biased&quot;</span>));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#a81882243935b8e8dbd427c4cfcd5dabc">CHRMergeThreshold</a>(</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="stringliteral">&quot;chr-merge-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(2), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;CHR merges a group of N branches/selects where N &gt;= this value&quot;</span>));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;std::string&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#ace1af9c851fd3ff6b2354fdd1967c303">CHRModuleList</a>(</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="stringliteral">&quot;chr-module-list&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="stringliteral">&quot;&quot;</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Specify file to retrieve the list of modules to apply CHR to&quot;</span>));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;std::string&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#aa47a194a72a51014b9c0aa614683ee0d">CHRFunctionList</a>(</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="stringliteral">&quot;chr-function-list&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="stringliteral">&quot;&quot;</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Specify file to retrieve the list of functions to apply CHR to&quot;</span>));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#ad7c6ec0efac7bf1cda1e2f0db908ccd4">CHRDupThreshsold</a>(</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="stringliteral">&quot;chr-dup-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(3), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Max number of duplications by CHR for a region&quot;</span>));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a5defa49c396dd67771e7f595976e27c7">   78</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1StringSet.html">StringSet&lt;&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#a5defa49c396dd67771e7f595976e27c7">CHRModules</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a282e11b24a3ab565115e0ed4b68820b7">   79</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1StringSet.html">StringSet&lt;&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#a282e11b24a3ab565115e0ed4b68820b7">CHRFunctions</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#aff85944087fc349e227e8b737179cb3e">   81</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="ControlHeightReduction_8cpp.html#aff85944087fc349e227e8b737179cb3e">parseCHRFilterFiles</a>() {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#ace1af9c851fd3ff6b2354fdd1967c303">CHRModuleList</a>.empty()) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">auto</span> FileOrErr = <a class="code" href="classllvm_1_1MemoryBuffer.html#aa98611beefe78f907beeee7305cc8174">MemoryBuffer::getFile</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ace1af9c851fd3ff6b2354fdd1967c303">CHRModuleList</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (!FileOrErr) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; <span class="stringliteral">&quot;Error: Couldn&#39;t read the chr-module-list file &quot;</span> &lt;&lt; <a class="code" href="ControlHeightReduction_8cpp.html#ace1af9c851fd3ff6b2354fdd1967c303">CHRModuleList</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="lib_2Target_2X86_2README_8txt.html#a809aa08f1d799a5ed298e68bd3fac0c7">std::exit</a>(1);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Buf = FileOrErr-&gt;get()-&gt;getBuffer();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;StringRef, 0&gt;</a> Lines;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    Buf.<a class="code" href="classllvm_1_1StringRef.html#a6414735714bdbd5c8790f32a0fe99bd2">split</a>(Lines, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Line : Lines) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      Line = Line.trim();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">if</span> (!Line.empty())</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a5defa49c396dd67771e7f595976e27c7">CHRModules</a>.<a class="code" href="classllvm_1_1StringSet.html#a31714563344c51d7d917d1206efa48cf">insert</a>(Line);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#aa47a194a72a51014b9c0aa614683ee0d">CHRFunctionList</a>.empty()) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">auto</span> FileOrErr = <a class="code" href="classllvm_1_1MemoryBuffer.html#aa98611beefe78f907beeee7305cc8174">MemoryBuffer::getFile</a>(<a class="code" href="ControlHeightReduction_8cpp.html#aa47a194a72a51014b9c0aa614683ee0d">CHRFunctionList</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (!FileOrErr) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; <span class="stringliteral">&quot;Error: Couldn&#39;t read the chr-function-list file &quot;</span> &lt;&lt; <a class="code" href="ControlHeightReduction_8cpp.html#aa47a194a72a51014b9c0aa614683ee0d">CHRFunctionList</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="lib_2Target_2X86_2README_8txt.html#a809aa08f1d799a5ed298e68bd3fac0c7">std::exit</a>(1);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Buf = FileOrErr-&gt;get()-&gt;getBuffer();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;StringRef, 0&gt;</a> Lines;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    Buf.<a class="code" href="classllvm_1_1StringRef.html#a6414735714bdbd5c8790f32a0fe99bd2">split</a>(Lines, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Line : Lines) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      Line = Line.trim();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> (!Line.empty())</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a282e11b24a3ab565115e0ed4b68820b7">CHRFunctions</a>.<a class="code" href="classllvm_1_1StringSet.html#a31714563344c51d7d917d1206efa48cf">insert</a>(Line);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keyword">struct </span>CHRStats {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  CHRStats() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;CHRStats: NumBranches &quot;</span> &lt;&lt; NumBranches</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;       &lt;&lt; <span class="stringliteral">&quot; NumBranchesDelta &quot;</span> &lt;&lt; NumBranchesDelta</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;       &lt;&lt; <span class="stringliteral">&quot; WeightedNumBranchesDelta &quot;</span> &lt;&lt; WeightedNumBranchesDelta;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// The original number of conditional branches / selects</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NumBranches = 0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// The decrease of the number of conditional branches / selects in the hot</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// paths due to CHR.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NumBranchesDelta = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// NumBranchesDelta weighted by the profile count at the scope entry.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> WeightedNumBranchesDelta = 0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;};</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">// RegInfo - some properties of a Region.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">struct </span>RegInfo {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  RegInfo() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  RegInfo(<a class="code" href="classllvm_1_1Region.html">Region</a> *RegionIn) : <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>(RegionIn) {}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">bool</span> HasBranch = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 8&gt;</a> Selects;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;};</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">typedef</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Region *, DenseSet&lt;Instruction *&gt;</a>&gt; HoistStopMapTy;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// CHRScope - a sequence of regions to CHR together. It corresponds to a</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">// sequence of conditional blocks. It can have subscopes which correspond to</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// nested conditional blocks. Nested CHRScopes form a tree.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keyword">class </span>CHRScope {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  CHRScope(RegInfo RI) : BranchInsertPoint(nullptr) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.R &amp;&amp; <span class="stringliteral">&quot;Null RegionIn&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    RegInfos.push_back(RI);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a> *getParentRegion() {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RegInfos.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Empty CHRScope&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *Parent = RegInfos[0].R-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a001c71505d9c3f8d39aed9227a0a6e74">getParent</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Parent &amp;&amp; <span class="stringliteral">&quot;Unexpected to call this on the top-level region&quot;</span>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">return</span> Parent;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *getEntryBlock() {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RegInfos.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Empty CHRScope&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> RegInfos.front().R-&gt;getEntry();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *getExitBlock() {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RegInfos.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Empty CHRScope&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> RegInfos.back().R-&gt;getExit();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">bool</span> appendable(CHRScope *Next) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// The next scope is appendable only if this scope is directly connected to</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// it (which implies it post-dominates this scope) and this scope dominates</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// it (no edge to the next scope outside this scope).</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NextEntry = Next-&gt;getEntryBlock();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (getExitBlock() != NextEntry)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="comment">// Not directly connected.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *LastRegion = RegInfos.back().R;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(NextEntry))</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">if</span> (!LastRegion-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a75479f44e7157d1a8592231addb67c9c">contains</a>(Pred))</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// There&#39;s an edge going into the entry of the next scope from outside</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">// of this scope.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm_1_1sys_1_1path.html#acb80894344c78dacf8d5ff8c23be697d">append</a>(CHRScope *Next) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RegInfos.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Empty CHRScope&quot;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Next-&gt;RegInfos.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Empty CHRScope&quot;</span>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(getParentRegion() == Next-&gt;getParentRegion() &amp;&amp;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;           <span class="stringliteral">&quot;Must be siblings&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(getExitBlock() == Next-&gt;getEntryBlock() &amp;&amp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;           <span class="stringliteral">&quot;Must be adjacent&quot;</span>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    RegInfos.append(Next-&gt;RegInfos.begin(), Next-&gt;RegInfos.end());</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    Subs.append(Next-&gt;Subs.begin(), Next-&gt;Subs.end());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">void</span> addSub(CHRScope *SubIn) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">bool</span> IsChild = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">for</span> (RegInfo &amp;RI : RegInfos)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (RI.R == SubIn-&gt;getParentRegion()) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        IsChild = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsChild &amp;&amp; <span class="stringliteral">&quot;Must be a child&quot;</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    Subs.push_back(SubIn);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// Split this scope at the boundary region into two, which will belong to the</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// tail and returns the tail.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  CHRScope *<a class="code" href="DataLayout_8cpp.html#a974f64e92d8749b49b9179a0bf255b93">split</a>(<a class="code" href="classllvm_1_1Region.html">Region</a> *Boundary) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Boundary &amp;&amp; <span class="stringliteral">&quot;Boundary null&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RegInfos.begin()-&gt;R != Boundary &amp;&amp;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;           <span class="stringliteral">&quot;Can&#39;t be split at beginning&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">auto</span> BoundaryIt = <a class="code" href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">llvm::find_if</a>(</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        RegInfos, [&amp;Boundary](<span class="keyword">const</span> RegInfo &amp;RI) { <span class="keywordflow">return</span> Boundary == RI.R; });</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span> (BoundaryIt == RegInfos.end())</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;RegInfo&gt;</a> TailRegInfos(BoundaryIt, RegInfos.end());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Region *&gt;</a> TailRegionSet;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> RegInfo &amp;RI : TailRegInfos)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      TailRegionSet.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(RI.R);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">auto</span> TailIt =</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        std::stable_partition(Subs.begin(), Subs.end(), [&amp;](CHRScope *Sub) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          assert(Sub &amp;&amp; <span class="stringliteral">&quot;null Sub&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          Region *Parent = Sub-&gt;getParentRegion();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          if (TailRegionSet.count(Parent))</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            return false;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          assert(llvm::any_of(</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                     RegInfos,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                     [&amp;Parent](const RegInfo &amp;RI) { return Parent == RI.R; }) &amp;&amp;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                 <span class="stringliteral">&quot;Must be in head&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        });</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;CHRScope *&gt;</a> TailSubs(TailIt, Subs.end());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(HoistStopMap.empty() &amp;&amp; <span class="stringliteral">&quot;MapHoistStops must be empty&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> = <span class="keyword">new</span> CHRScope(TailRegInfos, TailSubs);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    RegInfos.erase(BoundaryIt, RegInfos.end());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    Subs.erase(TailIt, Subs.end());</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a1112b818386ec01ddfdf3a5d0024eb17">contains</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Parent = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> RegInfo &amp;RI : RegInfos)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">if</span> (RI.R-&gt;contains(Parent))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;RegInfo, 8&gt;</a> RegInfos; <span class="comment">// Regions that belong to this scope</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> Subs;  <span class="comment">// Subscopes.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// The instruction at which to insert the CHR conditional branch (and hoist</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// the dependent condition values).</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BranchInsertPoint;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// True-biased and false-biased regions (conditional blocks),</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// respectively. Used only for the outermost scope and includes regions in</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// subscopes. The rest are unbiased.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Region *&gt;</a> TrueBiasedRegions;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Region *&gt;</a> FalseBiasedRegions;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// Among the biased regions, the regions that get CHRed.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;RegInfo, 8&gt;</a> CHRRegions;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// True-biased and false-biased selects, respectively. Used only for the</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// outermost scope and includes ones in subscopes.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;SelectInst *&gt;</a> TrueBiasedSelects;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;SelectInst *&gt;</a> FalseBiasedSelects;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// Map from one of the above regions to the instructions to stop</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// hoisting instructions at through use-def chains.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  HoistStopMapTy HoistStopMap;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   CHRScope(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;RegInfo&gt;</a> RegInfosIn, <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;CHRScope *&gt;</a> SubsIn)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;       : RegInfos(RegInfosIn.<a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>(), RegInfosIn.<a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>()),</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;         Subs(SubsIn.<a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>(), SubsIn.<a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>()), BranchInsertPoint(nullptr) {}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;};</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">class </span>CHR {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  CHR(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Fin, <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;BFIin, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DTin,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> &amp;PSIin, <a class="code" href="classllvm_1_1RegionInfo.html">RegionInfo</a> &amp;RIin,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;OREin)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(Fin), <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>(BFIin), DT(DTin), PSI(PSIin), RI(RIin), ORE(OREin) {}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  ~CHR() {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">for</span> (CHRScope *Scope : Scopes) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keyword">delete</span> <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">run</a>();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// See the comments in CHR::run() for the high level flow of the algorithm and</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// what the following functions do.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">void</span> findScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.getTopLevelRegion();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> (CHRScope *Scope = findScopes(R, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, Output)) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      Output.push_back(Scope);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  CHRScope *findScopes(<a class="code" href="classllvm_1_1Region.html">Region</a> *R, <a class="code" href="classllvm_1_1Region.html">Region</a> *NextRegion, <a class="code" href="classllvm_1_1Region.html">Region</a> *ParentRegion,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Scopes);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  CHRScope *findScope(<a class="code" href="classllvm_1_1Region.html">Region</a> *R);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordtype">void</span> checkScopeHoistable(CHRScope *Scope);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">void</span> splitScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                   <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> splitScope(CHRScope *Scope,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                        CHRScope *Outer,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                        <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> *OuterConditionValues,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OuterInsertPoint,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                        <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                        <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> &amp;Unhoistables);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">void</span> classifyBiasedScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Scopes);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">void</span> classifyBiasedScopes(CHRScope *Scope, CHRScope *OutermostScope);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">void</span> filterScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordtype">void</span> setCHRRegions(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                     <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">void</span> setCHRRegions(CHRScope *Scope, CHRScope *OutermostScope);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">void</span> sortScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                  <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">void</span> transformScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;CHRScopes);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordtype">void</span> transformScopes(CHRScope *Scope, <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> &amp;TrivialPHIs);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">void</span> cloneScopeBlocks(CHRScope *Scope,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                        <a class="code" href="classllvm_1_1Region.html">Region</a> *LastRegion,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                        <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> &amp;VMap);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *createMergedBranch(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                 <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EntryBlock,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                 <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewEntryBlock,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                 <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> &amp;VMap);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">void</span> fixupBranchesAndSelects(CHRScope *Scope, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock,</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                               <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *MergedBR, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">void</span> fixupBranch(<a class="code" href="classllvm_1_1Region.html">Region</a> *R, CHRScope *Scope, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;IRB,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                   <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;MergedCondition, <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> &amp;CHRBranchBias);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">void</span> fixupSelect(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, CHRScope *Scope, <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;IRB,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                   <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;MergedCondition, <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> &amp;CHRBranchBias);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">void</span> addToMergedCondition(<span class="keywordtype">bool</span> IsTrueBiased, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                            <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BranchOrSelect, CHRScope *Scope,</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                            <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;IRB, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;MergedCondition);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">unsigned</span> getRegionDuplicationCount(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Region.html">Region</a> *R) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">unsigned</span> Count = 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// Find out how many times region R is cloned. Note that if the parent</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// of R is cloned, R is also cloned, but R&#39;s clone count is not updated</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// from the clone of the parent. We need to accumlate all the counts</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// from the ancestors to get the clone count.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">while</span> (R) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      Count += DuplicationCount[<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getParent();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">return</span> Count;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> &amp;PSI;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="classllvm_1_1RegionInfo.html">RegionInfo</a> &amp;RI;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  CHRStats <a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">// All the true-biased regions in the function</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Region *&gt;</a> TrueBiasedRegionsGlobal;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// All the false-biased regions in the function</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Region *&gt;</a> FalseBiasedRegionsGlobal;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// All the true-biased selects in the function</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;SelectInst *&gt;</a> TrueBiasedSelectsGlobal;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// All the false-biased selects in the function</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;SelectInst *&gt;</a> FalseBiasedSelectsGlobal;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// A map from biased regions to their branch bias</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Region *, BranchProbability&gt;</a> BranchBiasMap;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// A map from biased selects to their branch bias</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;SelectInst *, BranchProbability&gt;</a> SelectBiasMap;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// All the scopes.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;CHRScope *&gt;</a> <a class="code" href="namespacellvm_1_1logicalview.html#a90c9f20715929cbe06c523bf8546c38ba48b26d57c14af0500090800c2cdd0d58">Scopes</a>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// This maps records how many times this region is cloned.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Region *, unsigned&gt;</a> DuplicationCount;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;};</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span></div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a900b2c8e3cfb38b08d34d78386308dcb">  402</a></span>&#160;<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a> &amp;<a class="code" href="ControlHeightReduction_8cpp.html#a900b2c8e3cfb38b08d34d78386308dcb">operator&lt;&lt;</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                              <span class="keyword">const</span> CHRStats &amp;<a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>.print(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span></div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a66d4aa110a9d8ddf12de1629eb517712">  409</a></span>&#160;<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="ControlHeightReduction_8cpp.html#a900b2c8e3cfb38b08d34d78386308dcb">operator&lt;&lt;</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <span class="keyword">const</span> CHRScope &amp;<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>.print(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a7cf6fe605431375e61c307bb1ca5cf41">  414</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#a7cf6fe605431375e61c307bb1ca5cf41">shouldApply</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> &amp;PSI) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ControlHeightReduction_8cpp.html#a14106e69b117dcbd5a7573af62d1cbeb">DisableCHR</a>)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ControlHeightReduction_8cpp.html#a99011b332a9be6ee52906fa398be35e2">ForceCHR</a>)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#ace1af9c851fd3ff6b2354fdd1967c303">CHRModuleList</a>.empty() || !<a class="code" href="ControlHeightReduction_8cpp.html#aa47a194a72a51014b9c0aa614683ee0d">CHRFunctionList</a>.empty()) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ControlHeightReduction_8cpp.html#a5defa49c396dd67771e7f595976e27c7">CHRModules</a>.<a class="code" href="classllvm_1_1StringMap.html#a9846bb2bc5672e7627011260772b8d09">count</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getName()))</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ControlHeightReduction_8cpp.html#a282e11b24a3ab565115e0ed4b68820b7">CHRFunctions</a>.<a class="code" href="classllvm_1_1StringMap.html#a9846bb2bc5672e7627011260772b8d09">count</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName());</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">return</span> PSI.<a class="code" href="classllvm_1_1ProfileSummaryInfo.html#a030e1f2821a154dec1b16c80a7154833">isFunctionEntryHot</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a8acf25125313b0e6333bb7fa3f4404f6">  430</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a> <a class="code" href="ControlHeightReduction_8cpp.html#a8acf25125313b0e6333bb7fa3f4404f6">dumpIR</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *Label,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                         CHRStats *<a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> FuncName = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="structModuleName.html">ModuleName</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getName();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  (void)(FuncName); <span class="comment">// Unused in release build.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  (void)(<a class="code" href="structModuleName.html">ModuleName</a>); <span class="comment">// Unused in release build.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CHR IR dump &quot;</span> &lt;&lt; Label &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="structModuleName.html">ModuleName</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            &lt;&lt; FuncName);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *<a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.dump());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">CHRScope::print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RegInfos.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Empty CHRScope&quot;</span>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;CHRScope[&quot;</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; RegInfos.size() &lt;&lt; <span class="stringliteral">&quot;, Regions[&quot;</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> RegInfo &amp;RI : RegInfos) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; RI.R-&gt;getNameStr();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot; B&quot;</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (RI.Selects.size() &gt; 0)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot; S&quot;</span> &lt;&lt; RI.Selects.size();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">if</span> (RegInfos[0].<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getParent()) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;], Parent &quot;</span> &lt;&lt; RegInfos[0].R-&gt;getParent()-&gt;getNameStr();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// top level region</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;, Subs[&quot;</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">for</span> (CHRScope *Sub : Subs) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; *Sub &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;]]&quot;</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">// Return true if the given instruction type can be hoisted by CHR.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#aa9216799cee3b3000ce6714aac1c1c7e">  470</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#aa9216799cee3b3000ce6714aac1c1c7e">isHoistableInstructionType</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">return</span> isa&lt;BinaryOperator&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;CastInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) ||</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      isa&lt;GetElementPtrInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;CmpInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) ||</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      isa&lt;InsertElementInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;ExtractElementInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) ||</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      isa&lt;ShuffleVectorInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;ExtractValueInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) ||</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      isa&lt;InsertValueInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">// Return true if the given instruction can be hoisted by CHR.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a3f3c0ac0dc88d578aba34d48efdd3746">  479</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#a3f3c0ac0dc88d578aba34d48efdd3746">isHoistable</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#aa9216799cee3b3000ce6714aac1c1c7e">isHoistableInstructionType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#abe76d72cda6b2b4562c72accb510040b">isSafeToSpeculativelyExecute</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, &amp;DT);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">// Recursively traverse the use-def chains of the given value and return a set</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">// of the unhoistable base values defined within the scope (excluding the</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">// first-region entry block) or the (hoistable or unhoistable) base values that</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">// are defined outside (including the first-region entry block) of the</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">// scope. The returned set doesn&#39;t include constants.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> std::set&lt;Value *&gt; &amp;</div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a41889aad2ef3409b5ab2a9ad06d09fa8">  491</a></span>&#160;<a class="code" href="ControlHeightReduction_8cpp.html#a41889aad2ef3409b5ab2a9ad06d09fa8">getBaseValues</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;              <a class="code" href="classllvm_1_1DenseMap.html">DenseMap</a>&lt;<a class="code" href="classllvm_1_1Value.html">Value</a> *, std::set&lt;Value *&gt;&gt; &amp;Visited) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keyword">auto</span> It = Visited.find(V);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">if</span> (It != Visited.end()) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> It-&gt;second;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  std::set&lt;Value *&gt; Result;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V)) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// We don&#39;t stop at a block that&#39;s not in the Scope because we would miss</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// some instructions that are based on the same base values if we stop</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// there.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#a3f3c0ac0dc88d578aba34d48efdd3746">isHoistable</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, DT)) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      Result.insert(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">return</span> Visited.insert(std::make_pair(V, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(Result))).first-&gt;second;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// I is hoistable above the Scope.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;operands()) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keyword">const</span> std::set&lt;Value *&gt; &amp;OpResult = <a class="code" href="ControlHeightReduction_8cpp.html#a41889aad2ef3409b5ab2a9ad06d09fa8">getBaseValues</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, DT, Visited);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      Result.insert(OpResult.begin(), OpResult.end());</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">return</span> Visited.insert(std::make_pair(V, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(Result))).first-&gt;second;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Argument&gt;(V)) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    Result.insert(V);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// We don&#39;t include others like constants because those won&#39;t lead to any</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// chance of folding of conditions (eg two bit checks merged into one check)</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// after CHR.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">return</span> Visited.insert(std::make_pair(V, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(Result))).first-&gt;second;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">// Return true if V is already hoisted or can be hoisted (along with its</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">// operands) above the insert point. When it returns true and HoistStops is</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">// non-null, the instructions to stop hoisting at through the use-def chains are</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">// inserted into HoistStops.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">  527</a></span>&#160;<a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPoint, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> &amp;Unhoistables,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> *HoistStops,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> &amp;Visited) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InsertPoint &amp;&amp; <span class="stringliteral">&quot;Null InsertPoint&quot;</span>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V)) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keyword">auto</span> It = Visited.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span> (It != Visited.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">return</span> It-&gt;second;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">getNode</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()) &amp;&amp; <span class="stringliteral">&quot;DT must contain I&#39;s parent block&quot;</span>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">getNode</a>(InsertPoint-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) &amp;&amp; <span class="stringliteral">&quot;DT must contain Destination&quot;</span>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> (Unhoistables.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="comment">// Don&#39;t hoist if they are not to be hoisted.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      Visited[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, InsertPoint)) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="comment">// We are already above the insert point. Stop here.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">if</span> (HoistStops)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        HoistStops-&gt;<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      Visited[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// We aren&#39;t not above the insert point, check if we can hoist it above the</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// insert point.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ControlHeightReduction_8cpp.html#a3f3c0ac0dc88d578aba34d48efdd3746">isHoistable</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, DT)) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="comment">// Check operands first.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> OpsHoistStops;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordtype">bool</span> AllOpsHoisted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;operands()) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, InsertPoint, DT, Unhoistables, &amp;OpsHoistStops,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                             Visited)) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          AllOpsHoisted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">if</span> (AllOpsHoisted) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;checkHoistValue &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">if</span> (HoistStops)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          HoistStops-&gt;<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(OpsHoistStops.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad7dc7318244359268414719e0959346e">begin</a>(), OpsHoistStops.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a8cd802dcaed35e1f28ea3cbe4af4eff5">end</a>());</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        Visited[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    Visited[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// Non-instructions are considered hoistable.</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;}</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">// Constructs the true and false branch probabilities if the the instruction has</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">// valid branch weights. Returns true when this was successful, false otherwise.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#afb9349865f6045be3029d7d171f23f4e">  581</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#afb9349865f6045be3029d7d171f23f4e">extractBranchProbabilities</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                       <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> &amp;TrueProb,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                       <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> &amp;FalseProb) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TrueWeight;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> FalseWeight;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#ac19cbbc4935a23e1d44f65e1eaba6b1d">extractBranchWeights</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, TrueWeight, FalseWeight))</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SumWeight = TrueWeight + FalseWeight;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SumWeight &gt;= TrueWeight &amp;&amp; SumWeight &gt;= FalseWeight &amp;&amp;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;         <span class="stringliteral">&quot;Overflow calculating branch probabilities.&quot;</span>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// Guard against 0-to-0 branch weights to avoid a division-by-zero crash.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">if</span> (SumWeight == 0)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  TrueProb = BranchProbability::getBranchProbability(TrueWeight, SumWeight);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  FalseProb = BranchProbability::getBranchProbability(FalseWeight, SumWeight);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#ae1d4736e8dfc615fad673c393a757127">  602</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> <a class="code" href="ControlHeightReduction_8cpp.html#ae1d4736e8dfc615fad673c393a757127">getCHRBiasThreshold</a>() {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">return</span> BranchProbability::getBranchProbability(</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a><span class="keyword">&gt;</span>(<a class="code" href="ControlHeightReduction_8cpp.html#a2881475f3f9e1db0f814ff65d7c44e8e">CHRBiasThreshold</a> * 1000000), 1000000);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">// A helper for CheckBiasedBranch and CheckBiasedSelect. If TrueProb &gt;=</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">// CHRBiasThreshold, put Key into TrueSet and return true. If FalseProb &gt;=</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">// CHRBiasThreshold, put Key into FalseSet and return true. Otherwise, return</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">// false.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> S, <span class="keyword">typename</span> M&gt;</div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a5408546ea035fa812e126beb843fdbb7">  612</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#a5408546ea035fa812e126beb843fdbb7">checkBias</a>(K *<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>, <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> TrueProb,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                      <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> FalseProb, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> &amp;TrueSet, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> &amp;FalseSet,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                      <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> &amp;BiasMap) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> Threshold = <a class="code" href="ControlHeightReduction_8cpp.html#ae1d4736e8dfc615fad673c393a757127">getCHRBiasThreshold</a>();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">if</span> (TrueProb &gt;= Threshold) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    TrueSet.insert(<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    BiasMap[<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>] = TrueProb;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FalseProb &gt;= Threshold) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    FalseSet.insert(<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    BiasMap[<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>] = FalseProb;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">// Returns true and insert a region into the right biased set and the map if the</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">// branch of the region is biased.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#af10d0fccdcb58cbd2e3932e630d24dfa">  630</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#af10d0fccdcb58cbd2e3932e630d24dfa">checkBiasedBranch</a>(<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI, <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                              <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Region *&gt;</a> &amp;TrueBiasedRegionsGlobal,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                              <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Region *&gt;</a> &amp;FalseBiasedRegionsGlobal,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                              <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Region *, BranchProbability&gt;</a> &amp;BranchBiasMap) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordflow">if</span> (!BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">isConditional</a>())</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> ThenProb, ElseProb;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#afb9349865f6045be3029d7d171f23f4e">extractBranchProbabilities</a>(BI, ThenProb, ElseProb))</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IfThen = BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IfElse = BI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(1);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IfThen == <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getExit() || IfElse == <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getExit()) &amp;&amp;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;         IfThen != IfElse &amp;&amp;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         <span class="stringliteral">&quot;Invariant from findScopes&quot;</span>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">if</span> (IfThen == <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getExit()) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// Swap them so that IfThen/ThenProb means going into the conditional code</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">// and IfElse/ElseProb means skipping it.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(IfThen, IfElse);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(ThenProb, ElseProb);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BI &quot;</span> &lt;&lt; *BI &lt;&lt; <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;ThenProb &quot;</span> &lt;&lt; ThenProb &lt;&lt; <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;ElseProb &quot;</span> &lt;&lt; ElseProb &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ControlHeightReduction_8cpp.html#a5408546ea035fa812e126beb843fdbb7">checkBias</a>(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, ThenProb, ElseProb,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                   TrueBiasedRegionsGlobal, FalseBiasedRegionsGlobal,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                   BranchBiasMap);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;}</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">// Returns true and insert a select into the right biased set and the map if the</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">// select is biased.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a61bbbc787a1633cdd1cc7d486e6c46f4">  660</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#a61bbbc787a1633cdd1cc7d486e6c46f4">checkBiasedSelect</a>(</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>,</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;SelectInst *&gt;</a> &amp;TrueBiasedSelectsGlobal,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;SelectInst *&gt;</a> &amp;FalseBiasedSelectsGlobal,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;SelectInst *, BranchProbability&gt;</a> &amp;SelectBiasMap) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> TrueProb, FalseProb;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#afb9349865f6045be3029d7d171f23f4e">extractBranchProbabilities</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, TrueProb, FalseProb))</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SI &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;TrueProb &quot;</span> &lt;&lt; TrueProb &lt;&lt; <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;FalseProb &quot;</span> &lt;&lt; FalseProb &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ControlHeightReduction_8cpp.html#a5408546ea035fa812e126beb843fdbb7">checkBias</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, TrueProb, FalseProb,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                   TrueBiasedSelectsGlobal, FalseBiasedSelectsGlobal,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                   SelectBiasMap);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;}</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">// Returns the instruction at which to hoist the dependent condition values and</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">// insert the CHR branch for a region. This is the terminator branch in the</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">// entry block or the first select in the entry block, if any.</span></div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a7e79123396c998a4a059db3c59bdd392">  679</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a>* <a class="code" href="ControlHeightReduction_8cpp.html#a7e79123396c998a4a059db3c59bdd392">getBranchInsertPoint</a>(RegInfo &amp;RI) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EntryBB = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">// The hoist point is by default the terminator of the entry block, which is</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// the same as the branch instruction if RI.HasBranch is true.</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *HoistPoint = EntryBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent() == EntryBB) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="comment">// Pick the first select in Selects in the entry block.  Note Selects is</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="comment">// sorted in the instruction order within a block (asserted below).</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      HoistPoint = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(HoistPoint &amp;&amp; <span class="stringliteral">&quot;Null HoistPoint&quot;</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// Check that HoistPoint is the first one in Selects in the entry block,</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="comment">// if any.</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> EntryBlockSelectSet;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent() == EntryBB) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      EntryBlockSelectSet.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *EntryBB) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (EntryBlockSelectSet.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == HoistPoint &amp;&amp;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;             <span class="stringliteral">&quot;HoistPoint must be the first one in Selects&quot;</span>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">return</span> HoistPoint;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;}</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">// Find a CHR scope in the given region.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;CHRScope * CHR::findScope(<a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  CHRScope *<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Entry = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry();</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Exit = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getExit();  <span class="comment">// null if top level.</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Entry &amp;&amp; <span class="stringliteral">&quot;Entry must not be null&quot;</span>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((Exit == <span class="keyword">nullptr</span>) == (<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;isTopLevelRegion()) &amp;&amp;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         <span class="stringliteral">&quot;Only top level region has a null exit&quot;</span>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordflow">if</span> (Entry)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Entry &quot;</span> &lt;&lt; Entry-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Entry null\n&quot;</span>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordflow">if</span> (Exit)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Exit &quot;</span> &lt;&lt; Exit-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Exit null\n&quot;</span>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// Exclude cases where Entry is part of a subregion (hence it doesn&#39;t belong</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// to this region).</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordtype">bool</span> EntryInSubregion = RI.getRegionFor(Entry) != <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">if</span> (EntryInSubregion)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">// Exclude loops</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(Entry))</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;contains(Pred))</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">// If any of the basic blocks have address taken, we must skip this region</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="comment">// because we cannot clone basic blocks that have address taken.</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;blocks()) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;hasAddressTaken())</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// If we encounter llvm.coro.id, skip this region because if the basic block</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// is cloned, we end up inserting a token type PHI node to the block with</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">// llvm.coro.begin.</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">// FIXME: This could lead to less optimal codegen, because the region is</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// excluded, it can prevent CHR from merging adjacent regions into bigger</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// scope and hoisting more branches.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span> (II-&gt;getIntrinsicID() == Intrinsic::coro_id)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span> (Exit) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// Try to find an if-then block (check if R is an if-then).</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// if (cond) {</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">//  ...</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keyword">auto</span> *BI = dyn_cast&lt;BranchInst&gt;(Entry-&gt;getTerminator());</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (BI)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BI.isConditional &quot;</span> &lt;&lt; BI-&gt;isConditional() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BI null\n&quot;</span>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (BI &amp;&amp; BI-&gt;isConditional()) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *S0 = BI-&gt;getSuccessor(0);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *S1 = BI-&gt;getSuccessor(1);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;S0 &quot;</span> &lt;&lt; S0-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;S1 &quot;</span> &lt;&lt; S1-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">if</span> (S0 != S1 &amp;&amp; (S0 == Exit || S1 == Exit)) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        RegInfo RI(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        RI.HasBranch = <a class="code" href="ControlHeightReduction_8cpp.html#af10d0fccdcb58cbd2e3932e630d24dfa">checkBiasedBranch</a>(</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            BI, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, TrueBiasedRegionsGlobal, FalseBiasedRegionsGlobal,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            BranchBiasMap);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = <span class="keyword">new</span> CHRScope(RI);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <a class="code" href="namespacellvm_1_1logicalview.html#a90c9f20715929cbe06c523bf8546c38ba48b26d57c14af0500090800c2cdd0d58">Scopes</a>.insert(Result);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found a region with a branch\n&quot;</span>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        ++<a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>.NumBranches;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">if</span> (!RI.HasBranch) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;BranchNotBiased&quot;</span>, BI)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Branch not biased&quot;</span>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          });</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// Try to look for selects in the direct child blocks (as opposed to in</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// subregions) of R.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">// ...</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">// if (..) { // Some subregion</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">//   ...</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// if (..) { // Some subregion</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">//   ...</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">// ...</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// a = cond ? b : c;</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">// ...</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 8&gt;</a> Selects;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1RegionNode.html">RegionNode</a> *<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;elements()) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>-&gt;isSubRegion())</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="comment">// This returns the basic block of E if E is a direct child of R (not a</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="comment">// subregion.)</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>-&gt;getEntry();</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="comment">// Need to push in the order to make it easier to find the first Select</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">// later.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SelectInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          Selects.push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          ++<a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>.NumBranches;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">if</span> (Selects.size() &gt; 0) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keyword">auto</span> AddSelects = [&amp;](RegInfo &amp;RI) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : Selects)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="ControlHeightReduction_8cpp.html#a61bbbc787a1633cdd1cc7d486e6c46f4">checkBiasedSelect</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, RI.R,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                TrueBiasedSelectsGlobal,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                FalseBiasedSelectsGlobal,</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                SelectBiasMap))</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            RI.Selects.push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;              <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;SelectNotBiased&quot;</span>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Select not biased&quot;</span>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            });</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      };</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">if</span> (!Result) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found a select-only region\n&quot;</span>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        RegInfo RI(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        AddSelects(RI);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = <span class="keyword">new</span> CHRScope(RI);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="namespacellvm_1_1logicalview.html#a90c9f20715929cbe06c523bf8546c38ba48b26d57c14af0500090800c2cdd0d58">Scopes</a>.insert(Result);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found select(s) in a region with a branch\n&quot;</span>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        AddSelects(<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>-&gt;RegInfos[0]);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordflow">if</span> (Result) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    checkScopeHoistable(Result);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">// Check that any of the branch and the selects in the region could be</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">// hoisted above the the CHR branch insert point (the most dominating of</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">// them, either the branch (at the end of the first block) or the first</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">// select in the first block). If the branch can&#39;t be hoisted, drop the</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">// selects in the first blocks.</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">// For example, for the following scope/region with selects, we want to insert</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">// the merged branch right before the first select in the first/entry block by</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">// hoisting c1, c2, c3, and c4.</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">// // Branch insert point here.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">// a = c1 ? b : c; // Select 1</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">// d = c2 ? e : f; // Select 2</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">// if (c3) { // Branch</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">//   c4 = foo() // A call.</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">//   g = c4 ? h : i; // Select 3</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">// But suppose we can&#39;t hoist c4 because it&#39;s dependent on the preceding</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">// call. Then, we drop Select 3. Furthermore, if we can&#39;t hoist c2, we also drop</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">// Select 2. If we can&#39;t hoist c3, we drop Selects 1 &amp; 2.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="keywordtype">void</span> CHR::checkScopeHoistable(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  RegInfo &amp;RI = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos[0];</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EntryBB = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry();</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> = RI.HasBranch ?</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                 cast&lt;BranchInst&gt;(EntryBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()) : nullptr;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;SelectInst *, 8&gt;</a> &amp;Selects = RI.Selects;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">if</span> (RI.HasBranch || !Selects.empty()) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPoint = <a class="code" href="ControlHeightReduction_8cpp.html#a7e79123396c998a4a059db3c59bdd392">getBranchInsertPoint</a>(RI);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;InsertPoint &quot;</span> &lt;&lt; *InsertPoint &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">// Avoid a data dependence from a select or a branch to a(nother)</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">// select. Note no instruction can&#39;t data-depend on a branch (a branch</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">// instruction doesn&#39;t produce a value).</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> Unhoistables;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">// Initialize Unhoistables with the selects.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : Selects) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      Unhoistables.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// Remove Selects that can&#39;t be hoisted.</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = Selects.begin(); <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != Selects.end(); ) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = *<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> == InsertPoint) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> Visited;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="keywordtype">bool</span> IsHoistable = <a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition(), InsertPoint,</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                                         DT, Unhoistables, <span class="keyword">nullptr</span>, Visited);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordflow">if</span> (!IsHoistable) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Dropping select &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>,</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                          <span class="stringliteral">&quot;DropUnhoistableSelect&quot;</span>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Dropped unhoistable select&quot;</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        });</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = Selects.erase(<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="comment">// Since we are dropping the select here, we also drop it from</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="comment">// Unhoistables.</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        Unhoistables.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#af972d87e15b5f6ed61bd5c3956c5213d">erase</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        ++<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">// Update InsertPoint after potentially removing selects.</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    InsertPoint = <a class="code" href="ControlHeightReduction_8cpp.html#a7e79123396c998a4a059db3c59bdd392">getBranchInsertPoint</a>(RI);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;InsertPoint &quot;</span> &lt;&lt; *InsertPoint &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch &amp;&amp; InsertPoint != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> Visited;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordtype">bool</span> IsHoistable = <a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;getCondition(), InsertPoint,</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                         DT, Unhoistables, <span class="keyword">nullptr</span>, Visited);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordflow">if</span> (!IsHoistable) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="comment">// If the branch isn&#39;t hoistable, drop the selects in the entry</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="comment">// block, preferring the branch, which makes the branch the hoist</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="comment">// point.</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InsertPoint != <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> &amp;&amp; <span class="stringliteral">&quot;Branch must not be the hoist point&quot;</span>);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Dropping selects in entry block \n&quot;</span>);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : Selects) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SI &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            });</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : Selects) {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;          ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>,</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                            <span class="stringliteral">&quot;DropSelectUnhoistableBranch&quot;</span>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Dropped select due to unhoistable branch&quot;</span>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          });</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(Selects, [EntryBB](<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent() == EntryBB;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        });</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        Unhoistables.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a1fbf4d66a9eeaa9ade03e8febee097ee">clear</a>();</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        InsertPoint = <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;InsertPoint &quot;</span> &lt;&lt; *InsertPoint &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!DT.dominates(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>, InsertPoint) &amp;&amp;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;             <span class="stringliteral">&quot;Branch can&#39;t be already above the hoist point&quot;</span>);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> Visited;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;getCondition(), InsertPoint,</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                             DT, Unhoistables, <span class="keyword">nullptr</span>, Visited) &amp;&amp;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;             <span class="stringliteral">&quot;checkHoistValue for branch&quot;</span>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : Selects) {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!DT.dominates(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, InsertPoint) &amp;&amp;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;             <span class="stringliteral">&quot;SI can&#39;t be already above the hoist point&quot;</span>);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> Visited;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition(), InsertPoint, DT,</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                             Unhoistables, <span class="keyword">nullptr</span>, Visited) &amp;&amp;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;             <span class="stringliteral">&quot;checkHoistValue for selects&quot;</span>);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Result\n&quot;</span>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BI &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : Selects) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SI &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;}</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">// Traverse the region tree, find all nested scopes and merge them if possible.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;CHRScope * CHR::findScopes(<a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, <a class="code" href="classllvm_1_1Region.html">Region</a> *NextRegion, <a class="code" href="classllvm_1_1Region.html">Region</a> *ParentRegion,</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                           <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Scopes) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;findScopes &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getNameStr() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  CHRScope *<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = findScope(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="comment">// Visit subscopes.</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  CHRScope *ConsecutiveSubscope = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> Subscopes;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> It = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;begin(); It != <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;end(); ++It) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keyword">const</span> std::unique_ptr&lt;Region&gt; &amp;SubR = *It;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keyword">auto</span> NextIt = std::next(It);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *NextSubR = NextIt != <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;end() ? NextIt-&gt;get() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Looking at subregion &quot;</span> &lt;&lt; SubR.get()-&gt;getNameStr()</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    CHRScope *SubCHRScope = findScopes(SubR.get(), NextSubR, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, Scopes);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span> (SubCHRScope) {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Subregion Scope &quot;</span> &lt;&lt; *SubCHRScope &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Subregion Scope null\n&quot;</span>);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">if</span> (SubCHRScope) {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordflow">if</span> (!ConsecutiveSubscope)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        ConsecutiveSubscope = SubCHRScope;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ConsecutiveSubscope-&gt;appendable(SubCHRScope)) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        Subscopes.push_back(ConsecutiveSubscope);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        ConsecutiveSubscope = SubCHRScope;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        ConsecutiveSubscope-&gt;append(SubCHRScope);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keywordflow">if</span> (ConsecutiveSubscope) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        Subscopes.push_back(ConsecutiveSubscope);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      ConsecutiveSubscope = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keywordflow">if</span> (ConsecutiveSubscope) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    Subscopes.push_back(ConsecutiveSubscope);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">for</span> (CHRScope *Sub : Subscopes) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">if</span> (Result) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="comment">// Combine it with the parent.</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>-&gt;addSub(Sub);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="comment">// Push Subscopes as they won&#39;t be combined with the parent.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <a class="code" href="namespacellvm_1_1logicalview.html#a90c9f20715929cbe06c523bf8546c38ba48b26d57c14af0500090800c2cdd0d58">Scopes</a>.push_back(Sub);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#abb56ce74e047a983c8550d39bc817a58"> 1025</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> <a class="code" href="ControlHeightReduction_8cpp.html#abb56ce74e047a983c8550d39bc817a58">getCHRConditionValuesForRegion</a>(RegInfo &amp;RI) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> ConditionValues;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">if</span> (RI.HasBranch) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keyword">auto</span> *BI = cast&lt;BranchInst&gt;(RI.R-&gt;getEntry()-&gt;getTerminator());</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    ConditionValues.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(BI-&gt;getCondition());</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    ConditionValues.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition());</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">return</span> ConditionValues;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;}</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">// Determine whether to split a scope depending on the sets of the branch</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">// condition values of the previous region and the current region. We split</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">// (return true) it if 1) the condition values of the inner/lower scope can&#39;t be</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">// hoisted up to the outer/upper scope, or 2) the two sets of the condition</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">// values have an empty intersection (because the combined branch conditions</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">// won&#39;t probably lead to a simpler combined condition).</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a4bd77853df82f4643859aa72ec33b2c0"> 1044</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#a4bd77853df82f4643859aa72ec33b2c0">shouldSplit</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPoint,</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                        <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> &amp;PrevConditionValues,</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                        <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> &amp;ConditionValues,</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> &amp;Unhoistables) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InsertPoint &amp;&amp; <span class="stringliteral">&quot;Null InsertPoint&quot;</span>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;shouldSplit &quot;</span> &lt;&lt; *InsertPoint &lt;&lt; <span class="stringliteral">&quot; PrevConditionValues &quot;</span>;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : PrevConditionValues) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; ConditionValues &quot;</span>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : ConditionValues) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">// If any of Bases isn&#39;t hoistable to the hoist point, split.</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : ConditionValues) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> Visited;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(V, InsertPoint, DT, Unhoistables, <span class="keyword">nullptr</span>, Visited)) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Split. checkHoistValue false &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Not hoistable, split.</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// If PrevConditionValues or ConditionValues is empty, don&#39;t split to avoid</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">// unnecessary splits at scopes with no branch/selects.  If</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="comment">// PrevConditionValues and ConditionValues don&#39;t intersect at all, split.</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordflow">if</span> (!PrevConditionValues.empty() &amp;&amp; !ConditionValues.empty()) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// Use std::set as DenseSet doesn&#39;t work with set_intersection.</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    std::set&lt;Value *&gt; PrevBases, Bases;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, std::set&lt;Value *&gt;</a>&gt; Visited;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : PrevConditionValues) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <span class="keyword">const</span> std::set&lt;Value *&gt; &amp;BaseValues = <a class="code" href="ControlHeightReduction_8cpp.html#a41889aad2ef3409b5ab2a9ad06d09fa8">getBaseValues</a>(V, DT, Visited);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      PrevBases.insert(BaseValues.begin(), BaseValues.end());</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : ConditionValues) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keyword">const</span> std::set&lt;Value *&gt; &amp;BaseValues = <a class="code" href="ControlHeightReduction_8cpp.html#a41889aad2ef3409b5ab2a9ad06d09fa8">getBaseValues</a>(V, DT, Visited);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      Bases.insert(BaseValues.begin(), BaseValues.end());</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;PrevBases &quot;</span>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : PrevBases) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Bases &quot;</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : Bases) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    std::vector&lt;Value *&gt; Intersection;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    std::set_intersection(PrevBases.begin(), PrevBases.end(), Bases.begin(),</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                          Bases.end(), std::back_inserter(Intersection));</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (Intersection.empty()) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <span class="comment">// Empty intersection, split.</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Split. Intersection empty\n&quot;</span>);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;No split\n&quot;</span>);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;  <span class="comment">// Don&#39;t split.</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;}</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a9eb6a3b45c148ae1416c2c8ad15f9b06"> 1106</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="ControlHeightReduction_8cpp.html#a9eb6a3b45c148ae1416c2c8ad15f9b06">getSelectsInScope</a>(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                              <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> &amp;Output) {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos)</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      Output.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordflow">for</span> (CHRScope *Sub : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;Subs)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a9eb6a3b45c148ae1416c2c8ad15f9b06">getSelectsInScope</a>(Sub, Output);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;}</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordtype">void</span> CHR::splitScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                      <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output) {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">for</span> (CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> : Input) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;BranchInsertPoint &amp;&amp;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;           <span class="stringliteral">&quot;BranchInsertPoint must not be set&quot;</span>);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> Unhoistables;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a9eb6a3b45c148ae1416c2c8ad15f9b06">getSelectsInScope</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, Unhoistables);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    splitScope(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, Output, Unhoistables);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">for</span> (CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> : Output) {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;BranchInsertPoint &amp;&amp; <span class="stringliteral">&quot;BranchInsertPoint must be set&quot;</span>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> CHR::splitScope(</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    CHRScope *Outer,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> *OuterConditionValues,</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OuterInsertPoint,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output,</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> &amp;Unhoistables) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">if</span> (Outer) {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OuterConditionValues &amp;&amp; <span class="stringliteral">&quot;Null OuterConditionValues&quot;</span>);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OuterInsertPoint &amp;&amp; <span class="stringliteral">&quot;Null OuterInsertPoint&quot;</span>);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  }</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordtype">bool</span> PrevSplitFromOuter = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> PrevConditionValues;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PrevInsertPoint = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> Splits;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;bool, 8&gt;</a> SplitsSplitFromOuter;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DenseSet&lt;Value *&gt;</a>, 8&gt; SplitsConditionValues;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> SplitsInsertPoints;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;RegInfo, 8&gt;</a> RegInfos(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos);  <span class="comment">// Copy</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : RegInfos) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPoint = <a class="code" href="ControlHeightReduction_8cpp.html#a7e79123396c998a4a059db3c59bdd392">getBranchInsertPoint</a>(RI);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> ConditionValues = <a class="code" href="ControlHeightReduction_8cpp.html#abb56ce74e047a983c8550d39bc817a58">getCHRConditionValuesForRegion</a>(RI);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;ConditionValues &quot;</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : ConditionValues) {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">if</span> (RI.R == RegInfos[0].R) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="comment">// First iteration. Check to see if we should split from the outer.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordflow">if</span> (Outer) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Outer &quot;</span> &lt;&lt; *Outer &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Should split from outer at &quot;</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                  &lt;&lt; RI.R-&gt;getNameStr() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ControlHeightReduction_8cpp.html#a4bd77853df82f4643859aa72ec33b2c0">shouldSplit</a>(OuterInsertPoint, *OuterConditionValues,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                        ConditionValues, DT, Unhoistables)) {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;          PrevConditionValues = ConditionValues;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;          PrevInsertPoint = InsertPoint;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;          ORE.emit([&amp;]() {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                            <span class="stringliteral">&quot;SplitScopeFromOuter&quot;</span>,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                            RI.R-&gt;getEntry()-&gt;getTerminator())</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Split scope from outer due to unhoistable branch/select &quot;</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;and/or lack of common condition values&quot;</span>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;          });</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;          <span class="comment">// Not splitting from the outer. Use the outer bases and insert</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;          <span class="comment">// point. Union the bases.</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;          PrevSplitFromOuter = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;          PrevConditionValues = *OuterConditionValues;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;          PrevConditionValues.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(ConditionValues.begin(),</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                     ConditionValues.end());</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          PrevInsertPoint = OuterInsertPoint;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Outer null\n&quot;</span>);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        PrevConditionValues = ConditionValues;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        PrevInsertPoint = InsertPoint;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Should split from prev at &quot;</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                &lt;&lt; RI.R-&gt;getNameStr() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ControlHeightReduction_8cpp.html#a4bd77853df82f4643859aa72ec33b2c0">shouldSplit</a>(PrevInsertPoint, PrevConditionValues, ConditionValues,</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                      DT, Unhoistables)) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        CHRScope *<a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">Tail</a> = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;split(RI.R);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <a class="code" href="namespacellvm_1_1logicalview.html#a90c9f20715929cbe06c523bf8546c38ba48b26d57c14af0500090800c2cdd0d58">Scopes</a>.insert(<a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">Tail</a>);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        Splits.push_back(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        SplitsSplitFromOuter.push_back(PrevSplitFromOuter);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        SplitsConditionValues.push_back(PrevConditionValues);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        SplitsInsertPoints.push_back(PrevInsertPoint);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> = <a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">Tail</a>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        PrevConditionValues = ConditionValues;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        PrevInsertPoint = InsertPoint;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        PrevSplitFromOuter = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        ORE.emit([&amp;]() {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>,</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                          <span class="stringliteral">&quot;SplitScopeFromPrev&quot;</span>,</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                          RI.R-&gt;getEntry()-&gt;getTerminator())</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Split scope from previous due to unhoistable branch/select &quot;</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;and/or lack of common condition values&quot;</span>;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        });</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="comment">// Not splitting. Union the bases. Keep the hoist point.</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        PrevConditionValues.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(ConditionValues.begin(), ConditionValues.end());</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  Splits.push_back(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  SplitsSplitFromOuter.push_back(PrevSplitFromOuter);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  SplitsConditionValues.push_back(PrevConditionValues);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PrevInsertPoint &amp;&amp; <span class="stringliteral">&quot;Null PrevInsertPoint&quot;</span>);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  SplitsInsertPoints.push_back(PrevInsertPoint);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Splits.size() == SplitsConditionValues.size() &amp;&amp;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;         Splits.size() == SplitsSplitFromOuter.size() &amp;&amp;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;         Splits.size() == SplitsInsertPoints.size() &amp;&amp; <span class="stringliteral">&quot;Mismatching sizes&quot;</span>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; Splits.size(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    CHRScope *<a class="code" href="namespacellvm_1_1logicalview.html#a032987f23ff952c1def983c6bb120f00a8a9e64d86ed12ad40de129bc7f4683b2">Split</a> = Splits[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Value *&gt;</a> &amp;SplitConditionValues = SplitsConditionValues[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *SplitInsertPoint = SplitsInsertPoints[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> NewSubs;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> SplitUnhoistables;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a9eb6a3b45c148ae1416c2c8ad15f9b06">getSelectsInScope</a>(Split, SplitUnhoistables);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">for</span> (CHRScope *Sub : <a class="code" href="namespacellvm_1_1logicalview.html#a032987f23ff952c1def983c6bb120f00a8a9e64d86ed12ad40de129bc7f4683b2">Split</a>-&gt;Subs) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> SubSplits = splitScope(</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          Sub, Split, &amp;SplitConditionValues, SplitInsertPoint, Output,</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          SplitUnhoistables);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <a class="code" href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a>(NewSubs, SubSplits);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="namespacellvm_1_1logicalview.html#a032987f23ff952c1def983c6bb120f00a8a9e64d86ed12ad40de129bc7f4683b2">Split</a>-&gt;Subs = NewSubs;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; Splits.size(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    CHRScope *<a class="code" href="namespacellvm_1_1logicalview.html#a032987f23ff952c1def983c6bb120f00a8a9e64d86ed12ad40de129bc7f4683b2">Split</a> = Splits[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (SplitsSplitFromOuter[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]) {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="comment">// Split from the outer.</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      Output.push_back(Split);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <a class="code" href="namespacellvm_1_1logicalview.html#a032987f23ff952c1def983c6bb120f00a8a9e64d86ed12ad40de129bc7f4683b2">Split</a>-&gt;BranchInsertPoint = SplitsInsertPoints[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BranchInsertPoint &quot;</span> &lt;&lt; *SplitsInsertPoints[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <span class="comment">// Connected to the outer.</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.push_back(Split);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keywordflow">if</span> (!Outer)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.empty() &amp;&amp;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;           <span class="stringliteral">&quot;If no outer (top-level), must return no nested ones&quot;</span>);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;}</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keywordtype">void</span> CHR::classifyBiasedScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Scopes) {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="keywordflow">for</span> (CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> : Scopes) {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions.empty() &amp;&amp; <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions.empty() &amp;&amp; <span class="stringliteral">&quot;Empty&quot;</span>);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    classifyBiasedScopes(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;classifyBiasedScopes &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;TrueBiasedRegions &quot;</span>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getNameStr() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;FalseBiasedRegions &quot;</span>;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions) {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getNameStr() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;TrueBiasedSelects &quot;</span>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects) {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;FalseBiasedSelects &quot;</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="keywordtype">void</span> CHR::classifyBiasedScopes(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, CHRScope *OutermostScope) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos) {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch) {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keywordflow">if</span> (TrueBiasedRegionsGlobal.contains(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>))</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        OutermostScope-&gt;TrueBiasedRegions.insert(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FalseBiasedRegionsGlobal.contains(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>))</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        OutermostScope-&gt;FalseBiasedRegions.insert(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Must be biased&quot;</span>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">if</span> (TrueBiasedSelectsGlobal.contains(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        OutermostScope-&gt;TrueBiasedSelects.insert(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FalseBiasedSelectsGlobal.contains(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        OutermostScope-&gt;FalseBiasedSelects.insert(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Must be biased&quot;</span>);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">for</span> (CHRScope *Sub : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;Subs) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    classifyBiasedScopes(Sub, OutermostScope);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;}</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160; </div>
<div class="line"><a name="l01315"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a6f11f4e5d8f0e7bc1365d24ef97f642d"> 1315</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#a6f11f4e5d8f0e7bc1365d24ef97f642d">hasAtLeastTwoBiasedBranches</a>(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keywordtype">unsigned</span> NumBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions.size() +</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                       <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions.size() +</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                       <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.size() +</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                       <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.size();</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordflow">return</span> NumBiased &gt;= <a class="code" href="ControlHeightReduction_8cpp.html#a81882243935b8e8dbd427c4cfcd5dabc">CHRMergeThreshold</a>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;}</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keywordtype">void</span> CHR::filterScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                       <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output) {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordflow">for</span> (CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> : Input) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">// Filter out the ones with only one region and no subs.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#a6f11f4e5d8f0e7bc1365d24ef97f642d">hasAtLeastTwoBiasedBranches</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>)) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Filtered out by biased branches truthy-regions &quot;</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                &lt;&lt; <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions.size()</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; falsy-regions &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions.size()</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; true-selects &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.size()</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; false-selects &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>,</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="stringliteral">&quot;DropScopeWithOneBranchOrSelect&quot;</span>,</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos[0].R-&gt;getEntry()-&gt;getTerminator())</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Drop scope with &lt; &quot;</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;CHRMergeThreshold&quot;</span>, <a class="code" href="ControlHeightReduction_8cpp.html#a81882243935b8e8dbd427c4cfcd5dabc">CHRMergeThreshold</a>)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; biased branch(es) or select(s)&quot;</span>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      });</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    Output.push_back(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;}</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="keywordtype">void</span> CHR::setCHRRegions(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                        <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output) {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">for</span> (CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> : Input) {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;HoistStopMap.empty() &amp;&amp; <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;CHRRegions.empty() &amp;&amp;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;           <span class="stringliteral">&quot;Empty&quot;</span>);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    setCHRRegions(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    Output.push_back(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;setCHRRegions HoistStopMap &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;HoistStopMap) {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;          Region *R = pair.first;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;          dbgs() &lt;&lt; <span class="stringliteral">&quot;Region &quot;</span> &lt;&lt; R-&gt;getNameStr() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          for (Instruction *I : pair.second) {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            dbgs() &lt;&lt; <span class="stringliteral">&quot;HoistStop &quot;</span> &lt;&lt; *I &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;          }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        }</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CHRRegions&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;CHRRegions) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; RI.R-&gt;getNameStr() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        });</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;}</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="keywordtype">void</span> CHR::setCHRRegions(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, CHRScope *OutermostScope) {</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> Unhoistables;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="comment">// Put the biased selects in Unhoistables because they should stay where they</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// are and constant-folded after CHR (in case one biased select or a branch</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">// can depend on another biased select.)</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      Unhoistables.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPoint = OutermostScope-&gt;BranchInsertPoint;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> HoistStops;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordtype">bool</span> IsHoisted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch) {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((OutermostScope-&gt;TrueBiasedRegions.contains(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>) ||</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;              OutermostScope-&gt;FalseBiasedRegions.contains(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>)) &amp;&amp;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;             <span class="stringliteral">&quot;Must be truthy or falsy&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keyword">auto</span> *BI = cast&lt;BranchInst&gt;(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry()-&gt;getTerminator());</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="comment">// Note checkHoistValue fills in HoistStops.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> Visited;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keywordtype">bool</span> IsHoistable = <a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(BI-&gt;getCondition(), InsertPoint, DT,</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                         Unhoistables, &amp;HoistStops, Visited);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsHoistable &amp;&amp; <span class="stringliteral">&quot;Must be hoistable&quot;</span>);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      (void)(IsHoistable);  <span class="comment">// Unused in release build</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      IsHoisted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((OutermostScope-&gt;TrueBiasedSelects.contains(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) ||</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;              OutermostScope-&gt;FalseBiasedSelects.contains(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)) &amp;&amp;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;             <span class="stringliteral">&quot;Must be true or false biased&quot;</span>);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="comment">// Note checkHoistValue fills in HoistStops.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, bool&gt;</a> Visited;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keywordtype">bool</span> IsHoistable = <a class="code" href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition(), InsertPoint, DT,</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                         Unhoistables, &amp;HoistStops, Visited);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsHoistable &amp;&amp; <span class="stringliteral">&quot;Must be hoistable&quot;</span>);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      (void)(IsHoistable);  <span class="comment">// Unused in release build</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      IsHoisted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span> (IsHoisted) {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      OutermostScope-&gt;CHRRegions.push_back(RI);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      OutermostScope-&gt;HoistStopMap[<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>] = HoistStops;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    }</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="keywordflow">for</span> (CHRScope *Sub : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;Subs)</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    setCHRRegions(Sub, OutermostScope);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;}</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a28a73b23a3e5378915406237983a2240"> 1420</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#a28a73b23a3e5378915406237983a2240">CHRScopeSorter</a>(CHRScope *Scope1, CHRScope *Scope2) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="keywordflow">return</span> Scope1-&gt;RegInfos[0].R-&gt;getDepth() &lt; Scope2-&gt;RegInfos[0].R-&gt;getDepth();</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;}</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="keywordtype">void</span> CHR::sortScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Input,</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                     <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Output) {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  Output.<a class="code" href="classllvm_1_1SmallVectorImpl.html#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(Input.size());</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <a class="code" href="namespacellvm.html#abb650e853db0ddbb60411b885c499737">llvm::copy</a>(Input, Output.begin());</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a>(Output, <a class="code" href="ControlHeightReduction_8cpp.html#a28a73b23a3e5378915406237983a2240">CHRScopeSorter</a>);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;}</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">// Return true if V is already hoisted or was hoisted (along with its operands)</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">// to the insert point.</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a64bba3cf05c8cb1baa848483e7150830"> 1433</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="ControlHeightReduction_8cpp.html#a64bba3cf05c8cb1baa848483e7150830">hoistValue</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *HoistPoint, <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>,</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                       HoistStopMapTy &amp;HoistStopMap,</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                       <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> &amp;HoistedSet,</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                       <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> &amp;TrivialPHIs,</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                       <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ARMSubtarget_8cpp.html#a6a14930b01ccb1cf446cd96395284102">IT</a> = HoistStopMap.find(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="ARMSubtarget_8cpp.html#a6a14930b01ccb1cf446cd96395284102">IT</a> != HoistStopMap.end() &amp;&amp; <span class="stringliteral">&quot;Region must be in hoist stop map&quot;</span>);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> &amp;HoistStops = <a class="code" href="ARMSubtarget_8cpp.html#a6a14930b01ccb1cf446cd96395284102">IT</a>-&gt;second;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V)) {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == HoistPoint)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span> (HoistStops.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PN = dyn_cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="keywordflow">if</span> (TrivialPHIs.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(PN))</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="comment">// The trivial phi inserted by the previous CHR scope could replace a</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="comment">// non-phi in HoistStops. Note that since this phi is at the exit of a</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="comment">// previous CHR scope, which dominates this scope, it&#39;s safe to stop</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <span class="comment">// hoisting there.</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">if</span> (HoistedSet.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="comment">// Already hoisted, return.</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="ControlHeightReduction_8cpp.html#aa9216799cee3b3000ce6714aac1c1c7e">isHoistableInstructionType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <span class="stringliteral">&quot;Unhoistable instruction type&quot;</span>);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">getNode</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()) &amp;&amp; <span class="stringliteral">&quot;DT must contain I&#39;s block&quot;</span>);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">getNode</a>(HoistPoint-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) &amp;&amp;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;           <span class="stringliteral">&quot;DT must contain HoistPoint block&quot;</span>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="keywordflow">if</span> (DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, HoistPoint))</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="comment">// We are already above the hoist point. Stop here. This may be necessary</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="comment">// when multiple scopes would independently hoist the same</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="comment">// instruction. Since an outer (dominating) scope would hoist it to its</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="comment">// entry before an inner (dominated) scope would to its entry, the inner</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="comment">// scope may see the instruction already hoisted, in which case it</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="comment">// potentially wrong for the inner scope to hoist it and could cause bad</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="comment">// IR (non-dominating def), but safe to skip hoisting it instead because</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="comment">// it&#39;s already in a block that dominates the inner scope.</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;operands()) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a64bba3cf05c8cb1baa848483e7150830">hoistValue</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, HoistPoint, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, HoistStopMap, HoistedSet, TrivialPHIs, DT);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;moveBefore(HoistPoint);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    HoistedSet.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;hoistValue &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;}</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">// Hoist the dependent condition values of the branches and the selects in the</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">// scope to the insert point.</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#aa849347ff04d0eca6ce4fc70cada49d5"> 1481</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="ControlHeightReduction_8cpp.html#aa849347ff04d0eca6ce4fc70cada49d5">hoistScopeConditions</a>(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *HoistPoint,</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                                 <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> &amp;TrivialPHIs,</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                                 <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction *&gt;</a> HoistedSet;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;CHRRegions) {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordtype">bool</span> IsTrueBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions.count(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordtype">bool</span> IsFalseBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions.count(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch &amp;&amp; (IsTrueBiased || IsFalseBiased)) {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keyword">auto</span> *BI = cast&lt;BranchInst&gt;(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry()-&gt;getTerminator());</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a64bba3cf05c8cb1baa848483e7150830">hoistValue</a>(BI-&gt;getCondition(), HoistPoint, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;HoistStopMap,</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                 HoistedSet, TrivialPHIs, DT);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="keywordtype">bool</span> IsTrueBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="keywordtype">bool</span> IsFalseBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordflow">if</span> (!(IsTrueBiased || IsFalseBiased))</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a64bba3cf05c8cb1baa848483e7150830">hoistValue</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition(), HoistPoint, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;HoistStopMap,</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                 HoistedSet, TrivialPHIs, DT);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;}</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">// Negate the predicate if an ICmp if it&#39;s used only by branches or selects by</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">// swapping the operands of the branches or the selects. Returns true if success.</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#acda14ede9da471244980c7fada91a4aa"> 1507</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="ControlHeightReduction_8cpp.html#acda14ede9da471244980c7fada91a4aa">negateICmpIfUsedByBranchOrSelectOnly</a>(<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *ICmp,</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                                 <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ExcludedUser,</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                                 CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : ICmp-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">if</span> (U == ExcludedUser)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keywordflow">if</span> (isa&lt;BranchInst&gt;(U) &amp;&amp; cast&lt;BranchInst&gt;(U)-&gt;isConditional())</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SelectInst&gt;(U) &amp;&amp; cast&lt;SelectInst&gt;(U)-&gt;getCondition() == ICmp)</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : ICmp-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordflow">if</span> (U == ExcludedUser)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *BI = dyn_cast&lt;BranchInst&gt;(U)) {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BI-&gt;isConditional() &amp;&amp; <span class="stringliteral">&quot;Must be conditional&quot;</span>);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      BI-&gt;swapSuccessors();</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <span class="comment">// Don&#39;t need to swap this in terms of</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <span class="comment">// TrueBiasedRegions/FalseBiasedRegions because true-based/false-based</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <span class="comment">// mean whehter the branch is likely go into the if-then rather than</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="comment">// successor0/successor1 and because we can tell which edge is the then or</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="comment">// the else one by comparing the destination to the region exit block.</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SelectInst&gt;(U)) {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="comment">// Swap operands</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;swapValues();</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;swapProfMetadata();</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)) {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.contains(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) &amp;&amp;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;               <span class="stringliteral">&quot;Must not be already in&quot;</span>);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.insert(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.contains(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) &amp;&amp;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;               <span class="stringliteral">&quot;Must not be already in&quot;</span>);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.insert(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Must be a branch or a select&quot;</span>);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">setPredicate</a>(CmpInst::getInversePredicate(ICmp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>()));</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;}</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">// A helper for transformScopes. Insert a trivial phi at the scope exit block</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">// for a value that&#39;s defined in the scope but used outside it (meaning it&#39;s</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">// alive at the exit block).</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#a071886a7b42adae6a171e653e04bd216"> 1556</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="ControlHeightReduction_8cpp.html#a071886a7b42adae6a171e653e04bd216">insertTrivialPHIs</a>(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                              <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EntryBlock, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock,</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                              <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> &amp;TrivialPHIs) {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;BasicBlock *, 8&gt;</a> BlocksInScope;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos) {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : RI.R-&gt;blocks()) { <span class="comment">// This includes the blocks in the</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                            <span class="comment">// sub-Scopes.</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      BlocksInScope.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>({</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inserting redundant phis\n&quot;</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : BlocksInScope)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BlockInScope &quot;</span> &lt;&lt; <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  });</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : BlocksInScope) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.users()) {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *UI = dyn_cast&lt;Instruction&gt;(U)) {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;          <span class="keywordflow">if</span> (!BlocksInScope.contains(UI-&gt;getParent()) &amp;&amp;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;              <span class="comment">// Unless there&#39;s already a phi for I at the exit block.</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;              !(isa&lt;PHINode&gt;(UI) &amp;&amp; UI-&gt;getParent() == ExitBlock)) {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;V &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Used outside scope by user &quot;</span> &lt;&lt; *UI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>.push_back(UI);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (UI-&gt;getParent() == EntryBlock &amp;&amp; isa&lt;PHINode&gt;(UI)) {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            <span class="comment">// There&#39;s a loop backedge from a block that&#39;s dominated by this</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            <span class="comment">// scope to the entry block.</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;V &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Used at entry block (for a back edge) by a phi user &quot;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                      &lt;&lt; *UI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>.push_back(UI);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;          }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>.size() &gt; 0) {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="comment">// Insert a trivial phi for I (phi [&amp;I, P0], [&amp;I, P1], ...) at</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="comment">// ExitBlock. Replace I with the new phi in UI unless UI is another</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="comment">// phi at ExitBlock.</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = PHINode::Create(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType(), <a class="code" href="namespacellvm.html#ae6d1c31d74bbaaa9e42bcbdc10a499f2">pred_size</a>(ExitBlock), <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                                      &amp;ExitBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(ExitBlock)) {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Pred);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        TrivialPHIs.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(PN);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Insert phi &quot;</span> &lt;&lt; *PN &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UI : <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>) {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> J = 0, NumOps = UI-&gt;getNumOperands(); J &lt; NumOps; ++J) {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="keywordflow">if</span> (UI-&gt;getOperand(J) == &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;              UI-&gt;setOperand(J, PN);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;          }</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Updated user &quot;</span> &lt;&lt; *UI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;}</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment">// Assert that all the CHR regions of the scope have a biased branch or select.</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a></div>
<div class="line"><a name="l01619"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#ad90b565f38c7ef3477c8ceb0bef3976d"> 1619</a></span>&#160;<a class="code" href="ControlHeightReduction_8cpp.html#ad90b565f38c7ef3477c8ceb0bef3976d">assertCHRRegionsHaveBiasedBranchOrSelect</a>(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>) {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="keyword">auto</span> HasBiasedBranchOrSelect = [](RegInfo &amp;RI, CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions.count(RI.R) ||</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions.count(RI.R))</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects)</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) ||</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;          <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  };</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;CHRRegions) {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(HasBiasedBranchOrSelect(RI, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>) &amp;&amp;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;           <span class="stringliteral">&quot;Must have biased branch or select&quot;</span>);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;}</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">// Assert that all the condition values of the biased branches and selects have</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">// been hoisted to the pre-entry block or outside of the scope.</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#ad36fda9d8203a5374fcb76941423c400"> 1640</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a> <a class="code" href="ControlHeightReduction_8cpp.html#ad36fda9d8203a5374fcb76941423c400">assertBranchOrSelectConditionHoisted</a>(</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock) {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Biased regions condition values \n&quot;</span>);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;CHRRegions) {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="keywordtype">bool</span> IsTrueBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions.count(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordtype">bool</span> IsFalseBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions.count(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch &amp;&amp; (IsTrueBiased || IsFalseBiased)) {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <span class="keyword">auto</span> *BI = cast&lt;BranchInst&gt;(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry()-&gt;getTerminator());</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = BI-&gt;getCondition();</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V)) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        (void)(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); <span class="comment">// Unused in release build.</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent() == PreEntryBlock ||</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                !<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;contains(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &amp;&amp;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;               <span class="stringliteral">&quot;Must have been hoisted to PreEntryBlock or outside the scope&quot;</span>);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordtype">bool</span> IsTrueBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keywordtype">bool</span> IsFalseBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keywordflow">if</span> (!(IsTrueBiased || IsFalseBiased))</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition();</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V)) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        (void)(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); <span class="comment">// Unused in release build.</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent() == PreEntryBlock ||</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                !<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;contains(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &amp;&amp;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;               <span class="stringliteral">&quot;Must have been hoisted to PreEntryBlock or outside the scope&quot;</span>);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="keywordtype">void</span> CHR::transformScopes(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> &amp;TrivialPHIs) {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;transformScopes &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos.size() &gt;= 1 &amp;&amp; <span class="stringliteral">&quot;Should have at least one Region&quot;</span>);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos) {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#a860d2c073855bc32dc6d517bc6fc706c">Duplication</a> = getRegionDuplicationCount(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Dup count for R=&quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> &lt;&lt; <span class="stringliteral">&quot;  is &quot;</span> &lt;&lt; <a class="code" href="lib_2Target_2X86_2README_8txt.html#a860d2c073855bc32dc6d517bc6fc706c">Duplication</a></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2X86_2README_8txt.html#a860d2c073855bc32dc6d517bc6fc706c">Duplication</a> &gt;= <a class="code" href="ControlHeightReduction_8cpp.html#ad7c6ec0efac7bf1cda1e2f0db908ccd4">CHRDupThreshsold</a>) {</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Reached the dup threshold of &quot;</span> &lt;&lt; <a class="code" href="lib_2Target_2X86_2README_8txt.html#a860d2c073855bc32dc6d517bc6fc706c">Duplication</a></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; for this region&quot;</span>);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;DupThresholdReached&quot;</span>,</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                        <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry()-&gt;getTerminator())</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;Reached the duplication threshold for the region&quot;</span>;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      });</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos) {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    DuplicationCount[RI.R]++;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a> *FirstRegion = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos[0].R;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EntryBlock = FirstRegion-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a36c36190d483bb765415014f3036de87">getEntry</a>();</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <a class="code" href="classllvm_1_1Region.html">Region</a> *LastRegion = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos[<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos.size() - 1].R;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock = LastRegion-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a1e4d2a9707cc6d2a71a1ffea59516ad5">getExit</a>();</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  std::optional&lt;uint64_t&gt; <a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a> = <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>.getBlockProfileCount(EntryBlock);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="keywordflow">if</span> (ExitBlock) {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="comment">// Insert a trivial phi at the exit block (where the CHR hot path and the</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="comment">// cold path merges) for a value that&#39;s defined in the scope but used</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">// outside it (meaning it&#39;s alive at the exit block). We will add the</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">// incoming values for the CHR cold paths to it below. Without this, we&#39;d</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="comment">// miss updating phi&#39;s for such values unless there happens to already be a</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="comment">// phi for that value there.</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a071886a7b42adae6a171e653e04bd216">insertTrivialPHIs</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, EntryBlock, ExitBlock, TrivialPHIs);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="comment">// Split the entry block of the first region. The new block becomes the new</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <span class="comment">// entry block of the first region. The old entry block becomes the block to</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="comment">// insert the CHR branch into. Note DT gets updated. Since DT gets updated</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="comment">// through the split, we update the entry of the first region after the split,</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="comment">// and Region only points to the entry and the exit blocks, rather than</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="comment">// keeping everything in a list or set, the blocks membership and the</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="comment">// entry/exit blocks of the region are still valid after the split.</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Splitting entry block &quot;</span> &lt;&lt; EntryBlock-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; at &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;BranchInsertPoint &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewEntryBlock =</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(EntryBlock, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;BranchInsertPoint, &amp;DT);</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewEntryBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>() == EntryBlock &amp;&amp;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;         <span class="stringliteral">&quot;NewEntryBlock&#39;s only pred must be EntryBlock&quot;</span>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  FirstRegion-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a736d34433c1ecf86e5649d44ea701ad5">replaceEntryRecursive</a>(NewEntryBlock);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock = EntryBlock;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> VMap;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="comment">// Clone the blocks in the scope (excluding the PreEntryBlock) to split into a</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="comment">// hot path (originals) and a cold path (clones) and update the PHIs at the</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="comment">// exit block.</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  cloneScopeBlocks(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, PreEntryBlock, ExitBlock, LastRegion, VMap);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <span class="comment">// Replace the old (placeholder) branch with the new (merged) conditional</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="comment">// branch.</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *MergedBr = createMergedBranch(PreEntryBlock, EntryBlock,</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                                            NewEntryBlock, VMap);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#ad90b565f38c7ef3477c8ceb0bef3976d">assertCHRRegionsHaveBiasedBranchOrSelect</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; </div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="comment">// Hoist the conditional values of the branches/selects.</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#aa849347ff04d0eca6ce4fc70cada49d5">hoistScopeConditions</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, PreEntryBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>(), TrivialPHIs, DT);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#ad36fda9d8203a5374fcb76941423c400">assertBranchOrSelectConditionHoisted</a>(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, PreEntryBlock);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">// Create the combined branch condition and constant-fold the branches/selects</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <span class="comment">// in the hot path.</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  fixupBranchesAndSelects(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, PreEntryBlock, MergedBr,</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                          <a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a>.value_or(0));</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;}</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">// A helper for transformScopes. Clone the blocks in the scope (excluding the</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">// PreEntryBlock) to split into a hot path and a cold path and update the PHIs</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment">// at the exit block.</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="keywordtype">void</span> CHR::cloneScopeBlocks(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                           <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock,</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                           <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock,</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                           <a class="code" href="classllvm_1_1Region.html">Region</a> *LastRegion,</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                           <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> &amp;VMap) {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">// Clone all the blocks. The original blocks will be the hot-path</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <span class="comment">// CHR-optimized code and the cloned blocks will be the original unoptimized</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <span class="comment">// code. This is so that the block pointers from the</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="comment">// CHRScope/Region/RegionInfo can stay valid in pointing to the hot-path code</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="comment">// which CHR should apply to.</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock*, 8&gt;</a> NewBlocks;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;RegInfos)</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : RI.R-&gt;blocks()) { <span class="comment">// This includes the blocks in the</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                            <span class="comment">// sub-Scopes.</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> != PreEntryBlock &amp;&amp; <span class="stringliteral">&quot;Don&#39;t copy the preetntry block&quot;</span>);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB = <a class="code" href="namespacellvm.html#a6befe133f42d6a8e07ba98372d7f9c60">CloneBasicBlock</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, VMap, <span class="stringliteral">&quot;.nonchr&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      NewBlocks.push_back(NewBB);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      VMap[<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>] = NewBB;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="comment">// Place the cloned blocks right after the original blocks (right before the</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="comment">// exit block of.)</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keywordflow">if</span> (ExitBlock)</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.splice(ExitBlock-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>(), &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, NewBlocks[0]-&gt;getIterator(),</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;             <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.end());</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="comment">// Update the cloned blocks/instructions to refer to themselves.</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB : NewBlocks)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *NewBB)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <a class="code" href="namespacellvm.html#a8f2893ab869a806d78af17691eb97be3">RemapInstruction</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, VMap,</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                       <a class="code" href="namespacellvm.html#a77724415203930efd07d7098cb1e437da9a24bd8dba1bef2753bc3f087435ae7f">RF_NoModuleLevelChanges</a> | <a class="code" href="namespacellvm.html#a77724415203930efd07d7098cb1e437da5633028bc27ffa8eab39cc5de65b3108">RF_IgnoreMissingLocals</a>);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="comment">// Add the cloned blocks to the PHIs of the exit blocks. ExitBlock is null for</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <span class="comment">// the top-level region but we don&#39;t need to add PHIs. The trivial PHIs</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="comment">// inserted above will be updated here.</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">if</span> (ExitBlock)</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN : ExitBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>())</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, NumOps = PN.getNumIncomingValues(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumOps;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;           ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred = PN.getIncomingBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">if</span> (LastRegion-&gt;<a class="code" href="classllvm_1_1RegionBase.html#a75479f44e7157d1a8592231addb67c9c">contains</a>(Pred)) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *V = PN.getIncomingValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;          <span class="keyword">auto</span> It = VMap.<a class="code" href="classllvm_1_1ValueMap.html#a7629b8c5f6a6802ee0fdc5c290769692">find</a>(V);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;          <span class="keywordflow">if</span> (It != VMap.<a class="code" href="classllvm_1_1ValueMap.html#ab871e2d0ebded563edfebd6766fc1a04">end</a>()) V = It-&gt;second;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VMap.<a class="code" href="classllvm_1_1ValueMap.html#a7629b8c5f6a6802ee0fdc5c290769692">find</a>(Pred) != VMap.<a class="code" href="classllvm_1_1ValueMap.html#ab871e2d0ebded563edfebd6766fc1a04">end</a>() &amp;&amp; <span class="stringliteral">&quot;Pred must have been cloned&quot;</span>);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;          PN.addIncoming(V, cast&lt;BasicBlock&gt;(VMap[Pred]));</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      }</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;}</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">// A helper for transformScope. Replace the old (placeholder) branch with the</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">// new (merged) conditional branch.</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *CHR::createMergedBranch(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock,</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                                    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *EntryBlock,</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                                    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewEntryBlock,</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                                    <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> &amp;VMap) {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *OldBR = cast&lt;BranchInst&gt;(PreEntryBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OldBR-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad56f6a9b5cd05940017c4544df48bc30">isUnconditional</a>() &amp;&amp; OldBR-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0) == NewEntryBlock &amp;&amp;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;         <span class="stringliteral">&quot;SplitBlock did not work correctly!&quot;</span>);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewEntryBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>() == EntryBlock &amp;&amp;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;         <span class="stringliteral">&quot;NewEntryBlock&#39;s only pred must be EntryBlock&quot;</span>);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VMap.<a class="code" href="classllvm_1_1ValueMap.html#a7629b8c5f6a6802ee0fdc5c290769692">find</a>(NewEntryBlock) != VMap.<a class="code" href="classllvm_1_1ValueMap.html#ab871e2d0ebded563edfebd6766fc1a04">end</a>() &amp;&amp;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;         <span class="stringliteral">&quot;NewEntryBlock must have been copied&quot;</span>);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  OldBR-&gt;<a class="code" href="classllvm_1_1User.html#a48ec5fcee6d2c17c723e8e67f169f948">dropAllReferences</a>();</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  OldBR-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="comment">// The true predicate is a placeholder. It will be replaced later in</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="comment">// fixupBranchesAndSelects().</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *NewBR = BranchInst::Create(NewEntryBlock,</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                                         cast&lt;BasicBlock&gt;(VMap[NewEntryBlock]),</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                                         <a class="code" href="InstructionSimplify_8cpp.html#a565dd825f238fa0a8c4bbfe562635f7c">ConstantInt::getTrue</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext()));</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  NewBR-&gt;<a class="code" href="classllvm_1_1Instruction.html#ad8c5093a18a40f863d4fc5fa6eefefa8">insertInto</a>(PreEntryBlock, PreEntryBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewEntryBlock-&gt;getSinglePredecessor() == EntryBlock &amp;&amp;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;         <span class="stringliteral">&quot;NewEntryBlock&#39;s only pred must be EntryBlock&quot;</span>);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordflow">return</span> NewBR;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;}</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">// A helper for transformScopes. Create the combined branch condition and</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">// constant-fold the branches/selects in the hot path.</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="keywordtype">void</span> CHR::fixupBranchesAndSelects(CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                                  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PreEntryBlock,</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                                  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *MergedBR,</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                                  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a>) {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *MergedCondition = <a class="code" href="InstructionSimplify_8cpp.html#a565dd825f238fa0a8c4bbfe562635f7c">ConstantInt::getTrue</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext());</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> CHRBranchBias(1, 1);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NumCHRedBranches = 0;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> IRB(PreEntryBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <span class="keywordflow">for</span> (RegInfo &amp;RI : <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;CHRRegions) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = RI.R;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">if</span> (RI.HasBranch) {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      fixupBranch(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, IRB, MergedCondition, CHRBranchBias);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      ++NumCHRedBranches;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : RI.Selects) {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      fixupSelect(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, IRB, MergedCondition, CHRBranchBias);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      ++NumCHRedBranches;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  }</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>.NumBranchesDelta += NumCHRedBranches - 1;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>.WeightedNumBranchesDelta += (NumCHRedBranches - 1) * <a class="code" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  ORE.emit([&amp;]() {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>,</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                              <span class="stringliteral">&quot;CHR&quot;</span>,</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                              <span class="comment">// Refer to the hot (original) path</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                              MergedBR-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>())</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Merged &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;NumCHRedBranches&quot;</span>, NumCHRedBranches)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; branches or selects&quot;</span>;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  });</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  MergedBR-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a3505dab06f59c36142a234321cdc3411">setCondition</a>(MergedCondition);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <a class="code" href="classuint32__t.html">uint32_t</a> Weights[] = {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="classuint32__t.html">uint32_t</a><span class="keyword">&gt;</span>(CHRBranchBias.scale(1000)),</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="classuint32__t.html">uint32_t</a><span class="keyword">&gt;</span>(CHRBranchBias.getCompl().scale(1000)),</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  };</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <a class="code" href="classllvm_1_1MDBuilder.html">MDBuilder</a> MDB(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext());</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  MergedBR-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD_prof, MDB.createBranchWeights(Weights));</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CHR branch bias &quot;</span> &lt;&lt; Weights[0] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; Weights[1]</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment">// A helper for fixupBranchesAndSelects. Add to the combined branch condition</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">// and constant-fold a branch in the hot path.</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="keywordtype">void</span> CHR::fixupBranch(<a class="code" href="classllvm_1_1Region.html">Region</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>, CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;IRB,</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                      <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;MergedCondition,</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                      <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> &amp;CHRBranchBias) {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keywordtype">bool</span> IsTrueBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedRegions.count(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IsTrueBiased || <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedRegions.count(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>)) &amp;&amp;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;         <span class="stringliteral">&quot;Must be truthy or falsy&quot;</span>);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="keyword">auto</span> *BI = cast&lt;BranchInst&gt;(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getEntry()-&gt;getTerminator());</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BranchBiasMap.find(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>) != BranchBiasMap.end() &amp;&amp;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;         <span class="stringliteral">&quot;Must be in the bias map&quot;</span>);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> Bias = BranchBiasMap[<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>];</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Bias &gt;= <a class="code" href="ControlHeightReduction_8cpp.html#ae1d4736e8dfc615fad673c393a757127">getCHRBiasThreshold</a>() &amp;&amp; <span class="stringliteral">&quot;Must be highly biased&quot;</span>);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="comment">// Take the min.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">if</span> (CHRBranchBias &gt; Bias)</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    CHRBranchBias = Bias;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IfThen = BI-&gt;getSuccessor(1);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *IfElse = BI-&gt;getSuccessor(0);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RegionExitBlock = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;getExit();</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RegionExitBlock &amp;&amp; <span class="stringliteral">&quot;Null ExitBlock&quot;</span>);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IfThen == RegionExitBlock || IfElse == RegionExitBlock) &amp;&amp;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;         IfThen != IfElse &amp;&amp; <span class="stringliteral">&quot;Invariant from findScopes&quot;</span>);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="keywordflow">if</span> (IfThen == RegionExitBlock) {</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="comment">// Swap them so that IfThen means going into it and IfElse means skipping</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="comment">// it.</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(IfThen, IfElse);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  }</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;IfThen &quot;</span> &lt;&lt; IfThen-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; IfElse &quot;</span> &lt;&lt; IfElse-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = BI-&gt;getCondition();</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *HotTarget = IsTrueBiased ? IfThen : IfElse;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <span class="keywordtype">bool</span> ConditionTrue = HotTarget == BI-&gt;getSuccessor(0);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  addToMergedCondition(ConditionTrue, <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>, BI, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, IRB,</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                       MergedCondition);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="comment">// Constant-fold the branch at ClonedEntryBlock.</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ConditionTrue == (HotTarget == BI-&gt;getSuccessor(0)) &amp;&amp;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;         <span class="stringliteral">&quot;The successor shouldn&#39;t change&quot;</span>);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewCondition = ConditionTrue ?</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                        <a class="code" href="InstructionSimplify_8cpp.html#a565dd825f238fa0a8c4bbfe562635f7c">ConstantInt::getTrue</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext()) :</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                        <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>::<a class="code" href="InstructionSimplify_8cpp.html#adb39181b87dffcd61082d08e02bf314e">getFalse</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext());</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  BI-&gt;setCondition(NewCondition);</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;}</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">// A helper for fixupBranchesAndSelects. Add to the combined branch condition</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">// and constant-fold a select in the hot path.</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="keywordtype">void</span> CHR::fixupSelect(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;IRB,</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                      <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;MergedCondition,</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                      <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> &amp;CHRBranchBias) {</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <span class="keywordtype">bool</span> IsTrueBiased = <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;TrueBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IsTrueBiased ||</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;          <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;FalseBiasedSelects.count(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)) &amp;&amp; <span class="stringliteral">&quot;Must be biased&quot;</span>);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SelectBiasMap.find(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) != SelectBiasMap.end() &amp;&amp;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;         <span class="stringliteral">&quot;Must be in the bias map&quot;</span>);</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> Bias = SelectBiasMap[<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>];</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Bias &gt;= <a class="code" href="ControlHeightReduction_8cpp.html#ae1d4736e8dfc615fad673c393a757127">getCHRBiasThreshold</a>() &amp;&amp; <span class="stringliteral">&quot;Must be highly biased&quot;</span>);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="comment">// Take the min.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="keywordflow">if</span> (CHRBranchBias &gt; Bias)</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    CHRBranchBias = Bias;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition();</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  addToMergedCondition(IsTrueBiased, <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, IRB,</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                       MergedCondition);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewCondition = IsTrueBiased ?</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                        <a class="code" href="InstructionSimplify_8cpp.html#a565dd825f238fa0a8c4bbfe562635f7c">ConstantInt::getTrue</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext()) :</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                        <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a>::<a class="code" href="InstructionSimplify_8cpp.html#adb39181b87dffcd61082d08e02bf314e">getFalse</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext());</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;setCondition(NewCondition);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">// A helper for fixupBranch/fixupSelect. Add a branch condition to the merged</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment">// condition.</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="keywordtype">void</span> CHR::addToMergedCondition(<span class="keywordtype">bool</span> IsTrueBiased, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>,</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                               <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BranchOrSelect, CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                               <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;IRB, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;MergedCondition) {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">if</span> (!IsTrueBiased) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">// If Cond is an icmp and all users of V except for BranchOrSelect is a</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">// branch, negate the icmp predicate and swap the branch targets and avoid</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">// inserting an Xor to negate Cond.</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keyword">auto</span> *ICmp = dyn_cast&lt;ICmpInst&gt;(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">if</span> (!ICmp ||</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        !<a class="code" href="ControlHeightReduction_8cpp.html#acda14ede9da471244980c7fada91a4aa">negateICmpIfUsedByBranchOrSelectOnly</a>(ICmp, BranchOrSelect, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>))</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = IRB.<a class="code" href="classllvm_1_1IRBuilderBase.html#a84652ca512637318e6729c659cf4541d">CreateXor</a>(<a class="code" href="InstructionSimplify_8cpp.html#a565dd825f238fa0a8c4bbfe562635f7c">ConstantInt::getTrue</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext()), <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  }</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="comment">// Select conditions can be poison, while branching on poison is immediate</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <span class="comment">// undefined behavior. As such, we need to freeze potentially poisonous</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <span class="comment">// conditions derived from selects.</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keywordflow">if</span> (isa&lt;SelectInst&gt;(BranchOrSelect) &amp;&amp;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      !<a class="code" href="ValueTracking_8cpp.html#af00585087cddeeb1e8995d4647966cfe">isGuaranteedNotToBeUndefOrPoison</a>(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>))</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = IRB.<a class="code" href="classllvm_1_1IRBuilderBase.html#a23f4fd9c646569c76800ac898a8e3517">CreateFreeze</a>(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="comment">// Use logical and to avoid propagating poison from later conditions.</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  MergedCondition = IRB.<a class="code" href="classllvm_1_1IRBuilderBase.html#adb3effdbb33cd3a2ac0c96bf1e67590f">CreateLogicalAnd</a>(MergedCondition, <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;}</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="keywordtype">void</span> CHR::transformScopes(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;CHRScopes) {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;PHINode *&gt;</a> TrivialPHIs;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordflow">for</span> (CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> : CHRScopes) {</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    transformScopes(<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, TrivialPHIs);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        std::ostringstream oss;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        oss &lt;&lt; <span class="stringliteral">&quot; after transformScopes &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <a class="code" href="ControlHeightReduction_8cpp.html#a8acf25125313b0e6333bb7fa3f4404f6">dumpIR</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, oss.str().c_str(), <span class="keyword">nullptr</span>));</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    (void)<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  }</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;}</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a></div>
<div class="line"><a name="l01990"></a><span class="lineno"><a class="line" href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961"> 1990</a></span>&#160;<a class="code" href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961">dumpScopes</a>(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CHRScope *&gt;</a> &amp;Scopes, <span class="keyword">const</span> <span class="keywordtype">char</span> *Label) {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; Label &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Scopes.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <span class="keywordflow">for</span> (CHRScope *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> : Scopes) {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;}</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">CHR::run</a>() {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ControlHeightReduction_8cpp.html#a7cf6fe605431375e61c307bb1ca5cf41">shouldApply</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PSI))</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="ControlHeightReduction_8cpp.html#a8acf25125313b0e6333bb7fa3f4404f6">dumpIR</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;before&quot;</span>, <span class="keyword">nullptr</span>));</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  {</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;RegionInfo:\n&quot;</span>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        RI.print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">// Recursively traverse the region tree and find regions that have biased</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="comment">// branches and/or selects and create scopes.</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> AllScopes;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    findScopes(AllScopes);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961">dumpScopes</a>(AllScopes, <span class="stringliteral">&quot;All scopes&quot;</span>));</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">// Split the scopes if 1) the conditional values of the biased</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="comment">// branches/selects of the inner/lower scope can&#39;t be hoisted up to the</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="comment">// outermost/uppermost scope entry, or 2) the condition values of the biased</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="comment">// branches/selects in a scope (including subscopes) don&#39;t share at least</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="comment">// one common value.</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> SplitScopes;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    splitScopes(AllScopes, SplitScopes);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961">dumpScopes</a>(SplitScopes, <span class="stringliteral">&quot;Split scopes&quot;</span>));</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">// After splitting, set the biased regions and selects of a scope (a tree</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="comment">// root) that include those of the subscopes.</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    classifyBiasedScopes(SplitScopes);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Set per-scope bias &quot;</span> &lt;&lt; SplitScopes.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="comment">// Filter out the scopes that has only one biased region or select (CHR</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">// isn&#39;t useful in such a case).</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> FilteredScopes;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    filterScopes(SplitScopes, FilteredScopes);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961">dumpScopes</a>(FilteredScopes, <span class="stringliteral">&quot;Filtered scopes&quot;</span>));</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">// Set the regions to be CHR&#39;ed and their hoist stops for each scope.</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> SetScopes;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    setCHRRegions(FilteredScopes, SetScopes);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961">dumpScopes</a>(SetScopes, <span class="stringliteral">&quot;Set CHR regions&quot;</span>));</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="comment">// Sort CHRScopes by the depth so that outer CHRScopes comes before inner</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="comment">// ones. We need to apply CHR from outer to inner so that we apply CHR only</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="comment">// to the hot path, rather than both hot and cold paths.</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CHRScope *, 8&gt;</a> SortedScopes;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    sortScopes(SetScopes, SortedScopes);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961">dumpScopes</a>(SortedScopes, <span class="stringliteral">&quot;Sorted scopes&quot;</span>));</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;RegionInfo:\n&quot;</span>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        RI.print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="comment">// Apply the CHR transformation.</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordflow">if</span> (!SortedScopes.empty()) {</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      transformScopes(SortedScopes);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="keywordflow">if</span> (Changed) {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <a class="code" href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a>(<a class="code" href="ControlHeightReduction_8cpp.html#a8acf25125313b0e6333bb7fa3f4404f6">dumpIR</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;after&quot;</span>, &amp;<a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>));</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    ORE.emit([&amp;]() {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>(<a class="code" href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;Stats&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;          &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;Function&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Reduced the number of branches in hot paths by &quot;</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;          &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;NumBranchesDelta&quot;</span>, <a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>.NumBranchesDelta)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; (static) and &quot;</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;          &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;WeightedNumBranchesDelta&quot;</span>, <a class="code" href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a>.WeightedNumBranchesDelta)</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; (weighted by PGO count)&quot;</span>;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    });</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; </div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;}</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"><a class="line" href="classllvm_1_1ControlHeightReductionPass.html#a8a2445471971f0f43e0454d57dca56e9"> 2076</a></span>&#160;<a class="code" href="classllvm_1_1ControlHeightReductionPass.html#a8a2445471971f0f43e0454d57dca56e9">ControlHeightReductionPass::ControlHeightReductionPass</a>() {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <a class="code" href="ControlHeightReduction_8cpp.html#aff85944087fc349e227e8b737179cb3e">parseCHRFilterFiles</a>();</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;}</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"><a class="line" href="classllvm_1_1ControlHeightReductionPass.html#aa07878663a309c8f4a4537b971c6d3b0"> 2080</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1ControlHeightReductionPass.html#aa07878663a309c8f4a4537b971c6d3b0">ControlHeightReductionPass::run</a>(</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>) {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a> = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyAnalysis.html">BlockFrequencyAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="keyword">auto</span> &amp;DT = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeAnalysis.html">DominatorTreeAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keyword">auto</span> &amp;MAMProxy = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1OuterAnalysisManagerProxy.html">ModuleAnalysisManagerFunctionProxy</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keyword">auto</span> &amp;PSI = *MAMProxy.getCachedResult&lt;<a class="code" href="classllvm_1_1ProfileSummaryAnalysis.html">ProfileSummaryAnalysis</a>&gt;(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent());</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <span class="keyword">auto</span> &amp;RI = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1RegionInfoAnalysis.html">RegionInfoAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keyword">auto</span> &amp;ORE = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">OptimizationRemarkEmitterAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordtype">bool</span> Changed = CHR(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>, DT, PSI, RI, ORE).<a class="code" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html#a82def85e95d702c5c226841c3d8205b8">run</a>();</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordflow">if</span> (!Changed)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;}</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;} <span class="comment">// namespace llvm</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aRegionInfo_8h_html"><div class="ttname"><a href="RegionInfo_8h.html">RegionInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aMemoryBuffer_8h_html"><div class="ttname"><a href="MemoryBuffer_8h.html">MemoryBuffer.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1OuterAnalysisManagerProxy_html"><div class="ttname"><a href="classllvm_1_1OuterAnalysisManagerProxy.html">llvm::OuterAnalysisManagerProxy</a></div><div class="ttdoc">An analysis over an &quot;inner&quot; IR unit that provides access to an analysis manager over a &quot;outer&quot; IR uni...</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l01056">PassManager.h:1056</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a9eb6a3b45c148ae1416c2c8ad15f9b06"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a9eb6a3b45c148ae1416c2c8ad15f9b06">getSelectsInScope</a></div><div class="ttdeci">static void getSelectsInScope(CHRScope *Scope, DenseSet&lt; Instruction * &gt; &amp;Output)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01106">ControlHeightReduction.cpp:1106</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_adb3effdbb33cd3a2ac0c96bf1e67590f"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#adb3effdbb33cd3a2ac0c96bf1e67590f">llvm::IRBuilderBase::CreateLogicalAnd</a></div><div class="ttdeci">Value * CreateLogicalAnd(Value *Cond1, Value *Cond2, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01591">IRBuilder.h:1591</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_abb4ce3bc3096a12d4b93460bf78bcf95"><div class="ttname"><a href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a></div><div class="ttdeci">into xmm2 addss xmm2 xmm1 xmm3 addss xmm3 movaps xmm0 unpcklps xmm0 ret seems silly when it could just be one addps Expand libm rounding functions main should enable SSE DAZ mode and other fast SSE modes Think about doing i64 math in SSE regs on x86 This testcase should have no SSE instructions in it</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00081">README-SSE.txt:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryBuffer_html_aa98611beefe78f907beeee7305cc8174"><div class="ttname"><a href="classllvm_1_1MemoryBuffer.html#aa98611beefe78f907beeee7305cc8174">llvm::MemoryBuffer::getFile</a></div><div class="ttdeci">static ErrorOr&lt; std::unique_ptr&lt; MemoryBuffer &gt; &gt; getFile(const Twine &amp;Filename, bool IsText=false, bool RequiresNullTerminator=true, bool IsVolatile=false, std::optional&lt; Align &gt; Alignment=std::nullopt)</div><div class="ttdoc">Open the specified file as a MemoryBuffer, returning a new MemoryBuffer if successful,...</div><div class="ttdef"><b>Definition:</b> <a href="MemoryBuffer_8cpp_source.html#l00248">MemoryBuffer.cpp:248</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a81882243935b8e8dbd427c4cfcd5dabc"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a81882243935b8e8dbd427c4cfcd5dabc">CHRMergeThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; CHRMergeThreshold(&quot;chr-merge-threshold&quot;, cl::init(2), cl::Hidden, cl::desc(&quot;CHR merges a group of N branches/selects where N &gt;= this value&quot;))</div></div>
<div class="ttc" id="aValueMapper_8h_html"><div class="ttname"><a href="ValueMapper_8h.html">ValueMapper.h</a></div></div>
<div class="ttc" id="aArchiveWriter_8cpp_html_aa9f638c7ae7fdd206a6c60e26bef9751"><div class="ttname"><a href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a></div><div class="ttdeci">static void print(raw_ostream &amp;Out, object::Archive::Kind Kind, T Val)</div><div class="ttdef"><b>Definition:</b> <a href="ArchiveWriter_8cpp_source.html#l00189">ArchiveWriter.cpp:189</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a5defa49c396dd67771e7f595976e27c7"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a5defa49c396dd67771e7f595976e27c7">CHRModules</a></div><div class="ttdeci">static StringSet CHRModules</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00078">ControlHeightReduction.cpp:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aclassllvm_1_1ValueMap_html_ab871e2d0ebded563edfebd6766fc1a04"><div class="ttname"><a href="classllvm_1_1ValueMap.html#ab871e2d0ebded563edfebd6766fc1a04">llvm::ValueMap::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="ValueMap_8h_source.html#l00135">ValueMap.h:135</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aAArch64AdvSIMDScalarPass_8cpp_html_a1112b818386ec01ddfdf3a5d0024eb17"><div class="ttname"><a href="AArch64AdvSIMDScalarPass_8cpp.html#a1112b818386ec01ddfdf3a5d0024eb17">contains</a></div><div class="ttdeci">return AArch64::GPR64RegClass contains(Reg)</div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a84652ca512637318e6729c659cf4541d"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a84652ca512637318e6729c659cf4541d">llvm::IRBuilderBase::CreateXor</a></div><div class="ttdeci">Value * CreateXor(Value *LHS, Value *RHS, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01434">IRBuilder.h:1434</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html_a030e1f2821a154dec1b16c80a7154833"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html#a030e1f2821a154dec1b16c80a7154833">llvm::ProfileSummaryInfo::isFunctionEntryHot</a></div><div class="ttdeci">bool isFunctionEntryHot(const Function *F) const</div><div class="ttdoc">Returns true if F has hot function entry.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8cpp_source.html#l00101">ProfileSummaryInfo.cpp:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a48ec5fcee6d2c17c723e8e67f169f948"><div class="ttname"><a href="classllvm_1_1User.html#a48ec5fcee6d2c17c723e8e67f169f948">llvm::User::dropAllReferences</a></div><div class="ttdeci">void dropAllReferences()</div><div class="ttdoc">Drop all references to operands.</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00299">User.h:299</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a282e11b24a3ab565115e0ed4b68820b7"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a282e11b24a3ab565115e0ed4b68820b7">CHRFunctions</a></div><div class="ttdeci">static StringSet CHRFunctions</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00079">ControlHeightReduction.cpp:79</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a41889aad2ef3409b5ab2a9ad06d09fa8"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a41889aad2ef3409b5ab2a9ad06d09fa8">getBaseValues</a></div><div class="ttdeci">static const std::set&lt; Value * &gt; &amp; getBaseValues(Value *V, DominatorTree &amp;DT, DenseMap&lt; Value *, std::set&lt; Value * &gt;&gt; &amp;Visited)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00491">ControlHeightReduction.cpp:491</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ad8c5093a18a40f863d4fc5fa6eefefa8"><div class="ttname"><a href="classllvm_1_1Instruction.html#ad8c5093a18a40f863d4fc5fa6eefefa8">llvm::Instruction::insertInto</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator insertInto(BasicBlock *ParentBB, SymbolTableList&lt; Instruction &gt;::iterator It)</div><div class="ttdoc">Inserts an unlinked instruction into ParentBB at position It and returns the iterator of the inserted...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00098">Instruction.cpp:98</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac9a7de5a04920954ac964059cfc428ad"><div class="ttname"><a href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a></div><div class="ttdeci">void erase_if(Container &amp;C, UnaryPredicate P)</div><div class="ttdoc">Provide a container algorithm similar to C++ Library Fundamentals v2's erase_if which is equivalent t...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01998">STLExtras.h:1998</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a61bbbc787a1633cdd1cc7d486e6c46f4"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a61bbbc787a1633cdd1cc7d486e6c46f4">checkBiasedSelect</a></div><div class="ttdeci">static bool checkBiasedSelect(SelectInst *SI, Region *R, DenseSet&lt; SelectInst * &gt; &amp;TrueBiasedSelectsGlobal, DenseSet&lt; SelectInst * &gt; &amp;FalseBiasedSelectsGlobal, DenseMap&lt; SelectInst *, BranchProbability &gt; &amp;SelectBiasMap)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00660">ControlHeightReduction.cpp:660</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1ControlHeightReductionPass_html_aa07878663a309c8f4a4537b971c6d3b0"><div class="ttname"><a href="classllvm_1_1ControlHeightReductionPass.html#aa07878663a309c8f4a4537b971c6d3b0">llvm::ControlHeightReductionPass::run</a></div><div class="ttdeci">PreservedAnalyses run(Function &amp;F, FunctionAnalysisManager &amp;FAM)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l02080">ControlHeightReduction.cpp:2080</a></div></div>
<div class="ttc" id="aGlobalsModRef_8h_html"><div class="ttname"><a href="GlobalsModRef_8h.html">GlobalsModRef.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aARMSubtarget_8cpp_html_a6a14930b01ccb1cf446cd96395284102"><div class="ttname"><a href="ARMSubtarget_8cpp.html#a6a14930b01ccb1cf446cd96395284102">IT</a></div><div class="ttdeci">static cl::opt&lt; ITMode &gt; IT(cl::desc(&quot;IT block support&quot;), cl::Hidden, cl::init(DefaultIT), cl::values(clEnumValN(DefaultIT, &quot;arm-default-it&quot;, &quot;Generate any type of IT block&quot;), clEnumValN(RestrictedIT, &quot;arm-restrict-it&quot;, &quot;Disallow complex IT blocks&quot;)))</div></div>
<div class="ttc" id="aDataLayout_8cpp_html_a974f64e92d8749b49b9179a0bf255b93"><div class="ttname"><a href="DataLayout_8cpp.html#a974f64e92d8749b49b9179a0bf255b93">split</a></div><div class="ttdeci">static Error split(StringRef Str, char Separator, std::pair&lt; StringRef, StringRef &gt; &amp;Split)</div><div class="ttdoc">Checked version of split, to ensure mandatory subparts.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00215">DataLayout.cpp:215</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00155">PassManager.h:155</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a6f11f4e5d8f0e7bc1365d24ef97f642d"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a6f11f4e5d8f0e7bc1365d24ef97f642d">hasAtLeastTwoBiasedBranches</a></div><div class="ttdeci">static bool hasAtLeastTwoBiasedBranches(CHRScope *Scope)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01315">ControlHeightReduction.cpp:1315</a></div></div>
<div class="ttc" id="aDenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a214ec2f04ffd92636ed4bd2717607a1d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">llvm::sys::path::end</a></div><div class="ttdeci">const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00235">Path.cpp:235</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a00a76a729b319dc47beffbe07325565f"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path, Style style=Style::native)</div><div class="ttdoc">Get begin iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00226">Path.cpp:226</a></div></div>
<div class="ttc" id="anamespacellvm_html_abb650e853db0ddbb60411b885c499737"><div class="ttname"><a href="namespacellvm.html#abb650e853db0ddbb60411b885c499737">llvm::copy</a></div><div class="ttdeci">OutputIt copy(R &amp;&amp;Range, OutputIt Out)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01837">STLExtras.h:1837</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a4344e66fb61ea313a85a9e054124ac55"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">llvm::DominatorTreeBase::getNode</a></div><div class="ttdeci">DomTreeNodeBase&lt; NodeT &gt; * getNode(const NodeT *BB) const</div><div class="ttdoc">getNode - return the (Post)DominatorTree node for the specified basic block.</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00367">GenericDomTree.h:367</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a8f5533240c6722d987a2443cba42019d"><div class="ttname"><a href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="aValueTracking_8cpp_html_af00585087cddeeb1e8995d4647966cfe"><div class="ttname"><a href="ValueTracking_8cpp.html#af00585087cddeeb1e8995d4647966cfe">isGuaranteedNotToBeUndefOrPoison</a></div><div class="ttdeci">static bool isGuaranteedNotToBeUndefOrPoison(const Value *V, AssumptionCache *AC, const Instruction *CtxI, const DominatorTree *DT, unsigned Depth, bool PoisonOnly)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l05449">ValueTracking.cpp:5449</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9a7b5c68c90f85baaedaa854cc5002cc"><div class="ttname"><a href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">llvm::errs</a></div><div class="ttdeci">raw_fd_ostream &amp; errs()</div><div class="ttdoc">This returns a reference to a raw_ostream for standard error.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8cpp_source.html#l00899">raw_ostream.cpp:899</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringSet_html_a31714563344c51d7d917d1206efa48cf"><div class="ttname"><a href="classllvm_1_1StringSet.html#a31714563344c51d7d917d1206efa48cf">llvm::StringSet::insert</a></div><div class="ttdeci">std::pair&lt; typename Base::iterator, bool &gt; insert(StringRef key)</div><div class="ttdef"><b>Definition:</b> <a href="StringSet_8h_source.html#l00034">StringSet.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a59fb91d1691350f7d1b8e8a114e3f2a4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">llvm::BasicBlock::getSinglePredecessor</a></div><div class="ttdeci">const BasicBlock * getSinglePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a single predecessor block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00284">BasicBlock.cpp:284</a></div></div>
<div class="ttc" id="aCompiler_8h_html_acc1c483f4b4ee2f17bb6643a3b353609"><div class="ttname"><a href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a></div><div class="ttdeci">#define LLVM_ATTRIBUTE_UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00172">Compiler.h:172</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a7e79123396c998a4a059db3c59bdd392"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a7e79123396c998a4a059db3c59bdd392">getBranchInsertPoint</a></div><div class="ttdeci">static Instruction * getBranchInsertPoint(RegInfo &amp;RI)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00679">ControlHeightReduction.cpp:679</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a79eed48913651aeedda2eed25201ea84"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">llvm::detail::DenseSetImpl&lt; ValueT, DenseMap&lt; ValueT, detail::DenseSetEmpty, DenseMapInfo&lt; ValueT &gt;, detail::DenseSetPair&lt; ValueT &gt; &gt;, DenseMapInfo&lt; ValueT &gt; &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const ValueT &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00206">DenseSet.h:206</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_afe504aa31a6a354cec13f5b32d0b1d9d"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#afe504aa31a6a354cec13f5b32d0b1d9d">llvm::detail::DenseSetImpl::count</a></div><div class="ttdeci">size_type count(const_arg_type_t&lt; ValueT &gt; V) const</div><div class="ttdoc">Return 1 if the specified key is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00097">DenseSet.h:97</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9247a212ea89acc9573fa7e7f557eaba"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">llvm::Instruction::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdoc">Set the metadata of the specified kind to the specified node.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01455">Metadata.cpp:1455</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a032987f23ff952c1def983c6bb120f00a8a9e64d86ed12ad40de129bc7f4683b2"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a032987f23ff952c1def983c6bb120f00a8a9e64d86ed12ad40de129bc7f4683b2">llvm::logicalview::LVOutputKind::Split</a></div><div class="ttdeci">@ Split</div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_acb80894344c78dacf8d5ff8c23be697d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#acb80894344c78dacf8d5ff8c23be697d">llvm::sys::path::append</a></div><div class="ttdeci">void append(SmallVectorImpl&lt; char &gt; &amp;path, const Twine &amp;a, const Twine &amp;b=&quot;&quot;, const Twine &amp;c=&quot;&quot;, const Twine &amp;d=&quot;&quot;)</div><div class="ttdoc">Append to path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00456">Path.cpp:456</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a8cd802dcaed35e1f28ea3cbe4af4eff5"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a8cd802dcaed35e1f28ea3cbe4af4eff5">llvm::detail::DenseSetImpl::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00174">DenseSet.h:174</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a64bba3cf05c8cb1baa848483e7150830"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a64bba3cf05c8cb1baa848483e7150830">hoistValue</a></div><div class="ttdeci">static void hoistValue(Value *V, Instruction *HoistPoint, Region *R, HoistStopMapTy &amp;HoistStopMap, DenseSet&lt; Instruction * &gt; &amp;HoistedSet, DenseSet&lt; PHINode * &gt; &amp;TrivialPHIs, DominatorTree &amp;DT)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01433">ControlHeightReduction.cpp:1433</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html">llvm::BlockFrequencyInfo</a></div><div class="ttdoc">BlockFrequencyInfo pass uses BlockFrequencyInfoImpl implementation to estimate IR basic block frequen...</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00037">BlockFrequencyInfo.h:37</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8f2893ab869a806d78af17691eb97be3"><div class="ttname"><a href="namespacellvm.html#a8f2893ab869a806d78af17691eb97be3">llvm::RemapInstruction</a></div><div class="ttdeci">void RemapInstruction(Instruction *I, ValueToValueMapTy &amp;VM, RemapFlags Flags=RF_None, ValueMapTypeRemapper *TypeMapper=nullptr, ValueMaterializer *Materializer=nullptr)</div><div class="ttdoc">Convert the instruction operands from referencing the current values into those specified by VM.</div><div class="ttdef"><b>Definition:</b> <a href="ValueMapper_8h_source.html#l00254">ValueMapper.h:254</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1RegionInfoAnalysis_html"><div class="ttname"><a href="classllvm_1_1RegionInfoAnalysis.html">llvm::RegionInfoAnalysis</a></div><div class="ttdoc">Analysis pass that exposes the RegionInfo for a function.</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00967">RegionInfo.h:967</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_aa849347ff04d0eca6ce4fc70cada49d5"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#aa849347ff04d0eca6ce4fc70cada49d5">hoistScopeConditions</a></div><div class="ttdeci">static void hoistScopeConditions(CHRScope *Scope, Instruction *HoistPoint, DenseSet&lt; PHINode * &gt; &amp;TrivialPHIs, DominatorTree &amp;DT)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01481">ControlHeightReduction.cpp:1481</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_af10d0fccdcb58cbd2e3932e630d24dfa"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#af10d0fccdcb58cbd2e3932e630d24dfa">checkBiasedBranch</a></div><div class="ttdeci">static bool checkBiasedBranch(BranchInst *BI, Region *R, DenseSet&lt; Region * &gt; &amp;TrueBiasedRegionsGlobal, DenseSet&lt; Region * &gt; &amp;FalseBiasedRegionsGlobal, DenseMap&lt; Region *, BranchProbability &gt; &amp;BranchBiasMap)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00630">ControlHeightReduction.cpp:630</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">llvm::ms_demangle::QualifierMangleMode::Result</a></div><div class="ttdeci">@ Result</div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1PALMD_html_af892c75285b0f64d58ca76cb73059adf"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">llvm::AMDGPU::PALMD::Key</a></div><div class="ttdeci">Key</div><div class="ttdoc">PAL metadata keys.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00486">AMDGPUMetadata.h:486</a></div></div>
<div class="ttc" id="aDenseSet_8h_html"><div class="ttname"><a href="DenseSet_8h.html">DenseSet.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a3505dab06f59c36142a234321cdc3411"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a3505dab06f59c36142a234321cdc3411">llvm::BranchInst::setCondition</a></div><div class="ttdeci">void setCondition(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03225">Instructions.h:3225</a></div></div>
<div class="ttc" id="aMDBuilder_8h_html"><div class="ttname"><a href="MDBuilder_8h.html">MDBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a72516971c5734dc0f7546e64affca425"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">llvm::BasicBlock::phis</a></div><div class="ttdeci">iterator_range&lt; const_phi_iterator &gt; phis() const</div><div class="ttdoc">Returns a range that iterates over the phis in the basic block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00372">BasicBlock.h:372</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a900b2c8e3cfb38b08d34d78386308dcb"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a900b2c8e3cfb38b08d34d78386308dcb">operator&lt;&lt;</a></div><div class="ttdeci">static raw_ostream LLVM_ATTRIBUTE_UNUSED &amp; operator&lt;&lt;(raw_ostream &amp;OS, const CHRStats &amp;Stats)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00402">ControlHeightReduction.cpp:402</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00052">raw_ostream.h:52</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a8acf25125313b0e6333bb7fa3f4404f6"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a8acf25125313b0e6333bb7fa3f4404f6">dumpIR</a></div><div class="ttdeci">static void LLVM_ATTRIBUTE_UNUSED dumpIR(Function &amp;F, const char *Label, CHRStats *Stats)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00430">ControlHeightReduction.cpp:430</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_ad0b3d8447f88377b62d9c019f3c4e118"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#ad0b3d8447f88377b62d9c019f3c4e118">llvm::SmallVectorImpl::resize</a></div><div class="ttdeci">void resize(size_type N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00642">SmallVector.h:642</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_acda14ede9da471244980c7fada91a4aa"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#acda14ede9da471244980c7fada91a4aa">negateICmpIfUsedByBranchOrSelectOnly</a></div><div class="ttdeci">static bool negateICmpIfUsedByBranchOrSelectOnly(ICmpInst *ICmp, Instruction *ExcludedUser, CHRScope *Scope)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01507">ControlHeightReduction.cpp:1507</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_a860d2c073855bc32dc6d517bc6fc706c"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#a860d2c073855bc32dc6d517bc6fc706c">Duplication</a></div><div class="ttdeci">http eax xorl edx cl sete al setne dl sall eax sall edx But that requires good bit subreg support this might be better It s an extra but it s one instruction and doesn t stress bit subreg eax eax movl edx edx sall eax sall cl edx bit we should expand to a conditional branch like GCC produces Some isel Duplication</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00051">README.txt:51</a></div></div>
<div class="ttc" id="aTransforms_2Utils_8h_html"><div class="ttname"><a href="Transforms_2Utils_8h.html">Utils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyAnalysis_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyAnalysis.html">llvm::BlockFrequencyAnalysis</a></div><div class="ttdoc">Analysis pass which computes BlockFrequencyInfo.</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00112">BlockFrequencyInfo.h:112</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_aff85944087fc349e227e8b737179cb3e"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#aff85944087fc349e227e8b737179cb3e">parseCHRFilterFiles</a></div><div class="ttdeci">static void parseCHRFilterFiles()</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00081">ControlHeightReduction.cpp:81</a></div></div>
<div class="ttc" id="anamespacellvm_html_a77724415203930efd07d7098cb1e437da9a24bd8dba1bef2753bc3f087435ae7f"><div class="ttname"><a href="namespacellvm.html#a77724415203930efd07d7098cb1e437da9a24bd8dba1bef2753bc3f087435ae7f">llvm::RF_NoModuleLevelChanges</a></div><div class="ttdeci">@ RF_NoModuleLevelChanges</div><div class="ttdoc">If this flag is set, the remapper knows that only local values within a function (such as an instruct...</div><div class="ttdef"><b>Definition:</b> <a href="ValueMapper_8h_source.html#l00071">ValueMapper.h:71</a></div></div>
<div class="ttc" id="aBranchProbability_8h_html"><div class="ttname"><a href="BranchProbability_8h.html">BranchProbability.h</a></div></div>
<div class="ttc" id="aControlHeightReduction_8h_html"><div class="ttname"><a href="ControlHeightReduction_8h.html">ControlHeightReduction.h</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a3f3c0ac0dc88d578aba34d48efdd3746"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a3f3c0ac0dc88d578aba34d48efdd3746">isHoistable</a></div><div class="ttdeci">static bool isHoistable(Instruction *I, DominatorTree &amp;DT)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00479">ControlHeightReduction.cpp:479</a></div></div>
<div class="ttc" id="aIR_2CFG_8h_html"><div class="ttname"><a href="IR_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dxil_1_1PointerTypeAnalysis_html_ae574a4c1d84b9e67bc94489f356805b4"><div class="ttname"><a href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">llvm::dxil::PointerTypeAnalysis::run</a></div><div class="ttdeci">PointerTypeMap run(const Module &amp;M)</div><div class="ttdoc">Compute the PointerTypeMap for the module M.</div><div class="ttdef"><b>Definition:</b> <a href="PointerTypeAnalysis_8cpp_source.html#l00189">PointerTypeAnalysis.cpp:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionNode_html"><div class="ttname"><a href="classllvm_1_1RegionNode.html">llvm::RegionNode</a></div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00879">RegionInfo.h:879</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html">llvm::ProfileSummaryInfo</a></div><div class="ttdoc">Analysis providing profile information.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00040">ProfileSummaryInfo.h:40</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a5408546ea035fa812e126beb843fdbb7"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a5408546ea035fa812e126beb843fdbb7">checkBias</a></div><div class="ttdeci">static bool checkBias(K *Key, BranchProbability TrueProb, BranchProbability FalseProb, S &amp;TrueSet, S &amp;FalseSet, M &amp;BiasMap)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00612">ControlHeightReduction.cpp:612</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseSet_html"><div class="ttname"><a href="classllvm_1_1DenseSet.html">llvm::DenseSet</a></div><div class="ttdoc">Implements a dense probed hash-table based set.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00268">DenseSet.h:268</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a071886a7b42adae6a171e653e04bd216"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a071886a7b42adae6a171e653e04bd216">insertTrivialPHIs</a></div><div class="ttdeci">static void insertTrivialPHIs(CHRScope *Scope, BasicBlock *EntryBlock, BasicBlock *ExitBlock, DenseSet&lt; PHINode * &gt; &amp;TrivialPHIs)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01556">ControlHeightReduction.cpp:1556</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6befe133f42d6a8e07ba98372d7f9c60"><div class="ttname"><a href="namespacellvm.html#a6befe133f42d6a8e07ba98372d7f9c60">llvm::CloneBasicBlock</a></div><div class="ttdeci">BasicBlock * CloneBasicBlock(const BasicBlock *BB, ValueToValueMapTy &amp;VMap, const Twine &amp;NameSuffix=&quot;&quot;, Function *F=nullptr, ClonedCodeInfo *CodeInfo=nullptr, DebugInfoFinder *DIFinder=nullptr)</div><div class="ttdoc">Return a copy of the specified basic block, but without embedding the block into a particular functio...</div><div class="ttdef"><b>Definition:</b> <a href="CloneFunction_8cpp_source.html#l00042">CloneFunction.cpp:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a90c9f20715929cbe06c523bf8546c38ba48b26d57c14af0500090800c2cdd0d58"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a90c9f20715929cbe06c523bf8546c38ba48b26d57c14af0500090800c2cdd0d58">llvm::logicalview::LVCompareKind::Scopes</a></div><div class="ttdeci">@ Scopes</div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html"><div class="ttname"><a href="classllvm_1_1ICmpInst.html">llvm::ICmpInst</a></div><div class="ttdoc">This instruction compares its operands according to the predicate given to the constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01197">Instructions.h:1197</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_ad7c6ec0efac7bf1cda1e2f0db908ccd4"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#ad7c6ec0efac7bf1cda1e2f0db908ccd4">CHRDupThreshsold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; CHRDupThreshsold(&quot;chr-dup-threshold&quot;, cl::init(3), cl::Hidden, cl::desc(&quot;Max number of duplications by CHR for a region&quot;))</div></div>
<div class="ttc" id="aProfileSummaryInfo_8h_html"><div class="ttname"><a href="ProfileSummaryInfo_8h.html">ProfileSummaryInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a36c36190d483bb765415014f3036de87"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a36c36190d483bb765415014f3036de87">llvm::RegionBase::getEntry</a></div><div class="ttdeci">BlockT * getEntry() const</div><div class="ttdoc">Get the entry BasicBlock of the Region.</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00322">RegionInfo.h:322</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a28a73b23a3e5378915406237983a2240"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a28a73b23a3e5378915406237983a2240">CHRScopeSorter</a></div><div class="ttdeci">static bool CHRScopeSorter(CHRScope *Scope1, CHRScope *Scope2)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01420">ControlHeightReduction.cpp:1420</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a4bd77853df82f4643859aa72ec33b2c0"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a4bd77853df82f4643859aa72ec33b2c0">shouldSplit</a></div><div class="ttdeci">static bool shouldSplit(Instruction *InsertPoint, DenseSet&lt; Value * &gt; &amp;PrevConditionValues, DenseSet&lt; Value * &gt; &amp;ConditionValues, DominatorTree &amp;DT, DenseSet&lt; Instruction * &gt; &amp;Unhoistables)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01044">ControlHeightReduction.cpp:1044</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="aProfDataUtils_8h_html"><div class="ttname"><a href="ProfDataUtils_8h.html">ProfDataUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aCloning_8h_html"><div class="ttname"><a href="Cloning_8h.html">Cloning.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a32203e7352f128904822ee859e9ae839"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a32203e7352f128904822ee859e9ae839">checkHoistValue</a></div><div class="ttdeci">static bool checkHoistValue(Value *V, Instruction *InsertPoint, DominatorTree &amp;DT, DenseSet&lt; Instruction * &gt; &amp;Unhoistables, DenseSet&lt; Instruction * &gt; *HoistStops, DenseMap&lt; Instruction *, bool &gt; &amp;Visited)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00527">ControlHeightReduction.cpp:527</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_ad36fda9d8203a5374fcb76941423c400"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#ad36fda9d8203a5374fcb76941423c400">assertBranchOrSelectConditionHoisted</a></div><div class="ttdeci">static void LLVM_ATTRIBUTE_UNUSED assertBranchOrSelectConditionHoisted(CHRScope *Scope, BasicBlock *PreEntryBlock)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01640">ControlHeightReduction.cpp:1640</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_ad7dc7318244359268414719e0959346e"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#ad7dc7318244359268414719e0959346e">llvm::detail::DenseSetImpl::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00173">DenseSet.h:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a14106e69b117dcbd5a7573af62d1cbeb"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a14106e69b117dcbd5a7573af62d1cbeb">DisableCHR</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableCHR(&quot;disable-chr&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Disable CHR for all functions&quot;))</div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a99011b332a9be6ee52906fa398be35e2"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a99011b332a9be6ee52906fa398be35e2">ForceCHR</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ForceCHR(&quot;force-chr&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Apply CHR for all functions&quot;))</div></div>
<div class="ttc" id="aRegionIterator_8h_html"><div class="ttname"><a href="RegionIterator_8h.html">RegionIterator.h</a></div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aInstructionSimplify_8cpp_html_adb39181b87dffcd61082d08e02bf314e"><div class="ttname"><a href="InstructionSimplify_8cpp.html#adb39181b87dffcd61082d08e02bf314e">getFalse</a></div><div class="ttdeci">static Constant * getFalse(Type *Ty)</div><div class="ttdoc">For a boolean type or a vector of boolean type, return false or a vector with every element false.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l00122">InstructionSimplify.cpp:122</a></div></div>
<div class="ttc" id="astructModuleName_html"><div class="ttname"><a href="structModuleName.html">ModuleName</a></div><div class="ttdef"><b>Definition:</b> <a href="ItaniumDemangle_8h_source.html#l00999">ItaniumDemangle.h:999</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="aclassllvm_1_1ControlHeightReductionPass_html_a8a2445471971f0f43e0454d57dca56e9"><div class="ttname"><a href="classllvm_1_1ControlHeightReductionPass.html#a8a2445471971f0f43e0454d57dca56e9">llvm::ControlHeightReductionPass::ControlHeightReductionPass</a></div><div class="ttdeci">ControlHeightReductionPass()</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l02076">ControlHeightReduction.cpp:2076</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad56f6a9b5cd05940017c4544df48bc30"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad56f6a9b5cd05940017c4544df48bc30">llvm::BranchInst::isUnconditional</a></div><div class="ttdeci">bool isUnconditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03217">Instructions.h:3217</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a1fbf4d66a9eeaa9ade03e8febee097ee"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a1fbf4d66a9eeaa9ade03e8febee097ee">llvm::detail::DenseSetImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00092">DenseSet.h:92</a></div></div>
<div class="ttc" id="anamespacellvm_html_a67980a8ae101d2fda845eb750ffb1942"><div class="ttname"><a href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">llvm::print</a></div><div class="ttdeci">Printable print(const GCNRegPressure &amp;RP, const GCNSubtarget *ST=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="GCNRegPressure_8cpp_source.html#l00138">GCNRegPressure.cpp:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryAnalysis_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryAnalysis.html">llvm::ProfileSummaryAnalysis</a></div><div class="ttdoc">An analysis pass based on the new PM to deliver ProfileSummaryInfo.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00212">ProfileSummaryInfo.h:212</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringSet_html"><div class="ttname"><a href="classllvm_1_1StringSet.html">llvm::StringSet</a></div><div class="ttdoc">StringSet - A wrapper for StringMap that provides set-like functionality.</div><div class="ttdef"><b>Definition:</b> <a href="StringSet_8h_source.html#l00023">StringSet.h:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1jitlink_html_adb322dc6826cf005531ccfdf666260fd"><div class="ttname"><a href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">llvm::jitlink::Scope</a></div><div class="ttdeci">Scope</div><div class="ttdoc">Defines the scope in which this symbol should be visible: Default – Visible in the public interface o...</div><div class="ttdef"><b>Definition:</b> <a href="JITLink_8h_source.html#l00384">JITLink.h:384</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitterAnalysis_html_a82def85e95d702c5c226841c3d8205b8"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html#a82def85e95d702c5c226841c3d8205b8">llvm::OptimizationRemarkEmitterAnalysis::run</a></div><div class="ttdeci">Result run(Function &amp;F, FunctionAnalysisManager &amp;AM)</div><div class="ttdoc">Run the analysis pass over a function and produce BFI.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00129">OptimizationRemarkEmitter.cpp:129</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_ad409c2de8502b94c8a0b1193307c63b6"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">llvm::detail::DenseSetImpl::contains</a></div><div class="ttdeci">bool contains(const_arg_type_t&lt; ValueT &gt; V) const</div><div class="ttdoc">Check if the set contains the given element.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00185">DenseSet.h:185</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchProbability_html"><div class="ttname"><a href="classllvm_1_1BranchProbability.html">llvm::BranchProbability</a></div><div class="ttdef"><b>Definition:</b> <a href="BranchProbability_8h_source.html#l00030">BranchProbability.h:30</a></div></div>
<div class="ttc" id="anamespacellvm_html_a39d3d23a084c4544ee5903203db10e8a"><div class="ttname"><a href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a></div><div class="ttdeci">void append_range(Container &amp;C, Range &amp;&amp;R)</div><div class="ttdoc">Wrapper function to append a range to a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l02014">STLExtras.h:2014</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a845d59a9cee6653b5c607b317afae153"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a845d59a9cee6653b5c607b317afae153">CHR_DEBUG</a></div><div class="ttdeci">#define CHR_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00050">ControlHeightReduction.cpp:50</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionInfo_html"><div class="ttname"><a href="classllvm_1_1RegionInfo.html">llvm::RegionInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00900">RegionInfo.h:900</a></div></div>
<div class="ttc" id="aBlockFrequencyInfo_8h_html"><div class="ttname"><a href="BlockFrequencyInfo_8h.html">BlockFrequencyInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPUISD_html_a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996"><div class="ttname"><a href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">llvm::AMDGPUISD::BFI</a></div><div class="ttdeci">@ BFI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUISelLowering_8h_source.html#l00441">AMDGPUISelLowering.h:441</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1ValueMap_html"><div class="ttname"><a href="classllvm_1_1ValueMap.html">llvm::ValueMap&lt; const Value *, WeakTrackingVH &gt;</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac78c09ae232b2ce188ff590d51e3c268"><div class="ttname"><a href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">llvm::find_if</a></div><div class="ttdeci">auto find_if(R &amp;&amp;Range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::find_if which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01762">STLExtras.h:1762</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab706e7ebb1969c5e34f28bfcf2ff719e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">llvm::BasicBlock::front</a></div><div class="ttdeci">const Instruction &amp; front() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00326">BasicBlock.h:326</a></div></div>
<div class="ttc" id="anamespacellvm_html_a77724415203930efd07d7098cb1e437da5633028bc27ffa8eab39cc5de65b3108"><div class="ttname"><a href="namespacellvm.html#a77724415203930efd07d7098cb1e437da5633028bc27ffa8eab39cc5de65b3108">llvm::RF_IgnoreMissingLocals</a></div><div class="ttdeci">@ RF_IgnoreMissingLocals</div><div class="ttdoc">If this flag is set, the remapper ignores missing function-local entries (Argument,...</div><div class="ttdef"><b>Definition:</b> <a href="ValueMapper_8h_source.html#l00089">ValueMapper.h:89</a></div></div>
<div class="ttc" id="aStringSet_8h_html"><div class="ttname"><a href="StringSet_8h.html">StringSet.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a076f93c387f454f0db13d4bc7d4e7f9c"><div class="ttname"><a href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a></div><div class="ttdeci">void stable_sort(R &amp;&amp;Range)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01948">STLExtras.h:1948</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_abb56ce74e047a983c8550d39bc817a58"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#abb56ce74e047a983c8550d39bc817a58">getCHRConditionValuesForRegion</a></div><div class="ttdeci">static DenseSet&lt; Value * &gt; getCHRConditionValuesForRegion(RegInfo &amp;RI)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01025">ControlHeightReduction.cpp:1025</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_ace1af9c851fd3ff6b2354fdd1967c303"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#ace1af9c851fd3ff6b2354fdd1967c303">CHRModuleList</a></div><div class="ttdeci">static cl::opt&lt; std::string &gt; CHRModuleList(&quot;chr-module-list&quot;, cl::init(&quot;&quot;), cl::Hidden, cl::desc(&quot;Specify file to retrieve the list of modules to apply CHR to&quot;))</div></div>
<div class="ttc" id="aMachineBlockPlacement_8cpp_html_a086f939e29b718dc5a01e4bcfe6af2a1"><div class="ttname"><a href="MachineBlockPlacement_8cpp.html#a086f939e29b718dc5a01e4bcfe6af2a1">Stats</a></div><div class="ttdeci">block placement Basic Block Placement Stats</div><div class="ttdef"><b>Definition:</b> <a href="MachineBlockPlacement_8cpp_source.html#l03669">MachineBlockPlacement.cpp:3669</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a23f4fd9c646569c76800ac898a8e3517"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a23f4fd9c646569c76800ac898a8e3517">llvm::IRBuilderBase::CreateFreeze</a></div><div class="ttdeci">Value * CreateFreeze(Value *V, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02416">IRBuilder.h:2416</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">llvm::MCID::Branch</a></div><div class="ttdeci">@ Branch</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00159">MCInstrDesc.h:159</a></div></div>
<div class="ttc" id="aPassManager_8h_html"><div class="ttname"><a href="PassManager_8h.html">PassManager.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a736d34433c1ecf86e5649d44ea701ad5"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a736d34433c1ecf86e5649d44ea701ad5">llvm::RegionBase::replaceEntryRecursive</a></div><div class="ttdeci">void replaceEntryRecursive(BlockT *NewEntry)</div><div class="ttdoc">Recursively replace the entry basic block of the region.</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfoImpl_8h_source.html#l00066">RegionInfoImpl.h:66</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a2881475f3f9e1db0f814ff65d7c44e8e"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a2881475f3f9e1db0f814ff65d7c44e8e">CHRBiasThreshold</a></div><div class="ttdeci">static cl::opt&lt; double &gt; CHRBiasThreshold(&quot;chr-bias-threshold&quot;, cl::init(0.99), cl::Hidden, cl::desc(&quot;CHR considers a branch bias greater than this ratio as biased&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1ValueMap_html_a7629b8c5f6a6802ee0fdc5c290769692"><div class="ttname"><a href="classllvm_1_1ValueMap.html#a7629b8c5f6a6802ee0fdc5c290769692">llvm::ValueMap::find</a></div><div class="ttdeci">iterator find(const KeyT &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="ValueMap_8h_source.html#l00155">ValueMap.h:155</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_afb9349865f6045be3029d7d171f23f4e"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#afb9349865f6045be3029d7d171f23f4e">extractBranchProbabilities</a></div><div class="ttdeci">static bool extractBranchProbabilities(Instruction *I, BranchProbability &amp;TrueProb, BranchProbability &amp;FalseProb)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00581">ControlHeightReduction.cpp:581</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_ae1b005e1a73fa20d7b1edcdae3e40961"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#ae1b005e1a73fa20d7b1edcdae3e40961">dumpScopes</a></div><div class="ttdeci">static void LLVM_ATTRIBUTE_UNUSED dumpScopes(SmallVectorImpl&lt; CHRScope * &gt; &amp;Scopes, const char *Label)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01990">ControlHeightReduction.cpp:1990</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a75479f44e7157d1a8592231addb67c9c"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a75479f44e7157d1a8592231addb67c9c">llvm::RegionBase::contains</a></div><div class="ttdeci">bool contains(const BlockT *BB) const</div><div class="ttdoc">Check if the region contains a BasicBlock.</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfoImpl_8h_source.html#l00102">RegionInfoImpl.h:102</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringMap_html_a9846bb2bc5672e7627011260772b8d09"><div class="ttname"><a href="classllvm_1_1StringMap.html#a9846bb2bc5672e7627011260772b8d09">llvm::StringMap::count</a></div><div class="ttdeci">size_type count(StringRef Key) const</div><div class="ttdoc">count - Return 1 if the element is in the map, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2StringMap_8h_source.html#l00245">StringMap.h:245</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a126a12b67fa620ad28ec0c919ca7a3e8"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a126a12b67fa620ad28ec0c919ca7a3e8">llvm::CmpInst::setPredicate</a></div><div class="ttdeci">void setPredicate(Predicate P)</div><div class="ttdoc">Set the predicate for this instruction to the specified value.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00811">InstrTypes.h:811</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_ad90b565f38c7ef3477c8ceb0bef3976d"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#ad90b565f38c7ef3477c8ceb0bef3976d">assertCHRRegionsHaveBiasedBranchOrSelect</a></div><div class="ttdeci">static void LLVM_ATTRIBUTE_UNUSED assertCHRRegionsHaveBiasedBranchOrSelect(CHRScope *Scope)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l01619">ControlHeightReduction.cpp:1619</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDBuilder_html"><div class="ttname"><a href="classllvm_1_1MDBuilder.html">llvm::MDBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="MDBuilder_8h_source.html#l00036">MDBuilder.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeAnalysis_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeAnalysis.html">llvm::DominatorTreeAnalysis</a></div><div class="ttdoc">Analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00279">Dominators.h:279</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_ae1d4736e8dfc615fad673c393a757127"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#ae1d4736e8dfc615fad673c393a757127">getCHRBiasThreshold</a></div><div class="ttdeci">static BranchProbability getCHRBiasThreshold()</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00602">ControlHeightReduction.cpp:602</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_a809aa08f1d799a5ed298e68bd3fac0c7"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#a809aa08f1d799a5ed298e68bd3fac0c7">exit</a></div><div class="ttdeci">declare void exit(i32) noreturn nounwind This compiles into</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l01072">README.txt:1072</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aInstructionSimplify_8cpp_html_a565dd825f238fa0a8c4bbfe562635f7c"><div class="ttname"><a href="InstructionSimplify_8cpp.html#a565dd825f238fa0a8c4bbfe562635f7c">getTrue</a></div><div class="ttdeci">static Constant * getTrue(Type *Ty)</div><div class="ttdoc">For a boolean type or a vector of boolean type, return true or a vector with every element true.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l00126">InstructionSimplify.cpp:126</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_aa7414ba9f658ff1287d22a4b8fe81bcb"><div class="ttname"><a href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const</div><div class="ttdoc">Return the predicate for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00808">InstrTypes.h:808</a></div></div>
<div class="ttc" id="aIVUsers_8cpp_html_a4e5b9edb51eec9dbca592075eb64dfcb"><div class="ttname"><a href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a></div><div class="ttdeci">iv Induction Variable Users</div><div class="ttdef"><b>Definition:</b> <a href="IVUsers_8cpp_source.html#l00048">IVUsers.cpp:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_aa9216799cee3b3000ce6714aac1c1c7e"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#aa9216799cee3b3000ce6714aac1c1c7e">isHoistableInstructionType</a></div><div class="ttdeci">static bool isHoistableInstructionType(Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00470">ControlHeightReduction.cpp:470</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_af972d87e15b5f6ed61bd5c3956c5213d"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#af972d87e15b5f6ed61bd5c3956c5213d">llvm::detail::DenseSetImpl::erase</a></div><div class="ttdeci">bool erase(const ValueT &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00101">DenseSet.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdoc">This class consists of common code factored out of the SmallVector class to reduce code duplication b...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00042">APFloat.h:42</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae6d1c31d74bbaaa9e42bcbdc10a499f2"><div class="ttname"><a href="namespacellvm.html#ae6d1c31d74bbaaa9e42bcbdc10a499f2">llvm::pred_size</a></div><div class="ttdeci">unsigned pred_size(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineSSAContext_8h_source.html#l00032">MachineSSAContext.h:32</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00048">ControlHeightReduction.cpp:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSetVector_html"><div class="ttname"><a href="classllvm_1_1SmallSetVector.html">llvm::SmallSetVector</a></div><div class="ttdoc">A SetVector that performs no allocations if smaller than a certain size.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00300">SetVector.h:300</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac19cbbc4935a23e1d44f65e1eaba6b1d"><div class="ttname"><a href="namespacellvm.html#ac19cbbc4935a23e1d44f65e1eaba6b1d">llvm::extractBranchWeights</a></div><div class="ttdeci">bool extractBranchWeights(const MDNode *ProfileData, SmallVectorImpl&lt; uint32_t &gt; &amp;Weights)</div><div class="ttdoc">Extract branch weights from MD_prof metadata.</div><div class="ttdef"><b>Definition:</b> <a href="ProfDataUtils_8cpp_source.html#l00122">ProfDataUtils.cpp:122</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">llvm::CallingConv::Tail</a></div><div class="ttdeci">@ Tail</div><div class="ttdoc">Attemps to make calls as fast as possible while guaranteeing that tail call optimization can always b...</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00076">CallingConv.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_1_1ProfileCount_html"><div class="ttname"><a href="classllvm_1_1Function_1_1ProfileCount.html">llvm::Function::ProfileCount</a></div><div class="ttdoc">Class to represent profile counts.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00252">Function.h:252</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_a7cf6fe605431375e61c307bb1ca5cf41"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#a7cf6fe605431375e61c307bb1ca5cf41">shouldApply</a></div><div class="ttdeci">static bool shouldApply(Function &amp;F, ProfileSummaryInfo &amp;PSI)</div><div class="ttdef"><b>Definition:</b> <a href="ControlHeightReduction_8cpp_source.html#l00414">ControlHeightReduction.cpp:414</a></div></div>
<div class="ttc" id="aclassllvm_1_1Region_html"><div class="ttname"><a href="classllvm_1_1Region.html">llvm::Region</a></div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00889">RegionInfo.h:889</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad295cb34421c21507bc9cdefe1ba3f16"><div class="ttname"><a href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">llvm::SplitBlock</a></div><div class="ttdeci">BasicBlock * SplitBlock(BasicBlock *Old, Instruction *SplitPt, DominatorTree *DT, LoopInfo *LI=nullptr, MemorySSAUpdater *MSSAU=nullptr, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the specified block at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00935">BasicBlockUtils.cpp:935</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a1e4d2a9707cc6d2a71a1ffea59516ad5"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a1e4d2a9707cc6d2a71a1ffea59516ad5">llvm::RegionBase::getExit</a></div><div class="ttdeci">BlockT * getExit() const</div><div class="ttdoc">Get the exit BasicBlock of the Region.</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00359">RegionInfo.h:359</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitterAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">llvm::OptimizationRemarkEmitterAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00164">OptimizationRemarkEmitter.h:164</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a6414735714bdbd5c8790f32a0fe99bd2"><div class="ttname"><a href="classllvm_1_1StringRef.html#a6414735714bdbd5c8790f32a0fe99bd2">llvm::StringRef::split</a></div><div class="ttdeci">std::pair&lt; StringRef, StringRef &gt; split(char Separator) const</div><div class="ttdoc">Split into two substrings around the first occurrence of a separator character.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00688">StringRef.h:688</a></div></div>
<div class="ttc" id="anamespacellvm_html_abe76d72cda6b2b4562c72accb510040b"><div class="ttname"><a href="namespacellvm.html#abe76d72cda6b2b4562c72accb510040b">llvm::isSafeToSpeculativelyExecute</a></div><div class="ttdeci">bool isSafeToSpeculativelyExecute(const Instruction *I, const Instruction *CtxI=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if the instruction does not have any effects besides calculating the result and does not ...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04799">ValueTracking.cpp:4799</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aControlHeightReduction_8cpp_html_aa47a194a72a51014b9c0aa614683ee0d"><div class="ttname"><a href="ControlHeightReduction_8cpp.html#aa47a194a72a51014b9c0aa614683ee0d">CHRFunctionList</a></div><div class="ttdeci">static cl::opt&lt; std::string &gt; CHRFunctionList(&quot;chr-function-list&quot;, cl::init(&quot;&quot;), cl::Hidden, cl::desc(&quot;Specify file to retrieve the list of functions to apply CHR to&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a7e4be8b16fbd68c9045a388904044e01"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03218">Instructions.h:3218</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad97f2e60cf22f15e0cf617af52309031"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03232">Instructions.h:3232</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegionBase_html_a001c71505d9c3f8d39aed9227a0a6e74"><div class="ttname"><a href="classllvm_1_1RegionBase.html#a001c71505d9c3f8d39aed9227a0a6e74">llvm::RegionBase::getParent</a></div><div class="ttdeci">RegionT * getParent() const</div><div class="ttdoc">Get the parent of the Region.</div><div class="ttdef"><b>Definition:</b> <a href="RegionInfo_8h_source.html#l00364">RegionInfo.h:364</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:24:12 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
