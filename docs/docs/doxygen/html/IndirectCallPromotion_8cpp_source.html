<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Instrumentation/IndirectCallPromotion.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_f844fca3b2393802daa002d01dc8623e.html">Instrumentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">IndirectCallPromotion.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="IndirectCallPromotion_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- IndirectCallPromotion.cpp - Optimizations based on value profiling -===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements the transformation that promotes indirect calls to</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// conditional direct calls when the indirect-call value profile metadata is</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// available.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ArrayRef_8h.html">llvm/ADT/ArrayRef.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IndirectCallPromotionAnalysis_8h.html">llvm/Analysis/IndirectCallPromotionAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IndirectCallVisitor_8h.html">llvm/Analysis/IndirectCallVisitor.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProfileSummaryInfo_8h.html">llvm/Analysis/ProfileSummaryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DiagnosticInfo_8h.html">llvm/IR/DiagnosticInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MDBuilder_8h.html">llvm/IR/MDBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PassManager_8h.html">llvm/IR/PassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstrProf_8h.html">llvm/ProfileData/InstrProf.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2Error_8h.html">llvm/Support/Error.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instrumentation_8h.html">llvm/Transforms/Instrumentation.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PGOInstrumentation_8h.html">llvm/Transforms/Instrumentation/PGOInstrumentation.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallPromotionUtils_8h.html">llvm/Transforms/Utils/CallPromotionUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   48</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;pgo-icall-prom&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOfPGOICallPromotion, <span class="stringliteral">&quot;Number of indirect call promotions.&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumOfPGOICallsites, <span class="stringliteral">&quot;Number of indirect call candidate sites.&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// Command line option to disable indirect-call promotion with the default as</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// false. This is for debug purpose.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="IndirectCallPromotion_8cpp.html#a197a657d7baca10b5f9206ab9533d6d4">DisableICP</a>(<span class="stringliteral">&quot;disable-icp&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable indirect call promotion&quot;</span>));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// Set the cutoff value for the promotion. If the value is other than 0, we</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// stop the transformation once the total number of promotions equals the cutoff</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// value.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// For debug use only.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="IndirectCallPromotion_8cpp.html#a29c2334c5a10304d0f345c5aac7887c8">ICPCutOff</a>(<span class="stringliteral">&quot;icp-cutoff&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;              <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Max number of promotions for this compilation&quot;</span>));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">// If ICPCSSkip is non zero, the first ICPCSSkip callsites will be skipped.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// For debug use only.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="IndirectCallPromotion_8cpp.html#a536c64cb42544e3105204c84856201a9">ICPCSSkip</a>(<span class="stringliteral">&quot;icp-csskip&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;              <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Skip Callsite up to this number for this compilation&quot;</span>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">// Set if the pass is called in LTO optimization. The difference for LTO mode</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// is the pass won&#39;t prefix the source module name to the internal linkage</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// symbols.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="IndirectCallPromotion_8cpp.html#af4bbe64c7a01b2af7c40d0b353abaee5">ICPLTOMode</a>(<span class="stringliteral">&quot;icp-lto&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Run indirect-call promotion in LTO &quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                         <span class="stringliteral">&quot;mode&quot;</span>));</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// Set if the pass is called in SamplePGO mode. The difference for SamplePGO</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// mode is it will add prof metadatato the created direct call.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="IndirectCallPromotion_8cpp.html#a80041d58a2f3b65b5ec597fffedb1d72">ICPSamplePGOMode</a>(<span class="stringliteral">&quot;icp-samplepgo&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                     <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Run indirect-call promotion in SamplePGO mode&quot;</span>));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">// If the option is set to true, only call instructions will be considered for</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// transformation -- invoke instructions will be ignored.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="IndirectCallPromotion_8cpp.html#a47f5070dfb594c28811032551db7d159">ICPCallOnly</a>(<span class="stringliteral">&quot;icp-call-only&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Run indirect-call promotion for call instructions &quot;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                         <span class="stringliteral">&quot;only&quot;</span>));</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// If the option is set to true, only invoke instructions will be considered for</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// transformation -- call instructions will be ignored.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="IndirectCallPromotion_8cpp.html#a9dbb4173df66fc2d83a50513455c0c63">ICPInvokeOnly</a>(<span class="stringliteral">&quot;icp-invoke-only&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                   <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                   <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Run indirect-call promotion for &quot;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                            <span class="stringliteral">&quot;invoke instruction only&quot;</span>));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// Dump the function level IR if the transformation happened in this</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// function. For debug use only.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="IndirectCallPromotion_8cpp.html#afa78e8b533e056ee55ef29afec061c3d">ICPDUMPAFTER</a>(<span class="stringliteral">&quot;icp-dumpafter&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                 <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Dump IR after transformation happens&quot;</span>));</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// The class for main data structure to promote indirect calls to conditional</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">// direct calls.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">class </span>ICallPromotionFunc {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// Symtab that maps indirect call profile values to function names and</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// defines.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="classllvm_1_1InstrProfSymtab.html">InstrProfSymtab</a> *Symtab;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">bool</span> SamplePGO;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// A struct that records the direct target and it&#39;s call count.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">struct </span>PromotionCandidate {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *TargetFunction;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Count;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    PromotionCandidate(<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) : TargetFunction(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>), Count(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {}</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  };</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// Check if the indirect-call call site should be promoted. Return the number</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// of promotions. Inst is the candidate indirect call, ValueDataRef</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// contains the array of value profile data for profiled targets,</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// TotalCount is the total profiled count of call executions, and</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// NumCandidates is the number of candidate entries in ValueDataRef.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  std::vector&lt;PromotionCandidate&gt; getPromotionCandidatesForCallSite(</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;InstrProfValueData&gt;</a> &amp;ValueDataRef,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TotalCount, <a class="code" href="classuint32__t.html">uint32_t</a> NumCandidates);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// Promote a list of targets for one indirect-call callsite. Return</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// the number of promotions.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classuint32__t.html">uint32_t</a> tryToPromote(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                        <span class="keyword">const</span> std::vector&lt;PromotionCandidate&gt; &amp;Candidates,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> &amp;TotalCount);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  ICallPromotionFunc(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Func, <a class="code" href="classllvm_1_1Module.html">Module</a> *Modu, <a class="code" href="classllvm_1_1InstrProfSymtab.html">InstrProfSymtab</a> *Symtab,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                     <span class="keywordtype">bool</span> SamplePGO, <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(<a class="code" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>(Modu), Symtab(Symtab), SamplePGO(SamplePGO), ORE(ORE) {}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  ICallPromotionFunc(<span class="keyword">const</span> ICallPromotionFunc &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  ICallPromotionFunc &amp;operator=(<span class="keyword">const</span> ICallPromotionFunc &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">bool</span> processFunction(<a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;};</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">// Indirect-call promotion heuristic. The direct targets are sorted based on</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// the count. Stop at the first target that is not promoted.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;std::vector&lt;ICallPromotionFunc::PromotionCandidate&gt;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;ICallPromotionFunc::getPromotionCandidatesForCallSite(</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;InstrProfValueData&gt;</a> &amp;ValueDataRef,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TotalCount, <a class="code" href="classuint32__t.html">uint32_t</a> NumCandidates) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  std::vector&lt;PromotionCandidate&gt; <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; \nWork on callsite #&quot;</span> &lt;&lt; NumOfPGOICallsites &lt;&lt; CB</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; Num_targets: &quot;</span> &lt;&lt; ValueDataRef.<a class="code" href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>()</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; Num_candidates: &quot;</span> &lt;&lt; NumCandidates &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  NumOfPGOICallsites++;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IndirectCallPromotion_8cpp.html#a536c64cb42544e3105204c84856201a9">ICPCSSkip</a> != 0 &amp;&amp; NumOfPGOICallsites &lt;= <a class="code" href="IndirectCallPromotion_8cpp.html#a536c64cb42544e3105204c84856201a9">ICPCSSkip</a>) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Skip: User options.\n&quot;</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumCandidates; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Count = ValueDataRef[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Count;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Count &lt;= TotalCount);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    (void)TotalCount;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="classllvm_1_1Target.html">Target</a> = ValueDataRef[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Value;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Candidate &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot; Count=&quot;</span> &lt;&lt; Count</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;  Target_func: &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1Target.html">Target</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndirectCallPromotion_8cpp.html#a9dbb4173df66fc2d83a50513455c0c63">ICPInvokeOnly</a> &amp;&amp; isa&lt;CallInst&gt;(CB)) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Not promote: User options.\n&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UserOptions&quot;</span>, &amp;CB)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; Not promote: User options&quot;</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      });</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndirectCallPromotion_8cpp.html#a47f5070dfb594c28811032551db7d159">ICPCallOnly</a> &amp;&amp; isa&lt;InvokeInst&gt;(CB)) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Not promote: User option.\n&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UserOptions&quot;</span>, &amp;CB)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; Not promote: User options&quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      });</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndirectCallPromotion_8cpp.html#a29c2334c5a10304d0f345c5aac7887c8">ICPCutOff</a> != 0 &amp;&amp; NumOfPGOICallPromotion &gt;= <a class="code" href="IndirectCallPromotion_8cpp.html#a29c2334c5a10304d0f345c5aac7887c8">ICPCutOff</a>) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Not promote: Cutoff reached.\n&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;CutOffReached&quot;</span>, &amp;CB)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; Not promote: Cutoff reached&quot;</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      });</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// Don&#39;t promote if the symbol is not defined in the module. This avoids</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// creating a reference to a symbol that doesn&#39;t exist in the module</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// This can happen when we compile with a sample profile collected from</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// one binary but used for another, which may have profiled targets that</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// aren&#39;t used in the new binary. We might have a declaration initially in</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// the case where the symbol is globally dead in the binary and removed by</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// ThinLTO.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *TargetFunction = Symtab-&gt;<a class="code" href="classllvm_1_1Function.html#a16be569c794ac815f294b1f651587e48">getFunction</a>(<a class="code" href="classllvm_1_1Target.html">Target</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (TargetFunction == <span class="keyword">nullptr</span> || TargetFunction-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">isDeclaration</a>()) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Not promote: Cannot find the target\n&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnableToFindTarget&quot;</span>, &amp;CB)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;Cannot promote indirect call: target with md5sum &quot;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">ore::NV</a>(<span class="stringliteral">&quot;target md5sum&quot;</span>, <a class="code" href="classllvm_1_1Target.html">Target</a>) &lt;&lt; <span class="stringliteral">&quot; not found&quot;</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      });</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *Reason = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">isLegalToPromote</a>(CB, TargetFunction, &amp;Reason)) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keyword">using namespace </span>ore;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnableToPromote&quot;</span>, &amp;CB)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;Cannot promote indirect call to &quot;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;TargetFunction&quot;</span>, TargetFunction) &lt;&lt; <span class="stringliteral">&quot; with count of &quot;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;Count&quot;</span>, Count) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; Reason;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      });</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>.push_back(PromotionCandidate(TargetFunction, Count));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    TotalCount -= Count;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="namespacellvm_1_1pgo.html#ac3ab1f99a5d99ba23fcfec6044ebc805">  244</a></span>&#160;<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code" href="namespacellvm_1_1pgo.html#ac3ab1f99a5d99ba23fcfec6044ebc805">llvm::pgo::promoteIndirectCall</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <a class="code" href="classllvm_1_1Function.html">Function</a> *DirectCallee,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                         <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Count, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TotalCount,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                         <span class="keywordtype">bool</span> AttachProfToDirectCall,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                         <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ElseCount = TotalCount - Count;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MaxCount = (Count &gt;= ElseCount ? Count : ElseCount);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Scale = <a class="code" href="namespacellvm.html#abb99891c63212832f13146f418aed935">calculateCountScale</a>(MaxCount);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="classllvm_1_1MDBuilder.html">MDBuilder</a> MDB(CB.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="classllvm_1_1MDNode.html">MDNode</a> *BranchWeights = MDB.<a class="code" href="classllvm_1_1MDBuilder.html#ad910125a9cfd76aaad7f69469df22f66">createBranchWeights</a>(</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <a class="code" href="namespacellvm.html#aa9a2cc174301c011647c95c88e0f89b0">scaleBranchCount</a>(Count, Scale), <a class="code" href="namespacellvm.html#aa9a2cc174301c011647c95c88e0f89b0">scaleBranchCount</a>(ElseCount, Scale));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;NewInst =</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="namespacellvm.html#a23c23396eb61a7a78555e926700dbf47">promoteCallWithIfThenElse</a>(CB, DirectCallee, BranchWeights);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">if</span> (AttachProfToDirectCall) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classllvm_1_1MDBuilder.html">MDBuilder</a> MDB(NewInst.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    NewInst.<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        LLVMContext::MD_prof,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        MDB.<a class="code" href="classllvm_1_1MDBuilder.html#ad910125a9cfd76aaad7f69469df22f66">createBranchWeights</a>({static_cast&lt;uint32_t&gt;(Count)}));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">using namespace </span>ore;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">if</span> (ORE)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>(<a class="code" href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;Promoted&quot;</span>, &amp;CB)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Promote indirect call to &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;DirectCallee&quot;</span>, DirectCallee)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; with count &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;Count&quot;</span>, Count) &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;             &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;TotalCount&quot;</span>, TotalCount);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    });</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">return</span> NewInst;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">// Promote indirect-call to conditional direct-call for one callsite.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<a class="code" href="classuint32__t.html">uint32_t</a> ICallPromotionFunc::tryToPromote(</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <span class="keyword">const</span> std::vector&lt;PromotionCandidate&gt; &amp;Candidates,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> &amp;TotalCount) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="classuint32__t.html">uint32_t</a> NumPromoted = 0;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> : Candidates) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Count = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.Count;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="namespacellvm_1_1pgo.html#ac3ab1f99a5d99ba23fcfec6044ebc805">pgo::promoteIndirectCall</a>(CB, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.TargetFunction, Count, TotalCount, SamplePGO,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                             &amp;ORE);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TotalCount &gt;= Count);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    TotalCount -= Count;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    NumOfPGOICallPromotion++;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    NumPromoted++;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">return</span> NumPromoted;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">// Traverse all the indirect-call callsite and get the value profile</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">// annotation to perform indirect-call promotion.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordtype">bool</span> ICallPromotionFunc::processFunction(<a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="classllvm_1_1ICallPromotionAnalysis.html">ICallPromotionAnalysis</a> ICallAnalysis;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CB : <a class="code" href="namespacellvm.html#a7267c2dce1936d5cf0de57bd65692774">findIndirectCalls</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> NumVals, NumCandidates;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TotalCount;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">auto</span> ICallProfDataRef = ICallAnalysis.<a class="code" href="classllvm_1_1ICallPromotionAnalysis.html#a4c5862efea289ce1e0bf8ed63615bb52">getPromotionCandidatesForInstruction</a>(</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        CB, NumVals, TotalCount, NumCandidates);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (!NumCandidates ||</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        (PSI &amp;&amp; PSI-&gt;<a class="code" href="classllvm_1_1ProfileSummaryInfo.html#a11d1c1af51bf81a6a9f8f5191b5e3cf2">hasProfileSummary</a>() &amp;&amp; !PSI-&gt;<a class="code" href="classllvm_1_1ProfileSummaryInfo.html#ac46d4d55dd867977ba88d57a170e31de">isHotCount</a>(TotalCount)))</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">auto</span> PromotionCandidates = getPromotionCandidatesForCallSite(</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        *CB, ICallProfDataRef, TotalCount, NumCandidates);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> NumPromoted = tryToPromote(*CB, PromotionCandidates, TotalCount);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (NumPromoted == 0)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// Adjust the MD.prof metadata. First delete the old one.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    CB-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD_prof, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// If all promoted, we don&#39;t need the MD.prof metadata.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (TotalCount == 0 || NumPromoted == NumVals)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// Otherwise we need update with the un-promoted records back.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="namespacellvm.html#a68ee9c22fcc77e40d4ae44e5b37c7998">annotateValueSite</a>(*M, *CB, ICallProfDataRef.slice(NumPromoted), TotalCount,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                      IPVK_IndirectCallTarget, NumCandidates);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">// A wrapper function that does the actual work.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="IndirectCallPromotion_8cpp.html#a0afab406364d2d6ad820ac7e90a3c3ec">  329</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="IndirectCallPromotion_8cpp.html#a0afab406364d2d6ad820ac7e90a3c3ec">promoteIndirectCalls</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                 <span class="keywordtype">bool</span> InLTO, <span class="keywordtype">bool</span> SamplePGO,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                 <a class="code" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> *AM = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IndirectCallPromotion_8cpp.html#a197a657d7baca10b5f9206ab9533d6d4">DisableICP</a>)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="classllvm_1_1InstrProfSymtab.html">InstrProfSymtab</a> Symtab;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Error.html">Error</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = Symtab.<a class="code" href="classllvm_1_1InstrProfSymtab.html#af157a4c7de20bed5a19a6148629b3534">create</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, InLTO)) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    std::string SymtabFailure = <a class="code" href="namespacellvm.html#a63540526d092e2f4bbc70590b6034f4e">toString</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getContext().emitError(<span class="stringliteral">&quot;Failed to create symtab: &quot;</span> + SymtabFailure);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration() || <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasOptNone())</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    std::unique_ptr&lt;OptimizationRemarkEmitter&gt; OwnedORE;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (AM) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> =</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          AM-&gt;<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1InnerAnalysisManagerProxy.html">FunctionAnalysisManagerModuleProxy</a>&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>).getManager();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      ORE = &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">OptimizationRemarkEmitterAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      OwnedORE = std::make_unique&lt;OptimizationRemarkEmitter&gt;(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      ORE = OwnedORE.get();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    ICallPromotionFunc ICallPromotion(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, &amp;Symtab, SamplePGO, *ORE);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">bool</span> FuncChanged = ICallPromotion.processFunction(PSI);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndirectCallPromotion_8cpp.html#afa78e8b533e056ee55ef29afec061c3d">ICPDUMPAFTER</a> &amp;&amp; FuncChanged) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n== IR Dump After ==&quot;</span>; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    Changed |= FuncChanged;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IndirectCallPromotion_8cpp.html#a29c2334c5a10304d0f345c5aac7887c8">ICPCutOff</a> != 0 &amp;&amp; NumOfPGOICallPromotion &gt;= <a class="code" href="IndirectCallPromotion_8cpp.html#a29c2334c5a10304d0f345c5aac7887c8">ICPCutOff</a>) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; Stop: Cutoff reached.\n&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classllvm_1_1PGOIndirectCallPromotion.html#a1ba98ca344e492bbb1112f09d3f4c83d">  371</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1PGOIndirectCallPromotion.html#a1ba98ca344e492bbb1112f09d3f4c83d">PGOIndirectCallPromotion::run</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                                <a class="code" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI = &amp;AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1ProfileSummaryAnalysis.html">ProfileSummaryAnalysis</a>&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="IndirectCallPromotion_8cpp.html#a0afab406364d2d6ad820ac7e90a3c3ec">promoteIndirectCalls</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, PSI, InLTO | <a class="code" href="IndirectCallPromotion_8cpp.html#af4bbe64c7a01b2af7c40d0b353abaee5">ICPLTOMode</a>,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                            SamplePGO | <a class="code" href="IndirectCallPromotion_8cpp.html#a80041d58a2f3b65b5ec597fffedb1d72">ICPSamplePGOMode</a>, &amp;AM))</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aInstrumentation_8h_html"><div class="ttname"><a href="Instrumentation_8h.html">Instrumentation.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_afa78e8b533e056ee55ef29afec061c3d"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#afa78e8b533e056ee55ef29afec061c3d">ICPDUMPAFTER</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ICPDUMPAFTER(&quot;icp-dumpafter&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Dump IR after transformation happens&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html_a11d1c1af51bf81a6a9f8f5191b5e3cf2"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html#a11d1c1af51bf81a6a9f8f5191b5e3cf2">llvm::ProfileSummaryInfo::hasProfileSummary</a></div><div class="ttdeci">bool hasProfileSummary() const</div><div class="ttdoc">Returns true if profile summary is available.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00069">ProfileSummaryInfo.h:69</a></div></div>
<div class="ttc" id="aclassllvm_1_1Target_html"><div class="ttname"><a href="classllvm_1_1Target.html">llvm::Target</a></div><div class="ttdoc">Target - Wrapper for Target specific information.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegistry_8h_source.html#l00149">TargetRegistry.h:149</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_af4bbe64c7a01b2af7c40d0b353abaee5"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#af4bbe64c7a01b2af7c40d0b353abaee5">ICPLTOMode</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ICPLTOMode(&quot;icp-lto&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Run indirect-call promotion in LTO &quot; &quot;mode&quot;))</div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstrProfSymtab_html_af157a4c7de20bed5a19a6148629b3534"><div class="ttname"><a href="classllvm_1_1InstrProfSymtab.html#af157a4c7de20bed5a19a6148629b3534">llvm::InstrProfSymtab::create</a></div><div class="ttdeci">Error create(object::SectionRef &amp;Section)</div><div class="ttdoc">Create InstrProfSymtab from an object file section which contains function PGO names.</div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_a80041d58a2f3b65b5ec597fffedb1d72"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#a80041d58a2f3b65b5ec597fffedb1d72">ICPSamplePGOMode</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ICPSamplePGOMode(&quot;icp-samplepgo&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Run indirect-call promotion in SamplePGO mode&quot;))</div></div>
<div class="ttc" id="aSupport_2Error_8h_html"><div class="ttname"><a href="Support_2Error_8h.html">Error.h</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00155">PassManager.h:155</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a8f5533240c6722d987a2443cba42019d"><div class="ttname"><a href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">llvm::MipsISD::Ret</a></div><div class="ttdeci">@ Ret</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00119">MipsISelLowering.h:119</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="IndirectCallPromotion_8cpp_source.html#l00048">IndirectCallPromotion.cpp:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICallPromotionAnalysis_html"><div class="ttname"><a href="classllvm_1_1ICallPromotionAnalysis.html">llvm::ICallPromotionAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="IndirectCallPromotionAnalysis_8h_source.html#l00024">IndirectCallPromotionAnalysis.h:24</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1PGOIndirectCallPromotion_html_a1ba98ca344e492bbb1112f09d3f4c83d"><div class="ttname"><a href="classllvm_1_1PGOIndirectCallPromotion.html#a1ba98ca344e492bbb1112f09d3f4c83d">llvm::PGOIndirectCallPromotion::run</a></div><div class="ttdeci">PreservedAnalyses run(Module &amp;M, ModuleAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition:</b> <a href="IndirectCallPromotion_8cpp_source.html#l00371">IndirectCallPromotion.cpp:371</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_a29c2334c5a10304d0f345c5aac7887c8"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#a29c2334c5a10304d0f345c5aac7887c8">ICPCutOff</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ICPCutOff(&quot;icp-cutoff&quot;, cl::init(0), cl::Hidden, cl::desc(&quot;Max number of promotions for this compilation&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9247a212ea89acc9573fa7e7f557eaba"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">llvm::Instruction::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdoc">Set the metadata of the specified kind to the specified node.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01455">Metadata.cpp:1455</a></div></div>
<div class="ttc" id="aIndirectCallPromotionAnalysis_8h_html"><div class="ttname"><a href="IndirectCallPromotionAnalysis_8h.html">IndirectCallPromotionAnalysis.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_abb99891c63212832f13146f418aed935"><div class="ttname"><a href="namespacellvm.html#abb99891c63212832f13146f418aed935">llvm::calculateCountScale</a></div><div class="ttdeci">static uint64_t calculateCountScale(uint64_t MaxCount)</div><div class="ttdoc">Calculate what to divide by to scale counts.</div><div class="ttdef"><b>Definition:</b> <a href="Instrumentation_8h_source.html#l00157">Instrumentation.h:157</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a32e606ac4c88f71f14212e42b808e7f4"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">llvm::GlobalValue::isDeclaration</a></div><div class="ttdeci">bool isDeclaration() const</div><div class="ttdoc">Return true if the primary definition of this global value is outside of the current translation unit...</div><div class="ttdef"><b>Definition:</b> <a href="Globals_8cpp_source.html#l00275">Globals.cpp:275</a></div></div>
<div class="ttc" id="aIndirectCallVisitor_8h_html"><div class="ttname"><a href="IndirectCallVisitor_8h.html">IndirectCallVisitor.h</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a23c23396eb61a7a78555e926700dbf47"><div class="ttname"><a href="namespacellvm.html#a23c23396eb61a7a78555e926700dbf47">llvm::promoteCallWithIfThenElse</a></div><div class="ttdeci">CallBase &amp; promoteCallWithIfThenElse(CallBase &amp;CB, Function *Callee, MDNode *BranchWeights=nullptr)</div><div class="ttdoc">Promote the given indirect call site to conditionally call Callee.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00549">CallPromotionUtils.cpp:549</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDBuilder_html_ad910125a9cfd76aaad7f69469df22f66"><div class="ttname"><a href="classllvm_1_1MDBuilder.html#ad910125a9cfd76aaad7f69469df22f66">llvm::MDBuilder::createBranchWeights</a></div><div class="ttdeci">MDNode * createBranchWeights(uint32_t TrueWeight, uint32_t FalseWeight)</div><div class="ttdoc">Return metadata containing two branch weights.</div><div class="ttdef"><b>Definition:</b> <a href="MDBuilder_8cpp_source.html#l00037">MDBuilder.cpp:37</a></div></div>
<div class="ttc" id="aInstrProf_8h_html"><div class="ttname"><a href="InstrProf_8h.html">InstrProf.h</a></div></div>
<div class="ttc" id="aMDBuilder_8h_html"><div class="ttname"><a href="MDBuilder_8h.html">MDBuilder.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="anamespacellvm_html_a0e5b9e42ea84622605acea0b0d721fda"><div class="ttname"><a href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">llvm::isLegalToPromote</a></div><div class="ttdeci">bool isLegalToPromote(const CallBase &amp;CB, Function *Callee, const char **FailureReason=nullptr)</div><div class="ttdoc">Return true if the given indirect call site can be made to call Callee.</div><div class="ttdef"><b>Definition:</b> <a href="CallPromotionUtils_8cpp_source.html#l00382">CallPromotionUtils.cpp:382</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa9a2cc174301c011647c95c88e0f89b0"><div class="ttname"><a href="namespacellvm.html#aa9a2cc174301c011647c95c88e0f89b0">llvm::scaleBranchCount</a></div><div class="ttdeci">static uint32_t scaleBranchCount(uint64_t Count, uint64_t Scale)</div><div class="ttdoc">Scale an individual branch count.</div><div class="ttdef"><b>Definition:</b> <a href="Instrumentation_8h_source.html#l00167">Instrumentation.h:167</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html">llvm::ProfileSummaryInfo</a></div><div class="ttdoc">Analysis providing profile information.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00040">ProfileSummaryInfo.h:40</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html_ac46d4d55dd867977ba88d57a170e31de"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html#ac46d4d55dd867977ba88d57a170e31de">llvm::ProfileSummaryInfo::isHotCount</a></div><div class="ttdeci">bool isHotCount(uint64_t C) const</div><div class="ttdoc">Returns true if count C is considered hot.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8cpp_source.html#l00292">ProfileSummaryInfo.cpp:292</a></div></div>
<div class="ttc" id="aProfileSummaryInfo_8h_html"><div class="ttname"><a href="ProfileSummaryInfo_8h.html">ProfileSummaryInfo.h</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="aPGOInstrumentation_8h_html"><div class="ttname"><a href="PGOInstrumentation_8h.html">PGOInstrumentation.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aArrayRef_8h_html"><div class="ttname"><a href="ArrayRef_8h.html">ArrayRef.h</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_a9dbb4173df66fc2d83a50513455c0c63"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#a9dbb4173df66fc2d83a50513455c0c63">ICPInvokeOnly</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ICPInvokeOnly(&quot;icp-invoke-only&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Run indirect-call promotion for &quot; &quot;invoke instruction only&quot;))</div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html_aae6a98aea85aa3af87357cc5448db499"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">llvm::OptimizationRemarkEmitter::emit</a></div><div class="ttdeci">void emit(DiagnosticInfoOptimizationBase &amp;OptDiag)</div><div class="ttdoc">Output the remark via the diagnostic handler and to the optimization record file.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00079">OptimizationRemarkEmitter.cpp:79</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDNode_html"><div class="ttname"><a href="classllvm_1_1MDNode.html">llvm::MDNode</a></div><div class="ttdoc">Metadata node.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00943">Metadata.h:943</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a16be569c794ac815f294b1f651587e48"><div class="ttname"><a href="classllvm_1_1Function.html#a16be569c794ac815f294b1f651587e48">llvm::Function::getFunction</a></div><div class="ttdeci">const Function &amp; getFunction() const</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00134">Function.h:134</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryAnalysis_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryAnalysis.html">llvm::ProfileSummaryAnalysis</a></div><div class="ttdoc">An analysis pass based on the new PM to deliver ProfileSummaryInfo.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00212">ProfileSummaryInfo.h:212</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aCallPromotionUtils_8h_html"><div class="ttname"><a href="CallPromotionUtils_8h.html">CallPromotionUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICallPromotionAnalysis_html_a4c5862efea289ce1e0bf8ed63615bb52"><div class="ttname"><a href="classllvm_1_1ICallPromotionAnalysis.html#a4c5862efea289ce1e0bf8ed63615bb52">llvm::ICallPromotionAnalysis::getPromotionCandidatesForInstruction</a></div><div class="ttdeci">ArrayRef&lt; InstrProfValueData &gt; getPromotionCandidatesForInstruction(const Instruction *I, uint32_t &amp;NumVals, uint64_t &amp;TotalCount, uint32_t &amp;NumCandidates)</div><div class="ttdoc">Returns reference to array of InstrProfValueData for the given instruction I.</div><div class="ttdef"><b>Definition:</b> <a href="IndirectCallPromotionAnalysis_8cpp_source.html#l00087">IndirectCallPromotionAnalysis.cpp:87</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ifs_html_adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df"><div class="ttname"><a href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">llvm::ifs::IFSSymbolType::Func</a></div><div class="ttdeci">@ Func</div></div>
<div class="ttc" id="anamespacellvm_html_a68ee9c22fcc77e40d4ae44e5b37c7998"><div class="ttname"><a href="namespacellvm.html#a68ee9c22fcc77e40d4ae44e5b37c7998">llvm::annotateValueSite</a></div><div class="ttdeci">void annotateValueSite(Module &amp;M, Instruction &amp;Inst, const InstrProfRecord &amp;InstrProfR, InstrProfValueKind ValueKind, uint32_t SiteIndx, uint32_t MaxMDCount=3)</div><div class="ttdoc">Get the value profile data for value site SiteIdx from InstrProfR and annotate the instruction Inst w...</div><div class="ttdef"><b>Definition:</b> <a href="InstrProf_8cpp_source.html#l01018">InstrProf.cpp:1018</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_a0afab406364d2d6ad820ac7e90a3c3ec"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#a0afab406364d2d6ad820ac7e90a3c3ec">promoteIndirectCalls</a></div><div class="ttdeci">static bool promoteIndirectCalls(Module &amp;M, ProfileSummaryInfo *PSI, bool InLTO, bool SamplePGO, ModuleAnalysisManager *AM=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="IndirectCallPromotion_8cpp_source.html#l00329">IndirectCallPromotion.cpp:329</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7267c2dce1936d5cf0de57bd65692774"><div class="ttname"><a href="namespacellvm.html#a7267c2dce1936d5cf0de57bd65692774">llvm::findIndirectCalls</a></div><div class="ttdeci">std::vector&lt; CallBase * &gt; findIndirectCalls(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="IndirectCallVisitor_8h_source.html#l00031">IndirectCallVisitor.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstrProfSymtab_html"><div class="ttname"><a href="classllvm_1_1InstrProfSymtab.html">llvm::InstrProfSymtab</a></div><div class="ttdoc">A symbol table used for function PGO name look-up with keys (such as pointers, md5hash values) to the...</div><div class="ttdef"><b>Definition:</b> <a href="InstrProf_8h_source.html#l00446">InstrProf.h:446</a></div></div>
<div class="ttc" id="anamespacellvm_html_a63540526d092e2f4bbc70590b6034f4e"><div class="ttname"><a href="namespacellvm.html#a63540526d092e2f4bbc70590b6034f4e">llvm::toString</a></div><div class="ttdeci">const char * toString(DWARFSectionKind Kind)</div><div class="ttdef"><b>Definition:</b> <a href="DWARFUnitIndex_8h_source.html#l00067">DWARFUnitIndex.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1Error_html"><div class="ttname"><a href="classllvm_1_1Error.html">llvm::Error</a></div><div class="ttdoc">Lightweight error class with error context and mandatory checking.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2Error_8h_source.html#l00156">Error.h:156</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aDiagnosticInfo_8h_html"><div class="ttname"><a href="DiagnosticInfo_8h.html">DiagnosticInfo.h</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aPassManager_8h_html"><div class="ttname"><a href="PassManager_8h.html">PassManager.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pgo_html_ac3ab1f99a5d99ba23fcfec6044ebc805"><div class="ttname"><a href="namespacellvm_1_1pgo.html#ac3ab1f99a5d99ba23fcfec6044ebc805">llvm::pgo::promoteIndirectCall</a></div><div class="ttdeci">CallBase &amp; promoteIndirectCall(CallBase &amp;CB, Function *F, uint64_t Count, uint64_t TotalCount, bool AttachProfToDirectCall, OptimizationRemarkEmitter *ORE)</div><div class="ttdef"><b>Definition:</b> <a href="IndirectCallPromotion_8cpp_source.html#l00244">IndirectCallPromotion.cpp:244</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDBuilder_html"><div class="ttname"><a href="classllvm_1_1MDBuilder.html">llvm::MDBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="MDBuilder_8h_source.html#l00036">MDBuilder.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_a197a657d7baca10b5f9206ab9533d6d4"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#a197a657d7baca10b5f9206ab9533d6d4">DisableICP</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableICP(&quot;disable-icp&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Disable indirect call promotion&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a85ffb6531d4cda988ea81f18d4e56fb7"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">llvm::ArrayRef::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">size - Get the array size.</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00163">ArrayRef.h:163</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_a47f5070dfb594c28811032551db7d159"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#a47f5070dfb594c28811032551db7d159">ICPCallOnly</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ICPCallOnly(&quot;icp-call-only&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Run indirect-call promotion for call instructions &quot; &quot;only&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1InnerAnalysisManagerProxy_html"><div class="ttname"><a href="classllvm_1_1InnerAnalysisManagerProxy.html">llvm::InnerAnalysisManagerProxy</a></div><div class="ttdoc">An analysis over an &quot;outer&quot; IR unit that provides access to an analysis manager over an &quot;inner&quot; IR un...</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00931">PassManager.h:931</a></div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aIndirectCallPromotion_8cpp_html_a536c64cb42544e3105204c84856201a9"><div class="ttname"><a href="IndirectCallPromotion_8cpp.html#a536c64cb42544e3105204c84856201a9">ICPCSSkip</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ICPCSSkip(&quot;icp-csskip&quot;, cl::init(0), cl::Hidden, cl::desc(&quot;Skip Callsite up to this number for this compilation&quot;))</div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitterAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">llvm::OptimizationRemarkEmitterAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00164">OptimizationRemarkEmitter.h:164</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:24:41 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
