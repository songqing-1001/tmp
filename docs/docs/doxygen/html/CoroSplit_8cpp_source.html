<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Coroutines/CoroSplit.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_41b0844b37bf482660c9a400b410eb70.html">Coroutines</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CoroSplit.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CoroSplit_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- CoroSplit.cpp - Converts a coroutine into a state machine ----------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// This pass builds the coroutine frame and outlines resume and destroy parts</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// of the coroutine into separate functions.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// We present a coroutine to an LLVM as an ordinary function with suspension</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// points marked up with intrinsics. We let the optimizer party on the coroutine</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// as a single function for as long as possible. Shortly before the coroutine is</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// eligible to be inlined into its callers, we split up the coroutine into parts</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// corresponding to an initial, resume and destroy invocations of the coroutine,</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// add them to the current SCC and restart the IPO pipeline to optimize the</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// coroutine subfunctions we extracted before proceeding to the caller of the</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// coroutine.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CoroSplit_8h.html">llvm/Transforms/Coroutines/CoroSplit.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CoroInstr_8h.html">CoroInstr.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CoroInternal_8h.html">CoroInternal.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PriorityWorklist_8h.html">llvm/ADT/PriorityWorklist.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Twine_8h.html">llvm/ADT/Twine.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Analysis_2CFG_8h.html">llvm/Analysis/CFG.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallGraph_8h.html">llvm/Analysis/CallGraph.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConstantFolding_8h.html">llvm/Analysis/ConstantFolding.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LazyCallGraph_8h.html">llvm/Analysis/LazyCallGraph.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dwarf_8h.html">llvm/BinaryFormat/Dwarf.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Argument_8h.html">llvm/IR/Argument.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Attributes_8h.html">llvm/IR/Attributes.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2CFG_8h.html">llvm/IR/CFG.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallingConv_8h.html">llvm/IR/CallingConv.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalValue_8h.html">llvm/IR/GlobalValue.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalVariable_8h.html">llvm/IR/GlobalVariable.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstIterator_8h.html">llvm/IR/InstIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Verifier_8h.html">llvm/IR/Verifier.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PrettyStackTrace_8h.html">llvm/Support/PrettyStackTrace.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CallGraphUpdater_8h.html">llvm/Transforms/Utils/CallGraphUpdater.h</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Cloning_8h.html">llvm/Transforms/Utils/Cloning.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueMapper_8h.html">llvm/Transforms/Utils/ValueMapper.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &lt;initializer_list&gt;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   77</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;coro-split&quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/// A little helper class for building</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span><span class="keyword">class </span>CoroCloner {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">enum class</span> <a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> {<span class="comment"></span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">    /// The shared resume function for a switch lowering.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span>    SwitchResume,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">    /// The shared unwind function for a switch lowering.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span>    SwitchUnwind,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    /// The shared cleanup function for a switch lowering.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span>    SwitchCleanup,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    /// An individual continuation function.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span>    Continuation,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    /// An async resume function.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span>    <a class="code" href="namespacellvm.html#a6cdf47ba1fa5831d7c2897bc3aed77b8a24aa4117da86c41684ad25742832dfa6">Async</a>,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  };</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;OrigF;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *NewF;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  Kind FKind;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> VMap;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewFramePtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  /// The active suspend instruction; meaningful only for continuation and async</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  /// ABIs.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *ActiveSuspend = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">  /// Create a cloner for a switch lowering.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span>  CoroCloner(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;OrigF, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;             Kind FKind)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    : OrigF(OrigF), NewF(<span class="keyword">nullptr</span>), Suffix(Suffix), Shape(Shape),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      FKind(FKind), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(OrigF.<a class="code" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>()) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">  /// Create a cloner for a continuation lowering.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span>  CoroCloner(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;OrigF, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;             <a class="code" href="classllvm_1_1Function.html">Function</a> *NewF, <a class="code" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *ActiveSuspend)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      : OrigF(OrigF), NewF(NewF), Suffix(Suffix), Shape(Shape),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        FKind(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a> ? Kind::Async : Kind::Continuation),</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(OrigF.<a class="code" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>()), ActiveSuspend(ActiveSuspend) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a> ||</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;           Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a> || Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewF &amp;&amp; <span class="stringliteral">&quot;need existing function for continuation&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ActiveSuspend &amp;&amp; <span class="stringliteral">&quot;need active suspend point for continuation&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="Evaluator_8cpp.html#a0b9941c7c78b50f1f303fa0c6403b199">getFunction</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewF != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;declaration not yet set&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> NewF;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">void</span> create();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">bool</span> isSwitchDestroyFunction() {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">switch</span> (FKind) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">case</span> Kind::Async:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">case</span> Kind::Continuation:</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">case</span> Kind::SwitchResume:</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">case</span> Kind::SwitchUnwind:</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">case</span> Kind::SwitchCleanup:</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown CoroCloner::Kind enum&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">void</span> replaceEntryBlock();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *deriveNewFramePointer();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">void</span> replaceRetconOrAsyncSuspendUses();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">void</span> replaceCoroSuspends();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">void</span> replaceCoroEnds();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">salvageDebugInfo</a>();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">void</span> handleFinalSuspend();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;};</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">  169</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, <a class="code" href="classllvm_1_1Value.html">Value</a> *FramePtr,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                   <a class="code" href="classllvm_1_1CallGraph.html">CallGraph</a> *CG) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a> ||</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">IsFrameInlineInStorage</a>)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#acad2aaa7f484c978bb790533eec90ac4">emitDealloc</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, FramePtr, CG);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">/// Replace an llvm.coro.end.async.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">/// Will inline the must tail call function call if there is one.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">/// \returns true if cleanup of the coro.end block is needed, false otherwise.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a8b22bf92719f6baa98dcfe7e99bd5389">  183</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#a8b22bf92719f6baa98dcfe7e99bd5389">replaceCoroEndAsync</a>(<a class="code" href="classllvm_1_1AnyCoroEndInst.html">AnyCoroEndInst</a> *End) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(End);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keyword">auto</span> *EndAsync = dyn_cast&lt;CoroAsyncEndInst&gt;(End);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (!EndAsync) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRetVoid();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span> <span class="comment">/*needs cleanup of coro.end block*/</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keyword">auto</span> *MustTailCallFunc = EndAsync-&gt;getMustTailCallFunction();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (!MustTailCallFunc) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRetVoid();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span> <span class="comment">/*needs cleanup of coro.end block*/</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// Move the must tail call from the predecessor block into the end block.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">auto</span> *CoroEndBlock = End-&gt;getParent();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">auto</span> *MustTailCallFuncBlock = CoroEndBlock-&gt;getSinglePredecessor();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MustTailCallFuncBlock &amp;&amp; <span class="stringliteral">&quot;Must have a single predecessor block&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">auto</span> It = MustTailCallFuncBlock-&gt;getTerminator()-&gt;getIterator();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keyword">auto</span> *MustTailCall = cast&lt;CallInst&gt;(&amp;*std::prev(It));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  CoroEndBlock-&gt;splice(End-&gt;getIterator(), MustTailCallFuncBlock,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                       MustTailCall-&gt;getIterator());</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// Insert the return instruction.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(End);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRetVoid();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="classllvm_1_1InlineFunctionInfo.html">InlineFunctionInfo</a> FnInfo;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// Remove the rest of the block, by splitting it into an unreachable block.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = End-&gt;getParent();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;splitBasicBlock(End);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keyword">auto</span> InlineRes = <a class="code" href="namespacellvm.html#ab5a3ac0a249da0743dac1bd816d8e5d5">InlineFunction</a>(*MustTailCall, FnInfo);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InlineRes.isSuccess() &amp;&amp; <span class="stringliteral">&quot;Expected inlining to succeed&quot;</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  (void)InlineRes;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// We have cleaned up the coro.end block above.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">/// Replace a non-unwind call to llvm.coro.end.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a84fbc09723655416fad6677d7fdaf8a6">  226</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a84fbc09723655416fad6677d7fdaf8a6">replaceFallthroughCoroEnd</a>(<a class="code" href="classllvm_1_1AnyCoroEndInst.html">AnyCoroEndInst</a> *End,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, <a class="code" href="classllvm_1_1Value.html">Value</a> *FramePtr,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                      <span class="keywordtype">bool</span> InResume, <a class="code" href="classllvm_1_1CallGraph.html">CallGraph</a> *CG) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Start inserting right before the coro.end.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(End);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// Create the return instruction.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">switch</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// The cloned functions in switch-lowering always return void.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// coro.end doesn&#39;t immediately end the coroutine in the main function</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// in this lowering, because we need to deallocate the coroutine.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (!InResume)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRetVoid();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// In async lowering this returns.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>: {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">bool</span> CoroEndBlockNeedsCleanup = <a class="code" href="CoroSplit_8cpp.html#a8b22bf92719f6baa98dcfe7e99bd5389">replaceCoroEndAsync</a>(End);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (!CoroEndBlockNeedsCleanup)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// In unique continuation lowering, the continuations always return void.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// But we may have implicitly allocated storage.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Shape, FramePtr, CG);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRetVoid();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// In non-unique continuation lowering, we signal completion by returning</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// a null continuation.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>: {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Shape, FramePtr, CG);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">auto</span> RetTy = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ab4f8e4fd5bccb83b8323e5ab38ed8571">getResumeFunctionType</a>()-&gt;<a class="code" href="classllvm_1_1FunctionType.html#ac453ad79a3d50950bac79bc9dff85918">getReturnType</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">auto</span> RetStructTy = dyn_cast&lt;StructType&gt;(RetTy);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *ContinuationTy =</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      cast&lt;PointerType&gt;(RetStructTy ? RetStructTy-&gt;getElementType(0) : RetTy);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ReturnValue = <a class="code" href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(ContinuationTy);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (RetStructTy) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      ReturnValue = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInsertValue(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(RetStructTy),</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                              ReturnValue, 0);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRet(ReturnValue);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// Remove the rest of the block, by splitting it into an unreachable block.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = End-&gt;getParent();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;splitBasicBlock(End);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">// Mark a coroutine as done, which implies that the coroutine is finished and</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">// never get resumed.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">// In resume-switched ABI, the done state is represented by storing zero in</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">// ResumeFnAddr.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">// NOTE: We couldn&#39;t omit the argument `FramePtr`. It is necessary because the</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">// pointer to the frame in splitted function is not stored in `Shape`.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aa6734dd82cf736e89074802287b0abfe">  291</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#aa6734dd82cf736e89074802287b0abfe">markCoroutineAsDone</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                <a class="code" href="classllvm_1_1Value.html">Value</a> *FramePtr) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a> &amp;&amp;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="stringliteral">&quot;markCoroutineAsDone is only supported for Switch-Resumed ABI for now.&quot;</span>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keyword">auto</span> *GepIndex = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStructGEP(</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>, FramePtr, <a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a3e10a8a52059efadba225b68fbb26451a012dd1dc85c718e8159980fa4273d9e6">coro::Shape::SwitchFieldIndex::Resume</a>,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="stringliteral">&quot;ResumeFn.addr&quot;</span>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keyword">auto</span> *NullPtr = <a class="code" href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(cast&lt;PointerType&gt;(</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>-&gt;<a class="code" href="classllvm_1_1StructType.html#abe11230ab448dd37adc9feb99ac7d3da">getTypeAtIndex</a>(<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a3e10a8a52059efadba225b68fbb26451a012dd1dc85c718e8159980fa4273d9e6">coro::Shape::SwitchFieldIndex::Resume</a>)));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(NullPtr, GepIndex);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">/// Replace an unwind call to llvm.coro.end.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a9cb75e325aabbbb2e1fdf034b2f11491">  305</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a9cb75e325aabbbb2e1fdf034b2f11491">replaceUnwindCoroEnd</a>(<a class="code" href="classllvm_1_1AnyCoroEndInst.html">AnyCoroEndInst</a> *End, <span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                 <a class="code" href="classllvm_1_1Value.html">Value</a> *FramePtr, <span class="keywordtype">bool</span> InResume,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                 <a class="code" href="classllvm_1_1CallGraph.html">CallGraph</a> *CG) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(End);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">switch</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// In switch-lowering, this does nothing in the main function.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>: {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// In C++&#39;s specification, the coroutine should be marked as done</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// if promise.unhandled_exception() throws.  The frontend will</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// call coro.end(true) along this path.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// FIXME: We should refactor this once there is other language</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// which uses Switch-Resumed style other than C++.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#aa6734dd82cf736e89074802287b0abfe">markCoroutineAsDone</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Shape, FramePtr);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (!InResume)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// In async lowering this does nothing.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// In continuation-lowering, this frees the continuation storage.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Shape, FramePtr, CG);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// If coro.end has an associated bundle, add cleanupret instruction.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Bundle = End-&gt;getOperandBundle(<a class="code" href="classllvm_1_1LLVMContext.html#a800c1300065ca1615d2f4fb88623afd5a8997c6b0930e2c05209e95e7172c6cf3">LLVMContext::OB_funclet</a>)) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">auto</span> *FromPad = cast&lt;CleanupPadInst&gt;(Bundle-&gt;Inputs[0]);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">auto</span> *CleanupRet = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCleanupRet(FromPad, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    End-&gt;getParent()-&gt;splitBasicBlock(End);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    CleanupRet-&gt;getParent()-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab289568caaa6647ee577a06e6e12499a">  343</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ab289568caaa6647ee577a06e6e12499a">replaceCoroEnd</a>(<a class="code" href="classllvm_1_1AnyCoroEndInst.html">AnyCoroEndInst</a> *End, <span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                           <a class="code" href="classllvm_1_1Value.html">Value</a> *FramePtr, <span class="keywordtype">bool</span> InResume, <a class="code" href="classllvm_1_1CallGraph.html">CallGraph</a> *CG) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">if</span> (End-&gt;isUnwind())</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a9cb75e325aabbbb2e1fdf034b2f11491">replaceUnwindCoroEnd</a>(End, Shape, FramePtr, InResume, CG);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a84fbc09723655416fad6677d7fdaf8a6">replaceFallthroughCoroEnd</a>(End, Shape, FramePtr, InResume, CG);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = End-&gt;getContext();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  End-&gt;replaceAllUsesWith(InResume ? <a class="code" href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">ConstantInt::getTrue</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                   : <a class="code" href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">ConstantInt::getFalse</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>));</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  End-&gt;eraseFromParent();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">// Create an entry block for a resume function with a switch that will jump to</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">// suspend points.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">  358</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">createResumeEntryBlock</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// resume.entry:</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">//  %index.addr = getelementptr inbounds %f.Frame, %f.Frame* %FramePtr, i32 0,</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">//  i32 2</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">//  % index = load i32, i32* %index.addr</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">//  switch i32 %index, label %unreachable [</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">//    i32 0, label %resume.0</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">//    i32 1, label %resume.1</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">//    ...</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">//  ]</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keyword">auto</span> *NewEntry = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <span class="stringliteral">&quot;resume.entry&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keyword">auto</span> *UnreachBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <span class="stringliteral">&quot;unreachable&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(NewEntry);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keyword">auto</span> *FramePtr = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">auto</span> *FrameTy = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keyword">auto</span> *GepIndex = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStructGEP(</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      FrameTy, FramePtr, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#aedc5db661c24859142b1b7a67dc05ba7">getSwitchIndexField</a>(), <span class="stringliteral">&quot;index.addr&quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a8a098003528fee285a3506a0d780cbdf">getIndexType</a>(), GepIndex, <span class="stringliteral">&quot;index&quot;</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keyword">auto</span> *Switch =</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSwitch(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, UnreachBB, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ab9ff52a8227ec3fe5547af29ed59622f">ResumeSwitch</a> = Switch;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordtype">size_t</span> SuspendIndex = 0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *AnyS : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = cast&lt;CoroSuspendInst&gt;(AnyS);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *IndexVal = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a002c19b0baeca605dc94e5987d50cde2">getIndex</a>(SuspendIndex);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// Replace CoroSave with a store to Index:</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">//    %index.addr = getelementptr %f.frame... (index field number)</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">//    store i32 %IndexVal, i32* %index.addr1</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keyword">auto</span> *Save = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getCoroSave();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Save);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;isFinal()) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="comment">// The coroutine should be marked done if it reaches the final suspend</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="comment">// point.</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#aa6734dd82cf736e89074802287b0abfe">markCoroutineAsDone</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Shape, FramePtr);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// If the coroutine don&#39;t have unwind coro end, we could omit the store to</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// the final suspend point since we could infer the coroutine is suspended</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// at the final suspend point by the nullness of ResumeFnAddr.</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// However, we can&#39;t skip it if the coroutine have unwind coro end. Since</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// the coroutine reaches unwind coro end is considered suspended at the</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// final suspend point (the ResumeFnAddr is null) but in fact the coroutine</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// didn&#39;t complete yet. We need the IndexVal for the final suspend point</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">// to make the states clear.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;isFinal() || Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a4eae23cbbb20b1a985a27727e3901ee6">HasUnwindCoroEnd</a>) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keyword">auto</span> *GepIndex = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStructGEP(</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          FrameTy, FramePtr, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#aedc5db661c24859142b1b7a67dc05ba7">getSwitchIndexField</a>(), <span class="stringliteral">&quot;index.addr&quot;</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(IndexVal, GepIndex);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    Save-&gt;replaceAllUsesWith(<a class="code" href="classllvm_1_1ConstantTokenNone.html#a8e29fb8e39fb67b3bb746dbba47fcb29">ConstantTokenNone::get</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>));</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    Save-&gt;eraseFromParent();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// Split block before and after coro.suspend and add a jump from an entry</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// switch:</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//  whateverBB:</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//    whatever</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">//    %0 = call i8 @llvm.coro.suspend(token none, i1 false)</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">//    switch i8 %0, label %suspend[i8 0, label %resume</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">//                                 i8 1, label %cleanup]</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// becomes:</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">//  whateverBB:</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">//     whatever</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//     br label %resume.0.landing</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">//  resume.0: ; &lt;--- jump from the switch in the resume.entry</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">//     %0 = tail call i8 @llvm.coro.suspend(token none, i1 false)</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">//     br label %resume.0.landing</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">//  resume.0.landing:</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">//     %1 = phi i8[-1, %whateverBB], [%0, %resume.0]</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">//     switch i8 % 1, label %suspend [i8 0, label %resume</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">//                                    i8 1, label %cleanup]</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keyword">auto</span> *SuspendBB = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getParent();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keyword">auto</span> *ResumeBB =</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        SuspendBB-&gt;splitBasicBlock(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <span class="stringliteral">&quot;resume.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(SuspendIndex));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keyword">auto</span> *LandingBB = ResumeBB-&gt;splitBasicBlock(</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getNextNode(), ResumeBB-&gt;getName() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.landing&quot;</span>));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    Switch-&gt;addCase(IndexVal, ResumeBB);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    cast&lt;BranchInst&gt;(SuspendBB-&gt;getTerminator())-&gt;setSuccessor(0, LandingBB);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keyword">auto</span> *PN = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8Ty(), 2, <span class="stringliteral">&quot;&quot;</span>, &amp;LandingBB-&gt;front());</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;replaceAllUsesWith(PN);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    PN-&gt;addIncoming(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8(-1), SuspendBB);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    PN-&gt;addIncoming(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, ResumeBB);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    ++SuspendIndex;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(UnreachBB);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateUnreachable();</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ae5f82081e3f2b39a7e795491bb5d7a6e">ResumeEntryBlock</a> = NewEntry;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">// In the resume function, we remove the last case  (when coro::Shape is built,</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">// the final suspend point (if present) is always the last element of</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">// CoroSuspends array) since it is an undefined behavior to resume a coroutine</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">// suspended at the final suspend point.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">// In the destroy function, if it isn&#39;t possible that the ResumeFnAddr is NULL</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">// and the coroutine doesn&#39;t suspend at the final suspend point actually (this</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">// is possible since the coroutine is considered suspended at the final suspend</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">// point if promise.unhandled_exception() exits via an exception), we can</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">// remove the last case.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keywordtype">void</span> CoroCloner::handleFinalSuspend() {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a> &amp;&amp;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;         Shape.SwitchLowering.HasFinalSuspend);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">if</span> (isSwitchDestroyFunction() &amp;&amp; Shape.SwitchLowering.HasUnwindCoroEnd)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a> = cast&lt;SwitchInst&gt;(VMap[Shape.SwitchLowering.ResumeSwitch]);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keyword">auto</span> FinalCaseIt = std::prev(<a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;case_end());</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ResumeBB = FinalCaseIt-&gt;getCaseSuccessor();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;removeCase(FinalCaseIt);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">if</span> (isSwitchDestroyFunction()) {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OldSwitchBB = <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;getParent();</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keyword">auto</span> *NewSwitchBB = OldSwitchBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(Switch, <span class="stringliteral">&quot;Switch&quot;</span>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(OldSwitchBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">auto</span> *GepIndex = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStructGEP(Shape.FrameTy, NewFramePtr,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                       <a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a3e10a8a52059efadba225b68fbb26451a012dd1dc85c718e8159980fa4273d9e6">coro::Shape::SwitchFieldIndex::Resume</a>,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                             <span class="stringliteral">&quot;ResumeFn.addr&quot;</span>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(Shape.getSwitchResumePointerType(),</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                    GepIndex);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIsNull(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCondBr(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>, ResumeBB, NewSwitchBB);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    OldSwitchBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *</div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a00d7d6364b0b1a9bc1b3faa647130974">  499</a></span>&#160;<a class="code" href="CoroSplit_8cpp.html#a00d7d6364b0b1a9bc1b3faa647130974">getFunctionTypeFromAsyncSuspend</a>(<a class="code" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *Suspend) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keyword">auto</span> *AsyncSuspend = cast&lt;CoroSuspendAsyncInst&gt;(Suspend);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">auto</span> *StructTy = cast&lt;StructType&gt;(AsyncSuspend-&gt;getType());</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = Suspend-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keyword">auto</span> *VoidTy = <a class="code" href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">Type::getVoidTy</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">FunctionType::get</a>(VoidTy, StructTy-&gt;elements(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aaef0869616c26b47efe87a72269d52b7">  507</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="CoroSplit_8cpp.html#aaef0869616c26b47efe87a72269d52b7">createCloneDeclaration</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;OrigF, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                        <a class="code" href="classllvm_1_1Module.html#a7893161303eb07ae7864db6b3d004d9e">Module::iterator</a> InsertBefore,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                        <a class="code" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *ActiveSuspend) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = OrigF.<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keyword">auto</span> *FnTy = (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                   ? Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ab4f8e4fd5bccb83b8323e5ab38ed8571">getResumeFunctionType</a>()</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                   : <a class="code" href="CoroSplit_8cpp.html#a00d7d6364b0b1a9bc1b3faa647130974">getFunctionTypeFromAsyncSuspend</a>(ActiveSuspend);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *NewF =</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <a class="code" href="classllvm_1_1Function.html#a6adbed68009f582caa84cdfd2adf36f1">Function::Create</a>(FnTy, GlobalValue::LinkageTypes::InternalLinkage,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                       OrigF.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + Suffix);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getFunctionList().insert(InsertBefore, NewF);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">return</span> NewF;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">/// Replace uses of the active llvm.coro.suspend.retcon/async call with the</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">/// arguments to the continuation function.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">/// This assumes that the builder has a meaningful insertion point.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> CoroCloner::replaceRetconOrAsyncSuspendUses() {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a> || Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a> ||</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keyword">auto</span> NewS = VMap[ActiveSuspend];</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (NewS-&gt;use_empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// Copy out all the continuation arguments after the buffer pointer into</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// an easily-indexed data structure for convenience.</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 8&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// The async ABI includes all arguments -- including the first argument.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordtype">bool</span> IsAsyncABI = Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = IsAsyncABI ? NewF-&gt;arg_begin() : std::next(NewF-&gt;arg_begin()),</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = NewF-&gt;arg_end();</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.push_back(&amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// If the suspend returns a single scalar value, we can just do a simple</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// replacement.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;StructType&gt;(NewS-&gt;getType())) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.size() == 1);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    NewS-&gt;replaceAllUsesWith(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.front());</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// Try to peephole extracts of an aggregate return.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(NewS-&gt;uses())) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keyword">auto</span> *EVI = dyn_cast&lt;ExtractValueInst&gt;(U.getUser());</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (!EVI || EVI-&gt;getNumIndices() != 1)</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    EVI-&gt;replaceAllUsesWith(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[EVI-&gt;getIndices().front()]);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    EVI-&gt;eraseFromParent();</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// If we have no remaining uses, we&#39;re done.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">if</span> (NewS-&gt;use_empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">// Otherwise, we need to create an aggregate.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Agg = <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(NewS-&gt;getType());</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    Agg = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInsertValue(Agg, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  NewS-&gt;replaceAllUsesWith(Agg);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;}</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keywordtype">void</span> CoroCloner::replaceCoroSuspends() {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SuspendResult;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">switch</span> (Shape.ABI) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// In switch lowering, replace coro.suspend with the appropriate value</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// for the type of function we&#39;re extracting.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">// Replacing coro.suspend with (0) will result in control flow proceeding to</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">// a resume label associated with a suspend point, replacing it with (1) will</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">// result in control flow proceeding to a cleanup label associated with this</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">// suspend point.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    SuspendResult = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8(isSwitchDestroyFunction() ? 1 : 0);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// In async lowering there are no uses of the result.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// In returned-continuation lowering, the arguments from earlier</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// continuations are theoretically arbitrary, and they should have been</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// spilled.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *CS : Shape.CoroSuspends) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// The active suspend was handled earlier.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (CS == ActiveSuspend) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keyword">auto</span> *MappedCS = cast&lt;AnyCoroSuspendInst&gt;(VMap[CS]);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    MappedCS-&gt;replaceAllUsesWith(SuspendResult);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    MappedCS-&gt;eraseFromParent();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordtype">void</span> CoroCloner::replaceCoroEnds() {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1AnyCoroEndInst.html">AnyCoroEndInst</a> *CE : Shape.CoroEnds) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// We use a null call graph because there&#39;s no call graph node for</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">// the cloned function yet.  We&#39;ll just be rebuilding that later.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keyword">auto</span> *NewCE = cast&lt;AnyCoroEndInst&gt;(VMap[CE]);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#ab289568caaa6647ee577a06e6e12499a">replaceCoroEnd</a>(NewCE, Shape, NewFramePtr, <span class="comment">/*in resume*/</span> <span class="keyword">true</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">  620</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                 <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> *VMap) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a> &amp;&amp; Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.empty())</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CachedSlot = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keyword">auto</span> getSwiftErrorSlot = [&amp;](<a class="code" href="classllvm_1_1Type.html">Type</a> *ValueTy) -&gt; <a class="code" href="classllvm_1_1Value.html">Value</a> * {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (CachedSlot) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;PointerType&gt;(CachedSlot-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                 -&gt;isOpaqueOrPointeeTypeMatches(ValueTy) &amp;&amp;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;             <span class="stringliteral">&quot;multiple swifterror slots in function with different types&quot;</span>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">return</span> CachedSlot;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">// Check if the function has a swifterror argument.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.args()) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.isSwiftError()) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        CachedSlot = &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;PointerType&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.getType())</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                   -&gt;isOpaqueOrPointeeTypeMatches(ValueTy) &amp;&amp;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;               <span class="stringliteral">&quot;swifterror argument does not have expected type&quot;</span>);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">return</span> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// Create a swifterror alloca.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().getFirstNonPHIOrDbg());</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keyword">auto</span> Alloca = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlloca(ValueTy);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    Alloca-&gt;setSwiftError(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    CachedSlot = Alloca;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">return</span> Alloca;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  };</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">SwiftErrorOps</a>) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keyword">auto</span> MappedOp = VMap ? cast&lt;CallInst&gt;((*VMap)[<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>]) : <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(MappedOp);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">// If there are no arguments, this is a &#39;get&#39; operation.</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *MappedResult;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;arg_empty()) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keyword">auto</span> ValueTy = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keyword">auto</span> Slot = getSwiftErrorSlot(ValueTy);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      MappedResult = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(ValueTy, Slot);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;arg_size() == 1);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keyword">auto</span> <a class="code" href="classllvm_1_1Value.html">Value</a> = MappedOp-&gt;getArgOperand(0);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keyword">auto</span> ValueTy = <a class="code" href="classllvm_1_1Value.html">Value</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keyword">auto</span> Slot = getSwiftErrorSlot(ValueTy);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(<a class="code" href="classllvm_1_1Value.html">Value</a>, Slot);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      MappedResult = Slot;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    MappedOp-&gt;replaceAllUsesWith(MappedResult);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    MappedOp-&gt;eraseFromParent();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// If we&#39;re updating the original function, we&#39;ve invalidated SwiftErrorOps.</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">if</span> (VMap == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">SwiftErrorOps</a>.clear();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">CoroCloner::replaceSwiftErrorOps</a>() {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">::replaceSwiftErrorOps</a>(*NewF, Shape, &amp;VMap);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">CoroCloner::salvageDebugInfo</a>() {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DbgVariableIntrinsic *, 8&gt;</a> Worklist;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;llvm::Value *, llvm::AllocaInst *, 4&gt;</a> DbgPtrAllocaCache;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : *NewF)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *DVI = dyn_cast&lt;DbgVariableIntrinsic&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        Worklist.push_back(DVI);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *DVI : Worklist)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="namespacellvm_1_1coro.html#a4b6f33a1040beb67526139c880622747">coro::salvageDebugInfo</a>(DbgPtrAllocaCache, DVI, Shape.OptimizeFrame);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="comment">// Remove all salvaged dbg.declare intrinsics that became</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="comment">// either unreachable or stale due to the CoroSplit transformation.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DomTree(*NewF);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keyword">auto</span> IsUnreachableBlock = [&amp;](<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="namespacellvm.html#affedc93ead6b25c57a7196d32ff11e89">isPotentiallyReachable</a>(&amp;NewF-&gt;getEntryBlock(), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                   &amp;DomTree);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  };</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *DVI : Worklist) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (IsUnreachableBlock(DVI-&gt;getParent()))</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      DVI-&gt;eraseFromParent();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa_and_nonnull&lt;AllocaInst&gt;(DVI-&gt;getVariableLocationOp(0))) {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="comment">// Count all non-debuginfo uses in reachable blocks.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a> = 0;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="classllvm_1_1User.html">User</a> : DVI-&gt;getVariableLocationOp(0)-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>())</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(<a class="code" href="classllvm_1_1User.html">User</a>))</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          <span class="keywordflow">if</span> (!isa&lt;AllocaInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; !IsUnreachableBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()))</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            ++<a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        DVI-&gt;eraseFromParent();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordtype">void</span> CoroCloner::replaceEntryBlock() {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// In the original function, the AllocaSpillBlock is a block immediately</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">// following the allocation of the frame object which defines GEPs for</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">// all the allocas that have been moved into the frame, and it ends by</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">// branching to the original beginning of the coroutine.  Make this</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// the entry block of the cloned function.</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keyword">auto</span> *Entry = cast&lt;BasicBlock&gt;(VMap[Shape.AllocaSpillBlock]);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keyword">auto</span> *OldEntry = &amp;NewF-&gt;getEntryBlock();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  Entry-&gt;setName(<span class="stringliteral">&quot;entry&quot;</span> + Suffix);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  Entry-&gt;moveBefore(OldEntry);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  Entry-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// Clear all predecessors of the new entry block.  There should be</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="comment">// exactly one predecessor, which we created when splitting out</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="comment">// AllocaSpillBlock to begin with.</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Entry-&gt;hasOneUse());</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keyword">auto</span> BranchToEntry = cast&lt;BranchInst&gt;(Entry-&gt;user_back());</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BranchToEntry-&gt;isUnconditional());</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(BranchToEntry);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateUnreachable();</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  BranchToEntry-&gt;eraseFromParent();</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// Branch from the entry to the appropriate place.</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Entry);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordflow">switch</span> (Shape.ABI) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>: {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// In switch-lowering, we built a resume-entry block in the original</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">// function.  Make the entry block branch to this.</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keyword">auto</span> *SwitchBB =</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      cast&lt;BasicBlock&gt;(VMap[Shape.SwitchLowering.ResumeEntryBlock]);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBr(SwitchBB);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>: {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// In continuation ABIs, we want to branch to immediately after the</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// active suspend point.  Earlier phases will have put the suspend in its</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// own basic block, so just thread our jump directly to its successor.</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a> &amp;&amp;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            isa&lt;CoroSuspendAsyncInst&gt;(ActiveSuspend)) ||</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;           ((Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a> ||</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;             Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>) &amp;&amp;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            isa&lt;CoroSuspendRetconInst&gt;(ActiveSuspend)));</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keyword">auto</span> *MappedCS = cast&lt;AnyCoroSuspendInst&gt;(VMap[ActiveSuspend]);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> = cast&lt;BranchInst&gt;(MappedCS-&gt;getNextNode());</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;isUnconditional());</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBr(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;getSuccessor(0));</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="comment">// Any static alloca that&#39;s still being used but not reachable from the new</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// entry needs to be moved to the new entry.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = OldEntry-&gt;getParent();</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT{*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>};</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(<a class="code" href="namespacellvm.html#a7e3e687ddfdcbacd404bcf17b917dd88">instructions</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keyword">auto</span> *Alloca = dyn_cast&lt;AllocaInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span> (!Alloca || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.use_empty())</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> (DT.isReachableFromEntry(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()) ||</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        !isa&lt;ConstantInt&gt;(Alloca-&gt;getArraySize()))</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.moveBefore(*Entry, Entry-&gt;getFirstInsertionPt());</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;}</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">/// Derive the value of the new frame pointer.</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Value.html">Value</a> *CoroCloner::deriveNewFramePointer() {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="comment">// Builder should be inserting to the front of the new entry block.</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordflow">switch</span> (Shape.ABI) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// In switch-lowering, the argument is the frame pointer.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">return</span> &amp;*NewF-&gt;arg_begin();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">// In async-lowering, one of the arguments is an async context as determined</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="comment">// by the `llvm.coro.id.async` intrinsic. We can retrieve the async context of</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">// the resume function from the async context projection function associated</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="comment">// with the active suspend. The frame is located as a tail to the async</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// context header.</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>: {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keyword">auto</span> *ActiveAsyncSuspend = cast&lt;CoroSuspendAsyncInst&gt;(ActiveSuspend);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keyword">auto</span> ContextIdx = ActiveAsyncSuspend-&gt;getStorageArgumentIndex() &amp; 0xff;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keyword">auto</span> *CalleeContext = NewF-&gt;getArg(ContextIdx);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keyword">auto</span> *FramePtrTy = Shape.FrameTy-&gt;getPointerTo();</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keyword">auto</span> *ProjectionFunc =</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        ActiveAsyncSuspend-&gt;getAsyncContextProjectionFunction();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keyword">auto</span> DbgLoc =</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        cast&lt;CoroSuspendAsyncInst&gt;(VMap[ActiveSuspend])-&gt;getDebugLoc();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">// Calling i8* (i8*)</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">auto</span> *CallerContext = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(ProjectionFunc-&gt;getFunctionType(),</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                             ProjectionFunc, CalleeContext);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    CallerContext-&gt;setCallingConv(ProjectionFunc-&gt;getCallingConv());</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    CallerContext-&gt;setDebugLoc(DbgLoc);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">// The frame is located after the async_context header.</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getContext();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keyword">auto</span> *FramePtrAddr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateConstInBoundsGEP1_32(</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>), CallerContext,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        Shape.AsyncLowering.FrameOffset, <span class="stringliteral">&quot;async.ctx.frameptr&quot;</span>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// Inline the projection function.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="classllvm_1_1InlineFunctionInfo.html">InlineFunctionInfo</a> <a class="code" href="FunctionInfo_8cpp.html#a3e1eb307ada3e1ef3a115f4c734aa5eeac1775aaace95748849e1216a09f028fc">InlineInfo</a>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keyword">auto</span> InlineRes = <a class="code" href="namespacellvm.html#ab5a3ac0a249da0743dac1bd816d8e5d5">InlineFunction</a>(*CallerContext, <a class="code" href="FunctionInfo_8cpp.html#a3e1eb307ada3e1ef3a115f4c734aa5eeac1775aaace95748849e1216a09f028fc">InlineInfo</a>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InlineRes.isSuccess());</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    (void)InlineRes;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(FramePtrAddr, FramePtrTy);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="comment">// In continuation-lowering, the argument is the opaque storage.</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>: {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="classllvm_1_1Argument.html">Argument</a> *NewStorage = &amp;*NewF-&gt;arg_begin();</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keyword">auto</span> FramePtrTy = Shape.FrameTy-&gt;getPointerTo();</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// If the storage is inline, just bitcast to the storage to the frame type.</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (Shape.RetconLowering.IsFrameInlineInStorage)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(NewStorage, FramePtrTy);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// Otherwise, load the real frame from the opaque storage.</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keyword">auto</span> FramePtrPtr =</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(NewStorage, FramePtrTy-&gt;getPointerTo());</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(FramePtrTy, FramePtrPtr);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;bad ABI&quot;</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;}</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a7c497627acf5128770bd9fa245b44fbd">  844</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a7c497627acf5128770bd9fa245b44fbd">addFramePointerAttrs</a>(<a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>, <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>,</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                 <span class="keywordtype">unsigned</span> ParamIndex, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Size,</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                 <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment, <span class="keywordtype">bool</span> NoAlias) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a> ParamAttrs(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  ParamAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a59d23ba2e7eac46cbc6cd3086e013b49">addAttribute</a>(Attribute::NonNull);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  ParamAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a59d23ba2e7eac46cbc6cd3086e013b49">addAttribute</a>(Attribute::NoUndef);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">if</span> (NoAlias)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    ParamAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a59d23ba2e7eac46cbc6cd3086e013b49">addAttribute</a>(Attribute::NoAlias);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  ParamAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a062f49b866f0e49c0dd872c2a904b5db">addAlignmentAttr</a>(Alignment);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  ParamAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a676e566281b7f39a0c685bc6d1032283">addDereferenceableAttr</a>(Size);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>.addParamAttributes(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, ParamIndex, ParamAttrs);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a2c299a4357972cc32be0eda57abda580">  859</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a2c299a4357972cc32be0eda57abda580">addAsyncContextAttrs</a>(<a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>, <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>,</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                 <span class="keywordtype">unsigned</span> ParamIndex) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a> ParamAttrs(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  ParamAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a59d23ba2e7eac46cbc6cd3086e013b49">addAttribute</a>(Attribute::SwiftAsync);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>.addParamAttributes(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, ParamIndex, ParamAttrs);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a0e09834bc2b325fc2f777641292396e1">  866</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a0e09834bc2b325fc2f777641292396e1">addSwiftSelfAttrs</a>(<a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>, <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>,</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                              <span class="keywordtype">unsigned</span> ParamIndex) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a> ParamAttrs(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  ParamAttrs.<a class="code" href="classllvm_1_1AttrBuilder.html#a59d23ba2e7eac46cbc6cd3086e013b49">addAttribute</a>(Attribute::SwiftSelf);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>.addParamAttributes(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, ParamIndex, ParamAttrs);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">/// Clone the body of the original function into a resume function of</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">/// some sort.</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> CoroCloner::create() {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// Create the new function if we don&#39;t already have one.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordflow">if</span> (!NewF) {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    NewF = <a class="code" href="CoroSplit_8cpp.html#aaef0869616c26b47efe87a72269d52b7">createCloneDeclaration</a>(OrigF, Shape, Suffix,</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                  OrigF.getParent()-&gt;end(), ActiveSuspend);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">// Replace all args with dummy instructions. If an argument is the old frame</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">// pointer, the dummy will be replaced by the new frame pointer once it is</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="comment">// computed below. Uses of all other arguments should have already been</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">// rewritten by buildCoroutineFrame() to use loads/stores on the coroutine</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// frame.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *&gt;</a> DummyArgs;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> &amp;A : OrigF.args()) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    DummyArgs.push_back(<span class="keyword">new</span> <a class="code" href="classllvm_1_1FreezeInst.html">FreezeInst</a>(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getType())));</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    VMap[&amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>] = DummyArgs.back();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ReturnInst *, 4&gt;</a> Returns;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// Ignore attempts to change certain attributes of the function.</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// TODO: maybe there should be a way to suppress this during cloning?</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keyword">auto</span> savedVisibility = NewF-&gt;getVisibility();</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keyword">auto</span> savedUnnamedAddr = NewF-&gt;getUnnamedAddr();</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keyword">auto</span> savedDLLStorageClass = NewF-&gt;getDLLStorageClass();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// NewF&#39;s linkage (which CloneFunctionInto does *not* change) might not</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">// be compatible with the visibility of OrigF (which it *does* change),</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">// so protect against that.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keyword">auto</span> savedLinkage = NewF-&gt;getLinkage();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  NewF-&gt;setLinkage(<a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca6c93794d7b99cd433e96c53eadb15a6e">llvm::GlobalValue::ExternalLinkage</a>);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <a class="code" href="namespacellvm.html#ac1b2be839460bb277d4f07f4aa5225ac">CloneFunctionInto</a>(NewF, &amp;OrigF, VMap,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                    <a class="code" href="namespacellvm.html#abe00617fc34ceb1aa0eb62995732b30aa68b46a44773674a07e6730fac74fc46b">CloneFunctionChangeType::LocalChangesOnly</a>, Returns);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = NewF-&gt;getContext();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">// For async functions / continuations, adjust the scope line of the</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">// clone to the line number of the suspend point. However, only</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">// adjust the scope line when the files are the same. This ensures</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// line number and file name belong together. The scope line is</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// associated with all pre-prologue instructions. This avoids a jump</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">// in the linetable from the function declaration to the suspend point.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *SP = NewF-&gt;<a class="code" href="classllvm_1_1DILocalScope.html#a0e0b4a5906e0bc2a7fa033548c59a220">getSubprogram</a>()) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SP != OrigF.getSubprogram() &amp;&amp; SP-&gt;isDistinct());</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (ActiveSuspend)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = ActiveSuspend-&gt;getDebugLoc())</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">if</span> (SP-&gt;getFile() == <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getFile())</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          SP-&gt;setScopeLine(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>-&gt;getLine());</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">// Update the linkage name to reflect the modified symbol name. It</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">// is necessary to update the linkage name in Swift, since the</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">// mangling changes for resume functions. It might also be the</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// right thing to do in C++, but due to a limitation in LLVM&#39;s</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// AsmPrinter we can only do this if the function doesn&#39;t have an</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// abstract specification, since the DWARF backend expects the</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">// abstract specification to contain the linkage name and asserts</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// that they are identical.</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">if</span> (!SP-&gt;getDeclaration() &amp;&amp; SP-&gt;getUnit() &amp;&amp;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        SP-&gt;getUnit()-&gt;getSourceLanguage() == dwarf::DW_LANG_Swift)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      SP-&gt;replaceLinkageName(<a class="code" href="classllvm_1_1MDString.html#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, NewF-&gt;getName()));</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  NewF-&gt;setLinkage(savedLinkage);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  NewF-&gt;setVisibility(savedVisibility);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  NewF-&gt;setUnnamedAddr(savedUnnamedAddr);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  NewF-&gt;setDLLStorageClass(savedDLLStorageClass);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">// The function sanitizer metadata needs to match the signature of the</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">// function it is being attached to. However this does not hold for split</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">// functions here. Thus remove the metadata for split functions.</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordflow">if</span> (Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a> &amp;&amp;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      NewF-&gt;hasMetadata(LLVMContext::MD_func_sanitize))</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    NewF-&gt;eraseMetadata(LLVMContext::MD_func_sanitize);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">// Replace the attributes of the new function:</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keyword">auto</span> OrigAttrs = NewF-&gt;getAttributes();</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keyword">auto</span> NewAttrs = <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a>();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordflow">switch</span> (Shape.ABI) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// Bootstrap attributes by copying function attributes from the</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="comment">// original function.  This should include optimization settings and so on.</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    NewAttrs = NewAttrs.addFnAttributes(</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, OrigAttrs.getFnAttrs()));</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a7c497627acf5128770bd9fa245b44fbd">addFramePointerAttrs</a>(NewAttrs, <a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, 0, Shape.FrameSize,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                         Shape.FrameAlign, <span class="comment">/*NoAlias=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>: {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keyword">auto</span> *ActiveAsyncSuspend = cast&lt;CoroSuspendAsyncInst&gt;(ActiveSuspend);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">if</span> (OrigF.hasParamAttribute(Shape.AsyncLowering.ContextArgNo,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                Attribute::SwiftAsync)) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <a class="code" href="classuint32__t.html">uint32_t</a> ArgAttributeIndices =</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          ActiveAsyncSuspend-&gt;getStorageArgumentIndex();</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keyword">auto</span> ContextArgIndex = ArgAttributeIndices &amp; 0xff;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#a2c299a4357972cc32be0eda57abda580">addAsyncContextAttrs</a>(NewAttrs, <a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, ContextArgIndex);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="comment">// `swiftasync` must preceed `swiftself` so 0 is not a valid index for</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="comment">// `swiftself`.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keyword">auto</span> SwiftSelfIndex = ArgAttributeIndices &gt;&gt; 8;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keywordflow">if</span> (SwiftSelfIndex)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="CoroSplit_8cpp.html#a0e09834bc2b325fc2f777641292396e1">addSwiftSelfAttrs</a>(NewAttrs, <a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, SwiftSelfIndex);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">// Transfer the original function&#39;s attributes.</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keyword">auto</span> FnAttrs = OrigF.getAttributes().getFnAttrs();</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    NewAttrs = NewAttrs.addFnAttributes(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, FnAttrs));</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// If we have a continuation prototype, just use its attributes,</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// full-stop.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    NewAttrs = Shape.RetconLowering.ResumePrototype-&gt;getAttributes();</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">    /// FIXME: Is it really good to add the NoAlias attribute?</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"></span>    <a class="code" href="CoroSplit_8cpp.html#a7c497627acf5128770bd9fa245b44fbd">addFramePointerAttrs</a>(NewAttrs, <a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, 0,</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                         Shape.getRetconCoroId()-&gt;getStorageSize(),</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                         Shape.getRetconCoroId()-&gt;getStorageAlignment(),</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                         <span class="comment">/*NoAlias=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">switch</span> (Shape.ABI) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// In these ABIs, the cloned functions always return &#39;void&#39;, and the</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="comment">// existing return sites are meaningless.  Note that for unique</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// continuations, this includes the returns associated with suspends;</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">// this is fine because we can&#39;t suspend twice.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="comment">// Remove old returns.</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1ReturnInst.html">ReturnInst</a> *Return : Returns)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <a class="code" href="namespacellvm.html#a97370114df349e0996f133e3402c1595">changeToUnreachable</a>(Return);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="comment">// With multi-suspend continuations, we&#39;ll already have eliminated the</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="comment">// original returns and inserted returns before all the suspend points,</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="comment">// so we want to leave any returns in place.</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="comment">// Async lowering will insert musttail call functions at all suspend points</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="comment">// followed by a return.</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">// Don&#39;t change returns to unreachable because that will trip up the verifier.</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="comment">// These returns should be unreachable from the clone.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  NewF-&gt;setAttributes(NewAttrs);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  NewF-&gt;setCallingConv(Shape.getResumeFunctionCC());</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">// Set up the new entry block.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  replaceEntryBlock();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;NewF-&gt;getEntryBlock().front());</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  NewFramePtr = deriveNewFramePointer();</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// Remap frame pointer.</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OldFramePtr = VMap[Shape.FramePtr];</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  NewFramePtr-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(OldFramePtr);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  OldFramePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewFramePtr);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="comment">// Remap vFrame pointer.</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keyword">auto</span> *NewVFrame = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      NewFramePtr, <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getContext()), <span class="stringliteral">&quot;vFrame&quot;</span>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OldVFrame = cast&lt;Value&gt;(VMap[Shape.CoroBegin]);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">if</span> (OldVFrame != NewVFrame)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    OldVFrame-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewVFrame);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="comment">// All uses of the arguments should have been resolved by this point,</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="comment">// so we can safely remove the dummy values.</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *DummyArg : DummyArgs) {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    DummyArg-&gt;replaceAllUsesWith(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(DummyArg-&gt;getType()));</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    DummyArg-&gt;deleteValue();</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordflow">switch</span> (Shape.ABI) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">// Rewrite final suspend handling as it is not done via switch (allows to</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">// remove final case from the switch, since it is undefined behavior to</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">// resume the coroutine suspended at the final suspend point.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">if</span> (Shape.SwitchLowering.HasFinalSuspend)</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      handleFinalSuspend();</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">// Replace uses of the active suspend with the corresponding</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">// continuation-function arguments.</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ActiveSuspend != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;           <span class="stringliteral">&quot;no active suspend when lowering a continuation-style coroutine&quot;</span>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    replaceRetconOrAsyncSuspendUses();</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="comment">// Handle suspends.</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  replaceCoroSuspends();</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="comment">// Handle swifterror.</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>();</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="comment">// Remove coro.end intrinsics.</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  replaceCoroEnds();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="comment">// Salvage debug info that points into the coroutine frame.</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <a class="code" href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">salvageDebugInfo</a>();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="comment">// Eliminate coro.free from the clones, replacing it with &#39;null&#39; in cleanup,</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="comment">// to suppress deallocation code.</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">if</span> (Shape.ABI == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <a class="code" href="namespacellvm_1_1coro.html#abf799de7147065c0e7f525e1b6009dde">coro::replaceCoroFree</a>(cast&lt;CoroIdInst&gt;(VMap[Shape.CoroBegin-&gt;getId()]),</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                          <span class="comment">/*Elide=*/</span> FKind == CoroCloner::Kind::SwitchCleanup);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;}</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">// Create a resume clone by cloning the body of the original function, setting</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">// new entry block and replacing coro.suspend an appropriate value to force</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">// resume or cleanup pass for every suspend point.</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aad4d1ceccdf98781e400898ad3b0e465"> 1092</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="CoroSplit_8cpp.html#aad4d1ceccdf98781e400898ad3b0e465">createClone</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix,</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                             <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, CoroCloner::Kind FKind) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  CoroCloner Cloner(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Suffix, Shape, FKind);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  Cloner.create();</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordflow">return</span> Cloner.getFunction();</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;}</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab02a4d4ecc962ea09ed6c79ebc699a54"> 1099</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ab02a4d4ecc962ea09ed6c79ebc699a54">updateAsyncFuncPointerContextSize</a>(<a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keyword">auto</span> *FuncPtrStruct = cast&lt;ConstantStruct&gt;(</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a025046ebc1affc226aa470223f73794c">AsyncFuncPointer</a>-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">getInitializer</a>());</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keyword">auto</span> *OrigRelativeFunOffset = FuncPtrStruct-&gt;getOperand(0);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="keyword">auto</span> *OrigContextSize = FuncPtrStruct-&gt;getOperand(1);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keyword">auto</span> *NewContextSize = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(OrigContextSize-&gt;getType(),</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                          Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a6b353e50aa2fb0fadf3c46ad81a28e00">ContextSize</a>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keyword">auto</span> *NewFuncPtrStruct = <a class="code" href="classllvm_1_1ConstantStruct.html#a54fcfa620deb80373f489ba2fdad7643">ConstantStruct::get</a>(</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      FuncPtrStruct-&gt;getType(), OrigRelativeFunOffset, NewContextSize);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a025046ebc1affc226aa470223f73794c">AsyncFuncPointer</a>-&gt;<a class="code" href="classllvm_1_1GlobalVariable.html#a095f8f031d99ce3c0b25478713293dea">setInitializer</a>(NewFuncPtrStruct);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;}</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a8543371395854bee27033b8e24836cb0"> 1114</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a8543371395854bee27033b8e24836cb0">replaceFrameSizeAndAlignment</a>(<a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#ab02a4d4ecc962ea09ed6c79ebc699a54">updateAsyncFuncPointerContextSize</a>(Shape);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CoroAlignInst.html">CoroAlignInst</a> *CA : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ad49b292032d2eebe5e027ab2d4445e6d">CoroAligns</a>) {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    CA-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CA-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>.<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>()));</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    CA-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">CoroSizes</a>.empty())</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="comment">// In the same function all coro.sizes should have the same result type.</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keyword">auto</span> *SizeIntrin = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">CoroSizes</a>.back();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = SizeIntrin-&gt;getModule();</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDataLayout();</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keyword">auto</span> Size = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keyword">auto</span> *SizeConstant = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeIntrin-&gt;getType(), Size);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CoroSizeInst.html">CoroSizeInst</a> *CS : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">CoroSizes</a>) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    CS-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(SizeConstant);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    CS-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;}</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">// Create a global constant array containing pointers to functions provided and</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">// set Info parameter of CoroBegin to point at this constant. Example:</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">//   @f.resumers = internal constant [2 x void(%f.frame*)*]</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">//                    [void(%f.frame*)* @f.resume, void(%f.frame*)* @f.destroy]</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">//   define void @f() {</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">//     ...</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">//     call i8* @llvm.coro.begin(i8* null, i32 0, i8* null,</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">//                    i8* bitcast([2 x void(%f.frame*)*] * @f.resumers to i8*))</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">// Assumes that all the functions have the same signature.</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66"> 1151</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66">setCoroInfo</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Function *&gt;</a> Fns) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="comment">// This only works under the switch-lowering ABI because coro elision</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">// only works on the switch-lowering ABI.</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 4&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>(Fns.<a class="code" href="classllvm_1_1ArrayRef.html#aab36927882fbfdcbb860d87fd9c30da8">begin</a>(), Fns.<a class="code" href="classllvm_1_1ArrayRef.html#a7ca5197533a9c1fb8a2bd30587fcec6b">end</a>());</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.empty());</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *Part = *Fns.<a class="code" href="classllvm_1_1ArrayRef.html#aab36927882fbfdcbb860d87fd9c30da8">begin</a>();</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = Part-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keyword">auto</span> *ArrTy = <a class="code" href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">ArrayType::get</a>(Part-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a92041fc7f781ba4fe708eec99139b72f">getType</a>(), <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.size());</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keyword">auto</span> *ConstVal = <a class="code" href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">ConstantArray::get</a>(ArrTy, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keyword">auto</span> *GV = <span class="keyword">new</span> <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(*<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, ConstVal-&gt;getType(), <span class="comment">/*isConstant=*/</span><span class="keyword">true</span>,</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                <a class="code" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">GlobalVariable::PrivateLinkage</a>, ConstVal,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.resumers&quot;</span>));</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">// Update coro.begin instruction to refer to this constant.</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keyword">auto</span> *BC = <a class="code" href="classllvm_1_1ConstantExpr.html#a1f469b1f703519ae25ce564c8704310f">ConstantExpr::getPointerCast</a>(GV, <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>));</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a3c5bfa27332d63608ee16d8e61c7682a">getSwitchCoroId</a>()-&gt;<a class="code" href="classllvm_1_1CoroIdInst.html#a11b71b3b2f2b4d214a7eac47e628b3d2">setInfo</a>(BC);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;}</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">// Store addresses of Resume/Destroy/Cleanup functions in the coroutine frame.</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83"> 1175</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83">updateCoroFrame</a>(<a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, <a class="code" href="classllvm_1_1Function.html">Function</a> *ResumeFn,</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                            <a class="code" href="classllvm_1_1Function.html">Function</a> *DestroyFn, <a class="code" href="classllvm_1_1Function.html">Function</a> *CleanupFn) {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>());</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keyword">auto</span> *ResumeAddr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStructGEP(</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>, <a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a3e10a8a52059efadba225b68fbb26451a012dd1dc85c718e8159980fa4273d9e6">coro::Shape::SwitchFieldIndex::Resume</a>,</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="stringliteral">&quot;resume.addr&quot;</span>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(ResumeFn, ResumeAddr);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DestroyOrCleanupFn = DestroyFn;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <a class="code" href="classllvm_1_1CoroIdInst.html">CoroIdInst</a> *CoroId = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a3c5bfa27332d63608ee16d8e61c7682a">getSwitchCoroId</a>();</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CoroAllocInst.html">CoroAllocInst</a> *CA = CoroId-&gt;<a class="code" href="classllvm_1_1AnyCoroIdInst.html#a612ac469ca41e39c081d41f40e48cfaa">getCoroAlloc</a>()) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// If there is a CoroAlloc and it returns false (meaning we elide the</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">// allocation, use CleanupFn instead of DestroyFn).</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    DestroyOrCleanupFn = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSelect(CA, DestroyFn, CleanupFn);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keyword">auto</span> *DestroyAddr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStructGEP(</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>, <a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a3e10a8a52059efadba225b68fbb26451a0416e9f2fbff942bd66bfa6d7e759d47">coro::Shape::SwitchFieldIndex::Destroy</a>,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="stringliteral">&quot;destroy.addr&quot;</span>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(DestroyOrCleanupFn, DestroyAddr);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;}</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d"> 1201</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <a class="code" href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">removeUnreachableBlocks</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">// For now, we do a mandatory verification step because we don&#39;t</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">// entirely trust this pass.  Note that we don&#39;t want to add a verifier</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="comment">// pass to FPM below because it will also verify all the global data.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a26389c546573f058ad8ecbdc5c1933cf">verifyFunction</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &amp;<a class="code" href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()))</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(<span class="stringliteral">&quot;Broken function&quot;</span>);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;}</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">// Assuming we arrived at the block NewBlock from Prev instruction, store</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">// PHI&#39;s incoming values in the ResolvedValues map.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387"> 1216</a></span>&#160;<a class="code" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Prev, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBlock,</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                          <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;ResolvedValues) {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keyword">auto</span> *PrevBB = Prev-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN : NewBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keyword">auto</span> V = PN.getIncomingValueForBlock(PrevBB);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">// See if we already resolved it.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keyword">auto</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a97bce951e4585a39601c04d86bb14ffd">VI</a> = ResolvedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(V);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a97bce951e4585a39601c04d86bb14ffd">VI</a> != ResolvedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      V = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a97bce951e4585a39601c04d86bb14ffd">VI</a>-&gt;second;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">// Remember the value.</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    ResolvedValues[&amp;PN] = V;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;}</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">// Replace a sequence of branches leading to a ret, with a clone of a ret</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">// instruction. Suspend instruction represented by a switch, track the PHI</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">// values and select the correct case successor when possible.</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307"> 1233</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307">simplifyTerminatorLeadingToRet</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InitialInst) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Value *&gt;</a> ResolvedValues;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *UnconditionalSucc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InitialInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>());</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = InitialInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="keyword">auto</span> GetFirstValidInstruction = [](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="comment">// BitCastInst wouldn&#39;t generate actual code so that we could skip it.</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="keywordflow">if</span> (isa&lt;BitCastInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isDebugOrPseudoInst() ||</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isLifetimeStartOrEnd())</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getNextNode();</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">isInstructionTriviallyDead</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="comment">// Duing we are in the middle of the transformation, we need to erase</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="comment">// the dead instruction manually.</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = &amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  };</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keyword">auto</span> TryResolveConstant = [&amp;ResolvedValues](<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keyword">auto</span> It = ResolvedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(V);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">if</span> (It != ResolvedValues.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      V = It-&gt;second;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">return</span> dyn_cast&lt;ConstantInt&gt;(V);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  };</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = InitialInst;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isTerminator() || isa&lt;CmpInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">if</span> (isa&lt;ReturnInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != InitialInst) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="comment">// If InitialInst is an unconditional branch,</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="comment">// remove PHI values that come from basic block of InitialInst</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">if</span> (UnconditionalSucc)</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          UnconditionalSucc-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#afe7af0c3ec2ef1f525173acd2ea4ba60">removePredecessor</a>(InitialInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <a class="code" href="namespacellvm.html#a016a85f7487f995fe80141e102a7a5ae">ReplaceInstWithInst</a>(InitialInst, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;clone());</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a> = dyn_cast&lt;BranchInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a>-&gt;isUnconditional()) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ = <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a>-&gt;getSuccessor(0);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == InitialInst)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;          UnconditionalSucc = Succ;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <a class="code" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Succ, ResolvedValues);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = GetFirstValidInstruction(Succ-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a74922788bb2b2a204fe51f04026d6859">getFirstNonPHIOrDbgOrLifetime</a>());</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a>-&gt;getParent();</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <span class="comment">// Handle the case the condition of the conditional branch is constant.</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="comment">// e.g.,</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="comment">//     br i1 false, label %cleanup, label %CoroEnd</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="comment">// It is possible during the transformation. We could continue the</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="comment">// simplifying in this case.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a152d8c380cc937c9dceb402ceec943b6">ConstantFoldTerminator</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <span class="comment">/*DeleteDeadConditions=*/</span><span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="comment">// Handle this branch in next iteration.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CondCmp = dyn_cast&lt;CmpInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="comment">// If the case number of suspended switch instruction is reduced to</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="comment">// 1, then it is simplified to CmpInst in llvm::ConstantFoldTerminator.</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a> = dyn_cast&lt;BranchInst&gt;(</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;          GetFirstValidInstruction(CondCmp-&gt;getNextNode()));</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a> || !<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a>-&gt;isConditional() || CondCmp != <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a>-&gt;getCondition())</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="comment">// And the comparsion looks like : %cond = icmp eq i8 %V, constant.</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="comment">// So we try to resolve constant for the first operand only since the</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="comment">// second operand should be literal constant by design.</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Cond0 = TryResolveConstant(CondCmp-&gt;getOperand(0));</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keyword">auto</span> *Cond1 = dyn_cast&lt;ConstantInt&gt;(CondCmp-&gt;getOperand(1));</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keywordflow">if</span> (!Cond0 || !Cond1)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="comment">// Both operands of the CmpInst are Constant. So that we could evaluate</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="comment">// it immediately to get the destination.</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keyword">auto</span> *ConstResult =</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;          dyn_cast_or_null&lt;ConstantInt&gt;(<a class="code" href="namespacellvm.html#a3cd3a3ec28036937ecebe767498ba55d">ConstantFoldCompareInstOperands</a>(</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;              CondCmp-&gt;getPredicate(), Cond0, Cond1, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>));</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordflow">if</span> (!ConstResult)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      CondCmp-&gt;replaceAllUsesWith(ConstResult);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      CondCmp-&gt;eraseFromParent();</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="comment">// Handle this branch in next iteration.</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">BR</a>;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SwitchInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = TryResolveConstant(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition());</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;findCaseValue(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>)-&gt;getCaseSuccessor();</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, ResolvedValues);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = GetFirstValidInstruction(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getFirstNonPHIOrDbgOrLifetime());</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;}</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">// Check whether CI obeys the rules of musttail attribute.</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8"> 1344</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8">shouldBeMustTail</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;CI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1CallBase.html#a018f0394a375233d538109968b76a05a">isInlineAsm</a>())</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="comment">// Match prototypes and calling conventions of resume function.</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *CalleeTy = CI.<a class="code" href="classllvm_1_1CallBase.html#a5e4a09f80c7cd5283dbbc7256d122d12">getFunctionType</a>();</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">if</span> (!CalleeTy-&gt;<a class="code" href="classllvm_1_1FunctionType.html#ac453ad79a3d50950bac79bc9dff85918">getReturnType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">isVoidTy</a>() || (CalleeTy-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a104d6154321899b53e40455e71d8e83a">getNumParams</a>() != 1))</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CalleeParmTy = CalleeTy-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">getParamType</a>(0);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keywordflow">if</span> (!CalleeParmTy-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() ||</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      (CalleeParmTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>() != 0))</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordflow">if</span> (CI.<a class="code" href="classllvm_1_1CallBase.html#a3ff92cec76009e859cb0c419d6e8ba5f">getCallingConv</a>() != <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getCallingConv())</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="comment">// CI should not has any ABI-impacting function attributes.</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">Attribute::AttrKind</a> ABIAttrs[] = {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      Attribute::StructRet,    Attribute::ByVal,     Attribute::InAlloca,</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      Attribute::Preallocated, Attribute::InReg,     Attribute::Returned,</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      Attribute::SwiftSelf,    Attribute::SwiftError};</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a> = CI.<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>();</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> AK : ABIAttrs)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>.hasParamAttr(0, AK))</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;}</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">// Add musttail to any resume instructions that is immediately followed by a</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">// suspend (i.e. ret). We do this even in -O0 to support guaranteed tail call</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">// for symmetrical coroutine control transfer (C++ Coroutines TS extension).</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">// This transformation is done only in the resume part of the coroutine that has</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">// identical signature and calling convention as the coro.resume call.</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a341351eefb2d2b299088ef02333fdaa0"> 1379</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a341351eefb2d2b299088ef02333fdaa0">addMustTailToCoroResumes</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>) {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordtype">bool</span> changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">// Collect potential resume instructions.</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallInst *, 4&gt;</a> Resumes;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#a7e3e687ddfdcbacd404bcf17b917dd88">instructions</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Call = dyn_cast&lt;CallInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8">shouldBeMustTail</a>(*Call, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        Resumes.push_back(Call);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="comment">// Set musttail on those that are followed by a ret instruction.</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Call : Resumes)</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// Skip targets which don&#39;t support tail call on the specific case.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#a2c143ebdce9475bb57428828fe848e3a">supportsTailCallFor</a>(Call) &amp;&amp;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <a class="code" href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307">simplifyTerminatorLeadingToRet</a>(Call-&gt;getNextNode())) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      Call-&gt;setTailCallKind(<a class="code" href="classllvm_1_1CallInst.html#ad682514c13f12f1a8d759d422fce6aefa2c3fc2c37f5db1dd777fad4e0d33ec7e">CallInst::TCK_MustTail</a>);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordflow">if</span> (changed)</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <a class="code" href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">removeUnreachableBlocks</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">// Coroutine has no suspend points. Remove heap allocation for the coroutine</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">// frame if possible.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0"> 1404</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0">handleNoSuspendCoroutine</a>(<a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keyword">auto</span> *CoroBegin = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keyword">auto</span> *CoroId = CoroBegin-&gt;<a class="code" href="classllvm_1_1CoroBeginInst.html#a738fe23c92cdff10d21f7db5236e8c3f">getId</a>();</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="keyword">auto</span> *AllocInst = CoroId-&gt;<a class="code" href="classllvm_1_1AnyCoroIdInst.html#a612ac469ca41e39c081d41f40e48cfaa">getCoroAlloc</a>();</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordflow">switch</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>: {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keyword">auto</span> SwitchId = cast&lt;CoroIdInst&gt;(CoroId);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="namespacellvm_1_1coro.html#abf799de7147065c0e7f525e1b6009dde">coro::replaceCoroFree</a>(SwitchId, <span class="comment">/*Elide=*/</span>AllocInst != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">if</span> (AllocInst) {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(AllocInst);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keyword">auto</span> *Frame = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlloca(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      Frame-&gt;setAlignment(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="keyword">auto</span> *VFrame = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(Frame, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy());</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      AllocInst-&gt;replaceAllUsesWith(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getFalse());</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      AllocInst-&gt;eraseFromParent();</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      CoroBegin-&gt;replaceAllUsesWith(VFrame);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      CoroBegin-&gt;replaceAllUsesWith(CoroBegin-&gt;getMem());</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    CoroBegin-&gt;replaceAllUsesWith(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(CoroBegin-&gt;getType()));</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  CoroBegin-&gt;eraseFromParent();</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;}</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">// SimplifySuspendPoint needs to check that there is no calls between</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">// coro_save and coro_suspend, since any of the calls may potentially resume</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">// the coroutine and if that is the case we cannot eliminate the suspend point.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74"> 1439</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *To) {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != To; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getNextNode()) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// Assume that no intrinsic can resume the coroutine.</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (isa&lt;IntrinsicInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">if</span> (isa&lt;CallBase&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;}</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde"> 1451</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde">hasCallsInBlocksBetween</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SaveBB, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ResDesBB) {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 8&gt;</a> Set;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> Worklist;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  Set.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(SaveBB);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  Worklist.push_back(ResDesBB);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="comment">// Accumulate all blocks between SaveBB and ResDesBB. Because CoroSaveIntr</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="comment">// returns a token consumed by suspend instruction, all blocks in between</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="comment">// will have to eventually hit SaveBB when going backwards from ResDesBB.</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = Worklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    Set.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="keywordflow">if</span> (!Set.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#af74676a3c7447be34bd2c1da76ec0c48">contains</a>(Pred))</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        Worklist.push_back(Pred);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">// SaveBB and ResDesBB are checked separately in hasCallsBetween.</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  Set.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(SaveBB);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  Set.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(ResDesBB);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : Set)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getFirstNonPHI(), <span class="keyword">nullptr</span>))</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;}</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63"> 1480</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63">hasCallsBetween</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Save, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ResumeOrDestroy) {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keyword">auto</span> *SaveBB = Save-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keyword">auto</span> *ResumeOrDestroyBB = ResumeOrDestroy-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="keywordflow">if</span> (SaveBB == ResumeOrDestroyBB)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(Save-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>(), ResumeOrDestroy);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="comment">// Any calls from Save to the end of the block?</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(Save-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>(), <span class="keyword">nullptr</span>))</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="comment">// Any calls from begging of the block up to ResumeOrDestroy?</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(ResumeOrDestroyBB-&gt;getFirstNonPHI(),</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                             ResumeOrDestroy))</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="comment">// Any calls in all of the blocks between SaveBB and ResumeOrDestroyBB?</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde">hasCallsInBlocksBetween</a>(SaveBB, ResumeOrDestroyBB))</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;}</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">// If a SuspendIntrin is preceded by Resume or Destroy, we can eliminate the</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">// suspend point and replace it with nornal control flow.</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0"> 1505</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0">simplifySuspendPoint</a>(<a class="code" href="classllvm_1_1CoroSuspendInst.html">CoroSuspendInst</a> *Suspend,</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                 <a class="code" href="classllvm_1_1CoroBeginInst.html">CoroBeginInst</a> *CoroBegin) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Prev = Suspend-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#ae451867ac0034a201153b54cc466386d">getPrevNode</a>();</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keywordflow">if</span> (!Prev) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keyword">auto</span> *Pred = Suspend-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">if</span> (!Pred)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    Prev = Pred-&gt;getTerminator();</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *CB = dyn_cast&lt;CallBase&gt;(Prev);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordflow">if</span> (!CB)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">getCalledOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="comment">// See if the callsite is for resumption or destruction of the coroutine.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="keyword">auto</span> *SubFn = dyn_cast&lt;CoroSubFnInst&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">if</span> (!SubFn)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="comment">// Does not refer to the current coroutine, we cannot do anything with it.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="keywordflow">if</span> (SubFn-&gt;getFrame() != CoroBegin)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="comment">// See if the transformation is safe. Specifically, see if there are any</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="comment">// calls in between Save and CallInstr. They can potenitally resume the</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">// coroutine rendering this optimization unsafe.</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keyword">auto</span> *Save = Suspend-&gt;<a class="code" href="classllvm_1_1CoroSuspendInst.html#a931c649e87e9b4229a7876755ac0b337">getCoroSave</a>();</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63">hasCallsBetween</a>(Save, CB))</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="comment">// Replace llvm.coro.suspend with the value that results in resumption over</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="comment">// the resume or cleanup path.</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  Suspend-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(SubFn-&gt;getRawIndex());</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  Suspend-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  Save-&gt;eraseFromParent();</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="comment">// No longer need a call to coro.resume or coro.destroy.</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Invoke = dyn_cast&lt;InvokeInst&gt;(CB)) {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(Invoke-&gt;getNormalDest(), Invoke);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; </div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="comment">// Grab the CalledValue from CB before erasing the CallInstr.</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="keyword">auto</span> *CalledValue = CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">getCalledOperand</a>();</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  CB-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">// If no more users remove it. Usually it is a bitcast of SubFn.</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">if</span> (CalledValue != SubFn &amp;&amp; CalledValue-&gt;user_empty())</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(CalledValue))</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="comment">// Now we are good to remove SubFn.</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">if</span> (SubFn-&gt;user_empty())</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    SubFn-&gt;eraseFromParent();</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;}</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">// Remove suspend points that are simplified.</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2"> 1565</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2">simplifySuspendPoints</a>(<a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="comment">// Currently, the only simplification we do is switch-lowering-specific.</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.size();</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> == 0)</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordtype">size_t</span> ChangedFinalIndex = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::numeric_limits&lt;size_t&gt;::max</a>();</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keyword">auto</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = cast&lt;CoroSuspendInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">// Leave final.suspend to handleFinalSuspend since it is undefined behavior</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">// to resume a coroutine suspended at the final suspend point.</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isFinal() &amp;&amp; <a class="code" href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0">simplifySuspendPoint</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)) {</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keywordflow">if</span> (--<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> == <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>[<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>]);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <span class="keywordflow">if</span> (cast&lt;CoroSuspendInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>])-&gt;isFinal()) {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a443e8b3df70f81937afd7c6bf52f9f84">HasFinalSuspend</a>);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        ChangedFinalIndex = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">if</span> (++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.resize(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="comment">// Maintain final.suspend in case final suspend was swapped.</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">// Due to we requrie the final suspend to be the last element of CoroSuspends.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="keywordflow">if</span> (ChangedFinalIndex &lt; <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;CoroSuspendInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>[ChangedFinalIndex])-&gt;isFinal());</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>[ChangedFinalIndex], <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.back());</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;}</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; </div>
<div class="line"><a name="l01606"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a0fda7566c0a6bf592ecf28d4476c6d27"> 1606</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a0fda7566c0a6bf592ecf28d4476c6d27">splitSwitchCoroutine</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                 <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones,</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                 <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>) {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">createResumeEntryBlock</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keyword">auto</span> ResumeClone = <a class="code" href="CoroSplit_8cpp.html#aad4d1ceccdf98781e400898ad3b0e465">createClone</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;.resume&quot;</span>, Shape,</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                                 CoroCloner::Kind::SwitchResume);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="keyword">auto</span> DestroyClone = <a class="code" href="CoroSplit_8cpp.html#aad4d1ceccdf98781e400898ad3b0e465">createClone</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;.destroy&quot;</span>, Shape,</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                  CoroCloner::Kind::SwitchUnwind);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="keyword">auto</span> CleanupClone = <a class="code" href="CoroSplit_8cpp.html#aad4d1ceccdf98781e400898ad3b0e465">createClone</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;.cleanup&quot;</span>, Shape,</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                  CoroCloner::Kind::SwitchCleanup);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(*ResumeClone);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(*DestroyClone);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(*CleanupClone);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="comment">// Adding musttail call to support symmetric transfer.</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="comment">// Skip targets which don&#39;t support tail call.</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="comment">// FIXME: Could we support symmetric transfer effectively without musttail</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="comment">// call?</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>.<a class="code" href="classllvm_1_1TargetTransformInfo.html#ad4d10c3084307035a3ae29cc2f420440">supportsTailCalls</a>())</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a341351eefb2d2b299088ef02333fdaa0">addMustTailToCoroResumes</a>(*ResumeClone, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">// Store addresses resume/destroy/cleanup functions in the coroutine frame.</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83">updateCoroFrame</a>(Shape, ResumeClone, DestroyClone, CleanupClone);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.empty());</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  Clones.push_back(ResumeClone);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  Clones.push_back(DestroyClone);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  Clones.push_back(CleanupClone);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="comment">// Create a constant array referring to resume/destroy/clone functions pointed</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="comment">// by the last argument of @llvm.coro.info, so that CoroElide pass can</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="comment">// determined correct function to call.</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66">setCoroInfo</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;}</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; </div>
<div class="line"><a name="l01645"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#af678f41709f265e2589f247e883aa738"> 1645</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#af678f41709f265e2589f247e883aa738">replaceAsyncResumeFunction</a>(<a class="code" href="classllvm_1_1CoroSuspendAsyncInst.html">CoroSuspendAsyncInst</a> *Suspend,</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                                       <a class="code" href="classllvm_1_1Value.html">Value</a> *Continuation) {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keyword">auto</span> *ResumeIntrinsic = Suspend-&gt;<a class="code" href="classllvm_1_1CoroSuspendAsyncInst.html#afb10bb7eb1e80d78154eed73166c37ce">getResumeFunction</a>();</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = Suspend-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keyword">auto</span> *Int8PtrTy = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(ResumeIntrinsic);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="keyword">auto</span> *Val = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitOrPointerCast(Continuation, Int8PtrTy);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  ResumeIntrinsic-&gt;replaceAllUsesWith(Val);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  ResumeIntrinsic-&gt;eraseFromParent();</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  Suspend-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(<a class="code" href="classllvm_1_1CoroSuspendAsyncInst.html#ad6e1a5840682e8102ea19e9e86f3dcb3a849e006178975accfd029d2d39b1deb1">CoroSuspendAsyncInst::ResumeFunctionArg</a>,</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                      <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(Int8PtrTy));</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;}</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">/// Coerce the arguments in \p FnArgs according to \p FnTy in \p CallArgs.</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab349dce775a8c8dcd72c24059e8357a2"> 1660</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#ab349dce775a8c8dcd72c24059e8357a2">coerceArguments</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *FnTy,</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                            <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> FnArgs,</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                            <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Value *&gt;</a> &amp;CallArgs) {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordtype">size_t</span> ArgIdx = 0;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *paramTy : FnTy-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a0400b7a6fcffcd3892d7bb6de435674a">params</a>()) {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArgIdx &lt; FnArgs.<a class="code" href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">if</span> (paramTy != FnArgs[ArgIdx]-&gt;<a class="code" href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a>())</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      CallArgs.push_back(</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitOrPointerCast(FnArgs[ArgIdx], paramTy));</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      CallArgs.push_back(FnArgs[ArgIdx]);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    ++ArgIdx;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"><a class="line" href="namespacellvm_1_1coro.html#acd1ac3572804d7881248a27e37b78788"> 1675</a></span>&#160;<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1coro.html#acd1ac3572804d7881248a27e37b78788">coro::createMustTailCall</a>(<a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> Loc, <a class="code" href="classllvm_1_1Function.html">Function</a> *MustTailCallFn,</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                                   <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a> <a class="code" href="AMDGPULowerKernelArguments_8cpp.html#a1161e5a4e753384aaba3a8e4533c4261">Arguments</a>,</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                   <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="keyword">auto</span> *FnTy = MustTailCallFn-&gt;<a class="code" href="classllvm_1_1Function.html#adf50671db83d2813e0d897ea2cfc9102">getFunctionType</a>();</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">// Coerce the arguments, llvm optimizations seem to ignore the types in</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="comment">// vaarg functions and throws away casts in optimized mode.</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> CallArgs;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ab349dce775a8c8dcd72c24059e8357a2">coerceArguments</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, FnTy, <a class="code" href="AMDGPULowerKernelArguments_8cpp.html#a1161e5a4e753384aaba3a8e4533c4261">Arguments</a>, CallArgs);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">TailCall</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(FnTy, MustTailCallFn, CallArgs);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">TailCall</a>-&gt;setTailCallKind(<a class="code" href="classllvm_1_1CallInst.html#ad682514c13f12f1a8d759d422fce6aefa2c3fc2c37f5db1dd777fad4e0d33ec7e">CallInst::TCK_MustTail</a>);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">TailCall</a>-&gt;setDebugLoc(Loc);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">TailCall</a>-&gt;setCallingConv(MustTailCallFn-&gt;<a class="code" href="classllvm_1_1Function.html#a5f494edc0a569c7fc9ff4181243be1ed">getCallingConv</a>());</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">TailCall</a>;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;}</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aaabb86d9f06d18a395eec8c40420067e"> 1691</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#aaabb86d9f06d18a395eec8c40420067e">splitAsyncCoroutine</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                                <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones) {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.empty());</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="comment">// Reset various things that the optimizer might have decided it</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="comment">// &quot;knows&quot; about the coroutine function due to not seeing a return.</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeFnAttr(Attribute::NoReturn);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeRetAttr(Attribute::NoAlias);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeRetAttr(Attribute::NonNull);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keyword">auto</span> *Int8PtrTy = <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a> = cast&lt;CoroIdAsyncInst&gt;(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code" href="classllvm_1_1CoroBeginInst.html#a738fe23c92cdff10d21f7db5236e8c3f">getId</a>());</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keyword">auto</span> *FramePtr = <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>-&gt;getStorage();</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  FramePtr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitOrPointerCast(FramePtr, Int8PtrTy);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  FramePtr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateConstInBoundsGEP1_32(</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>), FramePtr, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a257b93881a8ca56ed33f4326672b738d">FrameOffset</a>,</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="stringliteral">&quot;async.ctx.frameptr&quot;</span>);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="comment">// Map all uses of llvm.coro.begin to the allocated frame pointer.</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">// Make sure we don&#39;t invalidate Shape.FramePtr.</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <a class="code" href="classllvm_1_1TrackingVH.html">TrackingVH&lt;Value&gt;</a> Handle(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(FramePtr);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a> = Handle.<a class="code" href="classllvm_1_1TrackingVH.html#a464f543b0e219aca10fd5e8ae9ca3e4b">getValPtr</a>();</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="comment">// Create all the functions in order after the main function.</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="keyword">auto</span> NextF = std::next(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getIterator());</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="comment">// Create a continuation function for each of the suspend points.</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  Clones.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Idx = 0, End = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size(); Idx != End; ++Idx) {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keyword">auto</span> *Suspend = cast&lt;CoroSuspendAsyncInst&gt;(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>[Idx]);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">// Create the clone declaration.</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keyword">auto</span> ResumeNameSuffix = <span class="stringliteral">&quot;.resume.&quot;</span>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keyword">auto</span> ProjectionFunctionName =</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        Suspend-&gt;getAsyncContextProjectionFunction()-&gt;getName();</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keywordtype">bool</span> UseSwiftMangling = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">if</span> (ProjectionFunctionName.equals(<span class="stringliteral">&quot;__swift_async_resume_project_context&quot;</span>)) {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      ResumeNameSuffix = <span class="stringliteral">&quot;TQ&quot;</span>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      UseSwiftMangling = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ProjectionFunctionName.equals(</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                   <span class="stringliteral">&quot;__swift_async_resume_get_context&quot;</span>)) {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      ResumeNameSuffix = <span class="stringliteral">&quot;TY&quot;</span>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      UseSwiftMangling = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keyword">auto</span> *Continuation = <a class="code" href="CoroSplit_8cpp.html#aaef0869616c26b47efe87a72269d52b7">createCloneDeclaration</a>(</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape,</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        UseSwiftMangling ? ResumeNameSuffix + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(Idx) + <span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                         : ResumeNameSuffix + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(Idx),</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        NextF, Suspend);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    Clones.push_back(Continuation);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="comment">// Insert a branch to a new return block immediately before the suspend</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">// point.</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keyword">auto</span> *SuspendBB = Suspend-&gt;getParent();</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keyword">auto</span> *NewSuspendBB = SuspendBB-&gt;splitBasicBlock(Suspend);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> = cast&lt;BranchInst&gt;(SuspendBB-&gt;getTerminator());</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">// Place it before the first suspend.</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keyword">auto</span> *ReturnBB =</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext(), <span class="stringliteral">&quot;coro.return&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, NewSuspendBB);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;setSuccessor(0, ReturnBB);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(ReturnBB);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">// Insert the call to the tail call function and inline it.</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keyword">auto</span> *Fn = Suspend-&gt;getMustTailCallFunction();</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>(Suspend-&gt;args());</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keyword">auto</span> FnArgs = <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>).<a class="code" href="classllvm_1_1ArrayRef.html#a0b7abf908b6ce436de4d1012f2df7c0c">drop_front</a>(</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <a class="code" href="classllvm_1_1CoroSuspendAsyncInst.html#ad6e1a5840682e8102ea19e9e86f3dcb3adea642c56a7c4aa607d2901d060b240c">CoroSuspendAsyncInst::MustTailCallFuncArg</a> + 1);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">TailCall</a> =</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <a class="code" href="namespacellvm_1_1coro.html#acd1ac3572804d7881248a27e37b78788">coro::createMustTailCall</a>(Suspend-&gt;getDebugLoc(), Fn, FnArgs, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRetVoid();</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <a class="code" href="classllvm_1_1InlineFunctionInfo.html">InlineFunctionInfo</a> FnInfo;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keyword">auto</span> InlineRes = <a class="code" href="namespacellvm.html#ab5a3ac0a249da0743dac1bd816d8e5d5">InlineFunction</a>(*<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">TailCall</a>, FnInfo);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InlineRes.isSuccess() &amp;&amp; <span class="stringliteral">&quot;Expected inlining to succeed&quot;</span>);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    (void)InlineRes;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">// Replace the lvm.coro.async.resume intrisic call.</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#af678f41709f265e2589f247e883aa738">replaceAsyncResumeFunction</a>(Suspend, Continuation);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.size() == Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> Idx = 0, End = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size(); Idx != End; ++Idx) {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keyword">auto</span> *Suspend = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>[Idx];</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="keyword">auto</span> *Clone = Clones[Idx];</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    CoroCloner(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;resume.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(Idx), Shape, Clone, Suspend).create();</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;}</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c"> 1788</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c">splitRetconCoroutine</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                                 <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones) {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a> ||</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;         Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.empty());</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="comment">// Reset various things that the optimizer might have decided it</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="comment">// &quot;knows&quot; about the coroutine function due to not seeing a return.</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeFnAttr(Attribute::NoReturn);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeRetAttr(Attribute::NoAlias);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeRetAttr(Attribute::NonNull);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="comment">// Allocate the frame.</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a> = cast&lt;AnyCoroIdRetconInst&gt;(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code" href="classllvm_1_1CoroBeginInst.html#a738fe23c92cdff10d21f7db5236e8c3f">getId</a>());</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RawFramePtr;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">IsFrameInlineInStorage</a>) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    RawFramePtr = <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>-&gt;getStorage();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">// Determine the size of the frame.</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getDataLayout();</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keyword">auto</span> Size = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="comment">// Allocate.  We don&#39;t need to update the call graph node because we&#39;re</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">// going to recompute it from scratch after splitting.</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="comment">// FIXME: pass the required alignment</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    RawFramePtr = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a78fa8f84df72aa178f82c9421b0cf387">emitAlloc</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(Size), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    RawFramePtr =</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(RawFramePtr, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">// Stash the allocated frame pointer in the continuation storage.</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keyword">auto</span> Dest = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>-&gt;getStorage(),</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                                      RawFramePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>());</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(RawFramePtr, Dest);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  }</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="comment">// Map all uses of llvm.coro.begin to the allocated frame pointer.</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// Make sure we don&#39;t invalidate Shape.FramePtr.</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <a class="code" href="classllvm_1_1TrackingVH.html">TrackingVH&lt;Value&gt;</a> Handle(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(RawFramePtr);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a> = Handle.<a class="code" href="classllvm_1_1TrackingVH.html#a464f543b0e219aca10fd5e8ae9ca3e4b">getValPtr</a>();</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="comment">// Create a unique return block.</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ReturnBB = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 4&gt;</a> ReturnPHIs;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="comment">// Create all the functions in order after the main function.</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keyword">auto</span> NextF = std::next(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getIterator());</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="comment">// Create a continuation function for each of the suspend points.</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  Clones.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keyword">auto</span> Suspend = cast&lt;CoroSuspendRetconInst&gt;(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="comment">// Create the clone declaration.</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keyword">auto</span> Continuation =</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        <a class="code" href="CoroSplit_8cpp.html#aaef0869616c26b47efe87a72269d52b7">createCloneDeclaration</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, <span class="stringliteral">&quot;.resume.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>), NextF, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    Clones.push_back(Continuation);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// Insert a branch to the unified return block immediately before</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">// the suspend point.</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keyword">auto</span> SuspendBB = Suspend-&gt;getParent();</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keyword">auto</span> NewSuspendBB = SuspendBB-&gt;splitBasicBlock(Suspend);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> = cast&lt;BranchInst&gt;(SuspendBB-&gt;getTerminator());</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="comment">// Create the unified return block.</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordflow">if</span> (!ReturnBB) {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="comment">// Place it before the first suspend.</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      ReturnBB = <a class="code" href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">BasicBlock::Create</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext(), <span class="stringliteral">&quot;coro.return&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                                    NewSuspendBB);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a872685aee4d3b7567d0538ccaa326228">ReturnBlock</a> = ReturnBB;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(ReturnBB);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160; </div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="comment">// Create PHIs for all the return values.</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ReturnPHIs.empty());</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      <span class="comment">// First, the continuation.</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      ReturnPHIs.push_back(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePHI(Continuation-&gt;getType(),</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                                             Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size()));</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="comment">// Next, all the directly-yielded values.</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *ResultTy : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#aea126642cb4852180354e49d31e5d4f8">getRetconResultTypes</a>())</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        ReturnPHIs.push_back(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePHI(ResultTy,</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                                               Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size()));</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="comment">// Build the return value.</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keyword">auto</span> RetTy = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getReturnType();</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="comment">// Cast the continuation value if necessary.</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <span class="comment">// We can&#39;t rely on the types matching up because that type would</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="comment">// have to be infinite.</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="keyword">auto</span> CastedContinuationTy =</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        (ReturnPHIs.size() == 1 ? RetTy : RetTy-&gt;getStructElementType(0));</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="keyword">auto</span> *CastedContinuation =</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(ReturnPHIs[0], CastedContinuationTy);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *RetV;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keywordflow">if</span> (ReturnPHIs.size() == 1) {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        RetV = CastedContinuation;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        RetV = <a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(RetTy);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        RetV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInsertValue(RetV, CastedContinuation, 0);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = ReturnPHIs.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;          RetV = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInsertValue(RetV, ReturnPHIs[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateRet(RetV);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="comment">// Branch to the return block.</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;setSuccessor(0, ReturnBB);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    ReturnPHIs[0]-&gt;addIncoming(Continuation, SuspendBB);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordtype">size_t</span> NextPHIIndex = 1;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;VUse : Suspend-&gt;value_operands())</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      ReturnPHIs[NextPHIIndex++]-&gt;addIncoming(&amp;*VUse, SuspendBB);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NextPHIIndex == ReturnPHIs.size());</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  }</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.size() == Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keyword">auto</span> Suspend = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keyword">auto</span> Clone = Clones[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    CoroCloner(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;resume.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>), Shape, Clone, Suspend).create();</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  }</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;}</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="keyword">class </span>PrettyStackTraceFunction : <span class="keyword">public</span> <a class="code" href="classllvm_1_1PrettyStackTraceEntry.html">PrettyStackTraceEntry</a> {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    PrettyStackTraceFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {}</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;While splitting coroutine &quot;</span>;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.printAsOperand(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <span class="comment">/*print type*/</span> <span class="keyword">false</span>, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent());</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  };</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;}</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="keyword">static</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a></div>
<div class="line"><a name="l01933"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ac0d65c02370b6785a7163e5aa9de6f05"> 1933</a></span>&#160;<a class="code" href="CoroSplit_8cpp.html#ac0d65c02370b6785a7163e5aa9de6f05">splitCoroutine</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones,</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;               <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, <span class="keywordtype">bool</span> OptimizeFrame,</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;               <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;)&gt; MaterializableCallback) {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  PrettyStackTraceFunction prettyStackTrace(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="comment">// The suspend-crossing algorithm in buildCoroutineFrame get tripped</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="comment">// up by uses in unreachable blocks, so remove them as a first pass.</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <a class="code" href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">removeUnreachableBlocks</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> Shape(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, OptimizeFrame);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordflow">if</span> (!Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="keywordflow">return</span> Shape;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2">simplifySuspendPoints</a>(Shape);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <a class="code" href="namespacellvm_1_1coro.html#a311a963e369623329d830d9fc086cef5">buildCoroutineFrame</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, MaterializableCallback);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#a8543371395854bee27033b8e24836cb0">replaceFrameSizeAndAlignment</a>(Shape);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="comment">// If there are no suspend points, no split required, just remove</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="comment">// the allocation and deallocation blocks, they are not needed.</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.empty()) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0">handleNoSuspendCoroutine</a>(Shape);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keywordflow">switch</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#a0fda7566c0a6bf592ecf28d4476c6d27">splitSwitchCoroutine</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#aaabb86d9f06d18a395eec8c40420067e">splitAsyncCoroutine</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c">splitRetconCoroutine</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="comment">// Replace all the swifterror operations in the original function.</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="comment">// This invalidates SwiftErrorOps in the Shape.</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; </div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="comment">// Finally, salvage the llvm.dbg.{declare,addr} in our original function that</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="comment">// point into the coroutine frame. We only do this for the current function</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="comment">// since the Cloner salvaged debug info for us in the new coroutine funclets.</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DbgVariableIntrinsic *, 8&gt;</a> Worklist;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;llvm::Value *, llvm::AllocaInst *, 4&gt;</a> DbgPtrAllocaCache;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *DDI = dyn_cast&lt;DbgDeclareInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        Worklist.push_back(DDI);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *DDI = dyn_cast&lt;DbgAddrIntrinsic&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        Worklist.push_back(DDI);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  }</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DDI : Worklist)</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <a class="code" href="namespacellvm_1_1coro.html#a4b6f33a1040beb67526139c880622747">coro::salvageDebugInfo</a>(DbgPtrAllocaCache, DDI, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abcad2d8140114b7cd7e686dde240e5b0">OptimizeFrame</a>);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="keywordflow">return</span> Shape;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;}</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">/// Remove calls to llvm.coro.end in the original function.</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#afef107541dd0bbeac7108de79e829871"> 1997</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#afef107541dd0bbeac7108de79e829871">removeCoroEnds</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *End : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#adc470e92d3cd5fb8d54d7b9179841463">CoroEnds</a>) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#ab289568caaa6647ee577a06e6e12499a">replaceCoroEnd</a>(End, Shape, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>, <span class="comment">/*in resume*/</span> <span class="keyword">false</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;}</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a71999132e148b3feb5a3fc97031a0692"> 2003</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a71999132e148b3feb5a3fc97031a0692">updateCallGraphAfterCoroutineSplit</a>(</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <a class="code" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones, <a class="code" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>,</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <a class="code" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;CG, <a class="code" href="classllvm_1_1AnalysisManager.html">CGSCCAnalysisManager</a> &amp;AM, <a class="code" href="structllvm_1_1CGSCCUpdateResult.html">CGSCCUpdateResult</a> &amp;UR,</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>) {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="keywordflow">if</span> (!Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#afef107541dd0bbeac7108de79e829871">removeCoroEnds</a>(Shape);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1AnyCoroEndInst.html">llvm::AnyCoroEndInst</a> *End : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#adc470e92d3cd5fb8d54d7b9179841463">CoroEnds</a>) {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = End-&gt;getContext();</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      End-&gt;replaceAllUsesWith(<a class="code" href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">ConstantInt::getFalse</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>));</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      End-&gt;eraseFromParent();</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  }</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordflow">if</span> (!Clones.empty()) {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">switch</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">coro::ABI::Switch</a>:</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      <span class="comment">// Each clone in the Switch lowering is independent of the other clones.</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="comment">// Let the LazyCallGraph know about each one separately.</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *Clone : Clones)</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        CG.<a class="code" href="classllvm_1_1LazyCallGraph.html#a8d76834516af3608993c2add103b3a6f">addSplitFunction</a>(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction(), *Clone);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">coro::ABI::Async</a>:</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">coro::ABI::Retcon</a>:</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">coro::ABI::RetconOnce</a>:</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="comment">// Each clone in the Async/Retcon lowering references of the other clones.</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="comment">// Let the LazyCallGraph know about all of them at once.</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <span class="keywordflow">if</span> (!Clones.empty())</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        CG.<a class="code" href="classllvm_1_1LazyCallGraph.html#a952c8adfe8553406e169b98200072a69">addSplitRefRecursiveFunctions</a>(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction(), Clones);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    }</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">// Let the CGSCC infra handle the changes to the original function.</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="namespacellvm.html#a2e739fb4907159062aacbbafea669592">updateCGAndAnalysisManagerForCGSCCPass</a>(CG, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, AM, UR, <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="comment">// Do some cleanup and let the CGSCC infra see if we&#39;ve cleaned up any edges</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="comment">// to the split functions.</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction());</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <a class="code" href="namespacellvm.html#a2a035e8c90cdcf756260ddd5ed0e9a26">updateCGAndAnalysisManagerForFunctionPass</a>(CG, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, AM, UR, <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;}</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">/// Replace a call to llvm.coro.prepare.retcon.</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#acd162cfe23d841a49056ce6436dd2075"> 2050</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#acd162cfe23d841a49056ce6436dd2075">replacePrepare</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Prepare, <a class="code" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;CG,</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                           <a class="code" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="keyword">auto</span> CastFn = Prepare-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0); <span class="comment">// as an i8*</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="keyword">auto</span> Fn = CastFn-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>();   <span class="comment">// as its original type</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">// Attempt to peephole this pattern:</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="comment">//    %0 = bitcast [[TYPE]] @some_function to i8*</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">//    %1 = call @llvm.coro.prepare.retcon(i8* %0)</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="comment">//    %2 = bitcast %1 to [[TYPE]]</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="comment">// ==&gt;</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">//    %2 = @some_function</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(Prepare-&gt;<a class="code" href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">uses</a>())) {</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// Look for bitcasts back to the original function type.</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="keyword">auto</span> *Cast = dyn_cast&lt;BitCastInst&gt;(U.getUser());</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">if</span> (!Cast || Cast-&gt;getType() != Fn-&gt;getType())</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="comment">// Replace and remove the cast.</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    Cast-&gt;replaceAllUsesWith(Fn);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    Cast-&gt;eraseFromParent();</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  }</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="comment">// Replace any remaining uses with the function as an i8*.</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="comment">// This can never directly be a callee, so we don&#39;t need to update CG.</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  Prepare-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(CastFn);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  Prepare-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="comment">// Kill dead bitcasts.</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">auto</span> *Cast = dyn_cast&lt;BitCastInst&gt;(CastFn)) {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordflow">if</span> (!Cast-&gt;use_empty())</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    CastFn = Cast-&gt;getOperand(0);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    Cast-&gt;eraseFromParent();</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;}</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a83664bf5c186d5e2d65853f2cce4ec3a"> 2086</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroSplit_8cpp.html#a83664bf5c186d5e2d65853f2cce4ec3a">replaceAllPrepares</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> *PrepareFn, <a class="code" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;CG,</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                               <a class="code" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(PrepareFn-&gt;<a class="code" href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">uses</a>())) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="comment">// Intrinsics can only be used in calls.</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keyword">auto</span> *Prepare = cast&lt;CallInst&gt;(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.getUser());</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#acd162cfe23d841a49056ce6436dd2075">replacePrepare</a>(Prepare, CG, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;}</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a68cd8d24134223f2dfaf5f482a56f1fd"> 2099</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroSplit_8cpp.html#a68cd8d24134223f2dfaf5f482a56f1fd">addPrepareFunction</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                               <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Fns,</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                               <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Name) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="keyword">auto</span> *PrepareFn = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getFunction(Name);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="keywordflow">if</span> (PrepareFn &amp;&amp; !PrepareFn-&gt;use_empty())</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    Fns.push_back(PrepareFn);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;}</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; </div>
<div class="line"><a name="l02107"></a><span class="lineno"><a class="line" href="structllvm_1_1CoroSplitPass.html#a5f0bac32eb02663f4b3c2cc0adc0b41f"> 2107</a></span>&#160;<a class="code" href="structllvm_1_1CoroSplitPass.html#a5f0bac32eb02663f4b3c2cc0adc0b41f">CoroSplitPass::CoroSplitPass</a>(<span class="keywordtype">bool</span> OptimizeFrame)</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    : MaterializableCallback(coro::<a class="code" href="namespacellvm_1_1coro.html#a53b686b78ff6f0eedd7d4d5a6bdd22bb">defaultMaterializable</a>),</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      OptimizeFrame(OptimizeFrame) {}</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; </div>
<div class="line"><a name="l02111"></a><span class="lineno"><a class="line" href="structllvm_1_1CoroSplitPass.html#a47f6589634ad33a13369ace133b9f4b2"> 2111</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="structllvm_1_1CoroSplitPass.html#a47f6589634ad33a13369ace133b9f4b2">CoroSplitPass::run</a>(<a class="code" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>,</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                                     <a class="code" href="classllvm_1_1AnalysisManager.html">CGSCCAnalysisManager</a> &amp;AM,</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                                     <a class="code" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;CG, <a class="code" href="structllvm_1_1CGSCCUpdateResult.html">CGSCCUpdateResult</a> &amp;UR) {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="comment">// NB: One invariant of a valid LazyCallGraph::SCC is that it must contain a</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="comment">//     non-zero number of nodes, so we assume that here and grab the first</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="comment">//     node&#39;s function&#39;s module.</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>.begin()-&gt;getFunction().getParent();</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> =</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1FunctionAnalysisManagerCGSCCProxy.html">FunctionAnalysisManagerCGSCCProxy</a>&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, CG).getManager();</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160; </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="comment">// Check for uses of llvm.coro.prepare.retcon/async.</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Function *, 2&gt;</a> PrepareFns;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#a68cd8d24134223f2dfaf5f482a56f1fd">addPrepareFunction</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, PrepareFns, <span class="stringliteral">&quot;llvm.coro.prepare.retcon&quot;</span>);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <a class="code" href="CoroSplit_8cpp.html#a68cd8d24134223f2dfaf5f482a56f1fd">addPrepareFunction</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, PrepareFns, <span class="stringliteral">&quot;llvm.coro.prepare.async&quot;</span>);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="comment">// Find coroutines for processing.</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;LazyCallGraph::Node *&gt;</a> Coroutines;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> : <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction().isPresplitCoroutine())</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      Coroutines.push_back(&amp;<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="keywordflow">if</span> (Coroutines.empty() &amp;&amp; PrepareFns.empty())</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keywordflow">if</span> (Coroutines.empty()) {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *PrepareFn : PrepareFns) {</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#a83664bf5c186d5e2d65853f2cce4ec3a">replaceAllPrepares</a>(PrepareFn, CG, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    }</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="comment">// Split all the coroutines.</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> : Coroutines) {</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getFunction();</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CoroSplit: Processing coroutine &#39;&quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName()</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.setSplittedCoroutine();</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Function *, 4&gt;</a> Clones;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keyword">const</span> <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> Shape =</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        <a class="code" href="CoroSplit_8cpp.html#ac0d65c02370b6785a7163e5aa9de6f05">splitCoroutine</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Clones, <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1TargetIRAnalysis.html">TargetIRAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>),</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                       <a class="code" href="structllvm_1_1CoroSplitPass.html#acad6a8cfcddc1bd59394c0f2944f306e">OptimizeFrame</a>, <a class="code" href="structllvm_1_1CoroSplitPass.html#a3dd494278da3453bef21b1223a52fe27">MaterializableCallback</a>);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <a class="code" href="CoroSplit_8cpp.html#a71999132e148b3feb5a3fc97031a0692">updateCallGraphAfterCoroutineSplit</a>(*<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, Shape, Clones, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, CG, AM, UR, <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordflow">if</span> (!Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.empty()) {</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="comment">// Run the CGSCC pipeline on the original and newly split functions.</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      UR.<a class="code" href="structllvm_1_1CGSCCUpdateResult.html#a277c9d45b3b20308e166249fd56598ed">CWorklist</a>.insert(&amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *Clone : Clones)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        UR.<a class="code" href="structllvm_1_1CGSCCUpdateResult.html#a277c9d45b3b20308e166249fd56598ed">CWorklist</a>.insert(CG.<a class="code" href="classllvm_1_1LazyCallGraph.html#a2aa26a48970b4c22a7d85cb0e7fff842">lookupSCC</a>(CG.<a class="code" href="classllvm_1_1LazyCallGraph.html#a2e0002cac27faad0015b4fa7e5a3eb50">get</a>(*Clone)));</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="keywordflow">if</span> (!PrepareFns.empty()) {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *PrepareFn : PrepareFns) {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <a class="code" href="CoroSplit_8cpp.html#a83664bf5c186d5e2d65853f2cce4ec3a">replaceAllPrepares</a>(PrepareFn, CG, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    }</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a48b7ab2f26b9e2bc67de02229a1cdd1f"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">llvm::coro::Shape::CoroSizes</a></div><div class="ttdeci">SmallVector&lt; CoroSizeInst *, 2 &gt; CoroSizes</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00076">CoroInternal.h:76</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ac2458e50c1358135964844abe8d8979d"><div class="ttname"><a href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a></div><div class="ttdeci">static void postSplitCleanup(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01201">CoroSplit.cpp:1201</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ae55e412b7d8666b0c2ae26396f8e0e5f"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">llvm::coro::Shape::getInsertPtAfterFramePtr</a></div><div class="ttdeci">Instruction * getInsertPtAfterFramePtr() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00240">CoroInternal.h:240</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1Argument_html"><div class="ttname"><a href="classllvm_1_1Argument.html">llvm::Argument</a></div><div class="ttdoc">This class represents an incoming formal argument to a Function.</div><div class="ttdef"><b>Definition:</b> <a href="Argument_8h_source.html#l00028">Argument.h:28</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_acd1ac3572804d7881248a27e37b78788"><div class="ttname"><a href="namespacellvm_1_1coro.html#acd1ac3572804d7881248a27e37b78788">llvm::coro::createMustTailCall</a></div><div class="ttdeci">CallInst * createMustTailCall(DebugLoc Loc, Function *MustTailCallFn, ArrayRef&lt; Value * &gt; Arguments, IRBuilder&lt;&gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01675">CoroSplit.cpp:1675</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a7c497627acf5128770bd9fa245b44fbd"><div class="ttname"><a href="CoroSplit_8cpp.html#a7c497627acf5128770bd9fa245b44fbd">addFramePointerAttrs</a></div><div class="ttdeci">static void addFramePointerAttrs(AttributeList &amp;Attrs, LLVMContext &amp;Context, unsigned ParamIndex, uint64_t Size, Align Alignment, bool NoAlias)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00844">CoroSplit.cpp:844</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a68cd8d24134223f2dfaf5f482a56f1fd"><div class="ttname"><a href="CoroSplit_8cpp.html#a68cd8d24134223f2dfaf5f482a56f1fd">addPrepareFunction</a></div><div class="ttdeci">static void addPrepareFunction(const Module &amp;M, SmallVectorImpl&lt; Function * &gt; &amp;Fns, StringRef Name)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l02099">CoroSplit.cpp:2099</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9d3ba236d13373cde794da2023acc7a0"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a></div><div class="ttdeci">Function Attrs</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00215">README_ALTIVEC.txt:215</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetIRAnalysis_html"><div class="ttname"><a href="classllvm_1_1TargetIRAnalysis.html">llvm::TargetIRAnalysis</a></div><div class="ttdoc">Analysis pass providing the TargetTransformInfo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l02626">TargetTransformInfo.h:2626</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage_html_a257b93881a8ca56ed33f4326672b738d"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a257b93881a8ca56ed33f4326672b738d">llvm::coro::Shape::AsyncLoweringStorage::FrameOffset</a></div><div class="ttdeci">uint64_t FrameOffset</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00133">CoroInternal.h:133</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aaef0869616c26b47efe87a72269d52b7"><div class="ttname"><a href="CoroSplit_8cpp.html#aaef0869616c26b47efe87a72269d52b7">createCloneDeclaration</a></div><div class="ttdeci">static Function * createCloneDeclaration(Function &amp;OrigF, coro::Shape &amp;Shape, const Twine &amp;Suffix, Module::iterator InsertBefore, AnyCoroSuspendInst *ActiveSuspend)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00507">CoroSplit.cpp:507</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_af7e642e539e37ca5ee21e8cf1e1748b8"><div class="ttname"><a href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8">shouldBeMustTail</a></div><div class="ttdeci">static bool shouldBeMustTail(const CallInst &amp;CI, const Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01344">CoroSplit.cpp:1344</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocalScope_html_a0e0b4a5906e0bc2a7fa033548c59a220"><div class="ttname"><a href="classllvm_1_1DILocalScope.html#a0e0b4a5906e0bc2a7fa033548c59a220">llvm::DILocalScope::getSubprogram</a></div><div class="ttdeci">DISubprogram * getSubprogram() const</div><div class="ttdoc">Get the subprogram for this scope.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8cpp_source.html#l00965">DebugInfoMetadata.cpp:965</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab8367d5021c982f2e56503edd6abde83"><div class="ttname"><a href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83">updateCoroFrame</a></div><div class="ttdeci">static void updateCoroFrame(coro::Shape &amp;Shape, Function *ResumeFn, Function *DestroyFn, Function *CleanupFn)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01175">CoroSplit.cpp:1175</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html"><div class="ttname"><a href="classllvm_1_1ReturnInst.html">llvm::ReturnInst</a></div><div class="ttdoc">Return a value (possibly void), from a function.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03057">Instructions.h:3057</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a11045c7973ab24a8d6315b61fa337d4e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">llvm::SmallPtrSetImpl::erase</a></div><div class="ttdeci">bool erase(PtrType Ptr)</div><div class="ttdoc">erase - If the set contains the specified pointer, remove it and return true, otherwise return false.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00379">SmallPtrSet.h:379</a></div></div>
<div class="ttc" id="aValueMapper_8h_html"><div class="ttname"><a href="ValueMapper_8h.html">ValueMapper.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnyCoroSuspendInst_html"><div class="ttname"><a href="classllvm_1_1AnyCoroSuspendInst.html">llvm::AnyCoroSuspendInst</a></div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00477">CoroInstr.h:477</a></div></div>
<div class="ttc" id="anamespacellvm_html_a016a85f7487f995fe80141e102a7a5ae"><div class="ttname"><a href="namespacellvm.html#a016a85f7487f995fe80141e102a7a5ae">llvm::ReplaceInstWithInst</a></div><div class="ttdeci">void ReplaceInstWithInst(BasicBlock *BB, BasicBlock::iterator &amp;BI, Instruction *I)</div><div class="ttdoc">Replace the instruction specified by BI with the instruction specified by I.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00576">BasicBlockUtils.cpp:576</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7fe9ccd4893f4e2caa826126c09545ea"><div class="ttname"><a href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">llvm::Type::getInt8PtrTy</a></div><div class="ttdeci">static PointerType * getInt8PtrTy(LLVMContext &amp;C, unsigned AS=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00293">Type.cpp:293</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abe8f7906a8618f90e2a75109a778054a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">llvm::coro::Shape::SwitchLowering</a></div><div class="ttdeci">SwitchLoweringStorage SwitchLowering</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00141">CoroInternal.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3b996fbf8458aafffc86cb98a68d0a47"><div class="ttname"><a href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const</div><div class="ttdoc">True if this is an instance of PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00249">Type.h:249</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a7893161303eb07ae7864db6b3d004d9e"><div class="ttname"><a href="classllvm_1_1Module.html#a7893161303eb07ae7864db6b3d004d9e">llvm::Module::iterator</a></div><div class="ttdeci">FunctionListType::iterator iterator</div><div class="ttdoc">The Function iterators.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00090">Module.h:90</a></div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a24c5fed9b14aed8a3b4f3828472fbab5"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">llvm::coro::Shape::FrameTy</a></div><div class="ttdeci">StructType * FrameTy</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00098">CoroInternal.h:98</a></div></div>
<div class="ttc" id="aInstIterator_8h_html"><div class="ttname"><a href="InstIterator_8h.html">InstIterator.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aEvaluator_8cpp_html_a0b9941c7c78b50f1f303fa0c6403b199"><div class="ttname"><a href="Evaluator_8cpp.html#a0b9941c7c78b50f1f303fa0c6403b199">getFunction</a></div><div class="ttdeci">static Function * getFunction(Constant *C)</div><div class="ttdef"><b>Definition:</b> <a href="Evaluator_8cpp_source.html#l00236">Evaluator.cpp:236</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantStruct_html_a54fcfa620deb80373f489ba2fdad7643"><div class="ttname"><a href="classllvm_1_1ConstantStruct.html#a54fcfa620deb80373f489ba2fdad7643">llvm::ConstantStruct::get</a></div><div class="ttdeci">static Constant * get(StructType *T, ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01314">Constants.cpp:1314</a></div></div>
<div class="ttc" id="aclassllvm_1_1TrackingVH_html_a464f543b0e219aca10fd5e8ae9ca3e4b"><div class="ttname"><a href="classllvm_1_1TrackingVH.html#a464f543b0e219aca10fd5e8ae9ca3e4b">llvm::TrackingVH::getValPtr</a></div><div class="ttdeci">ValueTy * getValPtr() const</div><div class="ttdef"><b>Definition:</b> <a href="ValueHandle_8h_source.html#l00335">ValueHandle.h:335</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aa48f79e7f4c043c7e362c2ea8a7d5c74"><div class="ttname"><a href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a></div><div class="ttdeci">static bool hasCallsInBlockBetween(Instruction *From, Instruction *To)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01439">CoroSplit.cpp:1439</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_a26708685cc8b94fe3d7092ee080dbb34"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">llvm::ilist_node_with_parent::getNextNode</a></div><div class="ttdeci">NodeTy * getNextNode()</div><div class="ttdoc">Get the next node, or nullptr for the list tail.</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00289">ilist_node.h:289</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab5a3ac0a249da0743dac1bd816d8e5d5"><div class="ttname"><a href="namespacellvm.html#ab5a3ac0a249da0743dac1bd816d8e5d5">llvm::InlineFunction</a></div><div class="ttdeci">InlineResult InlineFunction(CallBase &amp;CB, InlineFunctionInfo &amp;IFI, bool MergeAttributes=false, AAResults *CalleeAAR=nullptr, bool InsertLifetime=true, Function *ForwardVarArgsTo=nullptr)</div><div class="ttdoc">This function inlines the called function into the basic block of the caller.</div><div class="ttdef"><b>Definition:</b> <a href="InlineFunction_8cpp_source.html#l02008">InlineFunction.cpp:2008</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt; Value *, 8 &gt;</a></div></div>
<div class="ttc" id="astructllvm_1_1CoroSplitPass_html_a5f0bac32eb02663f4b3c2cc0adc0b41f"><div class="ttname"><a href="structllvm_1_1CoroSplitPass.html#a5f0bac32eb02663f4b3c2cc0adc0b41f">llvm::CoroSplitPass::CoroSplitPass</a></div><div class="ttdeci">CoroSplitPass(bool OptimizeFrame=false)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l02107">CoroSplit.cpp:2107</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a018f0394a375233d538109968b76a05a"><div class="ttname"><a href="classllvm_1_1CallBase.html#a018f0394a375233d538109968b76a05a">llvm::CallBase::isInlineAsm</a></div><div class="ttdeci">bool isInlineAsm() const</div><div class="ttdoc">Check if this call is an inline asm statement.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01474">InstrTypes.h:1474</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166"><div class="ttname"><a href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380aad9d7f07127e321d1358b695c8720166">llvm::coro::ABI::Retcon</a></div><div class="ttdeci">@ Retcon</div><div class="ttdoc">The &quot;returned-continuation&quot; lowering, where each suspend point creates a single continuation function...</div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00039">GlobalVariable.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00880">DenseMap.h:880</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a7e89b55242c964ae61b7850e99cacef0"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">llvm::FunctionType::get</a></div><div class="ttdeci">static FunctionType * get(Type *Result, ArrayRef&lt; Type * &gt; Params, bool isVarArg)</div><div class="ttdoc">This static method is the primary way of constructing a FunctionType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00363">Type.cpp:363</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraph_html"><div class="ttname"><a href="classllvm_1_1CallGraph.html">llvm::CallGraph</a></div><div class="ttdoc">The basic data container for the call graph of a Module of IR.</div><div class="ttdef"><b>Definition:</b> <a href="CallGraph_8h_source.html#l00072">CallGraph.h:72</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26389c546573f058ad8ecbdc5c1933cf"><div class="ttname"><a href="namespacellvm.html#a26389c546573f058ad8ecbdc5c1933cf">llvm::verifyFunction</a></div><div class="ttdeci">bool verifyFunction(const Function &amp;F, raw_ostream *OS=nullptr)</div><div class="ttdoc">Check a function for errors, useful for use when debugging a pass.</div><div class="ttdef"><b>Definition:</b> <a href="Verifier_8cpp_source.html#l06428">Verifier.cpp:6428</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a116742dc8bd808e796becf1166383f63"><div class="ttname"><a href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63">hasCallsBetween</a></div><div class="ttdeci">static bool hasCallsBetween(Instruction *Save, Instruction *ResumeOrDestroy)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01480">CoroSplit.cpp:1480</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b"><div class="ttname"><a href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">llvm::coro::ABI::Switch</a></div><div class="ttdeci">@ Switch</div><div class="ttdoc">The &quot;resume-switch&quot; lowering, where there are separate resume and destroy functions that are shared b...</div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00155">PassManager.h:155</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a9fffac2512fe651f0d5e37e27f5bd51c"><div class="ttname"><a href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">llvm::Function::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">getContext - Return a reference to the LLVMContext associated with this function.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00315">Function.cpp:315</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aebee292426fd0bf7072b2beed8e95387"><div class="ttname"><a href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a></div><div class="ttdeci">static void scanPHIsAndUpdateValueMap(Instruction *Prev, BasicBlock *NewBlock, DenseMap&lt; Value *, Value * &gt; &amp;ResolvedValues)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01216">CoroSplit.cpp:1216</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a4e554c60419835fc3c74b91b28ca31c8"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">llvm::coro::Shape::ABI</a></div><div class="ttdeci">coro::ABI ABI</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00096">CoroInternal.h:96</a></div></div>
<div class="ttc" id="aDenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_aec88b7682025edff7984c3b6c8da8ac9"><div class="ttname"><a href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">llvm::removeUnreachableBlocks</a></div><div class="ttdeci">bool removeUnreachableBlocks(Function &amp;F, DomTreeUpdater *DTU=nullptr, MemorySSAUpdater *MSSAU=nullptr)</div><div class="ttdoc">Remove all blocks that can not be reached from the function's entry.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02614">Local.cpp:2614</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendAsyncInst_html_afb10bb7eb1e80d78154eed73166c37ce"><div class="ttname"><a href="classllvm_1_1CoroSuspendAsyncInst.html#afb10bb7eb1e80d78154eed73166c37ce">llvm::CoroSuspendAsyncInst::getResumeFunction</a></div><div class="ttdeci">CoroAsyncResumeInst * getResumeFunction() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00546">CoroInstr.h:546</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html"><div class="ttname"><a href="classllvm_1_1AttributeList.html">llvm::AttributeList</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00432">Attributes.h:432</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroBeginInst_html_a738fe23c92cdff10d21f7db5236e8c3f"><div class="ttname"><a href="classllvm_1_1CoroBeginInst.html#a738fe23c92cdff10d21f7db5236e8c3f">llvm::CoroBeginInst::getId</a></div><div class="ttdeci">AnyCoroIdInst * getId() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00424">CoroInstr.h:424</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ae0c55761fce39dd71617690b04385193"><div class="ttname"><a href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">llvm::CallBase::getAttributes</a></div><div class="ttdeci">AttributeList getAttributes() const</div><div class="ttdoc">Return the parameter attributes for this call.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01484">InstrTypes.h:1484</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a5e4a09f80c7cd5283dbbc7256d122d12"><div class="ttname"><a href="classllvm_1_1CallBase.html#a5e4a09f80c7cd5283dbbc7256d122d12">llvm::CallBase::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01264">InstrTypes.h:1264</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a8b22bf92719f6baa98dcfe7e99bd5389"><div class="ttname"><a href="CoroSplit_8cpp.html#a8b22bf92719f6baa98dcfe7e99bd5389">replaceCoroEndAsync</a></div><div class="ttdeci">static bool replaceCoroEndAsync(AnyCoroEndInst *End)</div><div class="ttdoc">Replace an llvm.coro.end.async.</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00183">CoroSplit.cpp:183</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a52c990590792c91dd20b6d45acebe359"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">llvm::BasicBlock::splitBasicBlock</a></div><div class="ttdeci">BasicBlock * splitBasicBlock(iterator I, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the basic block into two basic blocks at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00401">BasicBlock.cpp:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnyCoroIdInst_html_a612ac469ca41e39c081d41f40e48cfaa"><div class="ttname"><a href="classllvm_1_1AnyCoroIdInst.html#a612ac469ca41e39c081d41f40e48cfaa">llvm::AnyCoroIdInst::getCoroAlloc</a></div><div class="ttdeci">CoroAllocInst * getCoroAlloc()</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00084">CoroInstr.h:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_html_abe00617fc34ceb1aa0eb62995732b30aa68b46a44773674a07e6730fac74fc46b"><div class="ttname"><a href="namespacellvm.html#abe00617fc34ceb1aa0eb62995732b30aa68b46a44773674a07e6730fac74fc46b">llvm::CloneFunctionChangeType::LocalChangesOnly</a></div><div class="ttdeci">@ LocalChangesOnly</div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9a7b5c68c90f85baaedaa854cc5002cc"><div class="ttname"><a href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">llvm::errs</a></div><div class="ttdeci">raw_fd_ostream &amp; errs()</div><div class="ttdoc">This returns a reference to a raw_ostream for standard error.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8cpp_source.html#l00899">raw_ostream.cpp:899</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab7881567f602c3a94d11e2817f4464e0"><div class="ttname"><a href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0">handleNoSuspendCoroutine</a></div><div class="ttdeci">static void handleNoSuspendCoroutine(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01404">CoroSplit.cpp:1404</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a104d6154321899b53e40455e71d8e83a"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a104d6154321899b53e40455e71d8e83a">llvm::FunctionType::getNumParams</a></div><div class="ttdeci">unsigned getNumParams() const</div><div class="ttdoc">Return the number of fixed parameters this function type requires.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00139">DerivedTypes.h:139</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a59fb91d1691350f7d1b8e8a114e3f2a4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">llvm::BasicBlock::getSinglePredecessor</a></div><div class="ttdeci">const BasicBlock * getSinglePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a single predecessor block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00284">BasicBlock.cpp:284</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_ab9ff52a8227ec3fe5547af29ed59622f"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ab9ff52a8227ec3fe5547af29ed59622f">llvm::coro::Shape::SwitchLoweringStorage::ResumeSwitch</a></div><div class="ttdeci">SwitchInst * ResumeSwitch</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00108">CoroInternal.h:108</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab289568caaa6647ee577a06e6e12499a"><div class="ttname"><a href="CoroSplit_8cpp.html#ab289568caaa6647ee577a06e6e12499a">replaceCoroEnd</a></div><div class="ttdeci">static void replaceCoroEnd(AnyCoroEndInst *End, const coro::Shape &amp;Shape, Value *FramePtr, bool InResume, CallGraph *CG)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00343">CoroSplit.cpp:343</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_ad682514c13f12f1a8d759d422fce6aefa2c3fc2c37f5db1dd777fad4e0d33ec7e"><div class="ttname"><a href="classllvm_1_1CallInst.html#ad682514c13f12f1a8d759d422fce6aefa2c3fc2c37f5db1dd777fad4e0d33ec7e">llvm::CallInst::TCK_MustTail</a></div><div class="ttdeci">@ TCK_MustTail</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01663">Instructions.h:1663</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdeci">@ Load</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7ba5de75f50bb4a4ba920698edf39b28"><div class="ttname"><a href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">llvm::Type::getInt8Ty</a></div><div class="ttdeci">static IntegerType * getInt8Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00239">Type.cpp:239</a></div></div>
<div class="ttc" id="aConstantFolding_8h_html"><div class="ttname"><a href="ConstantFolding_8h.html">ConstantFolding.h</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a1f469b1f703519ae25ce564c8704310f"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a1f469b1f703519ae25ce564c8704310f">llvm::ConstantExpr::getPointerCast</a></div><div class="ttdeci">static Constant * getPointerCast(Constant *C, Type *Ty)</div><div class="ttdoc">Create a BitCast, AddrSpaceCast, or a PtrToInt cast constant expression.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02041">Constants.cpp:2041</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_a4eae23cbbb20b1a985a27727e3901ee6"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a4eae23cbbb20b1a985a27727e3901ee6">llvm::coro::Shape::SwitchLoweringStorage::HasUnwindCoroEnd</a></div><div class="ttdeci">bool HasUnwindCoroEnd</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00115">CoroInternal.h:115</a></div></div>
<div class="ttc" id="aARMLowOverheadLoops_8cpp_html_a0a0971d62011c35b29ff4a2325d45e93"><div class="ttname"><a href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a></div><div class="ttdeci">SmallPtrSet&lt; MachineInstr *, 2 &gt; Uses</div><div class="ttdef"><b>Definition:</b> <a href="ARMLowOverheadLoops_8cpp_source.html#l00590">ARMLowOverheadLoops.cpp:590</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_acad2aaa7f484c978bb790533eec90ac4"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#acad2aaa7f484c978bb790533eec90ac4">llvm::coro::Shape::emitDealloc</a></div><div class="ttdeci">void emitDealloc(IRBuilder&lt;&gt; &amp;Builder, Value *Ptr, CallGraph *CG) const</div><div class="ttdoc">Deallocate memory according to the rules of the active lowering.</div><div class="ttdef"><b>Definition:</b> <a href="Coroutines_8cpp_source.html#l00476">Coroutines.cpp:476</a></div></div>
<div class="ttc" id="aNVVMIntrRange_8cpp_html_afad351d7bf10ac0446b64e7827634e94"><div class="ttname"><a href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a></div><div class="ttdeci">LLVMContext &amp; Context</div><div class="ttdef"><b>Definition:</b> <a href="NVVMIntrRange_8cpp_source.html#l00066">NVVMIntrRange.cpp:66</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroAlignInst_html"><div class="ttname"><a href="classllvm_1_1CoroAlignInst.html">llvm::CoroAlignInst</a></div><div class="ttdoc">This represents the llvm.coro.align instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00603">CoroInstr.h:603</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aPriorityWorklist_8h_html"><div class="ttname"><a href="PriorityWorklist_8h.html">PriorityWorklist.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PrettyStackTraceEntry_html"><div class="ttname"><a href="classllvm_1_1PrettyStackTraceEntry.html">llvm::PrettyStackTraceEntry</a></div><div class="ttdoc">PrettyStackTraceEntry - This class is used to represent a frame of the &quot;pretty&quot; stack trace that is d...</div><div class="ttdef"><b>Definition:</b> <a href="PrettyStackTrace_8h_source.html#l00052">PrettyStackTrace.h:52</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab02a4d4ecc962ea09ed6c79ebc699a54"><div class="ttname"><a href="CoroSplit_8cpp.html#ab02a4d4ecc962ea09ed6c79ebc699a54">updateAsyncFuncPointerContextSize</a></div><div class="ttdeci">static void updateAsyncFuncPointerContextSize(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01099">CoroSplit.cpp:1099</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a2c299a4357972cc32be0eda57abda580"><div class="ttname"><a href="CoroSplit_8cpp.html#a2c299a4357972cc32be0eda57abda580">addAsyncContextAttrs</a></div><div class="ttdeci">static void addAsyncContextAttrs(AttributeList &amp;Attrs, LLVMContext &amp;Context, unsigned ParamIndex)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00859">CoroSplit.cpp:859</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroIdInst_html_a11b71b3b2f2b4d214a7eac47e628b3d2"><div class="ttname"><a href="classllvm_1_1CoroIdInst.html#a11b71b3b2f2b4d214a7eac47e628b3d2">llvm::CoroIdInst::setInfo</a></div><div class="ttdeci">void setInfo(Constant *C)</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00180">CoroInstr.h:180</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage_html_a4df922b446b5bfca3248510df728539b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">llvm::coro::Shape::RetconLoweringStorage::IsFrameInlineInStorage</a></div><div class="ttdeci">bool IsFrameInlineInStorage</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00123">CoroInternal.h:123</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_a2c143ebdce9475bb57428828fe848e3a"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#a2c143ebdce9475bb57428828fe848e3a">llvm::TargetTransformInfo::supportsTailCallFor</a></div><div class="ttdeci">bool supportsTailCallFor(const CallBase *CB) const</div><div class="ttdoc">If target supports tail call on CB.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00544">TargetTransformInfo.cpp:544</a></div></div>
<div class="ttc" id="aGlobalValue_8h_html"><div class="ttname"><a href="GlobalValue_8h.html">GlobalValue.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendAsyncInst_html_ad6e1a5840682e8102ea19e9e86f3dcb3adea642c56a7c4aa607d2901d060b240c"><div class="ttname"><a href="classllvm_1_1CoroSuspendAsyncInst.html#ad6e1a5840682e8102ea19e9e86f3dcb3adea642c56a7c4aa607d2901d060b240c">llvm::CoroSuspendAsyncInst::MustTailCallFuncArg</a></div><div class="ttdeci">@ MustTailCallFuncArg</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00531">CoroInstr.h:531</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1SCC_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1SCC.html">llvm::LazyCallGraph::SCC</a></div><div class="ttdoc">An SCC of the call graph.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00419">LazyCallGraph.h:419</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage_html_a025046ebc1affc226aa470223f73794c"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a025046ebc1affc226aa470223f73794c">llvm::coro::Shape::AsyncLoweringStorage::AsyncFuncPointer</a></div><div class="ttdeci">GlobalVariable * AsyncFuncPointer</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00135">CoroInternal.h:135</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_afef107541dd0bbeac7108de79e829871"><div class="ttname"><a href="CoroSplit_8cpp.html#afef107541dd0bbeac7108de79e829871">removeCoroEnds</a></div><div class="ttdeci">static void removeCoroEnds(const coro::Shape &amp;Shape)</div><div class="ttdoc">Remove calls to llvm.coro.end in the original function.</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01997">CoroSplit.cpp:1997</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aaabb86d9f06d18a395eec8c40420067e"><div class="ttname"><a href="CoroSplit_8cpp.html#aaabb86d9f06d18a395eec8c40420067e">splitAsyncCoroutine</a></div><div class="ttdeci">static void splitAsyncCoroutine(Function &amp;F, coro::Shape &amp;Shape, SmallVectorImpl&lt; Function * &gt; &amp;Clones)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01691">CoroSplit.cpp:1691</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aad4d1ceccdf98781e400898ad3b0e465"><div class="ttname"><a href="CoroSplit_8cpp.html#aad4d1ceccdf98781e400898ad3b0e465">createClone</a></div><div class="ttdeci">static Function * createClone(Function &amp;F, const Twine &amp;Suffix, coro::Shape &amp;Shape, CoroCloner::Kind FKind)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01092">CoroSplit.cpp:1092</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a0e09834bc2b325fc2f777641292396e1"><div class="ttname"><a href="CoroSplit_8cpp.html#a0e09834bc2b325fc2f777641292396e1">addSwiftSelfAttrs</a></div><div class="ttdeci">static void addSwiftSelfAttrs(AttributeList &amp;Attrs, LLVMContext &amp;Context, unsigned ParamIndex)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00866">CoroSplit.cpp:866</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdeci">@ A</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00034">ARMBaseInfo.h:34</a></div></div>
<div class="ttc" id="aTwine_8h_html"><div class="ttname"><a href="Twine_8h.html">Twine.h</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_aea126642cb4852180354e49d31e5d4f8"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#aea126642cb4852180354e49d31e5d4f8">llvm::coro::Shape::getRetconResultTypes</a></div><div class="ttdeci">ArrayRef&lt; Type * &gt; getRetconResultTypes() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00198">CoroInternal.h:198</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendInst_html"><div class="ttname"><a href="classllvm_1_1CoroSuspendInst.html">llvm::CoroSuspendInst</a></div><div class="ttdoc">This represents the llvm.coro.suspend instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00493">CoroInstr.h:493</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aebe6fbeca9d67beead560579e1af9e8c"><div class="ttname"><a href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c">splitRetconCoroutine</a></div><div class="ttdeci">static void splitRetconCoroutine(Function &amp;F, coro::Shape &amp;Shape, SmallVectorImpl&lt; Function * &gt; &amp;Clones)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01788">CoroSplit.cpp:1788</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_aecb93439702247fe5353a9966f7cefcd"><div class="ttname"><a href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">llvm::Value::uses</a></div><div class="ttdeci">iterator_range&lt; use_iterator &gt; uses()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00376">Value.h:376</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a8543371395854bee27033b8e24836cb0"><div class="ttname"><a href="CoroSplit_8cpp.html#a8543371395854bee27033b8e24836cb0">replaceFrameSizeAndAlignment</a></div><div class="ttdeci">static void replaceFrameSizeAndAlignment(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01114">CoroSplit.cpp:1114</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a5fd0aa934908c837c6d78097a2fd667b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">llvm::coro::Shape::CoroSuspends</a></div><div class="ttdeci">SmallVector&lt; AnyCoroSuspendInst *, 4 &gt; CoroSuspends</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00078">CoroInternal.h:78</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="anamespacellvm_html_affedc93ead6b25c57a7196d32ff11e89"><div class="ttname"><a href="namespacellvm.html#affedc93ead6b25c57a7196d32ff11e89">llvm::isPotentiallyReachable</a></div><div class="ttdeci">bool isPotentiallyReachable(const Instruction *From, const Instruction *To, const SmallPtrSetImpl&lt; BasicBlock * &gt; *ExclusionSet=nullptr, const DominatorTree *DT=nullptr, const LoopInfo *LI=nullptr)</div><div class="ttdoc">Determine whether instruction 'To' is reachable from 'From', without passing through any blocks in Ex...</div><div class="ttdef"><b>Definition:</b> <a href="CFG_8cpp_source.html#l00231">CFG.cpp:231</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_adc470e92d3cd5fb8d54d7b9179841463"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#adc470e92d3cd5fb8d54d7b9179841463">llvm::coro::Shape::CoroEnds</a></div><div class="ttdeci">SmallVector&lt; AnyCoroEndInst *, 4 &gt; CoroEnds</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00075">CoroInternal.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a311a963e369623329d830d9fc086cef5"><div class="ttname"><a href="namespacellvm_1_1coro.html#a311a963e369623329d830d9fc086cef5">llvm::coro::buildCoroutineFrame</a></div><div class="ttdeci">void buildCoroutineFrame(Function &amp;F, Shape &amp;Shape, const std::function&lt; bool(Instruction &amp;)&gt; &amp;MaterializableCallback)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02957">CoroFrame.cpp:2957</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_abf799de7147065c0e7f525e1b6009dde"><div class="ttname"><a href="namespacellvm_1_1coro.html#abf799de7147065c0e7f525e1b6009dde">llvm::coro::replaceCoroFree</a></div><div class="ttdeci">void replaceCoroFree(CoroIdInst *CoroId, bool Elide)</div><div class="ttdef"><b>Definition:</b> <a href="Coroutines_8cpp_source.html#l00130">Coroutines.cpp:130</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_a443e8b3df70f81937afd7c6bf52f9f84"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a443e8b3df70f81937afd7c6bf52f9f84">llvm::coro::Shape::SwitchLoweringStorage::HasFinalSuspend</a></div><div class="ttdeci">bool HasFinalSuspend</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00114">CoroInternal.h:114</a></div></div>
<div class="ttc" id="aFunctionInfo_8cpp_html_a3e1eb307ada3e1ef3a115f4c734aa5eeac1775aaace95748849e1216a09f028fc"><div class="ttname"><a href="FunctionInfo_8cpp.html#a3e1eb307ada3e1ef3a115f4c734aa5eeac1775aaace95748849e1216a09f028fc">InlineInfo</a></div><div class="ttdeci">@ InlineInfo</div><div class="ttdef"><b>Definition:</b> <a href="FunctionInfo_8cpp_source.html#l00025">FunctionInfo.cpp:25</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7f2a3d4dcfee70225988aec53ff1e173"><div class="ttname"><a href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">llvm::report_fatal_error</a></div><div class="ttdeci">void report_fatal_error(Error Err, bool gen_crash_diag=true)</div><div class="ttdoc">Report a serious error, calling any installed error handler.</div><div class="ttdef"><b>Definition:</b> <a href="Testing_2Support_2Error_8cpp_source.html#l00145">Error.cpp:145</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26be1141b23850a2b4eb78021d99e862"><div class="ttname"><a href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">llvm::salvageDebugInfo</a></div><div class="ttdeci">void salvageDebugInfo(const MachineRegisterInfo &amp;MRI, MachineInstr &amp;MI)</div><div class="ttdoc">Assuming the instruction MI is going to be deleted, attempt to salvage debug users of MI by writing t...</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l01367">Utils.cpp:1367</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a72516971c5734dc0f7546e64affca425"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">llvm::BasicBlock::phis</a></div><div class="ttdeci">iterator_range&lt; const_phi_iterator &gt; phis() const</div><div class="ttdoc">Returns a range that iterates over the phis in the basic block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00372">BasicBlock.h:372</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00052">raw_ostream.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'undef' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01740">Constants.cpp:1740</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a0400b7a6fcffcd3892d7bb6de435674a"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a0400b7a6fcffcd3892d7bb6de435674a">llvm::FunctionType::params</a></div><div class="ttdeci">ArrayRef&lt; Type * &gt; params() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00130">DerivedTypes.h:130</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_html_a2aa26a48970b4c22a7d85cb0e7fff842"><div class="ttname"><a href="classllvm_1_1LazyCallGraph.html#a2aa26a48970b4c22a7d85cb0e7fff842">llvm::LazyCallGraph::lookupSCC</a></div><div class="ttdeci">SCC * lookupSCC(Node &amp;N) const</div><div class="ttdoc">Lookup a function's SCC in the graph.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00979">LazyCallGraph.h:979</a></div></div>
<div class="ttc" id="aLazyCallGraph_8h_html"><div class="ttname"><a href="LazyCallGraph_8h.html">LazyCallGraph.h</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="astructllvm_1_1CoroSplitPass_html_acad6a8cfcddc1bd59394c0f2944f306e"><div class="ttname"><a href="structllvm_1_1CoroSplitPass.html#acad6a8cfcddc1bd59394c0f2944f306e">llvm::CoroSplitPass::OptimizeFrame</a></div><div class="ttdeci">bool OptimizeFrame</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8h_source.html#l00038">CoroSplit.h:38</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a3ff92cec76009e859cb0c419d6e8ba5f"><div class="ttname"><a href="classllvm_1_1CallBase.html#a3ff92cec76009e859cb0c419d6e8ba5f">llvm::CallBase::getCallingConv</a></div><div class="ttdeci">CallingConv::ID getCallingConv() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01465">InstrTypes.h:1465</a></div></div>
<div class="ttc" id="anamespacellvm_1_1lltok_html_af353621f14cb4b4b3af5ffaff84076b1"><div class="ttname"><a href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1">llvm::lltok::Kind</a></div><div class="ttdeci">Kind</div><div class="ttdef"><b>Definition:</b> <a href="LLToken_8h_source.html#l00018">LLToken.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_a062f49b866f0e49c0dd872c2a904b5db"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#a062f49b866f0e49c0dd872c2a904b5db">llvm::AttrBuilder::addAlignmentAttr</a></div><div class="ttdeci">AttrBuilder &amp; addAlignmentAttr(MaybeAlign Align)</div><div class="ttdoc">This turns an alignment into the form used internally in Attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01741">Attributes.cpp:1741</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a0a1a8e48ba1e5d845e979d5da8de597d"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">llvm::coro::Shape::FrameAlign</a></div><div class="ttdeci">Align FrameAlign</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00099">CoroInternal.h:99</a></div></div>
<div class="ttc" id="aIR_2CFG_8h_html"><div class="ttname"><a href="IR_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_html_a2e0002cac27faad0015b4fa7e5a3eb50"><div class="ttname"><a href="classllvm_1_1LazyCallGraph.html#a2e0002cac27faad0015b4fa7e5a3eb50">llvm::LazyCallGraph::get</a></div><div class="ttdeci">Node &amp; get(Function &amp;F)</div><div class="ttdoc">Get a graph node for a given function, scanning it to populate the graph data as necessary.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00994">LazyCallGraph.h:994</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a8a098003528fee285a3506a0d780cbdf"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a8a098003528fee285a3506a0d780cbdf">llvm::coro::Shape::getIndexType</a></div><div class="ttdeci">IntegerType * getIndexType() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00167">CoroInternal.h:167</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html">llvm::coro::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00073">CoroInternal.h:73</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a0cca043bc17f6f673acb6324db527dae"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">llvm::coro::Shape::AsyncLowering</a></div><div class="ttdeci">AsyncLoweringStorage AsyncLowering</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00143">CoroInternal.h:143</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_a59d23ba2e7eac46cbc6cd3086e013b49"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#a59d23ba2e7eac46cbc6cd3086e013b49">llvm::AttrBuilder::addAttribute</a></div><div class="ttdeci">AttrBuilder &amp; addAttribute(Attribute::AttrKind Val)</div><div class="ttdoc">Add an attribute to the builder.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01694">Attributes.cpp:1694</a></div></div>
<div class="ttc" id="aCoroInternal_8h_html"><div class="ttname"><a href="CoroInternal_8h.html">CoroInternal.h</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a44c557dcf96034410cdb25dd01c12dde"><div class="ttname"><a href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde">hasCallsInBlocksBetween</a></div><div class="ttdeci">static bool hasCallsInBlocksBetween(BasicBlock *SaveBB, BasicBlock *ResDesBB)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01451">CoroSplit.cpp:1451</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html">llvm::DbgVariableIntrinsic</a></div><div class="ttdoc">This is the common base class for debug info intrinsics for variables.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00181">IntrinsicInst.h:181</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a897ca0443b61ca11b2da59e381e8a84a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">llvm::coro::Shape::SwiftErrorOps</a></div><div class="ttdeci">SmallVector&lt; CallInst *, 2 &gt; SwiftErrorOps</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00079">CoroInternal.h:79</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7e3e687ddfdcbacd404bcf17b917dd88"><div class="ttname"><a href="namespacellvm.html#a7e3e687ddfdcbacd404bcf17b917dd88">llvm::instructions</a></div><div class="ttdeci">inst_range instructions(Function *F)</div><div class="ttdef"><b>Definition:</b> <a href="InstIterator_8h_source.html#l00133">InstIterator.h:133</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab2b08d89352a026bdcacac0229e93b66"><div class="ttname"><a href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66">setCoroInfo</a></div><div class="ttdeci">static void setCoroInfo(Function &amp;F, coro::Shape &amp;Shape, ArrayRef&lt; Function * &gt; Fns)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01151">CoroSplit.cpp:1151</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html_a0e5946885029c1bce1350d34f2539b1b"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html#a0e5946885029c1bce1350d34f2539b1b">llvm::GlobalVariable::getInitializer</a></div><div class="ttdeci">const Constant * getInitializer() const</div><div class="ttdoc">getInitializer - Return the initializer for this global variable.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00135">GlobalVariable.h:135</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a97bce951e4585a39601c04d86bb14ffd"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a97bce951e4585a39601c04d86bb14ffd">VI</a></div><div class="ttdeci">@ VI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07994">SIInstrInfo.cpp:7994</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a0b7abf908b6ce436de4d1012f2df7c0c"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a0b7abf908b6ce436de4d1012f2df7c0c">llvm::ArrayRef::drop_front</a></div><div class="ttdeci">ArrayRef&lt; T &gt; drop_front(size_t N=1) const</div><div class="ttdoc">Drop the first N elements of the array.</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00202">ArrayRef.h:202</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a76d02f8354cb0d3c8b30eb7812ae01b2"><div class="ttname"><a href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2">simplifySuspendPoints</a></div><div class="ttdeci">static void simplifySuspendPoints(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01565">CoroSplit.cpp:1565</a></div></div>
<div class="ttc" id="astructllvm_1_1CoroSplitPass_html_a47f6589634ad33a13369ace133b9f4b2"><div class="ttname"><a href="structllvm_1_1CoroSplitPass.html#a47f6589634ad33a13369ace133b9f4b2">llvm::CoroSplitPass::run</a></div><div class="ttdeci">PreservedAnalyses run(LazyCallGraph::SCC &amp;C, CGSCCAnalysisManager &amp;AM, LazyCallGraph &amp;CG, CGSCCUpdateResult &amp;UR)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l02111">CoroSplit.cpp:2111</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2a035e8c90cdcf756260ddd5ed0e9a26"><div class="ttname"><a href="namespacellvm.html#a2a035e8c90cdcf756260ddd5ed0e9a26">llvm::updateCGAndAnalysisManagerForFunctionPass</a></div><div class="ttdeci">LazyCallGraph::SCC &amp; updateCGAndAnalysisManagerForFunctionPass(LazyCallGraph &amp;G, LazyCallGraph::SCC &amp;C, LazyCallGraph::Node &amp;N, CGSCCAnalysisManager &amp;AM, CGSCCUpdateResult &amp;UR, FunctionAnalysisManager &amp;FAM)</div><div class="ttdoc">Helper to update the call graph after running a function pass.</div><div class="ttdef"><b>Definition:</b> <a href="CGSCCPassManager_8cpp_source.html#l01208">CGSCCPassManager.cpp:1208</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a5f494edc0a569c7fc9ff4181243be1ed"><div class="ttname"><a href="classllvm_1_1Function.html#a5f494edc0a569c7fc9ff4181243be1ed">llvm::Function::getCallingConv</a></div><div class="ttdeci">CallingConv::ID getCallingConv() const</div><div class="ttdoc">getCallingConv()/setCallingConv(CC) - These method get and set the calling convention of this functio...</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00237">Function.h:237</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_html_a8d76834516af3608993c2add103b3a6f"><div class="ttname"><a href="classllvm_1_1LazyCallGraph.html#a8d76834516af3608993c2add103b3a6f">llvm::LazyCallGraph::addSplitFunction</a></div><div class="ttdeci">void addSplitFunction(Function &amp;OriginalFunction, Function &amp;NewFunction)</div><div class="ttdoc">Add a new function split/outlined from an existing function.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8cpp_source.html#l01609">LazyCallGraph.cpp:1609</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00652">GlobalValue.h:652</a></div></div>
<div class="ttc" id="aCoroSplit_8h_html"><div class="ttname"><a href="CoroSplit_8h.html">CoroSplit.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantPointerNull_html_a96f5c85e4022e369266541b2db3fda69"><div class="ttname"><a href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">llvm::ConstantPointerNull::get</a></div><div class="ttdeci">static ConstantPointerNull * get(PointerType *T)</div><div class="ttdoc">Static factory methods - Return objects of the specified value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01707">Constants.cpp:1707</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00067">LLVMContext.h:67</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a38df51256d4b415b6a817b5e1c6d4d36"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">llvm::BranchInst::Create</a></div><div class="ttdeci">static BranchInst * Create(BasicBlock *IfTrue, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03195">Instructions.h:3195</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab349dce775a8c8dcd72c24059e8357a2"><div class="ttname"><a href="CoroSplit_8cpp.html#ab349dce775a8c8dcd72c24059e8357a2">coerceArguments</a></div><div class="ttdeci">static void coerceArguments(IRBuilder&lt;&gt; &amp;Builder, FunctionType *FnTy, ArrayRef&lt; Value * &gt; FnArgs, SmallVectorImpl&lt; Value * &gt; &amp;CallArgs)</div><div class="ttdoc">Coerce the arguments in FnArgs according to FnTy in CallArgs.</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01660">CoroSplit.cpp:1660</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a341351eefb2d2b299088ef02333fdaa0"><div class="ttname"><a href="CoroSplit_8cpp.html#a341351eefb2d2b299088ef02333fdaa0">addMustTailToCoroResumes</a></div><div class="ttdeci">static void addMustTailToCoroResumes(Function &amp;F, TargetTransformInfo &amp;TTI)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01379">CoroSplit.cpp:1379</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aa6734dd82cf736e89074802287b0abfe"><div class="ttname"><a href="CoroSplit_8cpp.html#aa6734dd82cf736e89074802287b0abfe">markCoroutineAsDone</a></div><div class="ttdeci">static void markCoroutineAsDone(IRBuilder&lt;&gt; &amp;Builder, const coro::Shape &amp;Shape, Value *FramePtr)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00291">CoroSplit.cpp:291</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendAsyncInst_html"><div class="ttname"><a href="classllvm_1_1CoroSuspendAsyncInst.html">llvm::CoroSuspendAsyncInst</a></div><div class="ttdoc">This represents the llvm.coro.suspend.async instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00525">CoroInstr.h:525</a></div></div>
<div class="ttc" id="aPrettyStackTrace_8h_html"><div class="ttname"><a href="PrettyStackTrace_8h.html">PrettyStackTrace.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html">llvm::AttrBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l01040">Attributes.h:1040</a></div></div>
<div class="ttc" id="aCloning_8h_html"><div class="ttname"><a href="Cloning_8h.html">Cloning.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a20cdc3911828248e70dbeae018106b76"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">llvm::FunctionType::getParamType</a></div><div class="ttdeci">Type * getParamType(unsigned i) const</div><div class="ttdoc">Parameter type accessors.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00135">DerivedTypes.h:135</a></div></div>
<div class="ttc" id="astructllvm_1_1CGSCCUpdateResult_html_a277c9d45b3b20308e166249fd56598ed"><div class="ttname"><a href="structllvm_1_1CGSCCUpdateResult.html#a277c9d45b3b20308e166249fd56598ed">llvm::CGSCCUpdateResult::CWorklist</a></div><div class="ttdeci">SmallPriorityWorklist&lt; LazyCallGraph::SCC *, 1 &gt; &amp; CWorklist</div><div class="ttdoc">Worklist of the SCCs queued for processing.</div><div class="ttdef"><b>Definition:</b> <a href="CGSCCPassManager_8h_source.html#l00257">CGSCCPassManager.h:257</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60e"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">llvm::Attribute::AttrKind</a></div><div class="ttdeci">AttrKind</div><div class="ttdoc">This enumeration lists the attributes that can be associated with parameters, function results,...</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00086">Attributes.h:86</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdoc">Class to represent pointers.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00632">DerivedTypes.h:632</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3cd3a3ec28036937ecebe767498ba55d"><div class="ttname"><a href="namespacellvm.html#a3cd3a3ec28036937ecebe767498ba55d">llvm::ConstantFoldCompareInstOperands</a></div><div class="ttdeci">Constant * ConstantFoldCompareInstOperands(unsigned Predicate, Constant *LHS, Constant *RHS, const DataLayout &amp;DL, const TargetLibraryInfo *TLI=nullptr, const Instruction *I=nullptr)</div><div class="ttdoc">Attempt to constant fold a compare instruction (icmp/fcmp) with the specified operands.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l01216">ConstantFolding.cpp:1216</a></div></div>
<div class="ttc" id="aclassllvm_1_1TrackingVH_html"><div class="ttname"><a href="classllvm_1_1TrackingVH.html">llvm::TrackingVH&lt; Value &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDString_html_affbb7e2e9ad8d18114816f2443d672b9"><div class="ttname"><a href="classllvm_1_1MDString.html#affbb7e2e9ad8d18114816f2443d672b9">llvm::MDString::get</a></div><div class="ttdeci">static MDString * get(LLVMContext &amp;Context, StringRef Str)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l00497">Metadata.cpp:497</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a6adbed68009f582caa84cdfd2adf36f1"><div class="ttname"><a href="classllvm_1_1Function.html#a6adbed68009f582caa84cdfd2adf36f1">llvm::Function::Create</a></div><div class="ttdeci">static Function * Create(FunctionType *Ty, LinkageTypes Linkage, unsigned AddrSpace, const Twine &amp;N=&quot;&quot;, Module *M=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00136">Function.h:136</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_ae451867ac0034a201153b54cc466386d"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#ae451867ac0034a201153b54cc466386d">llvm::ilist_node_with_parent::getPrevNode</a></div><div class="ttdeci">NodeTy * getPrevNode()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00275">ilist_node.h:275</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a9cb75e325aabbbb2e1fdf034b2f11491"><div class="ttname"><a href="CoroSplit_8cpp.html#a9cb75e325aabbbb2e1fdf034b2f11491">replaceUnwindCoroEnd</a></div><div class="ttdeci">static void replaceUnwindCoroEnd(AnyCoroEndInst *End, const coro::Shape &amp;Shape, Value *FramePtr, bool InResume, CallGraph *CG)</div><div class="ttdoc">Replace an unwind call to llvm.coro.end.</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00305">CoroSplit.cpp:305</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6"><div class="ttname"><a href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a24aa4117da86c41684ad25742832dfa6">llvm::coro::ABI::Async</a></div><div class="ttdeci">@ Async</div><div class="ttdoc">The &quot;async continuation&quot; lowering, where each suspend point creates a single continuation function.</div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abcad2d8140114b7cd7e686dde240e5b0"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abcad2d8140114b7cd7e686dde240e5b0">llvm::coro::Shape::OptimizeFrame</a></div><div class="ttdeci">bool OptimizeFrame</div><div class="ttdoc">This would only be true if optimization are enabled.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00105">CoroInternal.h:105</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ae8eaa0b4eeac52a2b2282cb1bfd981ae"><div class="ttname"><a href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">llvm::Type::isVoidTy</a></div><div class="ttdeci">bool isVoidTy() const</div><div class="ttdoc">Return true if this is 'void'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00140">Type.h:140</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayType_html_adf411edc4f135b570ab218079474ce77"><div class="ttname"><a href="classllvm_1_1ArrayType.html#adf411edc4f135b570ab218079474ce77">llvm::ArrayType::get</a></div><div class="ttdeci">static ArrayType * get(Type *ElementType, uint64_t NumElements)</div><div class="ttdoc">This static method is the primary way to construct an ArrayType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00640">Type.cpp:640</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1Node_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1Node.html">llvm::LazyCallGraph::Node</a></div><div class="ttdoc">A node in the call graph.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00315">LazyCallGraph.h:315</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00174">User.h:174</a></div></div>
<div class="ttc" id="aM68kELFObjectWriter_8cpp_html_ae4a8bc3879d2282eefd72b16b12c2a37"><div class="ttname"><a href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a></div><div class="ttdeci">static M68kRelType getType(unsigned Kind, MCSymbolRefExpr::VariantKind &amp;Modifier, bool &amp;IsPCRel)</div><div class="ttdef"><b>Definition:</b> <a href="M68kELFObjectWriter_8cpp_source.html#l00048">M68kELFObjectWriter.cpp:48</a></div></div>
<div class="ttc" id="anamespacellvm_html_a67980a8ae101d2fda845eb750ffb1942"><div class="ttname"><a href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">llvm::print</a></div><div class="ttdeci">Printable print(const GCNRegPressure &amp;RP, const GCNSubtarget *ST=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="GCNRegPressure_8cpp_source.html#l00138">GCNRegPressure.cpp:138</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage_html_a6b353e50aa2fb0fadf3c46ad81a28e00"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a6b353e50aa2fb0fadf3c46ad81a28e00">llvm::coro::Shape::AsyncLoweringStorage::ContextSize</a></div><div class="ttdeci">uint64_t ContextSize</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00134">CoroInternal.h:134</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ac0d65c02370b6785a7163e5aa9de6f05"><div class="ttname"><a href="CoroSplit_8cpp.html#ac0d65c02370b6785a7163e5aa9de6f05">splitCoroutine</a></div><div class="ttdeci">static coro::Shape splitCoroutine(Function &amp;F, SmallVectorImpl&lt; Function * &gt; &amp;Clones, TargetTransformInfo &amp;TTI, bool OptimizeFrame, std::function&lt; bool(Instruction &amp;)&gt; MaterializableCallback)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01933">CoroSplit.cpp:1933</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_af678f41709f265e2589f247e883aa738"><div class="ttname"><a href="CoroSplit_8cpp.html#af678f41709f265e2589f247e883aa738">replaceAsyncResumeFunction</a></div><div class="ttdeci">static void replaceAsyncResumeFunction(CoroSuspendAsyncInst *Suspend, Value *Continuation)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01645">CoroSplit.cpp:1645</a></div></div>
<div class="ttc" id="aAnalysis_2CFG_8h_html"><div class="ttname"><a href="Analysis_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a84fbc09723655416fad6677d7fdaf8a6"><div class="ttname"><a href="CoroSplit_8cpp.html#a84fbc09723655416fad6677d7fdaf8a6">replaceFallthroughCoroEnd</a></div><div class="ttdeci">static void replaceFallthroughCoroEnd(AnyCoroEndInst *End, const coro::Shape &amp;Shape, Value *FramePtr, bool InResume, CallGraph *CG)</div><div class="ttdoc">Replace a non-unwind call to llvm.coro.end.</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00226">CoroSplit.cpp:226</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ad7eb86fb2d6210e104805e7d7e1c4307"><div class="ttname"><a href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307">simplifyTerminatorLeadingToRet</a></div><div class="ttdeci">static bool simplifyTerminatorLeadingToRet(Instruction *InitialInst)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01233">CoroSplit.cpp:1233</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_html_a627b2f86ac433d829482d5a5a0f50668"><div class="ttname"><a href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">llvm::isInstructionTriviallyDead</a></div><div class="ttdeci">bool isInstructionTriviallyDead(Instruction *I, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if the result produced by the instruction is not used, and the instruction will return.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00398">Local.cpp:398</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendAsyncInst_html_ad6e1a5840682e8102ea19e9e86f3dcb3a849e006178975accfd029d2d39b1deb1"><div class="ttname"><a href="classllvm_1_1CoroSuspendAsyncInst.html#ad6e1a5840682e8102ea19e9e86f3dcb3a849e006178975accfd029d2d39b1deb1">llvm::CoroSuspendAsyncInst::ResumeFunctionArg</a></div><div class="ttdeci">@ ResumeFunctionArg</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00529">CoroInstr.h:529</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aDwarf_8h_html"><div class="ttname"><a href="Dwarf_8h.html">Dwarf.h</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab8d43a9eb23bbd336819153a60a26f36"><div class="ttname"><a href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">createResumeEntryBlock</a></div><div class="ttdeci">static void createResumeEntryBlock(Function &amp;F, coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00358">CoroSplit.cpp:358</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a236935b2df66a03a0a54350a6b9b84bc"><div class="ttname"><a href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a></div><div class="ttdeci">static void replaceSwiftErrorOps(Function &amp;F, coro::Shape &amp;Shape, ValueToValueMapTy *VMap)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00620">CoroSplit.cpp:620</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a71999132e148b3feb5a3fc97031a0692"><div class="ttname"><a href="CoroSplit_8cpp.html#a71999132e148b3feb5a3fc97031a0692">updateCallGraphAfterCoroutineSplit</a></div><div class="ttdeci">static void updateCallGraphAfterCoroutineSplit(LazyCallGraph::Node &amp;N, const coro::Shape &amp;Shape, const SmallVectorImpl&lt; Function * &gt; &amp;Clones, LazyCallGraph::SCC &amp;C, LazyCallGraph &amp;CG, CGSCCAnalysisManager &amp;AM, CGSCCUpdateResult &amp;UR, FunctionAnalysisManager &amp;FAM)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l02003">CoroSplit.cpp:2003</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroIdInst_html"><div class="ttname"><a href="classllvm_1_1CoroIdInst.html">llvm::CoroIdInst</a></div><div class="ttdoc">This represents the llvm.coro.id instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00113">CoroInstr.h:113</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ace940beeee97c222f836fe0ac70f6cf5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ace940beeee97c222f836fe0ac70f6cf5">llvm::BasicBlock::Create</a></div><div class="ttdeci">static BasicBlock * Create(LLVMContext &amp;Context, const Twine &amp;Name=&quot;&quot;, Function *Parent=nullptr, BasicBlock *InsertBefore=nullptr)</div><div class="ttdoc">Creates a new BasicBlock.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00105">BasicBlock.h:105</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abfb56acef5d60fefb2edc417f0bfbda0"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">llvm::coro::Shape::CoroBegin</a></div><div class="ttdeci">CoroBeginInst * CoroBegin</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00074">CoroInternal.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_abe11230ab448dd37adc9feb99ac7d3da"><div class="ttname"><a href="classllvm_1_1StructType.html#abe11230ab448dd37adc9feb99ac7d3da">llvm::StructType::getTypeAtIndex</a></div><div class="ttdeci">Type * getTypeAtIndex(const Value *V) const</div><div class="ttdoc">Given an index value into the type, return the type of the element.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00605">Type.cpp:605</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ab4f8e4fd5bccb83b8323e5ab38ed8571"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ab4f8e4fd5bccb83b8323e5ab38ed8571">llvm::coro::Shape::getResumeFunctionType</a></div><div class="ttdeci">FunctionType * getResumeFunctionType() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00182">CoroInternal.h:182</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnyCoroEndInst_html"><div class="ttname"><a href="classllvm_1_1AnyCoroEndInst.html">llvm::AnyCoroEndInst</a></div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00614">CoroInstr.h:614</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroAllocInst_html"><div class="ttname"><a href="classllvm_1_1CoroAllocInst.html">llvm::CoroAllocInst</a></div><div class="ttdoc">This represents the llvm.coro.alloc instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00070">CoroInstr.h:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1ValueMap_html"><div class="ttname"><a href="classllvm_1_1ValueMap.html">llvm::ValueMap&lt; const Value *, WeakTrackingVH &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba84922260d1582a0d4f6f0925cef648d7">llvm::MipsISD::TailCall</a></div><div class="ttdeci">@ TailCall</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00065">MipsISelLowering.h:65</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_ae5f82081e3f2b39a7e795491bb5d7a6e"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ae5f82081e3f2b39a7e795491bb5d7a6e">llvm::coro::Shape::SwitchLoweringStorage::ResumeEntryBlock</a></div><div class="ttdeci">BasicBlock * ResumeEntryBlock</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00110">CoroInternal.h:110</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ace1508259ecd37ceaafb9162d3768fff"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">llvm::coro::Shape::RetconLowering</a></div><div class="ttdeci">RetconLoweringStorage RetconLowering</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00142">CoroInternal.h:142</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a966eb231e7d4e572874d2cb49b18faea"><div class="ttname"><a href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">llvm::Value::stripPointerCasts</a></div><div class="ttdeci">const Value * stripPointerCasts() const</div><div class="ttdoc">Strip off pointer casts, all-zero GEPs and address space casts.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00685">Value.cpp:685</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa7cce62ac5cc6df09cce0535874336b7"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">llvm::ConstantInt::getFalse</a></div><div class="ttdeci">static ConstantInt * getFalse(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00842">Constants.cpp:842</a></div></div>
<div class="ttc" id="aArgument_8h_html"><div class="ttname"><a href="Argument_8h.html">Argument.h</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_a537c835c34f0b44b6ad2696643754390"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Callee</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a4b6f33a1040beb67526139c880622747"><div class="ttname"><a href="namespacellvm_1_1coro.html#a4b6f33a1040beb67526139c880622747">llvm::coro::salvageDebugInfo</a></div><div class="ttdeci">void salvageDebugInfo(SmallDenseMap&lt; llvm::Value *, llvm::AllocaInst *, 4 &gt; &amp;DbgPtrAllocaCache, DbgVariableIntrinsic *DVI, bool OptimizeFrame)</div><div class="ttdoc">Recover a dbg.declare prepared by the frontend and emit an alloca holding a pointer to the coroutine ...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02805">CoroFrame.cpp:2805</a></div></div>
<div class="ttc" id="aCallingConv_8h_html"><div class="ttname"><a href="CallingConv_8h.html">CallingConv.h</a></div></div>
<div class="ttc" id="aAttributes_8h_html"><div class="ttname"><a href="Attributes_8h.html">Attributes.h</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ad49b292032d2eebe5e027ab2d4445e6d"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ad49b292032d2eebe5e027ab2d4445e6d">llvm::coro::Shape::CoroAligns</a></div><div class="ttdeci">SmallVector&lt; CoroAlignInst *, 2 &gt; CoroAligns</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00077">CoroInternal.h:77</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41"><div class="ttname"><a href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380a6ec6c15fe79ec2274d2c3e79ae4bcc41">llvm::coro::ABI::RetconOnce</a></div><div class="ttdeci">@ RetconOnce</div><div class="ttdoc">The &quot;unique returned-continuation&quot; lowering, where each suspend point creates a single continuation f...</div></div>
<div class="ttc" id="astructllvm_1_1CGSCCUpdateResult_html"><div class="ttname"><a href="structllvm_1_1CGSCCUpdateResult.html">llvm::CGSCCUpdateResult</a></div><div class="ttdoc">Support structure for SCC passes to communicate updates the call graph back to the CGSCC pass manager...</div><div class="ttdef"><b>Definition:</b> <a href="CGSCCPassManager_8h_source.html#l00232">CGSCCPassManager.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdoc">Twine - A lightweight data structure for efficiently representing the concatenation of temporary valu...</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="anamespacellvm_html_a152d8c380cc937c9dceb402ceec943b6"><div class="ttname"><a href="namespacellvm.html#a152d8c380cc937c9dceb402ceec943b6">llvm::ConstantFoldTerminator</a></div><div class="ttdeci">bool ConstantFoldTerminator(BasicBlock *BB, bool DeleteDeadConditions=false, const TargetLibraryInfo *TLI=nullptr, DomTreeUpdater *DTU=nullptr)</div><div class="ttdoc">If a terminator instruction is predicated on a constant value, convert it into an unconditional branc...</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00126">Local.cpp:126</a></div></div>
<div class="ttc" id="aVerifier_8h_html"><div class="ttname"><a href="Verifier_8h.html">Verifier.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html_ad4d10c3084307035a3ae29cc2f420440"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html#ad4d10c3084307035a3ae29cc2f420440">llvm::TargetTransformInfo::supportsTailCalls</a></div><div class="ttdeci">bool supportsTailCalls() const</div><div class="ttdoc">If the target supports tail calls.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8cpp_source.html#l00540">TargetTransformInfo.cpp:540</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a82dbbd8e3688b0bc1eedb338864d0d0c"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">llvm::ConstantInt::getTrue</a></div><div class="ttdeci">static ConstantInt * getTrue(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00835">Constants.cpp:835</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_html_a952c8adfe8553406e169b98200072a69"><div class="ttname"><a href="classllvm_1_1LazyCallGraph.html#a952c8adfe8553406e169b98200072a69">llvm::LazyCallGraph::addSplitRefRecursiveFunctions</a></div><div class="ttdeci">void addSplitRefRecursiveFunctions(Function &amp;OriginalFunction, ArrayRef&lt; Function * &gt; NewFunctions)</div><div class="ttdoc">Add new ref-recursive functions split/outlined from an existing function.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8cpp_source.html#l01688">LazyCallGraph.cpp:1688</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">llvm::ISD::BR</a></div><div class="ttdeci">@ BR</div><div class="ttdoc">Control flow instructions. These all have token chains.</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00981">ISDOpcodes.h:981</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ab0ff669b12c20c07137705c38872ec63"><div class="ttname"><a href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02750">Instructions.h:2750</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_aab36927882fbfdcbb860d87fd9c30da8"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#aab36927882fbfdcbb860d87fd9c30da8">llvm::ArrayRef::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00151">ArrayRef.h:151</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html_a80735739b49cf97a491922c8f9af2cc1"><div class="ttname"><a href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">llvm::Align::value</a></div><div class="ttdeci">uint64_t value() const</div><div class="ttdoc">This is a hole in the type system and should not be abused.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00085">Alignment.h:85</a></div></div>
<div class="ttc" id="aGlobalVariable_8h_html"><div class="ttname"><a href="GlobalVariable_8h.html">GlobalVariable.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">llvm::MCID::Branch</a></div><div class="ttdeci">@ Branch</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00159">MCInstrDesc.h:159</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantTokenNone_html_a8e29fb8e39fb67b3bb746dbba47fcb29"><div class="ttname"><a href="classllvm_1_1ConstantTokenNone.html#a8e29fb8e39fb67b3bb746dbba47fcb29">llvm::ConstantTokenNone::get</a></div><div class="ttdeci">static ConstantTokenNone * get(LLVMContext &amp;Context)</div><div class="ttdoc">Return the ConstantTokenNone.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01429">Constants.cpp:1429</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a002c19b0baeca605dc94e5987d50cde2"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a002c19b0baeca605dc94e5987d50cde2">llvm::coro::Shape::getIndex</a></div><div class="ttdeci">ConstantInt * getIndex(uint64_t Value) const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00172">CoroInternal.h:172</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a00d7d6364b0b1a9bc1b3faa647130974"><div class="ttname"><a href="CoroSplit_8cpp.html#a00d7d6364b0b1a9bc1b3faa647130974">getFunctionTypeFromAsyncSuspend</a></div><div class="ttdeci">static FunctionType * getFunctionTypeFromAsyncSuspend(AnyCoroSuspendInst *Suspend)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00499">CoroSplit.cpp:499</a></div></div>
<div class="ttc" id="aAMDGPULowerKernelArguments_8cpp_html_a1161e5a4e753384aaba3a8e4533c4261"><div class="ttname"><a href="AMDGPULowerKernelArguments_8cpp.html#a1161e5a4e753384aaba3a8e4533c4261">Arguments</a></div><div class="ttdeci">AMDGPU Lower Kernel Arguments</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULowerKernelArguments_8cpp_source.html#l00240">AMDGPULowerKernelArguments.cpp:240</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_adc01a7457de85fc52a3bb860d7e1c6a4"><div class="ttname"><a href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0) const</div><div class="ttdoc">Return a pointer to the current type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00776">Type.cpp:776</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineFunctionInfo_html"><div class="ttname"><a href="classllvm_1_1InlineFunctionInfo.html">llvm::InlineFunctionInfo</a></div><div class="ttdoc">This class captures the data input to the InlineFunction call, and records the auxiliary results prod...</div><div class="ttdef"><b>Definition:</b> <a href="Cloning_8h_source.html#l00203">Cloning.h:203</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a78fa8f84df72aa178f82c9421b0cf387"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a78fa8f84df72aa178f82c9421b0cf387">llvm::coro::Shape::emitAlloc</a></div><div class="ttdeci">Value * emitAlloc(IRBuilder&lt;&gt; &amp;Builder, Value *Size, CallGraph *CG) const</div><div class="ttdoc">Allocate memory according to the rules of the active lowering.</div><div class="ttdef"><b>Definition:</b> <a href="Coroutines_8cpp_source.html#l00453">Coroutines.cpp:453</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_adf50671db83d2813e0d897ea2cfc9102"><div class="ttname"><a href="classllvm_1_1Function.html#adf50671db83d2813e0d897ea2cfc9102">llvm::Function::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType() const</div><div class="ttdoc">Returns the FunctionType for me.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00174">Function.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantArray_html_a0900dacdc7ad8e3ea0cc92993c7fd422"><div class="ttname"><a href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">llvm::ConstantArray::get</a></div><div class="ttdeci">static Constant * get(ArrayType *T, ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01249">Constants.cpp:1249</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex_html_a3e10a8a52059efadba225b68fbb26451a0416e9f2fbff942bd66bfa6d7e759d47"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a3e10a8a52059efadba225b68fbb26451a0416e9f2fbff942bd66bfa6d7e759d47">llvm::coro::Shape::SwitchFieldIndex::Destroy</a></div><div class="ttdeci">@ Destroy</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00085">CoroInternal.h:85</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a3c5bfa27332d63608ee16d8e61c7682a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a3c5bfa27332d63608ee16d8e61c7682a">llvm::coro::Shape::getSwitchCoroId</a></div><div class="ttdeci">CoroIdInst * getSwitchCoroId() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00146">CoroInternal.h:146</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a0fda7566c0a6bf592ecf28d4476c6d27"><div class="ttname"><a href="CoroSplit_8cpp.html#a0fda7566c0a6bf592ecf28d4476c6d27">splitSwitchCoroutine</a></div><div class="ttdeci">static void splitSwitchCoroutine(Function &amp;F, coro::Shape &amp;Shape, SmallVectorImpl&lt; Function * &gt; &amp;Clones, TargetTransformInfo &amp;TTI)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01606">CoroSplit.cpp:1606</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a7ac9329ef7292ee640d87f45ce7ae05c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a7ac9329ef7292ee640d87f45ce7ae05c">llvm::CallBase::getCalledOperand</a></div><div class="ttdeci">Value * getCalledOperand() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01399">InstrTypes.h:1399</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a83664bf5c186d5e2d65853f2cce4ec3a"><div class="ttname"><a href="CoroSplit_8cpp.html#a83664bf5c186d5e2d65853f2cce4ec3a">replaceAllPrepares</a></div><div class="ttdeci">static bool replaceAllPrepares(Function *PrepareFn, LazyCallGraph &amp;CG, LazyCallGraph::SCC &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l02086">CoroSplit.cpp:2086</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2e739fb4907159062aacbbafea669592"><div class="ttname"><a href="namespacellvm.html#a2e739fb4907159062aacbbafea669592">llvm::updateCGAndAnalysisManagerForCGSCCPass</a></div><div class="ttdeci">LazyCallGraph::SCC &amp; updateCGAndAnalysisManagerForCGSCCPass(LazyCallGraph &amp;G, LazyCallGraph::SCC &amp;C, LazyCallGraph::Node &amp;N, CGSCCAnalysisManager &amp;AM, CGSCCUpdateResult &amp;UR, FunctionAnalysisManager &amp;FAM)</div><div class="ttdoc">Helper to update the call graph after running a CGSCC pass.</div><div class="ttdef"><b>Definition:</b> <a href="CGSCCPassManager_8cpp_source.html#l01215">CGSCCPassManager.cpp:1215</a></div></div>
<div class="ttc" id="astructllvm_1_1CoroSplitPass_html_a3dd494278da3453bef21b1223a52fe27"><div class="ttname"><a href="structllvm_1_1CoroSplitPass.html#a3dd494278da3453bef21b1223a52fe27">llvm::CoroSplitPass::MaterializableCallback</a></div><div class="ttdeci">const std::function&lt; bool(Instruction &amp;)&gt; MaterializableCallback</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8h_source.html#l00025">CoroSplit.h:25</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_aedc5db661c24859142b1b7a67dc05ba7"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#aedc5db661c24859142b1b7a67dc05ba7">llvm::coro::Shape::getSwitchIndexField</a></div><div class="ttdeci">unsigned getSwitchIndexField() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00162">CoroInternal.h:162</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a74922788bb2b2a204fe51f04026d6859"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a74922788bb2b2a204fe51f04026d6859">llvm::BasicBlock::getFirstNonPHIOrDbgOrLifetime</a></div><div class="ttdeci">const Instruction * getFirstNonPHIOrDbgOrLifetime(bool SkipPseudoOp=true) const</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode, a debug intrinsic,...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00229">BasicBlock.cpp:229</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html_a676e566281b7f39a0c685bc6d1032283"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html#a676e566281b7f39a0c685bc6d1032283">llvm::AttrBuilder::addDereferenceableAttr</a></div><div class="ttdeci">AttrBuilder &amp; addDereferenceableAttr(uint64_t Bytes)</div><div class="ttdoc">This turns the number of dereferenceable bytes into the form used internally in Attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01758">Attributes.cpp:1758</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca6c93794d7b99cd433e96c53eadb15a6e"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca6c93794d7b99cd433e96c53eadb15a6e">llvm::GlobalValue::ExternalLinkage</a></div><div class="ttdeci">@ ExternalLinkage</div><div class="ttdoc">Externally visible function.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00048">GlobalValue.h:48</a></div></div>
<div class="ttc" id="aCallGraph_8h_html"><div class="ttname"><a href="CallGraph_8h.html">CallGraph.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a6e20e76960d952de088354cbcd14c3ab"><div class="ttname"><a href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">llvm::Type::getVoidTy</a></div><div class="ttdeci">static Type * getVoidTy(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00224">Type.cpp:224</a></div></div>
<div class="ttc" id="anamespacellvm_html_a97370114df349e0996f133e3402c1595"><div class="ttname"><a href="namespacellvm.html#a97370114df349e0996f133e3402c1595">llvm::changeToUnreachable</a></div><div class="ttdeci">unsigned changeToUnreachable(Instruction *I, bool PreserveLCSSA=false, DomTreeUpdater *DTU=nullptr, MemorySSAUpdater *MSSAU=nullptr)</div><div class="ttdoc">Insert an unreachable instruction before the specified instruction, making it and the rest of the cod...</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02250">Local.cpp:2250</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">llvm::GlobalValue::PrivateLinkage</a></div><div class="ttdeci">@ PrivateLinkage</div><div class="ttdoc">Like Internal, but omit from symbol table.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00056">GlobalValue.h:56</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendInst_html_a931c649e87e9b4229a7876755ac0b337"><div class="ttname"><a href="classllvm_1_1CoroSuspendInst.html#a931c649e87e9b4229a7876755ac0b337">llvm::CoroSuspendInst::getCoroSave</a></div><div class="ttdeci">CoroSaveInst * getCoroSave() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00497">CoroInstr.h:497</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSizeInst_html"><div class="ttname"><a href="classllvm_1_1CoroSizeInst.html">llvm::CoroSizeInst</a></div><div class="ttdoc">This represents the llvm.coro.size instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00591">CoroInstr.h:591</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage_html_a872685aee4d3b7567d0538ccaa326228"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a872685aee4d3b7567d0538ccaa326228">llvm::coro::Shape::RetconLoweringStorage::ReturnBlock</a></div><div class="ttdeci">BasicBlock * ReturnBlock</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00122">CoroInternal.h:122</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aclassllvm_1_1FreezeInst_html"><div class="ttname"><a href="classllvm_1_1FreezeInst.html">llvm::FreezeInst</a></div><div class="ttdoc">This class represents a freeze function that returns random concrete value if an operand is either a ...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05440">Instructions.h:5440</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a3907189466613e437b0ea2731bf9b159"><div class="ttname"><a href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a></div><div class="ttdeci">static void maybeFreeRetconStorage(IRBuilder&lt;&gt; &amp;Builder, const coro::Shape &amp;Shape, Value *FramePtr, CallGraph *CG)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l00169">CoroSplit.cpp:169</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a0c8ffe664a36e30d49c84d0aded2fe08"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00677">SmallVector.h:677</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a85ffb6531d4cda988ea81f18d4e56fb7"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">llvm::ArrayRef::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">size - Get the array size.</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00163">ArrayRef.h:163</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroBeginInst_html"><div class="ttname"><a href="classllvm_1_1CoroBeginInst.html">llvm::CoroBeginInst</a></div><div class="ttdoc">This class represents the llvm.coro.begin instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00420">CoroInstr.h:420</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_afe7af0c3ec2ef1f525173acd2ea4ba60"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#afe7af0c3ec2ef1f525173acd2ea4ba60">llvm::BasicBlock::removePredecessor</a></div><div class="ttdeci">void removePredecessor(BasicBlock *Pred, bool KeepOneInputPHIs=false)</div><div class="ttdoc">Update PHI nodes in this BasicBlock before removal of predecessor Pred.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00341">BasicBlock.cpp:341</a></div></div>
<div class="ttc" id="aCoroInstr_8h_html"><div class="ttname"><a href="CoroInstr_8h.html">CoroInstr.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DISubprogram_html"><div class="ttname"><a href="classllvm_1_1DISubprogram.html">llvm::DISubprogram</a></div><div class="ttdoc">Subprogram description.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01851">DebugInfoMetadata.h:1851</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdoc">This class consists of common code factored out of the SmallVector class to reduce code duplication b...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00042">APFloat.h:42</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a5eac2988672b484645dcbcd706430967"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">llvm::coro::Shape::FramePtr</a></div><div class="ttdeci">Value * FramePtr</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00101">CoroInternal.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a92041fc7f781ba4fe708eec99139b72f"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a92041fc7f781ba4fe708eec99139b72f">llvm::GlobalValue::getType</a></div><div class="ttdeci">PointerType * getType() const</div><div class="ttdoc">Global values are always pointers.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00290">GlobalValue.h:290</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a6d883605206368bc536cc9ded97209b8"><div class="ttname"><a href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">llvm::Module::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Get the data layout for the module's target platform.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00398">Module.cpp:398</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_acd162cfe23d841a49056ce6436dd2075"><div class="ttname"><a href="CoroSplit_8cpp.html#acd162cfe23d841a49056ce6436dd2075">replacePrepare</a></div><div class="ttdeci">static void replacePrepare(CallInst *Prepare, LazyCallGraph &amp;CG, LazyCallGraph::SCC &amp;C)</div><div class="ttdoc">Replace a call to llvm.coro.prepare.retcon.</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l02050">CoroSplit.cpp:2050</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac1b2be839460bb277d4f07f4aa5225ac"><div class="ttname"><a href="namespacellvm.html#ac1b2be839460bb277d4f07f4aa5225ac">llvm::CloneFunctionInto</a></div><div class="ttdeci">void CloneFunctionInto(Function *NewFunc, const Function *OldFunc, ValueToValueMapTy &amp;VMap, CloneFunctionChangeType Changes, SmallVectorImpl&lt; ReturnInst * &gt; &amp;Returns, const char *NameSuffix=&quot;&quot;, ClonedCodeInfo *CodeInfo=nullptr, ValueMapTypeRemapper *TypeMapper=nullptr, ValueMaterializer *Materializer=nullptr)</div><div class="ttdoc">Clone OldFunc into NewFunc, transforming the old arguments into references to VMap values.</div><div class="ttdef"><b>Definition:</b> <a href="CloneFunction_8cpp_source.html#l00086">CloneFunction.cpp:86</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex_html_a3e10a8a52059efadba225b68fbb26451a012dd1dc85c718e8159980fa4273d9e6"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a3e10a8a52059efadba225b68fbb26451a012dd1dc85c718e8159980fa4273d9e6">llvm::coro::Shape::SwitchFieldIndex::Resume</a></div><div class="ttdeci">@ Resume</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00084">CoroInternal.h:84</a></div></div>
<div class="ttc" id="aBlockVerifier_8cpp_html_ae45c7d73c0ff5d177b59153ffae77f84"><div class="ttname"><a href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a></div><div class="ttdeci">BlockVerifier::State From</div><div class="ttdef"><b>Definition:</b> <a href="BlockVerifier_8cpp_source.html#l00055">BlockVerifier.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdoc">Transfer the name from V to this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00381">Value.cpp:381</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdoc">A debug info location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00033">DebugLoc.h:33</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a9f3928b341e4412b8b66b794896014f0"><div class="ttname"><a href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0">simplifySuspendPoint</a></div><div class="ttdeci">static bool simplifySuspendPoint(CoroSuspendInst *Suspend, CoroBeginInst *CoroBegin)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01505">CoroSplit.cpp:1505</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="aCallGraphUpdater_8h_html"><div class="ttname"><a href="CallGraphUpdater_8h.html">CallGraphUpdater.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph.html">llvm::LazyCallGraph</a></div><div class="ttdoc">A lazily constructed view of the call graph of a module.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00110">LazyCallGraph.h:110</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1VGPRIndexMode_html_a9afd95476c40096a5898ba0f06370b3a"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">llvm::AMDGPU::VGPRIndexMode::Id</a></div><div class="ttdeci">Id</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00250">SIDefines.h:250</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_af74676a3c7447be34bd2c1da76ec0c48"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#af74676a3c7447be34bd2c1da76ec0c48">llvm::SmallPtrSetImpl::contains</a></div><div class="ttdeci">bool contains(ConstPtrType Ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00389">SmallPtrSet.h:389</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a499ea32ca1b8d16cedfe01d1e5b08f29"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">llvm::SmallVectorImpl::reserve</a></div><div class="ttdeci">void reserve(size_type N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00667">SmallVector.h:667</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionAnalysisManagerCGSCCProxy_html"><div class="ttname"><a href="classllvm_1_1FunctionAnalysisManagerCGSCCProxy.html">llvm::FunctionAnalysisManagerCGSCCProxy</a></div><div class="ttdoc">A proxy from a FunctionAnalysisManager to an SCC.</div><div class="ttdef"><b>Definition:</b> <a href="CGSCCPassManager_8h_source.html#l00392">CGSCCPassManager.h:392</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html_a800c1300065ca1615d2f4fb88623afd5a8997c6b0930e2c05209e95e7172c6cf3"><div class="ttname"><a href="classllvm_1_1LLVMContext.html#a800c1300065ca1615d2f4fb88623afd5a8997c6b0930e2c05209e95e7172c6cf3">llvm::LLVMContext::OB_funclet</a></div><div class="ttdeci">@ OB_funclet</div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00090">LLVMContext.h:90</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a53b686b78ff6f0eedd7d4d5a6bdd22bb"><div class="ttname"><a href="namespacellvm_1_1coro.html#a53b686b78ff6f0eedd7d4d5a6bdd22bb">llvm::coro::defaultMaterializable</a></div><div class="ttdeci">bool defaultMaterializable(Instruction &amp;V)</div><div class="ttdoc">Default materializable callback.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02218">CoroFrame.cpp:2218</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_ac453ad79a3d50950bac79bc9dff85918"><div class="ttname"><a href="classllvm_1_1FunctionType.html#ac453ad79a3d50950bac79bc9dff85918">llvm::FunctionType::getReturnType</a></div><div class="ttdeci">Type * getReturnType() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00124">DerivedTypes.h:124</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6cdf47ba1fa5831d7c2897bc3aed77b8a24aa4117da86c41684ad25742832dfa6"><div class="ttname"><a href="namespacellvm.html#a6cdf47ba1fa5831d7c2897bc3aed77b8a24aa4117da86c41684ad25742832dfa6">llvm::UWTableKind::Async</a></div><div class="ttdeci">@ Async</div><div class="ttdoc">&quot;Asynchronous&quot; unwind tables (instr precise)</div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a7ca5197533a9c1fb8a2bd30587fcec6b"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a7ca5197533a9c1fb8a2bd30587fcec6b">llvm::ArrayRef::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00152">ArrayRef.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html_a095f8f031d99ce3c0b25478713293dea"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html#a095f8f031d99ce3c0b25478713293dea">llvm::GlobalVariable::setInitializer</a></div><div class="ttdeci">void setInitializer(Constant *InitVal)</div><div class="ttdoc">setInitializer - Sets the initializer for this global variable, removing any existing initializer if ...</div><div class="ttdef"><b>Definition:</b> <a href="Globals_8cpp_source.html#l00472">Globals.cpp:472</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html"><div class="ttname"><a href="classllvm_1_1FunctionType.html">llvm::FunctionType</a></div><div class="ttdoc">Class to represent function types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00103">DerivedTypes.h:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:23:40 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
