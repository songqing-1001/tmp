<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Analysis/SyncDependenceAnalysis.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a25db018342d3ae6c7e6779086c18378.html">Analysis</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SyncDependenceAnalysis.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SyncDependenceAnalysis_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===--- SyncDependenceAnalysis.cpp - Compute Control Divergence Effects --===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements an algorithm that returns for a divergent branch</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// the set of basic blocks whose phi nodes become divergent due to divergent</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// control. These are the blocks that are reachable by two disjoint paths from</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the branch or loop exits that have a reaching path that is disjoint from a</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// path to the loop latch.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// The SyncDependenceAnalysis is used in the DivergenceAnalysis to model</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// control-induced divergence in phi nodes.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// -- Reference --</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// The algorithm is presented in Section 5 of </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//   An abstract interpretation for SPMD divergence</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//       on reducible control flow graphs.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//   Julian Rosemann, Simon Moll and Sebastian Hack</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//   POPL &#39;21</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// -- Sync dependence --</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// Sync dependence characterizes the control flow aspect of the</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// propagation of branch divergence. For example,</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//   %cond = icmp slt i32 %tid, 10</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//   br i1 %cond, label %then, label %else</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// then:</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//   br label %merge</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// else:</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//   br label %merge</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// merge:</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//   %a = phi i32 [ 0, %then ], [ 1, %else ]</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// Suppose %tid holds the thread ID. Although %a is not data dependent on %tid</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// because %tid is not on its use-def chains, %a is sync dependent on %tid</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// because the branch &quot;br i1 %cond&quot; depends on %tid and affects which value %a</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// is assigned to.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// -- Reduction to SSA construction --</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// There are two disjoint paths from A to X, if a certain variant of SSA</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// construction places a phi node in X under the following set-up scheme.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// This variant of SSA construction ignores incoming undef values.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// That is paths from the entry without a definition do not result in</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// phi nodes.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//       entry</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//     /      \</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//    A        \</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//  /   \       Y</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// B     C     /</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//  \   /  \  /</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//    D     E</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//     \   /</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//       F</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// Assume that A contains a divergent branch. We are interested</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">// in the set of all blocks where each block is reachable from A</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// via two disjoint paths. This would be the set {D, F} in this</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// case.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// To generally reduce this query to SSA construction we introduce</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// a virtual variable x and assign to x different values in each</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">// successor block of A.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//           entry</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//         /      \</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//        A        \</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//      /   \       Y</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">// x = 0   x = 1   /</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//      \  /   \  /</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//        D     E</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//         \   /</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//           F</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// Our flavor of SSA construction for x will construct the following</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//            entry</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//          /      \</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//         A        \</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//       /   \       Y</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// x0 = 0   x1 = 1  /</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//       \   /   \ /</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//     x2 = phi   E</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//         \     /</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//         x3 = phi</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// The blocks D and F contain phi nodes and are thus each reachable</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">// by two disjoins paths from A.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">// -- Remarks --</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// * In case of loop exits we need to check the disjoint path criterion for loops.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//   To this end, we check whether the definition of x differs between the</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//   loop exit and the loop header (_after_ SSA construction).</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// -- Known Limitations &amp; Future Work --</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// * The algorithm requires reducible loops because the implementation</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//   implicitly performs a single iteration of the underlying data flow analysis.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//   This was done for pragmatism, simplicity and speed.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//   Relevant related work for extending the algorithm to irreducible control:</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//     A simple algorithm for global data flow analysis problems.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//     Matthew S. Hecht and Jeffrey D. Ullman.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//     SIAM Journal on Computing, 4(4):519–532, December 1975.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// * Another reason for requiring reducible loops is that points of</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">//   synchronization in irreducible loops aren&#39;t &#39;obvious&#39; - there is no unique</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">//   header where threads &#39;should&#39; synchronize when entering or coming back</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">//   around from the latch.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SyncDependenceAnalysis_8h.html">llvm/Analysis/SyncDependenceAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2CFG_8h.html">llvm/IR/CFG.h</a>&quot;</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="SyncDependenceAnalysis_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">  130</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;sync-dependence&quot;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">// The SDA algorithm operates on a modified CFG - we modify the edges leaving</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">// loop headers as follows:</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">// * We remove all edges leaving all loop headers.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">// * We add additional edges from the loop headers to their exit blocks.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">// The modification is virtual, that is whenever we visit a loop header we</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">// pretend it had different successors.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// Custom Post-Order Traveral</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// We cannot use the vanilla (R)PO computation of LLVM because:</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">// * We (virtually) modify the CFG.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">// * We want a loop-compact block enumeration, that is the numbers assigned to</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">//   blocks of a loop form an interval</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">//   </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">using</span> POCB = <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;void(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;)&gt;;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">using</span> VisitedSet = std::set&lt;const BasicBlock *&gt;;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keyword">using</span> BlockStack = std::vector&lt;const BasicBlock *&gt;;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">// forward</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> computeLoopPO(<span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI, <a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;<a class="code" href="classllvm_1_1Loop.html">Loop</a>, POCB CallBack,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                          VisitedSet &amp;Finalized);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// for a nested region (top-level loop or nested loop)</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> computeStackPO(BlockStack &amp;Stack, <span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *<a class="code" href="classllvm_1_1Loop.html">Loop</a>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                           POCB CallBack, VisitedSet &amp;Finalized) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *LoopHeader = <a class="code" href="classllvm_1_1Loop.html">Loop</a> ? <a class="code" href="classllvm_1_1Loop.html">Loop</a>-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">while</span> (!Stack.empty()) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *NextBB = Stack.back();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">auto</span> *NestedLoop = LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(NextBB);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">bool</span> IsNestedLoop = NestedLoop != <a class="code" href="classllvm_1_1Loop.html">Loop</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Treat the loop as a node</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (IsNestedLoop) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 3&gt;</a> NestedExits;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      NestedLoop-&gt;getUniqueExitBlocks(NestedExits);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordtype">bool</span> PushedNodes = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *NestedExitBB : NestedExits) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (NestedExitBB == LoopHeader)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;&amp; !<a class="code" href="classllvm_1_1Loop.html">Loop</a>-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(NestedExitBB))</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> (Finalized.count(NestedExitBB))</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        PushedNodes = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        Stack.push_back(NestedExitBB);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">if</span> (!PushedNodes) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// All loop exits finalized -&gt; finish this node</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        Stack.pop_back();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        computeLoopPO(LI, *NestedLoop, CallBack, Finalized);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// DAG-style</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">bool</span> PushedNodes = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *SuccBB : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(NextBB)) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">if</span> (SuccBB == LoopHeader)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;&amp; !<a class="code" href="classllvm_1_1Loop.html">Loop</a>-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(SuccBB))</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">if</span> (Finalized.count(SuccBB))</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      PushedNodes = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      Stack.push_back(SuccBB);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (!PushedNodes) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="comment">// Never push nodes twice</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      Stack.pop_back();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">if</span> (!Finalized.insert(NextBB).second)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      CallBack(*NextBB);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> computeTopLevelPO(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI, POCB CallBack) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  VisitedSet Finalized;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  BlockStack Stack;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  Stack.reserve(24); <span class="comment">// FIXME made-up number</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  Stack.push_back(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock());</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  computeStackPO(Stack, LI, <span class="keyword">nullptr</span>, CallBack, Finalized);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> computeLoopPO(<span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI, <a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;<a class="code" href="classllvm_1_1Loop.html">Loop</a>, POCB CallBack,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                          VisitedSet &amp;Finalized) {<span class="comment"></span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">  /// Call CallBack on all loop blocks.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span>  std::vector&lt;const BasicBlock *&gt; Stack;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *LoopHeader = <a class="code" href="classllvm_1_1Loop.html">Loop</a>.<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// Visit the header last</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  Finalized.insert(LoopHeader);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  CallBack(*LoopHeader);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// Initialize with immediate successors</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(LoopHeader)) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1Loop.html">Loop</a>.<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> == LoopHeader)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    Stack.push_back(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// Compute PO inside region</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  computeStackPO(Stack, LI, &amp;<a class="code" href="classllvm_1_1Loop.html">Loop</a>, CallBack, Finalized);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<a class="code" href="structllvm_1_1ControlDivergenceDesc.html">ControlDivergenceDesc</a> SyncDependenceAnalysis::EmptyDivergenceDesc;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="classllvm_1_1SyncDependenceAnalysis.html#ab6abea93ecf5e0d31e9ace269170f681">  250</a></span>&#160;<a class="code" href="classllvm_1_1SyncDependenceAnalysis.html#ab6abea93ecf5e0d31e9ace269170f681">SyncDependenceAnalysis::SyncDependenceAnalysis</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1PostDominatorTree.html">PostDominatorTree</a> &amp;PDT,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    : DT(DT), PDT(PDT), LI(LI) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  computeTopLevelPO(*DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#aed9304e6b154061a392a88df94a2ba6c">getRoot</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>(), LI,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) { LoopPO.appendBlock(BB); });</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<a class="code" href="classllvm_1_1SyncDependenceAnalysis.html#a9d12fbf93a5e027fe41448d0fc2e5f09">SyncDependenceAnalysis::~SyncDependenceAnalysis</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">// divergence propagator for reducible CFGs</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keyword">struct </span><a class="code" href="classllvm_1_1DivergencePropagator.html">DivergencePropagator</a> {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">const</span> <a class="code" href="structllvm_1_1ModifiedPO.html">ModifiedPO</a> &amp;LoopPOT;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;<a class="code" href="classllvm_1_1DivergencePropagator.html#a82f5d9a55d60641dce49b2c606949759">DT</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1PostDominatorTree.html">PostDominatorTree</a> &amp;PDT;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// * if BlockLabels[IndexOf(B)] == C then C is the dominating definition at</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">//   block B</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// * if BlockLabels[IndexOf(B)] ~ undef then we haven&#39;t seen B yet</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// * if BlockLabels[IndexOf(B)] == B then B is a join point of disjoint paths</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// from X or B is an immediate successor of X (initial value).</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keyword">using</span> BlockLabelVec = std::vector&lt;const BasicBlock *&gt;;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  BlockLabelVec <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// divergent join and loop exit descriptor.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  std::unique_ptr&lt;ControlDivergenceDesc&gt; <a class="code" href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">DivDesc</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="classllvm_1_1DivergencePropagator.html#aefcd4588c26dc8f0236290c1e2af58d9">DivergencePropagator</a>(<span class="keyword">const</span> <a class="code" href="structllvm_1_1ModifiedPO.html">ModifiedPO</a> &amp;LoopPOT, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;<a class="code" href="classllvm_1_1DivergencePropagator.html#a82f5d9a55d60641dce49b2c606949759">DT</a>,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1PostDominatorTree.html">PostDominatorTree</a> &amp;PDT, <span class="keyword">const</span> <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      : LoopPOT(LoopPOT), <a class="code" href="classllvm_1_1DivergencePropagator.html#a82f5d9a55d60641dce49b2c606949759">DT</a>(<a class="code" href="classllvm_1_1DivergencePropagator.html#a82f5d9a55d60641dce49b2c606949759">DT</a>), PDT(PDT), LI(LI), <a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>(<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>),</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>(LoopPOT.<a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>(), nullptr),</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">DivDesc</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a3f8966a44f193849a18c573b402472b8">new</a> <a class="code" href="structllvm_1_1ControlDivergenceDesc.html">ControlDivergenceDesc</a>) {}</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1DivergencePropagator.html#a4c72630ffc031d0c72c3e0a3af2bcbda">printDefs</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;Out) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    Out &lt;&lt; <span class="stringliteral">&quot;Propagator::BlockLabels {\n&quot;</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> BlockIdx = (<span class="keywordtype">int</span>)<a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>.size() - 1; BlockIdx &gt; 0; --BlockIdx) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> *Label = <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>[BlockIdx];</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      Out &lt;&lt; LoopPOT.<a class="code" href="structllvm_1_1ModifiedPO.html#a104dff0e90fc778a5de275bf3a96f9cd">getBlockAt</a>(BlockIdx)-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">str</a>() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; BlockIdx</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;) : &quot;</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keywordflow">if</span> (!Label) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        Out &lt;&lt; <span class="stringliteral">&quot;&lt;null&gt;\n&quot;</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        Out &lt;&lt; <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f">Label</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    Out &lt;&lt; <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// Push a definition (\p PushedLabel) to \p SuccBlock and return whether this</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// causes a divergent join.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1DivergencePropagator.html#a26ba4f21aacd60c82d606f8d6830cb1a">computeJoin</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;SuccBlock, <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;PushedLabel) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">auto</span> SuccIdx = LoopPOT.<a class="code" href="structllvm_1_1ModifiedPO.html#a58ad069d9eec85a1f30209fca7e1c3d3">getIndexOf</a>(SuccBlock);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// unset or same reaching label</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *OldLabel = <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>[SuccIdx];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (!OldLabel || (OldLabel == &amp;PushedLabel)) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>[SuccIdx] = &amp;PushedLabel;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// Update the definition</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>[SuccIdx] = &amp;SuccBlock;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// visiting a virtual loop exit edge from the loop header --&gt; temporal</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// divergence on join</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">bool</span> visitLoopExitEdge(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;ExitBlock,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;DefBlock, <span class="keywordtype">bool</span> FromParentLoop) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Pushing from a non-parent loop cannot cause temporal divergence.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (!FromParentLoop)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1DivergencePropagator.html#af14ecd129e3da10ff3276dca2149a1c8">visitEdge</a>(ExitBlock, DefBlock);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1DivergencePropagator.html#a26ba4f21aacd60c82d606f8d6830cb1a">computeJoin</a>(ExitBlock, DefBlock))</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// Identified a divergent loop exit</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">DivDesc</a>-&gt;LoopDivBlocks.insert(&amp;ExitBlock);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tDivergent loop exit: &quot;</span> &lt;&lt; ExitBlock.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// process \p SuccBlock with reaching definition \p DefBlock</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1DivergencePropagator.html#af14ecd129e3da10ff3276dca2149a1c8">visitEdge</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;SuccBlock, <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;DefBlock) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1DivergencePropagator.html#a26ba4f21aacd60c82d606f8d6830cb1a">computeJoin</a>(SuccBlock, DefBlock))</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// Divergent, disjoint paths join.</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">DivDesc</a>-&gt;JoinDivBlocks.insert(&amp;SuccBlock);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tDivergent join: &quot;</span> &lt;&lt; SuccBlock.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  std::unique_ptr&lt;ControlDivergenceDesc&gt; <a class="code" href="classllvm_1_1DivergencePropagator.html#a7ffc68c7f06dd378cbb5aa700ed3ed91">computeJoinPoints</a>() {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">DivDesc</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SDA:computeJoinPoints: &quot;</span> &lt;&lt; <a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>.getName()</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *DivBlockLoop = LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(&amp;<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Early stopping criterion</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">int</span> FloorIdx = LoopPOT.<a class="code" href="structllvm_1_1ModifiedPO.html#aea9207f57619f8a7539d6488cc64f2cd">size</a>() - 1;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FloorLabel = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// bootstrap with branch targets</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">int</span> BlockIdx = 0;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *SuccBlock : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(&amp;<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>)) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keyword">auto</span> SuccIdx = LoopPOT.<a class="code" href="structllvm_1_1ModifiedPO.html#a58ad069d9eec85a1f30209fca7e1c3d3">getIndexOf</a>(*SuccBlock);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>[SuccIdx] = SuccBlock;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">// Find the successor with the highest index to start with</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      BlockIdx = std::max&lt;int&gt;(BlockIdx, SuccIdx);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      FloorIdx = std::min&lt;int&gt;(FloorIdx, SuccIdx);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="comment">// Identify immediate divergent loop exits</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">if</span> (!DivBlockLoop)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> *BlockLoop = LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(SuccBlock);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (BlockLoop &amp;&amp; DivBlockLoop-&gt;contains(BlockLoop))</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">DivDesc</a>-&gt;LoopDivBlocks.insert(SuccBlock);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tImmediate divergent loop exit: &quot;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        &lt;&lt; SuccBlock-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// propagate definitions at the immediate successors of the node in RPO</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">for</span> (; BlockIdx &gt;= FloorIdx; --BlockIdx) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Before next visit:\n&quot;</span>; <a class="code" href="classllvm_1_1DivergencePropagator.html#a4c72630ffc031d0c72c3e0a3af2bcbda">printDefs</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="comment">// Any label available here</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f">Label</a> = <a class="code" href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">BlockLabels</a>[BlockIdx];</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">if</span> (!Label)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="comment">// Ok. Get the block</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = LoopPOT.<a class="code" href="structllvm_1_1ModifiedPO.html#a104dff0e90fc778a5de275bf3a96f9cd">getBlockAt</a>(BlockIdx);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SDA::joins. visiting &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keyword">auto</span> *BlockLoop = LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(Block);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordtype">bool</span> IsLoopHeader = BlockLoop &amp;&amp; BlockLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>() == <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordtype">bool</span> CausedJoin = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordtype">int</span> LoweredFloorIdx = FloorIdx;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">if</span> (IsLoopHeader) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">// Disconnect from immediate successors and propagate directly to loop</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// exits.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 4&gt;</a> BlockLoopExits;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        BlockLoop-&gt;getExitBlocks(BlockLoopExits);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordtype">bool</span> IsParentLoop = BlockLoop-&gt;contains(&amp;<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">DivTermBlock</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *BlockLoopExit : BlockLoopExits) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          CausedJoin |= visitLoopExitEdge(*BlockLoopExit, *Label, IsParentLoop);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          LoweredFloorIdx = std::min&lt;int&gt;(LoweredFloorIdx,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                          LoopPOT.<a class="code" href="structllvm_1_1ModifiedPO.html#a58ad069d9eec85a1f30209fca7e1c3d3">getIndexOf</a>(*BlockLoopExit));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">// Acyclic successor case</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *SuccBlock : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(Block)) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          CausedJoin |= <a class="code" href="classllvm_1_1DivergencePropagator.html#af14ecd129e3da10ff3276dca2149a1c8">visitEdge</a>(*SuccBlock, *Label);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          LoweredFloorIdx =</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;              std::min&lt;int&gt;(LoweredFloorIdx, LoopPOT.<a class="code" href="structllvm_1_1ModifiedPO.html#a58ad069d9eec85a1f30209fca7e1c3d3">getIndexOf</a>(*SuccBlock));</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="comment">// Floor update</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">if</span> (CausedJoin) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">// 1. Different labels pushed to successors</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        FloorIdx = LoweredFloorIdx;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FloorLabel != Label) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">// 2. No join caused BUT we pushed a label that is different than the</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">// last pushed label</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        FloorIdx = LoweredFloorIdx;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        FloorLabel = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f">Label</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SDA::joins. After propagation:\n&quot;</span>; <a class="code" href="classllvm_1_1DivergencePropagator.html#a4c72630ffc031d0c72c3e0a3af2bcbda">printDefs</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(<a class="code" href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">DivDesc</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;};</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="namespacellvm.html#a566b94faede591a171dd12091ef00646">  440</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a566b94faede591a171dd12091ef00646">printBlockSet</a>(<a class="code" href="classllvm_1_1SmallPtrSet.html">ConstBlockSet</a> &amp;Blocks, <a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;Out) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  Out &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  ListSeparator <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c">LS</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : Blocks)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    Out &lt;&lt; <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c">LS</a> &lt;&lt; <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getName();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  Out &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keyword">const</span> <a class="code" href="structllvm_1_1ControlDivergenceDesc.html">ControlDivergenceDesc</a> &amp;</div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="classllvm_1_1SyncDependenceAnalysis.html#ad8d6cc68b9e31da6655613e8b398c659">  450</a></span>&#160;<a class="code" href="classllvm_1_1SyncDependenceAnalysis.html#ad8d6cc68b9e31da6655613e8b398c659">SyncDependenceAnalysis::getJoinBlocks</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// trivial case</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>.getNumSuccessors() &lt;= 1) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> EmptyDivergenceDesc;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// already available in cache?</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keyword">auto</span> ItCached = CachedControlDivDescs.find(&amp;<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">if</span> (ItCached != CachedControlDivDescs.end())</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">return</span> *ItCached-&gt;second;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">// compute all join points</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">// Special handling of divergent loop exits is not needed for LCSSA</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;TermBlock = *<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>.getParent();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="classllvm_1_1DivergencePropagator.html">DivergencePropagator</a> Propagator(LoopPO, DT, PDT, LI, TermBlock);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">auto</span> DivDesc = Propagator.<a class="code" href="classllvm_1_1DivergencePropagator.html#a7ffc68c7f06dd378cbb5aa700ed3ed91">computeJoinPoints</a>();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Result (&quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>.getParent()-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;):\n&quot;</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;             <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;JoinDivBlocks: &quot;</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;             <a class="code" href="namespacellvm.html#a566b94faede591a171dd12091ef00646">printBlockSet</a>(DivDesc-&gt;JoinDivBlocks, <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;             <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nLoopDivBlocks: &quot;</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;             <a class="code" href="namespacellvm.html#a566b94faede591a171dd12091ef00646">printBlockSet</a>(DivDesc-&gt;LoopDivBlocks, <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keyword">auto</span> ItInserted = CachedControlDivDescs.emplace(&amp;<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(DivDesc));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ItInserted.second);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">return</span> *ItInserted.first-&gt;second;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;} <span class="comment">// namespace llvm</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_a26ba4f21aacd60c82d606f8d6830cb1a"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#a26ba4f21aacd60c82d606f8d6830cb1a">llvm::DivergencePropagator::computeJoin</a></div><div class="ttdeci">bool computeJoin(const BlockT &amp;SuccBlock, const BlockT &amp;PushedLabel)</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00531">GenericUniformityImpl.h:531</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a04337b572d34ea413c35dbac5d75530b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const</div><div class="ttdoc">Return true if the specified loop is contained within in this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00139">LoopInfo.h:139</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26e2a938b431eaa6eca2beaa96410c9d"><div class="ttname"><a href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a></div><div class="ttdeci">auto successors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01265">MachineBasicBlock.h:1265</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt; const BasicBlock *, 4 &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_af14ecd129e3da10ff3276dca2149a1c8"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#af14ecd129e3da10ff3276dca2149a1c8">llvm::DivergencePropagator::visitEdge</a></div><div class="ttdeci">bool visitEdge(const BlockT &amp;SuccBlock, const BlockT &amp;Label)</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00580">GenericUniformityImpl.h:580</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a3f8966a44f193849a18c573b402472b8"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a3f8966a44f193849a18c573b402472b8">new</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM ID Predecessors according to mbb&lt; bb27, 0x8b0a7c0 &gt; Note ADDri is not a two address instruction its result reg1037 is an operand of the PHI node in bb76 and its operand reg1039 is the result of the PHI node We should treat it as a two address code and make sure the ADDri is scheduled after any node that reads reg1039 Use info(i.e. register scavenger) to assign it a free register to allow reuse the collector could move the objects and invalidate the derived pointer This is bad enough in the first but safe points can crop up unpredictably **array_addr i32 n y store obj * new</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00125">README.txt:125</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="astructllvm_1_1ModifiedPO_html_aea9207f57619f8a7539d6488cc64f2cd"><div class="ttname"><a href="structllvm_1_1ModifiedPO.html#aea9207f57619f8a7539d6488cc64f2cd">llvm::ModifiedPO::size</a></div><div class="ttdeci">unsigned size() const</div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8h_source.html#l00051">SyncDependenceAnalysis.h:51</a></div></div>
<div class="ttc" id="aSyncDependenceAnalysis_8h_html"><div class="ttname"><a href="SyncDependenceAnalysis_8h.html">SyncDependenceAnalysis.h</a></div></div>
<div class="ttc" id="astructllvm_1_1ModifiedPO_html_a58ad069d9eec85a1f30209fca7e1c3d3"><div class="ttname"><a href="structllvm_1_1ModifiedPO.html#a58ad069d9eec85a1f30209fca7e1c3d3">llvm::ModifiedPO::getIndexOf</a></div><div class="ttdeci">unsigned getIndexOf(const BasicBlock &amp;BB) const</div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8h_source.html#l00048">SyncDependenceAnalysis.h:48</a></div></div>
<div class="ttc" id="anamespacellvm_html_a566b94faede591a171dd12091ef00646"><div class="ttname"><a href="namespacellvm.html#a566b94faede591a171dd12091ef00646">llvm::printBlockSet</a></div><div class="ttdeci">static void printBlockSet(ConstBlockSet &amp;Blocks, raw_ostream &amp;Out)</div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8cpp_source.html#l00440">SyncDependenceAnalysis.cpp:440</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1SyncDependenceAnalysis_html_a9d12fbf93a5e027fe41448d0fc2e5f09"><div class="ttname"><a href="classllvm_1_1SyncDependenceAnalysis.html#a9d12fbf93a5e027fe41448d0fc2e5f09">llvm::SyncDependenceAnalysis::~SyncDependenceAnalysis</a></div><div class="ttdeci">~SyncDependenceAnalysis()</div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00052">raw_ostream.h:52</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aIR_2CFG_8h_html"><div class="ttname"><a href="IR_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_a82f5d9a55d60641dce49b2c606949759"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#a82f5d9a55d60641dce49b2c606949759">llvm::DivergencePropagator::DT</a></div><div class="ttdeci">const DominatorTreeT &amp; DT</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00493">GenericUniformityImpl.h:493</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_aed9304e6b154061a392a88df94a2ba6c"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#aed9304e6b154061a392a88df94a2ba6c">llvm::DominatorTreeBase::getRoot</a></div><div class="ttdeci">NodeT * getRoot() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00477">GenericDomTree.h:477</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SyncDependenceAnalysis_html_ab6abea93ecf5e0d31e9ace269170f681"><div class="ttname"><a href="classllvm_1_1SyncDependenceAnalysis.html#ab6abea93ecf5e0d31e9ace269170f681">llvm::SyncDependenceAnalysis::SyncDependenceAnalysis</a></div><div class="ttdeci">SyncDependenceAnalysis(const DominatorTree &amp;DT, const PostDominatorTree &amp;PDT, const LoopInfo &amp;LI)</div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8cpp_source.html#l00250">SyncDependenceAnalysis.cpp:250</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a7a7c8e0e4f836c13c015b62e18f386bd"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">llvm::LoopInfoBase::getLoopFor</a></div><div class="ttdeci">LoopT * getLoopFor(const BlockT *BB) const</div><div class="ttdoc">Return the inner most loop that BB lives in.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00992">LoopInfo.h:992</a></div></div>
<div class="ttc" id="astructllvm_1_1ModifiedPO_html"><div class="ttname"><a href="structllvm_1_1ModifiedPO.html">llvm::ModifiedPO</a></div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8h_source.html#l00041">SyncDependenceAnalysis.h:41</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_a3ce1c6241dbd4a80b91672bb4aa5e514"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#a3ce1c6241dbd4a80b91672bb4aa5e514">llvm::DivergencePropagator::DivDesc</a></div><div class="ttdeci">std::unique_ptr&lt; DivergenceDescriptorT &gt; DivDesc</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00505">GenericUniformityImpl.h:505</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html">llvm::DivergencePropagator</a></div><div class="ttdoc">Compute divergence starting with a divergent branch.</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00139">GenericUniformityImpl.h:139</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_a3ab9f4c02e1305316eef4eb1ec559f90"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#a3ab9f4c02e1305316eef4eb1ec559f90">llvm::DivergencePropagator::DivTermBlock</a></div><div class="ttdeci">const BlockT &amp; DivTermBlock</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00495">GenericUniformityImpl.h:495</a></div></div>
<div class="ttc" id="anamespacellvm_html_a10f3d955592ae2bc745f57e5b48ae115"><div class="ttname"><a href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">llvm::size</a></div><div class="ttdeci">auto size(R &amp;&amp;Range, std::enable_if_t&lt; std::is_base_of&lt; std::random_access_iterator_tag, typename std::iterator_traits&lt; decltype(Range.begin())&gt;::iterator_category &gt;::value, void &gt; *=nullptr)</div><div class="ttdoc">Get the size of a range.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01716">STLExtras.h:1716</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="astructllvm_1_1ControlDivergenceDesc_html"><div class="ttname"><a href="structllvm_1_1ControlDivergenceDesc.html">llvm::ControlDivergenceDesc</a></div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8h_source.html#l00034">SyncDependenceAnalysis.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1PostDominatorTree_html"><div class="ttname"><a href="classllvm_1_1PostDominatorTree.html">llvm::PostDominatorTree</a></div><div class="ttdoc">PostDominatorTree Class - Concrete subclass of DominatorTree that is used to compute the post-dominat...</div><div class="ttdef"><b>Definition:</b> <a href="PostDominators_8h_source.html#l00028">PostDominators.h:28</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f">llvm::pdb::PDB_SymType::Label</a></div><div class="ttdeci">@ Label</div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c">llvm::AArch64CC::LS</a></div><div class="ttdeci">@ LS</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00264">AArch64BaseInfo.h:264</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1SyncDependenceAnalysis_html_ad8d6cc68b9e31da6655613e8b398c659"><div class="ttname"><a href="classllvm_1_1SyncDependenceAnalysis.html#ad8d6cc68b9e31da6655613e8b398c659">llvm::SyncDependenceAnalysis::getJoinBlocks</a></div><div class="ttdeci">const ControlDivergenceDesc &amp; getJoinBlocks(const Instruction &amp;Term)</div><div class="ttdoc">Computes divergent join points and loop exits caused by branch divergence in Term.</div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8cpp_source.html#l00450">SyncDependenceAnalysis.cpp:450</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_abd0cfe9eadc0468f0b6be367ed4f59da"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#abd0cfe9eadc0468f0b6be367ed4f59da">llvm::DivergencePropagator::BlockLabels</a></div><div class="ttdeci">BlockLabelMapT &amp; BlockLabels</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00506">GenericUniformityImpl.h:506</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a223dd14e7d12bc5cea01889b972a98b2"><div class="ttname"><a href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">llvm::StringRef::str</a></div><div class="ttdeci">std::string str() const</div><div class="ttdoc">str - Get the contents as an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00222">StringRef.h:222</a></div></div>
<div class="ttc" id="astructllvm_1_1ModifiedPO_html_a104dff0e90fc778a5de275bf3a96f9cd"><div class="ttname"><a href="structllvm_1_1ModifiedPO.html#a104dff0e90fc778a5de275bf3a96f9cd">llvm::ModifiedPO::getBlockAt</a></div><div class="ttdeci">const BasicBlock * getBlockAt(unsigned Idx) const</div><div class="ttdef"><b>Definition:</b> <a href="SyncDependenceAnalysis_8h_source.html#l00052">SyncDependenceAnalysis.h:52</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1M68kBeads_html_a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd"><div class="ttname"><a href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">llvm::M68kBeads::Term</a></div><div class="ttdeci">@ Term</div><div class="ttdef"><b>Definition:</b> <a href="M68kBaseInfo_8h_source.html#l00090">M68kBaseInfo.h:90</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">llvm::pdb::PDB_SymType::Block</a></div><div class="ttdeci">@ Block</div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_a4c72630ffc031d0c72c3e0a3af2bcbda"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#a4c72630ffc031d0c72c3e0a3af2bcbda">llvm::DivergencePropagator::printDefs</a></div><div class="ttdeci">void printDefs(raw_ostream &amp;Out)</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00514">GenericUniformityImpl.h:514</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_a7ffc68c7f06dd378cbb5aa700ed3ed91"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#a7ffc68c7f06dd378cbb5aa700ed3ed91">llvm::DivergencePropagator::computeJoinPoints</a></div><div class="ttdeci">std::unique_ptr&lt; DivergenceDescriptorT &gt; computeJoinPoints()</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00591">GenericUniformityImpl.h:591</a></div></div>
<div class="ttc" id="aclassllvm_1_1DivergencePropagator_html_aefcd4588c26dc8f0236290c1e2af58d9"><div class="ttname"><a href="classllvm_1_1DivergencePropagator.html#aefcd4588c26dc8f0236290c1e2af58d9">llvm::DivergencePropagator::DivergencePropagator</a></div><div class="ttdeci">DivergencePropagator(const ModifiedPO &amp;CyclePOT, const DominatorTreeT &amp;DT, const CycleInfoT &amp;CI, const BlockT &amp;DivTermBlock)</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00508">GenericUniformityImpl.h:508</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 09:49:46 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
