<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Target/PowerPC/PPCLoopInstrFormPrep.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_794e483eb1cc7921d35fd149d9cc325b.html">Target</a></li><li class="navelem"><a class="el" href="dir_1854d513cb8eef295481a59a854f7656.html">PowerPC</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PPCLoopInstrFormPrep.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="PPCLoopInstrFormPrep_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===------ PPCLoopInstrFormPrep.cpp - Loop Instr Form Prep Pass ----------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements a pass to prepare loops for ppc preferred addressing</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// modes, leveraging different instruction form. (eg: DS/DQ form, D/DS form with</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// update)</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// Additional PHIs are created for loop induction variables used by load/store</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// instructions so that preferred addressing modes can be used.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// 1: DS/DQ form preparation, prepare the load/store instructions so that they</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//    can satisfy the DS/DQ form displacement requirements.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//    Generically, this means transforming loops like this:</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//    for (int i = 0; i &lt; n; ++i) {</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//      unsigned long x1 = *(unsigned long *)(p + i + 5);</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//      unsigned long x2 = *(unsigned long *)(p + i + 9);</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//    to look like this:</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//    unsigned NewP = p + 5;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//    for (int i = 0; i &lt; n; ++i) {</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//      unsigned long x1 = *(unsigned long *)(i + NewP);</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//      unsigned long x2 = *(unsigned long *)(i + NewP + 4);</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// 2: D/DS form with update preparation, prepare the load/store instructions so</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//    that we can use update form to do pre-increment.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//    Generically, this means transforming loops like this:</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//    for (int i = 0; i &lt; n; ++i)</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//      array[i] = c;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//    to look like this:</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//    T *p = array[-1];</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//    for (int i = 0; i &lt; n; ++i)</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//      *++p = c;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// 3: common multiple chains for the load/stores with same offsets in the loop,</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//    so that we can reuse the offsets and reduce the register pressure in the</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//    loop. This transformation can also increase the loop ILP as now each chain</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//    uses its own loop induction add/addi. But this will increase the number of</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//    add/addi in the loop.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//    Generically, this means transforming loops like this:</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//    char *p;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//    A1 = p + base1</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//    A2 = p + base1 + offset</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//    B1 = p + base2</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//    B2 = p + base2 + offset</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//    for (int i = 0; i &lt; n; i++)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//      unsigned long x1 = *(unsigned long *)(A1 + i);</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//      unsigned long x2 = *(unsigned long *)(A2 + i)</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//      unsigned long x3 = *(unsigned long *)(B1 + i);</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//      unsigned long x4 = *(unsigned long *)(B2 + i);</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//    to look like this:</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//    A1_new = p + base1 // chain 1</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//    B1_new = p + base2 // chain 2, now inside the loop, common offset is</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//                       // reused.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//    for (long long i = 0; i &lt; n; i+=count) {</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//      unsigned long x1 = *(unsigned long *)(A1_new + i);</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//      unsigned long x2 = *(unsigned long *)((A1_new + i) + offset);</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//      unsigned long x3 = *(unsigned long *)(B1_new + i);</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//      unsigned long x4 = *(unsigned long *)((B1_new + i) + offset);</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PPC_8h.html">PPC.h</a>&quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PPCSubtarget_8h.html">PPCSubtarget.h</a>&quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PPCTargetMachine_8h.html">PPCTargetMachine.h</a>&quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DepthFirstIterator_8h.html">llvm/ADT/DepthFirstIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolution_8h.html">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpressions_8h.html">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2CFG_8h.html">llvm/IR/CFG.h</a>&quot;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;llvm/IR/IntrinsicsPowerPC.h&quot;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_8h.html">llvm/Transforms/Utils.h</a>&quot;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopUtils_8h.html">llvm/Transforms/Utils/LoopUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpander_8h.html">llvm/Transforms/Utils/ScalarEvolutionExpander.h</a>&quot;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">  115</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;ppc-loop-instr-form-prep&quot;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#abd5fa22b0494828fb201bad19ae78e64">MaxVarsPrep</a>(<span class="stringliteral">&quot;ppc-formprep-max-vars&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(24),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Potential common base number threshold per function &quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                         <span class="stringliteral">&quot;for PPC loop prep&quot;</span>));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#aef9b4993495f559270a6875cbaeaad4f">PreferUpdateForm</a>(<span class="stringliteral">&quot;ppc-formprep-prefer-update&quot;</span>,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                 <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;prefer update form when ds form is also a update form&quot;</span>));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ade4b0ceb355799ae96ec6adb03a67026">EnableUpdateFormForNonConstInc</a>(</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="stringliteral">&quot;ppc-formprep-update-nonconst-inc&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;prepare update form when the load/store increment is a loop &quot;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;             <span class="stringliteral">&quot;invariant non-const value.&quot;</span>));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#abb7196e5faec17e673251a5bb83ec9ca">EnableChainCommoning</a>(</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="stringliteral">&quot;ppc-formprep-chain-commoning&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable chain commoning in PPC loop prepare pass.&quot;</span>));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">// Sum of following 3 per loop thresholds for all loops can not be larger</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">// than MaxVarsPrep.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">// now the thresholds for each kind prep are exterimental values on Power9.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a4b3dd3f72c269fc5371497e36525651c">MaxVarsUpdateForm</a>(<span class="stringliteral">&quot;ppc-preinc-prep-max-vars&quot;</span>,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                 <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(3),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Potential PHI threshold per loop for PPC loop prep of update &quot;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;           <span class="stringliteral">&quot;form&quot;</span>));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a3ee9baedeb296a9b779b9363b547ad40">MaxVarsDSForm</a>(<span class="stringliteral">&quot;ppc-dsprep-max-vars&quot;</span>,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                 <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(3),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Potential PHI threshold per loop for PPC loop prep of DS form&quot;</span>));</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a09750fd32fa96b7750d45c244a995126">MaxVarsDQForm</a>(<span class="stringliteral">&quot;ppc-dqprep-max-vars&quot;</span>,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                 <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(8),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Potential PHI threshold per loop for PPC loop prep of DQ form&quot;</span>));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// Commoning chain will reduce the register pressure, so we don&#39;t consider about</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">// the PHI nodes number.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">// But commoning chain will increase the addi/add number in the loop and also</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">// increase loop ILP. Maximum chain number should be same with hardware</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">// IssueWidth, because we won&#39;t benefit from ILP if the parallel chains number</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// is bigger than IssueWidth. We assume there are 2 chains in one bucket, so</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">// there would be 4 buckets at most on P9(IssueWidth is 8).</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a37f81249266813ec70ebf6f12922975d">MaxVarsChainCommon</a>(</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="stringliteral">&quot;ppc-chaincommon-max-vars&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(4),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Bucket number per loop for PPC loop chain common&quot;</span>));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">// If would not be profitable if the common base has only one load/store, ISEL</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// should already be able to choose best load/store form based on offset for</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">// single load/store. Set minimal profitable value default to 2 and make it as</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">// an option.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a6489c984a1218205ac22c47766b50ca1">DispFormPrepMinThreshold</a>(<span class="stringliteral">&quot;ppc-dispprep-min-threshold&quot;</span>,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(2),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Minimal common base load/store instructions triggering DS/DQ form &quot;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;           <span class="stringliteral">&quot;preparation&quot;</span>));</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ae380dba17971969fa47dbf027684048e">ChainCommonPrepMinThreshold</a>(</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="stringliteral">&quot;ppc-chaincommon-min-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(4),</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Minimal common base load/store instructions triggering chain &quot;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;             <span class="stringliteral">&quot;commoning preparation. Must be not smaller than 4&quot;</span>));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(PHINodeAlreadyExistsUpdate, <span class="stringliteral">&quot;PHI node already in pre-increment form&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(PHINodeAlreadyExistsDS, <span class="stringliteral">&quot;PHI node already in DS form&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(PHINodeAlreadyExistsDQ, <span class="stringliteral">&quot;PHI node already in DQ form&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(DSFormChainRewritten, <span class="stringliteral">&quot;Num of DS form chain rewritten&quot;</span>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(DQFormChainRewritten, <span class="stringliteral">&quot;Num of DQ form chain rewritten&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(UpdFormChainRewritten, <span class="stringliteral">&quot;Num of update form chain rewritten&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(ChainCommoningRewritten, <span class="stringliteral">&quot;Num of commoning chains&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keyword">struct </span>BucketElement {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    BucketElement(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) : <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>), Instr(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    BucketElement(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) : <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>(nullptr), Instr(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {}</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Instr;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  };</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keyword">struct </span>Bucket {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    Bucket(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        : BaseSCEV(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>), <a class="code" href="namespacellvm_1_1logicalview.html#a8d87e69e124542d3338b631934cdbea9aaa56a2e65d8106aef3c61e4f6bf94fdb">Elements</a>(1, BucketElement(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      ChainSize = 0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// The base of the whole bucket.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BaseSCEV;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// All elements in the bucket. In the bucket, the element with the BaseSCEV</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// has no offset and all other elements are stored as offsets to the</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// BaseSCEV.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BucketElement, 16&gt;</a> <a class="code" href="namespacellvm_1_1logicalview.html#a8d87e69e124542d3338b631934cdbea9aaa56a2e65d8106aef3c61e4f6bf94fdb">Elements</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// The potential chains size. This is used for chain commoning only.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">unsigned</span> ChainSize;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// The base for each potential chain. This is used for chain commoning only.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BucketElement, 16&gt;</a> ChainBases;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  };</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// &quot;UpdateForm&quot; is not a real PPC instruction form, it stands for dform</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// load/store with update like ldu/stdu, or Prefetch intrinsic.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// For DS form instructions, their displacements must be multiple of 4.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// For DQ form instructions, their displacements must be multiple of 16.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">enum</span> PrepForm { UpdateForm = 1, DSForm = 4, DQForm = 16, ChainCommoning };</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keyword">class </span>PPCLoopInstrFormPrep : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; <span class="comment">// Pass ID, replacement for typeid</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    PPCLoopInstrFormPrep() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <a class="code" href="namespacellvm.html#adc9b8c53e964842915e0ef5373b38827">initializePPCLoopInstrFormPrepPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    PPCLoopInstrFormPrep(<a class="code" href="classllvm_1_1PPCTargetMachine.html">PPCTargetMachine</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>) : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>), <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>(&amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="namespacellvm.html#adc9b8c53e964842915e0ef5373b38827">initializePPCLoopInstrFormPrepPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolutionWrapperPass.html">ScalarEvolutionWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classllvm_1_1PPCTargetMachine.html">PPCTargetMachine</a> *<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1PPCSubtarget.html">PPCSubtarget</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">bool</span> PreserveLCSSA;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">bool</span> HasCandidateForPrepare;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">    /// Successful preparation number for Update/DS/DQ form in all inner most</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">    /// loops. One successful preparation will put one common base out of loop,</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">    /// this may leads to register presure like LICM does.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">    /// Make sure total preparation number can be controlled by option.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> SuccPrepCount;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">bool</span> runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">    /// Check if required PHI node is already exist in Loop \p L.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> alreadyPrepared(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemI,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrStartSCEV,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrIncSCEV, PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">    /// Get the value which defines the increment SCEV \p BasePtrIncSCEV.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Value.html">Value</a> *getNodeForInc(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemI,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrIncSCEV);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    /// Common chains to reuse offsets for a loop to reduce register pressure.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> chainCommoning(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">    /// Find out the potential commoning chains and their bases.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> prepareBasesForCommoningChains(Bucket &amp;BucketChain);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">    /// Rewrite load/store according to the common chains.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    rewriteLoadStoresForCommoningChains(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, Bucket &amp;Bucket,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                        <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 16&gt;</a> &amp;BBChanged);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">    /// Collect condition matched(\p isValidCandidate() returns true)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">    /// candidates in Loop \p L.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> collectCandidates(</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, <a class="code" href="classllvm_1_1Value.html">Value</a> *, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *)&gt;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            isValidCandidate,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *)&gt; isValidDiff,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">unsigned</span> MaxCandidateNum);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    /// Add a candidate to candidates \p Buckets if diff between candidate and</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">    /// one base in \p Buckets matches \p isValidDiff.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> addOneCandidate(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *LSCEV,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                         <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                         <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *)&gt; isValidDiff,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                         <span class="keywordtype">unsigned</span> MaxCandidateNum);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    /// Prepare all candidates in \p Buckets for update form.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> updateFormPrep(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    /// Prepare all candidates in \p Buckets for displacement form, now for</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    /// ds/dq.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> dispFormPrep(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets, PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">    /// Prepare for one chain \p BucketChain, find the best base element and</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">    /// update all other elements in \p BucketChain accordingly.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">    /// \p Form is used to find the best base element.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">    /// If success, best base element must be stored as the first element of</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">    /// \p BucketChain.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    /// Return false if no base element found, otherwise return true.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> prepareBaseForDispFormChain(Bucket &amp;BucketChain, PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">    /// Prepare for one chain \p BucketChain, find the best base element and</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    /// update all other elements in \p BucketChain accordingly.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">    /// If success, best base element must be stored as the first element of</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    /// \p BucketChain.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">    /// Return false if no base element found, otherwise return true.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> prepareBaseForUpdateFormChain(Bucket &amp;BucketChain);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">    /// Rewrite load/store instructions in \p BucketChain according to</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">    /// preparation.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> rewriteLoadStores(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, Bucket &amp;BucketChain,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                           <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 16&gt;</a> &amp;BBChanged,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                           PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">    /// Rewrite for the base load/store of a chain.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span>    std::pair&lt;Instruction *, Instruction *&gt;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    rewriteForBase(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *BasePtrSCEV,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                   <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BaseMemI, <span class="keywordtype">bool</span> CanPreInc, PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                   <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;SCEVE, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> &amp;DeletedPtrs);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">    /// Rewrite for the other load/stores of a chain according to the new \p</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    /// Base.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    rewriteForBucketElement(std::pair&lt;Instruction *, Instruction *&gt; Base,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                            <span class="keyword">const</span> BucketElement &amp;Element, <a class="code" href="classllvm_1_1Value.html">Value</a> *OffToBase,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                            <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> &amp;DeletedPtrs);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  };</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">PPCLoopInstrFormPrep::ID</a> = 0;</div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">  341</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;Prepare loop for ppc preferred instruction forms&quot;</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<a class="code" href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a>(PPCLoopInstrFormPrep, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1ScalarEvolutionWrapperPass.html">ScalarEvolutionWrapperPass</a>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(PPCLoopInstrFormPrep, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#a7f229d5ad3269446f6de883c610bdad9">  347</a></span>&#160;static constexpr <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7f229d5ad3269446f6de883c610bdad9">PHINodeNameSuffix</a>    = &quot;.<a class="code" href="namespacellvm_1_1numbers.html#a9473b507816be4056a158a41cfb86807">phi</a>&quot;;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#af825625d346ed84be24c4d52b8c46f40">  348</a></span>&#160;static constexpr <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#af825625d346ed84be24c4d52b8c46f40">CastNodeNameSuffix</a>   = &quot;.<a class="code" href="namespacellvm.html#ac4fc845f5ed92de63cd4474f128f5fc5">cast</a>&quot;;</div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#a45c91183fa3018e4aa1db711feec00c3">  349</a></span>&#160;static constexpr <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a45c91183fa3018e4aa1db711feec00c3">GEPNodeIncNameSuffix</a> = &quot;.<a class="code" href="lib_2Target_2X86_2README_8txt.html#ad2f7724072b5d664bca622e53494c853">inc</a>&quot;;</div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#a225729c72185b480053c04b7f0395c64">  350</a></span>&#160;static constexpr <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a225729c72185b480053c04b7f0395c64">GEPNodeOffNameSuffix</a> = &quot;.off&quot;;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="namespacellvm.html#a1c5781563265f0f6f21b8cdcbd638639">  352</a></span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#a1c5781563265f0f6f21b8cdcbd638639">createPPCLoopInstrFormPrepPass</a>(<a class="code" href="classllvm_1_1PPCTargetMachine.html">PPCTargetMachine</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> PPCLoopInstrFormPrep(<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#ad83e09e9f97995f00b7200b604edd436">  356</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ad83e09e9f97995f00b7200b604edd436">IsPtrInBounds</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtr) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StrippedBasePtr = BasePtr;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *BC = dyn_cast&lt;BitCastInst&gt;(StrippedBasePtr))</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    StrippedBasePtr = BC-&gt;getOperand(0);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(StrippedBasePtr))</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;isInBounds();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;}</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">  366</a></span>&#160;<span class="keyword">static</span> std::string <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Suffix) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &amp;&amp; <span class="stringliteral">&quot;Invalid paramater!&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasName())</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getName() + Suffix).str();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">  374</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *MemI,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                       <a class="code" href="classllvm_1_1Type.html">Type</a> **PtrElementType = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *PointerElementType = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LMemI = dyn_cast&lt;LoadInst&gt;(MemI)) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    PtrValue = LMemI-&gt;getPointerOperand();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    PointerElementType = LMemI-&gt;getType();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *SMemI = dyn_cast&lt;StoreInst&gt;(MemI)) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    PtrValue = SMemI-&gt;getPointerOperand();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    PointerElementType = SMemI-&gt;getValueOperand()-&gt;getType();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *IMemI = dyn_cast&lt;IntrinsicInst&gt;(MemI)) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    PointerElementType = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(MemI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (IMemI-&gt;getIntrinsicID() == <a class="code" href="LoopDataPrefetch_8cpp.html#af1aa8156fe6dc9478d31e05cf3c1eb9b">Intrinsic::prefetch</a> ||</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        IMemI-&gt;getIntrinsicID() == Intrinsic::ppc_vsx_lxvp) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      PtrValue = IMemI-&gt;getArgOperand(0);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IMemI-&gt;getIntrinsicID() == Intrinsic::ppc_vsx_stxvp) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      PtrValue = IMemI-&gt;getArgOperand(1);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">/*Get ElementType if PtrElementType is not null.*/</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span> (PtrElementType)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    *PtrElementType = PointerElementType;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">return</span> PtrValue;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">PPCLoopInstrFormPrep::runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> (skipFunction(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  LI = &amp;getAnalysis&lt;LoopInfoWrapperPass&gt;().getLoopInfo();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  SE = &amp;getAnalysis&lt;ScalarEvolutionWrapperPass&gt;().getSE();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keyword">auto</span> *DTWP = getAnalysisIfAvailable&lt;DominatorTreeWrapperPass&gt;();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  DT = DTWP ? &amp;DTWP-&gt;getDomTree() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  PreserveLCSSA = mustPreserveAnalysisID(<a class="code" href="namespacellvm.html#a3e3d3c6d4e33a4f5ca579ee7939f0349">LCSSAID</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> = <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a> ? <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>-&gt;getSubtargetImpl(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  SuccPrepCount = 0;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *LI)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : <a class="code" href="namespacellvm.html#add49d9f7abebe402adf1a57c762abeef">depth_first</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      MadeChange |= runOnLoop(L);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">// Finding the minimal(chain_number + reusable_offset_number) is a complicated</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">// algorithmic problem.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">// For now, the algorithm used here is simply adjusted to handle the case for</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">// manually unrolling cases.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">// FIXME: use a more powerful algorithm to find minimal sum of chain_number and</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">// reusable_offset_number for one base with multiple offsets.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::prepareBasesForCommoningChains(Bucket &amp;CBucket) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// The minimal size for profitable chain commoning:</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// A1 = base + offset1</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">// A2 = base + offset2 (offset2 - offset1 = X)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">// A3 = base + offset3</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// A4 = base + offset4 (offset4 - offset3 = X)</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// ======&gt;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// base1 = base + offset1</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// base2 = base + offset3</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// A1 = base1</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">// A2 = base1 + X</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// A3 = base2</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// A4 = base2 + X</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">// There is benefit because of reuse of offest &#39;X&#39;.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ae380dba17971969fa47dbf027684048e">ChainCommonPrepMinThreshold</a> &gt;= 4 &amp;&amp;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         <span class="stringliteral">&quot;Thredhold can not be smaller than 4!\n&quot;</span>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span> (CBucket.Elements.size() &lt; <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ae380dba17971969fa47dbf027684048e">ChainCommonPrepMinThreshold</a>)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">// We simply select the FirstOffset as the first reusable offset between each</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// chain element 1 and element 0.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *FirstOffset = CBucket.Elements[1].Offset;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// Figure out how many times above FirstOffset is used in the chain.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// For a success commoning chain candidate, offset difference between each</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// chain element 1 and element 0 must be also FirstOffset.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordtype">unsigned</span> FirstOffsetReusedCount = 1;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="comment">// Figure out how many times above FirstOffset is used in the first chain.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// Chain number is FirstOffsetReusedCount / FirstOffsetReusedCountInFirstChain</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordtype">unsigned</span> FirstOffsetReusedCountInFirstChain = 1;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">unsigned</span> EleNum = CBucket.Elements.size();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">bool</span> SawChainSeparater = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 2; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != EleNum; ++<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(CBucket.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].Offset,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                         CBucket.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> - 1].Offset) == FirstOffset) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">if</span> (!SawChainSeparater)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        FirstOffsetReusedCountInFirstChain++;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      FirstOffsetReusedCount++;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="comment">// For now, if we meet any offset which is not FirstOffset, we assume we</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="comment">// find a new Chain.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="comment">// This makes us miss some opportunities.</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="comment">// For example, we can common:</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="comment">// {OffsetA, Offset A, OffsetB, OffsetA, OffsetA, OffsetB}</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="comment">// as two chains:</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="comment">// {{OffsetA, Offset A, OffsetB}, {OffsetA, OffsetA, OffsetB}}</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="comment">// FirstOffsetReusedCount = 4; FirstOffsetReusedCountInFirstChain = 2</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="comment">// But we fail to common:</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">// {OffsetA, OffsetB, OffsetA, OffsetA, OffsetB, OffsetA}</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="comment">// FirstOffsetReusedCount = 4; FirstOffsetReusedCountInFirstChain = 1</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      SawChainSeparater = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// FirstOffset is not reused, skip this bucket.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (FirstOffsetReusedCount == 1)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">unsigned</span> ChainNum =</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      FirstOffsetReusedCount / FirstOffsetReusedCountInFirstChain;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// All elements are increased by FirstOffset.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// The number of chains should be sqrt(EleNum).</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (!SawChainSeparater)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    ChainNum = (<a class="code" href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a>)sqrt((<span class="keywordtype">double</span>)EleNum);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  CBucket.ChainSize = (<a class="code" href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a>)(EleNum / ChainNum);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// If this is not a perfect chain(eg: not all elements can be put inside</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// commoning chains.), skip now.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (CBucket.ChainSize * ChainNum != EleNum)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">if</span> (SawChainSeparater) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// Check that the offset seqs are the same for all chains.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; CBucket.ChainSize; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 1; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; ChainNum; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>++)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span> (CBucket.Elements[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].Offset !=</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(CBucket.Elements[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> * CBucket.ChainSize].Offset,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                             CBucket.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> * CBucket.ChainSize].Offset))</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ChainNum; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    CBucket.ChainBases.push_back(CBucket.Elements[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> * CBucket.ChainSize]);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Bucket has &quot;</span> &lt;&lt; ChainNum &lt;&lt; <span class="stringliteral">&quot; chains.\n&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::chainCommoning(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                          <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">if</span> (Buckets.empty())</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 16&gt;</a> BBChanged;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Bucket : Buckets) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (prepareBasesForCommoningChains(Bucket))</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      MadeChange |= rewriteLoadStoresForCommoningChains(L, Bucket, BBChanged);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordflow">if</span> (MadeChange)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : BBChanged)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <a class="code" href="namespacellvm.html#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;}</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::rewriteLoadStoresForCommoningChains(</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, Bucket &amp;Bucket, <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 16&gt;</a> &amp;BBChanged) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Bucket.Elements.size() ==</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;             Bucket.ChainBases.size() * Bucket.ChainSize &amp;&amp;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;         <span class="stringliteral">&quot;invalid bucket for chain commoning!\n&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> DeletedPtrs;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopPredecessor = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a88575baf2ad9f4cd2e2432e6da4a976b">getLoopPredecessor</a>();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> SCEVE(*SE, Header-&gt;getModule()-&gt;getDataLayout(),</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                     <span class="stringliteral">&quot;loopprepare-chaincommon&quot;</span>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ChainIdx = 0; ChainIdx &lt; Bucket.ChainBases.size(); ++ChainIdx) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">unsigned</span> BaseElemIdx = Bucket.ChainSize * ChainIdx;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BaseSCEV =</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        ChainIdx ? SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(Bucket.BaseSCEV,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                  Bucket.Elements[BaseElemIdx].Offset)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                 : Bucket.BaseSCEV;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *BasePtrSCEV = cast&lt;SCEVAddRecExpr&gt;(BaseSCEV);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">// Make sure the base is able to expand.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">if</span> (!SCEVE.isSafeToExpand(BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>()))</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>() &amp;&amp;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;           <span class="stringliteral">&quot;Invalid SCEV type for the base ptr for a candidate chain!\n&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    std::pair&lt;Instruction *, Instruction *&gt; <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = rewriteForBase(</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        L, BasePtrSCEV, Bucket.Elements[BaseElemIdx].Instr,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keyword">false</span> <span class="comment">/* CanPreInc */</span>, ChainCommoning, SCEVE, DeletedPtrs);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.first || !<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.second)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// Keep track of the replacement pointer values we&#39;ve inserted so that we</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// don&#39;t generate more pointer values than necessary.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> NewPtrs;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    NewPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.first);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = BaseElemIdx + 1; Idx &lt; BaseElemIdx + Bucket.ChainSize;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;         ++Idx) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      BucketElement &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Bucket.Elements[Idx];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.Instr);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> &amp;&amp; <span class="stringliteral">&quot;No pointer operand&quot;</span>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">if</span> (NewPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>))</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *OffsetSCEV =</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          BaseElemIdx ? SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(Bucket.Elements[Idx].Offset,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                         Bucket.Elements[BaseElemIdx].Offset)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                      : Bucket.Elements[Idx].Offset;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="comment">// Make sure offset is able to expand. Only need to check one time as the</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="comment">// offsets are reused between different chains.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">if</span> (!BaseElemIdx)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span> (!SCEVE.isSafeToExpand(OffsetSCEV))</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *OffsetValue = SCEVE.expandCodeFor(</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          OffsetSCEV, OffsetSCEV-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>(), LoopPredecessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewPtr = rewriteForBucketElement(Base, Bucket.Elements[Idx],</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                                    OffsetValue, DeletedPtrs);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewPtr &amp;&amp; <span class="stringliteral">&quot;Wrong rewrite!\n&quot;</span>);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      NewPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(NewPtr);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    ++ChainCommoningRewritten;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="comment">// Clear the rewriter cache, because values that are in the rewriter&#39;s cache</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="comment">// can be deleted below, causing the AssertingVH in the cache to trigger.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  SCEVE.clear();</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> : DeletedPtrs) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IDel = dyn_cast&lt;Instruction&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>))</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      BBChanged.<a class="code" href="classllvm_1_1SmallSet.html#a1679469af9bb8ccfbe98441fb8228c79">insert</a>(IDel-&gt;getParent());</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="namespacellvm.html#a1106b8a15061e8494873e10bb8a364e5">RecursivelyDeleteTriviallyDeadInstructions</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">// Rewrite the new base according to BasePtrSCEV.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">// bb.loop.preheader:</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">//   %newstart = ...</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">// bb.loop.body:</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">//   %phinode = phi [ %newstart, %bb.loop.preheader ], [ %add, %bb.loop.body ]</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">//   %add = getelementptr %phinode, %inc</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">// First returned instruciton is %phinode (or a type cast to %phinode), caller</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">// needs this value to rewrite other load/stores in the same chain.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">// Second returned instruction is %add, caller needs this value to rewrite other</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">// load/stores in the same chain.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;std::pair&lt;Instruction *, Instruction *&gt;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;PPCLoopInstrFormPrep::rewriteForBase(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *BasePtrSCEV,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                     <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *BaseMemI, <span class="keywordtype">bool</span> CanPreInc,</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                     PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>, <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> &amp;SCEVE,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                     <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> &amp;DeletedPtrs) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;PIP: Transforming: &quot;</span> &lt;&lt; *BasePtrSCEV &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() == L &amp;&amp; <span class="stringliteral">&quot;AddRec for the wrong loop?&quot;</span>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a> = <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a>(BaseMemI);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BasePtr &amp;&amp; <span class="stringliteral">&quot;No pointer operand&quot;</span>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *I8Ty = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(BaseMemI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>());</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *I8PtrTy =</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">Type::getInt8PtrTy</a>(BaseMemI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(),</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                         <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType()-&gt;getPointerAddressSpace());</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordtype">bool</span> IsConstantInc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrIncSCEV = BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(*SE);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IncNode = getNodeForInc(L, BaseMemI, BasePtrIncSCEV);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *BasePtrIncConstantSCEV =</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      dyn_cast&lt;SCEVConstant&gt;(BasePtrIncSCEV);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">if</span> (BasePtrIncConstantSCEV)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    IsConstantInc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="comment">// No valid representation for the increment.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">if</span> (!IncNode) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop Increasement can not be represented!\n&quot;</span>);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span> std::make_pair(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == UpdateForm &amp;&amp; !IsConstantInc &amp;&amp; !<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ade4b0ceb355799ae96ec6adb03a67026">EnableUpdateFormForNonConstInc</a>) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Update form prepare for non-const increment is not enabled!\n&quot;</span>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">return</span> std::make_pair(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrStartSCEV = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">if</span> (CanPreInc) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(BasePtrIncSCEV, L) &amp;&amp;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;           <span class="stringliteral">&quot;Increment is not loop invariant!\n&quot;</span>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    BasePtrStartSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>(),</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                        IsConstantInc ? BasePtrIncConstantSCEV</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                                      : BasePtrIncSCEV);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    BasePtrStartSCEV = BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>();</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">if</span> (alreadyPrepared(L, BaseMemI, BasePtrStartSCEV, BasePtrIncSCEV, <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>)) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Instruction form is already prepared!\n&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span> std::make_pair(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;PIP: New start is: &quot;</span> &lt;&lt; *BasePtrStartSCEV &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordtype">unsigned</span> HeaderLoopPredCount = <a class="code" href="namespacellvm.html#ae6d1c31d74bbaaa9e42bcbdc10a499f2">pred_size</a>(Header);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopPredecessor = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a88575baf2ad9f4cd2e2432e6da4a976b">getLoopPredecessor</a>();</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPHI = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(I8PtrTy, HeaderLoopPredCount,</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                    <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(BaseMemI, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7f229d5ad3269446f6de883c610bdad9">PHINodeNameSuffix</a>),</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                    Header-&gt;getFirstNonPHI());</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *BasePtrStart = SCEVE.<a class="code" href="classllvm_1_1SCEVExpander.html#a7c9143ef971c8a2f094afaf228c9e648">expandCodeFor</a>(BasePtrStartSCEV, I8PtrTy,</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                            LoopPredecessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="comment">// Note that LoopPredecessor might occur in the predecessor list multiple</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">// times, and we need to add it the right number of times.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *PI : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(Header)) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">if</span> (PI != LoopPredecessor)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    NewPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(BasePtrStart, LoopPredecessor);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PtrInc = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewBasePtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span> (CanPreInc) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsPoint = &amp;*Header-&gt;getFirstInsertionPt();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    PtrInc = <a class="code" href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">GetElementPtrInst::Create</a>(</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        I8Ty, NewPHI, IncNode, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(BaseMemI, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a45c91183fa3018e4aa1db711feec00c3">GEPNodeIncNameSuffix</a>),</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        InsPoint);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    cast&lt;GetElementPtrInst&gt;(PtrInc)-&gt;setIsInBounds(<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ad83e09e9f97995f00b7200b604edd436">IsPtrInBounds</a>(BasePtr));</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *PI : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(Header)) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keywordflow">if</span> (PI == LoopPredecessor)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      NewPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(PtrInc, PI);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">if</span> (PtrInc-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType())</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      NewBasePtr =</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(PtrInc, <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType(),</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                          <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(PtrInc, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#af825625d346ed84be24c4d52b8c46f40">CastNodeNameSuffix</a>), InsPoint);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      NewBasePtr = PtrInc;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">// Note that LoopPredecessor might occur in the predecessor list multiple</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">// times, and we need to make sure no more incoming value for them in PHI.</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *PI : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(Header)) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">if</span> (PI == LoopPredecessor)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="comment">// For the latch predecessor, we need to insert a GEP just before the</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// terminator to increase the address.</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = PI;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsPoint = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator();</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      PtrInc = <a class="code" href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">GetElementPtrInst::Create</a>(</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          I8Ty, NewPHI, IncNode, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(BaseMemI, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a45c91183fa3018e4aa1db711feec00c3">GEPNodeIncNameSuffix</a>),</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          InsPoint);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      cast&lt;GetElementPtrInst&gt;(PtrInc)-&gt;setIsInBounds(<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ad83e09e9f97995f00b7200b604edd436">IsPtrInBounds</a>(BasePtr));</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      NewPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(PtrInc, PI);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    PtrInc = NewPHI;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">if</span> (NewPHI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType())</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      NewBasePtr = <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(NewPHI, <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType(),</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                                   <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(NewPHI, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#af825625d346ed84be24c4d52b8c46f40">CastNodeNameSuffix</a>),</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                   &amp;*Header-&gt;getFirstInsertionPt());</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      NewBasePtr = NewPHI;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;replaceAllUsesWith(NewBasePtr);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  DeletedPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(BasePtr);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">return</span> std::make_pair(NewBasePtr, PtrInc);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;}</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PPCLoopInstrFormPrep::rewriteForBucketElement(</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    std::pair&lt;Instruction *, Instruction *&gt; Base, <span class="keyword">const</span> BucketElement &amp;Element,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *OffToBase, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> &amp;DeletedPtrs) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewBasePtr = <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.first;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PtrInc = <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.second;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((NewBasePtr &amp;&amp; PtrInc) &amp;&amp; <span class="stringliteral">&quot;base does not exist!\n&quot;</span>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *I8Ty = <a class="code" href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">Type::getInt8Ty</a>(PtrInc-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>());</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a>(Element.Instr);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> &amp;&amp; <span class="stringliteral">&quot;No pointer operand&quot;</span>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *RealNewPtr;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">if</span> (!Element.Offset ||</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      (isa&lt;SCEVConstant&gt;(Element.Offset) &amp;&amp;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;       cast&lt;SCEVConstant&gt;(Element.Offset)-&gt;getValue()-&gt;isZero())) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    RealNewPtr = NewBasePtr;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PtrIP = dyn_cast&lt;Instruction&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (PtrIP &amp;&amp; isa&lt;Instruction&gt;(NewBasePtr) &amp;&amp;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        cast&lt;Instruction&gt;(NewBasePtr)-&gt;<a class="code" href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a>() == PtrIP-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>())</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      PtrIP = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PtrIP &amp;&amp; isa&lt;PHINode&gt;(PtrIP))</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      PtrIP = &amp;*PtrIP-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>();</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!PtrIP)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      PtrIP = Element.Instr;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OffToBase &amp;&amp; <span class="stringliteral">&quot;There should be an offset for non base element!\n&quot;</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *NewPtr = <a class="code" href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">GetElementPtrInst::Create</a>(</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        I8Ty, PtrInc, OffToBase,</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(Element.Instr, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a225729c72185b480053c04b7f0395c64">GEPNodeOffNameSuffix</a>), PtrIP);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (!PtrIP)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      NewPtr-&gt;<a class="code" href="classllvm_1_1Instruction.html#af09e4096de244d2fb345891328714a63">insertAfter</a>(cast&lt;Instruction&gt;(PtrInc));</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    NewPtr-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#a837e9f272fd070a5f8fc79c07a951106">setIsInBounds</a>(<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#ad83e09e9f97995f00b7200b604edd436">IsPtrInBounds</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>));</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    RealNewPtr = NewPtr;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ReplNewPtr;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType() != RealNewPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    ReplNewPtr = <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(RealNewPtr, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(),</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                 <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#af825625d346ed84be24c4d52b8c46f40">CastNodeNameSuffix</a>));</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    ReplNewPtr-&gt;<a class="code" href="classllvm_1_1Instruction.html#af09e4096de244d2fb345891328714a63">insertAfter</a>(RealNewPtr);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    ReplNewPtr = RealNewPtr;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;replaceAllUsesWith(ReplNewPtr);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  DeletedPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">return</span> ReplNewPtr;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="keywordtype">void</span> PPCLoopInstrFormPrep::addOneCandidate(</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *LSCEV, <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *)&gt; isValidDiff, <span class="keywordtype">unsigned</span> MaxCandidateNum) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((MemI &amp;&amp; <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a>(MemI)) &amp;&amp;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;         <span class="stringliteral">&quot;Candidate should be a memory instruction.&quot;</span>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LSCEV &amp;&amp; <span class="stringliteral">&quot;Invalid SCEV for Ptr value.&quot;</span>);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordtype">bool</span> FoundBucket = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> : Buckets) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">if</span> (cast&lt;SCEVAddRecExpr&gt;(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.BaseSCEV)-&gt;getStepRecurrence(*SE) !=</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        cast&lt;SCEVAddRecExpr&gt;(LSCEV)-&gt;getStepRecurrence(*SE))</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Diff = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(LSCEV, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.BaseSCEV);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (isValidDiff(Diff)) {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Elements.push_back(BucketElement(Diff, MemI));</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      FoundBucket = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span> (!FoundBucket) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (Buckets.size() == MaxCandidateNum) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Can not prepare more chains, reach maximum limit &quot;</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        &lt;&lt; MaxCandidateNum &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    Buckets.push_back(Bucket(LSCEV, MemI));</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> PPCLoopInstrFormPrep::collectCandidates(</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, <a class="code" href="classllvm_1_1Value.html">Value</a> *, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *)&gt;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        isValidCandidate,</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *)&gt; isValidDiff, <span class="keywordtype">unsigned</span> MaxCandidateNum) {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> Buckets;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>())</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;J : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrValue = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *PointerElementType = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      PtrValue = <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a>(&amp;J, &amp;PointerElementType);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">if</span> (!PtrValue)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">if</span> (PtrValue-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>())</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(PtrValue))</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *LSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(PtrValue, L);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *LARSCEV = dyn_cast&lt;SCEVAddRecExpr&gt;(LSCEV);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">if</span> (!LARSCEV || LARSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != L)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="comment">// Mark that we have candidates for preparing.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      HasCandidateForPrepare = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="keywordflow">if</span> (isValidCandidate(&amp;J, PtrValue, PointerElementType))</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        addOneCandidate(&amp;J, LSCEV, Buckets, isValidDiff, MaxCandidateNum);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordflow">return</span> Buckets;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;}</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::prepareBaseForDispFormChain(Bucket &amp;BucketChain,</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                                       PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">// RemainderOffsetInfo details:</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// key:            value of (Offset urem DispConstraint). For DSForm, it can</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="comment">//                 be [0, 4).</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// first of pair:  the index of first BucketElement whose remainder is equal</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">//                 to key. For key 0, this value must be 0.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">// second of pair: number of load/stores with the same remainder.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, std::pair&lt;unsigned, unsigned&gt;</a>&gt; RemainderOffsetInfo;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0, je = BucketChain.Elements.size(); <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != je; ++<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (!BucketChain.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].Offset)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      RemainderOffsetInfo[0] = std::make_pair(0, 1);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordtype">unsigned</span> Remainder = cast&lt;SCEVConstant&gt;(BucketChain.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].Offset)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                               -&gt;getAPInt()</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                               .urem(<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">if</span> (RemainderOffsetInfo.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Remainder) == RemainderOffsetInfo.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        RemainderOffsetInfo[Remainder] = std::make_pair(<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>, 1);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        RemainderOffsetInfo[Remainder].second++;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="comment">// Currently we choose the most profitable base as the one which has the max</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">// number of load/store with same remainder.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">// FIXME: adjust the base selection strategy according to load/store offset</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">// distribution.</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="comment">// For example, if we have one candidate chain for DS form preparation, which</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">// contains following load/stores with different remainders:</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">// 1: 10 load/store whose remainder is 1;</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">// 2: 9 load/store whose remainder is 2;</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// 3: 1 for remainder 3 and 0 for remainder 0;</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">// Now we will choose the first load/store whose remainder is 1 as base and</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// adjust all other load/stores according to new base, so we will get 10 DS</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// form and 10 X form.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">// But we should be more clever, for this case we could use two bases, one for</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// remainder 1 and the other for remainder 2, thus we could get 19 DS form and</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// 1 X form.</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordtype">unsigned</span> MaxCountRemainder = 0;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &lt; (<a class="code" href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a>)<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>++)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span> ((RemainderOffsetInfo.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) != RemainderOffsetInfo.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) &amp;&amp;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        RemainderOffsetInfo[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].second &gt;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            RemainderOffsetInfo[MaxCountRemainder].second)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      MaxCountRemainder = <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">// Abort when there are too few insts with common base.</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">if</span> (RemainderOffsetInfo[MaxCountRemainder].second &lt; <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a6489c984a1218205ac22c47766b50ca1">DispFormPrepMinThreshold</a>)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">// If the first value is most profitable, no needed to adjust BucketChain</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">// elements as they are substracted the first value when collecting.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordflow">if</span> (MaxCountRemainder == 0)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// Adjust load/store to the new chosen base.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> =</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      BucketChain.Elements[RemainderOffsetInfo[MaxCountRemainder].first].Offset;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  BucketChain.BaseSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(BucketChain.BaseSCEV, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : BucketChain.Elements) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset)</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset = cast&lt;SCEVConstant&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>));</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset = cast&lt;SCEVConstant&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">getNegativeSCEV</a>(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>));</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(BucketChain.Elements[RemainderOffsetInfo[MaxCountRemainder].first],</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            BucketChain.Elements[0]);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">// FIXME: implement a more clever base choosing policy.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">// Currently we always choose an exist load/store offset. This maybe lead to</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">// suboptimal code sequences. For example, for one DS chain with offsets</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">// {-32769, 2003, 2007, 2011}, we choose -32769 as base offset, and left disp</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">// for load/stores are {0, 34772, 34776, 34780}. Though each offset now is a</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">// multipler of 4, it cannot be represented by sint16.</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::prepareBaseForUpdateFormChain(Bucket &amp;BucketChain) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// We have a choice now of which instruction&#39;s memory operand we use as the</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// base for the generated PHI. Always picking the first instruction in each</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// bucket does not work well, specifically because that instruction might</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="comment">// be a prefetch (and there are no pre-increment dcbt variants). Otherwise,</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">// the choice is somewhat arbitrary, because the backend will happily</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">// generate direct offsets from both the pre-incremented and</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">// post-incremented pointer values. Thus, we&#39;ll pick the first non-prefetch</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="comment">// instruction in each bucket, and adjust the recurrence and other offsets</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="comment">// accordingly.</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = 0, je = BucketChain.Elements.size(); <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> != je; ++<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(BucketChain.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].Instr))</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">if</span> (II-&gt;getIntrinsicID() == <a class="code" href="LoopDataPrefetch_8cpp.html#af1aa8156fe6dc9478d31e05cf3c1eb9b">Intrinsic::prefetch</a>)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// If we&#39;d otherwise pick the first element anyway, there&#39;s nothing to do.</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> == 0)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">// If our chosen element has no offset from the base pointer, there&#39;s</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// nothing to do.</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (!BucketChain.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].Offset ||</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        cast&lt;SCEVConstant&gt;(BucketChain.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].Offset)-&gt;isZero())</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = BucketChain.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>].Offset;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    BucketChain.BaseSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(BucketChain.BaseSCEV, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : BucketChain.Elements) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset = cast&lt;SCEVConstant&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>));</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.Offset = cast&lt;SCEVConstant&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">getNegativeSCEV</a>(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>));</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(BucketChain.Elements[<a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>], BucketChain.Elements[0]);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;}</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::rewriteLoadStores(</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, Bucket &amp;BucketChain, <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 16&gt;</a> &amp;BBChanged,</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *BasePtrSCEV =</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      cast&lt;SCEVAddRecExpr&gt;(BucketChain.BaseSCEV);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">if</span> (!BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <a class="code" href="classllvm_1_1SCEVExpander.html">SCEVExpander</a> SCEVE(*SE, Header-&gt;getModule()-&gt;getDataLayout(),</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                     <span class="stringliteral">&quot;loopprepare-formrewrite&quot;</span>);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">if</span> (!SCEVE.<a class="code" href="classllvm_1_1SCEVExpander.html#a3b8edb4179c8a762f5ab29e1dd613c3a">isSafeToExpand</a>(BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>()))</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> DeletedPtrs;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// For some DS form load/store instructions, it can also be an update form,</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// if the stride is constant and is a multipler of 4. Use update form if</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// prefer it.</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordtype">bool</span> CanPreInc = (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == UpdateForm ||</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                    ((<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == DSForm) &amp;&amp;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                     isa&lt;SCEVConstant&gt;(BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(*SE)) &amp;&amp;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                     !cast&lt;SCEVConstant&gt;(BasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(*SE))</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                          -&gt;getAPInt()</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                          .urem(4) &amp;&amp;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                     <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#aef9b4993495f559270a6875cbaeaad4f">PreferUpdateForm</a>));</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  std::pair&lt;Instruction *, Instruction *&gt; <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> =</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      rewriteForBase(L, BasePtrSCEV, BucketChain.Elements.begin()-&gt;Instr,</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                     CanPreInc, <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>, SCEVE, DeletedPtrs);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.first || !<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.second)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="comment">// Keep track of the replacement pointer values we&#39;ve inserted so that we</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// don&#39;t generate more pointer values than necessary.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 16&gt;</a> NewPtrs;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  NewPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.first);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> BucketElement &amp;BE : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a>(BucketChain.Elements)) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a>(BE.Instr);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> &amp;&amp; <span class="stringliteral">&quot;No pointer operand&quot;</span>);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">if</span> (NewPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>))</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewPtr = rewriteForBucketElement(</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        Base, BE,</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        BE.Offset ? cast&lt;SCEVConstant&gt;(BE.Offset)-&gt;getValue() : <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        DeletedPtrs);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewPtr &amp;&amp; <span class="stringliteral">&quot;wrong rewrite!\n&quot;</span>);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    NewPtrs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(NewPtr);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">// Clear the rewriter cache, because values that are in the rewriter&#39;s cache</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// can be deleted below, causing the AssertingVH in the cache to trigger.</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  SCEVE.<a class="code" href="classllvm_1_1SCEVExpander.html#aa9bcc84c7b023d3b1321851509110dae">clear</a>();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> : DeletedPtrs) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IDel = dyn_cast&lt;Instruction&gt;(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>))</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      BBChanged.<a class="code" href="classllvm_1_1SmallSet.html#a1679469af9bb8ccfbe98441fb8228c79">insert</a>(IDel-&gt;getParent());</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="namespacellvm.html#a1106b8a15061e8494873e10bb8a364e5">RecursivelyDeleteTriviallyDeadInstructions</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  SuccPrepCount++;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == DSForm &amp;&amp; !CanPreInc)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    DSFormChainRewritten++;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == DQForm)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    DQFormChainRewritten++;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == UpdateForm || (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == DSForm &amp;&amp; CanPreInc))</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    UpdFormChainRewritten++;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;}</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::updateFormPrep(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                       <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets) {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordflow">if</span> (Buckets.empty())</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 16&gt;</a> BBChanged;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Bucket : Buckets)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// The base address of each bucket is transformed into a phi and the others</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">// are rewritten based on new base.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (prepareBaseForUpdateFormChain(Bucket))</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      MadeChange |= rewriteLoadStores(L, Bucket, BBChanged, UpdateForm);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">if</span> (MadeChange)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : BBChanged)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <a class="code" href="namespacellvm.html#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;}</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::dispFormPrep(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> &amp;Buckets,</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                        PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">if</span> (Buckets.empty())</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <a class="code" href="classllvm_1_1SmallSet.html">SmallSet&lt;BasicBlock *, 16&gt;</a> BBChanged;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Bucket : Buckets) {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (Bucket.Elements.size() &lt; <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a6489c984a1218205ac22c47766b50ca1">DispFormPrepMinThreshold</a>)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">if</span> (prepareBaseForDispFormChain(Bucket, <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>))</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      MadeChange |= rewriteLoadStores(L, Bucket, BBChanged, <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">if</span> (MadeChange)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : BBChanged)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <a class="code" href="namespacellvm.html#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">// Find the loop invariant increment node for SCEV BasePtrIncSCEV.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">// bb.loop.preheader:</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">//   %start = ...</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">// bb.loop.body:</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">//   %phinode = phi [ %start, %bb.loop.preheader ], [ %add, %bb.loop.body ]</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">//   %add = add %phinode, %inc  ; %inc is what we want to get.</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *PPCLoopInstrFormPrep::getNodeForInc(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemI,</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrIncSCEV) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="comment">// If the increment is a constant, no definition is needed.</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="comment">// Return the value directly.</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">if</span> (isa&lt;SCEVConstant&gt;(BasePtrIncSCEV))</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">return</span> cast&lt;SCEVConstant&gt;(BasePtrIncSCEV)-&gt;getValue();</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(BasePtrIncSCEV, L))</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = MemI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LatchBB = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">if</span> (!LatchBB)</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">// Run through the PHIs and check their operands to find valid representation</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="comment">// for the increment SCEV.</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="classllvm_1_1iterator__range.html">iterator_range&lt;BasicBlock::phi_iterator&gt;</a> PHIIter = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;phis();</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;CurrentPHI : PHIIter) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CurrentPHINode = dyn_cast&lt;PHINode&gt;(&amp;CurrentPHI);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">if</span> (!CurrentPHINode)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(CurrentPHINode-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()))</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PHISCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(CurrentPHINode, L);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *PHIBasePtrSCEV = dyn_cast&lt;SCEVAddRecExpr&gt;(PHISCEV);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">if</span> (!PHIBasePtrSCEV)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PHIBasePtrIncSCEV = PHIBasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(*SE);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span> (!PHIBasePtrIncSCEV || (PHIBasePtrIncSCEV != BasePtrIncSCEV))</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// Get the incoming value from the loop latch and check if the value has</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// the add form with the required increment.</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            CurrentPHINode-&gt;<a class="code" href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">getIncomingValueForBlock</a>(LatchBB))) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StrippedBaseI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *BC = dyn_cast&lt;BitCastInst&gt;(StrippedBaseI))</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        StrippedBaseI = BC-&gt;getOperand(0);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *StrippedI = dyn_cast&lt;Instruction&gt;(StrippedBaseI);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">if</span> (!StrippedI)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="comment">// LSR pass may add a getelementptr instruction to do the loop increment,</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="comment">// also search in that getelementptr instruction.</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="keywordflow">if</span> (StrippedI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">Instruction::Add</a> ||</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;          (StrippedI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::GetElementPtr &amp;&amp;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;           StrippedI-&gt;<a class="code" href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">getNumOperands</a>() == 2)) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(StrippedI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0), L) == BasePtrIncSCEV)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          <span class="keywordflow">return</span> StrippedI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">if</span> (SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(StrippedI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), L) == BasePtrIncSCEV)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;          <span class="keywordflow">return</span> StrippedI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">// In order to prepare for the preferred instruction form, a PHI is added.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">// This function will check to see if that PHI already exists and will return</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">// true if it found an existing PHI with the matched start and increment as the</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">// one we wanted to create.</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::alreadyPrepared(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemI,</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrStartSCEV,</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *BasePtrIncSCEV,</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                           PrepForm <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = MemI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PredBB = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a88575baf2ad9f4cd2e2432e6da4a976b">getLoopPredecessor</a>();</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LatchBB = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">if</span> (!PredBB || !LatchBB)</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="comment">// Run through the PHIs and see if we have some that looks like a preparation</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <a class="code" href="classllvm_1_1iterator__range.html">iterator_range&lt;BasicBlock::phi_iterator&gt;</a> PHIIter = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;phis();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; CurrentPHI : PHIIter) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CurrentPHINode = dyn_cast&lt;PHINode&gt;(&amp;CurrentPHI);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">if</span> (!CurrentPHINode)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(CurrentPHINode-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()))</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *PHISCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(CurrentPHINode, L);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *PHIBasePtrSCEV = dyn_cast&lt;SCEVAddRecExpr&gt;(PHISCEV);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">if</span> (!PHIBasePtrSCEV)</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *PHIBasePtrIncSCEV =</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      dyn_cast&lt;SCEVConstant&gt;(PHIBasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(*SE));</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">if</span> (!PHIBasePtrIncSCEV)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (CurrentPHINode-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>() == 2) {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keywordflow">if</span> ((CurrentPHINode-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0) == LatchBB &amp;&amp;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;           CurrentPHINode-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(1) == PredBB) ||</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;          (CurrentPHINode-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(1) == LatchBB &amp;&amp;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;           CurrentPHINode-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0) == PredBB)) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">if</span> (PHIBasePtrIncSCEV == BasePtrIncSCEV) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          <span class="comment">// The existing PHI (CurrentPHINode) has the same start and increment</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;          <span class="comment">// as the PHI that we wanted to create.</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == UpdateForm || <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == ChainCommoning ) &amp;&amp;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;              PHIBasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>() == BasePtrStartSCEV) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            ++PHINodeAlreadyExistsUpdate;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;          }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == DSForm || <a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == DQForm) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *Diff = dyn_cast&lt;SCEVConstant&gt;(</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(PHIBasePtrSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>(), BasePtrStartSCEV));</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keywordflow">if</span> (Diff &amp;&amp; !Diff-&gt;<a class="code" href="classllvm_1_1SCEVConstant.html#a17304ab072a5b259c03e766a2b78a30b">getAPInt</a>().<a class="code" href="classllvm_1_1APInt.html#a4e3a2187cacdec76028617a403c47d89">urem</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a>)) {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">Form</a> == DSForm)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                ++PHINodeAlreadyExistsDS;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                ++PHINodeAlreadyExistsDQ;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;}</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="keywordtype">bool</span> PPCLoopInstrFormPrep::runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="comment">// Only prep. the inner-most loop</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a16165c1e5da45acaa086c3a54a188d34">isInnermost</a>())</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="comment">// Return if already done enough preparation.</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="keywordflow">if</span> (SuccPrepCount &gt;= <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#abd5fa22b0494828fb201bad19ae78e64">MaxVarsPrep</a>)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;PIP: Examining: &quot;</span> &lt;&lt; *L &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopPredecessor = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a88575baf2ad9f4cd2e2432e6da4a976b">getLoopPredecessor</a>();</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">// If there is no loop predecessor, or the loop predecessor&#39;s terminator</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">// returns a value (which might contribute to determining the loop&#39;s</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">// iteration space), insert a new preheader for the loop.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">if</span> (!LoopPredecessor ||</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      !LoopPredecessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">isVoidTy</a>()) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    LoopPredecessor = <a class="code" href="namespacellvm.html#a0ced274818512cfd52e26d828ec1fcf2">InsertPreheaderForLoop</a>(L, DT, LI, <span class="keyword">nullptr</span>, PreserveLCSSA);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">if</span> (LoopPredecessor)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">if</span> (!LoopPredecessor) {</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;PIP fails since no predecessor for current loop.\n&quot;</span>);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="comment">// Check if a load/store has update form. This lambda is used by function</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="comment">// collectCandidates which can collect candidates for types defined by lambda.</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keyword">auto</span> isUpdateFormCandidate = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrValue,</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *PointerElementType) {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((PtrValue &amp;&amp; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <span class="stringliteral">&quot;Invalid parameter!&quot;</span>);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">// There are no update forms for Altivec vector load/stores.</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> &amp;&amp; <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>-&gt;hasAltivec() &amp;&amp; PointerElementType-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>())</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">// There are no update forms for P10 lxvp/stxvp intrinsic.</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordflow">if</span> (II &amp;&amp; ((II-&gt;getIntrinsicID() == Intrinsic::ppc_vsx_lxvp) ||</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;               II-&gt;getIntrinsicID() == Intrinsic::ppc_vsx_stxvp))</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// See getPreIndexedAddressParts, the displacement for LDU/STDU has to</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">// be 4&#39;s multiple (DS-form). For i64 loads/stores when the displacement</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="comment">// fits in a 16-bit signed field but isn&#39;t a multiple of 4, it will be</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">// useless and possible to break some original well-form addressing mode</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">// to make this pre-inc prep for it.</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span> (PointerElementType-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(64)) {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *LSCEV = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1Value.html">Value</a> *<span class="keyword">&gt;</span>(PtrValue), L);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *LARSCEV = dyn_cast&lt;SCEVAddRecExpr&gt;(LSCEV);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <span class="keywordflow">if</span> (!LARSCEV || LARSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() != L)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVConstant.html">SCEVConstant</a> *StepConst =</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;              dyn_cast&lt;SCEVConstant&gt;(LARSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(*SE))) {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;ConstInt = StepConst-&gt;getValue()-&gt;getValue();</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keywordflow">if</span> (ConstInt.<a class="code" href="classllvm_1_1APInt.html#a87d50d10274efe9688166584391ae489">isSignedIntN</a>(16) &amp;&amp; ConstInt.<a class="code" href="classllvm_1_1APInt.html#ac131d830427393332e440e1d6e3013b6">srem</a>(4) != 0)</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    }</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  };</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">// Check if a load/store has DS form.</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="keyword">auto</span> isDSFormCandidate = [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrValue,</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *PointerElementType) {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((PtrValue &amp;&amp; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <span class="stringliteral">&quot;Invalid parameter!&quot;</span>);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">if</span> (isa&lt;IntrinsicInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordflow">return</span> (PointerElementType-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(64)) ||</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;           (PointerElementType-&gt;<a class="code" href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">isFloatTy</a>()) ||</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;           (PointerElementType-&gt;<a class="code" href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">isDoubleTy</a>()) ||</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;           (PointerElementType-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(32) &amp;&amp;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users(),</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                         [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1User.html">User</a> *U) { return isa&lt;SExtInst&gt;(U); }));</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  };</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="comment">// Check if a load/store has DQ form.</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keyword">auto</span> isDQFormCandidate = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrValue,</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *PointerElementType) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((PtrValue &amp;&amp; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <span class="stringliteral">&quot;Invalid parameter!&quot;</span>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">// Check if it is a P10 lxvp/stxvp intrinsic.</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span> (II)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordflow">return</span> II-&gt;getIntrinsicID() == Intrinsic::ppc_vsx_lxvp ||</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;             II-&gt;getIntrinsicID() == Intrinsic::ppc_vsx_stxvp;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="comment">// Check if it is a P9 vector load/store.</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> &amp;&amp; <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>-&gt;hasP9Vector() &amp;&amp; (PointerElementType-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>());</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  };</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="comment">// Check if a load/store is candidate for chain commoning.</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">// If the SCEV is only with one ptr operand in its start, we can use that</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="comment">// start as a chain separator. Mark this load/store as a candidate.</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keyword">auto</span> isChainCommoningCandidate = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrValue,</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *PointerElementType) {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *ARSCEV =</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        cast&lt;SCEVAddRecExpr&gt;(SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(PtrValue, L));</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span> (!ARSCEV)</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">if</span> (!ARSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Start = ARSCEV-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>();</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">// A single pointer. We can treat it as offset 0.</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SCEVUnknown&gt;(Start) &amp;&amp; Start-&gt;getType()-&gt;isPointerTy())</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddExpr.html">SCEVAddExpr</a> *ASCEV = dyn_cast&lt;SCEVAddExpr&gt;(Start);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">// We need a SCEVAddExpr to include both base and offset.</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span> (!ASCEV)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">// Make sure there is only one pointer operand(base) and all other operands</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">// are integer type.</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordtype">bool</span> SawPointer = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : ASCEV-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a980d0688dfa2b96b0043950aa1aa88b3">operands</a>()) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()-&gt;isPointerTy()) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="keywordflow">if</span> (SawPointer)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        SawPointer = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()-&gt;isIntegerTy())</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">return</span> SawPointer;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  };</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="comment">// Check if the diff is a constant type. This is used for update/DS/DQ form</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="comment">// preparation.</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keyword">auto</span> isValidConstantDiff = [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Diff) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">return</span> dyn_cast&lt;SCEVConstant&gt;(Diff) != <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  };</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="comment">// Make sure the diff between the base and new candidate is required type.</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="comment">// This is used for chain commoning preparation.</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <span class="keyword">auto</span> isValidChainCommoningDiff = [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *Diff) {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Diff &amp;&amp; <span class="stringliteral">&quot;Invalid Diff!\n&quot;</span>);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">// Don&#39;t mess up previous dform prepare.</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SCEVConstant&gt;(Diff))</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="comment">// A single integer type offset.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SCEVUnknown&gt;(Diff) &amp;&amp; Diff-&gt;<a class="code" href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVNAryExpr.html">SCEVNAryExpr</a> *ADiff = dyn_cast&lt;SCEVNAryExpr&gt;(Diff);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">if</span> (!ADiff)</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : ADiff-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a980d0688dfa2b96b0043950aa1aa88b3">operands</a>())</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()-&gt;isIntegerTy())</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  };</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  HasCandidateForPrepare = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Start to prepare for update form.\n&quot;</span>);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="comment">// Collect buckets of comparable addresses used by loads and stores for update</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="comment">// form.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> UpdateFormBuckets = collectCandidates(</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      L, isUpdateFormCandidate, isValidConstantDiff, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a4b3dd3f72c269fc5371497e36525651c">MaxVarsUpdateForm</a>);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="comment">// Prepare for update form.</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordflow">if</span> (!UpdateFormBuckets.empty())</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    MadeChange |= updateFormPrep(L, UpdateFormBuckets);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!HasCandidateForPrepare) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;No prepare candidates found, stop praparation for current loop!\n&quot;</span>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// If no candidate for preparing, return early.</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Start to prepare for DS form.\n&quot;</span>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="comment">// Collect buckets of comparable addresses used by loads and stores for DS</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="comment">// form.</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> DSFormBuckets = collectCandidates(</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      L, isDSFormCandidate, isValidConstantDiff, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a3ee9baedeb296a9b779b9363b547ad40">MaxVarsDSForm</a>);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="comment">// Prepare for DS form.</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">if</span> (!DSFormBuckets.empty())</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    MadeChange |= dispFormPrep(L, DSFormBuckets, DSForm);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Start to prepare for DQ form.\n&quot;</span>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="comment">// Collect buckets of comparable addresses used by loads and stores for DQ</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="comment">// form.</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> DQFormBuckets = collectCandidates(</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      L, isDQFormCandidate, isValidConstantDiff, <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a09750fd32fa96b7750d45c244a995126">MaxVarsDQForm</a>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">// Prepare for DQ form.</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordflow">if</span> (!DQFormBuckets.empty())</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    MadeChange |= dispFormPrep(L, DQFormBuckets, DQForm);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="comment">// Collect buckets of comparable addresses used by loads and stores for chain</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="comment">// commoning. With chain commoning, we reuse offsets between the chains, so</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="comment">// the register pressure will be reduced.</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="PPCLoopInstrFormPrep_8cpp.html#abb7196e5faec17e673251a5bb83ec9ca">EnableChainCommoning</a>) {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Chain commoning is not enabled.\n&quot;</span>);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Start to prepare for chain commoning.\n&quot;</span>);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Bucket, 16&gt;</a> Buckets =</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      collectCandidates(L, isChainCommoningCandidate, isValidChainCommoningDiff,</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                        <a class="code" href="PPCLoopInstrFormPrep_8cpp.html#a37f81249266813ec70ebf6f12922975d">MaxVarsChainCommon</a>);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// Prepare for chain commoning.</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="keywordflow">if</span> (!Buckets.empty())</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    MadeChange |= chainCommoning(L, Buckets);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1106b8a15061e8494873e10bb8a364e5"><div class="ttname"><a href="namespacellvm.html#a1106b8a15061e8494873e10bb8a364e5">llvm::RecursivelyDeleteTriviallyDeadInstructions</a></div><div class="ttdeci">bool RecursivelyDeleteTriviallyDeadInstructions(Value *V, const TargetLibraryInfo *TLI=nullptr, MemorySSAUpdater *MSSAU=nullptr, std::function&lt; void(Value *)&gt; AboutToDeleteCallback=std::function&lt; void(Value *)&gt;())</div><div class="ttdoc">If the specified value is a trivially dead instruction, delete it.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00537">Local.cpp:537</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a837e9f272fd070a5f8fc79c07a951106"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a837e9f272fd070a5f8fc79c07a951106">llvm::GetElementPtrInst::setIsInBounds</a></div><div class="ttdeci">void setIsInBounds(bool b=true)</div><div class="ttdoc">Set or clear the inbounds flag on this GEP instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01938">Instructions.cpp:1938</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a37f81249266813ec70ebf6f12922975d"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a37f81249266813ec70ebf6f12922975d">MaxVarsChainCommon</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxVarsChainCommon(&quot;ppc-chaincommon-max-vars&quot;, cl::Hidden, cl::init(4), cl::desc(&quot;Bucket number per loop for PPC loop chain common&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a6cb6a58fb0ded82b4c7755fc4c27c86d"><div class="ttname"><a href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">llvm::Loop::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const Value *V) const</div><div class="ttdoc">Return true if the specified value is loop invariant.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00060">LoopInfo.cpp:60</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a083bb1deb1d2ba244a99ceae9e734bc1"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a083bb1deb1d2ba244a99ceae9e734bc1">llvm::ScalarEvolution::getNegativeSCEV</a></div><div class="ttdeci">const SCEV * getNegativeSCEV(const SCEV *V, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap)</div><div class="ttdoc">Return the SCEV object corresponding to -V.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04556">ScalarEvolution.cpp:4556</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a45c91183fa3018e4aa1db711feec00c3"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a45c91183fa3018e4aa1db711feec00c3">GEPNodeIncNameSuffix</a></div><div class="ttdeci">static constexpr StringRef GEPNodeIncNameSuffix</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00349">PPCLoopInstrFormPrep.cpp:349</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_html_a02981de53fb6ffd384d39addc4d25f37"><div class="ttname"><a href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a></div><div class="ttdeci">auto drop_begin(T &amp;&amp;RangeOrContainer, size_t N=1)</div><div class="ttdoc">Return a range covering RangeOrContainer with the first N elements excluded.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00386">STLExtras.h:386</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7fe9ccd4893f4e2caa826126c09545ea"><div class="ttname"><a href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">llvm::Type::getInt8PtrTy</a></div><div class="ttdeci">static PointerType * getInt8PtrTy(LLVMContext &amp;C, unsigned AS=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00293">Type.cpp:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a54bb7394d874cbbef1d81e6bea89d4f3"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">llvm::SCEVAddRecExpr::isAffine</a></div><div class="ttdeci">bool isAffine() const</div><div class="ttdoc">Return true if this represents an expression A + B*x where A and B are loop invariant values.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00358">ScalarEvolutionExpressions.h:358</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aScalarEvolutionExpander_8h_html"><div class="ttname"><a href="ScalarEvolutionExpander_8h.html">ScalarEvolutionExpander.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a87d50d10274efe9688166584391ae489"><div class="ttname"><a href="classllvm_1_1APInt.html#a87d50d10274efe9688166584391ae489">llvm::APInt::isSignedIntN</a></div><div class="ttdeci">bool isSignedIntN(unsigned N) const</div><div class="ttdoc">Check if this APInt has an N-bits signed integer value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00427">APInt.h:427</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a09750fd32fa96b7750d45c244a995126"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a09750fd32fa96b7750d45c244a995126">MaxVarsDQForm</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxVarsDQForm(&quot;ppc-dqprep-max-vars&quot;, cl::Hidden, cl::init(8), cl::desc(&quot;Potential PHI threshold per loop for PPC loop prep of DQ form&quot;))</div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a1d3a0e869e478018c481a577ed9d25ee"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">llvm::SCEVAddRecExpr::getStart</a></div><div class="ttdeci">const SCEV * getStart() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00341">ScalarEvolutionExpressions.h:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVExpander_html"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html">llvm::SCEVExpander</a></div><div class="ttdoc">This class uses information about analyze scalars to rewrite expressions in canonical form.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00050">ScalarEvolutionExpander.h:50</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_af825625d346ed84be24c4d52b8c46f40"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#af825625d346ed84be24c4d52b8c46f40">CastNodeNameSuffix</a></div><div class="ttdeci">static constexpr StringRef CastNodeNameSuffix</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00348">PPCLoopInstrFormPrep.cpp:348</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05258">Instructions.h:5258</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a88575baf2ad9f4cd2e2432e6da4a976b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a88575baf2ad9f4cd2e2432e6da4a976b">llvm::LoopBase::getLoopPredecessor</a></div><div class="ttdeci">BlockT * getLoopPredecessor() const</div><div class="ttdoc">If the given loop's header has exactly one unique predecessor outside the loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00211">LoopInfoImpl.h:211</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a6c06a10ffac779879f6b62a1a904517b"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a6c06a10ffac779879f6b62a1a904517b">llvm::dwarf::Form</a></div><div class="ttdeci">Form</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00130">Dwarf.h:130</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdoc">The main scalar evolution driver.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00452">ScalarEvolution.h:452</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1c5781563265f0f6f21b8cdcbd638639"><div class="ttname"><a href="namespacellvm.html#a1c5781563265f0f6f21b8cdcbd638639">llvm::createPPCLoopInstrFormPrepPass</a></div><div class="ttdeci">FunctionPass * createPPCLoopInstrFormPrepPass(PPCTargetMachine &amp;TM)</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00352">PPCLoopInstrFormPrep.cpp:352</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVExpander_html_a7c9143ef971c8a2f094afaf228c9e648"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#a7c9143ef971c8a2f094afaf228c9e648">llvm::SCEVExpander::expandCodeFor</a></div><div class="ttdeci">Value * expandCodeFor(const SCEV *SH, Type *Ty, Instruction *I)</div><div class="ttdoc">Insert code to directly compute the specified SCEV expression into the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00279">ScalarEvolutionExpander.h:279</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aScalarEvolution_8h_html"><div class="ttname"><a href="ScalarEvolution_8h.html">ScalarEvolution.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a48cd93139ab5e46d6899f61bc58af843"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a48cd93139ab5e46d6899f61bc58af843">getPointerOperandAndType</a></div><div class="ttdeci">static Value * getPointerOperandAndType(Value *MemI, Type **PtrElementType=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00374">PPCLoopInstrFormPrep.cpp:374</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1LoopInfoWrapperPass.html">llvm::LoopInfoWrapperPass</a></div><div class="ttdoc">The legacy pass manager's analysis pass to compute loop information.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01293">LoopInfo.h:1293</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSet_html"><div class="ttname"><a href="classllvm_1_1SmallSet.html">llvm::SmallSet</a></div><div class="ttdoc">SmallSet - This maintains a set of unique values, optimizing for the case when the set is small (less...</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00135">SmallSet.h:135</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a7f229d5ad3269446f6de883c610bdad9"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a7f229d5ad3269446f6de883c610bdad9">PHINodeNameSuffix</a></div><div class="ttdeci">static constexpr StringRef PHINodeNameSuffix</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00347">PPCLoopInstrFormPrep.cpp:347</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt; Value *, 16 &gt;</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_abb7196e5faec17e673251a5bb83ec9ca"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#abb7196e5faec17e673251a5bb83ec9ca">EnableChainCommoning</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableChainCommoning(&quot;ppc-formprep-chain-commoning&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Enable chain commoning in PPC loop prepare pass.&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1SCEVNAryExpr_html_a980d0688dfa2b96b0043950aa1aa88b3"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html#a980d0688dfa2b96b0043950aa1aa88b3">llvm::SCEVNAryExpr::operands</a></div><div class="ttdeci">ArrayRef&lt; const SCEV * &gt; operands() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00201">ScalarEvolutionExpressions.h:201</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7ba5de75f50bb4a4ba920698edf39b28"><div class="ttname"><a href="classllvm_1_1Type.html#a7ba5de75f50bb4a4ba920698edf39b28">llvm::Type::getInt8Ty</a></div><div class="ttdeci">static IntegerType * getInt8Ty(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00239">Type.cpp:239</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="anamespacellvm_html_adc9b8c53e964842915e0ef5373b38827"><div class="ttname"><a href="namespacellvm.html#adc9b8c53e964842915e0ef5373b38827">llvm::initializePPCLoopInstrFormPrepPass</a></div><div class="ttdeci">void initializePPCLoopInstrFormPrepPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aDepthFirstIterator_8h_html"><div class="ttname"><a href="DepthFirstIterator_8h.html">DepthFirstIterator.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aPPCSubtarget_8h_html"><div class="ttname"><a href="PPCSubtarget_8h.html">PPCSubtarget.h</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac4fc845f5ed92de63cd4474f128f5fc5"><div class="ttname"><a href="namespacellvm.html#ac4fc845f5ed92de63cd4474f128f5fc5">llvm::cast</a></div><div class="ttdeci">decltype(auto) cast(const From &amp;Val)</div><div class="ttdoc">cast&lt;X&gt; - Return the argument parameter cast to the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00566">Casting.h:566</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_af09e4096de244d2fb345891328714a63"><div class="ttname"><a href="classllvm_1_1Instruction.html#af09e4096de244d2fb345891328714a63">llvm::Instruction::insertAfter</a></div><div class="ttdeci">void insertAfter(Instruction *InsertPos)</div><div class="ttdoc">Insert an unlinked instruction into a basic block immediately after the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00094">Instruction.cpp:94</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4e05d690df389b8b1477c90387b575f"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns a member of one of the enums like Instruction::Add.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00168">Instruction.h:168</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_ade4b0ceb355799ae96ec6adb03a67026"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#ade4b0ceb355799ae96ec6adb03a67026">EnableUpdateFormForNonConstInc</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableUpdateFormForNonConstInc(&quot;ppc-formprep-update-nonconst-inc&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;prepare update form when the load/store increment is a loop &quot; &quot;invariant non-const value.&quot;))</div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_abd5fa22b0494828fb201bad19ae78e64"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#abd5fa22b0494828fb201bad19ae78e64">MaxVarsPrep</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxVarsPrep(&quot;ppc-formprep-max-vars&quot;, cl::Hidden, cl::init(24), cl::desc(&quot;Potential common base number threshold per function &quot; &quot;for PPC loop prep&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1PPCSubtarget_html"><div class="ttname"><a href="classllvm_1_1PPCSubtarget.html">llvm::PPCSubtarget</a></div><div class="ttdef"><b>Definition:</b> <a href="PPCSubtarget_8h_source.html#l00071">PPCSubtarget.h:71</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a3ee9baedeb296a9b779b9363b547ad40"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a3ee9baedeb296a9b779b9363b547ad40">MaxVarsDSForm</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxVarsDSForm(&quot;ppc-dsprep-max-vars&quot;, cl::Hidden, cl::init(3), cl::desc(&quot;Potential PHI threshold per loop for PPC loop prep of DS form&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">static const char * name</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00341">PPCLoopInstrFormPrep.cpp:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a40f34cc77d2b3bc73384f535c8101858"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">llvm::LoopBase::blocks</a></div><div class="ttdeci">iterator_range&lt; block_iterator &gt; blocks() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00195">LoopInfo.h:195</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a1bc022868b23918efa44df511f4d5b61"><div class="ttname"><a href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const</div><div class="ttdoc">True if this is an instance of VectorType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00258">Type.h:258</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00245">BasicBlock.cpp:245</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00141">StackSlotColoring.cpp:141</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_adfb61ffe25c950c75c86310245b3ef39"><div class="ttname"><a href="classllvm_1_1PHINode.html#adfb61ffe25c950c75c86310245b3ef39">llvm::PHINode::getIncomingValueForBlock</a></div><div class="ttdeci">Value * getIncomingValueForBlock(const BasicBlock *BB) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02889">Instructions.h:2889</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a4b3dd3f72c269fc5371497e36525651c"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a4b3dd3f72c269fc5371497e36525651c">MaxVarsUpdateForm</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxVarsUpdateForm(&quot;ppc-preinc-prep-max-vars&quot;, cl::Hidden, cl::init(3), cl::desc(&quot;Potential PHI threshold per loop for PPC loop prep of update &quot; &quot;form&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeWrapperPass_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeWrapperPass.html">llvm::DominatorTreeWrapperPass</a></div><div class="ttdoc">Legacy analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00314">Dominators.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aPPC_8h_html"><div class="ttname"><a href="PPC_8h.html">PPC.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d"><div class="ttname"><a href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">llvm::codeview::EncodedFramePtrReg::BasePtr</a></div><div class="ttdeci">@ BasePtr</div></div>
<div class="ttc" id="aLoopUtils_8h_html"><div class="ttname"><a href="LoopUtils_8h.html">LoopUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolutionWrapperPass_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolutionWrapperPass.html">llvm::ScalarEvolutionWrapperPass</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l02249">ScalarEvolution.h:2249</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVNAryExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html">llvm::SCEVNAryExpr</a></div><div class="ttdoc">This node is a base class providing common functionality for n'ary operators.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00179">ScalarEvolutionExpressions.h:179</a></div></div>
<div class="ttc" id="aTransforms_2Utils_8h_html"><div class="ttname"><a href="Transforms_2Utils_8h.html">Utils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_aef51af4b490af6b3bf2dfbc8737a8f9f"><div class="ttname"><a href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const</div><div class="ttdoc">Return the number of incoming edges.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02790">Instructions.h:2790</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_ae380dba17971969fa47dbf027684048e"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#ae380dba17971969fa47dbf027684048e">ChainCommonPrepMinThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ChainCommonPrepMinThreshold(&quot;ppc-chaincommon-min-threshold&quot;, cl::Hidden, cl::init(4), cl::desc(&quot;Minimal common base load/store instructions triggering chain &quot; &quot;commoning preparation. Must be not smaller than 4&quot;))</div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_ac131d830427393332e440e1d6e3013b6"><div class="ttname"><a href="classllvm_1_1APInt.html#ac131d830427393332e440e1d6e3013b6">llvm::APInt::srem</a></div><div class="ttdeci">APInt srem(const APInt &amp;RHS) const</div><div class="ttdoc">Function for signed remainder operation.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l01734">APInt.cpp:1734</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00059">PassSupport.h:59</a></div></div>
<div class="ttc" id="aIR_2CFG_8h_html"><div class="ttname"><a href="IR_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0ced274818512cfd52e26d828ec1fcf2"><div class="ttname"><a href="namespacellvm.html#a0ced274818512cfd52e26d828ec1fcf2">llvm::InsertPreheaderForLoop</a></div><div class="ttdeci">BasicBlock * InsertPreheaderForLoop(Loop *L, DominatorTree *DT, LoopInfo *LI, MemorySSAUpdater *MSSAU, bool PreserveLCSSA)</div><div class="ttdoc">InsertPreheaderForLoop - Once we discover that a loop doesn't have a preheader, this method is called...</div><div class="ttdef"><b>Definition:</b> <a href="LoopSimplify_8cpp_source.html#l00118">LoopSimplify.cpp:118</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a6489c984a1218205ac22c47766b50ca1"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a6489c984a1218205ac22c47766b50ca1">DispFormPrepMinThreshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; DispFormPrepMinThreshold(&quot;ppc-dispprep-min-threshold&quot;, cl::Hidden, cl::init(2), cl::desc(&quot;Minimal common base load/store instructions triggering DS/DQ form &quot; &quot;preparation&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdoc">This class represents an analyzed expression in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00075">ScalarEvolution.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">llvm::RISCVFenceField::O</a></div><div class="ttdeci">@ O</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00277">RISCVBaseInfo.h:277</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_aa10ee7493bddf2c751ca6e05451ef410"><div class="ttname"><a href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ad2f7724072b5d664bca622e53494c853"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ad2f7724072b5d664bca622e53494c853">inc</a></div><div class="ttdeci">Current eax eax eax ret Ideal eax eax ret Re implement atomic builtins x86 does not have to use add to implement these it can use inc</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l01367">README.txt:1367</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__MB_html_ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2"><div class="ttname"><a href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">llvm::ARM_MB::ST</a></div><div class="ttdeci">@ ST</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00073">ARMBaseInfo.h:73</a></div></div>
<div class="ttc" id="aSVEIntrinsicOpts_8cpp_html_a2bb87eb1bcbc74783a83ae945eb8fa36"><div class="ttname"><a href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(DominatorTreeWrapperPass)</div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a8d87e69e124542d3338b631934cdbea9aaa56a2e65d8106aef3c61e4f6bf94fdb"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a8d87e69e124542d3338b631934cdbea9aaa56a2e65d8106aef3c61e4f6bf94fdb">llvm::logicalview::LVPrintKind::Elements</a></div><div class="ttdeci">@ Elements</div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdoc">an instruction for type-safe pointer arithmetic to access elements of arrays and structs</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00940">Instructions.h:940</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVConstant_html"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html">llvm::SCEVConstant</a></div><div class="ttdoc">This class represents a constant integer value.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00060">ScalarEvolutionExpressions.h:60</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a225729c72185b480053c04b7f0395c64"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a225729c72185b480053c04b7f0395c64">GEPNodeOffNameSuffix</a></div><div class="ttdeci">static constexpr StringRef GEPNodeOffNameSuffix</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00350">PPCLoopInstrFormPrep.cpp:350</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a1230fd674d2609b96527fe65eaf40b1b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const</div><div class="ttdoc">If there is a single latch block for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00232">LoopInfoImpl.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVExpander_html_a3b8edb4179c8a762f5ab29e1dd613c3a"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#a3b8edb4179c8a762f5ab29e1dd613c3a">llvm::SCEVExpander::isSafeToExpand</a></div><div class="ttdeci">bool isSafeToExpand(const SCEV *S) const</div><div class="ttdoc">Return true if the given expression is safe to expand in the sense that all materialized values are s...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8cpp_source.html#l02621">ScalarEvolutionExpander.cpp:2621</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ae8eaa0b4eeac52a2b2282cb1bfd981ae"><div class="ttname"><a href="classllvm_1_1Type.html#ae8eaa0b4eeac52a2b2282cb1bfd981ae">llvm::Type::isVoidTy</a></div><div class="ttdeci">bool isVoidTy() const</div><div class="ttdoc">Return true if this is 'void'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00140">Type.h:140</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVExpander_html_aa9bcc84c7b023d3b1321851509110dae"><div class="ttname"><a href="classllvm_1_1SCEVExpander.html#aa9bcc84c7b023d3b1321851509110dae">llvm::SCEVExpander::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Erase the contents of the InsertedExpressions map so that users trying to expand the same expression ...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpander_8h_source.html#l00186">ScalarEvolutionExpander.h:186</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a4e3a2187cacdec76028617a403c47d89"><div class="ttname"><a href="classllvm_1_1APInt.html#a4e3a2187cacdec76028617a403c47d89">llvm::APInt::urem</a></div><div class="ttdeci">APInt urem(const APInt &amp;RHS) const</div><div class="ttdoc">Unsigned remainder operation.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l01664">APInt.cpp:1664</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_a7afc4fa207310b75cb942515f12bd7f3"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#a7afc4fa207310b75cb942515f12bd7f3">getInstrName</a></div><div class="ttdeci">static std::string getInstrName(const Value *I, StringRef Suffix)</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00366">PPCLoopInstrFormPrep.cpp:366</a></div></div>
<div class="ttc" id="aLoopDataPrefetch_8cpp_html_af1aa8156fe6dc9478d31e05cf3c1eb9b"><div class="ttname"><a href="LoopDataPrefetch_8cpp.html#af1aa8156fe6dc9478d31e05cf3c1eb9b">prefetch</a></div><div class="ttdeci">loop data prefetch</div><div class="ttdef"><b>Definition:</b> <a href="LoopDataPrefetch_8cpp_source.html#l00149">LoopDataPrefetch.cpp:149</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a74c47d18ecd4ca3399785e6ae07134dc"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">llvm::GetElementPtrInst::Create</a></div><div class="ttdeci">static GetElementPtrInst * Create(Type *PointeeType, Value *Ptr, ArrayRef&lt; Value * &gt; IdxList, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00966">Instructions.h:966</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">llvm::Offset</a></div><div class="ttdeci">@ Offset</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00115">PPCLoopInstrFormPrep.cpp:115</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdoc">Add the specified Pass class to the set of analyses preserved by this pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00098">PassAnalysisSupport.h:98</a></div></div>
<div class="ttc" id="aBasicAliasAnalysis_8cpp_html_a2675de1d8479c7b00387979714da43f7"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#a2675de1d8479c7b00387979714da43f7">getParent</a></div><div class="ttdeci">static const Function * getParent(const Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l00806">BasicAliasAnalysis.cpp:806</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_aef9b4993495f559270a6875cbaeaad4f"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#aef9b4993495f559270a6875cbaeaad4f">PreferUpdateForm</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; PreferUpdateForm(&quot;ppc-formprep-prefer-update&quot;, cl::init(true), cl::Hidden, cl::desc(&quot;prefer update form when ds form is also a update form&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a5a19768af81df7e5fe571bc08dcd48b3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">llvm::ScalarEvolution::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const SCEV *S, const Loop *L)</div><div class="ttdoc">Return true if the value of the given SCEV is unchanging in the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l13775">ScalarEvolution.cpp:13775</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_aa286a0f7f5d38488d593bb7ef0ba183e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">llvm::BasicBlock::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">Get the context in which this basic block lives.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00035">BasicBlock.cpp:35</a></div></div>
<div class="ttc" id="anamespacellvm_html_add49d9f7abebe402adf1a57c762abeef"><div class="ttname"><a href="namespacellvm.html#add49d9f7abebe402adf1a57c762abeef">llvm::depth_first</a></div><div class="ttdeci">iterator_range&lt; df_iterator&lt; T &gt; &gt; depth_first(const T &amp;G)</div><div class="ttdef"><b>Definition:</b> <a href="DepthFirstIterator_8h_source.html#l00229">DepthFirstIterator.h:229</a></div></div>
<div class="ttc" id="aEntryExitInstrumenter_8cpp_html_a3985f1f39349428d17f0d2b81ebc6349"><div class="ttname"><a href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a></div><div class="ttdeci">static bool runOnFunction(Function &amp;F, bool PostInlining)</div><div class="ttdef"><b>Definition:</b> <a href="EntryExitInstrumenter_8cpp_source.html#l00085">EntryExitInstrumenter.cpp:85</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a3a76669632041022e6976766a22bd2b0"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a></div><div class="ttdeci">return j(j&lt;&lt; 16)</div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a16165c1e5da45acaa086c3a54a188d34"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a16165c1e5da45acaa086c3a54a188d34">llvm::LoopBase::isInnermost</a></div><div class="ttdeci">bool isInnermost() const</div><div class="ttdoc">Return true if the loop does not contain any (natural) loops.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00182">LoopInfo.h:182</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3e3d3c6d4e33a4f5ca579ee7939f0349"><div class="ttname"><a href="namespacellvm.html#a3e3d3c6d4e33a4f5ca579ee7939f0349">llvm::LCSSAID</a></div><div class="ttdeci">char &amp; LCSSAID</div><div class="ttdef"><b>Definition:</b> <a href="LCSSA_8cpp_source.html#l00492">LCSSA.cpp:492</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_af6314c51a3cc5a619beb697246177bf0"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">llvm::SCEVAddRecExpr::getLoop</a></div><div class="ttdeci">const Loop * getLoop() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00342">ScalarEvolutionExpressions.h:342</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a8bcb86d8d126d95b0dc05f09e8f3df96"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a8bcb86d8d126d95b0dc05f09e8f3df96">llvm::ScalarEvolution::getMinusSCEV</a></div><div class="ttdeci">const SCEV * getMinusSCEV(const SCEV *LHS, const SCEV *RHS, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Return LHS-RHS.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04642">ScalarEvolution.cpp:4642</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3ffc75c3a4cb82ba307a3334483eb4ac"><div class="ttname"><a href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">llvm::Type::isFloatTy</a></div><div class="ttdeci">bool isFloatTy() const</div><div class="ttdoc">Return true if this is 'float', a 32-bit IEEE fp type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00154">Type.h:154</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ab0ff669b12c20c07137705c38872ec63"><div class="ttname"><a href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02750">Instructions.h:2750</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html">llvm::SCEVAddRecExpr</a></div><div class="ttdoc">This node represents a polynomial recurrence on the trip count of the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00330">ScalarEvolutionExpressions.h:330</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6d8769a72303e2b06ef63129cb231855"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">llvm::ScalarEvolution::isSCEVable</a></div><div class="ttdeci">bool isSCEVable(Type *Ty) const</div><div class="ttdoc">Test if values of the given type are analyzable within the SCEV framework.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04420">ScalarEvolution.cpp:4420</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_aa0fd6bf3d33236279db7b707bba755f4"><div class="ttname"><a href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">llvm::Type::isDoubleTy</a></div><div class="ttdeci">bool isDoubleTy() const</div><div class="ttdoc">Return true if this is 'double', a 64-bit IEEE fp type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00157">Type.h:157</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a2b016c207343046b2bac45e69e76dcec">llvm::MCID::Add</a></div><div class="ttdeci">@ Add</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00186">MCInstrDesc.h:186</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSet_html_a1679469af9bb8ccfbe98441fb8228c79"><div class="ttname"><a href="classllvm_1_1SmallSet.html#a1679469af9bb8ccfbe98441fb8228c79">llvm::SmallSet::insert</a></div><div class="ttdeci">std::pair&lt; const_iterator, bool &gt; insert(const T &amp;V)</div><div class="ttdoc">insert - Insert an element into the set if it isn't already there.</div><div class="ttdef"><b>Definition:</b> <a href="SmallSet_8h_source.html#l00177">SmallSet.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1PPCTargetMachine_html"><div class="ttname"><a href="classllvm_1_1PPCTargetMachine.html">llvm::PPCTargetMachine</a></div><div class="ttdoc">Common code between 32-bit and 64-bit PowerPC targets.</div><div class="ttdef"><b>Definition:</b> <a href="PPCTargetMachine_8h_source.html#l00026">PPCTargetMachine.h:26</a></div></div>
<div class="ttc" id="anamespacellvm_html_a64ecdacbd49f696216e772782a109945"><div class="ttname"><a href="namespacellvm.html#a64ecdacbd49f696216e772782a109945">llvm::DeleteDeadPHIs</a></div><div class="ttdeci">bool DeleteDeadPHIs(BasicBlock *BB, const TargetLibraryInfo *TLI=nullptr, MemorySSAUpdater *MSSAU=nullptr)</div><div class="ttdoc">Examine each PHI in the given block and delete it if it is dead.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00163">BasicBlockUtils.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVConstant_html_a17304ab072a5b259c03e766a2b78a30b"><div class="ttname"><a href="classllvm_1_1SCEVConstant.html#a17304ab072a5b259c03e766a2b78a30b">llvm::SCEVConstant::getAPInt</a></div><div class="ttdeci">const APInt &amp; getAPInt() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00070">ScalarEvolutionExpressions.h:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="aScalarEvolutionExpressions_8h_html"><div class="ttname"><a href="ScalarEvolutionExpressions_8h.html">ScalarEvolutionExpressions.h</a></div></div>
<div class="ttc" id="aPPCLoopInstrFormPrep_8cpp_html_ad83e09e9f97995f00b7200b604edd436"><div class="ttname"><a href="PPCLoopInstrFormPrep_8cpp.html#ad83e09e9f97995f00b7200b604edd436">IsPtrInBounds</a></div><div class="ttdeci">static bool IsPtrInBounds(Value *BasePtr)</div><div class="ttdef"><b>Definition:</b> <a href="PPCLoopInstrFormPrep_8cpp_source.html#l00356">PPCLoopInstrFormPrep.cpp:356</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a9473b507816be4056a158a41cfb86807"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a9473b507816be4056a158a41cfb86807">llvm::numbers::phi</a></div><div class="ttdeci">constexpr double phi</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00045">MathExtras.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddExpr.html">llvm::SCEVAddExpr</a></div><div class="ttdoc">This node represents an addition of some number of SCEVs.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00249">ScalarEvolutionExpressions.h:249</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_addec638786f763d967811b45cb662f1f"><div class="ttname"><a href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00191">User.h:191</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_aaa970fc931c1c63037a8182e028d04b1"><div class="ttname"><a href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">#define INITIALIZE_PASS_BEGIN(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00052">PassSupport.h:52</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a8ce0c4746a1ec805e66409d20ae93922"><div class="ttname"><a href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const</div><div class="ttdoc">Return incoming basic block number i.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02814">Instructions.h:2814</a></div></div>
<div class="ttc" id="aclassllvm_1_1iterator__range_html"><div class="ttname"><a href="classllvm_1_1iterator__range.html">llvm::iterator_range</a></div><div class="ttdoc">A range adaptor for a pair of iterators.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00030">iterator_range.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae6d1c31d74bbaaa9e42bcbdc10a499f2"><div class="ttname"><a href="namespacellvm.html#ae6d1c31d74bbaaa9e42bcbdc10a499f2">llvm::pred_size</a></div><div class="ttdeci">unsigned pred_size(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineSSAContext_8h_source.html#l00032">MachineSSAContext.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html_aefeda9454a5e8dfcec3deb106964832a"><div class="ttname"><a href="classllvm_1_1SCEV.html#aefeda9454a5e8dfcec3deb106964832a">llvm::SCEV::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">Return the LLVM type of this SCEV expression.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l00401">ScalarEvolution.cpp:401</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_ab76052bb166c65901edb603a3e1f03ab"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a></div><div class="ttdeci">const char LLVMTargetMachineRef TM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00047">PassBuilderBindings.cpp:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_aef6d2bea715d1793e956f41ddeea2320"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aef6d2bea715d1793e956f41ddeea2320">llvm::ScalarEvolution::getAddExpr</a></div><div class="ttdeci">const SCEV * getAddExpr(SmallVectorImpl&lt; const SCEV * &gt; &amp;Ops, SCEV::NoWrapFlags Flags=SCEV::FlagAnyWrap, unsigned Depth=0)</div><div class="ttdoc">Get a canonical add expression, or something simpler if possible.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l02537">ScalarEvolution.cpp:2537</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00308">Pass.h:308</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a21d6ee82eed29080d911dbb548a8bb68"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">llvm::ScalarEvolution::getSCEVAtScope</a></div><div class="ttdeci">const SCEV * getSCEVAtScope(const SCEV *S, const Loop *L)</div><div class="ttdoc">Return a SCEV expression for the specified value at the specified scope in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l09735">ScalarEvolution.cpp:9735</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aPPCTargetMachine_8h_html"><div class="ttname"><a href="PPCTargetMachine_8h.html">PPCTargetMachine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a7eec28400b00678b1fb2b5f55ef7ac1b"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">llvm::SCEVAddRecExpr::getStepRecurrence</a></div><div class="ttdeci">const SCEV * getStepRecurrence(ScalarEvolution &amp;SE) const</div><div class="ttdoc">Constructs and returns the recurrence indicating how much this expression steps by.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00348">ScalarEvolutionExpressions.h:348</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="aSmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:16:37 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
