<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Coroutines/CoroFrame.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_41b0844b37bf482660c9a400b410eb70.html">Coroutines</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CoroFrame.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CoroFrame_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- CoroFrame.cpp - Builds and manipulates coroutine frame -------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// This file contains classes used to discover if for a particular value</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// there from sue to definition that crosses a suspend block.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Using the information discovered we form a Coroutine Frame structure to</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// contain those values. All uses of those values are replaced with appropriate</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// GEP + load from the coroutine frame. At the point of the definition we spill</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// the value into the coroutine frame.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CoroInternal_8h.html">CoroInternal.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BitVector_8h.html">llvm/ADT/BitVector.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostOrderIterator_8h.html">llvm/ADT/PostOrderIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScopeExit_8h.html">llvm/ADT/ScopeExit.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallString_8h.html">llvm/ADT/SmallString.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PtrUseVisitor_8h.html">llvm/Analysis/PtrUseVisitor.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StackLifetime_8h.html">llvm/Analysis/StackLifetime.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;llvm/Config/llvm-config.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2CFG_8h.html">llvm/IR/CFG.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DIBuilder_8h.html">llvm/IR/DIBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2DebugInfo_8h.html">llvm/IR/DebugInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstIterator_8h.html">llvm/IR/InstIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MathExtras_8h.html">llvm/Support/MathExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizedStructLayout_8h.html">llvm/Support/OptimizedStructLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="circular__raw__ostream_8h.html">llvm/Support/circular_raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PromoteMemToReg_8h.html">llvm/Transforms/Utils/PromoteMemToReg.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;deque&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// The &quot;coro-suspend-crossing&quot; flag is very noisy. There is another debug type,</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// &quot;coro-frame&quot;, which results in leaner debug spew.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;coro-suspend-crossing&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#aa91808171edab519dad6cbe8119f5d9ba08dba5f678da9c72318b151fbf9aeceb">   50</a></span>&#160;<span class="keyword">enum</span> { <a class="code" href="CoroFrame_8cpp.html#aa91808171edab519dad6cbe8119f5d9ba08dba5f678da9c72318b151fbf9aeceb">SmallVectorThreshold</a> = 32 };</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// Provides two way mapping between the blocks and numbers.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">class </span>BlockToIndexMapping {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, SmallVectorThreshold&gt;</a> V;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> V.size(); }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  BlockToIndexMapping(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      V.push_back(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(V);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">size_t</span> blockToIndex(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#aa81eb67f09ee4944eaeeddbc54c0c0de">llvm::lower_bound</a>(V, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != V.end() &amp;&amp; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> &amp;&amp; <span class="stringliteral">&quot;BasicBlockNumberng: Unknown block&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> - V.begin();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *indexToBlock(<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> V[<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>]; }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;};</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">// The SuspendCrossingInfo maintains data that allows to answer a question</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">// whether given two BasicBlocks A and B there is a path from A to B that</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// passes through a suspend point.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// For every basic block &#39;i&#39; it maintains a BlockData that consists of:</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//   Consumes:  a bit vector which contains a set of indices of blocks that can</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//              reach block &#39;i&#39;. A block can trivially reach itself.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//   Kills: a bit vector which contains a set of indices of blocks that can</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//          reach block &#39;i&#39; but there is a path crossing a suspend point</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//          not repeating &#39;i&#39; (path to &#39;i&#39; without cycles containing &#39;i&#39;).</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//   Suspend: a boolean indicating whether block &#39;i&#39; contains a suspend point.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//   End: a boolean indicating whether block &#39;i&#39; contains a coro.end intrinsic.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//   KillLoop: There is a path from &#39;i&#39; to &#39;i&#39; not otherwise repeating &#39;i&#39; that</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//             crosses a suspend point.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">struct </span>SuspendCrossingInfo {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  BlockToIndexMapping Mapping;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keyword">struct </span><a class="code" href="classBlockData.html#a3a4dfddb67525d6766e5b78956395fb9">BlockData</a> {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classllvm_1_1BitVector.html">BitVector</a> Consumes;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classllvm_1_1BitVector.html">BitVector</a> Kills;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">bool</span> Suspend = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">bool</span> End = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">bool</span> KillLoop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  };</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BlockData, SmallVectorThreshold&gt;</a> <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="classllvm_1_1iterator__range.html">iterator_range&lt;succ_iterator&gt;</a> <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(BlockData <span class="keyword">const</span> &amp;BD)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = Mapping.indexToBlock(&amp;BD - &amp;Block[0]);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  BlockData &amp;getBlockData(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>[Mapping.blockToIndex(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Label, <a class="code" href="classllvm_1_1BitVector.html">BitVector</a> <span class="keyword">const</span> &amp;BV) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  SuspendCrossingInfo(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">  /// Returns true if there is a path from \p From to \p To crossing a suspend</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  /// point without crossing \p From a 2nd time.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> hasPathCrossingSuspendPoint(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *To)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">size_t</span> <span class="keyword">const</span> FromIndex = Mapping.blockToIndex(<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">size_t</span> <span class="keyword">const</span> ToIndex = Mapping.blockToIndex(To);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">bool</span> <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>[ToIndex].Kills[FromIndex];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; To-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; answer is &quot;</span> &lt;&lt; Result &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">  /// Returns true if there is a path from \p From to \p To crossing a suspend</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">  /// point without crossing \p From a 2nd time. If \p From is the same as \p To</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">  /// this will also check if there is a looping path crossing a suspend point.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> hasPathOrLoopCrossingSuspendPoint(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                         <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *To)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">size_t</span> <span class="keyword">const</span> FromIndex = Mapping.blockToIndex(<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">size_t</span> <span class="keyword">const</span> ToIndex = Mapping.blockToIndex(To);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>[ToIndex].Kills[FromIndex] ||</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                  (<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a> == To &amp;&amp; <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>[ToIndex].KillLoop);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; To-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; answer is &quot;</span> &lt;&lt; Result &lt;&lt; <span class="stringliteral">&quot; (path or loop)\n&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">bool</span> isDefinitionAcrossSuspend(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *DefBB, <a class="code" href="classllvm_1_1User.html">User</a> *U)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// We rewrote PHINodes, so that only the ones with exactly one incoming</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// value need to be analyzed.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PN = dyn_cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> (PN-&gt;getNumIncomingValues() &gt; 1)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *UseBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// As a special case, treat uses by an llvm.coro.suspend.retcon or an</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// llvm.coro.suspend.async as if they were uses in the suspend&#39;s single</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// predecessor: the uses conceptually occur before the suspend.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (isa&lt;CoroSuspendRetconInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;CoroSuspendAsyncInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      UseBB = UseBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(UseBB &amp;&amp; <span class="stringliteral">&quot;should have split coro.suspend into its own block&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> hasPathCrossingSuspendPoint(DefBB, UseBB);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">bool</span> isDefinitionAcrossSuspend(<a class="code" href="classllvm_1_1Argument.html">Argument</a> &amp;A, <a class="code" href="classllvm_1_1User.html">User</a> *U)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span> isDefinitionAcrossSuspend(&amp;<a class="code" href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">A</a>.getParent()-&gt;getEntryBlock(), U);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">bool</span> isDefinitionAcrossSuspend(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1User.html">User</a> *U)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">auto</span> *DefBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// As a special case, treat values produced by an llvm.coro.suspend.*</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// as if they were defined in the single successor: the uses</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// conceptually occur after the suspend.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (isa&lt;AnyCoroSuspendInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      DefBB = DefBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a79c007dcf9fff57e1569e778d7885b5e">getSingleSuccessor</a>();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DefBB &amp;&amp; <span class="stringliteral">&quot;should have split coro.suspend into its own block&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">return</span> isDefinitionAcrossSuspend(DefBB, U);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">bool</span> isDefinitionAcrossSuspend(<a class="code" href="classllvm_1_1Value.html">Value</a> &amp;V, <a class="code" href="classllvm_1_1User.html">User</a> *U)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = dyn_cast&lt;Argument&gt;(&amp;V))</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">return</span> isDefinitionAcrossSuspend(*<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, U);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Inst = dyn_cast&lt;Instruction&gt;(&amp;V))</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">return</span> isDefinitionAcrossSuspend(*Inst, U);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="stringliteral">&quot;Coroutine could only collect Argument and Instruction now.&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;};</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<a class="code" href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a> <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">SuspendCrossingInfo::dump</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Label,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                                <a class="code" href="classllvm_1_1BitVector.html">BitVector</a> <span class="keyword">const</span> &amp;BV)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f">Label</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = BV.<a class="code" href="classllvm_1_1BitVector.html#abf86e1383aec181a5a2d9967eb8070fd">size</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (BV[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>])</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Mapping.indexToBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;getName();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<a class="code" href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a> <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">SuspendCrossingInfo::dump</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<span class="keyword">const</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> = Mapping.indexToBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>(<span class="stringliteral">&quot;   Consumes&quot;</span>, Block[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Consumes);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>(<span class="stringliteral">&quot;      Kills&quot;</span>, Block[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Kills);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;SuspendCrossingInfo::SuspendCrossingInfo(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    : Mapping(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = Mapping.size();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.resize(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// Initialize every block so that it consumes itself</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Consumes.resize(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Kills.resize(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Consumes.set(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// Mark all CoroEnd Blocks. We do not propagate Kills beyond coro.ends as</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// the code beyond coro.end is reachable during initial invocation of the</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// coroutine.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CE : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#adc470e92d3cd5fb8d54d7b9179841463">CoroEnds</a>)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    getBlockData(<a class="code" href="namespacellvm_1_1WinEH.html#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getParent()).End = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// Mark all suspend blocks and indicate that they kill everything they</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// consume. Note, that crossing coro.save also requires a spill, as any code</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// between coro.save and coro.suspend may resume the coroutine and all of the</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// state needs to be saved by that time.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keyword">auto</span> markSuspendBlock = [&amp;](<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *BarrierInst) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SuspendBlock = BarrierInst-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> = getBlockData(SuspendBlock);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Suspend = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Kills |= <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Consumes;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  };</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CSI : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    markSuspendBlock(CSI);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Save = CSI-&gt;getCoroSave())</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      markSuspendBlock(Save);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// Iterate propagating consumes and kills until they stop changing.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordtype">int</span> Iteration = 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  (void)Iteration;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordtype">bool</span> Changed;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;iteration &quot;</span> &lt;&lt; ++Iteration);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;==============\n&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>)) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keyword">auto</span> SuccNo = Mapping.blockToIndex(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Saved Consumes and Kills bitsets so that it is easy to see</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// if anything changed after propagation.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = <a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>[SuccNo];</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keyword">auto</span> SavedConsumes = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Consumes;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keyword">auto</span> SavedKills = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// Propagate Kills and Consumes from block B into its successor S.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Consumes |= <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Consumes;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills |= <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Kills;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">// If block B is a suspend block, it should propagate kills into the</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">// its successor for every block B consumes.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Suspend) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills |= <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Consumes;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Suspend) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="comment">// If block S is a suspend block, it should kill all of the blocks it</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          <span class="comment">// consumes.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills |= <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Consumes;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.End) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="comment">// If block S is an end block, it should not propagate kills as the</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          <span class="comment">// blocks following coro.end() are reached during initial invocation</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          <span class="comment">// of the coroutine while all the data are still available on the</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="comment">// stack or in the registers.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills.reset();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <span class="comment">// This is reached when S block it not Suspend nor coro.end and it</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <span class="comment">// need to make sure that it is not in the kill set.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.KillLoop |= <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills[SuccNo];</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills.reset(SuccNo);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// See if anything changed.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        Changed |= (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills != SavedKills) || (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Consumes != SavedConsumes);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills != SavedKills) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nblock &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot; follower &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getName()</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>(<span class="stringliteral">&quot;S.Kills&quot;</span>, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Kills));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>(<span class="stringliteral">&quot;SavedKills&quot;</span>, SavedKills));</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Consumes != SavedConsumes) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nblock &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot; follower &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>(<span class="stringliteral">&quot;S.Consume&quot;</span>, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.Consumes));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>(<span class="stringliteral">&quot;SavedCons&quot;</span>, SavedConsumes));</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  } <span class="keywordflow">while</span> (Changed);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>());</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">// RematGraph is used to construct a DAG for rematerializable instructions</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">// When the constructor is invoked with a candidate instruction (which is</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">// materializable) it builds a DAG of materializable instructions from that</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">// point.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">// Typically, for each instruction identified as re-materializable across a</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">// suspend point, a RematGraph will be created.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword">struct </span>RematGraph {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// Each RematNode in the graph contains the edges to instructions providing</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// operands in the current node.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keyword">struct </span>RematNode {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Node;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;RematNode *&gt;</a> <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    RematNode() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    RematNode(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *V) : Node(V) {}</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  };</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  RematNode *EntryNode;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keyword">using</span> RematNodeMap =</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="structllvm_1_1SmallMapVector.html">SmallMapVector&lt;Instruction *, std::unique_ptr&lt;RematNode&gt;</a>, 8&gt;;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  RematNodeMap Remats;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keyword">const</span> <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;bool(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;)&gt; &amp;MaterializableCallback;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  SuspendCrossingInfo &amp;Checker;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  RematGraph(<span class="keyword">const</span> <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;)&gt; &amp;MaterializableCallback,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;             <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, SuspendCrossingInfo &amp;Checker)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      : MaterializableCallback(MaterializableCallback), Checker(Checker) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    std::unique_ptr&lt;RematNode&gt; FirstNode = std::make_unique&lt;RematNode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    EntryNode = FirstNode.get();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    std::deque&lt;std::unique_ptr&lt;RematNode&gt;&gt; WorkList;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    addNode(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(FirstNode), WorkList, cast&lt;User&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">while</span> (WorkList.size()) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      std::unique_ptr&lt;RematNode&gt; <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(WorkList.front());</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      WorkList.pop_front();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      addNode(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>), WorkList, cast&lt;User&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">void</span> addNode(std::unique_ptr&lt;RematNode&gt; NUPtr,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;               std::deque&lt;std::unique_ptr&lt;RematNode&gt;&gt; &amp;WorkList,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;               <a class="code" href="classllvm_1_1User.html">User</a> *FirstUse) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    RematNode *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = NUPtr.get();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (Remats.count(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Node))</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// We haven&#39;t see this node yet - add to the list</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    Remats[<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Node] = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(NUPtr);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a> : <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Node-&gt;operands()) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = dyn_cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>.get());</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> || !MaterializableCallback(*<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>) ||</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          !Checker.isDefinitionAcrossSuspend(*<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>, FirstUse))</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (Remats.count(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>)) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// Already have this in the graph</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Operands.push_back(Remats[<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>].<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">get</a>());</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a313a633eb3049b90e931206183e1251eac8b77721c677e0429241a9250972122d">NoMatch</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : WorkList) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;Node == <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <a class="code" href="namespacellvm.html#a313a633eb3049b90e931206183e1251eac8b77721c677e0429241a9250972122d">NoMatch</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Operands.push_back(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.get());</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (NoMatch) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// Create a new node</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        std::unique_ptr&lt;RematNode&gt; ChildNode = std::make_unique&lt;RematNode&gt;(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Operands.push_back(ChildNode.get());</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        WorkList.push_back(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(ChildNode));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Entry (&quot;</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (EntryNode-&gt;Node-&gt;getParent()-&gt;hasName())</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; EntryNode-&gt;Node-&gt;getParent()-&gt;getName();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      EntryNode-&gt;Node-&gt;getParent()-&gt;printAsOperand(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;) : &quot;</span> &lt;&lt; *EntryNode-&gt;Node &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : Remats) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">for</span> (RematNode *U : <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.second-&gt;Operands)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; *U-&gt;Node &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;};</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html">  418</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structllvm_1_1GraphTraits.html">GraphTraits</a>&lt;RematGraph *&gt; {</div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a177eefb57f6ebdea5449a54c13bf33b0">  419</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a177eefb57f6ebdea5449a54c13bf33b0">NodeRef</a> = RematGraph::RematNode *;</div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a754aa9aea4e2e521912cfa03a0c9348f">  420</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a754aa9aea4e2e521912cfa03a0c9348f">ChildIteratorType</a> = RematGraph::RematNode **;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a83f6404a5697ffe8f1b2c2813ea09a9c">  422</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a177eefb57f6ebdea5449a54c13bf33b0">NodeRef</a> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a83f6404a5697ffe8f1b2c2813ea09a9c">getEntryNode</a>(RematGraph *<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>) { <span class="keywordflow">return</span> <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>-&gt;EntryNode; }</div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#af18e552cfee5828616b328e7a438e13d">  423</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a754aa9aea4e2e521912cfa03a0c9348f">ChildIteratorType</a> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#af18e552cfee5828616b328e7a438e13d">child_begin</a>(<a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a177eefb57f6ebdea5449a54c13bf33b0">NodeRef</a> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Operands.begin();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a1f9cb0685800b508261501ca6019f772">  426</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a754aa9aea4e2e521912cfa03a0c9348f">ChildIteratorType</a> <a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a1f9cb0685800b508261501ca6019f772">child_end</a>(<a class="code" href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a177eefb57f6ebdea5449a54c13bf33b0">NodeRef</a> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) { <span class="keywordflow">return</span> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;Operands.end(); }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;};</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;} <span class="comment">// end namespace llvm</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#undef DEBUG_TYPE // &quot;coro-suspend-crossing&quot;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">  432</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;coro-frame&quot;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keyword">class </span>FrameTypeBuilder;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">// Mapping from the to-be-spilled value to all the users that need reload.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keyword">using</span> SpillInfo = <a class="code" href="structllvm_1_1SmallMapVector.html">SmallMapVector&lt;Value *, SmallVector&lt;Instruction *, 2&gt;</a>, 8&gt;;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keyword">struct </span>AllocaInfo {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, std::optional&lt;APInt&gt;</a>&gt; Aliases;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordtype">bool</span> MayWriteBeforeCoroBegin;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  AllocaInfo(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;             <a class="code" href="classllvm_1_1DenseMap.html">DenseMap</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, std::optional&lt;APInt&gt;&gt; Aliases,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;             <span class="keywordtype">bool</span> MayWriteBeforeCoroBegin)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      : Alloca(Alloca), Aliases(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(Aliases)),</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        MayWriteBeforeCoroBegin(MayWriteBeforeCoroBegin) {}</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;};</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">struct </span>FrameDataInfo {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// All the values (that are not allocas) that needs to be spilled to the</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">// frame.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  SpillInfo Spills;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// Allocas contains all values defined as allocas that need to live in the</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// frame.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;AllocaInfo, 8&gt;</a> Allocas;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> getAllDefs()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> Defs;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : Spills)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      Defs.push_back(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.first);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : Allocas)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      Defs.push_back(<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> Defs;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="classuint32__t.html">uint32_t</a> getFieldIndex(<a class="code" href="classllvm_1_1Value.html">Value</a> *V)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keyword">auto</span> Itr = FieldIndexMap.find(V);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Itr != FieldIndexMap.end() &amp;&amp;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;           <span class="stringliteral">&quot;Value does not have a frame field index&quot;</span>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> Itr-&gt;second;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordtype">void</span> setFieldIndex(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((LayoutIndexUpdateStarted || FieldIndexMap.count(V) == 0) &amp;&amp;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;           <span class="stringliteral">&quot;Cannot set the index for the same field twice.&quot;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    FieldIndexMap[V] = <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> <a class="code" href="IRBuilder_8cpp.html#a36cf33ef120f4b9706471a89271dcfb5">getAlign</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keyword">auto</span> Iter = FieldAlignMap.find(V);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Iter != FieldAlignMap.end());</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">return</span> Iter-&gt;second;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordtype">void</span> setAlign(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="structllvm_1_1Align.html">Align</a> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AL</a>) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FieldAlignMap.count(V) == 0);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    FieldAlignMap.insert({V, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AL</a>});</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> getDynamicAlign(<a class="code" href="classllvm_1_1Value.html">Value</a> *V)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keyword">auto</span> Iter = FieldDynamicAlignMap.find(V);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Iter != FieldDynamicAlignMap.end());</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> Iter-&gt;second;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">void</span> setDynamicAlign(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="structllvm_1_1Align.html">Align</a>) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FieldDynamicAlignMap.count(V) == 0);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    FieldDynamicAlignMap.insert({V, <a class="code" href="structllvm_1_1Align.html">Align</a>});</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm.html#a603eb2d37a31ea2c14318bedeecb8e3c">getOffset</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keyword">auto</span> Iter = FieldOffsetMap.find(V);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Iter != FieldOffsetMap.end());</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">return</span> Iter-&gt;second;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordtype">void</span> setOffset(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FieldOffsetMap.count(V) == 0);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    FieldOffsetMap.insert({V, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>});</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// Remap the index of every field in the frame, using the final layout index.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordtype">void</span> updateLayoutIndex(FrameTypeBuilder &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// LayoutIndexUpdateStarted is used to avoid updating the index of any field</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// twice by mistake.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordtype">bool</span> LayoutIndexUpdateStarted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// Map from values to their slot indexes on the frame. They will be first set</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// with their original insertion field index. After the frame is built, their</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// indexes will be updated into the final layout index.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, uint32_t&gt;</a> FieldIndexMap;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">// Map from values to their alignment on the frame. They would be set after</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// the frame is built.</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, Align&gt;</a> FieldAlignMap;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, uint64_t&gt;</a> FieldDynamicAlignMap;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// Map from values to their offset on the frame. They would be set after</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// the frame is built.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, uint64_t&gt;</a> FieldOffsetMap;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;};</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ad4de2704820e01ff871aa093ca9cb712">  533</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#ad4de2704820e01ff871aa093ca9cb712">dumpSpills</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Title, <span class="keyword">const</span> SpillInfo &amp;Spills) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;------------- &quot;</span> &lt;&lt; Title &lt;&lt; <span class="stringliteral">&quot;--------------\n&quot;</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : Spills) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first-&gt;dump();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;   user: &quot;</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.second)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;dump();</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;}</div>
<div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ae401556a84636b6bd31d124b7836082b">  542</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#ae401556a84636b6bd31d124b7836082b">dumpRemats</a>(</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Title,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">const</span> <a class="code" href="structllvm_1_1SmallMapVector.html">SmallMapVector</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, std::unique_ptr&lt;RematGraph&gt;, 8&gt; &amp;<a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;------------- &quot;</span> &lt;&lt; Title &lt;&lt; <span class="stringliteral">&quot;--------------\n&quot;</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : <a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.second-&gt;dump();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;--\n&quot;</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ac103d1b9c5e3a297b0f730cb03034d02">  552</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#ac103d1b9c5e3a297b0f730cb03034d02">dumpAllocas</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;AllocaInfo&gt;</a> &amp;Allocas) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;------------- Allocas --------------\n&quot;</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : Allocas) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca-&gt;dump();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keyword">using</span> FieldIDType = size_t;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">// We cannot rely solely on natural alignment of a type when building a</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">// coroutine frame and if the alignment specified on the Alloca instruction</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">// differs from the natural alignment of the alloca type we will need to insert</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">// padding.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keyword">class </span>FrameTypeBuilder {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keyword">struct </span><a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a> {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    FieldIDType LayoutFieldIndex;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> TyAlignment;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> DynamicAlignBuffer;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  };</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> StructSize = 0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> StructAlign;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordtype">bool</span> IsFinished = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  std::optional&lt;Align&gt; MaxFrameAlignment;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Field, 8&gt;</a> Fields;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value*, unsigned&gt;</a> FieldIndexByKey;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  FrameTypeBuilder(<a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                   std::optional&lt;Align&gt; MaxFrameAlignment)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      : <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), <a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>), MaxFrameAlignment(MaxFrameAlignment) {}</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">  /// Add a field to this structure for the storage of an `alloca`</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">  /// instruction.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"></span>  [[nodiscard]] FieldIDType addFieldForAlloca(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                              <span class="keywordtype">bool</span> IsHeader = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">// Make an array type if this is a static array allocation.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#aea74164514e7164813ab30bcc4b7c557">isArrayAllocation</a>()) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CI = dyn_cast&lt;ConstantInt&gt;(AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#aaca14fdf6d151782f7ab0a66405453fb">getArraySize</a>()))</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        Ty = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ArrayType::get</a>(Ty, CI-&gt;getValue().getZExtValue());</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(<span class="stringliteral">&quot;Coroutines cannot handle non static allocas yet&quot;</span>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">return</span> addField(Ty, AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), IsHeader);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">  /// We want to put the allocas whose lifetime-ranges are not overlapped</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">  /// into one slot of coroutine frame.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">  /// Consider the example at:https://bugs.llvm.org/show_bug.cgi?id=45566</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">  ///     cppcoro::task&lt;void&gt; alternative_paths(bool cond) {</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">  ///         if (cond) {</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">  ///             big_structure a;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">  ///             process(a);</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">  ///             co_await something();</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">  ///         } else {</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">  ///             big_structure b;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">  ///             process2(b);</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">  ///             co_await something();</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">  ///         }</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">  ///     }</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">  /// We want to put variable a and variable b in the same slot to</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">  /// reduce the size of coroutine frame.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">  /// This function use StackLifetime algorithm to partition the AllocaInsts in</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">  /// Spills to non-overlapped sets in order to put Alloca in the same</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">  /// non-overlapped set into the same slot in the Coroutine Frame. Then add</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">  /// field for the allocas in the same non-overlapped set by using the largest</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">  /// type as the field type.</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">  /// Side Effects: Because We sort the allocas, the order of allocas in the</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">  /// frame may be different with the order in the source code.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> addFieldForAllocas(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, FrameDataInfo &amp;FrameData,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                          <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">  /// Add a field to this structure.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span>  [[nodiscard]] FieldIDType addField(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty, <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> MaybeFieldAlignment,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                     <span class="keywordtype">bool</span> IsHeader = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                     <span class="keywordtype">bool</span> IsSpillOfValue = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!IsFinished &amp;&amp; <span class="stringliteral">&quot;adding fields to a finished builder&quot;</span>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty &amp;&amp; <span class="stringliteral">&quot;must provide a type for a field&quot;</span>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// The field size is always the alloc size of the type.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> FieldSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Ty);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// For an alloca with size=0, we don&#39;t need to add a field and they</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// can just point to any index in the frame. Use index 0.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> (FieldSize == 0) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">// The field alignment might not be the type alignment, but we need</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">// to remember the type alignment anyway to build the type.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">// If we are spilling values we don&#39;t need to worry about ABI alignment</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">// concerns.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> ABIAlign = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getABITypeAlign(Ty);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> TyAlignment = ABIAlign;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">if</span> (IsSpillOfValue &amp;&amp; MaxFrameAlignment &amp;&amp; *MaxFrameAlignment &lt; ABIAlign)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      TyAlignment = *MaxFrameAlignment;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> FieldAlignment = MaybeFieldAlignment.value_or(TyAlignment);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// The field alignment could be bigger than the max frame case, in that case</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// we request additional storage to be able to dynamically align the</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// pointer.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> DynamicAlignBuffer = 0;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> (MaxFrameAlignment &amp;&amp; (FieldAlignment &gt; *MaxFrameAlignment)) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      DynamicAlignBuffer =</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          <a class="code" href="namespacellvm.html#a99cdcecbadc13087f087c61809bb44f1">offsetToAlignment</a>(MaxFrameAlignment-&gt;value(), FieldAlignment);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      FieldAlignment = *MaxFrameAlignment;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      FieldSize = FieldSize + DynamicAlignBuffer;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">// Lay out header fields immediately.</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (IsHeader) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a96bc92416c8a38a3c4a275b9e6c0beca">alignTo</a>(StructSize, FieldAlignment);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      StructSize = <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> + FieldSize;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="comment">// Everything else has a flexible offset.</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = OptimizedStructLayoutField::FlexibleOffset;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    Fields.push_back({FieldSize, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, Ty, 0, FieldAlignment, TyAlignment,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                      DynamicAlignBuffer});</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">return</span> Fields.size() - 1;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">  /// Finish the layout and set the body on the given type.</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> finish(<a class="code" href="classllvm_1_1StructType.html">StructType</a> *Ty);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> getStructSize()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsFinished &amp;&amp; <span class="stringliteral">&quot;not yet finished!&quot;</span>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">return</span> StructSize;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> getStructAlign()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsFinished &amp;&amp; <span class="stringliteral">&quot;not yet finished!&quot;</span>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">return</span> StructAlign;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  FieldIDType getLayoutFieldIndex(FieldIDType <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsFinished &amp;&amp; <span class="stringliteral">&quot;not yet finished!&quot;</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">return</span> Fields[<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>].LayoutFieldIndex;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a> getLayoutField(FieldIDType <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsFinished &amp;&amp; <span class="stringliteral">&quot;not yet finished!&quot;</span>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">return</span> Fields[<a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>];</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;};</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordtype">void</span> FrameDataInfo::updateLayoutIndex(FrameTypeBuilder &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keyword">auto</span> Updater = [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keyword">auto</span> <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getLayoutField(getFieldIndex(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    setFieldIndex(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.LayoutFieldIndex);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    setAlign(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html#a31b084098ebbf47988d1817a597b52d2">Alignment</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> dynamicAlign =</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.DynamicAlignBuffer</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            ? <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.DynamicAlignBuffer + <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html#a31b084098ebbf47988d1817a597b52d2">Alignment</a>.<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>()</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            : 0;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    setDynamicAlign(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, dynamicAlign);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    setOffset(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html#adae4afc395aed3ab340d695de637dd11">Offset</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  };</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  LayoutIndexUpdateStarted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Spills)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    Updater(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.first);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : Allocas)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    Updater(<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  LayoutIndexUpdateStarted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;}</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordtype">void</span> FrameTypeBuilder::addFieldForAllocas(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                          FrameDataInfo &amp;FrameData,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                          <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keyword">using</span> AllocaSetType = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;AllocaInst *, 4&gt;</a>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;AllocaSetType, 4&gt;</a> NonOverlapedAllocas;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// We need to add field for allocas at the end of this function.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keyword">auto</span> AddFieldForAllocasAtExit = <a class="code" href="namespacellvm.html#ab2e3dbebd68e69d77c227682fc8e3ba2">make_scope_exit</a>([&amp;]() {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> AllocaList : NonOverlapedAllocas) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keyword">auto</span> *LargestAI = *AllocaList.begin();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      FieldIDType <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a> = addFieldForAlloca(LargestAI);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Alloca : AllocaList)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <a class="code" href="namespacellvm_1_1codeview.html#a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4">FrameData</a>.setFieldIndex(Alloca, <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  });</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span> (!Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abcad2d8140114b7cd7e686dde240e5b0">OptimizeFrame</a>) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : <a class="code" href="namespacellvm_1_1codeview.html#a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4">FrameData</a>.Allocas) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca = <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      NonOverlapedAllocas.emplace_back(AllocaSetType(1, Alloca));</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">// Because there are paths from the lifetime.start to coro.end</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// for each alloca, the liferanges for every alloca is overlaped</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">// in the blocks who contain coro.end and the successor blocks.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="comment">// So we choose to skip there blocks when we calculate the liferange</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">// for each alloca. It should be reasonable since there shouldn&#39;t be uses</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="comment">// in these blocks and the coroutine frame shouldn&#39;t be used outside the</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="comment">// coroutine body.</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="comment">// Note that the user of coro.suspend may not be SwitchInst. However, this</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// case seems too complex to handle. And it is harmless to skip these</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="comment">// patterns since it just prevend putting the allocas to live in the same</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">// slot.</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;SwitchInst *, BasicBlock *&gt;</a> DefaultSuspendDest;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="classllvm_1_1CoroSuspendInst.html">CoroSuspendInst</a> : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : <a class="code" href="classllvm_1_1CoroSuspendInst.html">CoroSuspendInst</a>-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ConstSWI = dyn_cast&lt;SwitchInst&gt;(U)) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keyword">auto</span> *SWI = <span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1SwitchInst.html">SwitchInst</a> *<span class="keyword">&gt;</span>(ConstSWI);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        DefaultSuspendDest[SWI] = SWI-&gt;getDefaultDest();</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        SWI-&gt;setDefaultDest(SWI-&gt;getSuccessor(1));</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keyword">auto</span> ExtractAllocas = [&amp;]() {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    AllocaSetType Allocas;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    Allocas.<a class="code" href="classllvm_1_1DenseMapBase.html#ae292a4b96e7f74eb95a4176ddba7b821">reserve</a>(<a class="code" href="namespacellvm_1_1codeview.html#a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4">FrameData</a>.Allocas.size());</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : <a class="code" href="namespacellvm_1_1codeview.html#a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4">FrameData</a>.Allocas)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      Allocas.push_back(<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span> Allocas;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  };</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="classllvm_1_1StackLifetime.html">StackLifetime</a> StackLifetimeAnalyzer(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ExtractAllocas(),</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                      StackLifetime::LivenessType::May);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  StackLifetimeAnalyzer.run();</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keyword">auto</span> IsAllocaInferenre = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI1, <span class="keyword">const</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI2) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">return</span> StackLifetimeAnalyzer.getLiveRange(AI1).overlaps(</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        StackLifetimeAnalyzer.getLiveRange(AI2));</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  };</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keyword">auto</span> GetAllocaSize = [&amp;](<span class="keyword">const</span> AllocaInfo &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    std::optional&lt;TypeSize&gt; RetSize = <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca-&gt;getAllocationSize(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RetSize &amp;&amp; <span class="stringliteral">&quot;Variable Length Arrays (VLA) are not supported.\n&quot;</span>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!RetSize-&gt;isScalable() &amp;&amp; <span class="stringliteral">&quot;Scalable vectors are not yet supported&quot;</span>);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">return</span> RetSize-&gt;getFixedValue();</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  };</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// Put larger allocas in the front. So the larger allocas have higher</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// priority to merge, which can save more space potentially. Also each</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">// AllocaSet would be ordered. So we can get the largest Alloca in one</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="comment">// AllocaSet easily.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">sort</a>(<a class="code" href="namespacellvm_1_1codeview.html#a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4">FrameData</a>.Allocas, [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Iter1, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;Iter2) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    return GetAllocaSize(Iter1) &gt; GetAllocaSize(Iter2);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  });</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : <a class="code" href="namespacellvm_1_1codeview.html#a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4">FrameData</a>.Allocas) {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca = <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordtype">bool</span> Merged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">// Try to find if the Alloca is not inferenced with any existing</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">// NonOverlappedAllocaSet. If it is true, insert the alloca to that</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// NonOverlappedAllocaSet.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;AllocaSet : NonOverlapedAllocas) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!AllocaSet.empty() &amp;&amp; <span class="stringliteral">&quot;Processing Alloca Set is not empty.\n&quot;</span>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordtype">bool</span> NoInference = <a class="code" href="namespacellvm.html#a7dc3069afa2ce5ea62ac2eb183e51c00">none_of</a>(AllocaSet, [&amp;](<span class="keyword">auto</span> Iter) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">return</span> IsAllocaInferenre(Alloca, Iter);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      });</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="comment">// If the alignment of A is multiple of the alignment of B, the address</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="comment">// of A should satisfy the requirement for aligning for B.</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="comment">// There may be other more fine-grained strategies to handle the alignment</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="comment">// infomation during the merging process. But it seems hard to handle</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// these strategies and benefit little.</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordtype">bool</span> Alignable = [&amp;]() -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keyword">auto</span> *LargestAlloca = *AllocaSet.begin();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">return</span> LargestAlloca-&gt;getAlign().value() % Alloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>().<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>() ==</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;               0;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      }();</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <span class="keywordtype">bool</span> CouldMerge = NoInference &amp;&amp; Alignable;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">if</span> (!CouldMerge)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      AllocaSet.push_back(Alloca);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      Merged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">if</span> (!Merged) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      NonOverlapedAllocas.emplace_back(AllocaSetType(1, Alloca));</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment">// Recover the default target destination for each Switch statement</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">// reserved.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> SwitchAndDefaultDest : DefaultSuspendDest) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="classllvm_1_1SwitchInst.html">SwitchInst</a> *SWI = SwitchAndDefaultDest.first;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *DestBB = SwitchAndDefaultDest.second;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    SWI-&gt;<a class="code" href="classllvm_1_1SwitchInst.html#aa22bdae1cee3c836f2b4cf8307fc7598">setDefaultDest</a>(DestBB);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// This Debug Info could tell us which allocas are merged into one slot.</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;AllocaSet</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                  : NonOverlapedAllocas) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> (AllocaSet.size() &gt; 1) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      dbgs() &lt;&lt; <span class="stringliteral">&quot;In Function:&quot;</span> &lt;&lt; F.getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      dbgs() &lt;&lt; <span class="stringliteral">&quot;Find Union Set &quot;</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      dbgs() &lt;&lt; <span class="stringliteral">&quot;\tAllocas are \n&quot;</span>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      for (auto Alloca : AllocaSet)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        dbgs() &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt; *Alloca &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  });</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordtype">void</span> FrameTypeBuilder::finish(<a class="code" href="classllvm_1_1StructType.html">StructType</a> *Ty) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!IsFinished &amp;&amp; <span class="stringliteral">&quot;already finished!&quot;</span>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">// Prepare the optimal-layout field array.</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="comment">// The Id in the layout field is a pointer to our Field for it.</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;OptimizedStructLayoutField, 8&gt;</a> LayoutFields;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  LayoutFields.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(Fields.size());</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a> : Fields) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    LayoutFields.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(&amp;<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>, <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html#ae472b245af5bd4a76bea7581ea772185">Size</a>, <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html#a31b084098ebbf47988d1817a597b52d2">Alignment</a>,</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                              <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a>.<a class="code" href="structllvm_1_1OptimizedStructLayoutField.html#adae4afc395aed3ab340d695de637dd11">Offset</a>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">// Perform layout.</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keyword">auto</span> SizeAndAlign = <a class="code" href="namespacellvm.html#aae35ec9b920ff3bb892cd872877a89fe">performOptimizedStructLayout</a>(LayoutFields);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  StructSize = SizeAndAlign.first;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  StructAlign = SizeAndAlign.second;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keyword">auto</span> getField = [](<span class="keyword">const</span> <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">OptimizedStructLayoutField</a> &amp;LayoutField) -&gt; <a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a> &amp; {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">static_cast&lt;</span><a class="code" href="structllvm_1_1OptimizedStructLayoutField.html">Field</a> *<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(LayoutField.Id));</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  };</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">// We need to produce a packed struct type if there&#39;s a field whose</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">// assigned offset isn&#39;t a multiple of its natural type alignment.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1codeview.html#a4e60e0c351f13aade28b451480c44e5aaa1977c3f68d4d3bbfe14d0e51a575482">Packed</a> = [&amp;] {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;LayoutField : LayoutFields) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getField(LayoutField);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="Loads_8cpp.html#a1ffe95010234816af6f2a6d704f787ed">isAligned</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.TyAlignment, LayoutField.Offset))</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }();</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// Build the struct body.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Type*, 16&gt;</a> FieldTypes;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  FieldTypes.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(LayoutFields.size() * 3 / 2);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> LastOffset = 0;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;LayoutField : LayoutFields) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = getField(LayoutField);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keyword">auto</span> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = LayoutField.Offset;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">// Add a padding field if there&#39;s a padding gap and we&#39;re either</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// building a packed struct or the padding gap is more than we&#39;d</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// get from aligning to the field type&#39;s natural alignment.</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> &gt;= LastOffset);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> != LastOffset) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">if</span> (Packed || <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a96bc92416c8a38a3c4a275b9e6c0beca">alignTo</a>(LastOffset, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.TyAlignment) != <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        FieldTypes.push_back(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ArrayType::get</a>(Type::getInt8Ty(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>),</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                            <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> - LastOffset));</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Offset = <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.LayoutFieldIndex = FieldTypes.size();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    FieldTypes.push_back(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Ty);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.DynamicAlignBuffer) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      FieldTypes.push_back(</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ArrayType::get</a>(Type::getInt8Ty(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>), <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.DynamicAlignBuffer));</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    LastOffset = <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> + <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Size;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  Ty-&gt;<a class="code" href="classllvm_1_1StructType.html#a3861d2f045e00a8114f99f751371ec68">setBody</a>(FieldTypes, Packed);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// Check that the IR layout matches the offsets we expect.</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keyword">auto</span> Layout = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getStructLayout(Ty);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : Fields) {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">getElementType</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.LayoutFieldIndex) == <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Ty);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Layout-&gt;getElementOffset(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.LayoutFieldIndex) == <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Offset);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  IsFinished = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;}</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a44d73f71509ec34798d5810859701347">  943</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a44d73f71509ec34798d5810859701347">cacheDIVar</a>(FrameDataInfo &amp;FrameData,</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                       <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, DILocalVariable *&gt;</a> &amp;DIVarCache) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *V : FrameData.getAllDefs()) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span> (DIVarCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(V) != DIVarCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keyword">auto</span> DDIs = <a class="code" href="namespacellvm.html#a06ac4fd2f05423f4d1a20a0ac699807c">FindDbgDeclareUses</a>(V);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">llvm::find_if</a>(DDIs, [](<a class="code" href="classllvm_1_1DbgDeclareInst.html">DbgDeclareInst</a> *DDI) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keywordflow">return</span> DDI-&gt;<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html#a2d4581b2568be7db21e47f096ffd6df8">getExpression</a>()-&gt;getNumElements() == 0;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    });</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != DDIs.end())</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      DIVarCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({V, (*I)-&gt;getVariable()});</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;}</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">/// Create name for Type. It uses MDString to store new created string to</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">/// avoid memory leak.</span></div>
<div class="line"><a name="l00960"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#acdaf5010e3f77d9d6e8ae04f5e0248e8">  960</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="CoroFrame_8cpp.html#acdaf5010e3f77d9d6e8ae04f5e0248e8">solveTypeName</a>(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// The longest name in common may be &#39;__int_128&#39;, which has 9 bits.</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;16&gt;</a> Buffer;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="classllvm_1_1raw__svector__ostream.html">raw_svector_ostream</a> <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>(Buffer);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;__int_&quot;</span> &lt;&lt; cast&lt;IntegerType&gt;(Ty)-&gt;getBitWidth();</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keyword">auto</span> *MDName = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">MDString::get</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>.str());</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">return</span> MDName-&gt;getString();</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>()) {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">isFloatTy</a>())</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;__float_&quot;</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">isDoubleTy</a>())</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;__double_&quot;</span>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;__floating_type_&quot;</span>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PtrTy = dyn_cast&lt;PointerType&gt;(Ty)) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span> (PtrTy-&gt;isOpaque())</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;PointerType&quot;</span>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *PointeeTy = PtrTy-&gt;<a class="code" href="classllvm_1_1Type.html#abceff71202e0269065cf32a2f750a9be">getNonOpaquePointerElementType</a>();</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <a class="code" href="CoroFrame_8cpp.html#acdaf5010e3f77d9d6e8ae04f5e0248e8">solveTypeName</a>(PointeeTy);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> == <span class="stringliteral">&quot;UnknownType&quot;</span>)</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;PointerType&quot;</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;16&gt;</a> Buffer;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;_Ptr&quot;</span>).<a class="code" href="classllvm_1_1Twine.html#ac521760e9a45f304a4cbe46ed4fff845">toStringRef</a>(Buffer);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keyword">auto</span> *MDName = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">MDString::get</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), Buffer.<a class="code" href="classllvm_1_1SmallString.html#af5dd7241878be5eed07736eb156bb10b">str</a>());</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">return</span> MDName-&gt;getString();</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>()) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> (!cast&lt;StructType&gt;(Ty)-&gt;hasName())</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;__LiteralStructType_&quot;</span>;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a4d0a50f63402f509e3f6c62a6c513fbf">getStructName</a>();</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;16&gt;</a> Buffer(<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Iter : Buffer)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="keywordflow">if</span> (Iter == <span class="charliteral">&#39;.&#39;</span> || Iter == <span class="charliteral">&#39;:&#39;</span>)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        Iter = <span class="charliteral">&#39;_&#39;</span>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keyword">auto</span> *MDName = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">MDString::get</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), Buffer.str());</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">return</span> MDName-&gt;getString();</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;UnknownType&quot;</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;}</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a0825e40d7e48c40f94c2639769b16f44"> 1008</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1DIType.html">DIType</a> *<a class="code" href="CoroFrame_8cpp.html#a0825e40d7e48c40f94c2639769b16f44">solveDIType</a>(<a class="code" href="classllvm_1_1DIBuilder.html">DIBuilder</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;Layout, <a class="code" href="classllvm_1_1DIScope.html">DIScope</a> *<a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>,</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                           <span class="keywordtype">unsigned</span> LineNum,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                           <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Type *, DIType *&gt;</a> &amp;DITypeCache) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1DIType.html">DIType</a> *DT = DITypeCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(Ty))</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">return</span> DT;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <a class="code" href="CoroFrame_8cpp.html#acdaf5010e3f77d9d6e8ae04f5e0248e8">solveTypeName</a>(Ty);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="classllvm_1_1DIType.html">DIType</a> *RetType = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = cast&lt;IntegerType&gt;(Ty)-&gt;getBitWidth();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    RetType = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.createBasicType(<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>, <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>, dwarf::DW_ATE_signed,</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                      llvm::DINode::FlagArtificial);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>()) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    RetType = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.createBasicType(<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>, Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(Ty),</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                                      dwarf::DW_ATE_float,</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                                      llvm::DINode::FlagArtificial);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// Construct PointerType points to null (aka void *) instead of exploring</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">// pointee type to avoid infinite search problem. For example, we would be</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">// in trouble if we traverse recursively:</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">//  struct Node {</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">//      Node* ptr;</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">//  };</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    RetType =</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.createPointerType(<span class="keyword">nullptr</span>, Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(Ty),</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                  Layout.<a class="code" href="classllvm_1_1DataLayout.html#a800e74bec9b78d6739665027c3616a55">getABITypeAlign</a>(Ty).<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>() * CHAR_BIT,</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                  <span class="comment">/*DWARFAddressSpace=*/</span>std::nullopt, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>()) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keyword">auto</span> *DIStruct = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.createStructType(</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>, <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;getFile(), LineNum, Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(Ty),</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        Layout.<a class="code" href="classllvm_1_1DataLayout.html#af9185c7e96873c6d2c13e1f1b6322cf6">getPrefTypeAlign</a>(Ty).<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>() * CHAR_BIT,</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        llvm::DINode::FlagArtificial, <span class="keyword">nullptr</span>, llvm::DINodeArray());</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keyword">auto</span> *StructTy = cast&lt;StructType&gt;(Ty);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Metadata *, 16&gt;</a> Elements;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; StructTy-&gt;getNumElements(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <a class="code" href="classllvm_1_1DIType.html">DIType</a> *DITy = <a class="code" href="CoroFrame_8cpp.html#a0825e40d7e48c40f94c2639769b16f44">solveDIType</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, StructTy-&gt;getElementType(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), Layout,</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                 <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, LineNum, DITypeCache);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DITy);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      Elements.push_back(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.createMemberType(</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;          <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>, DITy-&gt;<a class="code" href="classllvm_1_1DIType.html#a777848a3e8c10c10721c852d4efb9e3b">getName</a>(), <a class="code" href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">Scope</a>-&gt;getFile(), LineNum,</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          DITy-&gt;<a class="code" href="classllvm_1_1DIType.html#a8b53bdd5b8f1d8cd12a392c256cb54f3">getSizeInBits</a>(), DITy-&gt;<a class="code" href="classllvm_1_1DIType.html#afabf2c71538af4463120b743db12fcf0">getAlignInBits</a>(),</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          Layout.<a class="code" href="classllvm_1_1DataLayout.html#a61135fb8666f0b7a37b4e1bbcf1db131">getStructLayout</a>(StructTy)-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a38bfb6d6dbaf3f8ca7764969563f486d">getElementOffsetInBits</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>),</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          llvm::DINode::FlagArtificial, DITy));</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.replaceArrays(DIStruct, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getOrCreateArray(Elements));</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    RetType = DIStruct;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unresolved Type: &quot;</span> &lt;&lt; *Ty &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(Ty);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keyword">auto</span> *CharSizeType = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.createBasicType(</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>, 8, dwarf::DW_ATE_unsigned_char, llvm::DINode::FlagArtificial);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> &lt;= 8)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      RetType = CharSizeType;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> % 8 != 0)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = TypeSize::Fixed(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> + 8 - (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> % 8));</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      RetType = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.createArrayType(</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>, Layout.<a class="code" href="classllvm_1_1DataLayout.html#af9185c7e96873c6d2c13e1f1b6322cf6">getPrefTypeAlign</a>(Ty).<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>(), CharSizeType,</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getOrCreateArray(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getOrCreateSubrange(0, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> / 8)));</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  DITypeCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({Ty, RetType});</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">return</span> RetType;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;}</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">/// Build artificial debug info for C++ coroutine frames to allow users to</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">/// inspect the contents of the frame directly</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">/// Create Debug information for coroutine frame with debug name &quot;__coro_frame&quot;.</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">/// The debug information for the fields of coroutine frame is constructed from</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">/// the following way:</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">/// 1. For all the value in the Frame, we search the use of dbg.declare to find</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">///    the corresponding debug variables for the value. If we can find the</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">///    debug variable, we can get full and accurate debug information.</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">/// 2. If we can&#39;t get debug information in step 1 and 2, we could only try to</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">///    build the DIType by Type. We did this in solveDIType. We only handle</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">///    integer, float, double, integer type and struct type for now.</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a86c6fee36a1f17461710c01e694ee8df"> 1095</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a86c6fee36a1f17461710c01e694ee8df">buildFrameDebugInfo</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                FrameDataInfo &amp;FrameData) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *DIS = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getSubprogram();</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">// If there is no DISubprogram for F, it implies the Function are not compiled</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// with debug info. So we also don&#39;t need to generate debug info for the frame</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// neither.</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordflow">if</span> (!DIS || !DIS-&gt;getUnit() ||</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      !<a class="code" href="namespacellvm_1_1dwarf.html#aaedb78de657237c48255243a68e1dbc1">dwarf::isCPlusPlus</a>(</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          (<a class="code" href="namespacellvm_1_1dwarf.html#a78f32f1cfba451a8c3691f00768da230">dwarf::SourceLanguage</a>)DIS-&gt;getUnit()-&gt;getSourceLanguage()))</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch &amp;&amp;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;         <span class="stringliteral">&quot;We could only build debug infomation for C++ coroutine now.\n&quot;</span>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <a class="code" href="classllvm_1_1DIBuilder.html">DIBuilder</a> DBuilder(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent(), <span class="comment">/*AllowUnresolved*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *PromiseAlloca = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#aff44497b1660786285d7908a98f940f5">getPromiseAlloca</a>();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PromiseAlloca &amp;&amp;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;         <span class="stringliteral">&quot;Coroutine with switch ABI should own Promise alloca&quot;</span>);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <a class="code" href="classllvm_1_1TinyPtrVector.html">TinyPtrVector&lt;DbgDeclareInst *&gt;</a> DIs = <a class="code" href="namespacellvm.html#a06ac4fd2f05423f4d1a20a0ac699807c">FindDbgDeclareUses</a>(PromiseAlloca);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordflow">if</span> (DIs.<a class="code" href="classllvm_1_1TinyPtrVector.html#a9dc659b723e6725130ad354ed821d400">empty</a>())</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <a class="code" href="classllvm_1_1DbgDeclareInst.html">DbgDeclareInst</a> *PromiseDDI = DIs.<a class="code" href="classllvm_1_1TinyPtrVector.html#a3a26404d33061e8aaeab39c490181389">front</a>();</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <a class="code" href="classllvm_1_1DILocalVariable.html">DILocalVariable</a> *PromiseDIVariable = PromiseDDI-&gt;<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html#ac161deb2a31f78c85f94fbe0f3ba97b4">getVariable</a>();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <a class="code" href="classllvm_1_1DILocalScope.html">DILocalScope</a> *PromiseDIScope = PromiseDIVariable-&gt;<a class="code" href="classllvm_1_1DILocalVariable.html#accfecccb150b316edf9b05e2d1fe117f">getScope</a>();</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <a class="code" href="classllvm_1_1DIFile.html">DIFile</a> *DFile = PromiseDIScope-&gt;<a class="code" href="classllvm_1_1DIScope.html#a875719877cc384dbe437a63fdb579030">getFile</a>();</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <a class="code" href="classllvm_1_1DILocation.html">DILocation</a> *DILoc = PromiseDDI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>().<a class="code" href="classllvm_1_1DebugLoc.html#a4ff1bb484be62f8dac94fc087f72f524">get</a>();</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordtype">unsigned</span> LineNum = PromiseDIVariable-&gt;<a class="code" href="classllvm_1_1DIVariable.html#ae94ae88c9f22d83ba5843753153849a4">getLine</a>();</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <a class="code" href="classllvm_1_1DICompositeType.html">DICompositeType</a> *FrameDITy = DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#a3e99da1a11ff2254b0952710c600b621">createStructType</a>(</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      DIS-&gt;getUnit(), <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName() + <span class="stringliteral">&quot;.coro_frame_ty&quot;</span>).<a class="code" href="classllvm_1_1Twine.html#a4c1c1093a7749409c70838678514cc7c">str</a>(),</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      DFile, LineNum, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">FrameSize</a> * 8,</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>.<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>() * 8, llvm::DINode::FlagArtificial, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      llvm::DINodeArray());</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <a class="code" href="classllvm_1_1StructType.html">StructType</a> *FrameTy = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Metadata *, 16&gt;</a> Elements;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> Layout = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getDataLayout();</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Value *, DILocalVariable *&gt;</a> DIVarCache;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#a44d73f71509ec34798d5810859701347">cacheDIVar</a>(FrameData, DIVarCache);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordtype">unsigned</span> ResumeIndex = coro::Shape::SwitchFieldIndex::Resume;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordtype">unsigned</span> DestroyIndex = coro::Shape::SwitchFieldIndex::Destroy;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="keywordtype">unsigned</span> IndexIndex = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a1640d3af02b4a49eaa3422920056bb6d">IndexField</a>;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, StringRef&gt;</a> NameCache;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  NameCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({ResumeIndex, <span class="stringliteral">&quot;__resume_fn&quot;</span>});</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  NameCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({DestroyIndex, <span class="stringliteral">&quot;__destroy_fn&quot;</span>});</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  NameCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({IndexIndex, <span class="stringliteral">&quot;__coro_index&quot;</span>});</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ResumeFnTy = FrameTy-&gt;<a class="code" href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">getElementType</a>(ResumeIndex),</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;       *DestroyFnTy = FrameTy-&gt;<a class="code" href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">getElementType</a>(DestroyIndex),</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;       *IndexTy = FrameTy-&gt;<a class="code" href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">getElementType</a>(IndexIndex);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, DIType *&gt;</a> TyCache;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  TyCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      {ResumeIndex, DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#a8f163bf8a14c1c7823f6d8fce7fb5ac7">createPointerType</a>(</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                        <span class="keyword">nullptr</span>, Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(ResumeFnTy))});</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  TyCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      {DestroyIndex, DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#a8f163bf8a14c1c7823f6d8fce7fb5ac7">createPointerType</a>(</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                         <span class="keyword">nullptr</span>, Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(DestroyFnTy))});</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">  /// FIXME: If we fill the field `SizeInBits` with the actual size of</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">  /// __coro_index in bits, then __coro_index wouldn&#39;t show in the debugger.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment"></span>  TyCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({IndexIndex, DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#ab76e3275f4ae2b0601c15cf2d4e957af">createBasicType</a>(</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                                  <span class="stringliteral">&quot;__coro_index&quot;</span>,</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                  (Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(IndexTy) &lt; 8)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                      ? 8</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                      : Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(IndexTy),</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                  dwarf::DW_ATE_unsigned_char)});</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *V : FrameData.getAllDefs()) {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">if</span> (DIVarCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(V) == DIVarCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = FrameData.getFieldIndex(V);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    NameCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>, DIVarCache[V]-&gt;getName()});</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    TyCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>, DIVarCache[V]-&gt;getType()});</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="comment">// Cache from index to (Align, Offset Pair)</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;unsigned, std::pair&lt;unsigned, unsigned&gt;</a>&gt; OffsetCache;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">// The Align and Offset of Resume function and Destroy function are fixed.</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  OffsetCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({ResumeIndex, {8, 0}});</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  OffsetCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>({DestroyIndex, {8, 8}});</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  OffsetCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      {IndexIndex,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;       {Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a9d132e5f83821984ce6d37cb38a99c24">IndexAlign</a>, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a1d3459ac1d0c3c498b3a522fbdcb0e7b">IndexOffset</a>}});</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *V : FrameData.getAllDefs()) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = FrameData.getFieldIndex(V);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    OffsetCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        {<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>, {FrameData.getAlign(V).value(), FrameData.getOffset(V)}});</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Type *, DIType *&gt;</a> DITypeCache;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="comment">// This counter is used to avoid same type names. e.g., there would be</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="comment">// many i32 and i64 types in one coroutine. And we would use i32_0 and</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="comment">// i32_1 to avoid the same type. Since it makes no sense the name of the</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// fields confilicts with each other.</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordtype">unsigned</span> UnknownTypeNum = 0;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = 0; <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &lt; FrameTy-&gt;<a class="code" href="classllvm_1_1StructType.html#a858efd7b61654c0de28c56f9adafa13d">getNumElements</a>(); <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>++) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">if</span> (OffsetCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>) == OffsetCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    std::string <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SizeInBits;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> AlignInBits;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> OffsetInBits;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <a class="code" href="classllvm_1_1DIType.html">DIType</a> *DITy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = FrameTy-&gt;<a class="code" href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">getElementType</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a8ad67a33bae235fe3cca1c3e5a91ed2d">isSized</a>() &amp;&amp; <span class="stringliteral">&quot;We can&#39;t handle type which is not sized.\n&quot;</span>);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    SizeInBits = Layout.<a class="code" href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">getTypeSizeInBits</a>(Ty).<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">getFixedValue</a>();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    AlignInBits = OffsetCache[<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>].first * 8;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    OffsetInBits = OffsetCache[<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>].second * 8;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">if</span> (NameCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>) != NameCache.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = NameCache[<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>].str();</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      DITy = TyCache[<a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>];</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      DITy = <a class="code" href="CoroFrame_8cpp.html#a0825e40d7e48c40f94c2639769b16f44">solveDIType</a>(DBuilder, Ty, Layout, FrameDITy, LineNum, DITypeCache);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DITy &amp;&amp; <span class="stringliteral">&quot;SolveDIType shouldn&#39;t return nullptr.\n&quot;</span>);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = DITy-&gt;<a class="code" href="classllvm_1_1DIType.html#a777848a3e8c10c10721c852d4efb9e3b">getName</a>().<a class="code" href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">str</a>();</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> += <span class="stringliteral">&quot;_&quot;</span> + <a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(UnknownTypeNum);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      UnknownTypeNum++;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    Elements.push_back(DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#adbf77460ca5103d4d0b2708b013a1b88">createMemberType</a>(</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        FrameDITy, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>, DFile, LineNum, SizeInBits, AlignInBits, OffsetInBits,</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        llvm::DINode::FlagArtificial, DITy));</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#afee05194feacd4f95209e840e7242332">replaceArrays</a>(FrameDITy, DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#ac22bd3a0571eb4e961def1c480247296">getOrCreateArray</a>(Elements));</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keyword">auto</span> *FrameDIVar = DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#ae6081972b0560d0f16bd503654924b1b">createAutoVariable</a>(PromiseDIScope, <span class="stringliteral">&quot;__coro_frame&quot;</span>,</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                                 DFile, LineNum, FrameDITy,</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                                 <span class="keyword">true</span>, DINode::FlagArtificial);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FrameDIVar-&gt;isValidLocationForIntrinsic(PromiseDDI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>()));</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="comment">// Subprogram would have ContainedNodes field which records the debug</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="comment">// variables it contained. So we need to add __coro_frame to the</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="comment">// ContainedNodes of it.</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="comment">// If we don&#39;t add __coro_frame to the RetainedNodes, user may get</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="comment">// `no symbol __coro_frame in context` rather than `__coro_frame`</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">// is optimized out, which is more precise.</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SubProgram = dyn_cast&lt;DISubprogram&gt;(PromiseDIScope)) {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keyword">auto</span> RetainedNodes = SubProgram-&gt;getRetainedNodes();</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Metadata *, 32&gt;</a> RetainedNodesVec(RetainedNodes.begin(),</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                                 RetainedNodes.end());</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    RetainedNodesVec.push_back(FrameDIVar);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    SubProgram-&gt;replaceOperandWith(</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        7, (<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">MDTuple::get</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext(), RetainedNodesVec)));</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  DBuilder.insertDeclare(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>, FrameDIVar,</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                         DBuilder.<a class="code" href="classllvm_1_1DIBuilder.html#a8f92de2ab37d7999e6fcd53381306586">createExpression</a>(), DILoc,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                         Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>());</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">// Build a struct that will keep state for an active coroutine.</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">//   struct f.frame {</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">//     ResumeFnTy ResumeFnAddr;</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">//     ResumeFnTy DestroyFnAddr;</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">//     int ResumeIndex;</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">//     ... promise (if present) ...</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">//     ... spills ...</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">//   };</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a7fb33159070b72dbab672431dd656a3d"> 1268</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1StructType.html">StructType</a> *<a class="code" href="CoroFrame_8cpp.html#a7fb33159070b72dbab672431dd656a3d">buildFrameType</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                                  FrameDataInfo &amp;FrameData) {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getDataLayout();</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <a class="code" href="classllvm_1_1StructType.html">StructType</a> *FrameTy = [&amp;] {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;32&gt;</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName());</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>.append(<span class="stringliteral">&quot;.Frame&quot;</span>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">return</span> StructType::create(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  }();</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="comment">// We will use this value to cap the alignment of spilled values.</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  std::optional&lt;Align&gt; MaxFrameAlignment;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Async)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    MaxFrameAlignment = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a12d93f5ae63381caf2a4ef0fdba3a668">getContextAlignment</a>();</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  FrameTypeBuilder <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, MaxFrameAlignment);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *PromiseAlloca = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#aff44497b1660786285d7908a98f940f5">getPromiseAlloca</a>();</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  std::optional&lt;FieldIDType&gt; SwitchIndexFieldId;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keyword">auto</span> *FramePtrTy = FrameTy-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>();</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keyword">auto</span> *FnTy = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">FunctionType::get</a>(Type::getVoidTy(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>), FramePtrTy,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                   <span class="comment">/*IsVarArg=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keyword">auto</span> *FnPtrTy = FnTy-&gt;getPointerTo();</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">// Add header fields for the resume and destroy functions.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">// We can rely on these being perfectly packed.</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    (void)<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.addField(FnPtrTy, std::nullopt, <span class="comment">/*header*/</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    (void)<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.addField(FnPtrTy, std::nullopt, <span class="comment">/*header*/</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">// PromiseAlloca field needs to be explicitly added here because it&#39;s</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">// a header field with a fixed offset based on its alignment. Hence it</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">// needs special handling and cannot be added to FrameData.Allocas.</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">if</span> (PromiseAlloca)</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      FrameData.setFieldIndex(</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;          PromiseAlloca, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.addFieldForAlloca(PromiseAlloca, <span class="comment">/*header*/</span> <span class="keyword">true</span>));</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">// Add a field to store the suspend index.  This doesn&#39;t need to</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">// be in the header.</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordtype">unsigned</span> IndexBits = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(1U, <a class="code" href="namespacellvm.html#a238ef12f09938dac4efe5ca56dc125d9">Log2_64_Ceil</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size()));</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IndexType = Type::getIntNTy(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, IndexBits);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    SwitchIndexFieldId = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.addField(IndexType, std::nullopt);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PromiseAlloca == <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;lowering doesn&#39;t support promises&quot;</span>);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160; </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="comment">// Because multiple allocas may own the same field slot,</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="comment">// we add allocas to field here.</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.addFieldForAllocas(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, FrameData, Shape);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="comment">// Add PromiseAlloca to Allocas list so that</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="comment">// 1. updateLayoutIndex could update its index after</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="comment">// `performOptimizedStructLayout`</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="comment">// 2. it is processed in insertSpills.</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch &amp;&amp; PromiseAlloca)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">// We assume that the promise alloca won&#39;t be modified before</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// CoroBegin and no alias will be create before CoroBegin.</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    FrameData.Allocas.emplace_back(</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        PromiseAlloca, <a class="code" href="classllvm_1_1DenseMap.html">DenseMap</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, std::optional&lt;APInt&gt;&gt;{}, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="comment">// Create an entry for every spilled value.</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : FrameData.Spills) {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *FieldType = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.first-&gt;getType();</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">// For byval arguments, we need to store the pointed value in the frame,</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">// instead of the pointer itself.</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Argument.html">Argument</a> *<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> = dyn_cast&lt;Argument&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.first))</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>-&gt;hasByValAttr())</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        FieldType = <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>-&gt;getParamByValType();</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    FieldIDType <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.addField(FieldType, std::nullopt, <span class="keyword">false</span> <span class="comment">/*header*/</span>,</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                <span class="keyword">true</span> <span class="comment">/*IsSpillOfValue*/</span>);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    FrameData.setFieldIndex(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.first, <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.finish(FrameTy);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  FrameData.updateLayoutIndex(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getStructAlign();</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">FrameSize</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getStructSize();</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <span class="keywordflow">switch</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="keywordflow">case</span> coro::ABI::Switch: {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">// In the switch ABI, remember the switch-index field.</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keyword">auto</span> IndexField = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getLayoutField(*SwitchIndexFieldId);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a1640d3af02b4a49eaa3422920056bb6d">IndexField</a> = IndexField.LayoutFieldIndex;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a9d132e5f83821984ce6d37cb38a99c24">IndexAlign</a> = IndexField.Alignment.value();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a1d3459ac1d0c3c498b3a522fbdcb0e7b">IndexOffset</a> = IndexField.Offset;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">// Also round the frame size up to a multiple of its alignment, as is</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">// generally expected in C/C++.</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">FrameSize</a> = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a96bc92416c8a38a3c4a275b9e6c0beca">alignTo</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">FrameSize</a>, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="comment">// In the retcon ABI, remember whether the frame is inline in the storage.</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">case</span> coro::ABI::RetconOnce: {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a> = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a9b0a5f4e8a04c6ddea8e243dcff69c54">getRetconCoroId</a>();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">IsFrameInlineInStorage</a></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      = (<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getStructSize() &lt;= <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>-&gt;getStorageSize() &amp;&amp;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;         <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getStructAlign() &lt;= <a class="code" href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">Id</a>-&gt;getStorageAlignment());</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keywordflow">case</span> coro::ABI::Async: {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a257b93881a8ca56ed33f4326672b738d">FrameOffset</a> =</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a96bc92416c8a38a3c4a275b9e6c0beca">alignTo</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a3bf2569bd6f6975476d99b67f036a0e7">ContextHeaderSize</a>, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">// Also make the final context size a multiple of the context alignment to</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">// make allocation easier for allocators.</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a6b353e50aa2fb0fadf3c46ad81a28e00">ContextSize</a> =</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a96bc92416c8a38a3c4a275b9e6c0beca">alignTo</a>(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a257b93881a8ca56ed33f4326672b738d">FrameOffset</a> + Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">FrameSize</a>,</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a12d93f5ae63381caf2a4ef0fdba3a668">getContextAlignment</a>());</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">AsyncLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a12d93f5ae63381caf2a4ef0fdba3a668">getContextAlignment</a>() &lt; Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;          <span class="stringliteral">&quot;The alignment requirment of frame variables cannot be higher than &quot;</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;          <span class="stringliteral">&quot;the alignment of the async function context&quot;</span>);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keywordflow">return</span> FrameTy;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;}</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">// We use a pointer use visitor to track how an alloca is being used.</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">// The goal is to be able to answer the following three questions:</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">// 1. Should this alloca be allocated on the frame instead.</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">// 2. Could the content of the alloca be modified prior to CoroBegn, which would</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">// require copying the data from alloca to the frame after CoroBegin.</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">// 3. Is there any alias created for this alloca prior to CoroBegin, but used</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">// after CoroBegin. In that case, we will need to recreate the alias after</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">// CoroBegin based off the frame. To answer question 1, we track two things:</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">//   a. List of all BasicBlocks that use this alloca or any of the aliases of</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">//   the alloca. In the end, we check if there exists any two basic blocks that</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">//   cross suspension points. If so, this alloca must be put on the frame. b.</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">//   Whether the alloca or any alias of the alloca is escaped at some point,</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">//   either by storing the address somewhere, or the address is used in a</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">//   function call that might capture. If it&#39;s ever escaped, this alloca must be</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">//   put on the frame conservatively.</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">// To answer quetion 2, we track through the variable MayWriteBeforeCoroBegin.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">// Whenever a potential write happens, either through a store instruction, a</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">// function call or any of the memory intrinsics, we check whether this</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">// instruction is prior to CoroBegin. To answer question 3, we track the offsets</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">// of all aliases created for the alloca prior to CoroBegin but used after</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">// CoroBegin. std::optional is used to be able to represent the case when the</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">// offset is unknown (e.g. when you have a PHINode that takes in different</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">// offset values). We cannot handle unknown offsets and will assert. This is the</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">// potential issue left out. An ideal solution would likely require a</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">// significant redesign.</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="keyword">struct </span>AllocaUseVisitor : <a class="code" href="classllvm_1_1PtrUseVisitor.html">PtrUseVisitor</a>&lt;AllocaUseVisitor&gt; {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = <a class="code" href="classllvm_1_1PtrUseVisitor.html">PtrUseVisitor&lt;AllocaUseVisitor&gt;</a>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  AllocaUseVisitor(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT,</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classllvm_1_1CoroBeginInst.html">CoroBeginInst</a> &amp;CB, <span class="keyword">const</span> SuspendCrossingInfo &amp;Checker,</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                   <span class="keywordtype">bool</span> ShouldUseLifetimeStartInfo)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      : <a class="code" href="classllvm_1_1PtrUseVisitor.html">PtrUseVisitor</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), DT(DT), CoroBegin(CB), Checker(Checker),</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        ShouldUseLifetimeStartInfo(ShouldUseLifetimeStartInfo) {}</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1InstVisitor.html#a6352e72d11377a9c62f24434ae869bf0">visit</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>.insert(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <a class="code" href="classllvm_1_1InstVisitor.html#a6352e72d11377a9c62f24434ae869bf0">Base::visit</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">// If the pointer is escaped prior to CoroBegin, we have to assume it would</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="comment">// be written into before CoroBegin as well.</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (PI.isEscaped() &amp;&amp; !DT.dominates(&amp;CoroBegin, PI.getEscapingInst())) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      MayWriteBeforeCoroBegin = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">// We need to provide this overload as PtrUseVisitor uses a pointer based</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">// visiting function.</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1InstVisitor.html#a6352e72d11377a9c62f24434ae869bf0">visit</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) { <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InstVisitor.html#a6352e72d11377a9c62f24434ae869bf0">visit</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1InstVisitor.html#a6b5f364cdf10081c74343b149fbc325f">visitPHINode</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <a class="code" href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#a23aaa9f9a2d1e401b969c7395929fd1e">enqueueUsers</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    handleAlias(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1InstVisitor.html#aeb67eff747cfcdb17ca1079aff8ed9ca">visitSelectInst</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <a class="code" href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#a23aaa9f9a2d1e401b969c7395929fd1e">enqueueUsers</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    handleAlias(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html#ac6692a6fe0bccaaa2867a7b3c60c4a71">visitStoreInst</a>(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// Regardless whether the alias of the alloca is the value operand or the</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">// pointer operand, we need to assume the alloca is been written.</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    handleMayWrite(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getValueOperand() != U-&gt;get())</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">// We are storing the pointer into a memory location, potentially escaping.</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">// As an optimization, we try to detect simple cases where it doesn&#39;t</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="comment">// actually escape, for example:</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">//   %ptr = alloca ..</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">//   %addr = alloca ..</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">//   store %ptr, %addr</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="comment">//   %x = load %addr</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">//   ..</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">// If %addr is only used by loading from it, we could simply treat %x as</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">// another alias of %ptr, and not considering %ptr being escaped.</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keyword">auto</span> IsSimpleStoreThenLoad = [&amp;]() {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keyword">auto</span> *AI = dyn_cast&lt;AllocaInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getPointerOperand());</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="comment">// If the memory location we are storing to is not an alloca, it</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="comment">// could be an alias of some other memory locations, which is difficult</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="comment">// to analyze.</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordflow">if</span> (!AI)</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="comment">// StoreAliases contains aliases of the memory location stored into.</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> StoreAliases = {AI};</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordflow">while</span> (!StoreAliases.empty()) {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = StoreAliases.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users()) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          <span class="comment">// If we are loading from the memory location, we are creating an</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <span class="comment">// alias of the original pointer.</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(U)) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <a class="code" href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#a23aaa9f9a2d1e401b969c7395929fd1e">enqueueUsers</a>(*LI);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            handleAlias(*LI);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          <span class="comment">// If we are overriding the memory location, the pointer certainly</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          <span class="comment">// won&#39;t escape.</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = dyn_cast&lt;StoreInst&gt;(U))</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getPointerOperand() == <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(U))</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            <span class="keywordflow">if</span> (II-&gt;isLifetimeStartOrEnd())</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          <span class="comment">// BitCastInst creats aliases of the memory location being stored</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;          <span class="comment">// into.</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *BI = dyn_cast&lt;BitCastInst&gt;(U)) {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            StoreAliases.push_back(BI);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    };</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">if</span> (!IsSimpleStoreThenLoad())</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      PI.setEscaped(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">// All mem intrinsics modify the data.</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html#af177474d916756cfc8dac87397fc08c6">visitMemIntrinsic</a>(<a class="code" href="classllvm_1_1MemIntrinsic.html">MemIntrinsic</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) { handleMayWrite(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>); }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html#ab5c883233fb1eca9c18759fb49863a6e">visitBitCastInst</a>(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;BC) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <a class="code" href="classllvm_1_1InstVisitor.html#a5b052a3578e5c55ba04a8e8e87d7d584">Base::visitBitCastInst</a>(BC);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    handleAlias(BC);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html#aa7dac4f1adefec91c970ee7a0463dafb">visitAddrSpaceCastInst</a>(<a class="code" href="classllvm_1_1AddrSpaceCastInst.html">AddrSpaceCastInst</a> &amp;ASC) {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <a class="code" href="classllvm_1_1InstVisitor.html#ab39b720f77593cfa9c056431b6bc3714">Base::visitAddrSpaceCastInst</a>(ASC);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    handleAlias(ASC);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html#a9481f3ebdbe940c0b6fe67d1fe0e45a2">visitGetElementPtrInst</a>(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;GEPI) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">// The base visitor will adjust Offset accordingly.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <a class="code" href="classllvm_1_1InstVisitor.html#aefd0a9d7224ad6eb0a24c20197c5dc53">Base::visitGetElementPtrInst</a>(GEPI);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    handleAlias(GEPI);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  }</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html#adce253af48185f52c4b9d2e0088fd13e">visitIntrinsicInst</a>(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="comment">// When we found the lifetime markers refers to a</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="comment">// subrange of the original alloca, ignore the lifetime</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">// markers to avoid misleading the analysis.</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() != Intrinsic::lifetime_start || !IsOffsetKnown ||</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        !<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>.isZero())</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1InstVisitor.html#a432d533de0923ad3b0fd6dfc22c7ebd6">Base::visitIntrinsicInst</a>(II);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    LifetimeStarts.insert(&amp;II);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html#a1320c1780d4b96711e44c8bb2735fe86">visitCallBase</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = 0, OpCount = CB.<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>(); <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> &lt; OpCount; ++<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="keywordflow">if</span> (U-&gt;get() == CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>) &amp;&amp; !CB.<a class="code" href="classllvm_1_1CallBase.html#a27ab264aa1e655ed42732fe0ec40d441">doesNotCapture</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>))</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        PI.setEscaped(&amp;CB);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    handleMayWrite(CB);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  }</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keywordtype">bool</span> getShouldLiveOnFrame()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">if</span> (!ShouldLiveOnFrame)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      ShouldLiveOnFrame = computeShouldLiveOnFrame();</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">return</span> *ShouldLiveOnFrame;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="keywordtype">bool</span> getMayWriteBeforeCoroBegin()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> MayWriteBeforeCoroBegin; }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, std::optional&lt;APInt&gt;</a>&gt; getAliasesCopy()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(getShouldLiveOnFrame() &amp;&amp; <span class="stringliteral">&quot;This method should only be called if the &quot;</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                     <span class="stringliteral">&quot;alloca needs to live on the frame.&quot;</span>);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : AliasOffetMap)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.second)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(<span class="stringliteral">&quot;Unable to handle an alias with unknown offset &quot;</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                           <span class="stringliteral">&quot;created before CoroBegin.&quot;</span>);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">return</span> AliasOffetMap;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1CoroBeginInst.html">CoroBeginInst</a> &amp;CoroBegin;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keyword">const</span> SuspendCrossingInfo &amp;Checker;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="comment">// All alias to the original AllocaInst, created before CoroBegin and used</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="comment">// after CoroBegin. Each entry contains the instruction and the offset in the</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="comment">// original Alloca. They need to be recreated after CoroBegin off the frame.</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Instruction *, std::optional&lt;APInt&gt;</a>&gt; AliasOffetMap{};</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>{};</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;IntrinsicInst *, 2&gt;</a> LifetimeStarts{};</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordtype">bool</span> MayWriteBeforeCoroBegin{<span class="keyword">false</span>};</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordtype">bool</span> ShouldUseLifetimeStartInfo{<span class="keyword">true</span>};</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keyword">mutable</span> std::optional&lt;bool&gt; ShouldLiveOnFrame{};</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordtype">bool</span> computeShouldLiveOnFrame()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">// If lifetime information is available, we check it first since it&#39;s</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">// more precise. We look at every pair of lifetime.start intrinsic and</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="comment">// every basic block that uses the pointer to see if they cross suspension</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="comment">// points. The uses cover both direct uses as well as indirect uses.</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">if</span> (ShouldUseLifetimeStartInfo &amp;&amp; !LifetimeStarts.empty()) {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : LifetimeStarts)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;          <span class="keywordflow">if</span> (Checker.isDefinitionAcrossSuspend(*<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <span class="comment">// Addresses are guaranteed to be identical after every lifetime.start so</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="comment">// we cannot use the local stack if the address escaped and there is a</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="comment">// suspend point between lifetime markers. This should also cover the</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="comment">// case of a single lifetime.start intrinsic in a loop with suspend point.</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordflow">if</span> (PI.isEscaped()) {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : LifetimeStarts) {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> : LifetimeStarts) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            <span class="keywordflow">if</span> (Checker.hasPathOrLoopCrossingSuspendPoint(<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>-&gt;getParent(),</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                                          <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>-&gt;getParent()))</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;          }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    }</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">// FIXME: Ideally the isEscaped check should come at the beginning.</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">// However there are a few loose ends that need to be fixed first before</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">// we can do that. We need to make sure we are not over-conservative, so</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">// that the data accessed in-between await_suspend and symmetric transfer</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">// is always put on the stack, and also data accessed after coro.end is</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="comment">// always put on the stack (esp the return object). To fix that, we need</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="comment">// to:</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">//  1) Potentially treat sret as nocapture in calls</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">//  2) Special handle the return object and put it on the stack</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">//  3) Utilize lifetime.end intrinsic</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">if</span> (PI.isEscaped())</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U1 : <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U2 : <a class="code" href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">if</span> (Checker.isDefinitionAcrossSuspend(*U1, U2))</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keywordtype">void</span> handleMayWrite(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">if</span> (!DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(&amp;CoroBegin, &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      MayWriteBeforeCoroBegin = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="keywordtype">bool</span> usedAfterCoroBegin(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.uses())</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      <span class="keywordflow">if</span> (DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(&amp;CoroBegin, U))</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="keywordtype">void</span> handleAlias(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">// We track all aliases created prior to CoroBegin but used after.</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="comment">// These aliases may need to be recreated after CoroBegin if the alloca</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="comment">// need to live on the frame.</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordflow">if</span> (DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(&amp;CoroBegin, &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || !usedAfterCoroBegin(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordflow">if</span> (!IsOffsetKnown) {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      AliasOffetMap[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].reset();</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="keyword">auto</span> Itr = AliasOffetMap.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a153ea412ff7a0ba105111155d1e16128">find</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="keywordflow">if</span> (Itr == AliasOffetMap.end()) {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        AliasOffetMap[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code" href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#a082865790e32a27f3e3adf8db2c556e6">Offset</a>;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Itr-&gt;second &amp;&amp; *Itr-&gt;second != <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>) {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <span class="comment">// If we have seen two different possible values for this alias, we set</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <span class="comment">// it to empty.</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        AliasOffetMap[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].reset();</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    }</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  }</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;};</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">// We need to make room to insert a spill after initial PHIs, but before</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">// catchswitch instruction. Placing it before violates the requirement that</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">// catchswitch, like all other EHPads must be the first nonPHI in a block.</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">// Split away catchswitch into a separate block and insert in its place:</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment">//   cleanuppad &lt;InsertPt&gt; cleanupret.</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">// cleanupret instruction will act as an insert point for the spill.</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a5f0c86e4a93ace9ff013c23b1c1fa1ad"> 1666</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="CoroFrame_8cpp.html#a5f0c86e4a93ace9ff013c23b1c1fa1ad">splitBeforeCatchSwitch</a>(<a class="code" href="classllvm_1_1CatchSwitchInst.html">CatchSwitchInst</a> *CatchSwitch) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CurrentBlock = CatchSwitch-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBlock = CurrentBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(CatchSwitch);</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  CurrentBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keyword">auto</span> *CleanupPad =</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      CleanupPadInst::Create(CatchSwitch-&gt;<a class="code" href="classllvm_1_1CatchSwitchInst.html#ad4cac3f86755263bbdc8291f8254fb95">getParentPad</a>(), {}, <span class="stringliteral">&quot;&quot;</span>, CurrentBlock);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="keyword">auto</span> *CleanupRet =</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      CleanupReturnInst::Create(CleanupPad, NewBlock, CurrentBlock);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keywordflow">return</span> CleanupRet;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;}</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a1833296d8e82f27935a4302e47b60690"> 1678</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a1833296d8e82f27935a4302e47b60690">createFramePtr</a>(<a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keyword">auto</span> *CB = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(CB-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>());</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <a class="code" href="classllvm_1_1StructType.html">StructType</a> *FrameTy = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <a class="code" href="classllvm_1_1PointerType.html">PointerType</a> *FramePtrTy = FrameTy-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>();</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a> =</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      cast&lt;Instruction&gt;(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(CB, FramePtrTy, <span class="stringliteral">&quot;FramePtr&quot;</span>));</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;}</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="comment">// Replace all alloca and SSA values that are accessed across suspend points</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="comment">// with GetElementPointer from coroutine frame + loads and stores. Create an</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">// AllocaSpillBB that will become the new entry block for the resume parts of</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">// the coroutine:</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">//    %hdl = coro.begin(...)</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">//    whatever</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">// becomes:</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">//    %hdl = coro.begin(...)</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment">//    %FramePtr = bitcast i8* hdl to %f.frame*</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">//    br label %AllocaSpillBB</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">//  AllocaSpillBB:</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">//    ; geps corresponding to allocas that were moved to coroutine frame</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">//    br label PostSpill</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">//  PostSpill:</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">//    whatever</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#af0885df5b78cc732639a9d52a87d040e"> 1709</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#af0885df5b78cc732639a9d52a87d040e">insertSpills</a>(<span class="keyword">const</span> FrameDataInfo &amp;FrameData, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keyword">auto</span> *CB = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = CB-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>();</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <a class="code" href="classllvm_1_1StructType.html">StructType</a> *FrameTy = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a> = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">FramePtr</a>;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT(*CB-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>());</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;llvm::Value *, llvm::AllocaInst *, 4&gt;</a> DbgPtrAllocaCache;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="comment">// Create a GEP with the given index into the coroutine frame for the original</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="comment">// value Orig. Appends an extra 0 index for array-allocas, preserving the</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="comment">// original type.</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keyword">auto</span> GetFramePointer = [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> *Orig) -&gt; <a class="code" href="classllvm_1_1Value.html">Value</a> * {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    FieldIDType <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = FrameData.getFieldIndex(Orig);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 3&gt;</a> Indices = {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(Type::getInt32Ty(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>), 0),</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(Type::getInt32Ty(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>), <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>),</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    };</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AI = dyn_cast&lt;AllocaInst&gt;(Orig)) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CI = dyn_cast&lt;ConstantInt&gt;(AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#aaca14fdf6d151782f7ab0a66405453fb">getArraySize</a>())) {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="keyword">auto</span> Count = CI-&gt;getValue().getZExtValue();</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="keywordflow">if</span> (Count &gt; 1) {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;          Indices.push_back(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(Type::getInt32Ty(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>), 0));</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(<span class="stringliteral">&quot;Coroutines cannot handle non static allocas yet&quot;</span>);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keyword">auto</span> <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = cast&lt;GetElementPtrInst&gt;(</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateInBoundsGEP(FrameTy, <a class="code" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, Indices));</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AI = dyn_cast&lt;AllocaInst&gt;(Orig)) {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="keywordflow">if</span> (FrameData.getDynamicAlign(Orig) != 0) {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FrameData.getDynamicAlign(Orig) == AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>().<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>());</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = AI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keyword">auto</span> *IntPtrTy = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDataLayout().getIntPtrType(AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#ac106bea55dfb26f8b14676aac05bd89f">getType</a>());</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="keyword">auto</span> *PtrValue = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePtrToInt(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, IntPtrTy);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="keyword">auto</span> *AlignMask =</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(IntPtrTy, AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>().<a class="code" href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">value</a>() - 1);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        PtrValue = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAdd(PtrValue, AlignMask);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        PtrValue = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAnd(PtrValue, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateNot(AlignMask));</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntToPtr(PtrValue, AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#ac106bea55dfb26f8b14676aac05bd89f">getType</a>());</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="comment">// If the type of GEP is not equal to the type of AllocaInst, it implies</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="comment">// that the AllocaInst may be reused in the Frame slot of other</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="comment">// AllocaInst. So We cast GEP to the AllocaInst here to re-use</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="comment">// the Frame storage.</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="comment">// Note: If we change the strategy dealing with alignment, we need to refine</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="comment">// this casting.</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getType() != Orig-&gt;getType())</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, Orig-&gt;getType(),</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                                     Orig-&gt;getName() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.cast&quot;</span>));</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  };</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : FrameData.Spills) {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a> = <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keyword">auto</span> SpillAlignment = <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(FrameData.getAlign(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>));</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// Create a store instruction storing the value into the</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">// coroutine frame.</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ByValTy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = dyn_cast&lt;Argument&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>)) {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="comment">// For arguments, we will place the store instruction right after</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="comment">// the coroutine frame pointer instruction, i.e. bitcast of</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="comment">// coro.begin from i8* to %f.frame*.</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      InsertPt = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>();</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="comment">// If we&#39;re spilling an Argument, make sure we clear &#39;nocapture&#39;</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <span class="comment">// from the coroutine function.</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getParent()-&gt;removeParamAttr(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getArgNo(), Attribute::NoCapture);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;hasByValAttr())</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        ByValTy = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getParamByValType();</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CSI = dyn_cast&lt;AnyCoroSuspendInst&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>)) {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="comment">// Don&#39;t spill immediately after a suspend; splitting assumes</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="comment">// that the suspend will be followed by a branch.</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      InsertPt = CSI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a79c007dcf9fff57e1569e778d7885b5e">getSingleSuccessor</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>();</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">if</span> (!DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(CB, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="comment">// If it is not dominated by CoroBegin, then spill should be</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="comment">// inserted immediately after CoroFrame is computed.</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        InsertPt = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>();</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;InvokeInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        <span class="comment">// If we are spilling the result of the invoke instruction, split</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="comment">// the normal edge and insert the spill in the new block.</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        <span class="keyword">auto</span> *NewBB = <a class="code" href="namespacellvm.html#adf83581f514774264d616eef5706cf6e">SplitEdge</a>(II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), II-&gt;getNormalDest());</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        InsertPt = NewBB-&gt;getTerminator();</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <span class="comment">// Skip the PHINodes and EH pads instructions.</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *DefBlock = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CSI = dyn_cast&lt;CatchSwitchInst&gt;(DefBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()))</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;          InsertPt = <a class="code" href="CoroFrame_8cpp.html#a5f0c86e4a93ace9ff013c23b1c1fa1ad">splitBeforeCatchSwitch</a>(CSI);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;          InsertPt = &amp;*DefBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>();</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isTerminator() &amp;&amp; <span class="stringliteral">&quot;unexpected terminator&quot;</span>);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="comment">// For all other values, the spill is placed immediately after</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <span class="comment">// the definition.</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        InsertPt = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getNextNode();</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = FrameData.getFieldIndex(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(InsertPt);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateConstInBoundsGEP2_32(</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        FrameTy, <a class="code" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, 0, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>-&gt;getName() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.spill.addr&quot;</span>));</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">if</span> (ByValTy) {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="comment">// For byval arguments, we need to store the pointed value in the frame,</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="comment">// instead of the pointer itself.</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="classllvm_1_1Value.html">Value</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(ByValTy, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlignedStore(<a class="code" href="classllvm_1_1Value.html">Value</a>, <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>, SpillAlignment);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlignedStore(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>, <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>, SpillAlignment);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; </div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CurrentBlock = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *CurrentReload = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.second) {</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      <span class="comment">// If we have not seen the use block, create a load instruction to reload</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <span class="comment">// the spilled value from the coroutine frame. Populates the Value pointer</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      <span class="comment">// reference provided with the frame GEP.</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="keywordflow">if</span> (CurrentBlock != U-&gt;getParent()) {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        CurrentBlock = U-&gt;getParent();</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;*CurrentBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <span class="keyword">auto</span> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = GetFramePointer(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;setName(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first-&gt;getName() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.reload.addr&quot;</span>));</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        <span class="keywordflow">if</span> (ByValTy)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;          CurrentReload = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;          CurrentReload = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlignedLoad(</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;              FrameTy-&gt;<a class="code" href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">getElementType</a>(FrameData.getFieldIndex(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first)), <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>,</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;              SpillAlignment, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first-&gt;getName() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.reload&quot;</span>));</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <a class="code" href="classllvm_1_1TinyPtrVector.html">TinyPtrVector&lt;DbgDeclareInst *&gt;</a> DIs = <a class="code" href="namespacellvm.html#a06ac4fd2f05423f4d1a20a0ac699807c">FindDbgDeclareUses</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgDeclareInst.html">DbgDeclareInst</a> *DDI : DIs) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;          <span class="keywordtype">bool</span> AllowUnresolved = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;          <span class="comment">// This dbg.declare is preserved for all coro-split function</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          <span class="comment">// fragments. It will be unreachable in the main function, and</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;          <span class="comment">// processed by coro::salvageDebugInfo() by CoroCloner.</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;          <a class="code" href="classllvm_1_1DIBuilder.html">DIBuilder</a>(*CurrentBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>(), AllowUnresolved)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;              .insertDeclare(CurrentReload, DDI-&gt;getVariable(),</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                             DDI-&gt;getExpression(), DDI-&gt;getDebugLoc(),</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                             &amp;*<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.GetInsertPoint());</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;          <span class="comment">// This dbg.declare is for the main function entry point.  It</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;          <span class="comment">// will be deleted in all coro-split functions.</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;          <a class="code" href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">coro::salvageDebugInfo</a>(DbgPtrAllocaCache, DDI, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abcad2d8140114b7cd7e686dde240e5b0">OptimizeFrame</a>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="comment">// Salvage debug info on any dbg.addr that we see. We do not insert them</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="comment">// into each block where we have a use though.</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *DI = dyn_cast&lt;DbgAddrIntrinsic&gt;(U)) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <a class="code" href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">coro::salvageDebugInfo</a>(DbgPtrAllocaCache, DI, Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abcad2d8140114b7cd7e686dde240e5b0">OptimizeFrame</a>);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="comment">// If we have a single edge PHINode, remove it and replace it with a</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <span class="comment">// reload from the coroutine frame. (We already took care of multi edge</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="comment">// PHINodes by rewriting them in the rewritePHIs function).</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PN = dyn_cast&lt;PHINode&gt;(U)) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PN-&gt;getNumIncomingValues() == 1 &amp;&amp;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;               <span class="stringliteral">&quot;unexpected number of incoming &quot;</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;               <span class="stringliteral">&quot;values in the PHINode&quot;</span>);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        PN-&gt;replaceAllUsesWith(CurrentReload);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        PN-&gt;eraseFromParent();</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="comment">// Replace all uses of CurrentValue in the current instruction with</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="comment">// reload.</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      U-&gt;<a class="code" href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">replaceUsesOfWith</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>, CurrentReload);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FramePtrBB = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="keyword">auto</span> SpillBlock = FramePtrBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>(), <span class="stringliteral">&quot;AllocaSpillBB&quot;</span>);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  SpillBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(&amp;SpillBlock-&gt;front(), <span class="stringliteral">&quot;PostSpill&quot;</span>);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae3a9a76ce45cff6c0385091993bccdcc">AllocaSpillBlock</a> = SpillBlock;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="comment">// retcon and retcon.once lowering assumes all uses have been sunk.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Retcon || Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::RetconOnce ||</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Async) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="comment">// If we found any allocas, replace all of their remaining uses with Geps.</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;SpillBlock-&gt;front());</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : FrameData.Allocas) {</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.Alloca;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a> = GetFramePointer(Alloca);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="comment">// We are not using ReplaceInstWithInst(P.first, cast&lt;Instruction&gt;(G))</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="comment">// here, as we are changing location of the instruction.</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>-&gt;takeName(Alloca);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      Alloca-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      Alloca-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    }</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <span class="comment">// If we found any alloca, replace all of their remaining uses with GEP</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="comment">// instructions. To remain debugbility, we replace the uses of allocas for</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <span class="comment">// dbg.declares and dbg.values with the reload from the frame.</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="comment">// Note: We cannot replace the alloca with GEP instructions indiscriminately,</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="comment">// as some of the uses may not be dominated by CoroBegin.</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae3a9a76ce45cff6c0385091993bccdcc">AllocaSpillBlock</a>-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> UsersToUpdate;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : FrameData.Allocas) {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca = <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    UsersToUpdate.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : Alloca-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <span class="keywordflow">if</span> (DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(CB, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        UsersToUpdate.push_back(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    }</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordflow">if</span> (UsersToUpdate.empty())</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a> = GetFramePointer(Alloca);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>-&gt;setName(Alloca-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.reload.addr&quot;</span>));</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DbgVariableIntrinsic *, 4&gt;</a> DIs;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <a class="code" href="namespacellvm.html#a683448397460b5b16e0d9016fd7a273a">findDbgUsers</a>(DIs, Alloca);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DVI : DIs)</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      DVI-&gt;replaceUsesOfWith(Alloca, <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : UsersToUpdate) {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="comment">// It is meaningless to remain the lifetime intrinsics refer for the</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="comment">// member of coroutine frames and the meaningless lifetime intrinsics</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="comment">// are possible to block further optimizations.</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isLifetimeStartOrEnd())</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;replaceUsesOfWith(Alloca, <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>());</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : FrameData.Allocas) {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca = <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Alloca;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.MayWriteBeforeCoroBegin) {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="comment">// isEscaped really means potentially modified before CoroBegin.</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keywordflow">if</span> (Alloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#aea74164514e7164813ab30bcc4b7c557">isArrayAllocation</a>())</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <span class="stringliteral">&quot;Coroutines cannot handle copying of array allocas yet&quot;</span>);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a> = GetFramePointer(Alloca);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="classllvm_1_1Value.html">Value</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(Alloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), Alloca);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(<a class="code" href="classllvm_1_1Value.html">Value</a>, <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="comment">// For each alias to Alloca created before CoroBegin but used after</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">// CoroBegin, we recreate them after CoroBegin by appplying the offset</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="comment">// to the pointer in the frame.</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Alias : <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.Aliases) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a> = GetFramePointer(Alloca);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <span class="keyword">auto</span> *FramePtrRaw =</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(<a class="code" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, Type::getInt8PtrTy(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>));</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="classllvm_1_1Value.html">Value</a> = *Alias.second;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <span class="keyword">auto</span> ITy = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">IntegerType::get</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="classllvm_1_1Value.html">Value</a>.getBitWidth());</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <span class="keyword">auto</span> *AliasPtr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateGEP(Type::getInt8Ty(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>), FramePtrRaw,</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                                         <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(ITy, <a class="code" href="classllvm_1_1Value.html">Value</a>));</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keyword">auto</span> *AliasPtrTyped =</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(AliasPtr, Alias.first-&gt;getType());</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      Alias.first-&gt;replaceUsesWithIf(</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;          AliasPtrTyped, [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) { <span class="keywordflow">return</span> DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(CB, U); });</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="comment">// PromiseAlloca is not collected in FrameData.Allocas. So we don&#39;t handle</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="comment">// the case that the PromiseAlloca may have writes before CoroBegin in the</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="comment">// above codes. And it may be problematic in edge cases. See</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="comment">// https://github.com/llvm/llvm-project/issues/57861 for an example.</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch &amp;&amp; Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a6af0b7b0e5d0e8f4b8b4f4199a885204">PromiseAlloca</a>) {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *PA = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a6af0b7b0e5d0e8f4b8b4f4199a885204">PromiseAlloca</a>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="comment">// If there is memory accessing to promise alloca before CoroBegin;</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordtype">bool</span> HasAccessingPromiseBeforeCB = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a>(PA-&gt;<a class="code" href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">uses</a>(), [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      auto *Inst = dyn_cast&lt;Instruction&gt;(U.getUser());</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      if (!Inst || DT.dominates(CB, Inst))</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        return false;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      if (auto *CI = dyn_cast&lt;CallInst&gt;(Inst)) {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <span class="comment">// It is fine if the call wouldn&#39;t write to the Promise.</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="comment">// This is possible for @llvm.coro.id intrinsics, which</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="comment">// would take the promise as the second argument as a</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="comment">// marker.</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        if (CI-&gt;onlyReadsMemory() ||</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            CI-&gt;onlyReadsMemory(CI-&gt;getArgOperandNo(&amp;U)))</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;          return false;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        return true;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keywordflow">return</span> isa&lt;StoreInst&gt;(Inst) ||</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;             <span class="comment">// It may take too much time to track the uses.</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;             <span class="comment">// Be conservative about the case the use may escape.</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;             isa&lt;GetElementPtrInst&gt;(Inst) ||</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;             <span class="comment">// There would always be a bitcast for the promise alloca</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;             <span class="comment">// before we enabled Opaque pointers. And now given</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;             <span class="comment">// opaque pointers are enabled by default. This should be</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;             <span class="comment">// fine.</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;             isa&lt;BitCastInst&gt;(Inst);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    });</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="keywordflow">if</span> (HasAccessingPromiseBeforeCB) {</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">getInsertPtAfterFramePtr</a>());</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a> = GetFramePointer(PA);</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="classllvm_1_1Value.html">Value</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(PA-&gt;getAllocatedType(), PA);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(<a class="code" href="classllvm_1_1Value.html">Value</a>, <a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;}</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">// Moves the values in the PHIs in SuccBB that correspong to PredBB into a new</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">// PHI in InsertedBB.</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a642ec4238f02650fc1e70d5b4ac8d844"> 2023</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a642ec4238f02650fc1e70d5b4ac8d844">movePHIValuesToInsertedBlock</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SuccBB,</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                                         <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InsertedBB,</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                                         <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *PredBB,</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                                         <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *UntilPHI = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="keyword">auto</span> *PN = cast&lt;PHINode&gt;(&amp;SuccBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = PN-&gt;getBasicBlockIndex(InsertedBB);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = PN-&gt;getIncomingValue(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *InputV = PHINode::Create(</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 1, V-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.&quot;</span>) + SuccBB-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>(),</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        &amp;InsertedBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">front</a>());</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    InputV-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(V, PredBB);</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    PN-&gt;setIncomingValue(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, InputV);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    PN = dyn_cast&lt;PHINode&gt;(PN-&gt;getNextNode());</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  } <span class="keywordflow">while</span> (PN != UntilPHI);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;}</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">// Rewrites the PHI Nodes in a cleanuppad.</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ab9fcdedd3580f924cf782f155b549a22"> 2041</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#ab9fcdedd3580f924cf782f155b549a22">rewritePHIsForCleanupPad</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *CleanupPadBB,</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                                     <a class="code" href="classllvm_1_1CleanupPadInst.html">CleanupPadInst</a> *CleanupPad) {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="comment">// For every incoming edge to a CleanupPad we will create a new block holding</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="comment">// all incoming values in single-value PHI nodes. We will then create another</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">// block to act as a dispather (as all unwind edges for related EH blocks</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="comment">// must be the same).</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="comment">// cleanuppad:</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <span class="comment">//    %2 = phi i32[%0, %catchswitch], [%1, %catch.1]</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="comment">//    %3 = cleanuppad within none []</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="comment">// It will create:</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="comment">// cleanuppad.corodispatch</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">//    %2 = phi i8[0, %catchswitch], [1, %catch.1]</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="comment">//    %3 = cleanuppad within none []</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">//    switch i8 % 2, label %unreachable</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="comment">//            [i8 0, label %cleanuppad.from.catchswitch</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="comment">//             i8 1, label %cleanuppad.from.catch.1]</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">// cleanuppad.from.catchswitch:</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="comment">//    %4 = phi i32 [%0, %catchswitch]</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  <span class="comment">//    br %label cleanuppad</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="comment">// cleanuppad.from.catch.1:</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="comment">//    %6 = phi i32 [%1, %catch.1]</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="comment">//    br %label cleanuppad</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="comment">// cleanuppad:</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <span class="comment">//    %8 = phi i32 [%4, %cleanuppad.from.catchswitch],</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="comment">//                 [%6, %cleanuppad.from.catch.1]</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="comment">// Unreachable BB, in case switching on an invalid value in the dispatcher.</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <span class="keyword">auto</span> *UnreachBB = BasicBlock::Create(</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      CleanupPadBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), <span class="stringliteral">&quot;unreachable&quot;</span>, CleanupPadBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>());</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(UnreachBB);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateUnreachable();</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="comment">// Create a new cleanuppad which will be the dispatcher.</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keyword">auto</span> *NewCleanupPadBB =</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      BasicBlock::Create(CleanupPadBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(),</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                         CleanupPadBB-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.corodispatch&quot;</span>),</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                         CleanupPadBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>(), CleanupPadBB);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(NewCleanupPadBB);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keyword">auto</span> *SwitchType = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8Ty();</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="keyword">auto</span> *SetDispatchValuePN =</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePHI(SwitchType, <a class="code" href="namespacellvm.html#ae6d1c31d74bbaaa9e42bcbdc10a499f2">pred_size</a>(CleanupPadBB));</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  CleanupPad-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0fd53f63d349dc8a7c5fc0cdd7a94c8d">removeFromParent</a>();</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  CleanupPad-&gt;<a class="code" href="classllvm_1_1Instruction.html#af09e4096de244d2fb345891328714a63">insertAfter</a>(SetDispatchValuePN);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <span class="keyword">auto</span> *SwitchOnDispatch = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSwitch(SetDispatchValuePN, UnreachBB,</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                                                <a class="code" href="namespacellvm.html#ae6d1c31d74bbaaa9e42bcbdc10a499f2">pred_size</a>(CleanupPadBB));</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordtype">int</span> SwitchIndex = 0;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> Preds(<a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(CleanupPadBB));</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : Preds) {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="comment">// Create a new cleanuppad and move the PHI values to there.</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keyword">auto</span> *CaseBB = BasicBlock::Create(CleanupPadBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(),</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                                      CleanupPadBB-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() +</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                                          <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.from.&quot;</span>) + Pred-&gt;getName(),</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                                      CleanupPadBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>(), CleanupPadBB);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <a class="code" href="namespacellvm.html#ac1ced98ffeb2b6991821751661b136d6">updatePhiNodes</a>(CleanupPadBB, Pred, CaseBB);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    CaseBB-&gt;setName(CleanupPadBB-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.from.&quot;</span>) +</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                    Pred-&gt;getName());</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(CaseBB);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBr(CleanupPadBB);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a642ec4238f02650fc1e70d5b4ac8d844">movePHIValuesToInsertedBlock</a>(CleanupPadBB, CaseBB, NewCleanupPadBB);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="comment">// Update this Pred to the new unwind point.</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <a class="code" href="namespacellvm.html#ae2c2758db51113863d0114f08c4b482a">setUnwindEdgeTo</a>(Pred-&gt;getTerminator(), NewCleanupPadBB);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="comment">// Setup the switch in the dispatcher.</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="keyword">auto</span> *SwitchConstant = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(SwitchType, SwitchIndex);</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    SetDispatchValuePN-&gt;addIncoming(SwitchConstant, Pred);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    SwitchOnDispatch-&gt;addCase(SwitchConstant, CaseBB);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    SwitchIndex++;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  }</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;}</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; </div>
<div class="line"><a name="l02116"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a03cdd58b24dc91b4e3819e218a399cbf"> 2116</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a03cdd58b24dc91b4e3819e218a399cbf">cleanupSinglePredPHIs</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 32&gt;</a> Worklist;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Phi : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.phis()) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      <span class="keywordflow">if</span> (Phi.getNumIncomingValues() == 1) {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        Worklist.push_back(&amp;Phi);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keyword">auto</span> *Phi = Worklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keyword">auto</span> *OriginalValue = Phi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    Phi-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(OriginalValue);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;}</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; </div>
<div class="line"><a name="l02133"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a5a93b5fcf433128b2fd9d563792eb4cd"> 2133</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a5a93b5fcf433128b2fd9d563792eb4cd">rewritePHIs</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="comment">// For every incoming edge we will create a block holding all</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="comment">// incoming values in a single PHI nodes.</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="comment">// loop:</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="comment">//    %n.val = phi i32[%n, %entry], [%inc, %loop]</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="comment">// It will create:</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="comment">// loop.from.entry:</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="comment">//    %n.loop.pre = phi i32 [%n, %entry]</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="comment">//    br %label loop</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="comment">// loop.from.loop:</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="comment">//    %inc.loop.pre = phi i32 [%inc, %loop]</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="comment">//    br %label loop</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <span class="comment">// After this rewrite, further analysis will ignore any phi nodes with more</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="comment">// than one incoming edge.</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="comment">// TODO: Simplify PHINodes in the basic block to remove duplicate</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <span class="comment">// predecessors.</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="comment">// Special case for CleanupPad: all EH blocks must have the same unwind edge</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="comment">// so we need to create an additional &quot;dispatcher&quot; block.</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CleanupPad =</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;          dyn_cast_or_null&lt;CleanupPadInst&gt;(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getFirstNonPHI())) {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> Preds(<a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>));</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : Preds) {</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CatchSwitchInst.html">CatchSwitchInst</a> *CS =</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;              dyn_cast&lt;CatchSwitchInst&gt;(Pred-&gt;getTerminator())) {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        <span class="comment">// CleanupPad with a CatchSwitch predecessor: therefore this is an</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        <span class="comment">// unwind destination that needs to be handle specially.</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CS-&gt;getUnwindDest() == &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        (void)CS;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;        <a class="code" href="CoroFrame_8cpp.html#ab9fcdedd3580f924cf782f155b549a22">rewritePHIsForCleanupPad</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, CleanupPad);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      }</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <a class="code" href="classllvm_1_1LandingPadInst.html">LandingPadInst</a> *LandingPad = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *ReplPHI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="keywordflow">if</span> ((LandingPad = dyn_cast_or_null&lt;LandingPadInst&gt;(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getFirstNonPHI()))) {</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="comment">// ehAwareSplitEdge will clone the LandingPad in all the edge blocks.</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">// We replace the original landing pad with a PHINode that will collect the</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">// results from all of them.</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    ReplPHI = PHINode::Create(LandingPad-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 1, <span class="stringliteral">&quot;&quot;</span>, LandingPad);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    ReplPHI-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(LandingPad);</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    LandingPad-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(ReplPHI);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// We will erase the original landing pad at the end of this function after</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">// ehAwareSplitEdge cloned it in the transition blocks.</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> Preds(<a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>));</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : Preds) {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keyword">auto</span> *IncomingBB = <a class="code" href="namespacellvm.html#a833a6084a93d5900e8bdd493b37bbbc7">ehAwareSplitEdge</a>(Pred, &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, LandingPad, ReplPHI);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    IncomingBB-&gt;setName(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getName() + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.from.&quot;</span>) + Pred-&gt;getName());</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="comment">// Stop the moving of values at ReplPHI, as this is either null or the PHI</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="comment">// that replaced the landing pad.</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a642ec4238f02650fc1e70d5b4ac8d844">movePHIValuesToInsertedBlock</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, IncomingBB, Pred, ReplPHI);</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  }</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="keywordflow">if</span> (LandingPad) {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="comment">// Calls to ehAwareSplitEdge function cloned the original lading pad.</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="comment">// No longer need it.</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    LandingPad-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;}</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a0647ca6021ca57224016effde79d4d7e"> 2203</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a5a93b5fcf433128b2fd9d563792eb4cd">rewritePHIs</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> WorkList;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; </div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PN = dyn_cast&lt;PHINode&gt;(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.front()))</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      <span class="keywordflow">if</span> (PN-&gt;getNumIncomingValues() &gt; 1)</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        WorkList.push_back(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : WorkList)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a5a93b5fcf433128b2fd9d563792eb4cd">rewritePHIs</a>(*<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;}</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="comment">/// Default materializable callback</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="comment"></span><span class="comment">// Check for instructions that we can recreate on resume as opposed to spill</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="comment">// the result into a coroutine frame.</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"><a class="line" href="namespacellvm_1_1coro.html#a53b686b78ff6f0eedd7d4d5a6bdd22bb"> 2218</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1coro.html#a53b686b78ff6f0eedd7d4d5a6bdd22bb">coro::defaultMaterializable</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;V) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <span class="keywordflow">return</span> (isa&lt;CastInst&gt;(&amp;V) || isa&lt;GetElementPtrInst&gt;(&amp;V) ||</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;          isa&lt;BinaryOperator&gt;(&amp;V) || isa&lt;CmpInst&gt;(&amp;V) || isa&lt;SelectInst&gt;(&amp;V));</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;}</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">// Check for structural coroutine intrinsics that should not be spilled into</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment">// the coroutine frame.</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a0c7538ac13a28b2830b46b272c7ccfd4"> 2225</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroFrame_8cpp.html#a0c7538ac13a28b2830b46b272c7ccfd4">isCoroutineStructureIntrinsic</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="keywordflow">return</span> isa&lt;CoroIdInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;CoroSaveInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) ||</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;         isa&lt;CoroSuspendInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;}</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">// For each instruction identified as materializable across the suspend point,</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">// and its associated DAG of other rematerializable instructions,</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">// recreate the DAG of instructions after the suspend point.</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#aba618c16a34739af0506ba1082d209a3"> 2233</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#aba618c16a34739af0506ba1082d209a3">rewriteMaterializableInstructions</a>(</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keyword">const</span> <a class="code" href="structllvm_1_1SmallMapVector.html">SmallMapVector</a>&lt;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, std::unique_ptr&lt;RematGraph&gt;, 8&gt;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        &amp;AllRemats) {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  <span class="comment">// This has to be done in 2 phases</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="comment">// Do the remats and record the required defs to be replaced in the</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">// original use instructions</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="comment">// Once all the remats are complete, replace the uses in the final</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <span class="comment">// instructions with the new defs</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1Use.html">Use</a>;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Remat;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  } ProcessNode;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;ProcessNode&gt;</a> FinalInstructionsToProcess;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : AllRemats) {</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1Use.html">Use</a> = <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.first;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurrentMaterialization = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    RematGraph *RG = <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.second.get();</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <a class="code" href="classllvm_1_1ReversePostOrderTraversal.html">ReversePostOrderTraversal&lt;RematGraph *&gt;</a> RPOT(RG);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *&gt;</a> InstructionsToProcess;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="comment">// If the target use is actually a suspend instruction then we have to</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="comment">// insert the remats into the end of the predecessor (there should only be</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="comment">// one). This is so that suspend blocks always have the suspend instruction</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="comment">// as the first instruction.</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keyword">auto</span> InsertPoint = &amp;*<a class="code" href="classllvm_1_1Use.html">Use</a>-&gt;getParent()-&gt;getFirstInsertionPt();</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keywordflow">if</span> (isa&lt;AnyCoroSuspendInst&gt;(<a class="code" href="classllvm_1_1Use.html">Use</a>)) {</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SuspendPredecessorBlock =</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;          <a class="code" href="classllvm_1_1Use.html">Use</a>-&gt;getParent()-&gt;getSinglePredecessor();</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SuspendPredecessorBlock &amp;&amp; <span class="stringliteral">&quot;malformed coro suspend instruction&quot;</span>);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      InsertPoint = SuspendPredecessorBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    }</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <span class="comment">// Note: skip the first instruction as this is the actual use that we&#39;re</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="comment">// rematerializing everything for.</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = RPOT.<a class="code" href="classllvm_1_1ReversePostOrderTraversal.html#ac958000d711f19778f1b40792821b5b3">begin</a>();</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">for</span> (; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != RPOT.<a class="code" href="classllvm_1_1ReversePostOrderTraversal.html#ae945899e1218a9240c3fed1e5789cbba">end</a>(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = (*I)-&gt;Node;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      CurrentMaterialization = <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;clone();</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      CurrentMaterialization-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;getName());</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      CurrentMaterialization-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(InsertPoint);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      InsertPoint = CurrentMaterialization;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="comment">// Replace all uses of Def in the instructions being added as part of this</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="comment">// rematerialization group</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : InstructionsToProcess)</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;replaceUsesOfWith(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>, CurrentMaterialization);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160; </div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      <span class="comment">// Don&#39;t replace the final use at this point as this can cause problems</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <span class="comment">// for other materializations. Instead, for any final use that uses a</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <span class="comment">// define that&#39;s being rematerialized, record the replace values</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="classllvm_1_1Use.html">Use</a>-&gt;getNumOperands(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Use.html">Use</a>-&gt;getOperand(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) == <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>) <span class="comment">// Is this operand pointing to oldval?</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;          FinalInstructionsToProcess.push_back(</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;              {<a class="code" href="classllvm_1_1Use.html">Use</a>, <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>, CurrentMaterialization});</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      InstructionsToProcess.push_back(CurrentMaterialization);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    }</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <span class="comment">// Finally, replace the uses with the defines that we&#39;ve just rematerialized</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> : FinalInstructionsToProcess) {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PN = dyn_cast&lt;PHINode&gt;(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Use)) {</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PN-&gt;getNumIncomingValues() == 1 &amp;&amp; <span class="stringliteral">&quot;unexpected number of incoming &quot;</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                                                <span class="stringliteral">&quot;values in the PHINode&quot;</span>);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      PN-&gt;replaceAllUsesWith(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Remat);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      PN-&gt;eraseFromParent();</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    }</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Use-&gt;replaceUsesOfWith(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Def, <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Remat);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;}</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">// Splits the block at a particular instruction unless it is the first</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">// instruction in the block with a single predecessor.</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#aa7aa3f10fdb642f3648622f62b971e11"> 2311</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="CoroFrame_8cpp.html#aa7aa3f10fdb642f3648622f62b971e11">splitBlockIfNotFirst</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="keywordflow">if</span> (&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;front() == <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getSinglePredecessor()) {</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;setName(<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    }</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;splitBasicBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;}</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">// Split above and below a particular instruction so that it</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment">// will be all alone by itself in a block.</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a54c76b23c53f62a58c09936547b2842d"> 2324</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a54c76b23c53f62a58c09936547b2842d">splitAround</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#aa7aa3f10fdb642f3648622f62b971e11">splitBlockIfNotFirst</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#aa7aa3f10fdb642f3648622f62b971e11">splitBlockIfNotFirst</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getNextNode(), <span class="stringliteral">&quot;After&quot;</span> + <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;}</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; </div>
<div class="line"><a name="l02329"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ab15e79342bb64fb172d5d5e9331560e8"> 2329</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroFrame_8cpp.html#ab15e79342bb64fb172d5d5e9331560e8">isSuspendBlock</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="keywordflow">return</span> isa&lt;AnyCoroSuspendInst&gt;(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;front());</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;}</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a114ad3c2fa8977d19e6fd43f3b685164"> 2333</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock*, 8&gt;</a> <a class="code" href="CoroFrame_8cpp.html#a114ad3c2fa8977d19e6fd43f3b685164">VisitedBlocksSet</a>;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">/// Does control flow starting at the given block ever reach a suspend</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment">/// instruction before reaching a block in VisitedOrFreeBBs?</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a0be850a4c1970e9269b48c1758737d97"> 2337</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroFrame_8cpp.html#a0be850a4c1970e9269b48c1758737d97">isSuspendReachableFrom</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>,</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                                   <a class="code" href="classllvm_1_1SmallPtrSet.html">VisitedBlocksSet</a> &amp;VisitedOrFreeBBs) {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="comment">// Eagerly try to add this block to the visited set.  If it&#39;s already</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  <span class="comment">// there, stop recursing; this path doesn&#39;t reach a suspend before</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  <span class="comment">// either looping or reaching a freeing block.</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  <span class="keywordflow">if</span> (!VisitedOrFreeBBs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>).second)</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <span class="comment">// We assume that we&#39;ll already have split suspends into their own blocks.</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="CoroFrame_8cpp.html#ab15e79342bb64fb172d5d5e9331560e8">isSuspendBlock</a>(<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>))</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="comment">// Recurse on the successors.</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Succ : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(<a class="code" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>)) {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="CoroFrame_8cpp.html#a0be850a4c1970e9269b48c1758737d97">isSuspendReachableFrom</a>(Succ, VisitedOrFreeBBs))</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;}</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">/// Is the given alloca &quot;local&quot;, i.e. bounded in lifetime to not cross a</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">/// suspend point?</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a39d3bbde4893feb90f5667cc837a4c82"> 2360</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroFrame_8cpp.html#a39d3bbde4893feb90f5667cc837a4c82">isLocalAlloca</a>(<a class="code" href="classllvm_1_1CoroAllocaAllocInst.html">CoroAllocaAllocInst</a> *AI) {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="comment">// Seed the visited set with all the basic blocks containing a free</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <span class="comment">// so that we won&#39;t pass them up.</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">VisitedBlocksSet</a> VisitedOrFreeBBs;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="classllvm_1_1User.html">User</a> : AI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> FI = dyn_cast&lt;CoroAllocaFreeInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>))</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      VisitedOrFreeBBs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(FI-&gt;getParent());</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  }</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <span class="keywordflow">return</span> !<a class="code" href="CoroFrame_8cpp.html#a0be850a4c1970e9269b48c1758737d97">isSuspendReachableFrom</a>(AI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), VisitedOrFreeBBs);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;}</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">/// After we split the coroutine, will the given basic block be along</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">/// an obvious exit path for the resumption function?</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a711449044c2aef3a8aba56149e421b60"> 2374</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroFrame_8cpp.html#a711449044c2aef3a8aba56149e421b60">willLeaveFunctionImmediatelyAfter</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                                              <span class="keywordtype">unsigned</span> depth = 3) {</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="comment">// If we&#39;ve bottomed out our depth count, stop searching and assume</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="comment">// that the path might loop back.</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="keywordflow">if</span> (depth == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="comment">// If this is a suspend block, we&#39;re about to exit the resumption function.</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="CoroFrame_8cpp.html#ab15e79342bb64fb172d5d5e9331560e8">isSuspendBlock</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="comment">// Recurse into the successors.</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Succ : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)) {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="CoroFrame_8cpp.html#a711449044c2aef3a8aba56149e421b60">willLeaveFunctionImmediatelyAfter</a>(Succ, depth - 1))</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  <span class="comment">// If none of the successors leads back in a loop, we&#39;re on an exit/abort.</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;}</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; </div>
<div class="line"><a name="l02393"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a47b0e7da15eccab3545643118aa2f99f"> 2393</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="CoroFrame_8cpp.html#a47b0e7da15eccab3545643118aa2f99f">localAllocaNeedsStackSave</a>(<a class="code" href="classllvm_1_1CoroAllocaAllocInst.html">CoroAllocaAllocInst</a> *AI) {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="comment">// Look for a free that isn&#39;t sufficiently obviously followed by</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="comment">// either a suspend or a termination, i.e. something that will leave</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  <span class="comment">// the coro resumption frame.</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : AI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="keyword">auto</span> FI = dyn_cast&lt;CoroAllocaFreeInst&gt;(U);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="keywordflow">if</span> (!FI) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="CoroFrame_8cpp.html#a711449044c2aef3a8aba56149e421b60">willLeaveFunctionImmediatelyAfter</a>(FI-&gt;getParent()))</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  }</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <span class="comment">// If we never found one, we don&#39;t need a stack save.</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;}</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">/// Turn each of the given local allocas into a normal (dynamic) alloca</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">/// instruction.</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a36b39e8a1384a23b9899d2c9e2e08e72"> 2411</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a36b39e8a1384a23b9899d2c9e2e08e72">lowerLocalAllocas</a>(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;CoroAllocaAllocInst*&gt;</a> LocalAllocas,</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                              <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Instruction*&gt;</a> &amp;DeadInsts) {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *AI : LocalAllocas) {</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <span class="keyword">auto</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = AI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(AI);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="comment">// Save the stack depth.  Try to avoid doing this if the stackrestore</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="comment">// is going to immediately precede a return or something.</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StackSave = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="CoroFrame_8cpp.html#a47b0e7da15eccab3545643118aa2f99f">localAllocaNeedsStackSave</a>(AI))</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      StackSave = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                            <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Intrinsic::stacksave));</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">// Allocate memory.</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keyword">auto</span> Alloca = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlloca(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8Ty(), AI-&gt;getSize());</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    Alloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#af3bb24b322533dbe8a63c84b18568fe1">setAlignment</a>(AI-&gt;getAlignment());</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160; </div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : AI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <span class="comment">// Replace gets with the allocation.</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="keywordflow">if</span> (isa&lt;CoroAllocaGetInst&gt;(U)) {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        U-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Alloca);</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      <span class="comment">// Replace frees with stackrestores.  This is safe because</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <span class="comment">// alloca.alloc is required to obey a stack discipline, although we</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <span class="comment">// don&#39;t enforce that structurally.</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keyword">auto</span> FI = cast&lt;CoroAllocaFreeInst&gt;(U);</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        <span class="keywordflow">if</span> (StackSave) {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(FI);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                    <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Intrinsic::stackrestore),</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                             StackSave);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        }</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      DeadInsts.push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    }</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    DeadInsts.push_back(AI);</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  }</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;}</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">/// Turn the given coro.alloca.alloc call into a dynamic allocation.</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">/// This happens during the all-instructions iteration, so it must not</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">/// delete the call.</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a96b22cedfbc659e2d8c1239a0fd9618d"> 2455</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="CoroFrame_8cpp.html#a96b22cedfbc659e2d8c1239a0fd9618d">lowerNonLocalAlloca</a>(<a class="code" href="classllvm_1_1CoroAllocaAllocInst.html">CoroAllocaAllocInst</a> *AI,</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                                        <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                                   <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Instruction*&gt;</a> &amp;DeadInsts) {</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(AI);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  <span class="keyword">auto</span> Alloc = Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a78fa8f84df72aa178f82c9421b0cf387">emitAlloc</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, AI-&gt;<a class="code" href="classllvm_1_1CoroAllocaAllocInst.html#acc37820bc8c8aa5cd91ca08a0635bbdb">getSize</a>(), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; </div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : AI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="keywordflow">if</span> (isa&lt;CoroAllocaGetInst&gt;(U)) {</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      U-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Alloc);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      <span class="keyword">auto</span> FI = cast&lt;CoroAllocaFreeInst&gt;(U);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(FI);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#acad2aaa7f484c978bb790533eec90ac4">emitDealloc</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Alloc, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    DeadInsts.push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  }</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="comment">// Push this on last so that it gets deleted after all the others.</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  DeadInsts.push_back(AI);</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="comment">// Return the new allocation value so that we can check for needed spills.</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="keywordflow">return</span> cast&lt;Instruction&gt;(Alloc);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;}</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">/// Get the current swifterror value.</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ab32716a9639a60407ce76b1533323722"> 2480</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="CoroFrame_8cpp.html#ab32716a9639a60407ce76b1533323722">emitGetSwiftErrorValue</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *ValueTy,</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                                     <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  <span class="comment">// Make a fake function pointer as a sort of intrinsic.</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;  <span class="keyword">auto</span> FnTy = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">FunctionType::get</a>(ValueTy, {}, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  <span class="keyword">auto</span> Fn = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantPointerNull::get</a>(FnTy-&gt;getPointerTo());</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160; </div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(FnTy, Fn, {});</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">SwiftErrorOps</a>.push_back(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>);</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160; </div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;}</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">/// Set the given value as the current swifterror value.</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="comment">/// Returns a slot that can be used as a swifterror slot.</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a11eb2e9dc8e7e0d9af491ccb00d43147"> 2495</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="CoroFrame_8cpp.html#a11eb2e9dc8e7e0d9af491ccb00d43147">emitSetSwiftErrorValue</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                                     <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  <span class="comment">// Make a fake function pointer as a sort of intrinsic.</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <span class="keyword">auto</span> FnTy = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">FunctionType::get</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(),</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                                {V-&gt;getType()}, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <span class="keyword">auto</span> Fn = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantPointerNull::get</a>(FnTy-&gt;getPointerTo());</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160; </div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(FnTy, Fn, { V });</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">SwiftErrorOps</a>.push_back(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160; </div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;}</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">/// Set the swifterror value from the given alloca before a call,</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">/// then put in back in the alloca afterwards.</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">/// Returns an address that will stand in for the swifterror slot</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">/// until splitting.</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#aaa21a14feb97714a61658b2867c8b628"> 2513</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="CoroFrame_8cpp.html#aaa21a14feb97714a61658b2867c8b628">emitSetAndGetSwiftErrorValueAround</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>,</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                                                 <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca,</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                                                 <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  <span class="keyword">auto</span> ValueTy = Alloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>();</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; </div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;  <span class="comment">// Load the current value from the alloca and set it as the</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  <span class="comment">// swifterror value.</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;  <span class="keyword">auto</span> ValueBeforeCall = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(ValueTy, Alloca);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a> = <a class="code" href="CoroFrame_8cpp.html#a11eb2e9dc8e7e0d9af491ccb00d43147">emitSetSwiftErrorValue</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, ValueBeforeCall, Shape);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160; </div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  <span class="comment">// Move to after the call.  Since swifterror only has a guaranteed</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  <span class="comment">// value on normal exits, we can ignore implicit and explicit unwind</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  <span class="comment">// edges.</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  <span class="keywordflow">if</span> (isa&lt;CallInst&gt;(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>)) {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>-&gt;getNextNode());</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keyword">auto</span> Invoke = cast&lt;InvokeInst&gt;(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Invoke-&gt;getNormalDest()-&gt;getFirstNonPHIOrDbg());</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; </div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;  <span class="comment">// Get the current swifterror value and store it to the alloca.</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <span class="keyword">auto</span> ValueAfterCall = <a class="code" href="CoroFrame_8cpp.html#ab32716a9639a60407ce76b1533323722">emitGetSwiftErrorValue</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, ValueTy, Shape);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(ValueAfterCall, Alloca);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a>;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;}</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="comment">/// Eliminate a formerly-swifterror alloca by inserting the get/set</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">/// intrinsics and attempting to MemToReg the alloca away.</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a55af5cce8eb7833907578e6fc3f0ab5e"> 2543</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a55af5cce8eb7833907578e6fc3f0ab5e">eliminateSwiftErrorAlloca</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca,</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                                      <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;<a class="code" href="classllvm_1_1Use.html">Use</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(Alloca-&gt;<a class="code" href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">uses</a>())) {</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="comment">// swifterror values can only be used in very specific ways.</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="comment">// We take advantage of that here.</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="keyword">auto</span> <a class="code" href="classllvm_1_1User.html">User</a> = <a class="code" href="classllvm_1_1Use.html">Use</a>.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>();</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>) || isa&lt;StoreInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>))</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;CallInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>) || isa&lt;InvokeInst&gt;(<a class="code" href="classllvm_1_1User.html">User</a>));</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a> = cast&lt;Instruction&gt;(<a class="code" href="classllvm_1_1User.html">User</a>);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160; </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="keyword">auto</span> <a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a> = <a class="code" href="CoroFrame_8cpp.html#aaa21a14feb97714a61658b2867c8b628">emitSetAndGetSwiftErrorValueAround</a>(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>, Alloca, Shape);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160; </div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="comment">// Use the returned slot address as the call argument.</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <a class="code" href="classllvm_1_1Use.html">Use</a>.<a class="code" href="classllvm_1_1Use.html#a40360b4fa7b8e6920a68e5a8a0814f1f">set</a>(<a class="code" href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a>);</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  }</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160; </div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  <span class="comment">// All the uses should be loads and stores now.</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#a5023b360abc7a5d1612061fba30003a6">isAllocaPromotable</a>(Alloca));</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;}</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment">/// &quot;Eliminate&quot; a swifterror argument by reducing it to the alloca case</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment">/// and then loading and storing in the prologue and epilog.</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="comment">/// The argument keeps the swifterror flag.</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a8356860a8bef082ff15df896ecec7732"> 2569</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a8356860a8bef082ff15df896ecec7732">eliminateSwiftErrorArgument</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1Argument.html">Argument</a> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>,</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                                        <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                             <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;AllocaInst*&gt;</a> &amp;AllocasToPromote) {</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().getFirstNonPHIOrDbg());</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="keyword">auto</span> ArgTy = cast&lt;PointerType&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.getType());</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <span class="comment">// swifterror arguments are required to have pointer-to-pointer type,</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <span class="comment">// so create a pointer-typed alloca with opaque pointers.</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  <span class="keyword">auto</span> ValueTy = ArgTy-&gt;isOpaque() ? PointerType::getUnqual(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext())</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                                   : ArgTy-&gt;getNonOpaquePointerElementType();</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  <span class="comment">// Reduce to the alloca case:</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160; </div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  <span class="comment">// Create an alloca and replace all uses of the arg with it.</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;  <span class="keyword">auto</span> Alloca = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlloca(ValueTy, ArgTy-&gt;getAddressSpace());</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;  <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.replaceAllUsesWith(Alloca);</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  <span class="comment">// Set an initial value in the alloca.  swifterror is always null on entry.</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;  <span class="keyword">auto</span> InitialValue = Constant::getNullValue(ValueTy);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(InitialValue, Alloca);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; </div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  <span class="comment">// Find all the suspends in the function and save and restore around them.</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Suspend : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>) {</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    (void) <a class="code" href="CoroFrame_8cpp.html#aaa21a14feb97714a61658b2867c8b628">emitSetAndGetSwiftErrorValueAround</a>(Suspend, Alloca, Shape);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;  }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;  <span class="comment">// Find all the coro.ends in the function and restore the error value.</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *End : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#adc470e92d3cd5fb8d54d7b9179841463">CoroEnds</a>) {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(End);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keyword">auto</span> FinalValue = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(ValueTy, Alloca);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    (void) <a class="code" href="CoroFrame_8cpp.html#a11eb2e9dc8e7e0d9af491ccb00d43147">emitSetSwiftErrorValue</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, FinalValue, Shape);</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  }</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="comment">// Now we can use the alloca logic.</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  AllocasToPromote.push_back(Alloca);</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#a55af5cce8eb7833907578e6fc3f0ab5e">eliminateSwiftErrorAlloca</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Alloca, Shape);</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;}</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">/// Eliminate all problematic uses of swifterror arguments and allocas</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="comment">/// from the function.  We&#39;ll fix them up later when splitting the function.</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a311a80924f5342813ae67daa5e5ff444"> 2609</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a311a80924f5342813ae67daa5e5ff444">eliminateSwiftError</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;AllocaInst*, 4&gt;</a> AllocasToPromote;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="comment">// Look for a swifterror argument.</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.args()) {</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.hasSwiftErrorAttr()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160; </div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a8356860a8bef082ff15df896ecec7732">eliminateSwiftErrorArgument</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, Shape, AllocasToPromote);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  }</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  <span class="comment">// Look for swifterror allocas.</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Inst : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock()) {</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keyword">auto</span> Alloca = dyn_cast&lt;AllocaInst&gt;(&amp;Inst);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="keywordflow">if</span> (!Alloca || !Alloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a3016b467a9ecb5506956f7d029509db5">isSwiftError</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="comment">// Clear the swifterror flag.</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    Alloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a31eeebeefd320f6a2db4a867f568bee3">setSwiftError</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160; </div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    AllocasToPromote.push_back(Alloca);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a55af5cce8eb7833907578e6fc3f0ab5e">eliminateSwiftErrorAlloca</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Alloca, Shape);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="comment">// If we have any allocas to promote, compute a dominator tree and</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  <span class="comment">// promote them en masse.</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  <span class="keywordflow">if</span> (!AllocasToPromote.empty()) {</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <a class="code" href="namespacellvm.html#a1a4cac84457299517e69ff9764fed2db">PromoteMemToReg</a>(AllocasToPromote, DT);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  }</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;}</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment">/// retcon and retcon.once conventions assume that all spill uses can be sunk</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment">/// after the coro.begin intrinsic.</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a9c2c728c358082fa0b0f7d7672a9819a"> 2642</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a9c2c728c358082fa0b0f7d7672a9819a">sinkSpillUsesAfterCoroBegin</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                                        <span class="keyword">const</span> FrameDataInfo &amp;FrameData,</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                                        <a class="code" href="classllvm_1_1CoroBeginInst.html">CoroBeginInst</a> *CoroBegin) {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> Dom(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160; </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;Instruction *, 32&gt;</a> ToMove;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 32&gt;</a> Worklist;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160; </div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  <span class="comment">// Collect all users that precede coro.begin.</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a> : FrameData.getAllDefs()) {</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>-&gt;users()) {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="keyword">auto</span> Inst = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="keywordflow">if</span> (Inst-&gt;getParent() != CoroBegin-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() ||</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;          Dom.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(CoroBegin, Inst))</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      <span class="keywordflow">if</span> (ToMove.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(Inst))</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        Worklist.push_back(Inst);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    }</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  }</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  <span class="comment">// Recursively collect users before coro.begin.</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a> = Worklist.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>-&gt;users()) {</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <span class="keyword">auto</span> Inst = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <span class="keywordflow">if</span> (Dom.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(CoroBegin, Inst))</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      <span class="keywordflow">if</span> (ToMove.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(Inst))</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        Worklist.push_back(Inst);</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    }</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  }</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160; </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  <span class="comment">// Sort by dominance.</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 64&gt;</a> InsertionList(ToMove.<a class="code" href="classllvm_1_1SetVector.html#adb13793b98ab59209a5309d26f831850">begin</a>(), ToMove.<a class="code" href="classllvm_1_1SetVector.html#affac0dc3d407ef3dee29b8bc9a4836bc">end</a>());</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(InsertionList, [&amp;Dom](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="comment">// If a dominates b it should preceed (&lt;) b.</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="keywordflow">return</span> Dom.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  });</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160; </div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = CoroBegin-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>();</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst : InsertionList)</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(InsertPt);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;}</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment">/// For each local variable that all of its user are only used inside one of</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">/// suspended region, we sink their lifetime.start markers to the place where</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="comment">/// after the suspend block. Doing so minimizes the lifetime of each variable,</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="comment">/// hence minimizing the amount of data we end up putting on the frame.</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a9f46b526663b3a99b56fbcf1612a28a0"> 2689</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a9f46b526663b3a99b56fbcf1612a28a0">sinkLifetimeStartMarkers</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                                     SuspendCrossingInfo &amp;Checker) {</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasOptNone())</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160; </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160; </div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  <span class="comment">// Collect all possible basic blocks which may dominate all uses of allocas.</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;BasicBlock *, 4&gt;</a> DomSet;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  DomSet.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock());</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CSI : Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>) {</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SuspendBlock = CSI-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="CoroFrame_8cpp.html#ab15e79342bb64fb172d5d5e9331560e8">isSuspendBlock</a>(SuspendBlock) &amp;&amp; SuspendBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a79c007dcf9fff57e1569e778d7885b5e">getSingleSuccessor</a>() &amp;&amp;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;           <span class="stringliteral">&quot;should have split coro.suspend into its own block&quot;</span>);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    DomSet.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(SuspendBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a79c007dcf9fff57e1569e778d7885b5e">getSingleSuccessor</a>());</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  }</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; </div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="MustExecute_8cpp.html#a13fbdcf3bc34f504e8f2b5f2aa7d7f7c">instructions</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a>* AI = dyn_cast&lt;AllocaInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <span class="keywordflow">if</span> (!AI)</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160; </div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *DomBB : DomSet) {</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="keywordtype">bool</span> Valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 1&gt;</a> Lifetimes;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160; </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;      <span class="keyword">auto</span> <a class="code" href="GVN_8cpp.html#ab1faa49b43014e07caaf2bf2d3db07e4">isLifetimeStart</a> = [](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a>* <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span>* II = dyn_cast&lt;IntrinsicInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;          <span class="keywordflow">return</span> II-&gt;<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::lifetime_start;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;      };</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160; </div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;      <span class="keyword">auto</span> collectLifetimeStart = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *U, <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI) {</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="GVN_8cpp.html#ab1faa49b43014e07caaf2bf2d3db07e4">isLifetimeStart</a>(U)) {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;          Lifetimes.push_back(U);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        <span class="keywordflow">if</span> (!U-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() || U-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>() != AI)</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="GVN_8cpp.html#ab1faa49b43014e07caaf2bf2d3db07e4">isLifetimeStart</a>(U-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>())) {</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;          Lifetimes.push_back(U-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>());</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        }</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      };</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160; </div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : AI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UI = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        <span class="comment">// For all users except lifetime.start markers, if they are all</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        <span class="comment">// dominated by one of the basic blocks and do not cross</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        <span class="comment">// suspend points as well, then there is no need to spill the</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        <span class="comment">// instruction.</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        <span class="keywordflow">if</span> (!DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(DomBB, UI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) ||</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            Checker.isDefinitionAcrossSuspend(DomBB, UI)) {</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;          <span class="comment">// Skip lifetime.start, GEP and bitcast used by lifetime.start</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;          <span class="comment">// markers.</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;          <span class="keywordflow">if</span> (collectLifetimeStart(UI, AI))</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;          Valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        }</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      }</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      <span class="comment">// Sink lifetime.start markers to dominate block when they are</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      <span class="comment">// only used outside the region.</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      <span class="keywordflow">if</span> (Valid &amp;&amp; Lifetimes.size() != 0) {</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <span class="comment">// May be AI itself, when the type of AI is i8*</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <span class="keyword">auto</span> *NewBitCast = [&amp;](<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI) -&gt; <a class="code" href="classllvm_1_1Value.html">Value</a>* {</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;          <span class="keywordflow">if</span> (isa&lt;AllocaInst&gt;(Lifetimes[0]-&gt;getOperand(1)))</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;            <span class="keywordflow">return</span> AI;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;          <span class="keyword">auto</span> *Int8PtrTy = Type::getInt8PtrTy(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext());</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;          <span class="keywordflow">return</span> CastInst::Create(Instruction::BitCast, AI, Int8PtrTy, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                                  DomBB-&gt;getTerminator());</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        }(AI);</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160; </div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <span class="keyword">auto</span> *NewLifetime = Lifetimes[0]-&gt;clone();</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        NewLifetime-&gt;replaceUsesOfWith(NewLifetime-&gt;getOperand(1), NewBitCast);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        NewLifetime-&gt;insertBefore(DomBB-&gt;getTerminator());</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160; </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        <span class="comment">// All the outsided lifetime.start markers are no longer necessary.</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : Lifetimes)</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;          <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160; </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      }</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    }</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  }</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;}</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#a4656a64c1685bd4f7577a8073c314f6a"> 2777</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#a4656a64c1685bd4f7577a8073c314f6a">collectFrameAlloca</a>(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI, <a class="code" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                               <span class="keyword">const</span> SuspendCrossingInfo &amp;Checker,</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                               <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;AllocaInfo&gt;</a> &amp;Allocas,</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <span class="keywordflow">if</span> (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.empty())</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160; </div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  <span class="comment">// The PromiseAlloca will be specially handled since it needs to be in a</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  <span class="comment">// fixed position in the frame.</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  <span class="keywordflow">if</span> (AI == Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a6af0b7b0e5d0e8f4b8b4f4199a885204">PromiseAlloca</a>)</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; </div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  <span class="comment">// The code that uses lifetime.start intrinsic does not work for functions</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  <span class="comment">// with loops without exit. Disable it on ABIs we know to generate such</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <span class="comment">// code.</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <span class="keywordtype">bool</span> ShouldUseLifetimeStartInfo =</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      (Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::Async &amp;&amp; Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::Retcon &amp;&amp;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;       Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::RetconOnce);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  AllocaUseVisitor Visitor{AI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>(), DT,</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                           *Shape.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>, Checker,</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                           ShouldUseLifetimeStartInfo};</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;  Visitor.visitPtr(*AI);</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;  <span class="keywordflow">if</span> (!Visitor.getShouldLiveOnFrame())</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;  Allocas.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(AI, Visitor.getAliasesCopy(),</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                       Visitor.getMayWriteBeforeCoroBegin());</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;}</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; </div>
<div class="line"><a name="l02805"></a><span class="lineno"><a class="line" href="namespacellvm_1_1coro.html#a4b6f33a1040beb67526139c880622747"> 2805</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">coro::salvageDebugInfo</a>(</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;llvm::Value *, llvm::AllocaInst *, 4&gt;</a> &amp;DbgPtrAllocaCache,</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *DVI, <span class="keywordtype">bool</span> OptimizeFrame) {</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = DVI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>();</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getContext());</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <span class="keyword">auto</span> InsertPt = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock().getFirstInsertionPt();</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  <span class="keywordflow">while</span> (isa&lt;IntrinsicInst&gt;(InsertPt))</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    ++InsertPt;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock(), InsertPt);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  <a class="code" href="classllvm_1_1DIExpression.html">DIExpression</a> *Expr = DVI-&gt;<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html#a2d4581b2568be7db21e47f096ffd6df8">getExpression</a>();</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  <span class="comment">// Follow the pointer arithmetic all the way to the incoming</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  <span class="comment">// function argument and convert into a DIExpression.</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;  <span class="keywordtype">bool</span> SkipOutermostLoad = !isa&lt;DbgValueInst&gt;(DVI);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Storage = DVI-&gt;<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html#a5702a1d09ac6ee86196a38b3f682a570">getVariableLocationOp</a>(0);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OriginalStorage = Storage;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">auto</span> *Inst = dyn_cast_or_null&lt;Instruction&gt;(Storage)) {</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LdInst = dyn_cast&lt;LoadInst&gt;(Inst)) {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      Storage = LdInst-&gt;getOperand(0);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <span class="comment">// FIXME: This is a heuristic that works around the fact that</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      <span class="comment">// LLVM IR debug intrinsics cannot yet distinguish between</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      <span class="comment">// memory and value locations: Because a dbg.declare(alloca) is</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      <span class="comment">// implicitly a memory location no DW_OP_deref operation for the</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      <span class="comment">// last direct load from an alloca is necessary.  This condition</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="comment">// effectively drops the *last* DW_OP_deref in the expression.</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="keywordflow">if</span> (!SkipOutermostLoad)</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        Expr = DIExpression::prepend(Expr, DIExpression::DerefBefore);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *StInst = dyn_cast&lt;StoreInst&gt;(Inst)) {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      Storage = StInst-&gt;getOperand(0);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;uint64_t, 16&gt;</a> Ops;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 0&gt;</a> AdditionalValues;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="namespacellvm.html#a99356c6b92999b95181b5d79c03868ee">llvm::salvageDebugInfoImpl</a>(</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;          *Inst, Expr ? Expr-&gt;<a class="code" href="classllvm_1_1DIExpression.html#a9aef6cbb464a57070a26cf422b979df9">getNumLocationOperands</a>() : 0, Ops,</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;          AdditionalValues);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> || !AdditionalValues.empty()) {</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        <span class="comment">// If salvaging failed or salvaging produced more than one location</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        <span class="comment">// operand, give up.</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      }</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      Storage = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      Expr = DIExpression::appendOpsToArg(Expr, Ops, 0, <span class="comment">/*StackValue*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    SkipOutermostLoad = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  }</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  <span class="keywordflow">if</span> (!Storage)</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160; </div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <span class="comment">// Store a pointer to the coroutine frame object in an alloca so it</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  <span class="comment">// is available throughout the function when producing unoptimized</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <span class="comment">// code. Extending the lifetime this way is correct because the</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="comment">// variable has been declared by a dbg.declare intrinsic.</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  <span class="comment">// Avoid to create the alloca would be eliminated by optimization</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="comment">// passes and the corresponding dbg.declares would be invalid.</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <span class="keywordflow">if</span> (!OptimizeFrame)</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = dyn_cast&lt;llvm::Argument&gt;(Storage)) {</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      <span class="keyword">auto</span> &amp;Cached = DbgPtrAllocaCache[Storage];</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;      <span class="keywordflow">if</span> (!Cached) {</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        Cached = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateAlloca(Storage-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                                      <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getName() + <span class="stringliteral">&quot;.debug&quot;</span>);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(Storage, Cached);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;      }</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;      Storage = Cached;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;      <span class="comment">// FIXME: LLVM lacks nuanced semantics to differentiate between</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="comment">// memory and direct locations at the IR level. The backend will</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;      <span class="comment">// turn a dbg.declare(alloca, ..., DIExpression()) into a memory</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      <span class="comment">// location. Thus, if there are deref and offset operations in the</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      <span class="comment">// expression, we need to add a DW_OP_deref at the *start* of the</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      <span class="comment">// expression to first load the contents of the alloca before</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      <span class="comment">// adjusting it with the expression.</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;      Expr = DIExpression::prepend(Expr, DIExpression::DerefBefore);</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    }</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160; </div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  DVI-&gt;<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html#a212fcbee3e65ec41eebed2525fc15207">replaceVariableLocationOp</a>(OriginalStorage, Storage);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  DVI-&gt;<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html#a71808acf992f787300ec18d5700f09cc">setExpression</a>(Expr);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  <span class="comment">// We only hoist dbg.declare today since it doesn&#39;t make sense to hoist</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  <span class="comment">// dbg.value or dbg.addr since they do not have the same function wide</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <span class="comment">// guarantees that dbg.declare does.</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;DbgValueInst&gt;(DVI) &amp;&amp; !isa&lt;DbgAddrIntrinsic&gt;(DVI)) {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(Storage))</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      InsertPt = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getInsertionPointAfterDef();</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;Argument&gt;(Storage))</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;      InsertPt = &amp;*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock().begin();</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="keywordflow">if</span> (InsertPt)</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;      DVI-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(InsertPt);</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  }</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;}</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; </div>
<div class="line"><a name="l02895"></a><span class="lineno"><a class="line" href="CoroFrame_8cpp.html#ad4ec084a8acaa57f45aebebee2789763"> 2895</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="CoroFrame_8cpp.html#ad4ec084a8acaa57f45aebebee2789763">doRematerializations</a>(</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, SuspendCrossingInfo &amp;Checker,</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keyword">const</span> <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;)&gt; &amp;MaterializableCallback) {</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasOptNone())</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160; </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  SpillInfo Spills;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160; </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;  <span class="comment">// See if there are materializable instructions across suspend points</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  <span class="comment">// We record these as the starting point to also identify materializable</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  <span class="comment">// defs of uses in these operations</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="MustExecute_8cpp.html#a13fbdcf3bc34f504e8f2b5f2aa7d7f7c">instructions</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="keywordflow">if</span> (!MaterializableCallback(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.users())</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <span class="keywordflow">if</span> (Checker.isDefinitionAcrossSuspend(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, U))</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        Spills[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  }</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160; </div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <span class="comment">// Process each of the identified rematerializable instructions</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="comment">// and add predecessor instructions that can also be rematerialized.</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  <span class="comment">// This is actually a graph of instructions since we could potentially</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  <span class="comment">// have multiple uses of a def in the set of predecessor instructions.</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <span class="comment">// The approach here is to maintain a graph of instructions for each bottom</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="comment">// level instruction - where we have a unique set of instructions (nodes)</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <span class="comment">// and edges between them. We then walk the graph in reverse post-dominator</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  <span class="comment">// order to insert them past the suspend point, but ensure that ordering is</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;  <span class="comment">// correct. We also rely on CSE removing duplicate defs for remats of</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <span class="comment">// different instructions with a def in common (rather than maintaining more</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  <span class="comment">// complex graphs for each suspend point)</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="comment">// We can do this by adding new nodes to the list for each suspend</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <span class="comment">// point. Then using standard GraphTraits to give a reverse post-order</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  <span class="comment">// traversal when we insert the nodes after the suspend</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <a class="code" href="structllvm_1_1SmallMapVector.html">SmallMapVector&lt;Instruction *, std::unique_ptr&lt;RematGraph&gt;</a>, 8&gt; AllRemats;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : Spills) {</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *U : <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>.second) {</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <span class="comment">// Don&#39;t process a user twice (this can happen if the instruction uses</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      <span class="comment">// more than one rematerializable def)</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      <span class="keywordflow">if</span> (AllRemats.<a class="code" href="classllvm_1_1MapVector.html#a041e60c6f5f9841f3dc74921ea87bec2">count</a>(U))</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160; </div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <span class="comment">// Constructor creates the whole RematGraph for the given Use</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      <span class="keyword">auto</span> RematUPtr =</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;          std::make_unique&lt;RematGraph&gt;(MaterializableCallback, U, Checker);</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160; </div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;***** Next remat group *****\n&quot;</span>;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                 <a class="code" href="classllvm_1_1ReversePostOrderTraversal.html">ReversePostOrderTraversal&lt;RematGraph *&gt;</a> RPOT(RematUPtr.get());</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                 <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = RPOT.begin(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != RPOT.end();</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                      ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) { (*I)-&gt;Node-&gt;dump(); } <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160; </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      AllRemats[U] = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(RematUPtr);</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    }</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  }</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160; </div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  <span class="comment">// Rewrite materializable instructions to be materialized at the use</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;  <span class="comment">// point.</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="CoroFrame_8cpp.html#ae401556a84636b6bd31d124b7836082b">dumpRemats</a>(<span class="stringliteral">&quot;Materializations&quot;</span>, AllRemats));</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#aba618c16a34739af0506ba1082d209a3">rewriteMaterializableInstructions</a>(AllRemats);</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;}</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160; </div>
<div class="line"><a name="l02957"></a><span class="lineno"><a class="line" href="namespacellvm_1_1coro.html#a311a963e369623329d830d9fc086cef5"> 2957</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacellvm_1_1coro.html#a311a963e369623329d830d9fc086cef5">coro::buildCoroutineFrame</a>(</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a> &amp;<a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>,</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    <span class="keyword">const</span> <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;)&gt; &amp;MaterializableCallback) {</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  <span class="comment">// Don&#39;t eliminate swifterror in async functions that won&#39;t be split.</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::Async || !<a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.empty())</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a311a80924f5342813ae67daa5e5ff444">eliminateSwiftError</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160; </div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch &amp;&amp;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a6af0b7b0e5d0e8f4b8b4f4199a885204">PromiseAlloca</a>) {</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a3c5bfa27332d63608ee16d8e61c7682a">getSwitchCoroId</a>()-&gt;<a class="code" href="classllvm_1_1CoroIdInst.html#ab330f042033636da90859626bc4dc542">clearPromise</a>();</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;  }</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160; </div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;  <span class="comment">// Make sure that all coro.save, coro.suspend and the fallthrough coro.end</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  <span class="comment">// intrinsics are in their own blocks to simplify the logic of building up</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  <span class="comment">// SuspendCrossing data.</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CSI : <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>) {</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Save = CSI-&gt;getCoroSave())</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      <a class="code" href="CoroFrame_8cpp.html#a54c76b23c53f62a58c09936547b2842d">splitAround</a>(Save, <span class="stringliteral">&quot;CoroSave&quot;</span>);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a54c76b23c53f62a58c09936547b2842d">splitAround</a>(CSI, <span class="stringliteral">&quot;CoroSuspend&quot;</span>);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;  }</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; </div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  <span class="comment">// Put CoroEnds into their own blocks.</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1AnyCoroEndInst.html">AnyCoroEndInst</a> *CE : <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#adc470e92d3cd5fb8d54d7b9179841463">CoroEnds</a>) {</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a54c76b23c53f62a58c09936547b2842d">splitAround</a>(CE, <span class="stringliteral">&quot;CoroEnd&quot;</span>);</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160; </div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="comment">// Emit the musttail call function in a new block before the CoroEnd.</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    <span class="comment">// We do this here so that the right suspend crossing info is computed for</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    <span class="comment">// the uses of the musttail call function call. (Arguments to the coro.end</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    <span class="comment">// instructions would be ignored)</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AsyncEnd = dyn_cast&lt;CoroAsyncEndInst&gt;(CE)) {</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      <span class="keyword">auto</span> *MustTailCallFn = AsyncEnd-&gt;getMustTailCallFunction();</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <span class="keywordflow">if</span> (!MustTailCallFn)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(AsyncEnd);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>(AsyncEnd-&gt;args());</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="keyword">auto</span> <a class="code" href="AMDGPULowerKernelArguments_8cpp.html#a1161e5a4e753384aaba3a8e4533c4261">Arguments</a> = <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Value *&gt;</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>).<a class="code" href="classllvm_1_1ArrayRef.html#a0b7abf908b6ce436de4d1012f2df7c0c">drop_front</a>(3);</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a> = <a class="code" href="namespacellvm_1_1coro.html#acd1ac3572804d7881248a27e37b78788">createMustTailCall</a>(AsyncEnd-&gt;getDebugLoc(), MustTailCallFn,</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                                      <a class="code" href="AMDGPULowerKernelArguments_8cpp.html#a1161e5a4e753384aaba3a8e4533c4261">Arguments</a>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      <a class="code" href="CoroFrame_8cpp.html#a54c76b23c53f62a58c09936547b2842d">splitAround</a>(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">Call</a>, <span class="stringliteral">&quot;MustTailCall.Before.CoroEnd&quot;</span>);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    }</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;  }</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160; </div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  <span class="comment">// Later code makes structural assumptions about single predecessors phis e.g</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  <span class="comment">// that they are not live across a suspend point.</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#a03cdd58b24dc91b4e3819e218a399cbf">cleanupSinglePredPHIs</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; </div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;  <span class="comment">// Transforms multi-edge PHI Nodes, so that any value feeding into a PHI will</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;  <span class="comment">// never has its definition separated from the PHI by the suspend point.</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#a5a93b5fcf433128b2fd9d563792eb4cd">rewritePHIs</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  <span class="comment">// Build suspend crossing info.</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  SuspendCrossingInfo Checker(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>);</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160; </div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#ad4ec084a8acaa57f45aebebee2789763">doRematerializations</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Checker, MaterializableCallback);</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160; </div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  FrameDataInfo FrameData;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CoroAllocaAllocInst*, 4&gt;</a> LocalAllocas;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction*, 4&gt;</a> DeadInstructions;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::Async &amp;&amp; <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::Retcon &amp;&amp;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::RetconOnce)</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a9f46b526663b3a99b56fbcf1612a28a0">sinkLifetimeStartMarkers</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>, Checker);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; </div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;  <span class="comment">// Collect the spills for arguments and other not-materializable values.</span></div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Argument.html">Argument</a> &amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.args())</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>.users())</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      <span class="keywordflow">if</span> (Checker.isDefinitionAcrossSuspend(<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>, U))</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        FrameData.Spills[&amp;<a class="code" href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a>].push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160; </div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="MustExecute_8cpp.html#a13fbdcf3bc34f504e8f2b5f2aa7d7f7c">instructions</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="comment">// Values returned from coroutine structure intrinsics should not be part</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="comment">// of the Coroutine Frame.</span></div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="CoroFrame_8cpp.html#a0c7538ac13a28b2830b46b272c7ccfd4">isCoroutineStructureIntrinsic</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160; </div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="comment">// Handle alloca.alloc specially here.</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> AI = dyn_cast&lt;CoroAllocaAllocInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      <span class="comment">// Check whether the alloca&#39;s lifetime is bounded by suspend points.</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="CoroFrame_8cpp.html#a39d3bbde4893feb90f5667cc837a4c82">isLocalAlloca</a>(AI)) {</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        LocalAllocas.push_back(AI);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;      }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      <span class="comment">// If not, do a quick rewrite of the alloca and then add spills of</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      <span class="comment">// the rewritten value.  The rewrite doesn&#39;t invalidate anything in</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      <span class="comment">// Spills because the other alloca intrinsics have no other operands</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      <span class="comment">// besides AI, and it doesn&#39;t invalidate the iteration because we delay</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      <span class="comment">// erasing AI.</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      <span class="keyword">auto</span> Alloc = <a class="code" href="CoroFrame_8cpp.html#a96b22cedfbc659e2d8c1239a0fd9618d">lowerNonLocalAlloca</a>(AI, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>, DeadInstructions);</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160; </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : Alloc-&gt;users()) {</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        <span class="keywordflow">if</span> (Checker.isDefinitionAcrossSuspend(*Alloc, U))</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;          FrameData.Spills[Alloc].push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;      }</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    }</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160; </div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <span class="comment">// Ignore alloca.get; we process this as part of coro.alloca.alloc.</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="keywordflow">if</span> (isa&lt;CoroAllocaGetInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160; </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AI = dyn_cast&lt;AllocaInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      <a class="code" href="CoroFrame_8cpp.html#a4656a64c1685bd4f7577a8073c314f6a">collectFrameAlloca</a>(AI, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>, Checker, FrameData.Allocas, DT);</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160; </div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.users())</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;      <span class="keywordflow">if</span> (Checker.isDefinitionAcrossSuspend(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, U)) {</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="comment">// We cannot spill a token.</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;isTokenTy())</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          <a class="code" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;              <span class="stringliteral">&quot;token definition is separated from the use by a suspend point&quot;</span>);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        FrameData.Spills[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;      }</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  }</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; </div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="CoroFrame_8cpp.html#ac103d1b9c5e3a297b0f730cb03034d02">dumpAllocas</a>(FrameData.Allocas));</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160; </div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;  <span class="comment">// We don&#39;t want the layout of coroutine frame to be affected</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <span class="comment">// by debug information. So we only choose to salvage DbgValueInst for</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  <span class="comment">// whose value is already in the frame.</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  <span class="comment">// We would handle the dbg.values for allocas specially</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Iter : FrameData.Spills) {</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <span class="keyword">auto</span> *V = Iter.first;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DbgValueInst *, 16&gt;</a> DVIs;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <a class="code" href="namespacellvm.html#a8813c8445d4429956ae5a3647f02fcfb">findDbgValues</a>(DVIs, V);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgValueInst.html">DbgValueInst</a> *DVI : DVIs)</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;      <span class="keywordflow">if</span> (Checker.isDefinitionAcrossSuspend(*V, DVI))</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;        FrameData.Spills[V].push_back(DVI);</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  }</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160; </div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="CoroFrame_8cpp.html#ad4de2704820e01ff871aa093ca9cb712">dumpSpills</a>(<span class="stringliteral">&quot;Spills&quot;</span>, FrameData.Spills));</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Retcon || <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::RetconOnce ||</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Async)</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <a class="code" href="CoroFrame_8cpp.html#a9c2c728c358082fa0b0f7d7672a9819a">sinkSpillUsesAfterCoroBegin</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, FrameData, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>);</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>.<a class="code" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a> = <a class="code" href="CoroFrame_8cpp.html#a7fb33159070b72dbab672431dd656a3d">buildFrameType</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>, FrameData);</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#a1833296d8e82f27935a4302e47b60690">createFramePtr</a>(<a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>);</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="comment">// For now, this works for C++ programs only.</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#a86c6fee36a1f17461710c01e694ee8df">buildFrameDebugInfo</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>, FrameData);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#af0885df5b78cc732639a9d52a87d040e">insertSpills</a>(FrameData, <a class="code" href="structllvm_1_1coro_1_1Shape.html">Shape</a>);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <a class="code" href="CoroFrame_8cpp.html#a36b39e8a1384a23b9899d2c9e2e08e72">lowerLocalAllocas</a>(LocalAllocas, DeadInstructions);</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160; </div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : DeadInstructions)</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1Check_html_a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396"><div class="ttname"><a href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">llvm::Check::Size</a></div><div class="ttdeci">@ Size</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8h_source.html#l00077">FileCheck.h:77</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ae55e412b7d8666b0c2ae26396f8e0e5f"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ae55e412b7d8666b0c2ae26396f8e0e5f">llvm::coro::Shape::getInsertPtAfterFramePtr</a></div><div class="ttdeci">Instruction * getInsertPtAfterFramePtr() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00240">CoroInternal.h:240</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aPtrUseVisitor_8h_html"><div class="ttname"><a href="PtrUseVisitor_8h.html">PtrUseVisitor.h</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a96bc92416c8a38a3c4a275b9e6c0beca"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a96bc92416c8a38a3c4a275b9e6c0beca">alignTo</a></div><div class="ttdeci">static int alignTo(int Num, int PowOf2)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01204">AArch64LoadStoreOptimizer.cpp:1204</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1PtrUseVisitorBase_html_a23aaa9f9a2d1e401b969c7395929fd1e"><div class="ttname"><a href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#a23aaa9f9a2d1e401b969c7395929fd1e">llvm::detail::PtrUseVisitorBase::enqueueUsers</a></div><div class="ttdeci">void enqueueUsers(Instruction &amp;I)</div><div class="ttdoc">Enqueue the users of this instruction in the visit worklist.</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8cpp_source.html#l00020">PtrUseVisitor.cpp:20</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_aa7aa3f10fdb642f3648622f62b971e11"><div class="ttname"><a href="CoroFrame_8cpp.html#aa7aa3f10fdb642f3648622f62b971e11">splitBlockIfNotFirst</a></div><div class="ttdeci">static BasicBlock * splitBlockIfNotFirst(Instruction *I, const Twine &amp;Name)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02311">CoroFrame.cpp:2311</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html_a2d4581b2568be7db21e47f096ffd6df8"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html#a2d4581b2568be7db21e47f096ffd6df8">llvm::DbgVariableIntrinsic::getExpression</a></div><div class="ttdeci">DIExpression * getExpression() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00292">IntrinsicInst.h:292</a></div></div>
<div class="ttc" id="aclassllvm_1_1Argument_html"><div class="ttname"><a href="classllvm_1_1Argument.html">llvm::Argument</a></div><div class="ttdoc">This class represents an incoming formal argument to a Function.</div><div class="ttdef"><b>Definition:</b> <a href="Argument_8h_source.html#l00028">Argument.h:28</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_ad4ec084a8acaa57f45aebebee2789763"><div class="ttname"><a href="CoroFrame_8cpp.html#ad4ec084a8acaa57f45aebebee2789763">doRematerializations</a></div><div class="ttdeci">static void doRematerializations(Function &amp;F, SuspendCrossingInfo &amp;Checker, const std::function&lt; bool(Instruction &amp;)&gt; &amp;MaterializableCallback)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02895">CoroFrame.cpp:2895</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_acd1ac3572804d7881248a27e37b78788"><div class="ttname"><a href="namespacellvm_1_1coro.html#acd1ac3572804d7881248a27e37b78788">llvm::coro::createMustTailCall</a></div><div class="ttdeci">CallInst * createMustTailCall(DebugLoc Loc, Function *MustTailCallFn, ArrayRef&lt; Value * &gt; Arguments, IRBuilder&lt;&gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="CoroSplit_8cpp_source.html#l01675">CoroSplit.cpp:1675</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a8ad67a33bae235fe3cca1c3e5a91ed2d"><div class="ttname"><a href="classllvm_1_1Type.html#a8ad67a33bae235fe3cca1c3e5a91ed2d">llvm::Type::isSized</a></div><div class="ttdeci">bool isSized(SmallPtrSetImpl&lt; Type * &gt; *Visited=nullptr) const</div><div class="ttdoc">Return true if it makes sense to take the size of this type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00295">Type.h:295</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_ae401556a84636b6bd31d124b7836082b"><div class="ttname"><a href="CoroFrame_8cpp.html#ae401556a84636b6bd31d124b7836082b">dumpRemats</a></div><div class="ttdeci">static void dumpRemats(StringRef Title, const SmallMapVector&lt; Instruction *, std::unique_ptr&lt; RematGraph &gt;, 8 &gt; &amp;RM)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00542">CoroFrame.cpp:542</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage_html_a257b93881a8ca56ed33f4326672b738d"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a257b93881a8ca56ed33f4326672b738d">llvm::coro::Shape::AsyncLoweringStorage::FrameOffset</a></div><div class="ttdeci">uint64_t FrameOffset</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00133">CoroInternal.h:133</a></div></div>
<div class="ttc" id="aIRTranslator_8cpp_html_abe44dfdea65b4f7e11e0a608ab708b76"><div class="ttname"><a href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div><div class="ttdeci">IRTranslator LLVM IR MI</div><div class="ttdef"><b>Definition:</b> <a href="IRTranslator_8cpp_source.html#l00109">IRTranslator.cpp:109</a></div></div>
<div class="ttc" id="aCompiler_8h_html_aa863693eef567397d9c292da5bf22d34"><div class="ttname"><a href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a></div><div class="ttdeci">#define LLVM_DUMP_METHOD</div><div class="ttdoc">Mark debug helper function definitions like dump() that should not be stripped from debug builds.</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00492">Compiler.h:492</a></div></div>
<div class="ttc" id="aMathExtras_8h_html"><div class="ttname"><a href="MathExtras_8h.html">MathExtras.h</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">llvm::tgtok::Def</a></div><div class="ttdeci">@ Def</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00050">TGLexer.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIType_html"><div class="ttname"><a href="classllvm_1_1DIType.html">llvm::DIType</a></div><div class="ttdoc">Base class for types.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00697">DebugInfoMetadata.h:697</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIExpression_html_a9aef6cbb464a57070a26cf422b979df9"><div class="ttname"><a href="classllvm_1_1DIExpression.html#a9aef6cbb464a57070a26cf422b979df9">llvm::DIExpression::getNumLocationOperands</a></div><div class="ttdeci">uint64_t getNumLocationOperands() const</div><div class="ttdoc">Return the number of unique location operands referred to (via DW_OP_LLVM_arg) in this expression; th...</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8cpp_source.html#l01899">DebugInfoMetadata.cpp:1899</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">llvm::AArch64CC::AL</a></div><div class="ttdeci">@ AL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00269">AArch64BaseInfo.h:269</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7dc3069afa2ce5ea62ac2eb183e51c00"><div class="ttname"><a href="namespacellvm.html#a7dc3069afa2ce5ea62ac2eb183e51c00">llvm::none_of</a></div><div class="ttdeci">bool none_of(R &amp;&amp;Range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::none_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01749">STLExtras.h:1749</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="astructllvm_1_1OptimizedStructLayoutField_html_adae4afc395aed3ab340d695de637dd11"><div class="ttname"><a href="structllvm_1_1OptimizedStructLayoutField.html#adae4afc395aed3ab340d695de637dd11">llvm::OptimizedStructLayoutField::Offset</a></div><div class="ttdeci">uint64_t Offset</div><div class="ttdoc">The offset of this field in the final layout.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizedStructLayout_8h_source.html#l00059">OptimizedStructLayout.h:59</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a311a80924f5342813ae67daa5e5ff444"><div class="ttname"><a href="CoroFrame_8cpp.html#a311a80924f5342813ae67daa5e5ff444">eliminateSwiftError</a></div><div class="ttdeci">static void eliminateSwiftError(Function &amp;F, coro::Shape &amp;Shape)</div><div class="ttdoc">Eliminate all problematic uses of swifterror arguments and allocas from the function.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02609">CoroFrame.cpp:2609</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abe8f7906a8618f90e2a75109a778054a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">llvm::coro::Shape::SwitchLowering</a></div><div class="ttdeci">SwitchLoweringStorage SwitchLowering</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00141">CoroInternal.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIType_html_a8b53bdd5b8f1d8cd12a392c256cb54f3"><div class="ttname"><a href="classllvm_1_1DIType.html#a8b53bdd5b8f1d8cd12a392c256cb54f3">llvm::DIType::getSizeInBits</a></div><div class="ttdeci">uint64_t getSizeInBits() const</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00736">DebugInfoMetadata.h:736</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_a42438d0a43720a6571c9138224481754"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">llvm::AllocaInst::getAlign</a></div><div class="ttdeci">Align getAlign() const</div><div class="ttdoc">Return the alignment of the memory that is being allocated by the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00125">Instructions.h:125</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3b996fbf8458aafffc86cb98a68d0a47"><div class="ttname"><a href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const</div><div class="ttdoc">True if this is an instance of PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00249">Type.h:249</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html"><div class="ttname"><a href="classllvm_1_1DIBuilder.html">llvm::DIBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8h_source.html#l00042">DIBuilder.h:42</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_ac103d1b9c5e3a297b0f730cb03034d02"><div class="ttname"><a href="CoroFrame_8cpp.html#ac103d1b9c5e3a297b0f730cb03034d02">dumpAllocas</a></div><div class="ttdeci">static void dumpAllocas(const SmallVectorImpl&lt; AllocaInfo &gt; &amp;Allocas)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00552">CoroFrame.cpp:552</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a24c5fed9b14aed8a3b4f3828472fbab5"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">llvm::coro::Shape::FrameTy</a></div><div class="ttdeci">StructType * FrameTy</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00098">CoroInternal.h:98</a></div></div>
<div class="ttc" id="aInstIterator_8h_html"><div class="ttname"><a href="InstIterator_8h.html">InstIterator.h</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a54c76b23c53f62a58c09936547b2842d"><div class="ttname"><a href="CoroFrame_8cpp.html#a54c76b23c53f62a58c09936547b2842d">splitAround</a></div><div class="ttdeci">static void splitAround(Instruction *I, const Twine &amp;Name)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02324">CoroFrame.cpp:2324</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0b2ca98dc28c61793ff5c90d23e5f14e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::lookup</a></div><div class="ttdeci">ValueT lookup(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">lookup - Return the entry for the specified key, or a default constructed value if no such entry exis...</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00197">DenseMap.h:197</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa81eb67f09ee4944eaeeddbc54c0c0de"><div class="ttname"><a href="namespacellvm.html#aa81eb67f09ee4944eaeeddbc54c0c0de">llvm::lower_bound</a></div><div class="ttdeci">auto lower_bound(R &amp;&amp;Range, T &amp;&amp;Value)</div><div class="ttdoc">Provide wrappers to std::lower_bound which take ranges instead of having to pass begin/end explicitly...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01923">STLExtras.h:1923</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html_a7ff64b3625b6f9020556ed05a5f72af4"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">llvm::IntrinsicInst::getIntrinsicID</a></div><div class="ttdeci">Intrinsic::ID getIntrinsicID() const</div><div class="ttdoc">Return the intrinsic ID of this intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00054">IntrinsicInst.h:54</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a11eb2e9dc8e7e0d9af491ccb00d43147"><div class="ttname"><a href="CoroFrame_8cpp.html#a11eb2e9dc8e7e0d9af491ccb00d43147">emitSetSwiftErrorValue</a></div><div class="ttdeci">static Value * emitSetSwiftErrorValue(IRBuilder&lt;&gt; &amp;Builder, Value *V, coro::Shape &amp;Shape)</div><div class="ttdoc">Set the given value as the current swifterror value.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02495">CoroFrame.cpp:2495</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_acf0b1898efd7f81a078e9288befd9290"><div class="ttname"><a href="classllvm_1_1DataLayout.html#acf0b1898efd7f81a078e9288befd9290">llvm::DataLayout::getTypeSizeInBits</a></div><div class="ttdeci">TypeSize getTypeSizeInBits(Type *Ty) const</div><div class="ttdoc">Size examples:</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00669">DataLayout.h:669</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a3861d2f045e00a8114f99f751371ec68"><div class="ttname"><a href="classllvm_1_1StructType.html#a3861d2f045e00a8114f99f751371ec68">llvm::StructType::setBody</a></div><div class="ttdeci">void setBody(ArrayRef&lt; Type * &gt; Elements, bool isPacked=false)</div><div class="ttdoc">Specify a body for an opaque identified type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00447">Type.cpp:447</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05258">Instructions.h:5258</a></div></div>
<div class="ttc" id="astructllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4_html_a83f6404a5697ffe8f1b2c2813ea09a9c"><div class="ttname"><a href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a83f6404a5697ffe8f1b2c2813ea09a9c">llvm::GraphTraits&lt; RematGraph * &gt;::getEntryNode</a></div><div class="ttdeci">static NodeRef getEntryNode(RematGraph *G)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00422">CoroFrame.cpp:422</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26e2a938b431eaa6eca2beaa96410c9d"><div class="ttname"><a href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a></div><div class="ttdeci">auto successors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01265">MachineBasicBlock.h:1265</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_ac106bea55dfb26f8b14676aac05bd89f"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#ac106bea55dfb26f8b14676aac05bd89f">llvm::AllocaInst::getType</a></div><div class="ttdeci">PointerType * getType() const</div><div class="ttdoc">Overload to return most specific pointer type.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00100">Instructions.h:100</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_a26708685cc8b94fe3d7092ee080dbb34"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">llvm::ilist_node_with_parent::getNextNode</a></div><div class="ttdeci">NodeTy * getNextNode()</div><div class="ttdoc">Get the next node, or nullptr for the list tail.</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00289">ilist_node.h:289</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="astructllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4_html_a1f9cb0685800b508261501ca6019f772"><div class="ttname"><a href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a1f9cb0685800b508261501ca6019f772">llvm::GraphTraits&lt; RematGraph * &gt;::child_end</a></div><div class="ttdeci">static ChildIteratorType child_end(NodeRef N)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00426">CoroFrame.cpp:426</a></div></div>
<div class="ttc" id="aclassllvm_1_1LandingPadInst_html"><div class="ttname"><a href="classllvm_1_1LandingPadInst.html">llvm::LandingPadInst</a></div><div class="ttdoc">The landingpad instruction holds all of the information necessary to generate correct exception handl...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02956">Instructions.h:2956</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html_a432d533de0923ad3b0fd6dfc22c7ebd6"><div class="ttname"><a href="classllvm_1_1InstVisitor.html#a432d533de0923ad3b0fd6dfc22c7ebd6">llvm::InstVisitor&lt; DerivedT &gt;::visitIntrinsicInst</a></div><div class="ttdeci">void visitIntrinsicInst(IntrinsicInst &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00219">InstVisitor.h:219</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00880">DenseMap.h:880</a></div></div>
<div class="ttc" id="anamespacellvm_html_a683448397460b5b16e0d9016fd7a273a"><div class="ttname"><a href="namespacellvm.html#a683448397460b5b16e0d9016fd7a273a">llvm::findDbgUsers</a></div><div class="ttdeci">void findDbgUsers(SmallVectorImpl&lt; DbgVariableIntrinsic * &gt; &amp;DbgInsts, Value *V)</div><div class="ttdoc">Finds the debug info intrinsics describing a value.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l00105">DebugInfo.cpp:105</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a482498a1c760122fd33c7fc8190dd277"><div class="ttname"><a href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">llvm::Instruction::insertBefore</a></div><div class="ttdeci">void insertBefore(Instruction *InsertPos)</div><div class="ttdoc">Insert an unlinked instruction into a basic block immediately before the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00088">Instruction.cpp:88</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html_a212fcbee3e65ec41eebed2525fc15207"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html#a212fcbee3e65ec41eebed2525fc15207">llvm::DbgVariableIntrinsic::replaceVariableLocationOp</a></div><div class="ttdeci">void replaceVariableLocationOp(Value *OldValue, Value *NewValue)</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8cpp_source.html#l00114">IntrinsicInst.cpp:114</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_ab9fcdedd3580f924cf782f155b549a22"><div class="ttname"><a href="CoroFrame_8cpp.html#ab9fcdedd3580f924cf782f155b549a22">rewritePHIsForCleanupPad</a></div><div class="ttdeci">static void rewritePHIsForCleanupPad(BasicBlock *CleanupPadBB, CleanupPadInst *CleanupPad)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02041">CoroFrame.cpp:2041</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_a61135fb8666f0b7a37b4e1bbcf1db131"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a61135fb8666f0b7a37b4e1bbcf1db131">llvm::DataLayout::getStructLayout</a></div><div class="ttdeci">const StructLayout * getStructLayout(StructType *Ty) const</div><div class="ttdoc">Returns a StructLayout object, indicating the alignment of the struct, its size, and the offsets of i...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00698">DataLayout.cpp:698</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocation_html"><div class="ttname"><a href="classllvm_1_1DILocation.html">llvm::DILocation</a></div><div class="ttdoc">Debug location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01605">DebugInfoMetadata.h:1605</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroAllocaAllocInst_html"><div class="ttname"><a href="classllvm_1_1CoroAllocaAllocInst.html">llvm::CoroAllocaAllocInst</a></div><div class="ttdoc">This represents the llvm.coro.alloca.alloc instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00670">CoroInstr.h:670</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIType_html_afabf2c71538af4463120b743db12fcf0"><div class="ttname"><a href="classllvm_1_1DIType.html#afabf2c71538af4463120b743db12fcf0">llvm::DIType::getAlignInBits</a></div><div class="ttdeci">uint32_t getAlignInBits() const</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00737">DebugInfoMetadata.h:737</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html_a5b052a3578e5c55ba04a8e8e87d7d584"><div class="ttname"><a href="classllvm_1_1InstVisitor.html#a5b052a3578e5c55ba04a8e8e87d7d584">llvm::InstVisitor&lt; DerivedT &gt;::visitBitCastInst</a></div><div class="ttdeci">void visitBitCastInst(BitCastInst &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00187">InstVisitor.h:187</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a8356860a8bef082ff15df896ecec7732"><div class="ttname"><a href="CoroFrame_8cpp.html#a8356860a8bef082ff15df896ecec7732">eliminateSwiftErrorArgument</a></div><div class="ttdeci">static void eliminateSwiftErrorArgument(Function &amp;F, Argument &amp;Arg, coro::Shape &amp;Shape, SmallVectorImpl&lt; AllocaInst * &gt; &amp;AllocasToPromote)</div><div class="ttdoc">&quot;Eliminate&quot; a swifterror argument by reducing it to the alloca case and then loading and storing in t...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02569">CoroFrame.cpp:2569</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a4e554c60419835fc3c74b91b28ca31c8"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">llvm::coro::Shape::ABI</a></div><div class="ttdeci">coro::ABI ABI</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00096">CoroInternal.h:96</a></div></div>
<div class="ttc" id="aclassBlockData_html_a3a4dfddb67525d6766e5b78956395fb9"><div class="ttname"><a href="classBlockData.html#a3a4dfddb67525d6766e5b78956395fb9">BlockData::BlockData</a></div><div class="ttdeci">BlockData()</div><div class="ttdef"><b>Definition:</b> <a href="SIModeRegister_8cpp_source.html#l00105">SIModeRegister.cpp:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a79c007dcf9fff57e1569e778d7885b5e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a79c007dcf9fff57e1569e778d7885b5e">llvm::BasicBlock::getSingleSuccessor</a></div><div class="ttdeci">const BasicBlock * getSingleSuccessor() const</div><div class="ttdoc">Return the successor of this block if it has a single successor.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00314">BasicBlock.cpp:314</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a52c990590792c91dd20b6d45acebe359"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a52c990590792c91dd20b6d45acebe359">llvm::BasicBlock::splitBasicBlock</a></div><div class="ttdeci">BasicBlock * splitBasicBlock(iterator I, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the basic block into two basic blocks at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00401">BasicBlock.cpp:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1TinyPtrVector_html_a3a26404d33061e8aaeab39c490181389"><div class="ttname"><a href="classllvm_1_1TinyPtrVector.html#a3a26404d33061e8aaeab39c490181389">llvm::TinyPtrVector::front</a></div><div class="ttdeci">EltTy front() const</div><div class="ttdef"><b>Definition:</b> <a href="TinyPtrVector_8h_source.html#l00229">TinyPtrVector.h:229</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html_ac161deb2a31f78c85f94fbe0f3ba97b4"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html#ac161deb2a31f78c85f94fbe0f3ba97b4">llvm::DbgVariableIntrinsic::getVariable</a></div><div class="ttdeci">DILocalVariable * getVariable() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00288">IntrinsicInst.h:288</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsic_html"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html">llvm::MemIntrinsic</a></div><div class="ttdoc">This is the common base class for memset/memcpy/memmove.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01048">IntrinsicInst.h:1048</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_aff44497b1660786285d7908a98f940f5"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#aff44497b1660786285d7908a98f940f5">llvm::coro::Shape::getPromiseAlloca</a></div><div class="ttdeci">AllocaInst * getPromiseAlloca() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00234">CoroInternal.h:234</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a250e66aa31a03567cc345ca1bc463b8c"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a></div><div class="ttdeci">uint64_t Offset</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00080">ELFObjHandler.cpp:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt; Instruction *, 4 &gt;</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_acdaf5010e3f77d9d6e8ae04f5e0248e8"><div class="ttname"><a href="CoroFrame_8cpp.html#acdaf5010e3f77d9d6e8ae04f5e0248e8">solveTypeName</a></div><div class="ttdeci">static StringRef solveTypeName(Type *Ty)</div><div class="ttdoc">Create name for Type.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00960">CoroFrame.cpp:960</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1a4cac84457299517e69ff9764fed2db"><div class="ttname"><a href="namespacellvm.html#a1a4cac84457299517e69ff9764fed2db">llvm::PromoteMemToReg</a></div><div class="ttdeci">void PromoteMemToReg(ArrayRef&lt; AllocaInst * &gt; Allocas, DominatorTree &amp;DT, AssumptionCache *AC=nullptr)</div><div class="ttdoc">Promote the specified list of alloca instructions into scalar registers, inserting PHI nodes as appro...</div><div class="ttdef"><b>Definition:</b> <a href="PromoteMemoryToRegister_8cpp_source.html#l01102">PromoteMemoryToRegister.cpp:1102</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a59fb91d1691350f7d1b8e8a114e3f2a4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">llvm::BasicBlock::getSinglePredecessor</a></div><div class="ttdeci">const BasicBlock * getSinglePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a single predecessor block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00284">BasicBlock.cpp:284</a></div></div>
<div class="ttc" id="anamespacellvm_html_a03503773241005f01b090b9862aad304"><div class="ttname"><a href="namespacellvm.html#a03503773241005f01b090b9862aad304">llvm::dump</a></div><div class="ttdeci">void dump(const SparseBitVector&lt; ElementSize &gt; &amp;LHS, raw_ostream &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="SparseBitVector_8h_source.html#l00877">SparseBitVector.h:877</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_adbf77460ca5103d4d0b2708b013a1b88"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#adbf77460ca5103d4d0b2708b013a1b88">llvm::DIBuilder::createMemberType</a></div><div class="ttdeci">DIDerivedType * createMemberType(DIScope *Scope, StringRef Name, DIFile *File, unsigned LineNo, uint64_t SizeInBits, uint32_t AlignInBits, uint64_t OffsetInBits, DINode::DIFlags Flags, DIType *Ty, DINodeArray Annotations=nullptr)</div><div class="ttdoc">Create debugging information entry for a member.</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l00380">DIBuilder.cpp:380</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIExpression_html"><div class="ttname"><a href="classllvm_1_1DIExpression.html">llvm::DIExpression</a></div><div class="ttdoc">DWARF expression.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l02611">DebugInfoMetadata.h:2611</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a711449044c2aef3a8aba56149e421b60"><div class="ttname"><a href="CoroFrame_8cpp.html#a711449044c2aef3a8aba56149e421b60">willLeaveFunctionImmediatelyAfter</a></div><div class="ttdeci">static bool willLeaveFunctionImmediatelyAfter(BasicBlock *BB, unsigned depth=3)</div><div class="ttdoc">After we split the coroutine, will the given basic block be along an obvious exit path for the resump...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02374">CoroFrame.cpp:2374</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_aac5759c83abd6a4af236401a7cfe7a0f"><div class="ttname"><a href="classllvm_1_1Type.html#aac5759c83abd6a4af236401a7cfe7a0f">llvm::Type::isFloatingPointTy</a></div><div class="ttdeci">bool isFloatingPointTy() const</div><div class="ttdoc">Return true if this is one of the floating-point types.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00185">Type.h:185</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_abceff71202e0269065cf32a2f750a9be"><div class="ttname"><a href="classllvm_1_1Type.html#abceff71202e0269065cf32a2f750a9be">llvm::Type::getNonOpaquePointerElementType</a></div><div class="ttdeci">Type * getNonOpaquePointerElementType() const</div><div class="ttdoc">Only use this method in code that is not reachable with opaque pointers, or part of deprecated method...</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00416">Type.h:416</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_a6af0b7b0e5d0e8f4b8b4f4199a885204"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a6af0b7b0e5d0e8f4b8b4f4199a885204">llvm::coro::Shape::SwitchLoweringStorage::PromiseAlloca</a></div><div class="ttdeci">AllocaInst * PromiseAlloca</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00109">CoroInternal.h:109</a></div></div>
<div class="ttc" id="anamespacellvm_html_a603eb2d37a31ea2c14318bedeecb8e3c"><div class="ttname"><a href="namespacellvm.html#a603eb2d37a31ea2c14318bedeecb8e3c">llvm::getOffset</a></div><div class="ttdeci">static Error getOffset(const SymbolRef &amp;Sym, SectionRef Sec, uint64_t &amp;Result)</div><div class="ttdef"><b>Definition:</b> <a href="RuntimeDyld_8cpp_source.html#l00172">RuntimeDyld.cpp:172</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html_a5702a1d09ac6ee86196a38b3f682a570"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html#a5702a1d09ac6ee86196a38b3f682a570">llvm::DbgVariableIntrinsic::getVariableLocationOp</a></div><div class="ttdeci">Value * getVariableLocationOp(unsigned OpIdx) const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8cpp_source.html#l00092">IntrinsicInst.cpp:92</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage_html_a3bf2569bd6f6975476d99b67f036a0e7"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a3bf2569bd6f6975476d99b67f036a0e7">llvm::coro::Shape::AsyncLoweringStorage::ContextHeaderSize</a></div><div class="ttdeci">uint64_t ContextHeaderSize</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00131">CoroInternal.h:131</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aMustExecute_8cpp_html_a13fbdcf3bc34f504e8f2b5f2aa7d7f7c"><div class="ttname"><a href="MustExecute_8cpp.html#a13fbdcf3bc34f504e8f2b5f2aa7d7f7c">instructions</a></div><div class="ttdeci">print must be executed print the must be executed context for all instructions</div><div class="ttdef"><b>Definition:</b> <a href="MustExecute_8cpp_source.html#l00362">MustExecute.cpp:362</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_acad2aaa7f484c978bb790533eec90ac4"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#acad2aaa7f484c978bb790533eec90ac4">llvm::coro::Shape::emitDealloc</a></div><div class="ttdeci">void emitDealloc(IRBuilder&lt;&gt; &amp;Builder, Value *Ptr, CallGraph *CG) const</div><div class="ttdoc">Deallocate memory according to the rules of the active lowering.</div><div class="ttdef"><b>Definition:</b> <a href="Coroutines_8cpp_source.html#l00476">Coroutines.cpp:476</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_ae6081972b0560d0f16bd503654924b1b"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#ae6081972b0560d0f16bd503654924b1b">llvm::DIBuilder::createAutoVariable</a></div><div class="ttdeci">DILocalVariable * createAutoVariable(DIScope *Scope, StringRef Name, DIFile *File, unsigned LineNo, DIType *Ty, bool AlwaysPreserve=false, DINode::DIFlags Flags=DINode::FlagZero, uint32_t AlignInBits=0)</div><div class="ttdoc">Create a new descriptor for an auto variable.</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l00799">DIBuilder.cpp:799</a></div></div>
<div class="ttc" id="aNVVMIntrRange_8cpp_html_afad351d7bf10ac0446b64e7827634e94"><div class="ttname"><a href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a></div><div class="ttdeci">LLVMContext &amp; Context</div><div class="ttdef"><b>Definition:</b> <a href="NVVMIntrRange_8cpp_source.html#l00066">NVVMIntrRange.cpp:66</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_a8f163bf8a14c1c7823f6d8fce7fb5ac7"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#a8f163bf8a14c1c7823f6d8fce7fb5ac7">llvm::DIBuilder::createPointerType</a></div><div class="ttdeci">DIDerivedType * createPointerType(DIType *PointeeTy, uint64_t SizeInBits, uint32_t AlignInBits=0, std::optional&lt; unsigned &gt; DWARFAddressSpace=std::nullopt, StringRef Name=&quot;&quot;, DINodeArray Annotations=nullptr)</div><div class="ttdoc">Create debugging information entry for a pointer.</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l00319">DIBuilder.cpp:319</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_af09e4096de244d2fb345891328714a63"><div class="ttname"><a href="classllvm_1_1Instruction.html#af09e4096de244d2fb345891328714a63">llvm::Instruction::insertAfter</a></div><div class="ttdeci">void insertAfter(Instruction *InsertPos)</div><div class="ttdoc">Insert an unlinked instruction into a basic block immediately after the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00094">Instruction.cpp:94</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ae3a9a76ce45cff6c0385091993bccdcc"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ae3a9a76ce45cff6c0385091993bccdcc">llvm::coro::Shape::AllocaSpillBlock</a></div><div class="ttdeci">BasicBlock * AllocaSpillBlock</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00102">CoroInternal.h:102</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a03cdd58b24dc91b4e3819e218a399cbf"><div class="ttname"><a href="CoroFrame_8cpp.html#a03cdd58b24dc91b4e3819e218a399cbf">cleanupSinglePredPHIs</a></div><div class="ttdeci">static void cleanupSinglePredPHIs(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02116">CoroFrame.cpp:2116</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage_html_a4df922b446b5bfca3248510df728539b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">llvm::coro::Shape::RetconLoweringStorage::IsFrameInlineInStorage</a></div><div class="ttdeci">bool IsFrameInlineInStorage</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00123">CoroInternal.h:123</a></div></div>
<div class="ttc" id="aStackLifetime_8h_html"><div class="ttname"><a href="StackLifetime_8h.html">StackLifetime.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AddrSpaceCastInst_html"><div class="ttname"><a href="classllvm_1_1AddrSpaceCastInst.html">llvm::AddrSpaceCastInst</a></div><div class="ttdoc">This class represents a conversion between pointers from one address space to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05298">Instructions.h:5298</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_adb13793b98ab59209a5309d26f831850"><div class="ttname"><a href="classllvm_1_1SetVector.html#adb13793b98ab59209a5309d26f831850">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Get an iterator to the beginning of the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00082">SetVector.h:82</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_ab32716a9639a60407ce76b1533323722"><div class="ttname"><a href="CoroFrame_8cpp.html#ab32716a9639a60407ce76b1533323722">emitGetSwiftErrorValue</a></div><div class="ttdeci">static Value * emitGetSwiftErrorValue(IRBuilder&lt;&gt; &amp;Builder, Type *ValueTy, coro::Shape &amp;Shape)</div><div class="ttdoc">Get the current swifterror value.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02480">CoroFrame.cpp:2480</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a16c39eb6e60b42a40c399d8d65347bb6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const</div><div class="ttdoc">Return incoming value number x.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02794">Instructions.h:2794</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgValueInst_html"><div class="ttname"><a href="classllvm_1_1DbgValueInst.html">llvm::DbgValueInst</a></div><div class="ttdoc">This represents the llvm.dbg.value instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00388">IntrinsicInst.h:388</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_a074617b3e2f9f98ee3a2ac208e8e7210"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">llvm::AllocaInst::getAllocatedType</a></div><div class="ttdeci">Type * getAllocatedType() const</div><div class="ttdoc">Return the type that is being allocated by the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00118">Instructions.h:118</a></div></div>
<div class="ttc" id="aSmallString_8h_html"><div class="ttname"><a href="SmallString_8h.html">SmallString.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocalVariable_html"><div class="ttname"><a href="classllvm_1_1DILocalVariable.html">llvm::DILocalVariable</a></div><div class="ttdoc">Local variable.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l03170">DebugInfoMetadata.h:3170</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html_a9481f3ebdbe940c0b6fe67d1fe0e45a2"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html#a9481f3ebdbe940c0b6fe67d1fe0e45a2">llvm::PtrUseVisitor::visitGetElementPtrInst</a></div><div class="ttdeci">void visitGetElementPtrInst(GetElementPtrInst &amp;GEPI)</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00259">PtrUseVisitor.h:259</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a47b0e7da15eccab3545643118aa2f99f"><div class="ttname"><a href="CoroFrame_8cpp.html#a47b0e7da15eccab3545643118aa2f99f">localAllocaNeedsStackSave</a></div><div class="ttdeci">static bool localAllocaNeedsStackSave(CoroAllocaAllocInst *AI)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02393">CoroFrame.cpp:2393</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__PROC_html_aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#aac31dd660a6f18140efdd62b351cb11bad9577456b5bb7a03b7f42a710e122ab5">llvm::ARM_PROC::A</a></div><div class="ttdeci">@ A</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00034">ARMBaseInfo.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitVector_html_abf86e1383aec181a5a2d9967eb8070fd"><div class="ttname"><a href="classllvm_1_1BitVector.html#abf86e1383aec181a5a2d9967eb8070fd">llvm::BitVector::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdoc">size - Returns the number of bits in this bitvector.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00152">BitVector.h:152</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_aba618c16a34739af0506ba1082d209a3"><div class="ttname"><a href="CoroFrame_8cpp.html#aba618c16a34739af0506ba1082d209a3">rewriteMaterializableInstructions</a></div><div class="ttdeci">static void rewriteMaterializableInstructions(const SmallMapVector&lt; Instruction *, std::unique_ptr&lt; RematGraph &gt;, 8 &gt; &amp;AllRemats)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02233">CoroFrame.cpp:2233</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a4d0a50f63402f509e3f6c62a6c513fbf"><div class="ttname"><a href="classllvm_1_1Type.html#a4d0a50f63402f509e3f6c62a6c513fbf">llvm::Type::getStructName</a></div><div class="ttdeci">StringRef getStructName() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00344">DerivedTypes.h:344</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a96b22cedfbc659e2d8c1239a0fd9618d"><div class="ttname"><a href="CoroFrame_8cpp.html#a96b22cedfbc659e2d8c1239a0fd9618d">lowerNonLocalAlloca</a></div><div class="ttdeci">static Instruction * lowerNonLocalAlloca(CoroAllocaAllocInst *AI, coro::Shape &amp;Shape, SmallVectorImpl&lt; Instruction * &gt; &amp;DeadInsts)</div><div class="ttdoc">Turn the given coro.alloca.alloc call into a dynamic allocation.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02455">CoroFrame.cpp:2455</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html_aefd0a9d7224ad6eb0a24c20197c5dc53"><div class="ttname"><a href="classllvm_1_1InstVisitor.html#aefd0a9d7224ad6eb0a24c20197c5dc53">llvm::InstVisitor&lt; DerivedT &gt;::visitGetElementPtrInst</a></div><div class="ttdeci">void visitGetElementPtrInst(GetElementPtrInst &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00174">InstVisitor.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendInst_html"><div class="ttname"><a href="classllvm_1_1CoroSuspendInst.html">llvm::CoroSuspendInst</a></div><div class="ttdoc">This represents the llvm.coro.suspend instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00493">CoroInstr.h:493</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">llvm::ms_demangle::QualifierMangleMode::Result</a></div><div class="ttdeci">@ Result</div></div>
<div class="ttc" id="aclassllvm_1_1StructLayout_html_a38bfb6d6dbaf3f8ca7764969563f486d"><div class="ttname"><a href="classllvm_1_1StructLayout.html#a38bfb6d6dbaf3f8ca7764969563f486d">llvm::StructLayout::getElementOffsetInBits</a></div><div class="ttdeci">uint64_t getElementOffsetInBits(unsigned Idx) const</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00653">DataLayout.h:653</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIType_html_a777848a3e8c10c10721c852d4efb9e3b"><div class="ttname"><a href="classllvm_1_1DIType.html#a777848a3e8c10c10721c852d4efb9e3b">llvm::DIType::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00743">DebugInfoMetadata.h:743</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReversePostOrderTraversal_html_ae945899e1218a9240c3fed1e5789cbba"><div class="ttname"><a href="classllvm_1_1ReversePostOrderTraversal.html#ae945899e1218a9240c3fed1e5789cbba">llvm::ReversePostOrderTraversal::end</a></div><div class="ttdeci">rpo_iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00311">PostOrderIterator.h:311</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_aecb93439702247fe5353a9966f7cefcd"><div class="ttname"><a href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">llvm::Value::uses</a></div><div class="ttdeci">iterator_range&lt; use_iterator &gt; uses()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00376">Value.h:376</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00245">BasicBlock.cpp:245</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a5fd0aa934908c837c6d78097a2fd667b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">llvm::coro::Shape::CoroSuspends</a></div><div class="ttdeci">SmallVector&lt; AnyCoroSuspendInst *, 4 &gt; CoroSuspends</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00078">CoroInternal.h:78</a></div></div>
<div class="ttc" id="aXCoreFrameLowering_8cpp_html_a64f8c7400de58c117c5af250f000675f"><div class="ttname"><a href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a></div><div class="ttdeci">static const unsigned FramePtr</div><div class="ttdef"><b>Definition:</b> <a href="XCoreFrameLowering_8cpp_source.html#l00034">XCoreFrameLowering.cpp:34</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a55af5cce8eb7833907578e6fc3f0ab5e"><div class="ttname"><a href="CoroFrame_8cpp.html#a55af5cce8eb7833907578e6fc3f0ab5e">eliminateSwiftErrorAlloca</a></div><div class="ttdeci">static void eliminateSwiftErrorAlloca(Function &amp;F, AllocaInst *Alloca, coro::Shape &amp;Shape)</div><div class="ttdoc">Eliminate a formerly-swifterror alloca by inserting the get/set intrinsics and attempting to MemToReg...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02543">CoroFrame.cpp:2543</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="astructllvm_1_1MaybeAlign_html"><div class="ttname"><a href="structllvm_1_1MaybeAlign.html">llvm::MaybeAlign</a></div><div class="ttdoc">This struct is a compact representation of a valid (power of two) or undefined (0) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00117">Alignment.h:117</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html_a71808acf992f787300ec18d5700f09cc"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html#a71808acf992f787300ec18d5700f09cc">llvm::DbgVariableIntrinsic::setExpression</a></div><div class="ttdeci">void setExpression(DIExpression *NewExpr)</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00250">IntrinsicInst.h:250</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_adc470e92d3cd5fb8d54d7b9179841463"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#adc470e92d3cd5fb8d54d7b9179841463">llvm::coro::Shape::CoroEnds</a></div><div class="ttdeci">SmallVector&lt; AnyCoroEndInst *, 4 &gt; CoroEnds</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00075">CoroInternal.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a311a963e369623329d830d9fc086cef5"><div class="ttname"><a href="namespacellvm_1_1coro.html#a311a963e369623329d830d9fc086cef5">llvm::coro::buildCoroutineFrame</a></div><div class="ttdeci">void buildCoroutineFrame(Function &amp;F, Shape &amp;Shape, const std::function&lt; bool(Instruction &amp;)&gt; &amp;MaterializableCallback)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02957">CoroFrame.cpp:2957</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_a800e74bec9b78d6739665027c3616a55"><div class="ttname"><a href="classllvm_1_1DataLayout.html#a800e74bec9b78d6739665027c3616a55">llvm::DataLayout::getABITypeAlign</a></div><div class="ttdeci">Align getABITypeAlign(Type *Ty) const</div><div class="ttdoc">Returns the minimum ABI-required alignment for the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00848">DataLayout.cpp:848</a></div></div>
<div class="ttc" id="anamespacellvm_html_a06ac4fd2f05423f4d1a20a0ac699807c"><div class="ttname"><a href="namespacellvm.html#a06ac4fd2f05423f4d1a20a0ac699807c">llvm::FindDbgDeclareUses</a></div><div class="ttdeci">TinyPtrVector&lt; DbgDeclareInst * &gt; FindDbgDeclareUses(Value *V)</div><div class="ttdoc">Like FindDbgAddrUses, but only returns dbg.declare intrinsics, not dbg.addr.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l00071">DebugInfo.cpp:71</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_aaca14fdf6d151782f7ab0a66405453fb"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#aaca14fdf6d151782f7ab0a66405453fb">llvm::AllocaInst::getArraySize</a></div><div class="ttdeci">const Value * getArraySize() const</div><div class="ttdoc">Get the number of elements allocated.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00096">Instructions.h:96</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7f2a3d4dcfee70225988aec53ff1e173"><div class="ttname"><a href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">llvm::report_fatal_error</a></div><div class="ttdeci">void report_fatal_error(Error Err, bool gen_crash_diag=true)</div><div class="ttdoc">Report a serious error, calling any installed error handler.</div><div class="ttdef"><b>Definition:</b> <a href="Testing_2Support_2Error_8cpp_source.html#l00145">Error.cpp:145</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26be1141b23850a2b4eb78021d99e862"><div class="ttname"><a href="namespacellvm.html#a26be1141b23850a2b4eb78021d99e862">llvm::salvageDebugInfo</a></div><div class="ttdeci">void salvageDebugInfo(const MachineRegisterInfo &amp;MRI, MachineInstr &amp;MI)</div><div class="ttdoc">Assuming the instruction MI is going to be deleted, attempt to salvage debug users of MI by writing t...</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l01367">Utils.cpp:1367</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a35ee267850af7c235474a8c46c7ac5af"><div class="ttname"><a href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">llvm::Value::setName</a></div><div class="ttdeci">void setName(const Twine &amp;Name)</div><div class="ttdoc">Change the name of the value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00375">Value.cpp:375</a></div></div>
<div class="ttc" id="aBitVector_8h_html"><div class="ttname"><a href="BitVector_8h.html">BitVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a50a2e57da274f8d69b9f932977379cdf"><div class="ttname"><a href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">llvm::Use::getUser</a></div><div class="ttdeci">User * getUser() const</div><div class="ttdoc">Returns the User that contains this Use.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00072">Use.h:72</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a9c2c728c358082fa0b0f7d7672a9819a"><div class="ttname"><a href="CoroFrame_8cpp.html#a9c2c728c358082fa0b0f7d7672a9819a">sinkSpillUsesAfterCoroBegin</a></div><div class="ttdeci">static void sinkSpillUsesAfterCoroBegin(Function &amp;F, const FrameDataInfo &amp;FrameData, CoroBeginInst *CoroBegin)</div><div class="ttdoc">retcon and retcon.once conventions assume that all spill uses can be sunk after the coro....</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02642">CoroFrame.cpp:2642</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html_a6b5f364cdf10081c74343b149fbc325f"><div class="ttname"><a href="classllvm_1_1InstVisitor.html#a6b5f364cdf10081c74343b149fbc325f">llvm::InstVisitor&lt; DerivedT &gt;::visitPHINode</a></div><div class="ttdeci">void visitPHINode(PHINode &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00175">InstVisitor.h:175</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitVector_html"><div class="ttname"><a href="classllvm_1_1BitVector.html">llvm::BitVector</a></div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00075">BitVector.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a0fd53f63d349dc8a7c5fc0cdd7a94c8d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0fd53f63d349dc8a7c5fc0cdd7a94c8d">llvm::Instruction::removeFromParent</a></div><div class="ttdeci">void removeFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block, but does not delete it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00078">Instruction.cpp:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroIdInst_html_ab330f042033636da90859626bc4dc542"><div class="ttname"><a href="classllvm_1_1CoroIdInst.html#ab330f042033636da90859626bc4dc542">llvm::CoroIdInst::clearPromise</a></div><div class="ttdeci">void clearPromise()</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00124">CoroInstr.h:124</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a043cdaf7b89aaeeb127be5d93411637f"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a></div><div class="ttdeci">uint64_t Align</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00082">ELFObjHandler.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a46ef6115027606b67adcf4d28f3dac17"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">llvm::BasicBlock::getFirstNonPHI</a></div><div class="ttdeci">const Instruction * getFirstNonPHI() const</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00208">BasicBlock.cpp:208</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a463baf545246fea9718664d933ffe66f">llvm::MCID::Call</a></div><div class="ttdeci">@ Call</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00156">MCInstrDesc.h:156</a></div></div>
<div class="ttc" id="anamespacellvm_html_a833a6084a93d5900e8bdd493b37bbbc7"><div class="ttname"><a href="namespacellvm.html#a833a6084a93d5900e8bdd493b37bbbc7">llvm::ehAwareSplitEdge</a></div><div class="ttdeci">BasicBlock * ehAwareSplitEdge(BasicBlock *BB, BasicBlock *Succ, LandingPadInst *OriginalPad=nullptr, PHINode *LandingPadReplacement=nullptr, const CriticalEdgeSplittingOptions &amp;Options=CriticalEdgeSplittingOptions(), const Twine &amp;BBName=&quot;&quot;)</div><div class="ttdoc">Split the edge connect the specficed blocks in the case that Succ is an Exception Handling Block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00686">BasicBlockUtils.cpp:686</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_afee05194feacd4f95209e840e7242332"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#afee05194feacd4f95209e840e7242332">llvm::DIBuilder::replaceArrays</a></div><div class="ttdeci">void replaceArrays(DICompositeType *&amp;T, DINodeArray Elements, DINodeArray TParams=DINodeArray())</div><div class="ttdoc">Replace arrays on a composite type.</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l01169">DIBuilder.cpp:1169</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a9f46b526663b3a99b56fbcf1612a28a0"><div class="ttname"><a href="CoroFrame_8cpp.html#a9f46b526663b3a99b56fbcf1612a28a0">sinkLifetimeStartMarkers</a></div><div class="ttdeci">static void sinkLifetimeStartMarkers(Function &amp;F, coro::Shape &amp;Shape, SuspendCrossingInfo &amp;Checker)</div><div class="ttdoc">For each local variable that all of its user are only used inside one of suspended region,...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02689">CoroFrame.cpp:2689</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a0a1a8e48ba1e5d845e979d5da8de597d"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">llvm::coro::Shape::FrameAlign</a></div><div class="ttdeci">Align FrameAlign</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00099">CoroInternal.h:99</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallString_html"><div class="ttname"><a href="classllvm_1_1SmallString.html">llvm::SmallString&lt; 16 &gt;</a></div></div>
<div class="ttc" id="aIR_2CFG_8h_html"><div class="ttname"><a href="IR_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_a3016b467a9ecb5506956f7d029509db5"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a3016b467a9ecb5506956f7d029509db5">llvm::AllocaInst::isSwiftError</a></div><div class="ttdeci">bool isSwiftError() const</div><div class="ttdoc">Return true if this alloca is used as a swifterror argument to a call.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00150">Instructions.h:150</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReversePostOrderTraversal_html_ac958000d711f19778f1b40792821b5b3"><div class="ttname"><a href="classllvm_1_1ReversePostOrderTraversal.html#ac958000d711f19778f1b40792821b5b3">llvm::ReversePostOrderTraversal::begin</a></div><div class="ttdeci">rpo_iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00309">PostOrderIterator.h:309</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html_a4c1c1093a7749409c70838678514cc7c"><div class="ttname"><a href="classllvm_1_1Twine.html#a4c1c1093a7749409c70838678514cc7c">llvm::Twine::str</a></div><div class="ttdeci">std::string str() const</div><div class="ttdoc">Return the twine contents as a std::string.</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8cpp_source.html#l00017">Twine.cpp:17</a></div></div>
<div class="ttc" id="aMIRNamerPass_8cpp_html_a05e4be4ec3e2c3587dda0e376bb6822c"><div class="ttname"><a href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a></div><div class="ttdeci">mir Rename Register Operands</div><div class="ttdef"><b>Definition:</b> <a href="MIRNamerPass_8cpp_source.html#l00074">MIRNamerPass.cpp:74</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocalVariable_html_accfecccb150b316edf9b05e2d1fe117f"><div class="ttname"><a href="classllvm_1_1DILocalVariable.html#accfecccb150b316edf9b05e2d1fe117f">llvm::DILocalVariable::getScope</a></div><div class="ttdeci">DILocalScope * getScope() const</div><div class="ttdoc">Get the local scope for this variable.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l03228">DebugInfoMetadata.h:3228</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html">llvm::coro::Shape</a></div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00073">CoroInternal.h:73</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a0cca043bc17f6f673acb6324db527dae"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a0cca043bc17f6f673acb6324db527dae">llvm::coro::Shape::AsyncLowering</a></div><div class="ttdeci">AsyncLoweringStorage AsyncLowering</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00143">CoroInternal.h:143</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="anamespacellvm_html_a74cdbd1e4f731e7d7cd83461b8b1de0b"><div class="ttname"><a href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a></div><div class="ttdeci">void sort(IteratorTy Start, IteratorTy End)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01683">STLExtras.h:1683</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html_af177474d916756cfc8dac87397fc08c6"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html#af177474d916756cfc8dac87397fc08c6">llvm::PtrUseVisitor::visitMemIntrinsic</a></div><div class="ttdeci">void visitMemIntrinsic(MemIntrinsic &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00276">PtrUseVisitor.h:276</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_af9185c7e96873c6d2c13e1f1b6322cf6"><div class="ttname"><a href="classllvm_1_1DataLayout.html#af9185c7e96873c6d2c13e1f1b6322cf6">llvm::DataLayout::getPrefTypeAlign</a></div><div class="ttdeci">Align getPrefTypeAlign(Type *Ty) const</div><div class="ttdoc">Returns the preferred stack/global alignment for the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00857">DataLayout.cpp:857</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a0c7538ac13a28b2830b46b272c7ccfd4"><div class="ttname"><a href="CoroFrame_8cpp.html#a0c7538ac13a28b2830b46b272c7ccfd4">isCoroutineStructureIntrinsic</a></div><div class="ttdeci">static bool isCoroutineStructureIntrinsic(Instruction &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02225">CoroFrame.cpp:2225</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a1833296d8e82f27935a4302e47b60690"><div class="ttname"><a href="CoroFrame_8cpp.html#a1833296d8e82f27935a4302e47b60690">createFramePtr</a></div><div class="ttdeci">static void createFramePtr(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l01678">CoroFrame.cpp:1678</a></div></div>
<div class="ttc" id="aRDFGraph_8cpp_html_af153ca0eadca8bc464492b7aba7feb00"><div class="ttname"><a href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a></div><div class="ttdeci">const DataFlowGraph &amp; G</div><div class="ttdef"><b>Definition:</b> <a href="RDFGraph_8cpp_source.html#l00200">RDFGraph.cpp:200</a></div></div>
<div class="ttc" id="astructllvm_1_1SmallMapVector_html"><div class="ttname"><a href="structllvm_1_1SmallMapVector.html">llvm::SmallMapVector</a></div><div class="ttdoc">A MapVector that performs no allocations if smaller than a certain size.</div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00233">MapVector.h:233</a></div></div>
<div class="ttc" id="aCoroInternal_8h_html"><div class="ttname"><a href="CoroInternal_8h.html">CoroInternal.h</a></div></div>
<div class="ttc" id="astructllvm_1_1OptimizedStructLayoutField_html_a31b084098ebbf47988d1817a597b52d2"><div class="ttname"><a href="structllvm_1_1OptimizedStructLayoutField.html#a31b084098ebbf47988d1817a597b52d2">llvm::OptimizedStructLayoutField::Alignment</a></div><div class="ttdeci">Align Alignment</div><div class="ttdoc">The required alignment of this field.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizedStructLayout_8h_source.html#l00073">OptimizedStructLayout.h:73</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a40360b4fa7b8e6920a68e5a8a0814f1f"><div class="ttname"><a href="classllvm_1_1Use.html#a40360b4fa7b8e6920a68e5a8a0814f1f">llvm::Use::set</a></div><div class="ttdeci">void set(Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00865">Value.h:865</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html">llvm::DbgVariableIntrinsic</a></div><div class="ttdoc">This is the common base class for debug info intrinsics for variables.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00181">IntrinsicInst.h:181</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a897ca0443b61ca11b2da59e381e8a84a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">llvm::coro::Shape::SwiftErrorOps</a></div><div class="ttdeci">SmallVector&lt; CallInst *, 2 &gt; SwiftErrorOps</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00079">CoroInternal.h:79</a></div></div>
<div class="ttc" id="aclassllvm_1_1CleanupPadInst_html"><div class="ttname"><a href="classllvm_1_1CleanupPadInst.html">llvm::CleanupPadInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04491">Instructions.h:4491</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html_aeb67eff747cfcdb17ca1079aff8ed9ca"><div class="ttname"><a href="classllvm_1_1InstVisitor.html#aeb67eff747cfcdb17ca1079aff8ed9ca">llvm::InstVisitor&lt; DerivedT &gt;::visitSelectInst</a></div><div class="ttdeci">void visitSelectInst(SelectInst &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00189">InstVisitor.h:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a153ea412ff7a0ba105111155d1e16128"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a153ea412ff7a0ba105111155d1e16128">llvm::SmallPtrSetImpl::find</a></div><div class="ttdeci">iterator find(ConstPtrType Ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00386">SmallPtrSet.h:386</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a0b7abf908b6ce436de4d1012f2df7c0c"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a0b7abf908b6ce436de4d1012f2df7c0c">llvm::ArrayRef::drop_front</a></div><div class="ttdeci">ArrayRef&lt; T &gt; drop_front(size_t N=1) const</div><div class="ttdoc">Drop the first N elements of the array.</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00202">ArrayRef.h:202</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a4656a64c1685bd4f7577a8073c314f6a"><div class="ttname"><a href="CoroFrame_8cpp.html#a4656a64c1685bd4f7577a8073c314f6a">collectFrameAlloca</a></div><div class="ttdeci">static void collectFrameAlloca(AllocaInst *AI, coro::Shape &amp;Shape, const SuspendCrossingInfo &amp;Checker, SmallVectorImpl&lt; AllocaInfo &gt; &amp;Allocas, const DominatorTree &amp;DT)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02777">CoroFrame.cpp:2777</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_ad4de2704820e01ff871aa093ca9cb712"><div class="ttname"><a href="CoroFrame_8cpp.html#ad4de2704820e01ff871aa093ca9cb712">dumpSpills</a></div><div class="ttdeci">static void dumpSpills(StringRef Title, const SpillInfo &amp;Spills)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00533">CoroFrame.cpp:533</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a7fb33159070b72dbab672431dd656a3d"><div class="ttname"><a href="CoroFrame_8cpp.html#a7fb33159070b72dbab672431dd656a3d">buildFrameType</a></div><div class="ttdeci">static StructType * buildFrameType(Function &amp;F, coro::Shape &amp;Shape, FrameDataInfo &amp;FrameData)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l01268">CoroFrame.cpp:1268</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_aef61945034b9431b804748fc317c5548"><div class="ttname"><a href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a></div><div class="ttdeci">uint32_t Index</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00083">ELFObjHandler.cpp:83</a></div></div>
<div class="ttc" id="aclassllvm_1_1SwitchInst_html_aa22bdae1cee3c836f2b4cf8307fc7598"><div class="ttname"><a href="classllvm_1_1SwitchInst.html#aa22bdae1cee3c836f2b4cf8307fc7598">llvm::SwitchInst::setDefaultDest</a></div><div class="ttdeci">void setDefaultDest(BasicBlock *DefaultCase)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03494">Instructions.h:3494</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a9bf617fd3367180fb96cebccfaae8dfa"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a></div><div class="ttdeci">static GCRegistry::Add&lt; StatepointGC &gt; D(&quot;statepoint-example&quot;, &quot;an example strategy for statepoint&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00652">GlobalValue.h:652</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgDeclareInst_html"><div class="ttname"><a href="classllvm_1_1DbgDeclareInst.html">llvm::DbgDeclareInst</a></div><div class="ttdoc">This represents the llvm.dbg.declare instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00349">IntrinsicInst.h:349</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a9df82a8be2f17e80535a8937bf23e022"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a9df82a8be2f17e80535a8937bf23e022">Addr</a></div><div class="ttdeci">uint64_t Addr</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00079">ELFObjHandler.cpp:79</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a2fd1d2dc14e22227cfa8238778ab87b8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">llvm::Instruction::user_back</a></div><div class="ttdeci">Instruction * user_back()</div><div class="ttdoc">Specialize the methods defined in Value, as we know that an instruction can only be used by other ins...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00087">Instruction.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_a1d3459ac1d0c3c498b3a522fbdcb0e7b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a1d3459ac1d0c3c498b3a522fbdcb0e7b">llvm::coro::Shape::SwitchLoweringStorage::IndexOffset</a></div><div class="ttdeci">unsigned IndexOffset</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00113">CoroInternal.h:113</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00067">LLVMContext.h:67</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_a9d132e5f83821984ce6d37cb38a99c24"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a9d132e5f83821984ce6d37cb38a99c24">llvm::coro::Shape::SwitchLoweringStorage::IndexAlign</a></div><div class="ttdeci">unsigned IndexAlign</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00112">CoroInternal.h:112</a></div></div>
<div class="ttc" id="aPromoteMemToReg_8h_html"><div class="ttname"><a href="PromoteMemToReg_8h.html">PromoteMemToReg.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aIR_2DebugInfo_8h_html"><div class="ttname"><a href="IR_2DebugInfo_8h.html">DebugInfo.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html_a4ff1bb484be62f8dac94fc087f72f524"><div class="ttname"><a href="classllvm_1_1DebugLoc.html#a4ff1bb484be62f8dac94fc087f72f524">llvm::DebugLoc::get</a></div><div class="ttdeci">DILocation * get() const</div><div class="ttdoc">Get the underlying DILocation.</div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8cpp_source.html#l00020">DebugLoc.cpp:20</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdoc">an instruction for type-safe pointer arithmetic to access elements of arrays and structs</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00940">Instructions.h:940</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a86c6fee36a1f17461710c01e694ee8df"><div class="ttname"><a href="CoroFrame_8cpp.html#a86c6fee36a1f17461710c01e694ee8df">buildFrameDebugInfo</a></div><div class="ttdeci">static void buildFrameDebugInfo(Function &amp;F, coro::Shape &amp;Shape, FrameDataInfo &amp;FrameData)</div><div class="ttdoc">Build artificial debug info for C++ coroutine frames to allow users to inspect the contents of the fr...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l01095">CoroFrame.cpp:1095</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="aDIBuilder_8h_html"><div class="ttname"><a href="DIBuilder_8h.html">DIBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StackLifetime_html"><div class="ttname"><a href="classllvm_1_1StackLifetime.html">llvm::StackLifetime</a></div><div class="ttdoc">Compute live ranges of allocas.</div><div class="ttdef"><b>Definition:</b> <a href="StackLifetime_8h_source.html#l00037">StackLifetime.h:37</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerType_html"><div class="ttname"><a href="classllvm_1_1PointerType.html">llvm::PointerType</a></div><div class="ttdoc">Class to represent pointers.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00632">DerivedTypes.h:632</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8813c8445d4429956ae5a3647f02fcfb"><div class="ttname"><a href="namespacellvm.html#a8813c8445d4429956ae5a3647f02fcfb">llvm::findDbgValues</a></div><div class="ttdeci">void findDbgValues(SmallVectorImpl&lt; DbgValueInst * &gt; &amp;DbgValues, Value *V)</div><div class="ttdoc">Finds the llvm.dbg.value intrinsics describing a value.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l00079">DebugInfo.cpp:79</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_af0885df5b78cc732639a9d52a87d040e"><div class="ttname"><a href="CoroFrame_8cpp.html#af0885df5b78cc732639a9d52a87d040e">insertSpills</a></div><div class="ttdeci">static void insertSpills(const FrameDataInfo &amp;FrameData, coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l01709">CoroFrame.cpp:1709</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac1ced98ffeb2b6991821751661b136d6"><div class="ttname"><a href="namespacellvm.html#ac1ced98ffeb2b6991821751661b136d6">llvm::updatePhiNodes</a></div><div class="ttdeci">void updatePhiNodes(BasicBlock *DestBB, BasicBlock *OldPred, BasicBlock *NewPred, PHINode *Until=nullptr)</div><div class="ttdoc">Replaces all uses of OldPred with the NewPred block in all PHINodes in a block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00664">BasicBlockUtils.cpp:664</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html_a6352e72d11377a9c62f24434ae869bf0"><div class="ttname"><a href="classllvm_1_1InstVisitor.html#a6352e72d11377a9c62f24434ae869bf0">llvm::InstVisitor&lt; DerivedT &gt;::visit</a></div><div class="ttdeci">void visit(Iterator Start, Iterator End)</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00087">InstVisitor.h:87</a></div></div>
<div class="ttc" id="anamespacellvm_html_a238ef12f09938dac4efe5ca56dc125d9"><div class="ttname"><a href="namespacellvm.html#a238ef12f09938dac4efe5ca56dc125d9">llvm::Log2_64_Ceil</a></div><div class="ttdeci">unsigned Log2_64_Ceil(uint64_t Value)</div><div class="ttdoc">Return the ceil log base 2 of the specified value, 64 if the value is zero.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00401">MathExtras.h:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a27ab264aa1e655ed42732fe0ec40d441"><div class="ttname"><a href="classllvm_1_1CallBase.html#a27ab264aa1e655ed42732fe0ec40d441">llvm::CallBase::doesNotCapture</a></div><div class="ttdeci">bool doesNotCapture(unsigned OpNo) const</div><div class="ttdoc">Determine whether this data operand is not captured.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01683">InstrTypes.h:1683</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_a33880aaca0ad05e5f1557f079305bde5"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">llvm::details::FixedOrScalableQuantity::getFixedValue</a></div><div class="ttdeci">constexpr ScalarTy getFixedValue() const</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00182">TypeSize.h:182</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aOptimizedStructLayout_8h_html"><div class="ttname"><a href="OptimizedStructLayout_8h.html">OptimizedStructLayout.h</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a0be850a4c1970e9269b48c1758737d97"><div class="ttname"><a href="CoroFrame_8cpp.html#a0be850a4c1970e9269b48c1758737d97">isSuspendReachableFrom</a></div><div class="ttdeci">static bool isSuspendReachableFrom(BasicBlock *From, VisitedBlocksSet &amp;VisitedOrFreeBBs)</div><div class="ttdoc">Does control flow starting at the given block ever reach a suspend instruction before reaching a bloc...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02337">CoroFrame.cpp:2337</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a0825e40d7e48c40f94c2639769b16f44"><div class="ttname"><a href="CoroFrame_8cpp.html#a0825e40d7e48c40f94c2639769b16f44">solveDIType</a></div><div class="ttdeci">static DIType * solveDIType(DIBuilder &amp;Builder, Type *Ty, const DataLayout &amp;Layout, DIScope *Scope, unsigned LineNum, DenseMap&lt; Type *, DIType * &gt; &amp;DITypeCache)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l01008">CoroFrame.cpp:1008</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html_ab39b720f77593cfa9c056431b6bc3714"><div class="ttname"><a href="classllvm_1_1InstVisitor.html#ab39b720f77593cfa9c056431b6bc3714">llvm::InstVisitor&lt; DerivedT &gt;::visitAddrSpaceCastInst</a></div><div class="ttdeci">void visitAddrSpaceCastInst(AddrSpaceCastInst &amp;I)</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00188">InstVisitor.h:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abcad2d8140114b7cd7e686dde240e5b0"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abcad2d8140114b7cd7e686dde240e5b0">llvm::coro::Shape::OptimizeFrame</a></div><div class="ttdeci">bool OptimizeFrame</div><div class="ttdoc">This would only be true if optimization are enabled.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00105">CoroInternal.h:105</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="anamespacellvm_1_1WinEH_html_a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa"><div class="ttname"><a href="namespacellvm_1_1WinEH.html#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">llvm::WinEH::EncodingType::CE</a></div><div class="ttdeci">@ CE</div><div class="ttdoc">Windows NT (Windows on ARM)</div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_aaa21a14feb97714a61658b2867c8b628"><div class="ttname"><a href="CoroFrame_8cpp.html#aaa21a14feb97714a61658b2867c8b628">emitSetAndGetSwiftErrorValueAround</a></div><div class="ttdeci">static Value * emitSetAndGetSwiftErrorValueAround(Instruction *Call, AllocaInst *Alloca, coro::Shape &amp;Shape)</div><div class="ttdoc">Set the swifterror value from the given alloca before a call, then put in back in the alloca afterwar...</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02513">CoroFrame.cpp:2513</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage_html_a6b353e50aa2fb0fadf3c46ad81a28e00"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a6b353e50aa2fb0fadf3c46ad81a28e00">llvm::coro::Shape::AsyncLoweringStorage::ContextSize</a></div><div class="ttdeci">uint64_t ContextSize</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00134">CoroInternal.h:134</a></div></div>
<div class="ttc" id="aLoads_8cpp_html_a1ffe95010234816af6f2a6d704f787ed"><div class="ttname"><a href="Loads_8cpp.html#a1ffe95010234816af6f2a6d704f787ed">isAligned</a></div><div class="ttdeci">static bool isAligned(const Value *Base, const APInt &amp;Offset, Align Alignment, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="Loads_8cpp_source.html#l00029">Loads.cpp:29</a></div></div>
<div class="ttc" id="anamespacellvm_html_a10f3d955592ae2bc745f57e5b48ae115"><div class="ttname"><a href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">llvm::size</a></div><div class="ttdeci">auto size(R &amp;&amp;Range, std::enable_if_t&lt; std::is_base_of&lt; std::random_access_iterator_tag, typename std::iterator_traits&lt; decltype(Range.begin())&gt;::iterator_category &gt;::value, void &gt; *=nullptr)</div><div class="ttdoc">Get the size of a range.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01716">STLExtras.h:1716</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a78f32f1cfba451a8c3691f00768da230"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a78f32f1cfba451a8c3691f00768da230">llvm::dwarf::SourceLanguage</a></div><div class="ttdeci">SourceLanguage</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00199">Dwarf.h:199</a></div></div>
<div class="ttc" id="aclassllvm_1_1DICompositeType_html"><div class="ttname"><a href="classllvm_1_1DICompositeType.html">llvm::DICompositeType</a></div><div class="ttdoc">Composite types.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01083">DebugInfoMetadata.h:1083</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64_html_a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb"><div class="ttname"><a href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">llvm::AArch64::RM</a></div><div class="ttdeci">@ RM</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00499">AArch64ISelLowering.h:499</a></div></div>
<div class="ttc" id="astructllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4_html_a177eefb57f6ebdea5449a54c13bf33b0"><div class="ttname"><a href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a177eefb57f6ebdea5449a54c13bf33b0">llvm::GraphTraits&lt; RematGraph * &gt;::NodeRef</a></div><div class="ttdeci">RematGraph::RematNode * NodeRef</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00419">CoroFrame.cpp:419</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1jitlink_html_adb322dc6826cf005531ccfdf666260fd"><div class="ttname"><a href="namespacellvm_1_1jitlink.html#adb322dc6826cf005531ccfdf666260fd">llvm::jitlink::Scope</a></div><div class="ttdeci">Scope</div><div class="ttdoc">Defines the scope in which this symbol should be visible: Default  Visible in the public interface o...</div><div class="ttdef"><b>Definition:</b> <a href="JITLink_8h_source.html#l00384">JITLink.h:384</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html"><div class="ttname"><a href="classllvm_1_1StructType.html">llvm::StructType</a></div><div class="ttdoc">Class to represent struct types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00213">DerivedTypes.h:213</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIVariable_html_ae94ae88c9f22d83ba5843753153849a4"><div class="ttname"><a href="classllvm_1_1DIVariable.html#ae94ae88c9f22d83ba5843753153849a4">llvm::DIVariable::getLine</a></div><div class="ttdeci">unsigned getLine() const</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l02555">DebugInfoMetadata.h:2555</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6a66ebb3aa12757479a3c88de77d78f8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">llvm::Instruction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const</div><div class="ttdoc">Return the function this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00074">Instruction.cpp:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a015846b6188ce15e08cd94c74a9df1a3"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a015846b6188ce15e08cd94c74a9df1a3">A</a></div><div class="ttdeci">* A</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00089">README_ALTIVEC.txt:89</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html">llvm::PtrUseVisitor</a></div><div class="ttdoc">A base class for visitors over the uses of a pointer value.</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00198">PtrUseVisitor.h:198</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_aea74164514e7164813ab30bcc4b7c557"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#aea74164514e7164813ab30bcc4b7c557">llvm::AllocaInst::isArrayAllocation</a></div><div class="ttdeci">bool isArrayAllocation() const</div><div class="ttdoc">Return true if there is an allocation size parameter to the allocation instruction that is not 1.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01508">Instructions.cpp:1508</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a642ec4238f02650fc1e70d5b4ac8d844"><div class="ttname"><a href="CoroFrame_8cpp.html#a642ec4238f02650fc1e70d5b4ac8d844">movePHIValuesToInsertedBlock</a></div><div class="ttdeci">static void movePHIValuesToInsertedBlock(BasicBlock *SuccBB, BasicBlock *InsertedBB, BasicBlock *PredBB, PHINode *UntilPHI=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02023">CoroFrame.cpp:2023</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html_a1320c1780d4b96711e44c8bb2735fe86"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html#a1320c1780d4b96711e44c8bb2735fe86">llvm::PtrUseVisitor::visitCallBase</a></div><div class="ttdeci">void visitCallBase(CallBase &amp;CB)</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00290">PtrUseVisitor.h:290</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abfb56acef5d60fefb2edc417f0bfbda0"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">llvm::coro::Shape::CoroBegin</a></div><div class="ttdeci">CoroBeginInst * CoroBegin</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00074">CoroInternal.h:74</a></div></div>
<div class="ttc" id="astructllvm_1_1OptimizedStructLayoutField_html_ae472b245af5bd4a76bea7581ea772185"><div class="ttname"><a href="structllvm_1_1OptimizedStructLayoutField.html#ae472b245af5bd4a76bea7581ea772185">llvm::OptimizedStructLayoutField::Size</a></div><div class="ttdeci">uint64_t Size</div><div class="ttdoc">The required size of this field in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizedStructLayout_8h_source.html#l00063">OptimizedStructLayout.h:63</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnyCoroEndInst_html"><div class="ttname"><a href="classllvm_1_1AnyCoroEndInst.html">llvm::AnyCoroEndInst</a></div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00614">CoroInstr.h:614</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a0566221f10834bfcea70965379745a20"><div class="ttname"><a href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">llvm::Type::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">Return the LLVMContext in which this type was uniqued.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00129">Type.h:129</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1PtrUseVisitorBase_html_a082865790e32a27f3e3adf8db2c556e6"><div class="ttname"><a href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#a082865790e32a27f3e3adf8db2c556e6">llvm::detail::PtrUseVisitorBase::Offset</a></div><div class="ttdeci">APInt Offset</div><div class="ttdoc">The constant offset of the use if that is known.</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00149">PtrUseVisitor.h:149</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a99f811d53704275b4158c62a2dd138d9"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00207">DenseMap.h:207</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ace1508259ecd37ceaafb9162d3768fff"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">llvm::coro::Shape::RetconLowering</a></div><div class="ttdeci">RetconLoweringStorage RetconLowering</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00142">CoroInternal.h:142</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a1600c7959045cb6b6a5f5a1d427ec67e"><div class="ttname"><a href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">llvm::User::replaceUsesOfWith</a></div><div class="ttdeci">bool replaceUsesOfWith(Value *From, Value *To)</div><div class="ttdoc">Replace uses of one Value with another.</div><div class="ttdef"><b>Definition:</b> <a href="User_8cpp_source.html#l00021">User.cpp:21</a></div></div>
<div class="ttc" id="anamespacellvm_html_aae35ec9b920ff3bb892cd872877a89fe"><div class="ttname"><a href="namespacellvm.html#aae35ec9b920ff3bb892cd872877a89fe">llvm::performOptimizedStructLayout</a></div><div class="ttdeci">std::pair&lt; uint64_t, Align &gt; performOptimizedStructLayout(MutableArrayRef&lt; OptimizedStructLayoutField &gt; Fields)</div><div class="ttdoc">Compute a layout for a struct containing the given fields, making a best-effort attempt to minimize t...</div><div class="ttdef"><b>Definition:</b> <a href="OptimizedStructLayout_8cpp_source.html#l00043">OptimizedStructLayout.cpp:43</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aIRBuilder_8cpp_html_a36cf33ef120f4b9706471a89271dcfb5"><div class="ttname"><a href="IRBuilder_8cpp.html#a36cf33ef120f4b9706471a89271dcfb5">getAlign</a></div><div class="ttdeci">static MaybeAlign getAlign(Value *Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8cpp_source.html#l00529">IRBuilder.cpp:529</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a858efd7b61654c0de28c56f9adafa13d"><div class="ttname"><a href="classllvm_1_1StructType.html#a858efd7b61654c0de28c56f9adafa13d">llvm::StructType::getNumElements</a></div><div class="ttdeci">unsigned getNumElements() const</div><div class="ttdoc">Random access to the elements.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00327">DerivedTypes.h:327</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_aefa39f6b622360ce4e947feb9f671b73"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=std::nullopt)</div><div class="ttdoc">Create or insert an LLVM Function declaration for an intrinsic, and return it.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l01502">Function.cpp:1502</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a966eb231e7d4e572874d2cb49b18faea"><div class="ttname"><a href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">llvm::Value::stripPointerCasts</a></div><div class="ttdeci">const Value * stripPointerCasts() const</div><div class="ttdoc">Strip off pointer casts, all-zero GEPs and address space casts.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00685">Value.cpp:685</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab2e3dbebd68e69d77c227682fc8e3ba2"><div class="ttname"><a href="namespacellvm.html#ab2e3dbebd68e69d77c227682fc8e3ba2">llvm::make_scope_exit</a></div><div class="ttdeci">detail::scope_exit&lt; std::decay_t&lt; Callable &gt; &gt; make_scope_exit(Callable &amp;&amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="ScopeExit_8h_source.html#l00059">ScopeExit.h:59</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac78c09ae232b2ce188ff590d51e3c268"><div class="ttname"><a href="namespacellvm.html#ac78c09ae232b2ce188ff590d51e3c268">llvm::find_if</a></div><div class="ttdeci">auto find_if(R &amp;&amp;Range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::find_if which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01762">STLExtras.h:1762</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_ab706e7ebb1969c5e34f28bfcf2ff719e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#ab706e7ebb1969c5e34f28bfcf2ff719e">llvm::BasicBlock::front</a></div><div class="ttdeci">const Instruction &amp; front() const</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00326">BasicBlock.h:326</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_aa286a0f7f5d38488d593bb7ef0ba183e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">llvm::BasicBlock::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">Get the context in which this basic block lives.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00035">BasicBlock.cpp:35</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_a8f92de2ab37d7999e6fcd53381306586"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#a8f92de2ab37d7999e6fcd53381306586">llvm::DIBuilder::createExpression</a></div><div class="ttdeci">DIExpression * createExpression(ArrayRef&lt; uint64_t &gt; Addr=std::nullopt)</div><div class="ttdoc">Create a new descriptor for the specified variable which has a complex address expression for its add...</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l00837">DIBuilder.cpp:837</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a4e60e0c351f13aade28b451480c44e5aaa1977c3f68d4d3bbfe14d0e51a575482"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a4e60e0c351f13aade28b451480c44e5aaa1977c3f68d4d3bbfe14d0e51a575482">llvm::codeview::ClassOptions::Packed</a></div><div class="ttdeci">@ Packed</div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_a3e99da1a11ff2254b0952710c600b621"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#a3e99da1a11ff2254b0952710c600b621">llvm::DIBuilder::createStructType</a></div><div class="ttdeci">DICompositeType * createStructType(DIScope *Scope, StringRef Name, DIFile *File, unsigned LineNumber, uint64_t SizeInBits, uint32_t AlignInBits, DINode::DIFlags Flags, DIType *DerivedFrom, DINodeArray Elements, unsigned RunTimeLang=0, DIType *VTableHolder=nullptr, StringRef UniqueIdentifier=&quot;&quot;)</div><div class="ttdoc">Create debugging information entry for a struct.</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l00509">DIBuilder.cpp:509</a></div></div>
<div class="ttc" id="astructllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4_html_af18e552cfee5828616b328e7a438e13d"><div class="ttname"><a href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#af18e552cfee5828616b328e7a438e13d">llvm::GraphTraits&lt; RematGraph * &gt;::child_begin</a></div><div class="ttdeci">static ChildIteratorType child_begin(NodeRef N)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00423">CoroFrame.cpp:423</a></div></div>
<div class="ttc" id="anamespacellvm_html_a313a633eb3049b90e931206183e1251eac8b77721c677e0429241a9250972122d"><div class="ttname"><a href="namespacellvm.html#a313a633eb3049b90e931206183e1251eac8b77721c677e0429241a9250972122d">llvm::DiagnosticPredicateTy::NoMatch</a></div><div class="ttdeci">@ NoMatch</div></div>
<div class="ttc" id="anamespacellvm_html_adf83581f514774264d616eef5706cf6e"><div class="ttname"><a href="namespacellvm.html#adf83581f514774264d616eef5706cf6e">llvm::SplitEdge</a></div><div class="ttdeci">BasicBlock * SplitEdge(BasicBlock *From, BasicBlock *To, DominatorTree *DT=nullptr, LoopInfo *LI=nullptr, MemorySSAUpdater *MSSAU=nullptr, const Twine &amp;BBName=&quot;&quot;)</div><div class="ttdoc">Split the edge connecting the specified blocks, and return the newly created basic block between From...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00615">BasicBlockUtils.cpp:615</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdoc">Twine - A lightweight data structure for efficiently representing the concatenation of temporary valu...</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1MapVector_html_a041e60c6f5f9841f3dc74921ea87bec2"><div class="ttname"><a href="classllvm_1_1MapVector.html#a041e60c6f5f9841f3dc74921ea87bec2">llvm::MapVector&lt; KeyT, ValueT, SmallDenseMap&lt; KeyT, unsigned, N &gt;, SmallVector&lt; std::pair&lt; KeyT, ValueT &gt;, N &gt; &gt;::count</a></div><div class="ttdeci">size_type count(const KeyT &amp;Key) const</div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00143">MapVector.h:143</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bab021df6aac4654c454f46c77646e745f">llvm::pdb::PDB_SymType::Label</a></div><div class="ttdeci">@ Label</div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a5f0c86e4a93ace9ff013c23b1c1fa1ad"><div class="ttname"><a href="CoroFrame_8cpp.html#a5f0c86e4a93ace9ff013c23b1c1fa1ad">splitBeforeCatchSwitch</a></div><div class="ttdeci">static Instruction * splitBeforeCatchSwitch(CatchSwitchInst *CatchSwitch)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l01666">CoroFrame.cpp:1666</a></div></div>
<div class="ttc" id="anamespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00050">GraphWriter.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae2c2758db51113863d0114f08c4b482a"><div class="ttname"><a href="namespacellvm.html#ae2c2758db51113863d0114f08c4b482a">llvm::setUnwindEdgeTo</a></div><div class="ttdeci">void setUnwindEdgeTo(Instruction *TI, BasicBlock *Succ)</div><div class="ttdoc">Sets the unwind edge of an instruction to a particular successor.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00653">BasicBlockUtils.cpp:653</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3ffc75c3a4cb82ba307a3334483eb4ac"><div class="ttname"><a href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">llvm::Type::isFloatTy</a></div><div class="ttdeci">bool isFloatTy() const</div><div class="ttdoc">Return true if this is 'float', a 32-bit IEEE fp type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00154">Type.h:154</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIScope_html"><div class="ttname"><a href="classllvm_1_1DIScope.html">llvm::DIScope</a></div><div class="ttdoc">Base class for scope-like contexts.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00508">DebugInfoMetadata.h:508</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html_aa7dac4f1adefec91c970ee7a0463dafb"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html#aa7dac4f1adefec91c970ee7a0463dafb">llvm::PtrUseVisitor::visitAddrSpaceCastInst</a></div><div class="ttdeci">void visitAddrSpaceCastInst(AddrSpaceCastInst &amp;ASC)</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00251">PtrUseVisitor.h:251</a></div></div>
<div class="ttc" id="alib_2Target_2PowerPC_2README_8txt_html_aa91241c8c54738377749dc47ee489e0d"><div class="ttname"><a href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">get</a></div><div class="ttdeci">Should compile to something r4 addze r3 instead we get</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2PowerPC_2README_8txt_source.html#l00024">README.txt:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html_a80735739b49cf97a491922c8f9af2cc1"><div class="ttname"><a href="structllvm_1_1Align.html#a80735739b49cf97a491922c8f9af2cc1">llvm::Align::value</a></div><div class="ttdeci">uint64_t value() const</div><div class="ttdoc">This is a hole in the type system and should not be abused.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00085">Alignment.h:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_adde2ea00dd2613ee41bfe91908e4e68e"><div class="ttname"><a href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">llvm::CallBase::arg_size</a></div><div class="ttdeci">unsigned arg_size() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01349">InstrTypes.h:1349</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html"><div class="ttname"><a href="classllvm_1_1TypeSize.html">llvm::TypeSize</a></div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00314">TypeSize.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_html_a99356c6b92999b95181b5d79c03868ee"><div class="ttname"><a href="namespacellvm.html#a99356c6b92999b95181b5d79c03868ee">llvm::salvageDebugInfoImpl</a></div><div class="ttdeci">Value * salvageDebugInfoImpl(Instruction &amp;I, uint64_t CurrentLocOps, SmallVectorImpl&lt; uint64_t &gt; &amp;Ops, SmallVectorImpl&lt; Value * &gt; &amp;AdditionalValues)</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02039">Local.cpp:2039</a></div></div>
<div class="ttc" id="acircular__raw__ostream_8h_html"><div class="ttname"><a href="circular__raw__ostream_8h.html">circular_raw_ostream.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_abee0df5f7f703bb4462aba260ba0a60f"><div class="ttname"><a href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">llvm::BitWidth</a></div><div class="ttdeci">constexpr unsigned BitWidth</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00147">BitmaskEnum.h:147</a></div></div>
<div class="ttc" id="aAMDGPULowerKernelArguments_8cpp_html_a1161e5a4e753384aaba3a8e4533c4261"><div class="ttname"><a href="AMDGPULowerKernelArguments_8cpp.html#a1161e5a4e753384aaba3a8e4533c4261">Arguments</a></div><div class="ttdeci">AMDGPU Lower Kernel Arguments</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULowerKernelArguments_8cpp_source.html#l00240">AMDGPULowerKernelArguments.cpp:240</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_ac22bd3a0571eb4e961def1c480247296"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#ac22bd3a0571eb4e961def1c480247296">llvm::DIBuilder::getOrCreateArray</a></div><div class="ttdeci">DINodeArray getOrCreateArray(ArrayRef&lt; Metadata * &gt; Elements)</div><div class="ttdoc">Get a DINodeArray, create one if required.</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l00680">DIBuilder.cpp:680</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_adc01a7457de85fc52a3bb860d7e1c6a4"><div class="ttname"><a href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0) const</div><div class="ttdoc">Return a pointer to the current type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00776">Type.cpp:776</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_aa0fd6bf3d33236279db7b707bba755f4"><div class="ttname"><a href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">llvm::Type::isDoubleTy</a></div><div class="ttdeci">bool isDoubleTy() const</div><div class="ttdoc">Return true if this is 'double', a 64-bit IEEE fp type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00157">Type.h:157</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a78fa8f84df72aa178f82c9421b0cf387"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a78fa8f84df72aa178f82c9421b0cf387">llvm::coro::Shape::emitAlloc</a></div><div class="ttdeci">Value * emitAlloc(IRBuilder&lt;&gt; &amp;Builder, Value *Size, CallGraph *CG) const</div><div class="ttdoc">Allocate memory according to the rules of the active lowering.</div><div class="ttdef"><b>Definition:</b> <a href="Coroutines_8cpp_source.html#l00453">Coroutines.cpp:453</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a3c5bfa27332d63608ee16d8e61c7682a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a3c5bfa27332d63608ee16d8e61c7682a">llvm::coro::Shape::getSwitchCoroId</a></div><div class="ttdeci">CoroIdInst * getSwitchCoroId() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00146">CoroInternal.h:146</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00614">SmallVector.h:614</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a5a93b5fcf433128b2fd9d563792eb4cd"><div class="ttname"><a href="CoroFrame_8cpp.html#a5a93b5fcf433128b2fd9d563792eb4cd">rewritePHIs</a></div><div class="ttdeci">static void rewritePHIs(BasicBlock &amp;BB)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02133">CoroFrame.cpp:2133</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_aaedb78de657237c48255243a68e1dbc1"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#aaedb78de657237c48255243a68e1dbc1">llvm::dwarf::isCPlusPlus</a></div><div class="ttdeci">bool isCPlusPlus(SourceLanguage S)</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00207">Dwarf.h:207</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroAllocaAllocInst_html_acc37820bc8c8aa5cd91ca08a0635bbdb"><div class="ttname"><a href="classllvm_1_1CoroAllocaAllocInst.html#acc37820bc8c8aa5cd91ca08a0635bbdb">llvm::CoroAllocaAllocInst::getSize</a></div><div class="ttdeci">Value * getSize() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00673">CoroInstr.h:673</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallString_html_af5dd7241878be5eed07736eb156bb10b"><div class="ttname"><a href="classllvm_1_1SmallString.html#af5dd7241878be5eed07736eb156bb10b">llvm::SmallString::str</a></div><div class="ttdeci">StringRef str() const</div><div class="ttdoc">Explicit conversion to StringRef.</div><div class="ttdef"><b>Definition:</b> <a href="SmallString_8h_source.html#l00261">SmallString.h:261</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReversePostOrderTraversal_html"><div class="ttname"><a href="classllvm_1_1ReversePostOrderTraversal.html">llvm::ReversePostOrderTraversal</a></div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00293">PostOrderIterator.h:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1CatchSwitchInst_html_ad4cac3f86755263bbdc8291f8254fb95"><div class="ttname"><a href="classllvm_1_1CatchSwitchInst.html#ad4cac3f86755263bbdc8291f8254fb95">llvm::CatchSwitchInst::getParentPad</a></div><div class="ttdeci">Value * getParentPad() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04375">Instructions.h:4375</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="aGVN_8cpp_html_ab1faa49b43014e07caaf2bf2d3db07e4"><div class="ttname"><a href="GVN_8cpp.html#ab1faa49b43014e07caaf2bf2d3db07e4">isLifetimeStart</a></div><div class="ttdeci">static bool isLifetimeStart(const Instruction *Inst)</div><div class="ttdef"><b>Definition:</b> <a href="GVN_8cpp_source.html#l01032">GVN.cpp:1032</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a36b39e8a1384a23b9899d2c9e2e08e72"><div class="ttname"><a href="CoroFrame_8cpp.html#a36b39e8a1384a23b9899d2c9e2e08e72">lowerLocalAllocas</a></div><div class="ttdeci">static void lowerLocalAllocas(ArrayRef&lt; CoroAllocaAllocInst * &gt; LocalAllocas, SmallVectorImpl&lt; Instruction * &gt; &amp;DeadInsts)</div><div class="ttdoc">Turn each of the given local allocas into a normal (dynamic) alloca instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02411">CoroFrame.cpp:2411</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_ab15e79342bb64fb172d5d5e9331560e8"><div class="ttname"><a href="CoroFrame_8cpp.html#ab15e79342bb64fb172d5d5e9331560e8">isSuspendBlock</a></div><div class="ttdeci">static bool isSuspendBlock(BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02329">CoroFrame.cpp:2329</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_af3bb24b322533dbe8a63c84b18568fe1"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#af3bb24b322533dbe8a63c84b18568fe1">llvm::AllocaInst::setAlignment</a></div><div class="ttdeci">void setAlignment(Align Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00129">Instructions.h:129</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_affac0dc3d407ef3dee29b8bc9a4836bc"><div class="ttname"><a href="classllvm_1_1SetVector.html#affac0dc3d407ef3dee29b8bc9a4836bc">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdoc">Get an iterator to the end of the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00092">SetVector.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1TinyPtrVector_html_a9dc659b723e6725130ad354ed821d400"><div class="ttname"><a href="classllvm_1_1TinyPtrVector.html#a9dc659b723e6725130ad354ed821d400">llvm::TinyPtrVector::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="TinyPtrVector_8h_source.html#l00162">TinyPtrVector.h:162</a></div></div>
<div class="ttc" id="aPostOrderIterator_8h_html"><div class="ttname"><a href="PostOrderIterator_8h.html">PostOrderIterator.h</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a9b0a5f4e8a04c6ddea8e243dcff69c54"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a9b0a5f4e8a04c6ddea8e243dcff69c54">llvm::coro::Shape::getRetconCoroId</a></div><div class="ttdeci">AnyCoroIdRetconInst * getRetconCoroId() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00151">CoroInternal.h:151</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a81eef9d7336f7ee43be79630d8e8ec86"><div class="ttname"><a href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">llvm::Type::isStructTy</a></div><div class="ttdeci">bool isStructTy() const</div><div class="ttdoc">True if this is an instance of StructType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00243">Type.h:243</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a39d3bbde4893feb90f5667cc837a4c82"><div class="ttname"><a href="CoroFrame_8cpp.html#a39d3bbde4893feb90f5667cc837a4c82">isLocalAlloca</a></div><div class="ttdeci">static bool isLocalAlloca(CoroAllocaAllocInst *AI)</div><div class="ttdoc">Is the given alloca &quot;local&quot;, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02360">CoroFrame.cpp:2360</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a742806b2e667a87817ae171e1ec59826"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">llvm::coro::Shape::FrameSize</a></div><div class="ttdeci">uint64_t FrameSize</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00100">CoroInternal.h:100</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a0c8ffe664a36e30d49c84d0aded2fe08"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00677">SmallVector.h:677</a></div></div>
<div class="ttc" id="anamespacellvm_html_a13c1b5a253da5da49ce33d03dc1efc07"><div class="ttname"><a href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">llvm::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;Value)</div><div class="ttdef"><b>Definition:</b> <a href="ScopedPrinter_8h_source.html#l00085">ScopedPrinter.h:85</a></div></div>
<div class="ttc" id="aIVUsers_8cpp_html_a4e5b9edb51eec9dbca592075eb64dfcb"><div class="ttname"><a href="IVUsers_8cpp.html#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a></div><div class="ttdeci">iv Induction Variable Users</div><div class="ttdef"><b>Definition:</b> <a href="IVUsers_8cpp_source.html#l00048">IVUsers.cpp:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1iterator__range_html"><div class="ttname"><a href="classllvm_1_1iterator__range.html">llvm::iterator_range</a></div><div class="ttdoc">A range adaptor for a pair of iterators.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00030">iterator_range.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__svector__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__svector__ostream.html">llvm::raw_svector_ostream</a></div><div class="ttdoc">A raw_ostream that writes to an SmallVector or SmallString.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00672">raw_ostream.h:672</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_ae292a4b96e7f74eb95a4176ddba7b821"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#ae292a4b96e7f74eb95a4176ddba7b821">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::reserve</a></div><div class="ttdeci">void reserve(size_type NumEntries)</div><div class="ttdoc">Grow the densemap so that it can contain at least NumEntries items before resizing again.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00103">DenseMap.h:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aScopeExit_8h_html"><div class="ttname"><a href="ScopeExit_8h.html">ScopeExit.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroBeginInst_html"><div class="ttname"><a href="classllvm_1_1CoroBeginInst.html">llvm::CoroBeginInst</a></div><div class="ttdoc">This class represents the llvm.coro.begin instruction.</div><div class="ttdef"><b>Definition:</b> <a href="CoroInstr_8h_source.html#l00420">CoroInstr.h:420</a></div></div>
<div class="ttc" id="aclassllvm_1_1DISubprogram_html"><div class="ttname"><a href="classllvm_1_1DISubprogram.html">llvm::DISubprogram</a></div><div class="ttdoc">Subprogram description.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01851">DebugInfoMetadata.h:1851</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdoc">This class consists of common code factored out of the SmallVector class to reduce code duplication b...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00042">APFloat.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a6cb66137274f95e4bf6b324b8af9ab56"><div class="ttname"><a href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">llvm::StructType::getElementType</a></div><div class="ttdeci">Type * getElementType(unsigned N) const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00328">DerivedTypes.h:328</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a5eac2988672b484645dcbcd706430967"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a5eac2988672b484645dcbcd706430967">llvm::coro::Shape::FramePtr</a></div><div class="ttdeci">Value * FramePtr</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00101">CoroInternal.h:101</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae6d1c31d74bbaaa9e42bcbdc10a499f2"><div class="ttname"><a href="namespacellvm.html#ae6d1c31d74bbaaa9e42bcbdc10a499f2">llvm::pred_size</a></div><div class="ttdeci">unsigned pred_size(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineSSAContext_8h_source.html#l00032">MachineSSAContext.h:32</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_aa91808171edab519dad6cbe8119f5d9ba08dba5f678da9c72318b151fbf9aeceb"><div class="ttname"><a href="CoroFrame_8cpp.html#aa91808171edab519dad6cbe8119f5d9ba08dba5f678da9c72318b151fbf9aeceb">SmallVectorThreshold</a></div><div class="ttdeci">@ SmallVectorThreshold</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00050">CoroFrame.cpp:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a6d883605206368bc536cc9ded97209b8"><div class="ttname"><a href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">llvm::Module::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Get the data layout for the module's target platform.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00398">Module.cpp:398</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSetVector_html"><div class="ttname"><a href="classllvm_1_1SmallSetVector.html">llvm::SmallSetVector</a></div><div class="ttdoc">A SetVector that performs no allocations if smaller than a certain size.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00300">SetVector.h:300</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html_ac6692a6fe0bccaaa2867a7b3c60c4a71"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html#ac6692a6fe0bccaaa2867a7b3c60c4a71">llvm::PtrUseVisitor::visitStoreInst</a></div><div class="ttdeci">void visitStoreInst(StoreInst &amp;SI)</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00242">PtrUseVisitor.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a223dd14e7d12bc5cea01889b972a98b2"><div class="ttname"><a href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">llvm::StringRef::str</a></div><div class="ttdeci">std::string str() const</div><div class="ttdoc">str - Get the contents as an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00222">StringRef.h:222</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html_ac521760e9a45f304a4cbe46ed4fff845"><div class="ttname"><a href="classllvm_1_1Twine.html#ac521760e9a45f304a4cbe46ed4fff845">llvm::Twine::toStringRef</a></div><div class="ttdeci">StringRef toStringRef(SmallVectorImpl&lt; char &gt; &amp;Out) const</div><div class="ttdoc">This returns the twine as a single StringRef if it can be represented as such.</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00473">Twine.h:473</a></div></div>
<div class="ttc" id="astructllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4_html_a754aa9aea4e2e521912cfa03a0c9348f"><div class="ttname"><a href="structllvm_1_1GraphTraits_3_01RematGraph_01_5_01_4.html#a754aa9aea4e2e521912cfa03a0c9348f">llvm::GraphTraits&lt; RematGraph * &gt;::ChildIteratorType</a></div><div class="ttdeci">RematGraph::RematNode ** ChildIteratorType</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00420">CoroFrame.cpp:420</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocalScope_html"><div class="ttname"><a href="classllvm_1_1DILocalScope.html">llvm::DILocalScope</a></div><div class="ttdoc">A scope for locals.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01568">DebugInfoMetadata.h:1568</a></div></div>
<div class="ttc" id="astructllvm_1_1GraphTraits_html"><div class="ttname"><a href="structllvm_1_1GraphTraits.html">llvm::GraphTraits</a></div><div class="ttdef"><b>Definition:</b> <a href="GraphTraits_8h_source.html#l00037">GraphTraits.h:37</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html_ab76e3275f4ae2b0601c15cf2d4e957af"><div class="ttname"><a href="classllvm_1_1DIBuilder.html#ab76e3275f4ae2b0601c15cf2d4e957af">llvm::DIBuilder::createBasicType</a></div><div class="ttdeci">DIBasicType * createBasicType(StringRef Name, uint64_t SizeInBits, unsigned Encoding, DINode::DIFlags Flags=DINode::FlagZero)</div><div class="ttdoc">Create debugging information entry for a basic type.</div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8cpp_source.html#l00283">DIBuilder.cpp:283</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html_adce253af48185f52c4b9d2e0088fd13e"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html#adce253af48185f52c4b9d2e0088fd13e">llvm::PtrUseVisitor::visitIntrinsicInst</a></div><div class="ttdeci">void visitIntrinsicInst(IntrinsicInst &amp;II)</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00277">PtrUseVisitor.h:277</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">InlinePriorityMode::Size</a></div><div class="ttdeci">@ Size</div></div>
<div class="ttc" id="aBlockVerifier_8cpp_html_ae45c7d73c0ff5d177b59153ffae77f84"><div class="ttname"><a href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a></div><div class="ttdeci">BlockVerifier::State From</div><div class="ttdef"><b>Definition:</b> <a href="BlockVerifier_8cpp_source.html#l00055">BlockVerifier.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1SwitchInst_html"><div class="ttname"><a href="classllvm_1_1SwitchInst.html">llvm::SwitchInst</a></div><div class="ttdoc">Multiway switch.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03283">Instructions.h:3283</a></div></div>
<div class="ttc" id="astructllvm_1_1OptimizedStructLayoutField_html"><div class="ttname"><a href="structllvm_1_1OptimizedStructLayoutField.html">llvm::OptimizedStructLayoutField</a></div><div class="ttdoc">A field in a structure.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizedStructLayout_8h_source.html#l00045">OptimizedStructLayout.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdoc">Transfer the name from V to this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00381">Value.cpp:381</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdoc">an instruction to allocate memory on the stack</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a114ad3c2fa8977d19e6fd43f3b685164"><div class="ttname"><a href="CoroFrame_8cpp.html#a114ad3c2fa8977d19e6fd43f3b685164">VisitedBlocksSet</a></div><div class="ttdeci">SmallPtrSet&lt; BasicBlock *, 8 &gt; VisitedBlocksSet</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02333">CoroFrame.cpp:2333</a></div></div>
<div class="ttc" id="aCoroFrame_8cpp_html_a44d73f71509ec34798d5810859701347"><div class="ttname"><a href="CoroFrame_8cpp.html#a44d73f71509ec34798d5810859701347">cacheDIVar</a></div><div class="ttdeci">static void cacheDIVar(FrameDataInfo &amp;FrameData, DenseMap&lt; Value *, DILocalVariable * &gt; &amp;DIVarCache)</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l00943">CoroFrame.cpp:943</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage_html_a12d93f5ae63381caf2a4ef0fdba3a668"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1AsyncLoweringStorage.html#a12d93f5ae63381caf2a4ef0fdba3a668">llvm::coro::Shape::AsyncLoweringStorage::getContextAlignment</a></div><div class="ttdeci">Align getContextAlignment() const</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00137">CoroInternal.h:137</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TinyPtrVector_html"><div class="ttname"><a href="classllvm_1_1TinyPtrVector.html">llvm::TinyPtrVector</a></div><div class="ttdoc">TinyPtrVector - This class is specialized for cases where there are normally 0 or 1 element in a vect...</div><div class="ttdef"><b>Definition:</b> <a href="TinyPtrVector_8h_source.html#l00029">TinyPtrVector.h:29</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1VGPRIndexMode_html_a9afd95476c40096a5898ba0f06370b3a"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1VGPRIndexMode.html#a9afd95476c40096a5898ba0f06370b3a">llvm::AMDGPU::VGPRIndexMode::Id</a></div><div class="ttdeci">Id</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00250">SIDefines.h:250</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a499ea32ca1b8d16cedfe01d1e5b08f29"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">llvm::SmallVectorImpl::reserve</a></div><div class="ttdeci">void reserve(size_type N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00667">SmallVector.h:667</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html_ab5c883233fb1eca9c18759fb49863a6e"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html#ab5c883233fb1eca9c18759fb49863a6e">llvm::PtrUseVisitor::visitBitCastInst</a></div><div class="ttdeci">void visitBitCastInst(BitCastInst &amp;BC)</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00247">PtrUseVisitor.h:247</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">llvm::pdb::PDB_SymType::Block</a></div><div class="ttdeci">@ Block</div></div>
<div class="ttc" id="aclassllvm_1_1CatchSwitchInst_html"><div class="ttname"><a href="classllvm_1_1CatchSwitchInst.html">llvm::CatchSwitchInst</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04313">Instructions.h:4313</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a53b686b78ff6f0eedd7d4d5a6bdd22bb"><div class="ttname"><a href="namespacellvm_1_1coro.html#a53b686b78ff6f0eedd7d4d5a6bdd22bb">llvm::coro::defaultMaterializable</a></div><div class="ttdeci">bool defaultMaterializable(Instruction &amp;V)</div><div class="ttdoc">Default materializable callback.</div><div class="ttdef"><b>Definition:</b> <a href="CoroFrame_8cpp_source.html#l02218">CoroFrame.cpp:2218</a></div></div>
<div class="ttc" id="anamespacellvm_html_a99cdcecbadc13087f087c61809bb44f1"><div class="ttname"><a href="namespacellvm.html#a99cdcecbadc13087f087c61809bb44f1">llvm::offsetToAlignment</a></div><div class="ttdeci">uint64_t offsetToAlignment(uint64_t Value, Align Alignment)</div><div class="ttdoc">Returns the offset to the next integer (mod 2**64) that is greater than or equal to Value and is a mu...</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00197">Alignment.h:197</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_a1640d3af02b4a49eaa3422920056bb6d"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a1640d3af02b4a49eaa3422920056bb6d">llvm::coro::Shape::SwitchLoweringStorage::IndexField</a></div><div class="ttdeci">unsigned IndexField</div><div class="ttdef"><b>Definition:</b> <a href="CoroInternal_8h_source.html#l00111">CoroInternal.h:111</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_a31eeebeefd320f6a2db4a867f568bee3"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a31eeebeefd320f6a2db4a867f568bee3">llvm::AllocaInst::setSwiftError</a></div><div class="ttdeci">void setSwiftError(bool V)</div><div class="ttdoc">Specify whether this alloca is used to represent a swifterror.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00152">Instructions.h:152</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a04eb43a6dc736c2d6ed8dcc6d636a2afad6e408b692f1e72c58127dbaed95ebe4">llvm::codeview::DebugSubsectionKind::FrameData</a></div><div class="ttdeci">@ FrameData</div></div>
<div class="ttc" id="anamespacellvm_html_a5023b360abc7a5d1612061fba30003a6"><div class="ttname"><a href="namespacellvm.html#a5023b360abc7a5d1612061fba30003a6">llvm::isAllocaPromotable</a></div><div class="ttdeci">bool isAllocaPromotable(const AllocaInst *AI)</div><div class="ttdoc">Return true if this alloca is legal for promotion.</div><div class="ttdef"><b>Definition:</b> <a href="PromoteMemoryToRegister_8cpp_source.html#l00063">PromoteMemoryToRegister.cpp:63</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdoc">Unlink this instruction from its current basic block and insert it into the basic block that MovePos ...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00108">Instruction.cpp:108</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIScope_html_a875719877cc384dbe437a63fdb579030"><div class="ttname"><a href="classllvm_1_1DIScope.html#a875719877cc384dbe437a63fdb579030">llvm::DIScope::getFile</a></div><div class="ttdeci">DIFile * getFile() const</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00516">DebugInfoMetadata.h:516</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIFile_html"><div class="ttname"><a href="classllvm_1_1DIFile.html">llvm::DIFile</a></div><div class="ttdoc">File.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00562">DebugInfoMetadata.h:562</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:23:39 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
