<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/CodeGen/InlineSpiller.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_1e8ad0574bd6e387992681ee57691a07.html">CodeGen</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">InlineSpiller.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="InlineSpiller_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- InlineSpiller.cpp - Insert spills and restores inline --------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// The inline spiller modifies the machine function directly instead of</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// inserting spills and restores in VirtRegMap.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SplitKit_8h.html">SplitKit.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ArrayRef_8h.html">llvm/ADT/ArrayRef.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MapVector_8h.html">llvm/ADT/MapVector.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LiveInterval_8h.html">llvm/CodeGen/LiveInterval.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LiveIntervals_8h.html">llvm/CodeGen/LiveIntervals.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LiveRangeEdit_8h.html">llvm/CodeGen/LiveRangeEdit.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LiveStacks_8h.html">llvm/CodeGen/LiveStacks.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineBasicBlock_8h.html">llvm/CodeGen/MachineBasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineBlockFrequencyInfo_8h.html">llvm/CodeGen/MachineBlockFrequencyInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineDominators_8h.html">llvm/CodeGen/MachineDominators.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunction_8h.html">llvm/CodeGen/MachineFunction.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunctionPass_8h.html">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstr_8h.html">llvm/CodeGen/MachineInstr.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstrBuilder_8h.html">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstrBundle_8h.html">llvm/CodeGen/MachineInstrBundle.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineLoopInfo_8h.html">llvm/CodeGen/MachineLoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineOperand_8h.html">llvm/CodeGen/MachineOperand.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineRegisterInfo_8h.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SlotIndexes_8h.html">llvm/CodeGen/SlotIndexes.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Spiller_8h.html">llvm/CodeGen/Spiller.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StackMaps_8h.html">llvm/CodeGen/StackMaps.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetInstrInfo_8h.html">llvm/CodeGen/TargetInstrInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetOpcodes_8h.html">llvm/CodeGen/TargetOpcodes.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetRegisterInfo_8h.html">llvm/CodeGen/TargetRegisterInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetSubtargetInfo_8h.html">llvm/CodeGen/TargetSubtargetInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="VirtRegMap_8h.html">llvm/CodeGen/VirtRegMap.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;llvm/Config/llvm-config.h&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BlockFrequency_8h.html">llvm/Support/BlockFrequency.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BranchProbability_8h.html">llvm/Support/BranchProbability.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Compiler_8h.html">llvm/Support/Compiler.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="InlineSpiller_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   63</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;regalloc&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSpilledRanges,   <span class="stringliteral">&quot;Number of spilled live ranges&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSnippets,        <span class="stringliteral">&quot;Number of spilled snippets&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSpills,          <span class="stringliteral">&quot;Number of spills inserted&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSpillsRemoved,   <span class="stringliteral">&quot;Number of spills removed&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumReloads,         <span class="stringliteral">&quot;Number of reloads inserted&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumReloadsRemoved,  <span class="stringliteral">&quot;Number of reloads removed&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumFolded,          <span class="stringliteral">&quot;Number of folded stack accesses&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumFoldedLoads,     <span class="stringliteral">&quot;Number of folded loads&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumRemats,          <span class="stringliteral">&quot;Number of rematerialized defs for spilling&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="InlineSpiller_8cpp.html#a7819774f1578a13aaf380ec73782c9e4">DisableHoisting</a>(<span class="stringliteral">&quot;disable-spill-hoist&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                     <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Disable inline spill hoisting&quot;</span>));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<a class="code" href="InlineSpiller_8cpp.html#a44eadd2e9dc8ce097d98948617fd127a">RestrictStatepointRemat</a>(<span class="stringliteral">&quot;restrict-statepoint-remat&quot;</span>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                       <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                       <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Restrict remat for statepoint operands&quot;</span>));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">class </span>HoistSpillHelper : <span class="keyword">private</span> <a class="code" href="classllvm_1_1LiveRangeEdit_1_1Delegate.html">LiveRangeEdit::Delegate</a> {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classllvm_1_1LiveIntervals.html">LiveIntervals</a> &amp;LIS;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classllvm_1_1LiveStacks.html">LiveStacks</a> &amp;LSS;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classllvm_1_1MachineDominatorTree.html">MachineDominatorTree</a> &amp;MDT;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classllvm_1_1MachineLoopInfo.html">MachineLoopInfo</a> &amp;<a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classllvm_1_1VirtRegMap.html">VirtRegMap</a> &amp;VRM;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineBlockFrequencyInfo.html">MachineBlockFrequencyInfo</a> &amp;MBFI;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classllvm_1_1InsertPointAnalysis.html">InsertPointAnalysis</a> IPA;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// Map from StackSlot to the LiveInterval of the original register.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// Note the LiveInterval of the original register may have been deleted</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// after it is spilled. We keep a copy here to track the range where</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">// spills can be moved.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;int, std::unique_ptr&lt;LiveInterval&gt;</a>&gt; StackSlotToOrigLI;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// Map from pair of (StackSlot and Original VNI) to a set of spills which</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// have the same stackslot and have equal values defined by Original VNI.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// These spills are mergeable and are hoist candidates.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">using</span> MergeableSpillsMap =</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="classllvm_1_1MapVector.html">MapVector&lt;std::pair&lt;int, VNInfo *&gt;</a>, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a>&gt;;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  MergeableSpillsMap MergeableSpills;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  /// This is the map from original register to a set containing all its</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  /// siblings. To hoist a spill to another BB, we need to find out a live</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">  /// sibling there and use it as the source of the new spill.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;Register, SmallSetVector&lt;Register, 16&gt;</a>&gt; Virt2SiblingsMap;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">bool</span> isSpillCandBB(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> &amp;OrigVNI,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                     <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> &amp;LiveReg);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">void</span> rmRedundantSpills(</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a> &amp;Spills,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineInstr *&gt;</a> &amp;SpillsToRm,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, MachineInstr *&gt;</a> &amp;SpillBBToSpill);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">void</span> getVisitOrders(</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *Root, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a> &amp;Spills,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineDomTreeNode *&gt;</a> &amp;Orders,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineInstr *&gt;</a> &amp;SpillsToRm,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, unsigned&gt;</a> &amp;SpillsToKeep,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, MachineInstr *&gt;</a> &amp;SpillBBToSpill);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">void</span> runHoistSpills(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> &amp;OrigVNI,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                      <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a> &amp;Spills,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                      <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineInstr *&gt;</a> &amp;SpillsToRm,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                      <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineBasicBlock *, unsigned&gt;</a> &amp;SpillsToIns);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  HoistSpillHelper(<a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a> &amp;<a class="code" href="ModuloSchedule_8cpp.html#a27488fd62a85fc5ec4fd4247f8ec22aa">pass</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;mf,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                   <a class="code" href="classllvm_1_1VirtRegMap.html">VirtRegMap</a> &amp;vrm)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      : MF(mf), LIS(<a class="code" href="ModuloSchedule_8cpp.html#a27488fd62a85fc5ec4fd4247f8ec22aa">pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1LiveIntervals.html">LiveIntervals</a>&gt;()),</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        LSS(<a class="code" href="ModuloSchedule_8cpp.html#a27488fd62a85fc5ec4fd4247f8ec22aa">pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1LiveStacks.html">LiveStacks</a>&gt;()),</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        MDT(<a class="code" href="ModuloSchedule_8cpp.html#a27488fd62a85fc5ec4fd4247f8ec22aa">pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1MachineDominatorTree.html">MachineDominatorTree</a>&gt;()),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>(<a class="code" href="ModuloSchedule_8cpp.html#a27488fd62a85fc5ec4fd4247f8ec22aa">pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1MachineLoopInfo.html">MachineLoopInfo</a>&gt;()), VRM(vrm),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>(mf.getRegInfo()), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>(*mf.getSubtarget().getInstrInfo()),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>(*mf.getSubtarget().getRegisterInfo()),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        MBFI(<a class="code" href="ModuloSchedule_8cpp.html#a27488fd62a85fc5ec4fd4247f8ec22aa">pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1MachineBlockFrequencyInfo.html">MachineBlockFrequencyInfo</a>&gt;()),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        IPA(LIS, mf.getNumBlockIDs()) {}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">void</span> addToMergeableSpills(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;Spill, <span class="keywordtype">int</span> StackSlot,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                            <span class="keywordtype">unsigned</span> Original);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">bool</span> rmFromMergeableSpills(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;Spill, <span class="keywordtype">int</span> StackSlot);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">void</span> hoistAllSpills();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">void</span> LRE_DidCloneVirtReg(<a class="code" href="classllvm_1_1Register.html">Register</a>, <a class="code" href="classllvm_1_1Register.html">Register</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;};</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">class </span>InlineSpiller : <span class="keyword">public</span> <a class="code" href="classllvm_1_1Spiller.html">Spiller</a> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classllvm_1_1LiveIntervals.html">LiveIntervals</a> &amp;LIS;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="classllvm_1_1LiveStacks.html">LiveStacks</a> &amp;LSS;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="classllvm_1_1MachineDominatorTree.html">MachineDominatorTree</a> &amp;MDT;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classllvm_1_1MachineLoopInfo.html">MachineLoopInfo</a> &amp;<a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="classllvm_1_1VirtRegMap.html">VirtRegMap</a> &amp;VRM;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineBlockFrequencyInfo.html">MachineBlockFrequencyInfo</a> &amp;MBFI;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// Variables that are valid during spill(), but used by multiple methods.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="classllvm_1_1LiveRangeEdit.html">LiveRangeEdit</a> *Edit;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> *StackInt;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">int</span> StackSlot;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Original;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// All registers to spill to StackSlot, including the main register.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Register, 8&gt;</a> RegsToSpill;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// All COPY instructions to/from snippets.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// They are ignored since both operands refer to the same stack slot.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr*, 8&gt;</a> SnippetCopies;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// Values that failed to remat at some point.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;VNInfo*, 8&gt;</a> UsedValues;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// Dead defs generated during spilling.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineInstr*, 8&gt;</a> DeadDefs;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// Object records spills information and does the hoisting.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  HoistSpillHelper HSpiller;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// Live range weight calculator.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classllvm_1_1VirtRegAuxInfo.html">VirtRegAuxInfo</a> &amp;VRAI;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  ~InlineSpiller() <span class="keyword">override</span> = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  InlineSpiller(<a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a> &amp;<a class="code" href="classllvm_1_1Pass.html">Pass</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1VirtRegMap.html">VirtRegMap</a> &amp;VRM,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <a class="code" href="classllvm_1_1VirtRegAuxInfo.html">VirtRegAuxInfo</a> &amp;VRAI)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      : MF(MF), LIS(<a class="code" href="classllvm_1_1Pass.html">Pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1LiveIntervals.html">LiveIntervals</a>&gt;()),</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        LSS(<a class="code" href="classllvm_1_1Pass.html">Pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1LiveStacks.html">LiveStacks</a>&gt;()),</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        MDT(<a class="code" href="classllvm_1_1Pass.html">Pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1MachineDominatorTree.html">MachineDominatorTree</a>&gt;()),</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>(<a class="code" href="classllvm_1_1Pass.html">Pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1MachineLoopInfo.html">MachineLoopInfo</a>&gt;()), VRM(VRM),</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>(MF.getRegInfo()), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>(*MF.getSubtarget().getInstrInfo()),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>(*MF.getSubtarget().getRegisterInfo()),</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        MBFI(<a class="code" href="classllvm_1_1Pass.html">Pass</a>.getAnalysis&lt;<a class="code" href="classllvm_1_1MachineBlockFrequencyInfo.html">MachineBlockFrequencyInfo</a>&gt;()),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        HSpiller(<a class="code" href="classllvm_1_1Pass.html">Pass</a>, MF, VRM), VRAI(VRAI) {}</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="README-SSE_8txt.html#a7246178f42b1eaef4e9bba10a9f39323">spill</a>(<a class="code" href="classllvm_1_1LiveRangeEdit.html">LiveRangeEdit</a> &amp;) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">void</span> postOptimization() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">bool</span> isSnippet(<span class="keyword">const</span> <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SnipLI);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">void</span> collectRegsToSpill();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">bool</span> isRegToSpill(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) { <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">is_contained</a>(RegsToSpill, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>); }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">bool</span> isSibling(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">bool</span> hoistSpillInsideBB(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SpillLI, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;CopyMI);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">void</span> eliminateRedundantSpills(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;LI, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *VNI);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordtype">void</span> markValueUsed(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a>*, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a>*);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">bool</span> canGuaranteeAssignmentAfterRemat(<a class="code" href="classllvm_1_1Register.html">Register</a> VReg, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">bool</span> reMaterializeFor(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">void</span> reMaterializeAll();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordtype">bool</span> coalesceStackAccess(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">bool</span> foldMemoryOperand(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt;std::pair&lt;MachineInstr *, unsigned&gt;&gt;,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                         <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *LoadMI = <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordtype">void</span> insertReload(<a class="code" href="classllvm_1_1Register.html">Register</a> VReg, <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a>, <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">void</span> insertSpill(<a class="code" href="classllvm_1_1Register.html">Register</a> VReg, <span class="keywordtype">bool</span> isKill, <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">void</span> spillAroundUses(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">void</span> spillAll();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;};</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<a class="code" href="classllvm_1_1Spiller.html#a4346292d56a1b2beed7e2a000614c860">Spiller::~Spiller</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">void</span> Spiller::anchor() {}</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="namespacellvm.html#a56612ec3760d5308cf17fd1a2b9add93">  240</a></span>&#160;<a class="code" href="classllvm_1_1Spiller.html">Spiller</a> *<a class="code" href="namespacellvm.html#a56612ec3760d5308cf17fd1a2b9add93">llvm::createInlineSpiller</a>(<a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a> &amp;<a class="code" href="classllvm_1_1Pass.html">Pass</a>,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                   <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1VirtRegMap.html">VirtRegMap</a> &amp;VRM,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                   <a class="code" href="classllvm_1_1VirtRegAuxInfo.html">VirtRegAuxInfo</a> &amp;VRAI) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> InlineSpiller(<a class="code" href="classllvm_1_1Pass.html">Pass</a>, MF, VRM, VRAI);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">//                                Snippets</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">// When spilling a virtual register, we also spill any snippets it is connected</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">// to. The snippets are small live ranges that only have a single real use,</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">// leftovers from live range splitting. Spilling them enables memory operand</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">// folding or tightens the live range around the single use.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">// This minimizes register pressure and maximizes the store-to-load distance for</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">// spill slots which can be important in tight loops.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">/// isFullCopyOf - If MI is a COPY to or from Reg, return the other register,</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/// otherwise return 0.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="InlineSpiller_8cpp.html#a7bcb2af53f5165c69a357f244ead0ebb">  260</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="InlineSpiller_8cpp.html#a7bcb2af53f5165c69a357f244ead0ebb">isFullCopyOf</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isFullCopy())</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Register.html">Register</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg() == <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getReg() == <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Register.html">Register</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="InlineSpiller_8cpp.html#ac370c41caa198ae51b35d5b35f9b8c81">  270</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="InlineSpiller_8cpp.html#ac370c41caa198ae51b35d5b35f9b8c81">getVDefInterval</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1LiveIntervals.html">LiveIntervals</a> &amp;LIS) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO : <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands())</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (MO.isReg() &amp;&amp; MO.isDef() &amp;&amp; MO.getReg().isVirtual())</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a25c117ac45bfbbcf69dc0b674db2d1ea">getInterval</a>(MO.getReg());</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">/// isSnippet - Identify if a live interval is a snippet that should be spilled.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">/// It is assumed that SnipLI is a virtual register with the same original as</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">/// Edit-&gt;getReg().</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> InlineSpiller::isSnippet(<span class="keyword">const</span> <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SnipLI) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = Edit-&gt;getReg();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// A snippet is a tiny live range with only a single instruction using it</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// besides copies to/from Reg or spills/fills.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// Exception is done for statepoint instructions which will fold fills</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// into their operands.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// We accept:</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">//   %snip = COPY %Reg / FILL fi#</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">//   %snip = USE %snip</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">//   %snip = STATEPOINT %snip in var arg area</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">//   %Reg = COPY %snip / SPILL %snip, fi#</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">if</span> (!LIS.intervalIsInOneMBB(SnipLI))</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// Number of defs should not exceed 2 not accounting defs coming from</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// statepoint instructions.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">unsigned</span> NumValNums = SnipLI.<a class="code" href="classllvm_1_1LiveRange.html#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *VNI : SnipLI.<a class="code" href="classllvm_1_1LiveRange.html#a352c24ce556adb51f63f40a7d946ae44">vnis</a>()) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = LIS.getInstructionFromIndex(VNI-&gt;def);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOpcode() == TargetOpcode::STATEPOINT)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      --NumValNums;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">if</span> (NumValNums &gt; 2)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ExpandPseudoInsts_8cpp.html#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// Check that all uses satisfy our criteria.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineRegisterInfo_1_1defusechain__instr__iterator.html">MachineRegisterInfo::reg_instr_nodbg_iterator</a></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;           RI = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#ae43ef10e056198d73d7c688d0649c9b2">reg_instr_nodbg_begin</a>(SnipLI.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>()),</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;           <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a29a1144eb9d753b6b682a933aa3f8f9f">reg_instr_nodbg_end</a>();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;       RI != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *RI++;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// Allow copies to/from Reg.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InlineSpiller_8cpp.html#a7bcb2af53f5165c69a357f244ead0ebb">isFullCopyOf</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// Allow stack slot loads.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">int</span> FI;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (SnipLI.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>() == <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#aa78de19ae21b6786dd84b7baf19d9cbe">isLoadFromStackSlot</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI) &amp;&amp; FI == StackSlot)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// Allow stack slot stores.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (SnipLI.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>() == <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a92680e141738540aefb738d4e907701d">isStoreToStackSlot</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI) &amp;&amp; FI == StackSlot)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StatepointOpers.html#afa5a7e5f9b626c9fb0b9d66235146ac3">StatepointOpers::isFoldableReg</a>(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, SnipLI.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>()))</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Allow a single additional instruction.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64ExpandPseudoInsts_8cpp.html#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> &amp;&amp; &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> != <a class="code" href="AArch64ExpandPseudoInsts_8cpp.html#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="AArch64ExpandPseudoInsts_8cpp.html#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> = &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">/// collectRegsToSpill - Collect live range snippets that only have a single</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/// real use.</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::collectRegsToSpill() {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = Edit-&gt;getReg();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// Main register always spills.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  RegsToSpill.assign(1, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  SnippetCopies.clear();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// Snippets all have the same original, so there can&#39;t be any for an original</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// register.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (Original == <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> :</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;       <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a2718c79d7ff861cf3645991cef024f84">reg_instructions</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SnipReg = <a class="code" href="InlineSpiller_8cpp.html#a7bcb2af53f5165c69a357f244ead0ebb">isFullCopyOf</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> (!isSibling(SnipReg))</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SnipLI = LIS.getInterval(SnipReg);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (!isSnippet(SnipLI))</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    SnippetCopies.insert(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (isRegToSpill(SnipReg))</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    RegsToSpill.push_back(SnipReg);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\talso spill snippet &quot;</span> &lt;&lt; SnipLI &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    ++NumSnippets;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordtype">bool</span> InlineSpiller::isSibling(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>.isVirtual() &amp;&amp; VRM.getOriginal(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) == Original;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">/// It is beneficial to spill to earlier place in the same BB in case</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">/// as follows:</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">/// There is an alternative def earlier in the same MBB.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">/// Hoist the spill as far as possible in SpillMBB. This can ease</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">/// register pressure:</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">///   x = def</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">///   y = use x</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">///   s = copy x</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/// Hoisting the spill of s to immediately after the def removes the</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/// interference between x and y:</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">///   x = def</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">///   spill x</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">///   y = use killed x</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/// This hoist only helps when the copy kills its source.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> InlineSpiller::hoistSpillInsideBB(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SpillLI,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                       <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;CopyMI) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = LIS.getInstructionIndex(CopyMI);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *VNI = SpillLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>());</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VNI &amp;&amp; VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>() &amp;&amp; <span class="stringliteral">&quot;Not defined by copy&quot;</span>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = CopyMI.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SrcLI = LIS.getInterval(SrcReg);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *SrcVNI = SrcLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="classllvm_1_1LiveQueryResult.html">LiveQueryResult</a> SrcQ = SrcLI.<a class="code" href="classllvm_1_1LiveRange.html#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(Idx);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DefMBB = LIS.getMBBFromIndex(SrcVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span> (DefMBB != CopyMI.<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>() || !SrcQ.<a class="code" href="classllvm_1_1LiveQueryResult.html#af155aeaffc7607f4f27ab4cfcbb39a64">isKill</a>())</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// Conservatively extend the stack slot range to the range of the original</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// value. We may be able to do better with stack slot coloring by being more</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// careful here.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StackInt &amp;&amp; <span class="stringliteral">&quot;No stack slot assigned yet.&quot;</span>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI = LIS.getInterval(Original);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *OrigVNI = OrigLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  StackInt-&gt;MergeValueInAsValue(OrigLI, OrigVNI, StackInt-&gt;getValNumInfo(0));</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tmerged orig valno &quot;</span> &lt;&lt; OrigVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ad989a0c1b26066308798f4d11a0e69df">id</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    &lt;&lt; *StackInt &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// We are going to spill SrcVNI immediately after its def, so clear out</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">// any later spills of the same value.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  eliminateRedundantSpills(SrcLI, SrcVNI);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = LIS.getMBBFromIndex(SrcVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> MII;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordflow">if</span> (SrcVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>())</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    MII = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a0bcbe87140565048a95f70d5207b4a93">SkipPHIsLabelsAndDebug</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>());</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ExpandPseudoInsts_8cpp.html#ad3ece0ac2421637044624c9b01c42466">DefMI</a> = LIS.getInstructionFromIndex(SrcVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64ExpandPseudoInsts_8cpp.html#ad3ece0ac2421637044624c9b01c42466">DefMI</a> &amp;&amp; <span class="stringliteral">&quot;Defining instruction disappeared&quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    MII = <a class="code" href="AArch64ExpandPseudoInsts_8cpp.html#ad3ece0ac2421637044624c9b01c42466">DefMI</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    ++MII;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrSpan.html">MachineInstrSpan</a> MIS(MII, <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// Insert spill without kill flag immediately after def.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a230837b86f36384876568b3bdb4fdafb">storeRegToStackSlot</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, MII, SrcReg, <span class="keyword">false</span>, StackSlot,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                          <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">getRegClass</a>(SrcReg), &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="classllvm_1_1Register.html">Register</a>());</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  LIS.InsertMachineInstrRangeInMaps(MIS.begin(), MII);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(MIS.begin(), MII))</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="InlineSpiller_8cpp.html#ac370c41caa198ae51b35d5b35f9b8c81">getVDefInterval</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, LIS);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  --MII; <span class="comment">// Point to store instruction.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\thoisted: &quot;</span> &lt;&lt; SrcVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; *MII);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// If there is only 1 store instruction is required for spill, add it</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// to mergeable list. In X86 AMX, 2 intructions are required to store.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">// We disable the merge for this case.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span> (MIS.begin() == MII)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    HSpiller.addToMergeableSpills(*MII, StackSlot, Original);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  ++NumSpills;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">/// eliminateRedundantSpills - SLI:VNI is known to be on the stack. Remove any</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">/// redundant spills of this value in SLI.reg and sibling copies.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::eliminateRedundantSpills(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SLI, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *VNI) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VNI &amp;&amp; <span class="stringliteral">&quot;Missing value&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;LiveInterval*, VNInfo*&gt;</a>, 8&gt; WorkList;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  WorkList.push_back(std::make_pair(&amp;SLI, VNI));</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StackInt &amp;&amp; <span class="stringliteral">&quot;No stack slot assigned yet.&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> *LI;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    std::tie(LI, VNI) = WorkList.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = LI-&gt;<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Checking redundant spills for &quot;</span> &lt;&lt; VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ad989a0c1b26066308798f4d11a0e69df">id</a> &lt;&lt; <span class="charliteral">&#39;@&#39;</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                      &lt;&lt; VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; *LI &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// Regs to spill are taken care of.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (isRegToSpill(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// Add all of VNI&#39;s live range to StackInt.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    StackInt-&gt;MergeValueInAsValue(*LI, VNI, StackInt-&gt;getValNumInfo(0));</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Merged to stack int: &quot;</span> &lt;&lt; *StackInt &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// Find all spills and copies of VNI.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> :</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;         <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a7e0683c1bfad27f51e8d6c3a8cbdbfdc">use_nodbg_instructions</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCopy() &amp;&amp; !<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.mayStore())</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = LIS.getInstructionIndex(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx) != VNI)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">// Follow sibling copies down the dominator tree.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="InlineSpiller_8cpp.html#a7bcb2af53f5165c69a357f244ead0ebb">isFullCopyOf</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">if</span> (isSibling(DstReg)) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;           <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;DstLI = LIS.getInterval(DstReg);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;           <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *DstVNI = DstLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>());</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;           <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstVNI &amp;&amp; <span class="stringliteral">&quot;Missing defined value&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;           <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>() &amp;&amp; <span class="stringliteral">&quot;Wrong copy def slot&quot;</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;           WorkList.push_back(std::make_pair(&amp;DstLI, DstVNI));</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="comment">// Erase spills.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordtype">int</span> FI;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> == <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a92680e141738540aefb738d4e907701d">isStoreToStackSlot</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI) &amp;&amp; FI == StackSlot) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Redundant spill &quot;</span> &lt;&lt; Idx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// eliminateDeadDefs won&#39;t normally remove stores, so switch opcode.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::KILL));</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        DeadDefs.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        ++NumSpillsRemoved;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">if</span> (HSpiller.rmFromMergeableSpills(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, StackSlot))</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          --NumSpills;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  } <span class="keywordflow">while</span> (!WorkList.empty());</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//                            Rematerialization</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">/// markValueUsed - Remember that VNI failed to rematerialize, so its defining</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/// instruction cannot be eliminated. See through snippet copies</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::markValueUsed(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> *LI, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *VNI) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;LiveInterval*, VNInfo*&gt;</a>, 8&gt; WorkList;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  WorkList.push_back(std::make_pair(LI, VNI));</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    std::tie(LI, VNI) = WorkList.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">pop_back_val</a>();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (!UsedValues.insert(VNI).second)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>()) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = LIS.getMBBFromIndex(VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#afd9b9b8655c008bf6cd6afb05d41b69e">predecessors</a>()) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *PVNI = LI-&gt;<a class="code" href="classllvm_1_1LiveRange.html#a136fa159d07a92017f3206822f5847cd">getVNInfoBefore</a>(LIS.getMBBEndIdx(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>));</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">if</span> (PVNI)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          WorkList.push_back(std::make_pair(LI, PVNI));</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// Follow snippet copies.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = LIS.getInstructionFromIndex(VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (!SnippetCopies.count(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SnipLI = LIS.getInterval(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).getReg());</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isRegToSpill(SnipLI.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>()) &amp;&amp; <span class="stringliteral">&quot;Unexpected register in copy&quot;</span>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *SnipVNI = SnipLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(<span class="keyword">true</span>));</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SnipVNI &amp;&amp; <span class="stringliteral">&quot;Snippet undefined before copy&quot;</span>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    WorkList.push_back(std::make_pair(&amp;SnipLI, SnipVNI));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  } <span class="keywordflow">while</span> (!WorkList.empty());</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;}</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordtype">bool</span> InlineSpiller::canGuaranteeAssignmentAfterRemat(<a class="code" href="classllvm_1_1Register.html">Register</a> VReg,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                     <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="InlineSpiller_8cpp.html#a44eadd2e9dc8ce097d98948617fd127a">RestrictStatepointRemat</a>)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// Here&#39;s a quick explanation of the problem we&#39;re trying to handle here:</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">// * There are some pseudo instructions with more vreg uses than there are</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">//   physical registers on the machine.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// * This is normally handled by spilling the vreg, and folding the reload</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">//   into the user instruction.  (Thus decreasing the number of used vregs</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">//   until the remainder can be assigned to physregs.)</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// * However, since we may try to spill vregs in any order, we can end up</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">//   trying to spill each operand to the instruction, and then rematting it</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">//   instead.  When that happens, the new live intervals (for the remats) are</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">//   expected to be trivially assignable (i.e. RS_Done).  However, since we</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">//   may have more remats than physregs, we&#39;re guaranteed to fail to assign</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">//   one.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// At the moment, we only handle this for STATEPOINTs since they&#39;re the only</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// pseudo op where we&#39;ve seen this.  If we start seeing other instructions</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// with the same problem, we need to revisit this.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() != TargetOpcode::STATEPOINT)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// For STATEPOINTs we allow re-materialization for fixed arguments only hoping</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// that number of physical registers is enough to cover all fixed arguments.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">// If it is not true we need to revisit it.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = <a class="code" href="classllvm_1_1StatepointOpers.html">StatepointOpers</a>(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).getVarIdx(),</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                EndIdx = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getNumOperands();</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;       Idx &lt; EndIdx; ++Idx) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(Idx);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == VReg)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">/// reMaterializeFor - Attempt to rematerialize before MI instead of reloading.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> InlineSpiller::reMaterializeFor(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;VirtReg, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">// Analyze instruction</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;MachineInstr *, unsigned&gt;</a>, 8&gt; Ops;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="structllvm_1_1VirtRegInfo.html">VirtRegInfo</a> RI = <a class="code" href="namespacellvm.html#a2f2ae9a92eaa5f689a13f21782d4838e">AnalyzeVirtRegInBundle</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, VirtReg.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), &amp;Ops);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">if</span> (!RI.<a class="code" href="structllvm_1_1VirtRegInfo.html#a0066fe4418e8c4c6c08dd9a9f2ee70e7">Reads</a>)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> UseIdx = LIS.getInstructionIndex(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *ParentVNI = VirtReg.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(UseIdx.<a class="code" href="classllvm_1_1SlotIndex.html#aa94e57689dd16c1c4de909511f1b2ea8">getBaseIndex</a>());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">if</span> (!ParentVNI) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tadding &lt;undef&gt; flags: &quot;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO : <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands())</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">isUse</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == VirtReg.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>())</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        MO.<a class="code" href="classllvm_1_1MachineOperand.html#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; UseIdx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> (SnippetCopies.count(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI = LIS.getInterval(Original);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *OrigVNI = OrigLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(UseIdx);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="structllvm_1_1LiveRangeEdit_1_1Remat.html">LiveRangeEdit::Remat</a> <a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>(ParentVNI);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>.OrigMI = LIS.getInstructionFromIndex(OrigVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">if</span> (!Edit-&gt;canRematerializeAt(<a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>, OrigVNI, UseIdx, <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    markValueUsed(&amp;VirtReg, ParentVNI);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tcannot remat for &quot;</span> &lt;&lt; UseIdx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// If the instruction also writes VirtReg.reg, it had better not require the</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">// same register for uses and defs.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">if</span> (RI.<a class="code" href="structllvm_1_1VirtRegInfo.html#a5a3349f5396be814b455f5f3a01f4efe">Tied</a>) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    markValueUsed(&amp;VirtReg, ParentVNI);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tcannot remat tied reg: &quot;</span> &lt;&lt; UseIdx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="comment">// Before rematerializing into a register for a single instruction, try to</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">// fold a load into the instruction. That avoids allocating a new register.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>.OrigMI-&gt;canFoldAsLoad() &amp;&amp;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      foldMemoryOperand(Ops, <a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>.OrigMI)) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    Edit-&gt;markRematerialized(<a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>.ParentVNI);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    ++NumFoldedLoads;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// If we can&#39;t guarantee that we&#39;ll be able to actually assign the new vreg,</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// we can&#39;t remat.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">if</span> (!canGuaranteeAssignmentAfterRemat(VirtReg.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    markValueUsed(&amp;VirtReg, ParentVNI);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tcannot remat for &quot;</span> &lt;&lt; UseIdx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// Allocate a new register for the remat.</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> NewVReg = Edit-&gt;createFrom(Original);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// Finally we can rematerialize OrigMI before MI.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> DefIdx =</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      Edit-&gt;rematerializeAt(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent(), <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, NewVReg, <a class="code" href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">// We take the DebugLoc from MI, since OrigMI may be attributed to a</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">// different source location.</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keyword">auto</span> *NewMI = LIS.getInstructionFromIndex(DefIdx);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  NewMI-&gt;setDebugLoc(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc());</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  (void)DefIdx;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tremat:  &quot;</span> &lt;&lt; DefIdx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    &lt;&lt; *LIS.getInstructionFromIndex(DefIdx));</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// Replace operands</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;OpPair : Ops) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = OpPair.first-&gt;getOperand(OpPair.second);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">isUse</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == VirtReg.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>()) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      MO.<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(NewVReg);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      MO.<a class="code" href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">setIsKill</a>();</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\t        &quot;</span> &lt;&lt; UseIdx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  ++NumRemats;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">/// reMaterializeAll - Try to rematerialize as many uses as possible,</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">/// and trim the live ranges after.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::reMaterializeAll() {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">if</span> (!Edit-&gt;anyRematerializable())</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  UsedValues.clear();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">// Try to remat before all uses of snippets.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordtype">bool</span> anyRemat = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> : RegsToSpill) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;LI = LIS.getInterval(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a3985184940a3c717fb98e6d6bfbfd0d6">reg_bundles</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="comment">// Debug values are not allowed to affect codegen.</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugValue())</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugInstr() &amp;&amp; <span class="stringliteral">&quot;Did not expect to find a use in debug &quot;</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;             <span class="stringliteral">&quot;instruction that isn&#39;t a DBG_VALUE&quot;</span>);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      anyRemat |= reMaterializeFor(LI, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">if</span> (!anyRemat)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">// Remove any values that were completely rematted.</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> : RegsToSpill) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;LI = LIS.getInterval(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *VNI : LI.<a class="code" href="classllvm_1_1LiveRange.html#a352c24ce556adb51f63f40a7d946ae44">vnis</a>()) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">if</span> (VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ab72366fd538f240cbb53dac39368cdfc">isUnused</a>() || VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>() || UsedValues.count(VNI))</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = LIS.getInstructionFromIndex(VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;addRegisterDead(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;allDefsAreDead())</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;All defs dead: &quot;</span> &lt;&lt; *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      DeadDefs.push_back(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">// Eliminate dead code after remat. Note that some snippet copies may be</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// deleted here.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span> (DeadDefs.empty())</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Remat created &quot;</span> &lt;&lt; DeadDefs.size() &lt;&lt; <span class="stringliteral">&quot; dead defs.\n&quot;</span>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  Edit-&gt;eliminateDeadDefs(DeadDefs, RegsToSpill);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// LiveRangeEdit::eliminateDeadDef is used to remove dead define instructions</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">// after rematerialization.  To remove a VNI for a vreg from its LiveInterval,</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">// LiveIntervals::removeVRegDefAt is used. However, after non-PHI VNIs are all</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">// removed, PHI VNI are still left in the LiveInterval.</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// So to get rid of unused reg, we need to check whether it has non-dbg</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// reference instead of whether it has non-empty interval.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordtype">unsigned</span> ResultPos = 0;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> : RegsToSpill) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a666dc30b9326da6b9e69740a241df89d">reg_nodbg_empty</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      Edit-&gt;eraseVirtReg(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LIS.hasInterval(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) &amp;&amp;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;           (!LIS.getInterval(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>).empty() || !<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a666dc30b9326da6b9e69740a241df89d">reg_nodbg_empty</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)) &amp;&amp;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;           <span class="stringliteral">&quot;Empty and not used live-range?!&quot;</span>);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    RegsToSpill[ResultPos++] = <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  RegsToSpill.erase(RegsToSpill.begin() + ResultPos, RegsToSpill.end());</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; RegsToSpill.size()</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; registers to spill after remat.\n&quot;</span>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;}</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//                                 Spilling</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">/// If MI is a load or store of StackSlot, it can be removed.</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> InlineSpiller::coalesceStackAccess(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordtype">int</span> FI = 0;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> InstrReg = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#aa78de19ae21b6786dd84b7baf19d9cbe">isLoadFromStackSlot</a>(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordtype">bool</span> IsLoad = InstrReg;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">if</span> (!IsLoad)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    InstrReg = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a92680e141738540aefb738d4e907701d">isStoreToStackSlot</a>(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">// We have a stack access. Is it the right register and slot?</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">if</span> (InstrReg != <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> || FI != StackSlot)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">if</span> (!IsLoad)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    HSpiller.rmFromMergeableSpills(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, StackSlot);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Coalescing stack access: &quot;</span> &lt;&lt; *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  LIS.RemoveMachineInstrFromMaps(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">if</span> (IsLoad) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    ++NumReloadsRemoved;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    --NumReloads;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    ++NumSpillsRemoved;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    --NumSpills;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;}</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<a class="code" href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">// Dump the range of instructions from B to E with their slot indexes.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="InlineSpiller_8cpp.html#a3a62b5d1e83ec172369441613b538fce">  781</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="InlineSpiller_8cpp.html#a3a62b5d1e83ec172369441613b538fce">dumpMachineInstrRangeWithSlotIndex</a>(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                               <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                               <a class="code" href="classllvm_1_1LiveIntervals.html">LiveIntervals</a> <span class="keyword">const</span> &amp;LIS,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> header,</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                               <a class="code" href="classllvm_1_1Register.html">Register</a> VReg = <a class="code" href="classllvm_1_1Register.html">Register</a>()) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordtype">char</span> NextLine = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordtype">char</span> SlotIndent = <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">if</span> (std::next(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) == <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    NextLine = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    SlotIndent = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; header &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; NextLine;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">getInstructionIndex</a>(*I).<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">// If a register was passed in and this instruction has it as a</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">// destination that is marked as an early clobber, print the</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">// early-clobber slot index.</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">if</span> (VReg) {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> *MO = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;findRegisterDefOperand(VReg);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">if</span> (MO &amp;&amp; MO-&gt;<a class="code" href="classllvm_1_1MachineOperand.html#abd6aa9da048ef7a4faeaac6484d5c9a6">isEarlyClobber</a>())</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        Idx = Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; SlotIndent &lt;&lt; Idx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">/// foldMemoryOperand - Try folding stack slot references in Ops into their</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">/// instructions.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">/// @param Ops    Operand indices from AnalyzeVirtRegInBundle().</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">/// @param LoadMI Load instruction to use instead of stack slot when non-null.</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">/// @return       True on success.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> InlineSpiller::</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;foldMemoryOperand(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt;std::pair&lt;MachineInstr *, unsigned&gt;&gt; Ops,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *LoadMI) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">if</span> (Ops.empty())</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">// Don&#39;t attempt folding in bundles.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = Ops.front().first;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (Ops.back().first != <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> || <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isBundled())</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordtype">bool</span> WasCopy = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isCopy();</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ImpReg;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment">// TII::foldMemoryOperand will do what we need here for statepoint</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">// (fold load into use and remove corresponding def). We will replace</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">// uses of removed def with loads (spillAroundUses).</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// For that to work we need to untie def and use to pass it through</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// foldMemoryOperand and signal foldPatchpoint that it is allowed to</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// fold them.</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">bool</span> UntieRegs = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOpcode() == TargetOpcode::STATEPOINT;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">// Spill subregs if the target allows it.</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// We always want to spill subregs for stackmap/patchpoint pseudos.</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">bool</span> SpillSubRegs = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.isSubregFoldable() ||</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOpcode() == TargetOpcode::STATEPOINT ||</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aa31dda85603496c333a105d53ce62150">TargetOpcode::PATCHPOINT</a> ||</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOpcode() == <a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad2904b2502547c3f3d390774f8f548c7">TargetOpcode::STACKMAP</a>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">// TargetInstrInfo::foldMemoryOperand only expects explicit, non-tied</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// operands.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 8&gt;</a> FoldOps;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;OpPair : Ops) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordtype">unsigned</span> Idx = OpPair.second;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> == OpPair.first &amp;&amp; <span class="stringliteral">&quot;Instruction conflict during operand folding&quot;</span>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(Idx);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// No point restoring an undef read, and we&#39;ll produce an invalid live</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// interval.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">// TODO: Is this really the correct way to handle undef tied uses?</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">isUse</a>() &amp;&amp; !MO.<a class="code" href="classllvm_1_1MachineOperand.html#a3be9857a09c82046b77a71918b5e214f">readsReg</a>() &amp;&amp; !MO.<a class="code" href="classllvm_1_1MachineOperand.html#a894030fbf6d0f6c70991f05fff650930">isTied</a>())</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a3bf161859e1ad7fd3da485d3cb688d34">isImplicit</a>()) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      ImpReg = MO.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span> (!SpillSubRegs &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>())</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">// We cannot fold a load instruction into a def.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> (LoadMI &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">isDef</a>())</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// Tied use operands should not be passed to foldMemoryOperand.</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (UntieRegs || !<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isRegTiedToDefOperand(Idx))</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      FoldOps.push_back(Idx);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// If we only have implicit uses, we won&#39;t be able to fold that.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">// Moreover, TargetInstrInfo::foldMemoryOperand will assert if we try!</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> (FoldOps.empty())</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrSpan.html">MachineInstrSpan</a> MIS(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getParent());</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;unsigned, unsigned&gt;</a> &gt; TiedOps;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordflow">if</span> (UntieRegs)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx : FoldOps) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(Idx);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#a894030fbf6d0f6c70991f05fff650930">isTied</a>())</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordtype">unsigned</span> Tied = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;findTiedOperandIdx(Idx);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">isUse</a>())</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        TiedOps.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(Tied, Idx);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MO.<a class="code" href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">isDef</a>() &amp;&amp; <span class="stringliteral">&quot;Tied to not use and def?&quot;</span>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        TiedOps.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(Idx, Tied);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;untieRegOperand(Idx);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *FoldMI =</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      LoadMI ? <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.foldMemoryOperand(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FoldOps, *LoadMI, &amp;LIS)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;             : <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.foldMemoryOperand(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FoldOps, StackSlot, &amp;LIS, &amp;VRM);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="keywordflow">if</span> (!FoldMI) {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">// Re-tie operands.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Tied : TiedOps)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;tieOperands(Tied.first, Tied.second);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">// Remove LIS for any dead defs in the original MI not in FoldMI.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MIBundleOperands.html">MIBundleOperands</a> MO(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>); MO.isValid(); ++MO) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span> (!MO-&gt;<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = MO-&gt;<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> || <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>.isVirtual() || <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a53ca7cff9e929ba372da9780fdd44b02">isReserved</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// Skip non-Defs, including undef uses and internal reads.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (MO-&gt;<a class="code" href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">isUse</a>())</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <a class="code" href="structllvm_1_1PhysRegInfo.html">PhysRegInfo</a> RI = <a class="code" href="namespacellvm.html#a34ace715436fcbc42e83e196957b9f16">AnalyzePhysRegInBundle</a>(*FoldMI, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (RI.<a class="code" href="structllvm_1_1PhysRegInfo.html#afd963decf92bbfc81110071b5a39e9f4">FullyDefined</a>)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">// FoldMI does not define this physreg. Remove the LI segment.</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MO-&gt;<a class="code" href="classllvm_1_1MachineOperand.html#aaee820701392c55ad54235d3d7201206">isDead</a>() &amp;&amp; <span class="stringliteral">&quot;Cannot fold physreg def&quot;</span>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">getInstructionIndex</a>(*MI).<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#ae9f0ff5f13bf6cb4567247a39f7756e3">removePhysRegDefAt</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>.asMCReg(), Idx);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordtype">int</span> FI;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a92680e141738540aefb738d4e907701d">isStoreToStackSlot</a>(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI) &amp;&amp;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      HSpiller.rmFromMergeableSpills(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI))</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    --NumSpills;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#afbdfb2cc5decd8f22ea3ccc1ecea4028">ReplaceMachineInstrInMaps</a>(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, *FoldMI);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">// Update the call site info.</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isCandidateForCallSiteEntry())</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getMF()-&gt;moveCallSiteInfo(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FoldMI);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">// If we&#39;ve folded a store into an instruction labelled with debug-info,</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">// record a substitution from the old operand to the memory operand. Handle</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="comment">// the simple common case where operand 0 is the one being folded, plus when</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">// the destination operand is also a tied def. More values could be</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">// substituted / preserved with more analysis.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;peekDebugInstrNum() &amp;&amp; Ops[0].second == 0) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">// Helper lambda.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keyword">auto</span> MakeSubstitution = [<span class="keyword">this</span>,FoldMI,<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,&amp;Ops]() {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="comment">// Substitute old operand zero to the new instructions memory operand.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordtype">unsigned</span> OldOperandNum = Ops[0].second;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordtype">unsigned</span> NewNum = FoldMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ad26a74fb0ad868f0867cce317269d721">getDebugInstrNum</a>();</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keywordtype">unsigned</span> OldNum = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getDebugInstrNum();</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      MF.makeDebugValueSubstitution({OldNum, OldOperandNum},</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                         {NewNum, <a class="code" href="classllvm_1_1MachineFunction.html#a8f72614046d13d67b12a1e9201744ea8">MachineFunction::DebugOperandMemNumber</a>});</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    };</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Op0 = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(Ops[0].second);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (Ops.size() == 1 &amp;&amp; Op0.<a class="code" href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">isDef</a>()) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      MakeSubstitution();</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ops.size() == 2 &amp;&amp; Op0.<a class="code" href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">isDef</a>() &amp;&amp; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).isTied() &amp;&amp;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;               Op0.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).getReg()) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      MakeSubstitution();</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;peekDebugInstrNum()) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// This is a debug-labelled instruction, but the operand being folded isn&#39;t</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// at operand zero. Most likely this means it&#39;s a load being folded in.</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// Substitute any register defs from operand zero up to the one being</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// folded -- past that point, we don&#39;t know what the new operand indexes</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">// will be.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    MF.substituteDebugValuesForInst(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, *FoldMI, Ops[0].second);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="comment">// Insert any new instructions other than FoldMI into the LIS maps.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!MIS.empty() &amp;&amp; <span class="stringliteral">&quot;Unexpected empty span of instructions!&quot;</span>);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : MIS)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> != FoldMI)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a2035620c14bf7bdedfa4e2655f88d114">InsertMachineInstrInMaps</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">// TII.foldMemoryOperand may have left some implicit operands on the</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">// instruction.  Strip them.</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">if</span> (ImpReg)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = FoldMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a432824f0975bb863478bf4ef3a5df258">getNumOperands</a>(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>; --<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = FoldMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() || !MO.<a class="code" href="classllvm_1_1MachineOperand.html#a3bf161859e1ad7fd3da485d3cb688d34">isImplicit</a>())</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == ImpReg)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        FoldMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ac3b161ec90385105cb46a08b52139e60">removeOperand</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="InlineSpiller_8cpp.html#a3a62b5d1e83ec172369441613b538fce">dumpMachineInstrRangeWithSlotIndex</a>(MIS.begin(), MIS.end(), LIS,</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                                <span class="stringliteral">&quot;folded&quot;</span>));</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordflow">if</span> (!WasCopy)</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    ++NumFolded;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ops.front().second == 0) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    ++NumSpills;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="comment">// If there is only 1 store instruction is required for spill, add it</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">// to mergeable list. In X86 AMX, 2 intructions are required to store.</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">// We disable the merge for this case.</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">if</span> (std::distance(MIS.begin(), MIS.end()) &lt;= 1)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      HSpiller.addToMergeableSpills(*FoldMI, StackSlot, Original);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    ++NumReloads;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;}</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="keywordtype">void</span> InlineSpiller::insertReload(<a class="code" href="classllvm_1_1Register.html">Register</a> NewVReg,</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                 <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx,</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                 <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getParent();</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrSpan.html">MachineInstrSpan</a> MIS(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#abd2d8a338da0066ab5a287c36dd7928d">loadRegFromStackSlot</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, NewVReg, StackSlot,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                           <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">getRegClass</a>(NewVReg), &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="classllvm_1_1Register.html">Register</a>());</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a87b097de2261d68334195870a03412b9">InsertMachineInstrRangeInMaps</a>(MIS.begin(), <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="InlineSpiller_8cpp.html#a3a62b5d1e83ec172369441613b538fce">dumpMachineInstrRangeWithSlotIndex</a>(MIS.begin(), <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, LIS, <span class="stringliteral">&quot;reload&quot;</span>,</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                                                NewVReg));</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  ++NumReloads;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">/// Check if \p Def fully defines a VReg with an undefined value.</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">/// If that&#39;s the case, that means the value of VReg is actually</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">/// not relevant.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"><a class="line" href="InlineSpiller_8cpp.html#a812047022fbf54b86f829bce5496fcbd"> 1025</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InlineSpiller_8cpp.html#a812047022fbf54b86f829bce5496fcbd">isRealSpill</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>.isImplicitDef())</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>.getNumOperands() == 1 &amp;&amp;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         <span class="stringliteral">&quot;Implicit def with more than one definition&quot;</span>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// We can say that the VReg defined by Def is undef, only if it is</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// fully defined by Def. Otherwise, some of the lanes may not be</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// undef and the value of the VReg matters.</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>.getOperand(0).getSubReg();</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;}</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">/// insertSpill - Insert a spill of NewVReg after MI.</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::insertSpill(<a class="code" href="classllvm_1_1Register.html">Register</a> NewVReg, <span class="keywordtype">bool</span> isKill,</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                 <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="comment">// Spill are not terminators, so inserting spills after terminators will</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="comment">// violate invariants in MachineVerifier.</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isTerminator() &amp;&amp; <span class="stringliteral">&quot;Inserting a spill after a terminator&quot;</span>);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getParent();</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrSpan.html">MachineInstrSpan</a> MIS(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> SpillBefore = std::next(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordtype">bool</span> IsRealSpill = <a class="code" href="InlineSpiller_8cpp.html#a812047022fbf54b86f829bce5496fcbd">isRealSpill</a>(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordflow">if</span> (IsRealSpill)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a230837b86f36384876568b3bdb4fdafb">storeRegToStackSlot</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, SpillBefore, NewVReg, isKill, StackSlot,</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                            <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">getRegClass</a>(NewVReg), &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="classllvm_1_1Register.html">Register</a>());</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">// Don&#39;t spill undef value.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">// Anything works for undef, in particular keeping the memory</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">// uninitialized is a viable option and it saves code size and</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">// run time.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, SpillBefore, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::KILL))</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(NewVReg, <a class="code" href="namespacellvm.html#aac57d4100e9a9d02522fbd724568397d">getKillRegState</a>(isKill));</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> Spill = std::next(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a87b097de2261d68334195870a03412b9">InsertMachineInstrRangeInMaps</a>(Spill, MIS.end());</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(Spill, MIS.end()))</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <a class="code" href="InlineSpiller_8cpp.html#ac370c41caa198ae51b35d5b35f9b8c81">getVDefInterval</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, LIS);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <a class="code" href="InlineSpiller_8cpp.html#a3a62b5d1e83ec172369441613b538fce">dumpMachineInstrRangeWithSlotIndex</a>(Spill, MIS.end(), LIS, <span class="stringliteral">&quot;spill&quot;</span>));</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  ++NumSpills;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">// If there is only 1 store instruction is required for spill, add it</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// to mergeable list. In X86 AMX, 2 intructions are required to store.</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">// We disable the merge for this case.</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">if</span> (IsRealSpill &amp;&amp; std::distance(Spill, MIS.end()) &lt;= 1)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    HSpiller.addToMergeableSpills(*Spill, StackSlot, Original);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">/// spillAroundUses - insert spill code around each use of Reg.</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::spillAroundUses(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;spillAroundUses &quot;</span> &lt;&lt; <a class="code" href="namespacellvm.html#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OldLI = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a25c117ac45bfbbcf69dc0b674db2d1ea">getInterval</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="comment">// Iterate over instructions using Reg.</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a3985184940a3c717fb98e6d6bfbfd0d6">reg_bundles</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))) {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">// Debug values are not allowed to affect codegen.</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugValue()) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="comment">// Modify DBG_VALUE now that the value is in a spill slot.</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent();</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Modifying debug info due to spill:\t&quot;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <a class="code" href="namespacellvm.html#ac97a9a17e6fb3e143741bb48451a0959">buildDbgValueForSpill</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, StackSlot, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ad26bff839257f220557ce812b2159c72">erase</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugInstr() &amp;&amp; <span class="stringliteral">&quot;Did not expect to find a use in debug &quot;</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;           <span class="stringliteral">&quot;instruction that isn&#39;t a DBG_VALUE&quot;</span>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="comment">// Ignore copies to/from snippets. We&#39;ll delete them.</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span> (SnippetCopies.count(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// Stack slot accesses may coalesce away.</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span> (coalesceStackAccess(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// Analyze instruction.</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;MachineInstr*, unsigned&gt;</a>, 8&gt; Ops;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="structllvm_1_1VirtRegInfo.html">VirtRegInfo</a> RI = <a class="code" href="namespacellvm.html#a2f2ae9a92eaa5f689a13f21782d4838e">AnalyzeVirtRegInBundle</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, &amp;Ops);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">// Find the slot index where this instruction reads and writes OldLI.</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// This is usually the def slot, except for tied early clobbers.</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">getInstructionIndex</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *VNI = OldLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(<span class="keyword">true</span>)))</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SlotIndex.html#a0b73244049319d841fd11a238f35b5d1">SlotIndex::isSameInstr</a>(Idx, VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>))</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        Idx = VNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">// Check for a sibling copy.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SibReg = <a class="code" href="InlineSpiller_8cpp.html#a7bcb2af53f5165c69a357f244ead0ebb">isFullCopyOf</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span> (SibReg &amp;&amp; isSibling(SibReg)) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="comment">// This may actually be a copy between snippets.</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">if</span> (isRegToSpill(SibReg)) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found new snippet copy: &quot;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        SnippetCopies.insert(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="keywordflow">if</span> (RI.<a class="code" href="structllvm_1_1VirtRegInfo.html#acf7a0d275502415bb724169baf061638">Writes</a>) {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">if</span> (hoistSpillInsideBB(OldLI, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          <span class="comment">// This COPY is now dead, the value is already in the stack slot.</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;          <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).setIsDead();</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;          DeadDefs.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="comment">// This is a reload for a sib-reg copy. Drop spills downstream.</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;SibLI = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a25c117ac45bfbbcf69dc0b674db2d1ea">getInterval</a>(SibReg);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        eliminateRedundantSpills(SibLI, SibLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx));</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="comment">// The COPY will fold to a reload below.</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">// Attempt to fold memory ops.</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">if</span> (foldMemoryOperand(Ops))</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="comment">// Create a new virtual register for spill/fill.</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">// FIXME: Infer regclass from instruction alone.</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> NewVReg = Edit-&gt;createFrom(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (RI.<a class="code" href="structllvm_1_1VirtRegInfo.html#a0066fe4418e8c4c6c08dd9a9f2ee70e7">Reads</a>)</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      insertReload(NewVReg, Idx, &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// Rewrite instruction operands.</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordtype">bool</span> hasLiveDef = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;OpPair : Ops) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = OpPair.first-&gt;getOperand(OpPair.second);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      MO.<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(NewVReg);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">isUse</a>()) {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">if</span> (!OpPair.first-&gt;isRegTiedToDefOperand(OpPair.second))</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          MO.<a class="code" href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">setIsKill</a>();</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="keywordflow">if</span> (!MO.<a class="code" href="classllvm_1_1MachineOperand.html#aaee820701392c55ad54235d3d7201206">isDead</a>())</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          hasLiveDef = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\trewrite: &quot;</span> &lt;&lt; Idx &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">// FIXME: Use a second vreg if instruction has no tied ops.</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">if</span> (RI.<a class="code" href="structllvm_1_1VirtRegInfo.html#acf7a0d275502415bb724169baf061638">Writes</a>)</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">if</span> (hasLiveDef)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        insertSpill(NewVReg, <span class="keyword">true</span>, &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">/// spillAll - Spill all registers remaining after rematerialization.</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::spillAll() {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">// Update LiveStacks now that we are committed to spilling.</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordflow">if</span> (StackSlot == <a class="code" href="classllvm_1_1VirtRegMap.html#a472fd85e65eda4973c533f43b8226f20a120c86e3ef630a99345f58523740bfd3">VirtRegMap::NO_STACK_SLOT</a>) {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    StackSlot = VRM.assignVirt2StackSlot(Original);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    StackInt = &amp;LSS.getOrCreateInterval(StackSlot, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">getRegClass</a>(Original));</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    StackInt-&gt;getNextValue(<a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a>(), LSS.getVNInfoAllocator());</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    StackInt = &amp;LSS.getInterval(StackSlot);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keywordflow">if</span> (Original != Edit-&gt;getReg())</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    VRM.assignVirt2StackSlot(Edit-&gt;getReg(), StackSlot);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StackInt-&gt;getNumValNums() == 1 &amp;&amp; <span class="stringliteral">&quot;Bad stack interval values&quot;</span>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> : RegsToSpill)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    StackInt-&gt;MergeSegmentsInAsValue(LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a25c117ac45bfbbcf69dc0b674db2d1ea">getInterval</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>),</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                     StackInt-&gt;<a class="code" href="classllvm_1_1LiveRange.html#a699598a93a78f8b0376cfb49933cbce7">getValNumInfo</a>(0));</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Merged spilled regs: &quot;</span> &lt;&lt; *StackInt &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">// Spill around uses of all RegsToSpill.</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> : RegsToSpill)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    spillAroundUses(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">// Hoisted spills may cause dead code.</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordflow">if</span> (!DeadDefs.empty()) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Eliminating &quot;</span> &lt;&lt; DeadDefs.size() &lt;&lt; <span class="stringliteral">&quot; dead defs\n&quot;</span>);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    Edit-&gt;eliminateDeadDefs(DeadDefs, RegsToSpill);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="comment">// Finally delete the SnippetCopies.</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> : RegsToSpill) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> :</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a2718c79d7ff861cf3645991cef024f84">reg_instructions</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))) {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SnippetCopies.count(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &amp;&amp; <span class="stringliteral">&quot;Remaining use wasn&#39;t a snippet copy&quot;</span>);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="comment">// FIXME: Do this with a LiveRangeEdit callback.</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a73f605751be73f0a910a586bb1b5d869">RemoveMachineInstrFromMaps</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.eraseFromParent();</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">// Delete all spilled registers.</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> : RegsToSpill)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    Edit-&gt;eraseVirtReg(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;}</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="keywordtype">void</span> <a class="code" href="README-SSE_8txt.html#a7246178f42b1eaef4e9bba10a9f39323">InlineSpiller::spill</a>(<a class="code" href="classllvm_1_1LiveRangeEdit.html">LiveRangeEdit</a> &amp;edit) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  ++NumSpilledRanges;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  Edit = &amp;edit;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="classllvm_1_1Register.html#a1b164a8c57e21c6b879b8bdcc55c5f28">Register::isStackSlot</a>(edit.<a class="code" href="classllvm_1_1LiveRangeEdit.html#ac2d157d94da9ea6da55d19a1fa8d9247">getReg</a>()) &amp;&amp;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;         <span class="stringliteral">&quot;Trying to spill a stack slot.&quot;</span>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="comment">// Share a stack slot among all descendants of Original.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  Original = VRM.getOriginal(edit.<a class="code" href="classllvm_1_1LiveRangeEdit.html#ac2d157d94da9ea6da55d19a1fa8d9247">getReg</a>());</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  StackSlot = VRM.getStackSlot(Original);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  StackInt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inline spilling &quot;</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                    &lt;&lt; <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ac80ef1b0f96f5df74292346277f0005b">getRegClassName</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">getRegClass</a>(edit.<a class="code" href="classllvm_1_1LiveRangeEdit.html#ac2d157d94da9ea6da55d19a1fa8d9247">getReg</a>()))</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; edit.<a class="code" href="classllvm_1_1LiveRangeEdit.html#a74435e70950c152062a08f3d706d77ff">getParent</a>() &lt;&lt; <span class="stringliteral">&quot;\nFrom original &quot;</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                    &lt;&lt; <a class="code" href="namespacellvm.html#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(Original) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(edit.<a class="code" href="classllvm_1_1LiveRangeEdit.html#a74435e70950c152062a08f3d706d77ff">getParent</a>().<a class="code" href="classllvm_1_1LiveInterval.html#a1a07a284547e2997c90a6a1be428cd47">isSpillable</a>() &amp;&amp;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;         <span class="stringliteral">&quot;Attempting to spill already spilled value.&quot;</span>);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DeadDefs.empty() &amp;&amp; <span class="stringliteral">&quot;Previous spill didn&#39;t remove dead defs&quot;</span>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  collectRegsToSpill();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  reMaterializeAll();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">// Remat may handle everything.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordflow">if</span> (!RegsToSpill.empty())</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    spillAll();</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  Edit-&gt;calculateRegClassAndHint(MF, VRAI);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">/// Optimizations after all the reg selections and spills are done.</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> InlineSpiller::postOptimization() { HSpiller.hoistAllSpills(); }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">/// When a spill is inserted, add the spill to MergeableSpills map.</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> HoistSpillHelper::addToMergeableSpills(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;Spill, <span class="keywordtype">int</span> StackSlot,</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                            <span class="keywordtype">unsigned</span> Original) {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <a class="code" href="classllvm_1_1BumpPtrAllocatorImpl.html">BumpPtrAllocator</a> &amp;<a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a> = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a11b78aceef1db7dddc7ca575c395ddaf">getVNInfoAllocator</a>();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a25c117ac45bfbbcf69dc0b674db2d1ea">getInterval</a>(Original);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// save a copy of LiveInterval in StackSlotToOrigLI because the original</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="comment">// LiveInterval may be cleared after all its references are spilled.</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="keywordflow">if</span> (StackSlotToOrigLI.find(StackSlot) == StackSlotToOrigLI.end()) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keyword">auto</span> LI = std::make_unique&lt;LiveInterval&gt;(OrigLI.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), OrigLI.<a class="code" href="classllvm_1_1LiveInterval.html#a0fc46dffc68d1302d150b7e4c28c7983">weight</a>());</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    LI-&gt;<a class="code" href="classllvm_1_1LiveRange.html#ae7eb95d6c78b269fe03ed9c78cf2c33f">assign</a>(OrigLI, <a class="code" href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    StackSlotToOrigLI[StackSlot] = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(LI);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">getInstructionIndex</a>(Spill);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *OrigVNI = StackSlotToOrigLI[StackSlot]-&gt;getVNInfoAt(Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>());</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  std::pair&lt;int, VNInfo *&gt; MIdx = std::make_pair(StackSlot, OrigVNI);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  MergeableSpills[MIdx].insert(&amp;Spill);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;}</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">/// When a spill is removed, remove the spill from MergeableSpills map.</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">/// Return true if the spill is removed successfully.</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> HoistSpillHelper::rmFromMergeableSpills(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;Spill,</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                             <span class="keywordtype">int</span> StackSlot) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keyword">auto</span> It = StackSlotToOrigLI.find(StackSlot);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keywordflow">if</span> (It == StackSlotToOrigLI.end())</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">getInstructionIndex</a>(Spill);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *OrigVNI = It-&gt;second-&gt;getVNInfoAt(Idx.<a class="code" href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>());</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  std::pair&lt;int, VNInfo *&gt; MIdx = std::make_pair(StackSlot, OrigVNI);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordflow">return</span> MergeableSpills[MIdx].erase(&amp;Spill);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;}</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">/// Check BB to see if it is a possible target BB to place a hoisted spill,</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">/// i.e., there should be a living sibling of OrigReg at the insert point.</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> HoistSpillHelper::isSpillCandBB(<a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> &amp;OrigVNI,</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                     <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> &amp;LiveReg) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> Idx = IPA.getLastInsertPoint(OrigLI, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="comment">// The original def could be after the last insert point in the root block,</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="comment">// we can&#39;t hoist to here.</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">if</span> (Idx &lt; OrigVNI.<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>) {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="comment">// TODO: We could be better here. If LI is not alive in landing pad</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">// we could hoist spill after LIP.</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;can&#39;t spill in root block - def after LIP\n&quot;</span>);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> OrigReg = OrigLI.<a class="code" href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">reg</a>();</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;Register, 16&gt;</a> &amp;Siblings = Virt2SiblingsMap[OrigReg];</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OrigLI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx) == &amp;OrigVNI &amp;&amp; <span class="stringliteral">&quot;Unexpected VNI&quot;</span>);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> &amp;SibReg : Siblings) {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;LI = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a25c117ac45bfbbcf69dc0b674db2d1ea">getInterval</a>(SibReg);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *VNI = LI.<a class="code" href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">getVNInfoAt</a>(Idx);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">if</span> (VNI) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      LiveReg = SibReg;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;}</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">/// Remove redundant spills in the same BB. Save those redundant spills in</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">/// SpillsToRm, and save the spill to keep and its BB in SpillBBToSpill map.</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> HoistSpillHelper::rmRedundantSpills(</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a> &amp;Spills,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineInstr *&gt;</a> &amp;SpillsToRm,</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, MachineInstr *&gt;</a> &amp;SpillBBToSpill) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="comment">// For each spill saw, check SpillBBToSpill[] and see if its BB already has</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="comment">// another spill inside. If a BB contains more than one spill, only keep the</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="comment">// earlier spill with smaller SlotIndex.</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<span class="keyword">const</span> CurrentSpill : Spills) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = CurrentSpill-&gt;getParent();</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <a class="code" href="classllvm_1_1DomTreeNodeBase.html">MachineDomTreeNode</a> *Node = MDT.getBase().getNode(Block);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *PrevSpill = SpillBBToSpill[Node];</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">if</span> (PrevSpill) {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> PIdx = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">getInstructionIndex</a>(*PrevSpill);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <a class="code" href="classllvm_1_1SlotIndex.html">SlotIndex</a> CIdx = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">getInstructionIndex</a>(*CurrentSpill);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *SpillToRm = (CIdx &gt; PIdx) ? CurrentSpill : PrevSpill;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *SpillToKeep = (CIdx &gt; PIdx) ? PrevSpill : CurrentSpill;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      SpillsToRm.push_back(SpillToRm);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      SpillBBToSpill[MDT.getBase().getNode(Block)] = SpillToKeep;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      SpillBBToSpill[MDT.getBase().getNode(Block)] = CurrentSpill;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<span class="keyword">const</span> SpillToRm : SpillsToRm)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    Spills.<a class="code" href="classllvm_1_1DenseMapBase.html#a1eb8504bab5f794778d82db6ac829923">erase</a>(SpillToRm);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;}</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">/// Starting from \p Root find a top-down traversal order of the dominator</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">/// tree to visit all basic blocks containing the elements of \p Spills.</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">/// Redundant spills will be found and put into \p SpillsToRm at the same</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">/// time. \p SpillBBToSpill will be populated as part of the process and</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">/// maps a basic block to the first store occurring in the basic block.</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">/// \post SpillsToRm.union(Spills\@post) == Spills\@pre</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> HoistSpillHelper::getVisitOrders(</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *Root, <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a> &amp;Spills,</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineDomTreeNode *&gt;</a> &amp;Orders,</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineInstr *&gt;</a> &amp;SpillsToRm,</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, unsigned&gt;</a> &amp;SpillsToKeep,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, MachineInstr *&gt;</a> &amp;SpillBBToSpill) {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <span class="comment">// The set contains all the possible BB nodes to which we may hoist</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="comment">// original spills.</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineDomTreeNode *, 8&gt;</a> WorkSet;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="comment">// Save the BB nodes on the path from the first BB node containing</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="comment">// non-redundant spill to the Root node.</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineDomTreeNode *, 8&gt;</a> NodesOnPath;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="comment">// All the spills to be hoisted must originate from a single def instruction</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="comment">// to the OrigReg. It means the def instruction should dominate all the spills</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="comment">// to be hoisted. We choose the BB where the def instruction is located as</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="comment">// the Root.</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <a class="code" href="classllvm_1_1DomTreeNodeBase.html">MachineDomTreeNode</a> *RootIDomNode = MDT[Root]-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#aa22cb3ff8c95bb05185acad8c569d4b6">getIDom</a>();</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">// For every node on the dominator tree with spill, walk up on the dominator</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">// tree towards the Root node until it is reached. If there is other node</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="comment">// containing spill in the middle of the path, the previous spill saw will</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="comment">// be redundant and the node containing it will be removed. All the nodes on</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="comment">// the path starting from the first node with non-redundant spill to the Root</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="comment">// node will be added to the WorkSet, which will contain all the possible</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="comment">// locations where spills may be hoisted to after the loop below is done.</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<span class="keyword">const</span> Spill : Spills) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = Spill-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>();</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <a class="code" href="classllvm_1_1DomTreeNodeBase.html">MachineDomTreeNode</a> *Node = MDT[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>];</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *SpillToRm = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordflow">while</span> (Node != RootIDomNode) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="comment">// If Node dominates Block, and it already contains a spill, the spill in</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">// Block will be redundant.</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keywordflow">if</span> (Node != MDT[Block] &amp;&amp; SpillBBToSpill[Node]) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        SpillToRm = SpillBBToSpill[MDT[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>]];</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <span class="keywordflow">break</span>;<span class="comment"></span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">        /// If we see the Node already in WorkSet, the path from the Node to</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">        /// the Root node must already be traversed by another spill.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">        /// Then no need to repeat.</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment"></span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WorkSet.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(Node)) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        NodesOnPath.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(Node);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      Node = Node-&gt;getIDom();</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordflow">if</span> (SpillToRm) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      SpillsToRm.push_back(SpillToRm);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="comment">// Add a BB containing the original spills to SpillsToKeep -- i.e.,</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="comment">// set the initial status before hoisting start. The value of BBs</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="comment">// containing original spills is set to 0, in order to descriminate</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="comment">// with BBs containing hoisted spills which will be inserted to</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="comment">// SpillsToKeep later during hoisting.</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      SpillsToKeep[MDT[<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>]] = 0;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      WorkSet.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(NodesOnPath.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(), NodesOnPath.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a7004354fbee1c8cd74ed9001915e1db5">end</a>());</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    NodesOnPath.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="comment">// Sort the nodes in WorkSet in top-down order and save the nodes</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="comment">// in Orders. Orders will be used for hoisting in runHoistSpills.</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keywordtype">unsigned</span> idx = 0;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  Orders.push_back(MDT.getBase().getNode(Root));</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <a class="code" href="classllvm_1_1DomTreeNodeBase.html">MachineDomTreeNode</a> *Node = Orders[idx++];</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DomTreeNodeBase.html">MachineDomTreeNode</a> *Child : Node-&gt;children()) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordflow">if</span> (WorkSet.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(Child))</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        Orders.push_back(Child);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  } <span class="keywordflow">while</span> (idx != Orders.size());</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Orders.size() == WorkSet.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>() &amp;&amp;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         <span class="stringliteral">&quot;Orders have different size with WorkSet&quot;</span>);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Orders size is &quot;</span> &lt;&lt; Orders.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineDomTreeNode *, 32&gt;::reverse_iterator</a> RIt = Orders.rbegin();</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="keywordflow">for</span> (; RIt != Orders.rend(); RIt++)</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;BB&quot;</span> &lt;&lt; (*RIt)-&gt;getBlock()-&gt;getNumber() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;}</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">/// Try to hoist spills according to BB hotness. The spills to removed will</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">/// be saved in \p SpillsToRm. The spills to be inserted will be saved in</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">/// \p SpillsToIns.</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> HoistSpillHelper::runHoistSpills(</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI, <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> &amp;OrigVNI,</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a> &amp;Spills,</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineInstr *&gt;</a> &amp;SpillsToRm,</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineBasicBlock *, unsigned&gt;</a> &amp;SpillsToIns) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="comment">// Visit order of dominator tree nodes.</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineDomTreeNode *, 32&gt;</a> Orders;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="comment">// SpillsToKeep contains all the nodes where spills are to be inserted</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">// during hoisting. If the spill to be inserted is an original spill</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">// (not a hoisted one), the value of the map entry is 0. If the spill</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="comment">// is a hoisted spill, the value of the map entry is the VReg to be used</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="comment">// as the source of the spill.</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, unsigned&gt;</a> SpillsToKeep;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="comment">// Map from BB to the first spill inside of it.</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, MachineInstr *&gt;</a> SpillBBToSpill;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  rmRedundantSpills(Spills, SpillsToRm, SpillBBToSpill);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *Root = LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a5b83266ee091a07ac1702d0e8c4a1937">getMBBFromIndex</a>(OrigVNI.<a class="code" href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  getVisitOrders(Root, Spills, Orders, SpillsToRm, SpillsToKeep,</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                 SpillBBToSpill);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="comment">// SpillsInSubTreeMap keeps the map from a dom tree node to a pair of</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="comment">// nodes set and the cost of all the spills inside those nodes.</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="comment">// The nodes set are the locations where spills are to be inserted</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="comment">// in the subtree of current node.</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keyword">using</span> NodesCostPair =</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      std::pair&lt;SmallPtrSet&lt;MachineDomTreeNode *, 16&gt;, <a class="code" href="classllvm_1_1BlockFrequency.html">BlockFrequency</a>&gt;;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineDomTreeNode *, NodesCostPair&gt;</a> SpillsInSubTreeMap;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="comment">// Iterate Orders set in reverse order, which will be a bottom-up order</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="comment">// in the dominator tree. Once we visit a dom tree node, we know its</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="comment">// children have already been visited and the spill locations in the</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="comment">// subtrees of all the children have been determined.</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineDomTreeNode *, 32&gt;::reverse_iterator</a> RIt = Orders.rbegin();</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="keywordflow">for</span> (; RIt != Orders.rend(); RIt++) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = (*RIt)-&gt;getBlock();</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">// If Block contains an original spill, simply continue.</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">if</span> (SpillsToKeep.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(*RIt) != SpillsToKeep.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp; !SpillsToKeep[*RIt]) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      SpillsInSubTreeMap[*RIt].first.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(*RIt);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="comment">// SpillsInSubTreeMap[*RIt].second contains the cost of spill.</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      SpillsInSubTreeMap[*RIt].second = MBFI.getBlockFreq(Block);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// Collect spills in subtree of current node (*RIt) to</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// SpillsInSubTreeMap[*RIt].first.</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DomTreeNodeBase.html">MachineDomTreeNode</a> *Child : (*RIt)-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#ad809413059b01b7a8eee4de0816e8b46">children</a>()) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordflow">if</span> (SpillsInSubTreeMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Child) == SpillsInSubTreeMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="comment">// The stmt &quot;SpillsInSubTree = SpillsInSubTreeMap[*RIt].first&quot; below</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="comment">// should be placed before getting the begin and end iterators of</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="comment">// SpillsInSubTreeMap[Child].first, or else the iterators may be</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="comment">// invalidated when SpillsInSubTreeMap[*RIt] is seen the first time</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="comment">// and the map grows and then the original buckets in the map are moved.</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineDomTreeNode *, 16&gt;</a> &amp;SpillsInSubTree =</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          SpillsInSubTreeMap[*RIt].first;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      <a class="code" href="classllvm_1_1BlockFrequency.html">BlockFrequency</a> &amp;SubTreeCost = SpillsInSubTreeMap[*RIt].second;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      SubTreeCost += SpillsInSubTreeMap[Child].second;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keyword">auto</span> BI = SpillsInSubTreeMap[Child].first.<a class="code" href="classllvm_1_1DenseMapBase.html#a50d461a887e200e704e5157d3b21514d">begin</a>();</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      <span class="keyword">auto</span> EI = SpillsInSubTreeMap[Child].first.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>();</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      SpillsInSubTree.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(BI, EI);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      SpillsInSubTreeMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a1eb8504bab5f794778d82db6ac829923">erase</a>(Child);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; </div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineDomTreeNode *, 16&gt;</a> &amp;SpillsInSubTree =</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          SpillsInSubTreeMap[*RIt].first;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="classllvm_1_1BlockFrequency.html">BlockFrequency</a> &amp;SubTreeCost = SpillsInSubTreeMap[*RIt].second;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">// No spills in subtree, simply continue.</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordflow">if</span> (SpillsInSubTree.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">empty</a>())</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// Check whether Block is a possible candidate to insert spill.</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> LiveReg;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">if</span> (!isSpillCandBB(OrigLI, OrigVNI, *Block, LiveReg))</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="comment">// If there are multiple spills that could be merged, bias a little</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">// to hoist the spill.</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a> MarginProb = (SpillsInSubTree.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>() &gt; 1)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                                       ? <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a>(9, 10)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                                       : <a class="code" href="classllvm_1_1BranchProbability.html">BranchProbability</a>(1, 1);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keywordflow">if</span> (SubTreeCost &gt; MBFI.getBlockFreq(Block) * MarginProb) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="comment">// Hoist: Move spills to current Block.</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<span class="keyword">const</span> SpillBB : SpillsInSubTree) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="comment">// When SpillBB is a BB contains original spill, insert the spill</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="comment">// to SpillsToRm.</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <span class="keywordflow">if</span> (SpillsToKeep.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(SpillBB) != SpillsToKeep.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            !SpillsToKeep[SpillBB]) {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;          <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *SpillToRm = SpillBBToSpill[SpillBB];</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;          SpillsToRm.push_back(SpillToRm);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="comment">// SpillBB will not contain spill anymore, remove it from SpillsToKeep.</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        SpillsToKeep.<a class="code" href="classllvm_1_1DenseMapBase.html#a1eb8504bab5f794778d82db6ac829923">erase</a>(SpillBB);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <span class="comment">// Current Block is the BB containing the new hoisted spill. Add it to</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="comment">// SpillsToKeep. LiveReg is the source of the new spill.</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      SpillsToKeep[*RIt] = LiveReg;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;spills in BB: &quot;</span>;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> Rspill : SpillsInSubTree)</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; Rspill-&gt;getBlock()-&gt;getNumber() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;were promoted to BB&quot;</span> &lt;&lt; (*RIt)-&gt;getBlock()-&gt;getNumber()</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      });</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      SpillsInSubTree.clear();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      SpillsInSubTree.insert(*RIt);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      SubTreeCost = MBFI.getBlockFreq(Block);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="comment">// For spills in SpillsToKeep with LiveReg set (i.e., not original spill),</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="comment">// save them to SpillsToIns.</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Ent : SpillsToKeep) {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">if</span> (Ent.second)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      SpillsToIns[Ent.first-&gt;getBlock()] = Ent.second;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;}</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">/// For spills with equal values, remove redundant spills and hoist those left</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">/// to less hot spots.</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">/// Spills with equal values will be collected into the same set in</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">/// MergeableSpills when spill is inserted. These equal spills are originated</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">/// from the same defining instruction and are dominated by the instruction.</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">/// Before hoisting all the equal spills, redundant spills inside in the same</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">/// BB are first marked to be deleted. Then starting from the spills left, walk</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">/// up on the dominator tree towards the Root node where the define instruction</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">/// is located, mark the dominated spills to be deleted along the way and</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">/// collect the BB nodes on the path from non-dominated spills to the define</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">/// instruction into a WorkSet. The nodes in WorkSet are the candidate places</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">/// where we are considering to hoist the spills. We iterate the WorkSet in</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">/// bottom-up order, and for each node, we will decide whether to hoist spills</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">/// inside its subtree to that node. In this way, we can get benefit locally</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">/// even if hoisting all the equal spills to one cold place is impossible.</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> HoistSpillHelper::hoistAllSpills() {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Register, 4&gt;</a> NewVRegs;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <a class="code" href="classllvm_1_1LiveRangeEdit.html">LiveRangeEdit</a> Edit(<span class="keyword">nullptr</span>, NewVRegs, MF, LIS, &amp;VRM, <span class="keyword">this</span>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#ae73582bbbc71758dcac70cd8c56210e4">getNumVirtRegs</a>(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = <a class="code" href="classllvm_1_1Register.html#a1979c563289f871907832e419889f979">Register::index2VirtReg</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Original = VRM.getPreSplitReg(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5f95077d52fb7c8cd08ce6338b107bcf">def_empty</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      Virt2SiblingsMap[Original].insert(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">// Each entry in MergeableSpills contains a spill set with equal values.</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Ent : MergeableSpills) {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1pdb.html#a5dbb1abfb6d3c14555304f9c56703234a9234cc57c43f272b55a94b0069fe62d1">Slot</a> = Ent.first.first;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;OrigLI = *StackSlotToOrigLI[<a class="code" href="namespacellvm_1_1pdb.html#a5dbb1abfb6d3c14555304f9c56703234a9234cc57c43f272b55a94b0069fe62d1">Slot</a>];</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <a class="code" href="classllvm_1_1VNInfo.html">VNInfo</a> *OrigVNI = Ent.first.second;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;MachineInstr *, 16&gt;</a> &amp;EqValSpills = Ent.second;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordflow">if</span> (Ent.second.empty())</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nFor Slot&quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1pdb.html#a5dbb1abfb6d3c14555304f9c56703234a9234cc57c43f272b55a94b0069fe62d1">Slot</a> &lt;&lt; <span class="stringliteral">&quot; and VN&quot;</span> &lt;&lt; OrigVNI-&gt;<a class="code" href="classllvm_1_1VNInfo.html#ad989a0c1b26066308798f4d11a0e69df">id</a> &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Equal spills in BB: &quot;</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="README-SSE_8txt.html#a7246178f42b1eaef4e9bba10a9f39323">spill</a> : EqValSpills)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="README-SSE_8txt.html#a7246178f42b1eaef4e9bba10a9f39323">spill</a>-&gt;getParent()-&gt;getNumber() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    });</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="comment">// SpillsToRm is the spill set to be removed from EqValSpills.</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineInstr *, 16&gt;</a> SpillsToRm;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="comment">// SpillsToIns is the spill set to be newly inserted after hoisting.</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;MachineBasicBlock *, unsigned&gt;</a> SpillsToIns;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    runHoistSpills(OrigLI, *OrigVNI, EqValSpills, SpillsToRm, SpillsToIns);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Finally inserted spills in BB: &quot;</span>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Ispill : SpillsToIns)</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; Ispill.first-&gt;getNumber() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nFinally removed spills in BB: &quot;</span>;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> Rspill : SpillsToRm)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; Rspill-&gt;getParent()-&gt;getNumber() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    });</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">// Stack live range update.</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <a class="code" href="classllvm_1_1LiveInterval.html">LiveInterval</a> &amp;StackIntvl = LSS.getInterval(Slot);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordflow">if</span> (!SpillsToIns.empty() || !SpillsToRm.empty())</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      StackIntvl.<a class="code" href="classllvm_1_1LiveRange.html#a325a4ec9c33a3dead9ff01c9e70fd534">MergeValueInAsValue</a>(OrigLI, OrigVNI,</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                     StackIntvl.getValNumInfo(0));</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">// Insert hoisted spills.</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;Insert : SpillsToIns) {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="README__P9_8txt.html#aa793083a95c48c23abfa352d4335685a">Insert</a>.first;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> LiveReg = <a class="code" href="README__P9_8txt.html#aa793083a95c48c23abfa352d4335685a">Insert</a>.second;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> MII = IPA.getLastInsertPointIter(OrigLI, *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <a class="code" href="classllvm_1_1MachineInstrSpan.html">MachineInstrSpan</a> MIS(MII, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.<a class="code" href="classllvm_1_1HexagonInstrInfo.html#a230837b86f36384876568b3bdb4fdafb">storeRegToStackSlot</a>(*<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, MII, LiveReg, <span class="keyword">false</span>, Slot,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                              <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">getRegClass</a>(LiveReg), &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="classllvm_1_1Register.html">Register</a>());</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      LIS.<a class="code" href="classllvm_1_1LiveIntervals.html#a87b097de2261d68334195870a03412b9">InsertMachineInstrRangeInMaps</a>(MIS.begin(), MII);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(MIS.begin(), MII))</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <a class="code" href="InlineSpiller_8cpp.html#ac370c41caa198ae51b35d5b35f9b8c81">getVDefInterval</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, LIS);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      ++NumSpills;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// Remove redundant spills or change them to dead instructions.</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    NumSpills -= SpillsToRm.size();</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<span class="keyword">const</span> RMEnt : SpillsToRm) {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      RMEnt-&gt;setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::KILL));</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = RMEnt-&gt;getNumOperands(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>; --<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO = RMEnt-&gt;getOperand(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordflow">if</span> (MO.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#a3bf161859e1ad7fd3da485d3cb688d34">isImplicit</a>() &amp;&amp; MO.<a class="code" href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">isDef</a>() &amp;&amp; !MO.<a class="code" href="classllvm_1_1MachineOperand.html#aaee820701392c55ad54235d3d7201206">isDead</a>())</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;          RMEnt-&gt;removeOperand(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    Edit.eliminateDeadDefs(SpillsToRm, std::nullopt);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">/// For VirtReg clone, the \p New register should have the same physreg or</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">/// stackslot as the \p old register.</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> HoistSpillHelper::LRE_DidCloneVirtReg(<a class="code" href="classllvm_1_1Register.html">Register</a> New, <a class="code" href="classllvm_1_1Register.html">Register</a> Old) {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="keywordflow">if</span> (VRM.hasPhys(Old))</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    VRM.assignVirt2Phys(New, VRM.getPhys(Old));</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VRM.getStackSlot(Old) != <a class="code" href="classllvm_1_1VirtRegMap.html#a472fd85e65eda4973c533f43b8226f20a120c86e3ef630a99345f58523740bfd3">VirtRegMap::NO_STACK_SLOT</a>)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    VRM.assignVirt2StackSlot(New, VRM.getStackSlot(Old));</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;VReg should be assigned either physreg or stackslot&quot;</span>);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordflow">if</span> (VRM.hasShape(Old))</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    VRM.assignVirt2Shape(New, VRM.getShape(Old));</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1Spiller_html"><div class="ttname"><a href="classllvm_1_1Spiller.html">llvm::Spiller</a></div><div class="ttdoc">Spiller interface.</div><div class="ttdef"><b>Definition:</b> <a href="Spiller_8h_source.html#l00024">Spiller.h:24</a></div></div>
<div class="ttc" id="astructllvm_1_1LiveRangeEdit_1_1Remat_html"><div class="ttname"><a href="structllvm_1_1LiveRangeEdit_1_1Remat.html">llvm::LiveRangeEdit::Remat</a></div><div class="ttdoc">Remat - Information needed to rematerialize at a specific location.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRangeEdit_8h_source.html#l00189">LiveRangeEdit.h:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1HexagonInstrInfo_html_a92680e141738540aefb738d4e907701d"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#a92680e141738540aefb738d4e907701d">llvm::HexagonInstrInfo::isStoreToStackSlot</a></div><div class="ttdeci">unsigned isStoreToStackSlot(const MachineInstr &amp;MI, int &amp;FrameIndex) const override</div><div class="ttdoc">If the specified machine instruction is a direct store to a stack slot, return the virtual or physica...</div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l00336">HexagonInstrInfo.cpp:336</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_ad26a74fb0ad868f0867cce317269d721"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ad26a74fb0ad868f0867cce317269d721">llvm::MachineInstr::getDebugInstrNum</a></div><div class="ttdeci">unsigned getDebugInstrNum()</div><div class="ttdoc">Fetch the instruction number of this MachineInstr.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l02370">MachineInstr.cpp:2370</a></div></div>
<div class="ttc" id="aIRTranslator_8cpp_html_abe44dfdea65b4f7e11e0a608ab708b76"><div class="ttname"><a href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div><div class="ttdeci">IRTranslator LLVM IR MI</div><div class="ttdef"><b>Definition:</b> <a href="IRTranslator_8cpp_source.html#l00109">IRTranslator.cpp:109</a></div></div>
<div class="ttc" id="aMachineInstr_8h_html"><div class="ttname"><a href="MachineInstr_8h.html">MachineInstr.h</a></div></div>
<div class="ttc" id="aCompiler_8h_html_aa863693eef567397d9c292da5bf22d34"><div class="ttname"><a href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a></div><div class="ttdeci">#define LLVM_DUMP_METHOD</div><div class="ttdoc">Mark debug helper function definitions like dump() that should not be stripped from debug builds.</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00492">Compiler.h:492</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">llvm::tgtok::Def</a></div><div class="ttdeci">@ Def</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00050">TGLexer.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110aa31dda85603496c333a105d53ce62150"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110aa31dda85603496c333a105d53ce62150">llvm::ISD::PATCHPOINT</a></div><div class="ttdeci">@ PATCHPOINT</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l01303">ISDOpcodes.h:1303</a></div></div>
<div class="ttc" id="aAArch64ExpandPseudoInsts_8cpp_html_a6cf2f8996b1e9aaf2d7a435aaa62382f"><div class="ttname"><a href="AArch64ExpandPseudoInsts_8cpp.html#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a></div><div class="ttdeci">MachineInstrBuilder &amp; UseMI</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ExpandPseudoInsts_8cpp_source.html#l00107">AArch64ExpandPseudoInsts.cpp:107</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="aREADME__P9_8txt_html_aa793083a95c48c23abfa352d4335685a"><div class="ttname"><a href="README__P9_8txt.html#aa793083a95c48c23abfa352d4335685a">Insert</a></div><div class="ttdeci">Vector Rotate Left Mask Mask Insert</div><div class="ttdef"><b>Definition:</b> <a href="README__P9_8txt_source.html#l00112">README_P9.txt:112</a></div></div>
<div class="ttc" id="astructllvm_1_1VirtRegInfo_html_a5a3349f5396be814b455f5f3a01f4efe"><div class="ttname"><a href="structllvm_1_1VirtRegInfo.html#a5a3349f5396be814b455f5f3a01f4efe">llvm::VirtRegInfo::Tied</a></div><div class="ttdeci">bool Tied</div><div class="ttdoc">Tied - Uses and defs must use the same register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8h_source.html#l00229">MachineInstrBundle.h:229</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html">llvm::MachineRegisterInfo</a></div><div class="ttdoc">MachineRegisterInfo - Keep track of information for virtual and physical registers,...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00051">MachineRegisterInfo.h:51</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrSpan_html"><div class="ttname"><a href="classllvm_1_1MachineInstrSpan.html">llvm::MachineInstrSpan</a></div><div class="ttdoc">MachineInstrSpan provides an interface to get an iteration range containing the instruction it was in...</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01274">MachineBasicBlock.h:1274</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aHexagonHardwareLoops_8cpp_html_ada7c1594a393ede3ce32602d64d7ddb2"><div class="ttname"><a href="HexagonHardwareLoops_8cpp.html#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a></div><div class="ttdeci">Hexagon Hardware Loops</div><div class="ttdef"><b>Definition:</b> <a href="HexagonHardwareLoops_8cpp_source.html#l00374">HexagonHardwareLoops.cpp:374</a></div></div>
<div class="ttc" id="astructllvm_1_1VirtRegInfo_html_a0066fe4418e8c4c6c08dd9a9f2ee70e7"><div class="ttname"><a href="structllvm_1_1VirtRegInfo.html#a0066fe4418e8c4c6c08dd9a9f2ee70e7">llvm::VirtRegInfo::Reads</a></div><div class="ttdeci">bool Reads</div><div class="ttdoc">Reads - One of the operands read the virtual register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8h_source.html#l00221">MachineInstrBundle.h:221</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a8a82683fccdef8a5ef772ef03277aee7"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">llvm::MachineOperand::setIsKill</a></div><div class="ttdeci">void setIsKill(bool Val=true)</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00519">MachineOperand.h:519</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveInterval_html_a1a07a284547e2997c90a6a1be428cd47"><div class="ttname"><a href="classllvm_1_1LiveInterval.html#a1a07a284547e2997c90a6a1be428cd47">llvm::LiveInterval::isSpillable</a></div><div class="ttdeci">bool isSpillable() const</div><div class="ttdoc">isSpillable - Can this interval be spilled?</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00819">LiveInterval.h:819</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1VirtRegAuxInfo_html"><div class="ttname"><a href="classllvm_1_1VirtRegAuxInfo.html">llvm::VirtRegAuxInfo</a></div><div class="ttdoc">Calculate auxiliary information for a virtual register such as its spill weight and allocation hint.</div><div class="ttdef"><b>Definition:</b> <a href="CalcSpillWeights_8h_source.html#l00045">CalcSpillWeights.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveInterval_html_a0fc46dffc68d1302d150b7e4c28c7983"><div class="ttname"><a href="classllvm_1_1LiveInterval.html#a0fc46dffc68d1302d150b7e4c28c7983">llvm::LiveInterval::weight</a></div><div class="ttdeci">float weight() const</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00718">LiveInterval.h:718</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html"><div class="ttname"><a href="Support_2ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1VirtRegMap_html"><div class="ttname"><a href="classllvm_1_1VirtRegMap.html">llvm::VirtRegMap</a></div><div class="ttdef"><b>Definition:</b> <a href="VirtRegMap_8h_source.html#l00033">VirtRegMap.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a894030fbf6d0f6c70991f05fff650930"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a894030fbf6d0f6c70991f05fff650930">llvm::MachineOperand::isTied</a></div><div class="ttdeci">bool isTied() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00450">MachineOperand.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86Disassembler_html_a1e59b79e1d09149912cad9c0ef2809ad"><div class="ttname"><a href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">llvm::X86Disassembler::Reg</a></div><div class="ttdeci">Reg</div><div class="ttdoc">All possible values of the reg field in the ModR/M byte.</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00462">X86DisassemblerDecoder.h:462</a></div></div>
<div class="ttc" id="aMapVector_8h_html"><div class="ttname"><a href="MapVector_8h.html">MapVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_1_1defusechain__instr__iterator_html"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo_1_1defusechain__instr__iterator.html">llvm::MachineRegisterInfo::defusechain_instr_iterator</a></div><div class="ttdoc">defusechain_iterator - This class provides iterator support for machine operands in the function that...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00291">MachineRegisterInfo.h:291</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunctionPass_html"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html">llvm::MachineFunctionPass</a></div><div class="ttdoc">MachineFunctionPass - This class adapts the FunctionPass interface to allow convenient creation of pa...</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8h_source.html#l00030">MachineFunctionPass.h:30</a></div></div>
<div class="ttc" id="aMachineBasicBlock_8h_html"><div class="ttname"><a href="MachineBasicBlock_8h.html">MachineBasicBlock.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1VNInfo_html_ae623a0f1ab59da851f2ebf1674d1fddb"><div class="ttname"><a href="classllvm_1_1VNInfo.html#ae623a0f1ab59da851f2ebf1674d1fddb">llvm::VNInfo::def</a></div><div class="ttdeci">SlotIndex def</div><div class="ttdoc">The index of the defining instruction.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00061">LiveInterval.h:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a1eb8504bab5f794778d82db6ac829923"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a1eb8504bab5f794778d82db6ac829923">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::erase</a></div><div class="ttdeci">bool erase(const KeyT &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00302">DenseMap.h:302</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a7e0683c1bfad27f51e8d6c3a8cbdbfdc"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a7e0683c1bfad27f51e8d6c3a8cbdbfdc">llvm::MachineRegisterInfo::use_nodbg_instructions</a></div><div class="ttdeci">iterator_range&lt; use_instr_nodbg_iterator &gt; use_nodbg_instructions(Register Reg) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00565">MachineRegisterInfo.h:565</a></div></div>
<div class="ttc" id="aclassllvm_1_1InsertPointAnalysis_html"><div class="ttname"><a href="classllvm_1_1InsertPointAnalysis.html">llvm::InsertPointAnalysis</a></div><div class="ttdoc">Determines the latest safe point in a block in which we can insert a split, spill or other instructio...</div><div class="ttdef"><b>Definition:</b> <a href="SplitKit_8h_source.html#l00050">SplitKit.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html">llvm::TargetRegisterInfo</a></div><div class="ttdoc">TargetRegisterInfo base class - We assume that the target defines a static array of TargetRegisterDes...</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00236">TargetRegisterInfo.h:236</a></div></div>
<div class="ttc" id="astructllvm_1_1PhysRegInfo_html_afd963decf92bbfc81110071b5a39e9f4"><div class="ttname"><a href="structllvm_1_1PhysRegInfo.html#afd963decf92bbfc81110071b5a39e9f4">llvm::PhysRegInfo::FullyDefined</a></div><div class="ttdeci">bool FullyDefined</div><div class="ttdoc">Reg or a super-register is defined.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8h_source.html#l00256">MachineInstrBundle.h:256</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a50d461a887e200e704e5157d3b21514d"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a50d461a887e200e704e5157d3b21514d">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00075">DenseMap.h:75</a></div></div>
<div class="ttc" id="aBlockFrequency_8h_html"><div class="ttname"><a href="BlockFrequency_8h.html">BlockFrequency.h</a></div></div>
<div class="ttc" id="aSpiller_8h_html"><div class="ttname"><a href="Spiller_8h.html">Spiller.h</a></div></div>
<div class="ttc" id="aDenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="aTargetInstrInfo_8h_html"><div class="ttname"><a href="TargetInstrInfo_8h.html">TargetInstrInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MapVector_html"><div class="ttname"><a href="classllvm_1_1MapVector.html">llvm::MapVector</a></div><div class="ttdoc">This class implements a map that also provides access to all stored values in a deterministic order.</div><div class="ttdef"><b>Definition:</b> <a href="MapVector_8h_source.html#l00037">MapVector.h:37</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_ae73582bbbc71758dcac70cd8c56210e4"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#ae73582bbbc71758dcac70cd8c56210e4">llvm::MachineRegisterInfo::getNumVirtRegs</a></div><div class="ttdeci">unsigned getNumVirtRegs() const</div><div class="ttdoc">getNumVirtRegs - Return the number of virtual registers created.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00784">MachineRegisterInfo.h:784</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="aclassllvm_1_1Register_html_a1979c563289f871907832e419889f979"><div class="ttname"><a href="classllvm_1_1Register.html#a1979c563289f871907832e419889f979">llvm::Register::index2VirtReg</a></div><div class="ttdeci">static Register index2VirtReg(unsigned Index)</div><div class="ttdoc">Convert a 0-based index to a virtual register number.</div><div class="ttdef"><b>Definition:</b> <a href="Register_8h_source.html#l00084">Register.h:84</a></div></div>
<div class="ttc" id="aSTLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRangeEdit_html_ac2d157d94da9ea6da55d19a1fa8d9247"><div class="ttname"><a href="classllvm_1_1LiveRangeEdit.html#ac2d157d94da9ea6da55d19a1fa8d9247">llvm::LiveRangeEdit::getReg</a></div><div class="ttdeci">Register getReg() const</div><div class="ttdef"><b>Definition:</b> <a href="LiveRangeEdit_8h_source.html#l00146">LiveRangeEdit.h:146</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html_aa22cb3ff8c95bb05185acad8c569d4b6"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html#aa22cb3ff8c95bb05185acad8c569d4b6">llvm::DomTreeNodeBase::getIDom</a></div><div class="ttdeci">DomTreeNodeBase * getIDom() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00090">GenericDomTree.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveQueryResult_html"><div class="ttname"><a href="classllvm_1_1LiveQueryResult.html">llvm::LiveQueryResult</a></div><div class="ttdoc">Result of a LiveRange query.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00090">LiveInterval.h:90</a></div></div>
<div class="ttc" id="aMachineSink_8cpp_html_a0f36ed1bc17fc1aa97fe291c439a0698"><div class="ttname"><a href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a></div><div class="ttdeci">unsigned const TargetRegisterInfo * TRI</div><div class="ttdef"><b>Definition:</b> <a href="MachineSink_8cpp_source.html#l01628">MachineSink.cpp:1628</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_ae7eb95d6c78b269fe03ed9c78cf2c33f"><div class="ttname"><a href="classllvm_1_1LiveRange.html#ae7eb95d6c78b269fe03ed9c78cf2c33f">llvm::LiveRange::assign</a></div><div class="ttdeci">void assign(const LiveRange &amp;Other, BumpPtrAllocator &amp;Allocator)</div><div class="ttdoc">Copies values numbers and live segments from Other into this range.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00252">LiveInterval.h:252</a></div></div>
<div class="ttc" id="anamespacellvm_html_a34ace715436fcbc42e83e196957b9f16"><div class="ttname"><a href="namespacellvm.html#a34ace715436fcbc42e83e196957b9f16">llvm::AnalyzePhysRegInBundle</a></div><div class="ttdeci">PhysRegInfo AnalyzePhysRegInBundle(const MachineInstr &amp;MI, Register Reg, const TargetRegisterInfo *TRI)</div><div class="ttdoc">AnalyzePhysRegInBundle - Analyze how the current instruction or bundle uses a physical register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8cpp_source.html#l00313">MachineInstrBundle.cpp:313</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_a5b83266ee091a07ac1702d0e8c4a1937"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#a5b83266ee091a07ac1702d0e8c4a1937">llvm::LiveIntervals::getMBBFromIndex</a></div><div class="ttdeci">MachineBasicBlock * getMBBFromIndex(SlotIndex index) const</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00249">LiveIntervals.h:249</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_a6f3043b29023d270fc4bc5062dff7cee"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#a6f3043b29023d270fc4bc5062dff7cee">llvm::LiveIntervals::getInstructionIndex</a></div><div class="ttdeci">SlotIndex getInstructionIndex(const MachineInstr &amp;Instr) const</div><div class="ttdoc">Returns the base index of the given instruction.</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00220">LiveIntervals.h:220</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineLoopInfo_html"><div class="ttname"><a href="classllvm_1_1MachineLoopInfo.html">llvm::MachineLoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineLoopInfo_8h_source.html#l00089">MachineLoopInfo.h:89</a></div></div>
<div class="ttc" id="aMachineRegisterInfo_8h_html"><div class="ttname"><a href="MachineRegisterInfo_8h.html">MachineRegisterInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_ad26bff839257f220557ce812b2159c72"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ad26bff839257f220557ce812b2159c72">llvm::MachineBasicBlock::erase</a></div><div class="ttdeci">instr_iterator erase(instr_iterator I)</div><div class="ttdoc">Remove an instruction from the instruction list and delete it.</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l01323">MachineBasicBlock.cpp:1323</a></div></div>
<div class="ttc" id="aAliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a56612ec3760d5308cf17fd1a2b9add93"><div class="ttname"><a href="namespacellvm.html#a56612ec3760d5308cf17fd1a2b9add93">llvm::createInlineSpiller</a></div><div class="ttdeci">Spiller * createInlineSpiller(MachineFunctionPass &amp;Pass, MachineFunction &amp;MF, VirtRegMap &amp;VRM, VirtRegAuxInfo &amp;VRAI)</div><div class="ttdoc">Create and return a spiller that will insert spill code directly instead of deferring though VirtRegM...</div><div class="ttdef"><b>Definition:</b> <a href="InlineSpiller_8cpp_source.html#l00240">InlineSpiller.cpp:240</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a3bf161859e1ad7fd3da485d3cb688d34"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a3bf161859e1ad7fd3da485d3cb688d34">llvm::MachineOperand::isImplicit</a></div><div class="ttdeci">bool isImplicit() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00389">MachineOperand.h:389</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetInstrInfo_html"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html">llvm::TargetInstrInfo</a></div><div class="ttdoc">TargetInstrInfo - Interface to description of machine instruction set.</div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00098">TargetInstrInfo.h:98</a></div></div>
<div class="ttc" id="aMachineLoopInfo_8h_html"><div class="ttname"><a href="MachineLoopInfo_8h.html">MachineLoopInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBlockFrequencyInfo_html"><div class="ttname"><a href="classllvm_1_1MachineBlockFrequencyInfo.html">llvm::MachineBlockFrequencyInfo</a></div><div class="ttdoc">MachineBlockFrequencyInfo pass uses BlockFrequencyInfoImpl implementation to estimate machine basic b...</div><div class="ttdef"><b>Definition:</b> <a href="MachineBlockFrequencyInfo_8h_source.html#l00033">MachineBlockFrequencyInfo.h:33</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1Register_html_a1b164a8c57e21c6b879b8bdcc55c5f28"><div class="ttname"><a href="classllvm_1_1Register.html#a1b164a8c57e21c6b879b8bdcc55c5f28">llvm::Register::isStackSlot</a></div><div class="ttdeci">static bool isStackSlot(unsigned Reg)</div><div class="ttdoc">isStackSlot - Sometimes it is useful the be able to store a non-negative frame index in a variable th...</div><div class="ttdef"><b>Definition:</b> <a href="Register_8h_source.html#l00044">Register.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a69544ec8658eadeed98245dc37c3a541"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">llvm::MachineOperand::isUse</a></div><div class="ttdeci">bool isUse() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00379">MachineOperand.h:379</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a3f7a45f6e10668a5f702e26bca80d18e"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">llvm::MachineInstr::getOperand</a></div><div class="ttdeci">const MachineOperand &amp; getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00526">MachineInstr.h:526</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac97a9a17e6fb3e143741bb48451a0959"><div class="ttname"><a href="namespacellvm.html#ac97a9a17e6fb3e143741bb48451a0959">llvm::buildDbgValueForSpill</a></div><div class="ttdeci">MachineInstr * buildDbgValueForSpill(MachineBasicBlock &amp;BB, MachineBasicBlock::iterator I, const MachineInstr &amp;Orig, int FrameIndex, Register SpillReg)</div><div class="ttdoc">Clone a DBG_VALUE whose value has been spilled to FrameIndex.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l02224">MachineInstr.cpp:2224</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a53ca7cff9e929ba372da9780fdd44b02"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a53ca7cff9e929ba372da9780fdd44b02">llvm::MachineRegisterInfo::isReserved</a></div><div class="ttdeci">bool isReserved(MCRegister PhysReg) const</div><div class="ttdoc">isReserved - Returns true when PhysReg is a reserved register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00956">MachineRegisterInfo.h:956</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_a2035620c14bf7bdedfa4e2655f88d114"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#a2035620c14bf7bdedfa4e2655f88d114">llvm::LiveIntervals::InsertMachineInstrInMaps</a></div><div class="ttdeci">SlotIndex InsertMachineInstrInMaps(MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00260">LiveIntervals.h:260</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html_ad809413059b01b7a8eee4de0816e8b46"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html#ad809413059b01b7a8eee4de0816e8b46">llvm::DomTreeNodeBase::children</a></div><div class="ttdeci">iterator_range&lt; iterator &gt; children()</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00084">GenericDomTree.h:84</a></div></div>
<div class="ttc" id="aSplitKit_8h_html"><div class="ttname"><a href="SplitKit_8h.html">SplitKit.h</a></div></div>
<div class="ttc" id="aTargetOpcodes_8h_html"><div class="ttname"><a href="TargetOpcodes_8h.html">TargetOpcodes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a29a1144eb9d753b6b682a933aa3f8f9f"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a29a1144eb9d753b6b682a933aa3f8f9f">llvm::MachineRegisterInfo::reg_instr_nodbg_end</a></div><div class="ttdeci">static reg_instr_nodbg_iterator reg_instr_nodbg_end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00371">MachineRegisterInfo.h:371</a></div></div>
<div class="ttc" id="aHexagonCopyToCombine_8cpp_html_a1d40004718218dbdf06b496766299101"><div class="ttname"><a href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a></div><div class="ttdeci">const HexagonInstrInfo * TII</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCopyToCombine_8cpp_source.html#l00125">HexagonCopyToCombine.cpp:125</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html"><div class="ttname"><a href="classllvm_1_1MachineOperand.html">llvm::MachineOperand</a></div><div class="ttdoc">MachineOperand class - Representation of each machine instruction operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00048">MachineOperand.h:48</a></div></div>
<div class="ttc" id="aModuloSchedule_8cpp_html_a27488fd62a85fc5ec4fd4247f8ec22aa"><div class="ttname"><a href="ModuloSchedule_8cpp.html#a27488fd62a85fc5ec4fd4247f8ec22aa">pass</a></div><div class="ttdeci">modulo schedule Modulo Schedule test pass</div><div class="ttdef"><b>Definition:</b> <a href="ModuloSchedule_8cpp_source.html#l02144">ModuloSchedule.cpp:2144</a></div></div>
<div class="ttc" id="astructllvm_1_1VirtRegInfo_html_acf7a0d275502415bb724169baf061638"><div class="ttname"><a href="structllvm_1_1VirtRegInfo.html#acf7a0d275502415bb724169baf061638">llvm::VirtRegInfo::Writes</a></div><div class="ttdeci">bool Writes</div><div class="ttdoc">Writes - One of the operands writes the virtual register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8h_source.html#l00224">MachineInstrBundle.h:224</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a2718c79d7ff861cf3645991cef024f84"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a2718c79d7ff861cf3645991cef024f84">llvm::MachineRegisterInfo::reg_instructions</a></div><div class="ttdeci">iterator_range&lt; reg_instr_iterator &gt; reg_instructions(Register Reg) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00324">MachineRegisterInfo.h:324</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRangeEdit_html"><div class="ttname"><a href="classllvm_1_1LiveRangeEdit.html">llvm::LiveRangeEdit</a></div><div class="ttdef"><b>Definition:</b> <a href="LiveRangeEdit_8h_source.html#l00042">LiveRangeEdit.h:42</a></div></div>
<div class="ttc" id="aMachineInstrBundle_8h_html"><div class="ttname"><a href="MachineInstrBundle_8h.html">MachineInstrBundle.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1MIBundleOperands_html"><div class="ttname"><a href="classllvm_1_1MIBundleOperands.html">llvm::MIBundleOperands</a></div><div class="ttdoc">MIBundleOperands - Iterate over all operands in a bundle of machine instructions.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8h_source.html#l00166">MachineInstrBundle.h:166</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveInterval_html"><div class="ttname"><a href="classllvm_1_1LiveInterval.html">llvm::LiveInterval</a></div><div class="ttdoc">LiveInterval - This class represents the liveness of a register, or stack slot.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00686">LiveInterval.h:686</a></div></div>
<div class="ttc" id="aInlineSpiller_8cpp_html_a7bcb2af53f5165c69a357f244ead0ebb"><div class="ttname"><a href="InlineSpiller_8cpp.html#a7bcb2af53f5165c69a357f244ead0ebb">isFullCopyOf</a></div><div class="ttdeci">static Register isFullCopyOf(const MachineInstr &amp;MI, Register Reg)</div><div class="ttdoc">isFullCopyOf - If MI is a COPY to or from Reg, return the other register, otherwise return 0.</div><div class="ttdef"><b>Definition:</b> <a href="InlineSpiller_8cpp_source.html#l00260">InlineSpiller.cpp:260</a></div></div>
<div class="ttc" id="aclassllvm_1_1SlotIndex_html"><div class="ttname"><a href="classllvm_1_1SlotIndex.html">llvm::SlotIndex</a></div><div class="ttdoc">SlotIndex - An opaque wrapper around machine indexes.</div><div class="ttdef"><b>Definition:</b> <a href="SlotIndexes_8h_source.html#l00082">SlotIndexes.h:82</a></div></div>
<div class="ttc" id="aBranchProbability_8h_html"><div class="ttname"><a href="BranchProbability_8h.html">BranchProbability.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html">llvm::MachineBasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00094">MachineBasicBlock.h:94</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a5f95077d52fb7c8cd08ce6338b107bcf"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a5f95077d52fb7c8cd08ce6338b107bcf">llvm::MachineRegisterInfo::def_empty</a></div><div class="ttdeci">bool def_empty(Register RegNo) const</div><div class="ttdoc">def_empty - Return true if there are no instructions defining the specified register (it may be live-...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00448">MachineRegisterInfo.h:448</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_aa363afffca4fc13a709673936b47fe33"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">llvm::MachineRegisterInfo::getRegClass</a></div><div class="ttdeci">const TargetRegisterClass * getRegClass(Register Reg) const</div><div class="ttdoc">Return the register class of the specified virtual register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00661">MachineRegisterInfo.h:661</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_af8a50544090e81ac83601aff8f4b0142"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">llvm::SmallPtrSetImplBase::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00092">SmallPtrSet.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1Spiller_html_a4346292d56a1b2beed7e2a000614c860"><div class="ttname"><a href="classllvm_1_1Spiller.html#a4346292d56a1b2beed7e2a000614c860">llvm::Spiller::~Spiller</a></div><div class="ttdeci">virtual ~Spiller()=0</div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_ae9f0ff5f13bf6cb4567247a39f7756e3"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#ae9f0ff5f13bf6cb4567247a39f7756e3">llvm::LiveIntervals::removePhysRegDefAt</a></div><div class="ttdeci">void removePhysRegDefAt(MCRegister Reg, SlotIndex Pos)</div><div class="ttdoc">Remove value numbers and related live segments starting at position Pos that are part of any liverang...</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8cpp_source.html#l01709">LiveIntervals.cpp:1709</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1SlotIndex_html_aa94e57689dd16c1c4de909511f1b2ea8"><div class="ttname"><a href="classllvm_1_1SlotIndex.html#aa94e57689dd16c1c4de909511f1b2ea8">llvm::SlotIndex::getBaseIndex</a></div><div class="ttdeci">SlotIndex getBaseIndex() const</div><div class="ttdoc">Returns the base index for associated with this index.</div><div class="ttdef"><b>Definition:</b> <a href="SlotIndexes_8h_source.html#l00246">SlotIndexes.h:246</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a3985184940a3c717fb98e6d6bfbfd0d6"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a3985184940a3c717fb98e6d6bfbfd0d6">llvm::MachineRegisterInfo::reg_bundles</a></div><div class="ttdeci">iterator_range&lt; reg_bundle_iterator &gt; reg_bundles(Register Reg) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00339">MachineRegisterInfo.h:339</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequency_html"><div class="ttname"><a href="classllvm_1_1BlockFrequency.html">llvm::BlockFrequency</a></div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequency_8h_source.html#l00023">BlockFrequency.h:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_a136fa159d07a92017f3206822f5847cd"><div class="ttname"><a href="classllvm_1_1LiveRange.html#a136fa159d07a92017f3206822f5847cd">llvm::LiveRange::getVNInfoBefore</a></div><div class="ttdeci">VNInfo * getVNInfoBefore(SlotIndex Idx) const</div><div class="ttdoc">getVNInfoBefore - Return the VNInfo that is live up to but not necessarilly including Idx,...</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00429">LiveInterval.h:429</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_afbdfb2cc5decd8f22ea3ccc1ecea4028"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#afbdfb2cc5decd8f22ea3ccc1ecea4028">llvm::LiveIntervals::ReplaceMachineInstrInMaps</a></div><div class="ttdeci">SlotIndex ReplaceMachineInstrInMaps(MachineInstr &amp;MI, MachineInstr &amp;NewMI)</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00274">LiveIntervals.h:274</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a4c9594c955fec80c73ddd964b5efd554"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">llvm::MachineOperand::isReg</a></div><div class="ttdeci">bool isReg() const</div><div class="ttdoc">isReg - Tests if this is a MO_Register operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00329">MachineOperand.h:329</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html"><div class="ttname"><a href="classllvm_1_1MachineInstr.html">llvm::MachineInstr</a></div><div class="ttdoc">Representation of each machine instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00066">MachineInstr.h:66</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2f2ae9a92eaa5f689a13f21782d4838e"><div class="ttname"><a href="namespacellvm.html#a2f2ae9a92eaa5f689a13f21782d4838e">llvm::AnalyzeVirtRegInBundle</a></div><div class="ttdeci">VirtRegInfo AnalyzeVirtRegInBundle(MachineInstr &amp;MI, Register Reg, SmallVectorImpl&lt; std::pair&lt; MachineInstr *, unsigned &gt;&gt; *Ops=nullptr)</div><div class="ttdoc">AnalyzeVirtRegInBundle - Analyze how the current instruction or bundle uses a virtual register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8cpp_source.html#l00283">MachineInstrBundle.cpp:283</a></div></div>
<div class="ttc" id="aLiveIntervals_8h_html"><div class="ttname"><a href="LiveIntervals_8h.html">LiveIntervals.h</a></div></div>
<div class="ttc" id="aVirtRegMap_8h_html"><div class="ttname"><a href="VirtRegMap_8h.html">VirtRegMap.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1VNInfo_html_ad989a0c1b26066308798f4d11a0e69df"><div class="ttname"><a href="classllvm_1_1VNInfo.html#ad989a0c1b26066308798f4d11a0e69df">llvm::VNInfo::id</a></div><div class="ttdeci">unsigned id</div><div class="ttdoc">The ID number of this value.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00058">LiveInterval.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a7004354fbee1c8cd74ed9001915e1db5"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a7004354fbee1c8cd74ed9001915e1db5">llvm::SmallPtrSetImpl::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00408">SmallPtrSet.h:408</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_ac80ef1b0f96f5df74292346277f0005b"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#ac80ef1b0f96f5df74292346277f0005b">llvm::TargetRegisterInfo::getRegClassName</a></div><div class="ttdeci">const char * getRegClassName(const TargetRegisterClass *Class) const</div><div class="ttdoc">Returns the name of the register class.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00784">TargetRegisterInfo.h:784</a></div></div>
<div class="ttc" id="aclassllvm_1_1BumpPtrAllocatorImpl_html"><div class="ttname"><a href="classllvm_1_1BumpPtrAllocatorImpl.html">llvm::BumpPtrAllocatorImpl</a></div><div class="ttdoc">Allocate memory in an ever growing pool, as if by bump-pointer.</div><div class="ttdef"><b>Definition:</b> <a href="Allocator_8h_source.html#l00063">Allocator.h:63</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_a93450063916ca1ab1f11bf3304a6ad03"><div class="ttname"><a href="classllvm_1_1LiveRange.html#a93450063916ca1ab1f11bf3304a6ad03">llvm::LiveRange::getNumValNums</a></div><div class="ttdeci">unsigned getNumValNums() const</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00313">LiveInterval.h:313</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_aaee820701392c55ad54235d3d7201206"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#aaee820701392c55ad54235d3d7201206">llvm::MachineOperand::isDead</a></div><div class="ttdeci">bool isDead() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00394">MachineOperand.h:394</a></div></div>
<div class="ttc" id="aInlineSpiller_8cpp_html_a7819774f1578a13aaf380ec73782c9e4"><div class="ttname"><a href="InlineSpiller_8cpp.html#a7819774f1578a13aaf380ec73782c9e4">DisableHoisting</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; DisableHoisting(&quot;disable-spill-hoist&quot;, cl::Hidden, cl::desc(&quot;Disable inline spill hoisting&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_ae43ef10e056198d73d7c688d0649c9b2"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#ae43ef10e056198d73d7c688d0649c9b2">llvm::MachineRegisterInfo::reg_instr_nodbg_begin</a></div><div class="ttdeci">reg_instr_nodbg_iterator reg_instr_nodbg_begin(Register RegNo) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00368">MachineRegisterInfo.h:368</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_abf73a826b5d6f739eb4af48ddf14c5b4"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#abf73a826b5d6f739eb4af48ddf14c5b4">llvm::SmallPtrSetImpl::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00403">SmallPtrSet.h:403</a></div></div>
<div class="ttc" id="aclassllvm_1_1SlotIndex_html_a0b73244049319d841fd11a238f35b5d1"><div class="ttname"><a href="classllvm_1_1SlotIndex.html#a0b73244049319d841fd11a238f35b5d1">llvm::SlotIndex::isSameInstr</a></div><div class="ttdeci">static bool isSameInstr(SlotIndex A, SlotIndex B)</div><div class="ttdoc">isSameInstr - Return true if A and B refer to the same instruction.</div><div class="ttdef"><b>Definition:</b> <a href="SlotIndexes_8h_source.html#l00198">SlotIndexes.h:198</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd1cd968cb420c82d70926920fcdc7d7"><div class="ttname"><a href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a></div><div class="ttdeci">bool is_contained(R &amp;&amp;Range, const E &amp;Element)</div><div class="ttdoc">Wrapper function around std::find to detect if an element exists in a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01869">STLExtras.h:1869</a></div></div>
<div class="ttc" id="aArrayRef_8h_html"><div class="ttname"><a href="ArrayRef_8h.html">ArrayRef.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_a6eb0e49d283729a5f8b99d4efa1be7c1"><div class="ttname"><a href="classllvm_1_1LiveRange.html#a6eb0e49d283729a5f8b99d4efa1be7c1">llvm::LiveRange::Query</a></div><div class="ttdeci">LiveQueryResult Query(SlotIndex Idx) const</div><div class="ttdoc">Query Liveness at Idx.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00541">LiveInterval.h:541</a></div></div>
<div class="ttc" id="aMachineFunctionPass_8h_html"><div class="ttname"><a href="MachineFunctionPass_8h.html">MachineFunctionPass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_abd6aa9da048ef7a4faeaac6484d5c9a6"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#abd6aa9da048ef7a4faeaac6484d5c9a6">llvm::MachineOperand::isEarlyClobber</a></div><div class="ttdeci">bool isEarlyClobber() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00445">MachineOperand.h:445</a></div></div>
<div class="ttc" id="astructllvm_1_1PhysRegInfo_html"><div class="ttname"><a href="structllvm_1_1PhysRegInfo.html">llvm::PhysRegInfo</a></div><div class="ttdoc">Information about how a physical register Reg is used by a set of operands.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8h_source.html#l00246">MachineInstrBundle.h:246</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110ad2904b2502547c3f3d390774f8f548c7"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110ad2904b2502547c3f3d390774f8f548c7">llvm::ISD::STACKMAP</a></div><div class="ttdeci">@ STACKMAP</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l01297">ISDOpcodes.h:1297</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_ad08ed580345a51c50d9477dec1e65818"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">llvm::MachineInstrBuilder::addReg</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addReg(Register RegNo, unsigned flags=0, unsigned SubReg=0) const</div><div class="ttdoc">Add a new virtual register operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00097">MachineInstrBuilder.h:97</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_ac0035d7c1c860501c877c20e6e93297b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">llvm::MachineOperand::getReg</a></div><div class="ttdeci">Register getReg() const</div><div class="ttdoc">getReg - Returns the register number.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00369">MachineOperand.h:369</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_afd9b9b8655c008bf6cd6afb05d41b69e"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#afd9b9b8655c008bf6cd6afb05d41b69e">llvm::MachineBasicBlock::predecessors</a></div><div class="ttdeci">iterator_range&lt; pred_iterator &gt; predecessors()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00390">MachineBasicBlock.h:390</a></div></div>
<div class="ttc" id="aclassllvm_1_1SlotIndex_html_ae3b98982e2036f3d26806de5ed5e02d0"><div class="ttname"><a href="classllvm_1_1SlotIndex.html#ae3b98982e2036f3d26806de5ed5e02d0">llvm::SlotIndex::getRegSlot</a></div><div class="ttdeci">SlotIndex getRegSlot(bool EC=false) const</div><div class="ttdoc">Returns the register use/def slot in the current instruction for a normal or early-clobber def.</div><div class="ttdef"><b>Definition:</b> <a href="SlotIndexes_8h_source.html#l00259">SlotIndexes.h:259</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_a25c117ac45bfbbcf69dc0b674db2d1ea"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#a25c117ac45bfbbcf69dc0b674db2d1ea">llvm::LiveIntervals::getInterval</a></div><div class="ttdeci">LiveInterval &amp; getInterval(Register Reg)</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00112">LiveIntervals.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html"><div class="ttname"><a href="classllvm_1_1MachineFunction.html">llvm::MachineFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00258">MachineFunction.h:258</a></div></div>
<div class="ttc" id="aInlineSpiller_8cpp_html_a812047022fbf54b86f829bce5496fcbd"><div class="ttname"><a href="InlineSpiller_8cpp.html#a812047022fbf54b86f829bce5496fcbd">isRealSpill</a></div><div class="ttdeci">static bool isRealSpill(const MachineInstr &amp;Def)</div><div class="ttdoc">Check if Def fully defines a VReg with an undefined value.</div><div class="ttdef"><b>Definition:</b> <a href="InlineSpiller_8cpp_source.html#l01025">InlineSpiller.cpp:1025</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64_html_a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb"><div class="ttname"><a href="namespacellvm_1_1AArch64.html#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">llvm::AArch64::RM</a></div><div class="ttdeci">@ RM</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00499">AArch64ISelLowering.h:499</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_a16413f1a88d8baca228d0a1b4cc0bfc6"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#a16413f1a88d8baca228d0a1b4cc0bfc6">llvm::SmallPtrSetImplBase::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00095">SmallPtrSet.h:95</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="aInlineSpiller_8cpp_html_a44eadd2e9dc8ce097d98948617fd127a"><div class="ttname"><a href="InlineSpiller_8cpp.html#a44eadd2e9dc8ce097d98948617fd127a">RestrictStatepointRemat</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; RestrictStatepointRemat(&quot;restrict-statepoint-remat&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Restrict remat for statepoint operands&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1VirtRegMap_html_a472fd85e65eda4973c533f43b8226f20a120c86e3ef630a99345f58523740bfd3"><div class="ttname"><a href="classllvm_1_1VirtRegMap.html#a472fd85e65eda4973c533f43b8226f20a120c86e3ef630a99345f58523740bfd3">llvm::VirtRegMap::NO_STACK_SLOT</a></div><div class="ttdeci">@ NO_STACK_SLOT</div><div class="ttdef"><b>Definition:</b> <a href="VirtRegMap_8h_source.html#l00037">VirtRegMap.h:37</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_a352c24ce556adb51f63f40a7d946ae44"><div class="ttname"><a href="classllvm_1_1LiveRange.html#a352c24ce556adb51f63f40a7d946ae44">llvm::LiveRange::vnis</a></div><div class="ttdeci">iterator_range&lt; vni_iterator &gt; vnis()</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00230">LiveInterval.h:230</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_ab979122f21b7fa46d3d2d9b21983068b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ab979122f21b7fa46d3d2d9b21983068b">llvm::MachineOperand::setIsUndef</a></div><div class="ttdeci">void setIsUndef(bool Val=true)</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00530">MachineOperand.h:530</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchProbability_html"><div class="ttname"><a href="classllvm_1_1BranchProbability.html">llvm::BranchProbability</a></div><div class="ttdef"><b>Definition:</b> <a href="BranchProbability_8h_source.html#l00030">BranchProbability.h:30</a></div></div>
<div class="ttc" id="aCompiler_8h_html"><div class="ttname"><a href="Compiler_8h.html">Compiler.h</a></div></div>
<div class="ttc" id="aTargetSubtargetInfo_8h_html"><div class="ttname"><a href="TargetSubtargetInfo_8h.html">TargetSubtargetInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a75eb135014670ce946e78739cdc9b51b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">llvm::MachineOperand::isDef</a></div><div class="ttdeci">bool isDef() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00384">MachineOperand.h:384</a></div></div>
<div class="ttc" id="aclassllvm_1_1HexagonInstrInfo_html_aa78de19ae21b6786dd84b7baf19d9cbe"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#aa78de19ae21b6786dd84b7baf19d9cbe">llvm::HexagonInstrInfo::isLoadFromStackSlot</a></div><div class="ttdeci">unsigned isLoadFromStackSlot(const MachineInstr &amp;MI, int &amp;FrameIndex) const override</div><div class="ttdoc">TargetInstrInfo overrides.</div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l00288">HexagonInstrInfo.cpp:288</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a002fd916e7206e01d512eeb06d405cf0"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">llvm::MachineInstr::getParent</a></div><div class="ttdeci">const MachineBasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00313">MachineInstr.h:313</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html">llvm::DomTreeNodeBase</a></div><div class="ttdoc">Base class for the actual dominator tree node.</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervalCalc_8h_source.html#l00024">LiveIntervalCalc.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a99f811d53704275b4158c62a2dd138d9"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00207">DenseMap.h:207</a></div></div>
<div class="ttc" id="aAArch64AdvSIMDScalarPass_8cpp_html_aacd2ab195054a3e6a74bfbb9d5d571c8"><div class="ttname"><a href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a></div><div class="ttdeci">unsigned const MachineRegisterInfo * MRI</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AdvSIMDScalarPass_8cpp_source.html#l00105">AArch64AdvSIMDScalarPass.cpp:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1Register_html"><div class="ttname"><a href="classllvm_1_1Register.html">llvm::Register</a></div><div class="ttdoc">Wrapper class representing virtual and physical registers.</div><div class="ttdef"><b>Definition:</b> <a href="Register_8h_source.html#l00019">Register.h:19</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_a0e1c3175b0ac22fe3853651c28e1ecb8"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">llvm::SmallPtrSetImplBase::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00093">SmallPtrSet.h:93</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a028a8c5113d40d8c3f4427053bf36738"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a028a8c5113d40d8c3f4427053bf36738">llvm::MachineOperand::getSubReg</a></div><div class="ttdeci">unsigned getSubReg() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00374">MachineOperand.h:374</a></div></div>
<div class="ttc" id="aLiveRangeEdit_8h_html"><div class="ttname"><a href="LiveRangeEdit_8h.html">LiveRangeEdit.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1VNInfo_html_ae72fbcf51be7574c84817cde814df07e"><div class="ttname"><a href="classllvm_1_1VNInfo.html#ae72fbcf51be7574c84817cde814df07e">llvm::VNInfo::isPHIDef</a></div><div class="ttdeci">bool isPHIDef() const</div><div class="ttdoc">Returns true if this value is defined by a PHI instruction (or was, PHI instructions may have been el...</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00078">LiveInterval.h:78</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_a5958512eae2979bd2eb383977996a600"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a></div><div class="ttdeci">MachineBasicBlock &amp; MBB</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00074">AArch64SLSHardening.cpp:74</a></div></div>
<div class="ttc" id="aInlineSpiller_8cpp_html_a3a62b5d1e83ec172369441613b538fce"><div class="ttname"><a href="InlineSpiller_8cpp.html#a3a62b5d1e83ec172369441613b538fce">dumpMachineInstrRangeWithSlotIndex</a></div><div class="ttdeci">static LLVM_DUMP_METHOD void dumpMachineInstrRangeWithSlotIndex(MachineBasicBlock::iterator B, MachineBasicBlock::iterator E, LiveIntervals const &amp;LIS, const char *const header, Register VReg=Register())</div><div class="ttdef"><b>Definition:</b> <a href="InlineSpiller_8cpp_source.html#l00781">InlineSpiller.cpp:781</a></div></div>
<div class="ttc" id="aInlineSpiller_8cpp_html_ac370c41caa198ae51b35d5b35f9b8c81"><div class="ttname"><a href="InlineSpiller_8cpp.html#ac370c41caa198ae51b35d5b35f9b8c81">getVDefInterval</a></div><div class="ttdeci">static void getVDefInterval(const MachineInstr &amp;MI, LiveIntervals &amp;LIS)</div><div class="ttdef"><b>Definition:</b> <a href="InlineSpiller_8cpp_source.html#l00270">InlineSpiller.cpp:270</a></div></div>
<div class="ttc" id="aclassllvm_1_1StatepointOpers_html"><div class="ttname"><a href="classllvm_1_1StatepointOpers.html">llvm::StatepointOpers</a></div><div class="ttdoc">MI-level Statepoint operands.</div><div class="ttdef"><b>Definition:</b> <a href="StackMaps_8h_source.html#l00158">StackMaps.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRangeEdit_html_a74435e70950c152062a08f3d706d77ff"><div class="ttname"><a href="classllvm_1_1LiveRangeEdit.html#a74435e70950c152062a08f3d706d77ff">llvm::LiveRangeEdit::getParent</a></div><div class="ttdeci">const LiveInterval &amp; getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="LiveRangeEdit_8h_source.html#l00141">LiveRangeEdit.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a3be9857a09c82046b77a71918b5e214f"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a3be9857a09c82046b77a71918b5e214f">llvm::MachineOperand::readsReg</a></div><div class="ttdeci">bool readsReg() const</div><div class="ttdoc">readsReg - Returns true if this operand reads the previous value of its register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00467">MachineOperand.h:467</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1StatepointOpers_html_afa5a7e5f9b626c9fb0b9d66235146ac3"><div class="ttname"><a href="classllvm_1_1StatepointOpers.html#afa5a7e5f9b626c9fb0b9d66235146ac3">llvm::StatepointOpers::isFoldableReg</a></div><div class="ttdeci">bool isFoldableReg(Register Reg) const</div><div class="ttdoc">Return true if Reg is used only in operands which can be folded to stack usage.</div><div class="ttdef"><b>Definition:</b> <a href="StackMaps_8cpp_source.html#l00149">StackMaps.cpp:149</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a5dbb1abfb6d3c14555304f9c56703234a9234cc57c43f272b55a94b0069fe62d1"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a5dbb1abfb6d3c14555304f9c56703234a9234cc57c43f272b55a94b0069fe62d1">llvm::pdb::PDB_LocType::Slot</a></div><div class="ttdeci">@ Slot</div></div>
<div class="ttc" id="aStackMaps_8h_html"><div class="ttname"><a href="StackMaps_8h.html">StackMaps.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_a699598a93a78f8b0376cfb49933cbce7"><div class="ttname"><a href="classllvm_1_1LiveRange.html#a699598a93a78f8b0376cfb49933cbce7">llvm::LiveRange::getValNumInfo</a></div><div class="ttdeci">VNInfo * getValNumInfo(unsigned ValNo)</div><div class="ttdoc">getValNumInfo - Returns pointer to the specified val#.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00317">LiveInterval.h:317</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html">llvm::LiveIntervals</a></div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00053">LiveIntervals.h:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1VNInfo_html"><div class="ttname"><a href="classllvm_1_1VNInfo.html">llvm::VNInfo</a></div><div class="ttdoc">VNInfo - Value Number Information.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00053">LiveInterval.h:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_adf042897913dea01859fc1944f7e61cd"><div class="ttname"><a href="classllvm_1_1LiveRange.html#adf042897913dea01859fc1944f7e61cd">llvm::LiveRange::getVNInfoAt</a></div><div class="ttdeci">VNInfo * getVNInfoAt(SlotIndex Idx) const</div><div class="ttdoc">getVNInfoAt - Return the VNInfo that is live at Idx, or NULL.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00421">LiveInterval.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_ac3b161ec90385105cb46a08b52139e60"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ac3b161ec90385105cb46a08b52139e60">llvm::MachineInstr::removeOperand</a></div><div class="ttdeci">void removeOperand(unsigned OpNo)</div><div class="ttdoc">Erase an operand from an instruction, leaving it with one fewer operand than it started with.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00279">MachineInstr.cpp:279</a></div></div>
<div class="ttc" id="aLiveInterval_8h_html"><div class="ttname"><a href="LiveInterval_8h.html">LiveInterval.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1HexagonInstrInfo_html_abd2d8a338da0066ab5a287c36dd7928d"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#abd2d8a338da0066ab5a287c36dd7928d">llvm::HexagonInstrInfo::loadRegFromStackSlot</a></div><div class="ttdeci">void loadRegFromStackSlot(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MBBI, Register DestReg, int FrameIndex, const TargetRegisterClass *RC, const TargetRegisterInfo *TRI, Register VReg) const override</div><div class="ttdoc">Load the specified register of the given register class from the specified stack frame index.</div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l01004">HexagonInstrInfo.cpp:1004</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRange_html_a325a4ec9c33a3dead9ff01c9e70fd534"><div class="ttname"><a href="classllvm_1_1LiveRange.html#a325a4ec9c33a3dead9ff01c9e70fd534">llvm::LiveRange::MergeValueInAsValue</a></div><div class="ttdeci">void MergeValueInAsValue(const LiveRange &amp;RHS, const VNInfo *RHSValNo, VNInfo *LHSValNo)</div><div class="ttdoc">MergeValueInAsValue - Merge all of the segments of a specific val# in RHS into this live range as the...</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8cpp_source.html#l00722">LiveInterval.cpp:722</a></div></div>
<div class="ttc" id="anamespacellvm_html_aac57d4100e9a9d02522fbd724568397d"><div class="ttname"><a href="namespacellvm.html#aac57d4100e9a9d02522fbd724568397d">llvm::getKillRegState</a></div><div class="ttdeci">unsigned getKillRegState(bool B)</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00531">MachineInstrBuilder.h:531</a></div></div>
<div class="ttc" id="aclassllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdoc">Pass interface - Implemented by all 'passes'.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00091">Pass.h:91</a></div></div>
<div class="ttc" id="anamespacellvm_html_a17e04afcf0c5efeb0eb6a9a45287b5e4"><div class="ttname"><a href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">llvm::BuildMI</a></div><div class="ttdeci">MachineInstrBuilder BuildMI(MachineFunction &amp;MF, const MIMetadata &amp;MIMD, const MCInstrDesc &amp;MCID)</div><div class="ttdoc">Builder interface. Specify how to create the initial instruction itself.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00357">MachineInstrBuilder.h:357</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_ab2d91e7bec944efcbc39d8e30644f111"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">llvm::MachineBasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00309">MachineBasicBlock.h:309</a></div></div>
<div class="ttc" id="aMachineInstrBuilder_8h_html"><div class="ttname"><a href="MachineInstrBuilder_8h.html">MachineInstrBuilder.h</a></div></div>
<div class="ttc" id="aLiveStacks_8h_html"><div class="ttname"><a href="LiveStacks_8h.html">LiveStacks.h</a></div></div>
<div class="ttc" id="aRegAllocBasic_8cpp_html_ad5d00e1d77644d95847b9bf8da12b759"><div class="ttname"><a href="RegAllocBasic_8cpp.html#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a></div><div class="ttdeci">Basic Register Allocator</div><div class="ttdef"><b>Definition:</b> <a href="RegAllocBasic_8cpp_source.html#l00143">RegAllocBasic.cpp:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a682ba82f42f7903d0000ffbb13ea3b57"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">llvm::MachineOperand::setReg</a></div><div class="ttdeci">void setReg(Register Reg)</div><div class="ttdoc">Change the register this operand corresponds to.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8cpp_source.html#l00061">MachineOperand.cpp:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_a73f605751be73f0a910a586bb1b5d869"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#a73f605751be73f0a910a586bb1b5d869">llvm::LiveIntervals::RemoveMachineInstrFromMaps</a></div><div class="ttdeci">void RemoveMachineInstrFromMaps(MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00270">LiveIntervals.h:270</a></div></div>
<div class="ttc" id="aAArch64ExpandPseudoInsts_8cpp_html_ad3ece0ac2421637044624c9b01c42466"><div class="ttname"><a href="AArch64ExpandPseudoInsts_8cpp.html#ad3ece0ac2421637044624c9b01c42466">DefMI</a></div><div class="ttdeci">MachineInstrBuilder MachineInstrBuilder &amp; DefMI</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ExpandPseudoInsts_8cpp_source.html#l00108">AArch64ExpandPseudoInsts.cpp:108</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a432824f0975bb863478bf4ef3a5df258"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a432824f0975bb863478bf4ef3a5df258">llvm::MachineInstr::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const</div><div class="ttdoc">Retuns the total number of operands.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00519">MachineInstr.h:519</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_a87b097de2261d68334195870a03412b9"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#a87b097de2261d68334195870a03412b9">llvm::LiveIntervals::InsertMachineInstrRangeInMaps</a></div><div class="ttdeci">void InsertMachineInstrRangeInMaps(MachineBasicBlock::iterator B, MachineBasicBlock::iterator E)</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00264">LiveIntervals.h:264</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a0c8ffe664a36e30d49c84d0aded2fe08"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a0c8ffe664a36e30d49c84d0aded2fe08">llvm::SmallVectorImpl::pop_back_val</a></div><div class="ttdeci">T pop_back_val()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00677">SmallVector.h:677</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveInterval_html_a14d46e70db7e417c8ed5bc66fb295185"><div class="ttname"><a href="classllvm_1_1LiveInterval.html#a14d46e70db7e417c8ed5bc66fb295185">llvm::LiveInterval::reg</a></div><div class="ttdeci">Register reg() const</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00717">LiveInterval.h:717</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl&lt; MachineInstr * &gt;</a></div></div>
<div class="ttc" id="aMachineOperand_8h_html"><div class="ttname"><a href="MachineOperand_8h.html">MachineOperand.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSetVector_html"><div class="ttname"><a href="classllvm_1_1SmallSetVector.html">llvm::SmallSetVector</a></div><div class="ttdoc">A SetVector that performs no allocations if smaller than a certain size.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00300">SetVector.h:300</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRangeEdit_1_1Delegate_html"><div class="ttname"><a href="classllvm_1_1LiveRangeEdit_1_1Delegate.html">llvm::LiveRangeEdit::Delegate</a></div><div class="ttdoc">Callback methods for LiveRangeEdit owners.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRangeEdit_8h_source.html#l00045">LiveRangeEdit.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1VNInfo_html_ab72366fd538f240cbb53dac39368cdfc"><div class="ttname"><a href="classllvm_1_1VNInfo.html#ab72366fd538f240cbb53dac39368cdfc">llvm::VNInfo::isUnused</a></div><div class="ttdeci">bool isUnused() const</div><div class="ttdoc">Returns true if this value is unused.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00081">LiveInterval.h:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_a0bcbe87140565048a95f70d5207b4a93"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a0bcbe87140565048a95f70d5207b4a93">llvm::MachineBasicBlock::SkipPHIsLabelsAndDebug</a></div><div class="ttdeci">iterator SkipPHIsLabelsAndDebug(iterator I, bool SkipPseudoOp=true)</div><div class="ttdoc">Return the first instruction in MBB after I that is not a PHI, label or debug.</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00223">MachineBasicBlock.cpp:223</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a8f72614046d13d67b12a1e9201744ea8"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a8f72614046d13d67b12a1e9201744ea8">llvm::MachineFunction::DebugOperandMemNumber</a></div><div class="ttdeci">const static unsigned int DebugOperandMemNumber</div><div class="ttdoc">A reserved operand number representing the instructions memory operand, for instructions that have a ...</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00587">MachineFunction.h:587</a></div></div>
<div class="ttc" id="aSlotIndexes_8h_html"><div class="ttname"><a href="SlotIndexes_8h.html">SlotIndexes.h</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a7246178f42b1eaef4e9bba10a9f39323"><div class="ttname"><a href="README-SSE_8txt.html#a7246178f42b1eaef4e9bba10a9f39323">spill</a></div><div class="ttdeci">the custom lowered code happens to be but we shouldn t have to custom lower anything This is probably related to&lt; 2 x i64 &gt; ops being so bad LLVM currently generates stack realignment when it is not necessary needed The problem is that we need to know about stack alignment too before RA runs At that point we don t whether there will be vector spill</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00489">README-SSE.txt:489</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a666dc30b9326da6b9e69740a241df89d"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a666dc30b9326da6b9e69740a241df89d">llvm::MachineRegisterInfo::reg_nodbg_empty</a></div><div class="ttdeci">bool reg_nodbg_empty(Register RegNo) const</div><div class="ttdoc">reg_nodbg_empty - Return true if the only instructions using or defining Reg are Debug instructions.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00399">MachineRegisterInfo.h:399</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineDominatorTree_html"><div class="ttname"><a href="classllvm_1_1MachineDominatorTree.html">llvm::MachineDominatorTree</a></div><div class="ttdoc">DominatorTree Class - Concrete subclass of DominatorTreeBase that is used to compute a normal dominat...</div><div class="ttdef"><b>Definition:</b> <a href="MachineDominators_8h_source.html#l00051">MachineDominators.h:51</a></div></div>
<div class="ttc" id="astructllvm_1_1VirtRegInfo_html"><div class="ttname"><a href="structllvm_1_1VirtRegInfo.html">llvm::VirtRegInfo</a></div><div class="ttdoc">VirtRegInfo - Information about a virtual register used by a set of operands.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBundle_8h_source.html#l00218">MachineInstrBundle.h:218</a></div></div>
<div class="ttc" id="aMachineFunction_8h_html"><div class="ttname"><a href="MachineFunction_8h.html">MachineFunction.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_af085ea923a328b9fa6a1975f1a4ff987"><div class="ttname"><a href="namespacellvm.html#af085ea923a328b9fa6a1975f1a4ff987">llvm::printReg</a></div><div class="ttdeci">Printable printReg(Register Reg, const TargetRegisterInfo *TRI=nullptr, unsigned SubIdx=0, const MachineRegisterInfo *MRI=nullptr)</div><div class="ttdoc">Prints virtual and physical registers with or without a TRI instance.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8cpp_source.html#l00111">TargetRegisterInfo.cpp:111</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBundleIterator_html"><div class="ttname"><a href="classllvm_1_1MachineInstrBundleIterator.html">llvm::MachineInstrBundleIterator&lt; MachineInstr &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bae1e4c8c9ccd9fc39c391da4bcd093fb2">llvm::pdb::PDB_SymType::Block</a></div><div class="ttdeci">@ Block</div></div>
<div class="ttc" id="aclassllvm_1_1LiveStacks_html"><div class="ttname"><a href="classllvm_1_1LiveStacks.html">llvm::LiveStacks</a></div><div class="ttdef"><b>Definition:</b> <a href="LiveStacks_8h_source.html#l00035">LiveStacks.h:35</a></div></div>
<div class="ttc" id="aMachineBlockFrequencyInfo_8h_html"><div class="ttname"><a href="MachineBlockFrequencyInfo_8h.html">MachineBlockFrequencyInfo.h</a></div></div>
<div class="ttc" id="aTargetRegisterInfo_8h_html"><div class="ttname"><a href="TargetRegisterInfo_8h.html">TargetRegisterInfo.h</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveQueryResult_html_af155aeaffc7607f4f27ab4cfcbb39a64"><div class="ttname"><a href="classllvm_1_1LiveQueryResult.html#af155aeaffc7607f4f27ab4cfcbb39a64">llvm::LiveQueryResult::isKill</a></div><div class="ttdeci">bool isKill() const</div><div class="ttdoc">Return true if the live-in value is killed by this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="LiveInterval_8h_source.html#l00112">LiveInterval.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveIntervals_html_a11b78aceef1db7dddc7ca575c395ddaf"><div class="ttname"><a href="classllvm_1_1LiveIntervals.html#a11b78aceef1db7dddc7ca575c395ddaf">llvm::LiveIntervals::getVNInfoAllocator</a></div><div class="ttdeci">VNInfo::Allocator &amp; getVNInfoAllocator()</div><div class="ttdef"><b>Definition:</b> <a href="LiveIntervals_8h_source.html#l00278">LiveIntervals.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1HexagonInstrInfo_html_a230837b86f36384876568b3bdb4fdafb"><div class="ttname"><a href="classllvm_1_1HexagonInstrInfo.html#a230837b86f36384876568b3bdb4fdafb">llvm::HexagonInstrInfo::storeRegToStackSlot</a></div><div class="ttdeci">void storeRegToStackSlot(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator MBBI, Register SrcReg, bool isKill, int FrameIndex, const TargetRegisterClass *RC, const TargetRegisterInfo *TRI, Register VReg) const override</div><div class="ttdoc">Store the specified register of the given register class to the specified stack frame index.</div><div class="ttdef"><b>Definition:</b> <a href="HexagonInstrInfo_8cpp_source.html#l00956">HexagonInstrInfo.cpp:956</a></div></div>
<div class="ttc" id="aSetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="aMachineDominators_8h_html"><div class="ttname"><a href="MachineDominators_8h.html">MachineDominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 09:53:00 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
