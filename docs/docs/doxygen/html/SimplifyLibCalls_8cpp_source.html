<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Utils/SimplifyLibCalls.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_f75c00afeb315f44d76556a7c675e6e8.html">Utils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SimplifyLibCalls.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SimplifyLibCalls_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===------ SimplifyLibCalls.cpp - Library calls simplifier ---------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements the library calls simplifier. It does not implement</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// any pass, but can&#39;t be used by other passes to do simplifications.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SimplifyLibCalls_8h.html">llvm/Transforms/Utils/SimplifyLibCalls.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="APSInt_8h.html">llvm/ADT/APSInt.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallString_8h.html">llvm/ADT/SmallString.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConstantFolding_8h.html">llvm/Analysis/ConstantFolding.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Loads_8h.html">llvm/Analysis/Loads.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Intrinsics_8h.html">llvm/IR/Intrinsics.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KnownBits_8h.html">llvm/Support/KnownBits.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MathExtras_8h.html">llvm/Support/MathExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Triple_8h.html">llvm/TargetParser/Triple.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BuildLibCalls_8h.html">llvm/Transforms/Utils/BuildLibCalls.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SizeOpts_8h.html">llvm/Transforms/Utils/SizeOpts.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a1485593d8fe2ff9daade68b22fc01249">EnableUnsafeFPShrink</a>(<span class="stringliteral">&quot;enable-double-float-shrink&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                         <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                         <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable unsafe double to float &quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                  <span class="stringliteral">&quot;shrinking for math lib calls&quot;</span>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// Helper Functions</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a613c1a46385c58d54da4ac29ec17994c">   51</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a613c1a46385c58d54da4ac29ec17994c">ignoreCallingConv</a>(<a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> Func) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">return</span> Func == LibFunc_abs || Func == LibFunc_labs ||</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;         Func == LibFunc_llabs || Func == LibFunc_strlen;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">/// Return true if it is only used in equality comparisons with With.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">   57</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">isOnlyUsedInEqualityComparison</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Value.html">Value</a> *With) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : V-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *IC = dyn_cast&lt;ICmpInst&gt;(U))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (IC-&gt;isEquality() &amp;&amp; IC-&gt;getOperand(1) == With)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// Unknown instruction.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#ae56877b571bfd107841dabb130c9f2ca">   68</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#ae56877b571bfd107841dabb130c9f2ca">callHasFloatingPointArgument</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(CI-&gt;<a class="code" href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>(), [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;OI) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    return OI-&gt;getType()-&gt;isFloatingPointTy();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  });</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#ae817e73e41b3b26068e6b8a50cd447af">   74</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#ae817e73e41b3b26068e6b8a50cd447af">callHasFP128Argument</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(CI-&gt;<a class="code" href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>(), [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;OI) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    return OI-&gt;getType()-&gt;isFP128Ty();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  });</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// Convert the entire string Str representing an integer in Base, up to</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">// the terminating nul if present, to a constant according to the rules</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// of strtoul[l] or, when AsSigned is set, of strtol[l].  On success</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// return the result, otherwise null.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// The function assumes the string is encoded in ASCII and carefully</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">// avoids converting sequences (including &quot;&quot;) that the corresponding</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// library call might fail and set errno for.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a181299935120519ce8b8953da4d4d354">   87</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a181299935120519ce8b8953da4d4d354">convertStrToInt</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> &amp;Str, <a class="code" href="classllvm_1_1Value.html">Value</a> *EndPtr,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                              <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Base, <span class="keywordtype">bool</span> AsSigned, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (Base &lt; 2 || Base &gt; 36)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> != 0)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="comment">// Fail for an invalid base (required by POSIX).</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// Current offset into the original string to reflect in EndPtr.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">size_t</span> Offset = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// Strip leading whitespace.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">for</span> ( ; Offset != Str.size(); ++Offset)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (!isSpace((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)Str[Offset])) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      Str = Str.substr(Offset);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">if</span> (Str.empty())</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Fail for empty subject sequences (POSIX allows but doesn&#39;t require</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// strtol[l]/strtoul[l] to fail with EINVAL).</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// Strip but remember the sign.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">bool</span> Negate = Str[0] == <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (Str[0] == <span class="charliteral">&#39;-&#39;</span> || Str[0] == <span class="charliteral">&#39;+&#39;</span>) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    Str = Str.drop_front();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (Str.empty())</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="comment">// Fail for a sign with nothing after it.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ++Offset;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// Set Max to the absolute value of the minimum (for signed), or</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// to the maximum (for unsigned) value representable in the type.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *RetTy = CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">unsigned</span> NBits = RetTy-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Max = AsSigned &amp;&amp; Negate ? 1 : 0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  Max += AsSigned ? <a class="code" href="namespacellvm.html#a08b6d5c69d7933ac65aae84e1b50fa62">maxIntN</a>(NBits) : <a class="code" href="namespacellvm.html#af80bd4ec8a9b2f8e7d9d75ab708a55c2">maxUIntN</a>(NBits);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// Autodetect Base if it&#39;s zero and consume the &quot;0x&quot; prefix.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">if</span> (Str.size() &gt; 1) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (Str[0] == <span class="charliteral">&#39;0&#39;</span>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (toUpper((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)Str[1]) == <span class="charliteral">&#39;X&#39;</span>) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span> (Str.size() == 2 || (<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> &amp;&amp; <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> != 16))</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <span class="comment">// Fail if Base doesn&#39;t allow the &quot;0x&quot; prefix or for the prefix</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <span class="comment">// alone that implementations like BSD set errno to EINVAL for.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        Str = Str.drop_front(2);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        Offset += 2;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = 16;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> == 0)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = 8;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> == 0)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = 10;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> == 0)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = 10;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// Convert the rest of the subject sequence, not including the sign,</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// to its uint64_t representation (this assumes the source character</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// set is ASCII).</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Result = 0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != Str.size(); ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> DigVal = Str[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="RustDemangle_8cpp.html#a12d4f37888b638bcbd9fc0201492c776">isDigit</a>(DigVal))</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      DigVal = DigVal - <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      DigVal = toUpper(DigVal);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span> (isAlpha(DigVal))</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        DigVal = DigVal - <span class="charliteral">&#39;A&#39;</span> + 10;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (DigVal &gt;= <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">// Fail if the digit is not valid in the Base.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// Add the digit and fail if the result is not representable in</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// the (unsigned form of the) destination type.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">bool</span> VFlow;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    Result = <a class="code" href="namespacellvm.html#a9cb2daa4b6729813d1f8d39b9e037a5a">SaturatingMultiplyAdd</a>(Result, <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)DigVal, &amp;VFlow);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (VFlow || Result &gt; Max)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (EndPtr) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// Store the pointer to the end.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Off = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt64(Offset + Str.size());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StrBeg = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StrEnd = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), StrBeg, Off, <span class="stringliteral">&quot;endptr&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(StrEnd, EndPtr);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (Negate)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Unsigned negation doesn&#39;t overflow.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    Result = -Result;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(RetTy, Result);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#adfa827b083d21f99d75f9e3e08205fee">  189</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#adfa827b083d21f99d75f9e3e08205fee">isOnlyUsedInComparisonWithZero</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : V-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *IC = dyn_cast&lt;ICmpInst&gt;(U))</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(IC-&gt;getOperand(1)))</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;isNullValue())</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// Unknown instruction.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a24ff4e69025be7564b19025b93cac8d9">  201</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a24ff4e69025be7564b19025b93cac8d9">canTransformToMemCmp</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1Value.html">Value</a> *Str, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SimplifyLibCalls_8cpp.html#adfa827b083d21f99d75f9e3e08205fee">isOnlyUsedInComparisonWithZero</a>(CI))</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2da012cb3e5534bbee33563d309bc354">isDereferenceableAndAlignedPointer</a>(Str, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), <a class="code" href="classllvm_1_1APInt.html">APInt</a>(64, Len), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#afb28a4deafe2954b0534cc6399ce518b">hasFnAttribute</a>(Attribute::SanitizeMemory))</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">  215</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                         <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;unsigned&gt;</a> ArgNos,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                         <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> DereferenceableBytes) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ArgNo : ArgNos) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> DerefBytes = DereferenceableBytes;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">unsigned</span> AS = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(ArgNo)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a7b03ed78a8e299bde6d26a8793cd4e06">llvm::NullPointerIsDefined</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, AS) ||</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">paramHasAttr</a>(ArgNo, Attribute::NonNull))</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      DerefBytes = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#abaf8a257af9e537d7cd8b05299e5090c">getParamDereferenceableOrNullBytes</a>(ArgNo),</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                            DereferenceableBytes);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a37269632d3b68130c5b7019cd795be44">getParamDereferenceableBytes</a>(ArgNo) &lt; DerefBytes) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2ab5d0b4d639b3f79ff3922441e0082e">removeParamAttr</a>(ArgNo, Attribute::Dereferenceable);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a7b03ed78a8e299bde6d26a8793cd4e06">llvm::NullPointerIsDefined</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, AS) ||</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">paramHasAttr</a>(ArgNo, Attribute::NonNull))</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2ab5d0b4d639b3f79ff3922441e0082e">removeParamAttr</a>(ArgNo, Attribute::DereferenceableOrNull);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">addParamAttr</a>(ArgNo, <a class="code" href="classllvm_1_1Attribute.html#a4b2c8769ea6c7af6f24285e87a7e3aa1">Attribute::getWithDereferenceableBytes</a>(</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                                  CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), DerefBytes));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">  240</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                         <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;unsigned&gt;</a> ArgNos) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ArgNo : ArgNos) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">paramHasAttr</a>(ArgNo, Attribute::NoUndef))</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">addParamAttr</a>(ArgNo, Attribute::NoUndef);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">paramHasAttr</a>(ArgNo, Attribute::NonNull)) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordtype">unsigned</span> AS =</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(ArgNo)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a7b03ed78a8e299bde6d26a8793cd4e06">llvm::NullPointerIsDefined</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, AS))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">addParamAttr</a>(ArgNo, Attribute::NonNull);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, ArgNo, 1);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">  262</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">annotateNonNullAndDereferenceable</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;unsigned&gt;</a> ArgNos,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                               <a class="code" href="classllvm_1_1Value.html">Value</a> *Size, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *LenC = dyn_cast&lt;ConstantInt&gt;(Size)) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, ArgNos);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, ArgNos, LenC-&gt;getZExtValue());</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, ArgNos);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, *<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> DerefMin = 1;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Size, <a class="code" href="namespacellvm_1_1PatternMatch.html#addb87fe3f509b7803d3f5933ee24b560">m_Select</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(), <a class="code" href="namespacellvm_1_1PatternMatch.html#aac9e78b3aa02ec087c4621358f506718">m_APInt</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>), <a class="code" href="namespacellvm_1_1PatternMatch.html#aac9e78b3aa02ec087c4621358f506718">m_APInt</a>(<a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>)))) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      DerefMin = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>-&gt;getZExtValue(), <a class="code" href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a>-&gt;getZExtValue());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, ArgNos, DerefMin);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">// Copy CallInst &quot;flags&quot; like musttail, notail, and tail. Return New param for</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">// easier chaining. Calls to emit* and B.createCall should probably be wrapped</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">// in this function when New is created to replace Old. Callers should take</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">// care to check Old.isMustTailCall() if they aren&#39;t replacing Old directly</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">// with New.</span></div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">  283</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;Old, <a class="code" href="classllvm_1_1Value.html">Value</a> *New) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Old.<a class="code" href="classllvm_1_1CallInst.html#ad3c897ba734b78e973db4622dff7bdcb">isMustTailCall</a>() &amp;&amp; <span class="stringliteral">&quot;do not copy musttail call flags&quot;</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Old.<a class="code" href="classllvm_1_1CallInst.html#a07b994620d0144569ae8250ba59d0d6e">isNoTailCall</a>() &amp;&amp; <span class="stringliteral">&quot;do not copy notail call flags&quot;</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *NewCI = dyn_cast_or_null&lt;CallInst&gt;(New))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    NewCI-&gt;setTailCallKind(Old.<a class="code" href="classllvm_1_1CallInst.html#a8f907245246e05c0220934144c013aee">getTailCallKind</a>());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">return</span> New;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">  291</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI, <span class="keyword">const</span> <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> &amp;Old) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  NewCI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a9da3b29e8e71b9be4645874e1721207a">setAttributes</a>(<a class="code" href="classllvm_1_1AttributeList.html#a5cc6492c8f2e06a8bae9dc0d121fab9f">AttributeList::get</a>(</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      NewCI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), {NewCI-&gt;getAttributes(), Old.getAttributes()}));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  NewCI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d9fe4a8103a58d5dee8ff09e6fa2152">removeRetAttrs</a>(<a class="code" href="namespacellvm_1_1AttributeFuncs.html#ae48bd752d74f193a0651b89931b28025">AttributeFuncs::typeIncompatible</a>(NewCI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(Old, NewCI);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">// Helper to avoid truncating the length if size_t is 32-bits.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#ab845621311caa169682acb9c65516ae1">  299</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="SimplifyLibCalls_8cpp.html#ab845621311caa169682acb9c65516ae1">substr</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">return</span> Len &gt;= Str.size() ? Str : Str.substr(0, Len);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">// String and Memory Library Call Optimizations</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrCat(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// Extract some information from the instruction</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, {0, 1});</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// See if we can get the length of the input string.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">if</span> (Len)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, Len);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  --<a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a>; <span class="comment">// Unbias length.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// Handle the simple, do-nothing case: strcat(x, &quot;&quot;) -&gt; x</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> (Len == 0)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, emitStrLenMemCpy(Src, Dst, Len, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::emitStrLenMemCpy(<a class="code" href="classllvm_1_1Value.html">Value</a> *Src, <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                           <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// We need to find the end of the destination string.  That&#39;s where the</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// memory is to be moved to. We just generate a call to strlen.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DstLen = <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(Dst, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">if</span> (!DstLen)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// Now that we have the destination&#39;s length, we must index into the</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// destination&#39;s pointer to get the actual memcpy destination (end of</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">// the string .. we&#39;re concatenating).</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CpyDst = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, DstLen, <span class="stringliteral">&quot;endptr&quot;</span>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// We have enough information to now generate the memcpy call to do the</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// concatenation for us.  Make a memcpy to copy the nul byte with align = 1.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      CpyDst, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), Src, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1),</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(Src-&gt;getContext()), Len + 1));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrNCat(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// Extract some information from the instruction.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 1);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// We don&#39;t do anything if length is not constant.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *LengthArg = dyn_cast&lt;ConstantInt&gt;(Size);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">if</span> (LengthArg) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = LengthArg-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// strncat(x, c, 0) -&gt; x</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (!Len)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// See if we can get the length of the input string.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SrcLen = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">if</span> (SrcLen) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, SrcLen);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    --SrcLen; <span class="comment">// Unbias length.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">// strncat(x, &quot;&quot;, c) -&gt; x</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span> (SrcLen == 0)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// We don&#39;t optimize this case.</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">if</span> (Len &lt; SrcLen)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// strncat(x, s, c) -&gt; strcat(x, s)</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// s is constant so the strcat can be optimized further.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, emitStrLenMemCpy(Src, Dst, SrcLen, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>));</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">// Helper to transform memchr(S, C, N) == S to N &amp;&amp; *S == C and, when</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">// NBytes is null, strchr(S, C) to *S == C.  A precondition of the function</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">// is that either S is dereferenceable or the value of N is nonzero.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a4471d0813af2c29201b8c3191e146370">  395</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a>* <a class="code" href="SimplifyLibCalls_8cpp.html#a4471d0813af2c29201b8c3191e146370">memChrToCharCompare</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1Value.html">Value</a> *NBytes,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                  <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CharVal = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// Fold memchr(A, C, N) == A to N &amp;&amp; *A == C.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CharTy = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Char0 = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(CharTy, Src);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  CharVal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateTrunc(CharVal, CharTy);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Cmp = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpEQ(Char0, CharVal, <span class="stringliteral">&quot;char0cmp&quot;</span>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span> (NBytes) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Zero = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(NBytes-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eac33315685a0cba3ce53be378b3c7874b">And</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpNE(NBytes, Zero);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    Cmp = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLogicalAnd(<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eac33315685a0cba3ce53be378b3c7874b">And</a>, Cmp);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NullPtr = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(Cmp, Src, NullPtr);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrChr(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcStr = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CharVal = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">isOnlyUsedInEqualityComparison</a>(CI, SrcStr))</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a4471d0813af2c29201b8c3191e146370">memChrToCharCompare</a>(CI, <span class="keyword">nullptr</span>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// If the second operand is non-constant, see if we can compute the length</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// of the input string and turn this into memchr.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CharC = dyn_cast&lt;ConstantInt&gt;(CharVal);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (!CharC) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(SrcStr);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (Len)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 0, Len);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *FT = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">unsigned</span> IntBits = TLI-&gt;getIntSize();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> (!FT-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">getParamType</a>(1)-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(IntBits)) <span class="comment">// memchr needs &#39;int&#39;.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">unsigned</span> SizeTBits = TLI-&gt;getSizeTSize(*CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTTy = <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), SizeTBits);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                     <a class="code" href="namespacellvm.html#acaee7c149092d8a3f5c9b626030c6fa9">emitMemChr</a>(SrcStr, CharVal, <span class="comment">// include nul.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTTy, Len), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (CharC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>()) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NullPtr = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">isOnlyUsedInEqualityComparison</a>(CI, NullPtr))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="comment">// Pre-empt the transformation to strlen below and fold</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="comment">// strchr(A, &#39;\0&#39;) == null to false.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntToPtr(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getTrue(), CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// Otherwise, the character is a constant, see if the first argument is</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// a string literal.  If so, we can constant fold.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(SrcStr, Str)) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (CharC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>()) <span class="comment">// strchr(p, 0) -&gt; p + strlen(p)</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *StrLen = <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(SrcStr, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI))</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr, StrLen, <span class="stringliteral">&quot;strchr&quot;</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// Compute the offset, make sure to handle the case when we&#39;re searching for</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// zero (a weird way to spell strlen).</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = (0xFF &amp; CharC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>()) == 0</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                 ? Str.size()</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                 : Str.find(CharC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>());</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>) <span class="comment">// Didn&#39;t find the char.  strchr returns null.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">// strchr(s+n,c)  -&gt; gep(s+n+i,c)</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt64(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <span class="stringliteral">&quot;strchr&quot;</span>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrRChr(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcStr = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CharVal = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CharC = dyn_cast&lt;ConstantInt&gt;(CharVal);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(SrcStr, Str)) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// strrchr(s, 0) -&gt; strchr(s, 0)</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (CharC &amp;&amp; CharC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>())</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a0ba6a71235e219f0d87ab9f7c43476a9">emitStrChr</a>(SrcStr, <span class="charliteral">&#39;\0&#39;</span>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">unsigned</span> SizeTBits = TLI-&gt;getSizeTSize(*CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>());</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTTy = <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), SizeTBits);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Try to expand strrchr to the memrchr nonstandard extension if it&#39;s</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">// available, or simply fail otherwise.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NBytes = Str.size() + 1;   <span class="comment">// Include the terminating nul.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTTy, NBytes);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a38b79d4f932b987c3ff538cacebb106f">emitMemRChr</a>(SrcStr, CharVal, Size, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrCmp(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Str1P = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *Str2P = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (Str1P == Str2P) <span class="comment">// strcmp(x,x)  -&gt; 0</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str1, Str2;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordtype">bool</span> HasStr1 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(Str1P, Str1);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordtype">bool</span> HasStr2 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(Str2P, Str2);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// strcmp(x, y)  -&gt; cnst  (if both x and y are constant strings)</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span> (HasStr1 &amp;&amp; HasStr2)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                            std::clamp(Str1.<a class="code" href="classllvm_1_1StringRef.html#ae0c6424784f132b91eb387a3ee0b57c9">compare</a>(Str2), -1, 1));</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">if</span> (HasStr1 &amp;&amp; Str1.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()) <span class="comment">// strcmp(&quot;&quot;, x) -&gt; -*x</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateNeg(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Str2P, <span class="stringliteral">&quot;strcmpload&quot;</span>), CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">if</span> (HasStr2 &amp;&amp; Str2.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()) <span class="comment">// strcmp(x,&quot;&quot;) -&gt; *x</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Str1P, <span class="stringliteral">&quot;strcmpload&quot;</span>),</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// strcmp(P, &quot;x&quot;) -&gt; memcmp(P, &quot;x&quot;, 2)</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len1 = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Str1P);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">if</span> (Len1)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 0, Len1);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len2 = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Str2P);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">if</span> (Len2)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, Len2);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordflow">if</span> (Len1 &amp;&amp; Len2) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        *CI, <a class="code" href="namespacellvm.html#a64f1b4176cc7b8012657e7e04a687e66">emitMemCmp</a>(Str1P, Str2P,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()),</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                         <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(Len1, Len2)),</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// strcmp to memcmp</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordflow">if</span> (!HasStr1 &amp;&amp; HasStr2) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a24ff4e69025be7564b19025b93cac8d9">canTransformToMemCmp</a>(CI, Str1P, Len2, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          *CI,</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <a class="code" href="namespacellvm.html#a64f1b4176cc7b8012657e7e04a687e66">emitMemCmp</a>(Str1P, Str2P,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                     <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()), Len2),</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                     <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (HasStr1 &amp;&amp; !HasStr2) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a24ff4e69025be7564b19025b93cac8d9">canTransformToMemCmp</a>(CI, Str2P, Len1, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          *CI,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          <a class="code" href="namespacellvm.html#a64f1b4176cc7b8012657e7e04a687e66">emitMemCmp</a>(Str1P, Str2P,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                     <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()), Len1),</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                     <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, {0, 1});</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">// Optimize a memcmp or, when StrNCmp is true, strncmp call CI with constant</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">// arrays LHS and RHS and nonconstant Size.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#aee5d0f05688dce3f38e3c495744d49e8">optimizeMemCmpVarSize</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                    <a class="code" href="classllvm_1_1Value.html">Value</a> *Size, <span class="keywordtype">bool</span> StrNCmp,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                    <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrNCmp(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Str1P = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Str2P = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (Str1P == Str2P) <span class="comment">// strncmp(x,x,n)  -&gt; 0</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, {0, 1});</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// Get the length argument if it is constant.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *LengthArg = dyn_cast&lt;ConstantInt&gt;(Size))</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = LengthArg-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#aee5d0f05688dce3f38e3c495744d49e8">optimizeMemCmpVarSize</a>(CI, Str1P, Str2P, Size, <span class="keyword">true</span>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> == 0) <span class="comment">// strncmp(x,y,0)   -&gt; 0</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> == 1) <span class="comment">// strncmp(x,y,1) -&gt; memcmp(x,y,1)</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a64f1b4176cc7b8012657e7e04a687e66">emitMemCmp</a>(Str1P, Str2P, Size, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str1, Str2;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">bool</span> HasStr1 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(Str1P, Str1);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordtype">bool</span> HasStr2 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(Str2P, Str2);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// strncmp(x, y)  -&gt; cnst  (if both x and y are constant strings)</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span> (HasStr1 &amp;&amp; HasStr2) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// Avoid truncating the 64-bit Length to 32 bits in ILP32.</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> SubStr1 = <a class="code" href="SimplifyLibCalls_8cpp.html#ab845621311caa169682acb9c65516ae1">substr</a>(Str1, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> SubStr2 = <a class="code" href="SimplifyLibCalls_8cpp.html#ab845621311caa169682acb9c65516ae1">substr</a>(Str2, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                            std::clamp(SubStr1.<a class="code" href="classllvm_1_1StringRef.html#ae0c6424784f132b91eb387a3ee0b57c9">compare</a>(SubStr2), -1, 1));</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> (HasStr1 &amp;&amp; Str1.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()) <span class="comment">// strncmp(&quot;&quot;, x, n) -&gt; -*x</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateNeg(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Str2P, <span class="stringliteral">&quot;strcmpload&quot;</span>), CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (HasStr2 &amp;&amp; Str2.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()) <span class="comment">// strncmp(x, &quot;&quot;, n) -&gt; *x</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Str1P, <span class="stringliteral">&quot;strcmpload&quot;</span>),</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len1 = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Str1P);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (Len1)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 0, Len1);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len2 = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Str2P);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">if</span> (Len2)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, Len2);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">// strncmp to memcmp</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">if</span> (!HasStr1 &amp;&amp; HasStr2) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    Len2 = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(Len2, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a24ff4e69025be7564b19025b93cac8d9">canTransformToMemCmp</a>(CI, Str1P, Len2, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          *CI,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          <a class="code" href="namespacellvm.html#a64f1b4176cc7b8012657e7e04a687e66">emitMemCmp</a>(Str1P, Str2P,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                     <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()), Len2),</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                     <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (HasStr1 &amp;&amp; !HasStr2) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    Len1 = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(Len1, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a24ff4e69025be7564b19025b93cac8d9">canTransformToMemCmp</a>(CI, Str2P, Len1, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          *CI,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <a class="code" href="namespacellvm.html#a64f1b4176cc7b8012657e7e04a687e66">emitMemCmp</a>(Str1P, Str2P,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                     <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()), Len1),</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                     <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;}</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrNDup(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SrcLen = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">if</span> (SrcLen &amp;&amp; Size) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 0, SrcLen);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">if</span> (SrcLen &lt;= Size-&gt;getZExtValue() + 1)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a70223109f2fd6a814865c58a738b4925">emitStrDup</a>(Src, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">if</span> (Dst == Src) <span class="comment">// strcpy(x,x)  -&gt; x</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> Src;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, {0, 1});</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// See if we can get the length of the input string.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">if</span> (Len)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, Len);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="comment">// We have enough information to now generate the memcpy call to do the</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">// copy for us.  Make a memcpy to copy the nul byte with align = 1.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI =</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dst, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), Src, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1),</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                     <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()), Len));</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;}</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStpCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// stpcpy(d,s) -&gt; strcpy(d,s) if the result is not used.</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#ae1777b151b5f4127a3af26fa2f841a99">emitStrCpy</a>(Dst, Src, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">if</span> (Dst == Src) { <span class="comment">// stpcpy(x,x)  -&gt; x+strlen(x)</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StrLen = <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(Src, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">return</span> StrLen ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, StrLen) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// See if we can get the length of the input string.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">if</span> (Len)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, Len);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *PT = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>()-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">getParamType</a>(0);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LenV = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(PT), Len);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DstEnd = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(PT), Len - 1));</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// We have enough information to now generate the memcpy call to do the</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">// copy for us.  Make a memcpy to copy the nul byte with align = 1.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dst, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), Src, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), LenV);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">return</span> DstEnd;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">// Optimize a call to size_t strlcpy(char*, const char*, size_t).</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrLCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// Like snprintf, the function stores into the destination only when</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// the size argument is nonzero.</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// The function reads the source argument regardless of Size (it returns</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="comment">// its length).</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 1);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NBytes;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *SizeC = dyn_cast&lt;ConstantInt&gt;(Size))</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    NBytes = SizeC-&gt;<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span> (NBytes &lt;= 1) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (NBytes == 1)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="comment">// For a call to strlcpy(D, S, 1) first store a nul in *D.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8(0), Dst);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// Transform strlcpy(D, S, 0) to a call to strlen(S).</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(Src, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="comment">// Try to determine the length of the source, substituting its size</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">// when it&#39;s not nul-terminated (as it&#39;s required to be) to avoid</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// reading past its end.</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(Src, Str, <span class="comment">/*TrimAtNul=*/</span><span class="keyword">false</span>))</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SrcLen = Str.find(<span class="charliteral">&#39;\0&#39;</span>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// Set if the terminating nul should be copied by the call to memcpy</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// below.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordtype">bool</span> NulTerm = SrcLen &lt; NBytes;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">if</span> (NulTerm)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// Overwrite NBytes with the number of bytes to copy, including</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">// the terminating nul.</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    NBytes = SrcLen + 1;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">// Set the length of the source for the function to return to its</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="comment">// size, and cap NBytes at the same.</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    SrcLen = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(SrcLen, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>(Str.size()));</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    NBytes = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(NBytes - 1, SrcLen);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (SrcLen == 0) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">// Transform strlcpy(D, &quot;&quot;, N) to (*D = &#39;\0, 0).</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8(0), Dst);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *PT = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>()-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">getParamType</a>(0);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">// Transform strlcpy(D, S, N) to memcpy(D, S, N&#39;) where N&#39; is the lower</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="comment">// bound on strlen(S) + 1 and N, optionally followed by a nul store to</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="comment">// D[N&#39; - 1] if necessary.</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dst, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), Src, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1),</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                        <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(PT), NBytes));</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">if</span> (!NulTerm) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *EndOff = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), NBytes);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *EndPtr = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, EndOff);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8(0), EndPtr);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// Like snprintf, strlcpy returns the number of nonzero bytes that would</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="comment">// have been copied if the bound had been sufficiently big (which in this</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">// case is strlen(Src)).</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), SrcLen);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;}</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">// Optimize a call CI to either stpncpy when RetEnd is true, or to strncpy</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">// otherwise.</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStringNCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <span class="keywordtype">bool</span> RetEnd,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                             <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// Both st{p,r}ncpy(D, S, N) access the source and destination arrays</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// only when N is nonzero.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 1);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">// If the &quot;bound&quot; argument is known set N to it.  Otherwise set it to</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// UINT64_MAX and handle it later.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = <a class="code" href="c_2DataTypes_8h.html#a30654b4b67d97c42ca3f9b6052dda916">UINT64_MAX</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *SizeC = dyn_cast&lt;ConstantInt&gt;(Size))</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = SizeC-&gt;getZExtValue();</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> == 0)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">// Fold st{p,r}ncpy(D, S, 0) to D.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> == 1) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *CharTy = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *CharVal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(CharTy, Src, <span class="stringliteral">&quot;stxncpy.char0&quot;</span>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(CharVal, Dst);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span> (!RetEnd)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// Transform strncpy(D, S, 1) to return (*D = *S), D.</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">// Transform stpncpy(D, S, 1) to return (*D = *S) ? D + 1 : D.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ZeroChar = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CharTy, 0);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpEQ(CharVal, ZeroChar, <span class="stringliteral">&quot;stpncpy.char0cmp&quot;</span>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Off1 = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt32(1);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *EndPtr = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(CharTy, Dst, Off1, <span class="stringliteral">&quot;stpncpy.end&quot;</span>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(Cmp, Dst, EndPtr, <span class="stringliteral">&quot;stpncpy.sel&quot;</span>);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="comment">// If the length of the input string is known set SrcLen to it.</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SrcLen = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">if</span> (SrcLen)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, SrcLen);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  --SrcLen; <span class="comment">// Unbias length.</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">if</span> (SrcLen == 0) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// Transform st{p,r}ncpy(D, &quot;&quot;, N) to memset(D, &#39;\0&#39;, N) for any N.</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> MemSetAlign =</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeList.html#ada7a173c40ca7ac048a4b7099ceb71c0">getParamAttrs</a>(0).<a class="code" href="classllvm_1_1AttributeSet.html#abbebeeab2f7fc663ae61eb5c391a79db">getAlignment</a>().<a class="code" href="structllvm_1_1MaybeAlign.html#a06846474be3ab85f8d30c388faf3b116">valueOrOne</a>();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemSet(Dst, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8(<span class="charliteral">&#39;\0&#39;</span>), Size, MemSetAlign);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a> ArgAttrs(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeList.html#ada7a173c40ca7ac048a4b7099ceb71c0">getParamAttrs</a>(0));</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    NewCI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a9da3b29e8e71b9be4645874e1721207a">setAttributes</a>(NewCI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>().<a class="code" href="classllvm_1_1AttributeList.html#ae18cffa676178ae60f0692ad4410e940">addParamAttributes</a>(</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), 0, ArgAttrs));</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, NewCI);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &gt; SrcLen + 1) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &gt; 128)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="comment">// Bail if N is large or unknown.</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// st{p,r}ncpy(D, &quot;a&quot;, N) -&gt; memcpy(D, &quot;a\0\0\0&quot;, N) for N &lt;= 128.</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(Src, Str))</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    std::string SrcStr = Str.str();</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// Create a bigger, nul-padded array with the same length, SrcLen,</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// as the original string.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    SrcStr.resize(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <span class="charliteral">&#39;\0&#39;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    Src = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateGlobalString(SrcStr, <span class="stringliteral">&quot;str&quot;</span>);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *PT = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>()-&gt;<a class="code" href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">getParamType</a>(0);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">// st{p,r}ncpy(D, S, N) -&gt; memcpy(align 1 D, align 1 S, N) when both</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">// S and N are constant.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dst, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), Src, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1),</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                   <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(PT), <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>));</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">if</span> (!RetEnd)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// stpncpy(D, S, N) returns the address of the first null in D if it writes</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// one, otherwise D + N.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1IsaInfo.html#ab6e8b39aa26af871d8ede5fa8c791ee6ad15305d7a4e34e02489c74a5ef542f36">Off</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt64(<a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(SrcLen, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>));</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, Off, <span class="stringliteral">&quot;endptr&quot;</span>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStringLength(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                               <span class="keywordtype">unsigned</span> CharSize,</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                               <a class="code" href="classllvm_1_1Value.html">Value</a> *Bound) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CharTy = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntNTy(CharSize);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a1c4687f9c44e149d4893bd81b7ddce3b">isOnlyUsedInZeroEqualityComparison</a>(CI) &amp;&amp;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      (!Bound || <a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Bound, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// Fold strlen:</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">//   strlen(x) != 0 --&gt; *x != 0</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">//   strlen(x) == 0 --&gt; *x == 0</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// and likewise strnlen with constant N &gt; 0:</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">//   strnlen(x, N) != 0 --&gt; *x != 0</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">//   strnlen(x, N) == 0 --&gt; *x == 0</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(CharTy, Src, <span class="stringliteral">&quot;char0&quot;</span>),</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                        CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keywordflow">if</span> (Bound) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *BoundCst = dyn_cast&lt;ConstantInt&gt;(Bound)) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordflow">if</span> (BoundCst-&gt;isZero())</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">// Fold strnlen(s, 0) -&gt; 0 for any s, constant or otherwise.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">if</span> (BoundCst-&gt;isOne()) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="comment">// Fold strnlen(s, 1) -&gt; *s ? 1 : 0 for any s.</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *CharVal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(CharTy, Src, <span class="stringliteral">&quot;strnlen.char0&quot;</span>);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *ZeroChar = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CharTy, 0);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpNE(CharVal, ZeroChar, <span class="stringliteral">&quot;strnlen.char0cmp&quot;</span>);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(Cmp, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src, CharSize)) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LenC = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Len - 1);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// Fold strlen(&quot;xyz&quot;) -&gt; 3 and strnlen(&quot;xyz&quot;, 2) -&gt; 2</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">// and strnlen(&quot;xyz&quot;, Bound) -&gt; min(3, Bound) for nonconstant Bound.</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (Bound)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateBinaryIntrinsic(<a class="code" href="namespacellvm_1_1APIntOps.html#aa606171b17bdde9015fa656e226ca9e0">Intrinsic::umin</a>, LenC, Bound);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">return</span> LenC;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">if</span> (Bound)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">// Punt for strnlen for now.</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">// If s is a constant pointer pointing to a string literal, we can fold</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// strlen(s + x) to strlen(s) - x, when x is known to be in the range</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// [0, strlen(s)] or the string has a single null terminator &#39;\0&#39; at the end.</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">// We only try to simplify strlen when the pointer s points to an array</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// of CharSize elements. Otherwise, we would need to scale the offset x before</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// doing the subtraction. This will make the optimization more complex, and</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">// it&#39;s not very useful because calling strlen for a pointer of other types is</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">// very uncommon.</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GEPOperator.html">GEPOperator</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GEPOperator&gt;(Src)) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// TODO: Handle subobjects.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#ade8f600187cb9c664701443e796111e7">isGEPBasedOnPointerToString</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, CharSize))</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <a class="code" href="structllvm_1_1ConstantDataArraySlice.html">ConstantDataArraySlice</a> Slice;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a36b03d4697c30b32e8762cb0dfd66761">getConstantDataArrayInfo</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(0), Slice, CharSize)) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NullTermIdx;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="keywordflow">if</span> (Slice.<a class="code" href="structllvm_1_1ConstantDataArraySlice.html#ac259d8d452474b84269b58dd573ed291">Array</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        NullTermIdx = 0;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        NullTermIdx = ~((<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)0);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = Slice.<a class="code" href="structllvm_1_1ConstantDataArraySlice.html#a87f5d145b113af758f48fb50f6ea92b9">Length</a>; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;          <span class="keywordflow">if</span> (Slice.<a class="code" href="structllvm_1_1ConstantDataArraySlice.html#ac259d8d452474b84269b58dd573ed291">Array</a>-&gt;<a class="code" href="classllvm_1_1ConstantDataSequential.html#a9409db5c707242fc05b7b2abeba38506">getElementAsInteger</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> + Slice.<a class="code" href="structllvm_1_1ConstantDataArraySlice.html#aa521d739527c924cc3d0c7b40936ea45">Offset</a>) == 0) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            NullTermIdx = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;          }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="comment">// If the string does not have &#39;\0&#39;, leave it to strlen to compute</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="comment">// its length.</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">if</span> (NullTermIdx == ~((<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)0))</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(2);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <a class="code" href="structllvm_1_1KnownBits.html">KnownBits</a> Known = <a class="code" href="namespacellvm.html#aa1f8f0633edd8b9a1c5ec15bb9fc5640">computeKnownBits</a>(Offset, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, 0, <span class="keyword">nullptr</span>, CI, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ArrSize =</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;             cast&lt;ArrayType&gt;(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getSourceElementType())-&gt;getNumElements();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="comment">// If Offset is not provably in the range [0, NullTermIdx], we can still</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="comment">// optimize if we can prove that the program has undefined behavior when</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="comment">// Offset is outside that range. That is the case when GEP-&gt;getOperand(0)</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="comment">// is a pointer to an object whose memory extent is NullTermIdx+1.</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">if</span> ((Known.<a class="code" href="structllvm_1_1KnownBits.html#a157efd68e8b4b838829cad165b1583f8">isNonNegative</a>() &amp;&amp; Known.<a class="code" href="structllvm_1_1KnownBits.html#a825476b2436eb817b735fdd34ee521c4">getMaxValue</a>().<a class="code" href="classllvm_1_1APInt.html#aca14d9ec64ba4ab7fb2cef37c57d9ce4">ule</a>(NullTermIdx)) ||</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          (isa&lt;GlobalVariable&gt;(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(0)) &amp;&amp;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;           NullTermIdx == ArrSize - 1)) {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSExtOrTrunc(Offset, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSub(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), NullTermIdx),</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                           Offset);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">// strlen(x?&quot;foo&quot;:&quot;bars&quot;) --&gt; x ? 3 : 4</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SelectInst&gt;(Src)) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> LenTrue = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getTrueValue(), CharSize);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> LenFalse = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getFalseValue(), CharSize);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">if</span> (LenTrue &amp;&amp; LenFalse) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      ORE.emit([&amp;]() {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>(<span class="stringliteral">&quot;instcombine&quot;</span>, <span class="stringliteral">&quot;simplify-libcalls&quot;</span>, CI)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;folded strlen(select) to select of constants&quot;</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      });</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition(),</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                            <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), LenTrue - 1),</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                            <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), LenFalse - 1));</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;}</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrLen(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeStringLength(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, 8))</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;}</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrNLen(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Bound = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeStringLength(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, 8, Bound))</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Bound, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;}</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeWcslen(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = *CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordtype">unsigned</span> WCharSize = TLI-&gt;getWCharSize(M) * 8;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">// We cannot perform this optimization without wchar_size metadata.</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">if</span> (WCharSize == 0)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">return</span> optimizeStringLength(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, WCharSize);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;}</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrPBrk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> S1, S2;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordtype">bool</span> HasS1 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), S1);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordtype">bool</span> HasS2 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), S2);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// strpbrk(s, &quot;&quot;) -&gt; nullptr</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// strpbrk(&quot;&quot;, s) -&gt; nullptr</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">if</span> ((HasS1 &amp;&amp; S1.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()) || (HasS2 &amp;&amp; S2.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()))</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="comment">// Constant folding.</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordflow">if</span> (HasS1 &amp;&amp; HasS2) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = S1.<a class="code" href="classllvm_1_1StringRef.html#a93b15a8c0022febbe39d17ab933737a8">find_first_of</a>(S2);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>) <span class="comment">// No match.</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0),</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                               <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt64(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <span class="stringliteral">&quot;strpbrk&quot;</span>);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="comment">// strpbrk(s, &quot;a&quot;) -&gt; strchr(s, &#39;a&#39;)</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordflow">if</span> (HasS2 &amp;&amp; S2.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() == 1)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a0ba6a71235e219f0d87ab9f7c43476a9">emitStrChr</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), S2[0], <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;}</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrTo(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *EndPtr = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantPointerNull&gt;(EndPtr)) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">// With a null EndPtr, this function won&#39;t capture the main argument.</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">// It would be readonly too, except that it still may write to errno.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">addParamAttr</a>(0, Attribute::NoCapture);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;}</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrSpn(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> S1, S2;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordtype">bool</span> HasS1 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), S1);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordtype">bool</span> HasS2 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), S2);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">// strspn(s, &quot;&quot;) -&gt; 0</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// strspn(&quot;&quot;, s) -&gt; 0</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keywordflow">if</span> ((HasS1 &amp;&amp; S1.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()) || (HasS2 &amp;&amp; S2.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()))</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="comment">// Constant folding.</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordflow">if</span> (HasS1 &amp;&amp; HasS2) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordtype">size_t</span> Pos = S1.<a class="code" href="classllvm_1_1StringRef.html#ae851887270f35d2a2670a79b9833d45b">find_first_not_of</a>(S2);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">if</span> (Pos == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      Pos = S1.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Pos);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;}</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrCSpn(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> S1, S2;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordtype">bool</span> HasS1 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), S1);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="keywordtype">bool</span> HasS2 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), S2);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">// strcspn(&quot;&quot;, s) -&gt; 0</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">if</span> (HasS1 &amp;&amp; S1.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>())</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">// Constant folding.</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">if</span> (HasS1 &amp;&amp; HasS2) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordtype">size_t</span> Pos = S1.<a class="code" href="classllvm_1_1StringRef.html#a93b15a8c0022febbe39d17ab933737a8">find_first_of</a>(S2);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span> (Pos == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      Pos = S1.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>();</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Pos);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// strcspn(s, &quot;&quot;) -&gt; strlen(s)</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordflow">if</span> (HasS2 &amp;&amp; S2.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>())</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;}</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrStr(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="comment">// fold strstr(x, x) -&gt; x.</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0) == CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1))</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateBitCast(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="comment">// fold strstr(a, b) == a -&gt; strncmp(a, b, strlen(b)) == 0</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">isOnlyUsedInEqualityComparison</a>(CI, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0))) {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StrLen = <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span> (!StrLen)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StrNCmp = <a class="code" href="namespacellvm.html#a6235f3b5af61e1da8ecb017f6f909f1f">emitStrNCmp</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                 StrLen, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (!StrNCmp)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>())) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="classllvm_1_1ICmpInst.html">ICmpInst</a> *Old = cast&lt;ICmpInst&gt;(U);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> =</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmp(Old-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>(), StrNCmp,</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                       <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(StrNCmp-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), <span class="stringliteral">&quot;cmp&quot;</span>);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <a class="code" href="CodeGenPrepare_8cpp.html#a19e092ecf7889abf7277f13824e0c601">replaceAllUsesWith</a>(Old, Cmp);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">return</span> CI;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">// See if either input string is a constant string.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> SearchStr, ToFindStr;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordtype">bool</span> HasStr1 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), SearchStr);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordtype">bool</span> HasStr2 = <a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), ToFindStr);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="comment">// fold strstr(x, &quot;&quot;) -&gt; x.</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordflow">if</span> (HasStr2 &amp;&amp; ToFindStr.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>())</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateBitCast(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="comment">// If both strings are known, constant fold it.</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordflow">if</span> (HasStr1 &amp;&amp; HasStr2) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = SearchStr.<a class="code" href="classllvm_1_1StringRef.html#aab312a8386488873bac2eddfc67c22be">find</a>(ToFindStr);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">if</span> (Offset == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>) <span class="comment">// strstr(&quot;foo&quot;, &quot;bar&quot;) -&gt; null</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">// strstr(&quot;abcd&quot;, &quot;bc&quot;) -&gt; gep((char*)&quot;abcd&quot;, 1)</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = <a class="code" href="namespacellvm.html#a1f00bd493d9df4474770b08908867a69">castToCStr</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> =</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateConstInBoundsGEP1_64(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Result, Offset, <span class="stringliteral">&quot;strstr&quot;</span>);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateBitCast(Result, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">// fold strstr(x, &quot;y&quot;) -&gt; strchr(x, &#39;y&#39;).</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">if</span> (HasStr2 &amp;&amp; ToFindStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() == 1) {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StrChr = <a class="code" href="namespacellvm.html#a0ba6a71235e219f0d87ab9f7c43476a9">emitStrChr</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), ToFindStr[0], <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">return</span> StrChr ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateBitCast(StrChr, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, {0, 1});</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemRChr(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcStr = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">annotateNonNullAndDereferenceable</a>(CI, 0, Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CharVal = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *LenC = dyn_cast&lt;ConstantInt&gt;(Size);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NullPtr = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">if</span> (LenC) {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">if</span> (LenC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>())</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="comment">// Fold memrchr(x, y, 0) --&gt; null.</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">return</span> NullPtr;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span> (LenC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">isOne</a>()) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="comment">// Fold memrchr(x, y, 1) --&gt; *x == y ? x : null for any x and y,</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="comment">// constant or otherwise.</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr, <span class="stringliteral">&quot;memrchr.char0&quot;</span>);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="comment">// Slice off the character&#39;s high end bits.</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      CharVal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateTrunc(CharVal, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty());</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpEQ(Val, CharVal, <span class="stringliteral">&quot;memrchr.char0cmp&quot;</span>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(Cmp, SrcStr, NullPtr, <span class="stringliteral">&quot;memrchr.sel&quot;</span>);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(SrcStr, Str, <span class="comment">/*TrimAtNul=*/</span><span class="keyword">false</span>))</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordflow">if</span> (Str.size() == 0)</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">// If the array is empty fold memrchr(A, C, N) to null for any value</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">// of C and N on the basis that the only valid value of N is zero</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="comment">// (otherwise the call is undefined).</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">return</span> NullPtr;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOff = <a class="code" href="c_2DataTypes_8h.html#a30654b4b67d97c42ca3f9b6052dda916">UINT64_MAX</a>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordflow">if</span> (LenC) {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    EndOff = LenC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">if</span> (Str.size() &lt; EndOff)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <span class="comment">// Punt out-of-bounds accesses to sanitizers and/or libc.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CharC = dyn_cast&lt;ConstantInt&gt;(CharVal)) {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">// Fold memrchr(S, C, N) for a constant C.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordtype">size_t</span> Pos = Str.rfind(CharC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>(), EndOff);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordflow">if</span> (Pos == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="comment">// When the character is not in the source array fold the result</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="comment">// to null regardless of Size.</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="keywordflow">return</span> NullPtr;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">if</span> (LenC)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="comment">// Fold memrchr(s, c, N) --&gt; s + Pos for constant N &gt; Pos.</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt64(Pos));</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">if</span> (Str.find(Str[Pos]) == Pos) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="comment">// When there is just a single occurrence of C in S, i.e., the one</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="comment">// in Str[Pos], fold</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="comment">//   memrchr(s, c, N) --&gt; N &lt;= Pos ? null : s + Pos</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="comment">// for nonconstant N.</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpULE(Size, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>-&gt;getType(), Pos),</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                   <span class="stringliteral">&quot;memrchr.cmp&quot;</span>);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcPlus = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr,</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                           <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt64(Pos), <span class="stringliteral">&quot;memrchr.ptr_plus&quot;</span>);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(Cmp, NullPtr, SrcPlus, <span class="stringliteral">&quot;memrchr.sel&quot;</span>);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="comment">// Truncate the string to search at most EndOff characters.</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  Str = Str.substr(0, EndOff);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keywordflow">if</span> (Str.find_first_not_of(Str[0]) != <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>)</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">// If the source array consists of all equal characters, then for any</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="comment">// C and N (whether in bounds or not), fold memrchr(S, C, N) to</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="comment">//   N != 0 &amp;&amp; *S == C ? S + N - 1 : null</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTy = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>-&gt;getType();</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8Ty = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty();</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NNeZ = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpNE(Size, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTy, 0));</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="comment">// Slice off the sought character&#39;s high end bits.</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  CharVal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateTrunc(CharVal, Int8Ty);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CEqS0 = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpEQ(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Int8Ty, Str[0]), CharVal);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eac33315685a0cba3ce53be378b3c7874b">And</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLogicalAnd(NNeZ, CEqS0);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SizeM1 = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSub(Size, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTy, 1));</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcPlus =</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(Int8Ty, SrcStr, SizeM1, <span class="stringliteral">&quot;memrchr.ptr_plus&quot;</span>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(And, SrcPlus, NullPtr, <span class="stringliteral">&quot;memrchr.sel&quot;</span>);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemChr(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcStr = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">isOnlyUsedInEqualityComparison</a>(CI, SrcStr))</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a4471d0813af2c29201b8c3191e146370">memChrToCharCompare</a>(CI, Size, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CharVal = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CharC = dyn_cast&lt;ConstantInt&gt;(CharVal);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *LenC = dyn_cast&lt;ConstantInt&gt;(Size);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NullPtr = <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">// memchr(x, y, 0) -&gt; null</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordflow">if</span> (LenC) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">if</span> (LenC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">isZero</a>())</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="keywordflow">return</span> NullPtr;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">if</span> (LenC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">isOne</a>()) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="comment">// Fold memchr(x, y, 1) --&gt; *x == y ? x : null for any x and y,</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="comment">// constant or otherwise.</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr, <span class="stringliteral">&quot;memchr.char0&quot;</span>);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <span class="comment">// Slice off the character&#39;s high end bits.</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      CharVal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateTrunc(CharVal, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty());</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpEQ(Val, CharVal, <span class="stringliteral">&quot;memchr.char0cmp&quot;</span>);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(Cmp, SrcStr, NullPtr, <span class="stringliteral">&quot;memchr.sel&quot;</span>);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(SrcStr, Str, <span class="comment">/*TrimAtNul=*/</span><span class="keyword">false</span>))</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">if</span> (CharC) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordtype">size_t</span> Pos = Str.find(CharC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>());</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">if</span> (Pos == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>)</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="comment">// When the character is not in the source array fold the result</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="comment">// to null regardless of Size.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">return</span> NullPtr;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">// Fold memchr(s, c, n) -&gt; n &lt;= Pos ? null : s + Pos</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">// When the constant Size is less than or equal to the character</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">// position also fold the result to null.</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpULE(Size, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>-&gt;getType(), Pos),</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                 <span class="stringliteral">&quot;memchr.cmp&quot;</span>);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcPlus = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt64(Pos),</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                         <span class="stringliteral">&quot;memchr.ptr&quot;</span>);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(Cmp, NullPtr, SrcPlus);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">if</span> (Str.size() == 0)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">// If the array is empty fold memchr(A, C, N) to null for any value</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">// of C and N on the basis that the only valid value of N is zero</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">// (otherwise the call is undefined).</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordflow">return</span> NullPtr;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">if</span> (LenC)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    Str = <a class="code" href="SimplifyLibCalls_8cpp.html#ab845621311caa169682acb9c65516ae1">substr</a>(Str, LenC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>());</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="keywordtype">size_t</span> Pos = Str.find_first_not_of(Str[0]);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keywordflow">if</span> (Pos == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      || Str.find_first_not_of(Str[Pos], Pos) == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// If the source array consists of at most two consecutive sequences</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// of the same characters, then for any C and N (whether in bounds or</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">// not), fold memchr(S, C, N) to</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="comment">//   N != 0 &amp;&amp; *S == C ? S : null</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">// or for the two sequences to:</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">//   N != 0 &amp;&amp; *S == C ? S : (N &gt; Pos &amp;&amp; S[Pos] == C ? S + Pos : null)</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">//   ^Sel2                   ^Sel1 are denoted above.</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">// The latter makes it also possible to fold strchr() calls with strings</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// of the same characters.</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTy = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>-&gt;getType();</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8Ty = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty();</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="comment">// Slice off the sought character&#39;s high end bits.</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    CharVal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateTrunc(CharVal, Int8Ty);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Sel1 = NullPtr;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">if</span> (Pos != <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="comment">// Handle two consecutive sequences of the same characters.</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *PosVal = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTy, Pos);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StrPos = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Int8Ty, Str[Pos]);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *CEqSPos = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpEQ(CharVal, StrPos);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NGtPos = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmp(<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba607cecdc5172814382033e001ed11fad">ICmpInst::ICMP_UGT</a>, Size, PosVal);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eac33315685a0cba3ce53be378b3c7874b">And</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateAnd(CEqSPos, NGtPos);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcPlus = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), SrcStr, PosVal);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      Sel1 = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(And, SrcPlus, NullPtr, <span class="stringliteral">&quot;memchr.sel1&quot;</span>);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Str0 = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Int8Ty, Str[0]);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *CEqS0 = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpEQ(Str0, CharVal);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NNeZ = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpNE(Size, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTy, 0));</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eac33315685a0cba3ce53be378b3c7874b">And</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateAnd(NNeZ, CEqS0);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(And, SrcStr, Sel1, <span class="stringliteral">&quot;memchr.sel2&quot;</span>);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">if</span> (!LenC) {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">isOnlyUsedInEqualityComparison</a>(CI, SrcStr))</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="comment">// S is dereferenceable so it&#39;s safe to load from it and fold</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="comment">//   memchr(S, C, N) == S to N &amp;&amp; *S == C for any C and N.</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="comment">// TODO: This is safe even even for nonconstant S.</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a4471d0813af2c29201b8c3191e146370">memChrToCharCompare</a>(CI, Size, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="comment">// From now on we need a constant length and constant array.</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="comment">// If the char is variable but the input str and length are not we can turn</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="comment">// this memchr call into a simple bit field test. Of course this only works</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="comment">// when the return value is only checked against null.</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">// It would be really nice to reuse switch lowering here but we can&#39;t change</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="comment">// the CFG at this point.</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// memchr(&quot;\r\n&quot;, C, 2) != nullptr -&gt; (1 &lt;&lt; C &amp; ((1 &lt;&lt; &#39;\r&#39;) | (1 &lt;&lt; &#39;\n&#39;)))</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="comment">// != 0</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="comment">//   after bounds check.</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">if</span> (Str.empty() || !<a class="code" href="namespacellvm.html#a1c4687f9c44e149d4893bd81b7ddce3b">isOnlyUsedInZeroEqualityComparison</a>(CI))</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1pdb.html#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> =</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      *std::max_element(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(Str.begin()),</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                        <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(Str.end()));</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="comment">// Make sure the bit field we&#39;re about to create fits in a register on the</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="comment">// target.</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="comment">// FIXME: On a 64 bit architecture this prevents us from using the</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="comment">// interesting range of alpha ascii chars. We could do better by emitting</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">// two bitfields or shifting the range by 64 if no lower chars are used.</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.fitsInLegalInteger(Max + 1))</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <span class="comment">// For the bit field use a power-of-2 type with at least 8 bits to avoid</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="comment">// creating unnecessary illegal types.</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> = <a class="code" href="namespacellvm.html#afb65eef479f0473d0fe1666b80155237">NextPowerOf2</a>(<a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)7, Max));</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="comment">// Now build the bit field.</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="structllvm_1_1Bitfield.html">Bitfield</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>, 0);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">char</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> : Str)</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <a class="code" href="structllvm_1_1Bitfield.html">Bitfield</a>.setBit((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *BitfieldC = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt(<a class="code" href="structllvm_1_1Bitfield.html">Bitfield</a>);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <span class="comment">// Adjust width of &quot;C&quot; to the bitfield width, then mask off the high bits.</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExtOrTrunc(CharVal, BitfieldC-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateAnd(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntN(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>, 0xFF));</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="comment">// First check that the bit field access is within bounds.</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Bounds = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmp(<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP_ULT</a>, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntN(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>),</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                               <span class="stringliteral">&quot;memchr.bounds&quot;</span>);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="comment">// Create code that checks if the given bit is set in the field.</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Shl = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateShl(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntN(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>, 1ULL), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a3c0710aa6b054662f67b480712fa2b95">Bits</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIsNotNull(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateAnd(Shl, BitfieldC), <span class="stringliteral">&quot;memchr.bits&quot;</span>);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="comment">// Finally merge both checks and cast to pointer type. The inttoptr</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="comment">// implicitly zexts the i1 to intptr type.</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntToPtr(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLogicalAnd(Bounds, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a3c0710aa6b054662f67b480712fa2b95">Bits</a>, <span class="stringliteral">&quot;memchr&quot;</span>),</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                          CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;}</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">// Optimize a memcmp or, when StrNCmp is true, strncmp call CI with constant</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">// arrays LHS and RHS and nonconstant Size.</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#aee5d0f05688dce3f38e3c495744d49e8"> 1416</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#aee5d0f05688dce3f38e3c495744d49e8">optimizeMemCmpVarSize</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                                    <a class="code" href="classllvm_1_1Value.html">Value</a> *Size, <span class="keywordtype">bool</span> StrNCmp,</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                                    <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) <span class="comment">// memcmp(s,s,x) -&gt; 0</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> LStr, RStr;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, LStr, <span class="comment">/*TrimAtNul=*/</span><span class="keyword">false</span>) ||</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      !<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, RStr, <span class="comment">/*TrimAtNul=*/</span><span class="keyword">false</span>))</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="comment">// If the contents of both constant arrays are known, fold a call to</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="comment">// memcmp(A, B, N) to</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="comment">//   N &lt;= Pos ? 0 : (A &lt; B ? -1 : B &lt; A ? +1 : 0)</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="comment">// where Pos is the first mismatch between A and B, determined below.</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Pos = 0;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Zero = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MinSize = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(LStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>(), RStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>()); ; ++Pos) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">if</span> (Pos == MinSize ||</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        (StrNCmp &amp;&amp; (LStr[Pos] == <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; RStr[Pos] == <span class="charliteral">&#39;\0&#39;</span>))) {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="comment">// One array is a leading part of the other of equal or greater</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="comment">// size, or for strncmp, the arrays are equal strings.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <span class="comment">// Fold the result to zero.  Size is assumed to be in bounds, since</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="comment">// otherwise the call would be undefined.</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="keywordflow">return</span> Zero;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span> (LStr[Pos] != RStr[Pos])</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="comment">// Normalize the result.</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> UChar;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordtype">int</span> IRes = UChar(LStr[Pos]) &lt; UChar(RStr[Pos]) ? -1 : 1;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *MaxSize = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Size-&gt;getType(), Pos);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Cmp = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmp(<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bad92f160316221fd4090520bb2b3cefc5">ICmpInst::ICMP_ULE</a>, Size, MaxSize);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), IRes);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(Cmp, Zero, Res);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;}</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">// Optimize a memcmp call CI with constant size Len.</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a2e6d43b46806f4a27f61ae2fd14c0f69"> 1458</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a2e6d43b46806f4a27f61ae2fd14c0f69">optimizeMemCmpConstantSize</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                                         <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Len, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="keywordflow">if</span> (Len == 0) <span class="comment">// memcmp(s1,s2,0) -&gt; 0</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="comment">// memcmp(S1,S2,1) -&gt; *(unsigned char*)LHS - *(unsigned char*)RHS</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="keywordflow">if</span> (Len == 1) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LHSV =</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <a class="code" href="namespacellvm.html#a1f00bd493d9df4474770b08908867a69">castToCStr</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>), <span class="stringliteral">&quot;lhsc&quot;</span>),</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                     CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <span class="stringliteral">&quot;lhsv&quot;</span>);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *RHSV =</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <a class="code" href="namespacellvm.html#a1f00bd493d9df4474770b08908867a69">castToCStr</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>), <span class="stringliteral">&quot;rhsc&quot;</span>),</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                     CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <span class="stringliteral">&quot;rhsv&quot;</span>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSub(LHSV, RHSV, <span class="stringliteral">&quot;chardiff&quot;</span>);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="comment">// memcmp(S1,S2,N/8)==0 -&gt; (*(intN_t*)S1 != *(intN_t*)S2)==0</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">// TODO: The case where both inputs are constants does not need to be limited</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="comment">// to legal integers or equality comparison. See block below this.</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isLegalInteger(Len * 8) &amp;&amp; <a class="code" href="namespacellvm.html#a1c4687f9c44e149d4893bd81b7ddce3b">isOnlyUsedInZeroEqualityComparison</a>(CI)) {</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *IntType = <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), Len * 8);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> PrefAlignment = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPrefTypeAlign(IntType);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">// First, see if we can fold either argument to a constant.</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LHSV = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LHSC = dyn_cast&lt;Constant&gt;(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      LHSC = <a class="code" href="classllvm_1_1ConstantExpr.html#ae79d05dd3d0b05e080e08f8c5c33f880">ConstantExpr::getBitCast</a>(LHSC, IntType-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>());</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      LHSV = <a class="code" href="namespacellvm.html#ad95650d790f6f9d252cf0cd0e0094368">ConstantFoldLoadFromConstPtr</a>(LHSC, IntType, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *RHSV = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *RHSC = dyn_cast&lt;Constant&gt;(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)) {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      RHSC = <a class="code" href="classllvm_1_1ConstantExpr.html#ae79d05dd3d0b05e080e08f8c5c33f880">ConstantExpr::getBitCast</a>(RHSC, IntType-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>());</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      RHSV = <a class="code" href="namespacellvm.html#ad95650d790f6f9d252cf0cd0e0094368">ConstantFoldLoadFromConstPtr</a>(RHSC, IntType, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="comment">// Don&#39;t generate unaligned loads. If either source is constant data,</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// alignment doesn&#39;t matter for that source because there is no load.</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> ((LHSV || <a class="code" href="namespacellvm.html#a607b7fac55adc5ea9ed40a78e48a5b00">getKnownAlignment</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CI) &gt;= PrefAlignment) &amp;&amp;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        (RHSV || <a class="code" href="namespacellvm.html#a607b7fac55adc5ea9ed40a78e48a5b00">getKnownAlignment</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CI) &gt;= PrefAlignment)) {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keywordflow">if</span> (!LHSV) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *LHSPtrTy =</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            IntType-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>());</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        LHSV = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(IntType, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateBitCast(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, LHSPtrTy), <span class="stringliteral">&quot;lhsv&quot;</span>);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordflow">if</span> (!RHSV) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *RHSPtrTy =</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            IntType-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>());</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        RHSV = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(IntType, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateBitCast(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, RHSPtrTy), <span class="stringliteral">&quot;rhsv&quot;</span>);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpNE(LHSV, RHSV), CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <span class="stringliteral">&quot;memcmp&quot;</span>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;}</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">// Most simplifications for memcmp also apply to bcmp.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemCmpBCmpCommon(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                                                   <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">annotateNonNullAndDereferenceable</a>(CI, {0, 1}, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Res = <a class="code" href="SimplifyLibCalls_8cpp.html#aee5d0f05688dce3f38e3c495744d49e8">optimizeMemCmpVarSize</a>(CI, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, Size, <span class="keyword">false</span>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">return</span> Res;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="comment">// Handle constant Size.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *LenC = dyn_cast&lt;ConstantInt&gt;(Size);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordflow">if</span> (!LenC)</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a2e6d43b46806f4a27f61ae2fd14c0f69">optimizeMemCmpConstantSize</a>(CI, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, LenC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;}</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemCmp(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeMemCmpBCmpCommon(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>))</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <span class="comment">// memcmp(x, y, Len) == 0 -&gt; bcmp(x, y, Len) == 0</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="comment">// bcmp can be more efficient than memcmp because it only has to know that</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">// there is a difference, not how different one is to the other.</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_bcmp) &amp;&amp;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <a class="code" href="namespacellvm.html#a1c4687f9c44e149d4893bd81b7ddce3b">isOnlyUsedInZeroEqualityComparison</a>(CI)) {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a7e2b6aee30057f25f3a9537ff74775a8">emitBCmp</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, Size, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;}</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeBCmp(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="keywordflow">return</span> optimizeMemCmpBCmpCommon(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;}</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">annotateNonNullAndDereferenceable</a>(CI, {0, 1}, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">if</span> (isa&lt;IntrinsicInst&gt;(CI))</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">// memcpy(x, y, n) -&gt; llvm.memcpy(align 1 x, align 1 y, n)</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="structllvm_1_1Align.html">Align</a>(1),</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                                   CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), Size);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;}</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemCCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *StopChar = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3));</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> SrcStr;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>() &amp;&amp; Dst == Src)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">return</span> Dst;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="comment">// memccpy(d, s, c, 0) -&gt; nullptr</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>) {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;isNullValue())</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(Src, SrcStr, <span class="comment">/*TrimAtNul=*/</span><span class="keyword">false</span>) ||</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="comment">// TODO: Handle zeroinitializer.</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        !StopChar)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="comment">// Wrap arg &#39;c&#39; of type int to char</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="keywordtype">size_t</span> Pos = SrcStr.<a class="code" href="classllvm_1_1StringRef.html#aab312a8386488873bac2eddfc67c22be">find</a>(StopChar-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>() &amp; 0xFF);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordflow">if</span> (Pos == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getZExtValue() &lt;= SrcStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>()) {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dst, <a class="code" href="structllvm_1_1Align.html">Align</a>(1), Src, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1),</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                    CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3)));</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewN =</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getType(), <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>(Pos + 1), <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getZExtValue()));</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="comment">// memccpy -&gt; llvm.memcpy</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dst, <a class="code" href="structllvm_1_1Align.html">Align</a>(1), Src, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), NewN));</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordflow">return</span> Pos + 1 &lt;= <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getZExtValue()</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;             ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, NewN)</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;             : <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;}</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemPCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="comment">// mempcpy(x, y, n) -&gt; llvm.memcpy(align 1 x, align 1 y, n), x + n</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI =</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dst, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="comment">// Propagate attributes, but memcpy has no return value, so make sure that</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="comment">// any return attributes are compliant.</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="comment">// TODO: Attach return value attributes to the 1st operand to preserve them?</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;}</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemMove(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">annotateNonNullAndDereferenceable</a>(CI, {0, 1}, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordflow">if</span> (isa&lt;IntrinsicInst&gt;(CI))</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="comment">// memmove(x, y, n) -&gt; llvm.memmove(align 1 x, align 1 y, n)</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemMove(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="structllvm_1_1Align.html">Align</a>(1),</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                                    CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), Size);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;}</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeMemSet(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">annotateNonNullAndDereferenceable</a>(CI, 0, Size, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="keywordflow">if</span> (isa&lt;IntrinsicInst&gt;(CI))</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="comment">// memset(p, v, n) -&gt; llvm.memset(align 1 p, v, n)</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemSet(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), Val, Size, <a class="code" href="structllvm_1_1Align.html">Align</a>(1));</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;}</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeRealloc(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantPointerNull&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0)))</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#ac76c99e44c5f3570a3666c9234caf222">emitMalloc</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160; </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;}</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">// Math Library Optimizations</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">// Replace a libcall \p CI with a call to intrinsic \p IID</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8"> 1661</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                               <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IID) {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="comment">// Propagate fast-math flags from the existing call to the new call.</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9a167f91db810097d281b1ed627f4575">getFastMathFlags</a>());</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, IID, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCall = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, V);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  NewCall-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(CI);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, NewCall);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">/// Return a variant of Val with float type.</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">/// Currently this works in two cases: If Val is an FPExtension of a float</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">/// value to something bigger, simply return the operand.</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">/// If Val is a ConstantFP but can be converted to a float ConstantFP without</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">/// loss of precision do so.</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#ab4cd2984c6254a6d8bd4d05d2d6fddde"> 1680</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#ab4cd2984c6254a6d8bd4d05d2d6fddde">valueHasFloatPrecision</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Val) {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1FPExtInst.html">FPExtInst</a> *Cast = dyn_cast&lt;FPExtInst&gt;(Val)) {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = Cast-&gt;getOperand(0);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()-&gt;isFloatTy())</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  }</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *Const = dyn_cast&lt;ConstantFP&gt;(Val)) {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = Const-&gt;getValueAPF();</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordtype">bool</span> losesInfo;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    (void)<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.convert(<a class="code" href="structllvm_1_1APFloatBase.html#a0c5765e9acba977f6e462c2917276d8f">APFloat::IEEEsingle</a>(), <a class="code" href="structllvm_1_1APFloatBase.html#a22ed74f1ed33c4d33f524a650ea536a6">APFloat::rmNearestTiesToEven</a>,</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                    &amp;losesInfo);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">if</span> (!losesInfo)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Const-&gt;getContext(), <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;}</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">/// Shrink double -&gt; float functions.</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a753c7e658af5b364f756cb18b620e3c5"> 1698</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a753c7e658af5b364f756cb18b620e3c5">optimizeDoubleFP</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                               <span class="keywordtype">bool</span> <a class="code" href="PPCReduceCRLogicals_8cpp.html#a2f97198e249f3b493a0abed59c1de605">isBinary</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI,</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                               <span class="keywordtype">bool</span> isPrecise = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *CalleeFn = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">isDoubleTy</a>() || !CalleeFn)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="comment">// If not all the uses of the function are converted to float, then bail out.</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="comment">// This matters if the precision of the result is more important than the</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="comment">// precision of the arguments.</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">if</span> (isPrecise)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <a class="code" href="classllvm_1_1FPTruncInst.html">FPTruncInst</a> *Cast = dyn_cast&lt;FPTruncInst&gt;(U);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="keywordflow">if</span> (!Cast || !Cast-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">isFloatTy</a>())</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="comment">// If this is something like &#39;g((double) float)&#39;, convert to &#39;gf(float)&#39;.</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V[2];</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  V[0] = <a class="code" href="SimplifyLibCalls_8cpp.html#ab4cd2984c6254a6d8bd4d05d2d6fddde">valueHasFloatPrecision</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  V[1] = <a class="code" href="PPCReduceCRLogicals_8cpp.html#a2f97198e249f3b493a0abed59c1de605">isBinary</a> ? <a class="code" href="SimplifyLibCalls_8cpp.html#ab4cd2984c6254a6d8bd4d05d2d6fddde">valueHasFloatPrecision</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1)) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keywordflow">if</span> (!V[0] || (<a class="code" href="PPCReduceCRLogicals_8cpp.html#a2f97198e249f3b493a0abed59c1de605">isBinary</a> &amp;&amp; !V[1]))</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="comment">// If call isn&#39;t an intrinsic, check that it isn&#39;t within a function with the</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="comment">// same name as the float version of this call, otherwise the result is an</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="comment">// infinite loop.  For example, from MinGW-w64:</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="comment">// float expf(float val) { return (float) exp((double) val); }</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> CalleeName = CalleeFn-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="keywordtype">bool</span> IsIntrinsic = CalleeFn-&gt;<a class="code" href="classllvm_1_1Function.html#a900a32da3983469187b1848189681705">isIntrinsic</a>();</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">if</span> (!IsIntrinsic) {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> CallerName = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordflow">if</span> (!CallerName.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>() &amp;&amp; CallerName.<a class="code" href="classllvm_1_1StringRef.html#a5b6faabb08339ea1dd11e9d37a668634">back</a>() == <span class="charliteral">&#39;f&#39;</span> &amp;&amp;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        CallerName.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() == (CalleeName.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() + 1) &amp;&amp;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        CallerName.<a class="code" href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">startswith</a>(CalleeName))</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <span class="comment">// Propagate the math semantics from the current function to the new function.</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9a167f91db810097d281b1ed627f4575">getFastMathFlags</a>());</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="comment">// g((double) float) -&gt; (double) gf(float)</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *R;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="keywordflow">if</span> (IsIntrinsic) {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IID = CalleeFn-&gt;<a class="code" href="classllvm_1_1Function.html#a4d0a7baab8d078065b2de10e3460892a">getIntrinsicID</a>();</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *Fn = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, IID, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getFloatTy());</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    R = <a class="code" href="PPCReduceCRLogicals_8cpp.html#a2f97198e249f3b493a0abed59c1de605">isBinary</a> ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(Fn, V) : <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(Fn, V[0]);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> CalleeAttrs = CalleeFn-&gt;<a class="code" href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">getAttributes</a>();</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    R = <a class="code" href="PPCReduceCRLogicals_8cpp.html#a2f97198e249f3b493a0abed59c1de605">isBinary</a> ? <a class="code" href="namespacellvm.html#a656b9d85656ae6dd73f482f6d5639b97">emitBinaryFloatFnCall</a>(V[0], V[1], TLI, CalleeName, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                                         CalleeAttrs)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                 : <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(V[0], TLI, CalleeName, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, CalleeAttrs);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  }</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFPExt(R, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getDoubleTy());</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;}</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">/// Shrink double -&gt; float for unary functions.</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3"> 1758</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3">optimizeUnaryDoubleFP</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI,</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                                    <span class="keywordtype">bool</span> isPrecise = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a753c7e658af5b364f756cb18b620e3c5">optimizeDoubleFP</a>(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <span class="keyword">false</span>, TLI, isPrecise);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;}</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment">/// Shrink double -&gt; float for binary functions.</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a4826c8503f42d50634e8fdce6e756be1"> 1765</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a4826c8503f42d50634e8fdce6e756be1">optimizeBinaryDoubleFP</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI,</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                                     <span class="keywordtype">bool</span> isPrecise = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a753c7e658af5b364f756cb18b620e3c5">optimizeDoubleFP</a>(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <span class="keyword">true</span>, TLI, isPrecise);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;}</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">// cabs(z) -&gt; sqrt((creal(z)*creal(z)) + (cimag(z)*cimag(z)))</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeCAbs(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">isFast</a>())</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="comment">// Propagate fast-math flags from the existing call to new instructions.</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9a167f91db810097d281b1ed627f4575">getFastMathFlags</a>());</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; </div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Real, *Imag;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() == 1) {</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()-&gt;isArrayTy() &amp;&amp; <span class="stringliteral">&quot;Unexpected signature for cabs!&quot;</span>);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    Real = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateExtractValue(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, 0, <span class="stringliteral">&quot;real&quot;</span>);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    Imag = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateExtractValue(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, 1, <span class="stringliteral">&quot;imag&quot;</span>);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() == 2 &amp;&amp; <span class="stringliteral">&quot;Unexpected signature for cabs!&quot;</span>);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    Real = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    Imag = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RealReal = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(Real, Real);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ImagImag = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(Imag, Imag);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *FSqrt = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>(), Intrinsic::sqrt,</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                              CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      *CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(FSqrt, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFAdd(RealReal, ImagImag), <span class="stringliteral">&quot;cabs&quot;</span>));</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;}</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#af91095dff7bacd615e3add3634f489ea"> 1801</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#af91095dff7bacd615e3add3634f489ea">optimizeTrigReflections</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Call, <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> Func,</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;FPMathOperator&gt;(Call))</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(Call-&gt;getFastMathFlags());</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="comment">// TODO: Can this be shared to also handle LLVM intrinsics?</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">switch</span> (Func) {</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="keywordflow">case</span> LibFunc_sin:</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="keywordflow">case</span> LibFunc_sinf:</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="keywordflow">case</span> LibFunc_sinl:</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="keywordflow">case</span> LibFunc_tan:</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keywordflow">case</span> LibFunc_tanf:</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordflow">case</span> LibFunc_tanl:</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="comment">// sin(-X) --&gt; -sin(X)</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">// tan(-X) --&gt; -tan(X)</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Call-&gt;getArgOperand(0), <a class="code" href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">m_OneUse</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#af431ec215bba8bb9c56e7541d99920f2">m_FNeg</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>)))))</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFNeg(</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;          <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Call, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(Call-&gt;getCalledFunction(), <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>)));</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keywordflow">case</span> LibFunc_cos:</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="keywordflow">case</span> LibFunc_cosf:</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="keywordflow">case</span> LibFunc_cosl:</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// cos(-X) --&gt; cos(X)</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Call-&gt;getArgOperand(0), <a class="code" href="namespacellvm_1_1PatternMatch.html#af431ec215bba8bb9c56e7541d99920f2">m_FNeg</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>))))</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Call,</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                       <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(Call-&gt;getCalledFunction(), <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <span class="stringliteral">&quot;cos&quot;</span>));</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;}</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">// Return a properly extended integer (DstWidth bits wide) if the operation is</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">// an itofp.</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a80f54c2de948fe93fbb7acbf7c8bcee5"> 1840</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a80f54c2de948fe93fbb7acbf7c8bcee5">getIntToFPVal</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *I2F, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <span class="keywordtype">unsigned</span> DstWidth) {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">if</span> (isa&lt;SIToFPInst&gt;(I2F) || isa&lt;UIToFPInst&gt;(I2F)) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = cast&lt;Instruction&gt;(I2F)-&gt;getOperand(0);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">// Make sure that the exponent fits inside an &quot;int&quot; of size DstWidth,</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">// thus avoiding any range issues that FP has not.</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()-&gt;getPrimitiveSizeInBits();</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> &lt; DstWidth ||</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        (<a class="code" href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> == DstWidth &amp;&amp; isa&lt;SIToFPInst&gt;(I2F)))</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      <span class="keywordflow">return</span> isa&lt;SIToFPInst&gt;(I2F) ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSExt(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntNTy(DstWidth))</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                                  : <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntNTy(DstWidth));</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;}</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment">/// Use exp{,2}(x * y) for pow(exp{,2}(x), y);</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment">/// ldexp(1.0, x) for pow(2.0, itofp(x)); exp2(n * x) for pow(2.0 ** n, x);</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">/// exp10(x) for pow(10.0, x); exp2(log2(n) * x) for pow(n, x).</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::replacePowWithExp(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Pow, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *Expo = Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="PassBuilderBindings_8cpp.html#a76adb4549f349676de0a703a497ca5a5">Mod</a> = Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Pow-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <span class="keywordtype">bool</span> Ignored;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160; </div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="comment">// Evaluate special cases related to a nested function as the base.</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="comment">// pow(exp(x), y) -&gt; exp(x * y)</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <span class="comment">// pow(exp2(x), y) -&gt; exp2(x * y)</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="comment">// If exp{,2}() is used only once, it is better to fold two transcendental</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <span class="comment">// math functions into one.  If used again, exp{,2}() would still have to be</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="comment">// called with the original argument, then keep both original transcendental</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="comment">// functions.  However, this transformation is only safe with fully relaxed</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <span class="comment">// math semantics, since, besides rounding differences, it changes overflow</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="comment">// and underflow behavior quite dramatically.  For example:</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="comment">//   pow(exp(1000), 0.001) = pow(inf, 0.001) = inf</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="comment">// Whereas:</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="comment">//   exp(1000 * 0.001) = exp(1)</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="comment">// TODO: Loosen the requirement for fully relaxed math semantics.</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="comment">// TODO: Handle exp10() when more targets have it available.</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *BaseFn = dyn_cast&lt;CallInst&gt;(Base);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keywordflow">if</span> (BaseFn &amp;&amp; BaseFn-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() &amp;&amp; BaseFn-&gt;<a class="code" href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">isFast</a>() &amp;&amp; Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">isFast</a>()) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> LibFn;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *CalleeFn = BaseFn-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">if</span> (CalleeFn &amp;&amp; TLI-&gt;getLibFunc(CalleeFn-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>(), LibFn) &amp;&amp;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFn)) {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> ExpName;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *ExpFn;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> LibFnFloat, LibFnDouble, LibFnLongDouble;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keywordflow">switch</span> (LibFn) {</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="keywordflow">case</span> LibFunc_expf:</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">case</span> LibFunc_exp:</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">case</span> LibFunc_expl:</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        ExpName = TLI-&gt;getName(LibFunc_exp);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a> = Intrinsic::exp;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        LibFnFloat = LibFunc_expf;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        LibFnDouble = LibFunc_exp;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        LibFnLongDouble = LibFunc_expl;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">case</span> LibFunc_exp2f:</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keywordflow">case</span> LibFunc_exp2:</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordflow">case</span> LibFunc_exp2l:</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        ExpName = TLI-&gt;getName(LibFunc_exp2);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a> = Intrinsic::exp2;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        LibFnFloat = LibFunc_exp2f;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        LibFnDouble = LibFunc_exp2;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        LibFnLongDouble = LibFunc_exp2l;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="comment">// Create new exp{,2}() with the product as its argument.</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eab48b2a9934af7a531cfd7236ded9d50e">FMul</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(BaseFn-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), Expo, <span class="stringliteral">&quot;mul&quot;</span>);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      ExpFn = BaseFn-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>()</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;              ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(Mod, <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>, Ty),</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                             FMul, ExpName)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;              : <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(FMul, TLI, LibFnDouble, LibFnFloat,</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                                     LibFnLongDouble, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                     BaseFn-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>());</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="comment">// Since the new exp{,2}() is different from the original one, dead code</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <span class="comment">// elimination cannot be trusted to remove it, since it may have side</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <span class="comment">// effects (e.g., errno).  When the only consumer for the original</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <span class="comment">// exp{,2}() is pow(), then it has to be explicitly erased.</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      substituteInParent(BaseFn, ExpFn);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keywordflow">return</span> ExpFn;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  }</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="comment">// Evaluate special cases related to a constant base.</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> *BaseF;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="namespacellvm_1_1PatternMatch.html#acd794d7b3653822f61ba126e1678e03f">m_APFloat</a>(BaseF)))</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; </div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> NoAttrs; <span class="comment">// Attributes are only meaningful on the original call</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="comment">// pow(2.0, itofp(x)) -&gt; ldexp(1.0, x)</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="comment">// TODO: This does not work for vectors because there is no ldexp intrinsic.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordflow">if</span> (!Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>() &amp;&amp; <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Base, <a class="code" href="namespacellvm_1_1PatternMatch.html#a43117391a6d351518362783bff747d44">m_SpecificFP</a>(2.0)) &amp;&amp;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      (isa&lt;SIToFPInst&gt;(Expo) || isa&lt;UIToFPInst&gt;(Expo)) &amp;&amp;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <a class="code" href="namespacellvm.html#a48857a8252dd37eb41884773de34738f">hasFloatFn</a>(M, TLI, Ty, LibFunc_ldexp, LibFunc_ldexpf, LibFunc_ldexpl)) {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *ExpoI = <a class="code" href="SimplifyLibCalls_8cpp.html#a80f54c2de948fe93fbb7acbf7c8bcee5">getIntToFPVal</a>(Expo, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI-&gt;getIntSize()))</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow,</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                       <a class="code" href="namespacellvm.html#a656b9d85656ae6dd73f482f6d5639b97">emitBinaryFloatFnCall</a>(<a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, 1.0), ExpoI,</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                                             TLI, LibFunc_ldexp, LibFunc_ldexpf,</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                                             LibFunc_ldexpl, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, NoAttrs));</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  }</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160; </div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="comment">// pow(2.0 ** n, x) -&gt; exp2(n * x)</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a48857a8252dd37eb41884773de34738f">hasFloatFn</a>(M, TLI, Ty, LibFunc_exp2, LibFunc_exp2f, LibFunc_exp2l)) {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> BaseR = <a class="code" href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a56697632782c9ab774d6c132a955674a">APFloat</a>(1.0);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    BaseR.<a class="code" href="classllvm_1_1APFloat.html#a257e3cb529defa79ad7a9f42072f339a">convert</a>(BaseF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a037ff294d9d370e29651cbc99442a575">getSemantics</a>(), <a class="code" href="structllvm_1_1APFloatBase.html#a482d9cf95b588eb05cefeaa5c05be9a3">APFloat::rmTowardZero</a>, &amp;Ignored);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    BaseR = BaseR / *BaseF;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordtype">bool</span> IsInteger = BaseF-&gt;<a class="code" href="classllvm_1_1APFloat.html#ace4517dbbab7dbdefa0d31e29db55969">isInteger</a>(), IsReciprocal = BaseR.<a class="code" href="classllvm_1_1APFloat.html#ace4517dbbab7dbdefa0d31e29db55969">isInteger</a>();</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> *NF = IsReciprocal ? &amp;BaseR : BaseF;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <a class="code" href="classllvm_1_1APSInt.html">APSInt</a> NI(64, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordflow">if</span> ((IsInteger || IsReciprocal) &amp;&amp;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        NF-&gt;<a class="code" href="classllvm_1_1APFloat.html#aae1f09de4bf1aab27149a7d328715e30">convertToInteger</a>(NI, <a class="code" href="structllvm_1_1APFloatBase.html#a482d9cf95b588eb05cefeaa5c05be9a3">APFloat::rmTowardZero</a>, &amp;Ignored) ==</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            <a class="code" href="structllvm_1_1APFloatBase.html#aee544c332088dbef348a0c1c97e21a6aa8092c6b52c0412d8198a63bc995761e9">APFloat::opOK</a> &amp;&amp;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        NI &gt; 1 &amp;&amp; NI.isPowerOf2()) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = NI.logBase2() * (IsReciprocal ? -1.0 : 1.0);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eab48b2a9934af7a531cfd7236ded9d50e">FMul</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(Expo, <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>), <span class="stringliteral">&quot;mul&quot;</span>);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="keywordflow">if</span> (Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>())</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                                                Mod, Intrinsic::exp2, Ty),</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                                            FMul, <span class="stringliteral">&quot;exp2&quot;</span>));</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow, <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(FMul, TLI, LibFunc_exp2,</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                                                    LibFunc_exp2f,</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                                                    LibFunc_exp2l, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, NoAttrs));</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    }</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="comment">// pow(10.0, x) -&gt; exp10(x)</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="comment">// TODO: There is no exp10() intrinsic yet, but some day there shall be one.</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Base, <a class="code" href="namespacellvm_1_1PatternMatch.html#a43117391a6d351518362783bff747d44">m_SpecificFP</a>(10.0)) &amp;&amp;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <a class="code" href="namespacellvm.html#a48857a8252dd37eb41884773de34738f">hasFloatFn</a>(M, TLI, Ty, LibFunc_exp10, LibFunc_exp10f, LibFunc_exp10l))</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow, <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(Expo, TLI, LibFunc_exp10,</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                                                LibFunc_exp10f, LibFunc_exp10l,</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                                                <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, NoAttrs));</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  <span class="comment">// pow(x, y) -&gt; exp2(log2(x) * y)</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordflow">if</span> (Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#aa11ca53210de69609754994339179e10">hasApproxFunc</a>() &amp;&amp; Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0d4bb13ba43d71cfe58184ab1bb4abd1">hasNoNaNs</a>() &amp;&amp; BaseF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a152743f94b060fbc99d10736c1b430e5">isFiniteNonZero</a>() &amp;&amp;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      !BaseF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a2b901c3a0625a7d7173e9bd4864e2775">isNegative</a>()) {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="comment">// pow(1, inf) is defined to be 1 but exp2(log2(1) * inf) evaluates to NaN.</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="comment">// Luckily optimizePow has already handled the x == 1 case.</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Base, <a class="code" href="namespacellvm_1_1PatternMatch.html#a8f87f39b5e0dedd0793bb3a450f463cf">m_FPOne</a>()) &amp;&amp;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;           <span class="stringliteral">&quot;pow(1.0, y) should have been simplified earlier!&quot;</span>);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Log = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">isFloatTy</a>())</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      Log = <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, <a class="code" href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">std::log2</a>(BaseF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a8269fab998356ea27a76ad45bd6cc8fe">convertToFloat</a>()));</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">isDoubleTy</a>())</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      Log = <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, <a class="code" href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">std::log2</a>(BaseF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a37733c4c22afc6a48194783dbd25487c">convertToDouble</a>()));</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">if</span> (Log) {</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eab48b2a9934af7a531cfd7236ded9d50e">FMul</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(Log, Expo, <span class="stringliteral">&quot;mul&quot;</span>);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keywordflow">if</span> (Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>())</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                                                Mod, Intrinsic::exp2, Ty),</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                                            FMul, <span class="stringliteral">&quot;exp2&quot;</span>));</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a48857a8252dd37eb41884773de34738f">hasFloatFn</a>(M, TLI, Ty, LibFunc_exp2, LibFunc_exp2f,</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                          LibFunc_exp2l))</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow, <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(FMul, TLI, LibFunc_exp2,</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                                                    LibFunc_exp2f,</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                                                    LibFunc_exp2l, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, NoAttrs));</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;}</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#ac88d9af30f3e67bd725bfe03e786f50c"> 2017</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#ac88d9af30f3e67bd725bfe03e786f50c">getSqrtCall</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>, <span class="keywordtype">bool</span> NoErrno,</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                          <a class="code" href="classllvm_1_1Module.html">Module</a> *M, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI) {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="comment">// If errno is never set, then use the intrinsic for sqrt().</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordflow">if</span> (NoErrno) {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *SqrtFn =</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Intrinsic::sqrt, V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(SqrtFn, V, <span class="stringliteral">&quot;sqrt&quot;</span>);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="comment">// Otherwise, use the libcall for sqrt().</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a48857a8252dd37eb41884773de34738f">hasFloatFn</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, TLI, V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), LibFunc_sqrt, LibFunc_sqrtf,</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                 LibFunc_sqrtl))</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">// TODO: We also should check that the target can in fact lower the sqrt()</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="comment">// libcall. We currently have no way to ask this question, so we ask if</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">// the target has a sqrt() libcall, which is not exactly the same.</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(V, TLI, LibFunc_sqrt, LibFunc_sqrtf,</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                                LibFunc_sqrtl, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a>);</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;}</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">/// Use square root in place of pow(x, +/-0.5).</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::replacePowWithSqrt(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Pow, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Sqrt, *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *Expo = Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="PassBuilderBindings_8cpp.html#a76adb4549f349676de0a703a497ca5a5">Mod</a> = Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Pow-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> *ExpoF;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Expo, <a class="code" href="namespacellvm_1_1PatternMatch.html#acd794d7b3653822f61ba126e1678e03f">m_APFloat</a>(ExpoF)) ||</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      (!ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a43efe9700a64d52fdf51d350923eef33">isExactlyValue</a>(0.5) &amp;&amp; !ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a43efe9700a64d52fdf51d350923eef33">isExactlyValue</a>(-0.5)))</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="comment">// Converting pow(X, -0.5) to 1/sqrt(X) may introduce an extra rounding step,</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="comment">// so that requires fast-math-flags (afn or reassoc).</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="keywordflow">if</span> (ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a2b901c3a0625a7d7173e9bd4864e2775">isNegative</a>() &amp;&amp; (!Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#aa11ca53210de69609754994339179e10">hasApproxFunc</a>() &amp;&amp; !Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#aed565a1dfd056c37a481581db8cdbedd">hasAllowReassoc</a>()))</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">// If we have a pow() library call (accesses memory) and we can&#39;t guarantee</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="comment">// that the base is not an infinity, give up:</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">// pow(-Inf, 0.5) is optionally required to have a result of +Inf (not setting</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="comment">// errno), but sqrt(-Inf) is required by various standards to set errno.</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="keywordflow">if</span> (!Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>() &amp;&amp; !Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a10d8839494fe8385aa1ddbca6f801d79">hasNoInfs</a>() &amp;&amp;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      !<a class="code" href="namespacellvm.html#a670d4ce84e762e337fbf51e582316e13">isKnownNeverInfinity</a>(Base, TLI))</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  Sqrt = <a class="code" href="SimplifyLibCalls_8cpp.html#ac88d9af30f3e67bd725bfe03e786f50c">getSqrtCall</a>(Base, <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a>(), Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>(), Mod, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                     TLI);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordflow">if</span> (!Sqrt)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; </div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="comment">// Handle signed zero base by expanding to fabs(sqrt(x)).</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="keywordflow">if</span> (!Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2c8498183c5bce88fb4f651ee4169611">hasNoSignedZeros</a>()) {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *FAbsFn = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(Mod, Intrinsic::fabs, Ty);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    Sqrt = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(FAbsFn, Sqrt, <span class="stringliteral">&quot;abs&quot;</span>);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  }</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  Sqrt = <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow, Sqrt);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="comment">// Handle non finite base by expanding to</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="comment">// (x == -infinity ? +infinity : sqrt(x)).</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="keywordflow">if</span> (!Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a10d8839494fe8385aa1ddbca6f801d79">hasNoInfs</a>()) {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PosInf = <a class="code" href="classllvm_1_1ConstantFP.html#a6f2864671b22c9f6135b6ae5d41bcf54">ConstantFP::getInfinity</a>(Ty),</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;          *NegInf = <a class="code" href="classllvm_1_1ConstantFP.html#a6f2864671b22c9f6135b6ae5d41bcf54">ConstantFP::getInfinity</a>(Ty, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *FCmp = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFCmpOEQ(Base, NegInf, <span class="stringliteral">&quot;isinf&quot;</span>);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    Sqrt = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(FCmp, PosInf, Sqrt);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="comment">// If the exponent is negative, then get the reciprocal.</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keywordflow">if</span> (ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a2b901c3a0625a7d7173e9bd4864e2775">isNegative</a>())</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    Sqrt = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFDiv(<a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, 1.0), Sqrt, <span class="stringliteral">&quot;reciprocal&quot;</span>);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordflow">return</span> Sqrt;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;}</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; </div>
<div class="line"><a name="l02092"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a35aa038c66bf741a35e18bf9d9d89493"> 2092</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SimplifyLibCalls_8cpp.html#a35aa038c66bf741a35e18bf9d9d89493">createPowWithIntegerExponent</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *Base, <a class="code" href="classllvm_1_1Value.html">Value</a> *Expo, <a class="code" href="classllvm_1_1Module.html">Module</a> *M,</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                                           <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[] = {<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, Expo};</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Types[] = {<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>-&gt;getType(), Expo-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()};</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, <a class="code" href="lib_2Target_2README_8txt.html#a5cef66dcb1fc369e64240a0bff194597">Intrinsic::powi</a>, Types);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;}</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizePow(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Pow, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Expo = Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName();</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Pow-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="keywordtype">bool</span> AllowApprox = Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#aa11ca53210de69609754994339179e10">hasApproxFunc</a>();</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="keywordtype">bool</span> Ignored;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="comment">// Propagate the math semantics from the call to any created instructions.</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(Pow-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9a167f91db810097d281b1ed627f4575">getFastMathFlags</a>());</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <span class="comment">// Evaluate special cases related to the base.</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="comment">// pow(1.0, x) -&gt; 1.0</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Base, <a class="code" href="namespacellvm_1_1PatternMatch.html#a8f87f39b5e0dedd0793bb3a450f463cf">m_FPOne</a>()))</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Exp = replacePowWithExp(Pow, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>))</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a3fd487d9643d814ffb8ef37443e70a27acad39a154bffb61175f674d6eefaf6d0">Exp</a>;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="comment">// Evaluate special cases related to the exponent.</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="comment">// pow(x, -1.0) -&gt; 1.0 / x</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Expo, <a class="code" href="namespacellvm_1_1PatternMatch.html#a43117391a6d351518362783bff747d44">m_SpecificFP</a>(-1.0)))</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFDiv(<a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, 1.0), Base, <span class="stringliteral">&quot;reciprocal&quot;</span>);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="comment">// pow(x, +/-0.0) -&gt; 1.0</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Expo, <a class="code" href="namespacellvm_1_1PatternMatch.html#ab9370b798ae530641518075b0832723a">m_AnyZeroFP</a>()))</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, 1.0);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="comment">// pow(x, 1.0) -&gt; x</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Expo, <a class="code" href="namespacellvm_1_1PatternMatch.html#a8f87f39b5e0dedd0793bb3a450f463cf">m_FPOne</a>()))</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; </div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="comment">// pow(x, 2.0) -&gt; x * x</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Expo, <a class="code" href="namespacellvm_1_1PatternMatch.html#a43117391a6d351518362783bff747d44">m_SpecificFP</a>(2.0)))</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(Base, Base, <span class="stringliteral">&quot;square&quot;</span>);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; </div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Sqrt = replacePowWithSqrt(Pow, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>))</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keywordflow">return</span> Sqrt;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="comment">// If we can approximate pow:</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="comment">// pow(x, n) -&gt; powi(x, n) * sqrt(x) if n has exactly a 0.5 fraction</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="comment">// pow(x, n) -&gt; powi(x, n) if n is a constant signed integer value</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> *ExpoF;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="keywordflow">if</span> (AllowApprox &amp;&amp; <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Expo, <a class="code" href="namespacellvm_1_1PatternMatch.html#acd794d7b3653822f61ba126e1678e03f">m_APFloat</a>(ExpoF)) &amp;&amp;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      !ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a43efe9700a64d52fdf51d350923eef33">isExactlyValue</a>(0.5) &amp;&amp; !ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#a43efe9700a64d52fdf51d350923eef33">isExactlyValue</a>(-0.5)) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> ExpoA(<a class="code" href="namespacellvm.html#a2816e84a08c108d18bc4665bc1817e01">abs</a>(*ExpoF));</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> ExpoI(*ExpoF);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Sqrt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordflow">if</span> (!ExpoA.isInteger()) {</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      <a class="code" href="classllvm_1_1APFloat.html">APFloat</a> Expo2 = ExpoA;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      <span class="comment">// To check if ExpoA is an integer + 0.5, we add it to itself. If there</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="comment">// is no floating point exception and the result is an integer, then</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="comment">// ExpoA == integer + 0.5</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <span class="keywordflow">if</span> (Expo2.<a class="code" href="classllvm_1_1APFloat.html#a44602b2ea058f08b290a8fa0185909d1">add</a>(ExpoA, <a class="code" href="structllvm_1_1APFloatBase.html#a22ed74f1ed33c4d33f524a650ea536a6">APFloat::rmNearestTiesToEven</a>) != <a class="code" href="structllvm_1_1APFloatBase.html#aee544c332088dbef348a0c1c97e21a6aa8092c6b52c0412d8198a63bc995761e9">APFloat::opOK</a>)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="keywordflow">if</span> (!Expo2.<a class="code" href="classllvm_1_1APFloat.html#ace4517dbbab7dbdefa0d31e29db55969">isInteger</a>())</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keywordflow">if</span> (ExpoI.roundToIntegral(<a class="code" href="structllvm_1_1APFloatBase.html#a1ba0fce5daa7f716936cabcf00373f0e">APFloat::rmTowardNegative</a>) !=</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;          <a class="code" href="structllvm_1_1APFloatBase.html#aee544c332088dbef348a0c1c97e21a6aaba98149aef517089f9868bde5b8c41bc">APFloat::opInexact</a>)</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keywordflow">if</span> (!ExpoI.isInteger())</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      ExpoF = &amp;ExpoI;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      Sqrt = <a class="code" href="SimplifyLibCalls_8cpp.html#ac88d9af30f3e67bd725bfe03e786f50c">getSqrtCall</a>(Base, <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a>(), Pow-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>(), M,</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                         <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <span class="keywordflow">if</span> (!Sqrt)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160; </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="comment">// 0.5 fraction is now optionally handled.</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">// Do pow -&gt; powi for remaining integer exponent</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <a class="code" href="classllvm_1_1APSInt.html">APSInt</a> IntExpo(TLI-&gt;getIntSize(), <span class="comment">/*isUnsigned=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="keywordflow">if</span> (ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#ace4517dbbab7dbdefa0d31e29db55969">isInteger</a>() &amp;&amp;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        ExpoF-&gt;<a class="code" href="classllvm_1_1APFloat.html#aae1f09de4bf1aab27149a7d328715e30">convertToInteger</a>(IntExpo, <a class="code" href="structllvm_1_1APFloatBase.html#a482d9cf95b588eb05cefeaa5c05be9a3">APFloat::rmTowardZero</a>, &amp;Ignored) ==</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            <a class="code" href="structllvm_1_1APFloatBase.html#aee544c332088dbef348a0c1c97e21a6aa8092c6b52c0412d8198a63bc995761e9">APFloat::opOK</a>) {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *PowI = <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;          *Pow,</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;          <a class="code" href="SimplifyLibCalls_8cpp.html#a35aa038c66bf741a35e18bf9d9d89493">createPowWithIntegerExponent</a>(</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;              Base, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntNTy(TLI-&gt;getIntSize()), IntExpo),</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;              M, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>));</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="keywordflow">if</span> (PowI &amp;&amp; Sqrt)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(PowI, Sqrt);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">return</span> PowI;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    }</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  }</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="comment">// powf(x, itofp(y)) -&gt; powi(x, y)</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="keywordflow">if</span> (AllowApprox &amp;&amp; (isa&lt;SIToFPInst&gt;(Expo) || isa&lt;UIToFPInst&gt;(Expo))) {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *ExpoI = <a class="code" href="SimplifyLibCalls_8cpp.html#a80f54c2de948fe93fbb7acbf7c8bcee5">getIntToFPVal</a>(Expo, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI-&gt;getIntSize()))</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*Pow, <a class="code" href="SimplifyLibCalls_8cpp.html#a35aa038c66bf741a35e18bf9d9d89493">createPowWithIntegerExponent</a>(Base, ExpoI, M, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>));</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="comment">// Shrink pow() to powf() if the arguments are single precision,</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="comment">// unless the result is expected to be double precision.</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="keywordflow">if</span> (UnsafeFPShrink &amp;&amp; Name == TLI-&gt;getName(LibFunc_pow) &amp;&amp;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      hasFloatVersion(M, Name)) {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Shrunk = <a class="code" href="SimplifyLibCalls_8cpp.html#a4826c8503f42d50634e8fdce6e756be1">optimizeBinaryDoubleFP</a>(Pow, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI, <span class="keyword">true</span>))</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <span class="keywordflow">return</span> Shrunk;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;}</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeExp2(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName();</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="keywordflow">if</span> (UnsafeFPShrink &amp;&amp; Name == TLI-&gt;getName(LibFunc_exp2) &amp;&amp;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      hasFloatVersion(M, Name))</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <a class="code" href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3">optimizeUnaryDoubleFP</a>(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <span class="comment">// Bail out for vectors because the code below only expects scalars.</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="comment">// TODO: This could be allowed if we had a ldexp intrinsic (D14327).</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">isVectorTy</a>())</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  <span class="comment">// exp2(sitofp(x)) -&gt; ldexp(1.0, sext(x))  if sizeof(x) &lt;= IntSize</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="comment">// exp2(uitofp(x)) -&gt; ldexp(1.0, zext(x))  if sizeof(x) &lt; IntSize</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <span class="keywordflow">if</span> ((isa&lt;SIToFPInst&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>) || isa&lt;UIToFPInst&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)) &amp;&amp;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <a class="code" href="namespacellvm.html#a48857a8252dd37eb41884773de34738f">hasFloatFn</a>(M, TLI, Ty, LibFunc_ldexp, LibFunc_ldexpf, LibFunc_ldexpl)) {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Exp = <a class="code" href="SimplifyLibCalls_8cpp.html#a80f54c2de948fe93fbb7acbf7c8bcee5">getIntToFPVal</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI-&gt;getIntSize())) {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9a167f91db810097d281b1ed627f4575">getFastMathFlags</a>());</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;          *CI, <a class="code" href="namespacellvm.html#a656b9d85656ae6dd73f482f6d5639b97">emitBinaryFloatFnCall</a>(<a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Ty, 1.0), Exp, TLI,</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                                     LibFunc_ldexp, LibFunc_ldexpf,</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                                     LibFunc_ldexpl, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a>()));</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  }</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160; </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;}</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFMinFMax(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="comment">// If we can shrink the call to a float function rather than a double</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="comment">// function, do that first.</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName();</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="keywordflow">if</span> ((Name == <span class="stringliteral">&quot;fmin&quot;</span> || Name == <span class="stringliteral">&quot;fmax&quot;</span>) &amp;&amp; hasFloatVersion(M, Name))</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <a class="code" href="SimplifyLibCalls_8cpp.html#a4826c8503f42d50634e8fdce6e756be1">optimizeBinaryDoubleFP</a>(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI))</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="comment">// The LLVM intrinsics minnum/maxnum correspond to fmin/fmax. Canonicalize to</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="comment">// the intrinsics for improved optimization (for example, vectorization).</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="comment">// No-signed-zeros is implied by the definitions of fmax/fmin themselves.</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="comment">// From the C standard draft WG14/N1256:</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="comment">// &quot;Ideally, fmax would be sensitive to the sign of zero, for example</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="comment">// fmax(-0.0, +0.0) would return +0; however, implementation in software</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  <span class="comment">// might be impractical.&quot;</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <a class="code" href="classllvm_1_1FastMathFlags.html">FastMathFlags</a> FMF = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9a167f91db810097d281b1ed627f4575">getFastMathFlags</a>();</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  FMF.<a class="code" href="classllvm_1_1FastMathFlags.html#a9b87b2b5c4b6b7d083212a0c93684f72">setNoSignedZeros</a>();</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(FMF);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> IID = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName().startswith(<span class="stringliteral">&quot;fmin&quot;</span>) ? <a class="code" href="namespacellvm.html#aa656aa475d13ec6a900414eadabe86b0">Intrinsic::minnum</a></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                                                           : <a class="code" href="namespacellvm.html#a636de400e4dd2bc090b729329a99e75b">Intrinsic::maxnum</a>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>(), IID, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      *CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, {CI-&gt;getArgOperand(0), CI-&gt;getArgOperand(1)}));</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;}</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeLog(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *Log, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *LogFn = Log-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> LogNm = LogFn-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> LogID = LogFn-&gt;<a class="code" href="classllvm_1_1Function.html#a4d0a7baab8d078065b2de10e3460892a">getIntrinsicID</a>();</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="PassBuilderBindings_8cpp.html#a76adb4549f349676de0a703a497ca5a5">Mod</a> = Log-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = Log-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="keywordflow">if</span> (UnsafeFPShrink &amp;&amp; hasFloatVersion(Mod, LogNm))</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <a class="code" href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3">optimizeUnaryDoubleFP</a>(Log, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="comment">// The earlier call must also be &#39;fast&#39; in order to do these transforms.</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = dyn_cast&lt;CallInst&gt;(Log-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <span class="keywordflow">if</span> (!Log-&gt;<a class="code" href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">isFast</a>() || !<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> || !<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;isFast() || !<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;hasOneUse())</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> LogLb, ExpLb, Exp2Lb, Exp10Lb, PowLb;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  <span class="comment">// This is only applicable to log(), log2(), log10().</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  <span class="keywordflow">if</span> (TLI-&gt;getLibFunc(LogNm, LogLb))</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="keywordflow">switch</span> (LogLb) {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <span class="keywordflow">case</span> LibFunc_logf:</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      LogID = Intrinsic::log;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      ExpLb = LibFunc_expf;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      Exp2Lb = LibFunc_exp2f;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      Exp10Lb = LibFunc_exp10f;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      PowLb = LibFunc_powf;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordflow">case</span> LibFunc_log:</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      LogID = Intrinsic::log;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      ExpLb = LibFunc_exp;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      Exp2Lb = LibFunc_exp2;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      Exp10Lb = LibFunc_exp10;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      PowLb = LibFunc_pow;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="keywordflow">case</span> LibFunc_logl:</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      LogID = Intrinsic::log;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      ExpLb = LibFunc_expl;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      Exp2Lb = LibFunc_exp2l;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      Exp10Lb = LibFunc_exp10l;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      PowLb = LibFunc_powl;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keywordflow">case</span> LibFunc_log2f:</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      LogID = <a class="code" href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">Intrinsic::log2</a>;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      ExpLb = LibFunc_expf;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      Exp2Lb = LibFunc_exp2f;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      Exp10Lb = LibFunc_exp10f;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      PowLb = LibFunc_powf;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordflow">case</span> LibFunc_log2:</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      LogID = <a class="code" href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">Intrinsic::log2</a>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      ExpLb = LibFunc_exp;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      Exp2Lb = LibFunc_exp2;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      Exp10Lb = LibFunc_exp10;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      PowLb = LibFunc_pow;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordflow">case</span> LibFunc_log2l:</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      LogID = <a class="code" href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">Intrinsic::log2</a>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      ExpLb = LibFunc_expl;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      Exp2Lb = LibFunc_exp2l;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      Exp10Lb = LibFunc_exp10l;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      PowLb = LibFunc_powl;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordflow">case</span> LibFunc_log10f:</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      LogID = Intrinsic::log10;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      ExpLb = LibFunc_expf;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      Exp2Lb = LibFunc_exp2f;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      Exp10Lb = LibFunc_exp10f;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      PowLb = LibFunc_powf;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keywordflow">case</span> LibFunc_log10:</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      LogID = Intrinsic::log10;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      ExpLb = LibFunc_exp;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      Exp2Lb = LibFunc_exp2;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      Exp10Lb = LibFunc_exp10;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      PowLb = LibFunc_pow;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    <span class="keywordflow">case</span> LibFunc_log10l:</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      LogID = Intrinsic::log10;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      ExpLb = LibFunc_expl;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      Exp2Lb = LibFunc_exp2l;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      Exp10Lb = LibFunc_exp10l;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      PowLb = LibFunc_powl;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    }</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LogID == Intrinsic::log || LogID == <a class="code" href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">Intrinsic::log2</a> ||</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;           LogID == Intrinsic::log10) {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">isFloatTy</a>()) {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      ExpLb = LibFunc_expf;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      Exp2Lb = LibFunc_exp2f;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      Exp10Lb = LibFunc_exp10f;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      PowLb = LibFunc_powf;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">isDoubleTy</a>()) {</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      ExpLb = LibFunc_exp;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      Exp2Lb = LibFunc_exp2;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      Exp10Lb = LibFunc_exp10;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      PowLb = LibFunc_pow;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(<a class="code" href="classllvm_1_1FastMathFlags.html#acd492b88eb98461e692085ed400db114">FastMathFlags::getFast</a>());</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">Intrinsic::ID</a> ArgID = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getIntrinsicID();</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> ArgLb = <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154ea2552a9aa363fba3520d8e8e1a7eca566">NotLibFunc</a>;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  TLI-&gt;getLibFunc(*<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, ArgLb);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="comment">// log(pow(x,y)) -&gt; y*log(x)</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <a class="code" href="classllvm_1_1AttributeList.html">AttributeList</a> NoAttrs;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  <span class="keywordflow">if</span> (ArgLb == PowLb || ArgID == Intrinsic::pow) {</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LogX =</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        Log-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>()</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(Mod, LogID, Ty),</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                           <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getOperand(0), <span class="stringliteral">&quot;log&quot;</span>)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            : <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getOperand(0), TLI, LogNm, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, NoAttrs);</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *MulY = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getArgOperand(1), LogX, <span class="stringliteral">&quot;mul&quot;</span>);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <span class="comment">// Since pow() may have side effects, e.g. errno,</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="comment">// dead code elimination may not be trusted to remove it.</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    substituteInParent(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, MulY);</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="keywordflow">return</span> MulY;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  }</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  <span class="comment">// log(exp{,2,10}(y)) -&gt; y*log({e,2,10})</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <span class="comment">// TODO: There is no exp10() intrinsic yet.</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="keywordflow">if</span> (ArgLb == ExpLb || ArgLb == Exp2Lb || ArgLb == Exp10Lb ||</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;           ArgID == Intrinsic::exp || ArgID == Intrinsic::exp2) {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Eul;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="keywordflow">if</span> (ArgLb == ExpLb || ArgID == Intrinsic::exp)</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      <span class="comment">// FIXME: Add more precise value of e for long double.</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      Eul = <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Log-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">numbers::e</a>);</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ArgLb == Exp2Lb || ArgID == Intrinsic::exp2)</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      Eul = <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Log-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 2.0);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      Eul = <a class="code" href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">ConstantFP::get</a>(Log-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 10.0);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LogE = Log-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>()</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                      ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(Mod, LogID, Ty),</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                                     Eul, <span class="stringliteral">&quot;log&quot;</span>)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                      : <a class="code" href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">emitUnaryFloatFnCall</a>(Eul, TLI, LogNm, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, NoAttrs);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *MulY = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getArgOperand(0), LogE, <span class="stringliteral">&quot;mul&quot;</span>);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="comment">// Since exp() may have side effects, e.g. errno,</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="comment">// dead code elimination may not be trusted to remove it.</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    substituteInParent(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, MulY);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keywordflow">return</span> MulY;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  }</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;}</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeSqrt(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;  <span class="comment">// TODO: Once we have a way (other than checking for the existince of the</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="comment">// libcall) to tell whether our target can lower @llvm.sqrt, relax the</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  <span class="comment">// condition below.</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_sqrtf) &amp;&amp;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      (<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName() == <span class="stringliteral">&quot;sqrt&quot;</span> ||</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;       <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getIntrinsicID() == Intrinsic::sqrt))</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <a class="code" href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3">optimizeUnaryDoubleFP</a>(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; </div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">isFast</a>())</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() != Instruction::FMul || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isFast())</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; </div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="comment">// We&#39;re looking for a repeated factor in a multiplication tree,</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <span class="comment">// so we can do this fold: sqrt(x * x) -&gt; fabs(x);</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <span class="comment">// or this fold: sqrt((x * x) * y) -&gt; fabs(x) * sqrt(y).</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1);</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RepeatOp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OtherOp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <span class="keywordflow">if</span> (Op0 == Op1) {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="comment">// Simple match: the operands of the multiply are identical.</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    RepeatOp = Op0;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="comment">// Look for a more complicated pattern: one of the operands is itself</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="comment">// a multiply, so search for a common factor in that multiply.</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="comment">// Note: We don&#39;t bother looking any deeper than this first level or for</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="comment">// variations of this pattern because instcombine&#39;s visitFMUL and/or the</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="comment">// reassociation pass should give us this form.</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *OtherMul0, *OtherMul1;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(Op0, <a class="code" href="namespacellvm_1_1PatternMatch.html#a7aff89f4f22502c8ad9118bed59ce21c">m_FMul</a>(<a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(OtherMul0), <a class="code" href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">m_Value</a>(OtherMul1)))) {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      <span class="comment">// Pattern: sqrt((x * y) * z)</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      <span class="keywordflow">if</span> (OtherMul0 == OtherMul1 &amp;&amp; cast&lt;Instruction&gt;(Op0)-&gt;isFast()) {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        <span class="comment">// Matched: sqrt((x * x) * z)</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        RepeatOp = OtherMul0;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        OtherOp = Op1;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    }</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  }</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="keywordflow">if</span> (!RepeatOp)</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="comment">// Fast math flags for any created instructions should match the sqrt</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="comment">// and multiply.</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">IRBuilderBase::FastMathFlagGuard</a> Guard(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.setFastMathFlags(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getFastMathFlags());</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  <span class="comment">// If we found a repeated factor, hoist it out of the square root and</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  <span class="comment">// replace it with the fabs of that factor.</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgType = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType();</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *Fabs = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(M, Intrinsic::fabs, ArgType);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FabsCall = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(Fabs, RepeatOp, <span class="stringliteral">&quot;fabs&quot;</span>);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  <span class="keywordflow">if</span> (OtherOp) {</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="comment">// If we found a non-repeated factor, we still need to get its square</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="comment">// root. We then multiply that by the value that was simplified out</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="comment">// of the square root calculation.</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *Sqrt = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(M, Intrinsic::sqrt, ArgType);</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SqrtCall = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(Sqrt, OtherOp, <span class="stringliteral">&quot;sqrt&quot;</span>);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateFMul(FabsCall, SqrtCall));</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  }</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, FabsCall);</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;}</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160; </div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="comment">// TODO: Generalize to handle any trig function and its inverse.</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeTan(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName();</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  <span class="keywordflow">if</span> (UnsafeFPShrink &amp;&amp; Name == <span class="stringliteral">&quot;tan&quot;</span> &amp;&amp; hasFloatVersion(M, Name))</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <a class="code" href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3">optimizeUnaryDoubleFP</a>(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160; </div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="keyword">auto</span> *OpC = dyn_cast&lt;CallInst&gt;(Op1);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="keywordflow">if</span> (!OpC)</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160; </div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;  <span class="comment">// Both calls must be &#39;fast&#39; in order to remove them.</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">isFast</a>() || !OpC-&gt;isFast())</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; </div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  <span class="comment">// tan(atan(x)) -&gt; x</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  <span class="comment">// tanf(atanf(x)) -&gt; x</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  <span class="comment">// tanl(atanl(x)) -&gt; x</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> <a class="code" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = OpC-&gt;getCalledFunction();</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;&amp; TLI-&gt;getLibFunc(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName(), Func) &amp;&amp;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, Func) &amp;&amp;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      ((Func == LibFunc_atan &amp;&amp; <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName() == <span class="stringliteral">&quot;tan&quot;</span>) ||</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;       (Func == LibFunc_atanf &amp;&amp; <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName() == <span class="stringliteral">&quot;tanf&quot;</span>) ||</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;       (Func == LibFunc_atanl &amp;&amp; <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName() == <span class="stringliteral">&quot;tanl&quot;</span>)))</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = OpC-&gt;getArgOperand(0);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;}</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#ad633d6152693e0c1dd402507ac156289"> 2528</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#ad633d6152693e0c1dd402507ac156289">isTrigLibCall</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI) {</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;  <span class="comment">// We can only hope to do anything useful if we can ignore things like errno</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;  <span class="comment">// and floating-point exceptions.</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;  <span class="comment">// We already checked the prototype.</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#aa87fae97a8c702741eca5a95748af49d">doesNotThrow</a>() &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">doesNotAccessMemory</a>();</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;}</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a24da6451c0e494831c85fa96cb572c9a"> 2535</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a24da6451c0e494831c85fa96cb572c9a">insertSinCosCall</a>(<a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="classllvm_1_1Function.html">Function</a> *OrigCallee, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>,</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                             <span class="keywordtype">bool</span> UseFloat, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Sin, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Cos,</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                             <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;SinCos, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI) {</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = OrigCallee-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>();</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgTy = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getType();</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ResTy;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Name;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160; </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <a class="code" href="classllvm_1_1Triple.html">Triple</a> <a class="code" href="classT.html">T</a>(OrigCallee-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a86ec13a58628abfcbee9652dcd8633ed">getTargetTriple</a>());</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  <span class="keywordflow">if</span> (UseFloat) {</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    Name = <span class="stringliteral">&quot;__sincospif_stret&quot;</span>;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="classT.html">T</a>.getArch() != <a class="code" href="classllvm_1_1Triple.html#a547abd13f7a3c063aa72c8192a868154a0eefa3e53db25b90828e42c64b138648">Triple::x86</a> &amp;&amp; <span class="stringliteral">&quot;x86 messy and unsupported for now&quot;</span>);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    <span class="comment">// x86_64 can&#39;t use {float, float} since that would be returned in both</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="comment">// xmm0 and xmm1, which isn&#39;t what a real struct would do.</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    ResTy = <a class="code" href="classT.html">T</a>.getArch() == <a class="code" href="classllvm_1_1Triple.html#a547abd13f7a3c063aa72c8192a868154a13d8ce5e71051718a537277c6a594062">Triple::x86_64</a></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                ? <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1Type.html">Type</a> *<span class="keyword">&gt;</span>(<a class="code" href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">FixedVectorType::get</a>(ArgTy, 2))</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                : <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1Type.html">Type</a> *<span class="keyword">&gt;</span>(<a class="code" href="classllvm_1_1StructType.html#a18fc4545474c6ebb6f7c547f64f4fb31">StructType::get</a>(ArgTy, ArgTy));</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    Name = <span class="stringliteral">&quot;__sincospi_stret&quot;</span>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    ResTy = <a class="code" href="classllvm_1_1StructType.html#a18fc4545474c6ebb6f7c547f64f4fb31">StructType::get</a>(ArgTy, ArgTy);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  }</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; </div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, TLI, Name))</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> TheLibFunc;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a97cfbbed8869e3582142012a071a9052">getLibFunc</a>(Name, TheLibFunc);</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, *TLI, TheLibFunc, OrigCallee-&gt;<a class="code" href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">getAttributes</a>(), ResTy, ArgTy);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160; </div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ArgInst = dyn_cast&lt;Instruction&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)) {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="comment">// If the argument is an instruction, it must dominate all uses so put our</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="comment">// sincos call there.</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.SetInsertPoint(ArgInst-&gt;getParent(), ++ArgInst-&gt;getIterator());</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="comment">// Otherwise (e.g. for a constant) the beginning of the function is as</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="comment">// good a place as any.</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;EntryBB = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.GetInsertBlock()-&gt;getParent()-&gt;getEntryBlock();</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.SetInsertPoint(&amp;EntryBB, EntryBB.<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  }</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160; </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  SinCos = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, <span class="stringliteral">&quot;sincospi&quot;</span>);</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160; </div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;  <span class="keywordflow">if</span> (SinCos-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>()) {</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    Sin = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateExtractValue(SinCos, 0, <span class="stringliteral">&quot;sinpi&quot;</span>);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    Cos = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateExtractValue(SinCos, 1, <span class="stringliteral">&quot;cospi&quot;</span>);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    Sin = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateExtractElement(SinCos, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt32Ty(), 0),</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                                 <span class="stringliteral">&quot;sinpi&quot;</span>);</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    Cos = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateExtractElement(SinCos, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt32Ty(), 1),</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                                 <span class="stringliteral">&quot;cospi&quot;</span>);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  }</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;}</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160; </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeSinCosPi(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;  <span class="comment">// Make sure the prototype is as expected, otherwise the rest of the</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;  <span class="comment">// function is probably invalid and likely to abort.</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SimplifyLibCalls_8cpp.html#ad633d6152693e0c1dd402507ac156289">isTrigLibCall</a>(CI))</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallInst *, 1&gt;</a> SinCalls;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallInst *, 1&gt;</a> CosCalls;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;CallInst *, 1&gt;</a> SinCosCalls;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="keywordtype">bool</span> IsFloat = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;getType()-&gt;isFloatTy();</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; </div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="comment">// Look for all compatible sinpi, cospi and sincospi calls with the same</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  <span class="comment">// argument. If there are enough (in some sense) we can make the</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  <span class="comment">// substitution.</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>();</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;users())</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    classifyArgUse(U, <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, IsFloat, SinCalls, CosCalls, SinCosCalls);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160; </div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;  <span class="comment">// It&#39;s only worthwhile if both sinpi and cospi are actually used.</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="keywordflow">if</span> (SinCalls.empty() || CosCalls.empty())</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Sin, *Cos, *SinCos;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SimplifyLibCalls_8cpp.html#a24da6451c0e494831c85fa96cb572c9a">insertSinCosCall</a>(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>(), <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>, IsFloat, Sin, Cos,</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                        SinCos, TLI))</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  <span class="keyword">auto</span> replaceTrigInsts = [<span class="keyword">this</span>](<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CallInst *&gt;</a> &amp;Calls,</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                                 <a class="code" href="classllvm_1_1Value.html">Value</a> *Res) {</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> : Calls)</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <a class="code" href="CodeGenPrepare_8cpp.html#a19e092ecf7889abf7277f13824e0c601">replaceAllUsesWith</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, Res);</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  };</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  replaceTrigInsts(SinCalls, Sin);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  replaceTrigInsts(CosCalls, Cos);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  replaceTrigInsts(SinCosCalls, SinCos);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160; </div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;}</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; </div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="keywordtype">void</span> LibCallSimplifier::classifyArgUse(</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Val, <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keywordtype">bool</span> IsFloat,</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CallInst *&gt;</a> &amp;SinCalls,</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CallInst *&gt;</a> &amp;CosCalls,</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;CallInst *&gt;</a> &amp;SinCosCalls) {</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  <span class="keyword">auto</span> *CI = dyn_cast&lt;CallInst&gt;(Val);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <span class="keywordflow">if</span> (!CI || CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  <span class="comment">// Don&#39;t consider calls in other functions.</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>() != <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> <a class="code" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  <span class="keywordflow">if</span> (!Callee || !TLI-&gt;getLibFunc(*Callee, Func) ||</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      !<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, Func) ||</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      !<a class="code" href="SimplifyLibCalls_8cpp.html#ad633d6152693e0c1dd402507ac156289">isTrigLibCall</a>(CI))</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; </div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  <span class="keywordflow">if</span> (IsFloat) {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordflow">if</span> (Func == LibFunc_sinpif)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      SinCalls.push_back(CI);</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Func == LibFunc_cospif)</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      CosCalls.push_back(CI);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Func == LibFunc_sincospif_stret)</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;      SinCosCalls.push_back(CI);</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <span class="keywordflow">if</span> (Func == LibFunc_sinpi)</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      SinCalls.push_back(CI);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Func == LibFunc_cospi)</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      CosCalls.push_back(CI);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Func == LibFunc_sincospi_stret)</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      SinCosCalls.push_back(CI);</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;}</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">// Integer Library Call Optimizations</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160; </div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFFS(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  <span class="comment">// All variants of ffs return int which need not be 32 bits wide.</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  <span class="comment">// ffs{,l,ll}(x) -&gt; x != 0 ? (int)llvm.cttz(x)+1 : 0</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *RetType = CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgType = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType();</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>(),</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                                          Intrinsic::cttz, ArgType);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, {<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getTrue()}, <span class="stringliteral">&quot;cttz&quot;</span>);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateAdd(V, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 1));</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(V, RetType, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160; </div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpNE(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(ArgType));</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>, V, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(RetType, 0));</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;}</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160; </div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFls(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  <span class="comment">// All variants of fls return int which need not be 32 bits wide.</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <span class="comment">// fls{,l,ll}(x) -&gt; (int)(sizeInBits(x) - llvm.ctlz(x, false))</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgType = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType();</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>(),</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                                          Intrinsic::ctlz, ArgType);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateCall(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, {<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getFalse()}, <span class="stringliteral">&quot;ctlz&quot;</span>);</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;  V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSub(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), ArgType-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>()),</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                  V);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(V, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;}</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; </div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeAbs(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;  <span class="comment">// abs(x) -&gt; x &lt;s 0 ? -x : x</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  <span class="comment">// The negation has &#39;nsw&#39; because abs of INT_MIN is undefined.</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *IsNeg = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIsNeg(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NegX = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateNSWNeg(<a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>, <span class="stringliteral">&quot;neg&quot;</span>);</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSelect(IsNeg, NegX, <a class="code" href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a>);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;}</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160; </div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeIsDigit(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  <span class="comment">// isdigit(c) -&gt; (c-&#39;0&#39;) &lt;u 10</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgType = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType();</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateSub(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(ArgType, <span class="charliteral">&#39;0&#39;</span>), <span class="stringliteral">&quot;isdigittmp&quot;</span>);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpULT(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(ArgType, 10), <span class="stringliteral">&quot;isdigit&quot;</span>);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;}</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160; </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeIsAscii(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <span class="comment">// isascii(c) -&gt; c &lt;u 128</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgType = <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType();</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateICmpULT(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(ArgType, 128), <span class="stringliteral">&quot;isascii&quot;</span>);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateZExt(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;}</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; </div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeToAscii(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;  <span class="comment">// toascii(c) -&gt; c &amp; 0x7f</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateAnd(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0),</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                     <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0x7F));</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;}</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160; </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="comment">// Fold calls to atoi, atol, and atoll.</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeAtoi(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">addParamAttr</a>(0, Attribute::NoCapture);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160; </div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), Str))</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160; </div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a181299935120519ce8b8953da4d4d354">convertStrToInt</a>(CI, Str, <span class="keyword">nullptr</span>, 10, <span class="comment">/*AsSigned=*/</span><span class="keyword">true</span>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;}</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160; </div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">// Fold calls to strtol, strtoll, strtoul, and strtoull.</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStrToInt(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                                           <span class="keywordtype">bool</span> AsSigned) {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *EndPtr = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantPointerNull&gt;(EndPtr)) {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="comment">// With a null EndPtr, this function won&#39;t capture the main argument.</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="comment">// It would be readonly too, except that it still may write to errno.</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">addParamAttr</a>(0, Attribute::NoCapture);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    EndPtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(EndPtr, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), Str))</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160; </div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CInt = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2))) {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a181299935120519ce8b8953da4d4d354">convertStrToInt</a>(CI, Str, EndPtr, CInt-&gt;getSExtValue(), AsSigned, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;  }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160; </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;}</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160; </div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="comment">// Formatting and IO Library Call Optimizations</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a766df1ea3c4bf3cbc8586f310562034f">isReportingError</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> *Callee, <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <span class="keywordtype">int</span> StreamArg);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160; </div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeErrorReporting(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                                                 <span class="keywordtype">int</span> StreamArg) {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  <span class="comment">// Error reporting calls should be cold, mark them as such.</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  <span class="comment">// This applies even to non-builtin calls: it is only a hint and applies to</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <span class="comment">// functions that the frontend might not understand as builtins.</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160; </div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;  <span class="comment">// This heuristic was suggested in:</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  <span class="comment">// Improving Static Branch Prediction in a Compiler</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  <span class="comment">// Brian L. Deitrich, Ben-Chung Cheng, Wen-mei W. Hwu</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  <span class="comment">// Proceedings of PACT&#39;98, Oct. 1998, IEEE</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a2fbfe5377a984518a7c03d8558df726d">hasFnAttr</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">Attribute::Cold</a>) &amp;&amp;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <a class="code" href="SimplifyLibCalls_8cpp.html#a766df1ea3c4bf3cbc8586f310562034f">isReportingError</a>(Callee, CI, StreamArg)) {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a0f72a62efd0912aba72c6818c720023c">addFnAttr</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">Attribute::Cold</a>);</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;}</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160; </div>
<div class="line"><a name="l02795"></a><span class="lineno"><a class="line" href="SimplifyLibCalls_8cpp.html#a766df1ea3c4bf3cbc8586f310562034f"> 2795</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a766df1ea3c4bf3cbc8586f310562034f">isReportingError</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> *Callee, <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <span class="keywordtype">int</span> StreamArg) {</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> || !<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isDeclaration())</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; </div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;  <span class="keywordflow">if</span> (StreamArg &lt; 0)</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160; </div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;  <span class="comment">// These functions might be considered cold, but only if their stream</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <span class="comment">// argument is stderr.</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; </div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  <span class="keywordflow">if</span> (StreamArg &gt;= (<span class="keywordtype">int</span>)CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>())</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(StreamArg));</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <span class="keywordflow">if</span> (!LI)</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <a class="code" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a> *GV = dyn_cast&lt;GlobalVariable&gt;(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>());</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  <span class="keywordflow">if</span> (!GV || !GV-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">isDeclaration</a>())</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  <span class="keywordflow">return</span> GV-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() == <span class="stringliteral">&quot;stderr&quot;</span>;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;}</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160; </div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizePrintFString(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;  <span class="comment">// Check for a fixed format string.</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> FormatStr;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), FormatStr))</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160; </div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  <span class="comment">// Empty format string -&gt; noop.</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;  <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>()) <span class="comment">// Tolerate printf&#39;s declared void.</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>() ? (<a class="code" href="classllvm_1_1Value.html">Value</a> *)CI : <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <span class="comment">// Do not do any of the following transformations if the printf return value</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  <span class="comment">// is used, in general the printf return value is not compatible with either</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;  <span class="comment">// putchar() or puts().</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160; </div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy = CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  <span class="comment">// printf(&quot;x&quot;) -&gt; putchar(&#39;x&#39;), even for &quot;%&quot; and &quot;%%&quot;.</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() == 1 || FormatStr == <span class="stringliteral">&quot;%%&quot;</span>) {</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="comment">// Convert the character to unsigned char before passing it to putchar</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="comment">// to avoid host-specific sign extension in the IR.  Putchar converts</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    <span class="comment">// it to unsigned char regardless.</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IntChar = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IntTy, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)FormatStr[0]);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a11b84a626ef34d3ced2e131937e58ddd">emitPutChar</a>(IntChar, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  }</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160; </div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  <span class="comment">// Try to remove call or emit putchar/puts.</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  <span class="keywordflow">if</span> (FormatStr == <span class="stringliteral">&quot;%s&quot;</span> &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() &gt; 1) {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> OperandStr;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), OperandStr))</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <span class="comment">// printf(&quot;%s&quot;, &quot;&quot;) --&gt; NOP</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    <span class="keywordflow">if</span> (OperandStr.<a class="code" href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>())</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *)CI;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="comment">// printf(&quot;%s&quot;, &quot;a&quot;) --&gt; putchar(&#39;a&#39;)</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">if</span> (OperandStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() == 1) {</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;      <span class="comment">// Convert the character to unsigned char before passing it to putchar</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      <span class="comment">// to avoid host-specific sign extension in the IR.  Putchar converts</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;      <span class="comment">// it to unsigned char regardless.</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *IntChar = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IntTy, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)OperandStr[0]);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a11b84a626ef34d3ced2e131937e58ddd">emitPutChar</a>(IntChar, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    }</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <span class="comment">// printf(&quot;%s&quot;, str&quot;\n&quot;) --&gt; puts(str)</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    <span class="keywordflow">if</span> (OperandStr.<a class="code" href="classllvm_1_1StringRef.html#a5b6faabb08339ea1dd11e9d37a668634">back</a>() == <span class="charliteral">&#39;\n&#39;</span>) {</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      OperandStr = OperandStr.<a class="code" href="classllvm_1_1StringRef.html#ae2705fd641fb3d1eefa2691b5117cf22">drop_back</a>();</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *GV = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateGlobalString(OperandStr, <span class="stringliteral">&quot;str&quot;</span>);</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#ad0f8cc4358373eeb5363cd620bbdaeab">emitPutS</a>(GV, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    }</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160; </div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  <span class="comment">// printf(&quot;foo\n&quot;) --&gt; puts(&quot;foo&quot;)</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5b6faabb08339ea1dd11e9d37a668634">back</a>() == <span class="charliteral">&#39;\n&#39;</span> &amp;&amp;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;      !FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a83a294111af6d4412163b209725ca556">contains</a>(<span class="charliteral">&#39;%&#39;</span>)) { <span class="comment">// No format characters.</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="comment">// Create a string literal with no \n on it.  We expect the constant merge</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="comment">// pass to be run after this pass, to merge duplicate strings.</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    FormatStr = FormatStr.<a class="code" href="classllvm_1_1StringRef.html#ae2705fd641fb3d1eefa2691b5117cf22">drop_back</a>();</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *GV = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateGlobalString(FormatStr, <span class="stringliteral">&quot;str&quot;</span>);</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#ad0f8cc4358373eeb5363cd620bbdaeab">emitPutS</a>(GV, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  }</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160; </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  <span class="comment">// Optimize specific format strings.</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  <span class="comment">// printf(&quot;%c&quot;, chr) --&gt; putchar(chr)</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  <span class="keywordflow">if</span> (FormatStr == <span class="stringliteral">&quot;%c&quot;</span> &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() &gt; 1 &amp;&amp;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()) {</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <span class="comment">// Convert the argument to the type expected by putchar, i.e., int, which</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="comment">// need not be 32 bits wide but which is the same as printf&#39;s return type.</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IntChar = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), IntTy, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a11b84a626ef34d3ced2e131937e58ddd">emitPutChar</a>(IntChar, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;  }</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160; </div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;  <span class="comment">// printf(&quot;%s\n&quot;, str) --&gt; puts(str)</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  <span class="keywordflow">if</span> (FormatStr == <span class="stringliteral">&quot;%s\n&quot;</span> &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() &gt; 1 &amp;&amp;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;      CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#ad0f8cc4358373eeb5363cd620bbdaeab">emitPutS</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;}</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; </div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizePrintF(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *FT = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>();</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizePrintFString(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>)) {</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  }</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160; </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160; </div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  <span class="comment">// printf(format, ...) -&gt; iprintf(format, ...) if no floating point</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  <span class="comment">// arguments.</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_iprintf) &amp;&amp;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      !<a class="code" href="SimplifyLibCalls_8cpp.html#ae56877b571bfd107841dabb130c9f2ca">callHasFloatingPointArgument</a>(CI)) {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> IPrintFFn = <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(M, *TLI, LibFunc_iprintf, FT,</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                                                  <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getAttributes());</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = cast&lt;CallInst&gt;(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setCalledFunction(IPrintFFn);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Insert(New);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  }</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  <span class="comment">// printf(format, ...) -&gt; __small_printf(format, ...) if no 128-bit floating point</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <span class="comment">// arguments.</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_small_printf) &amp;&amp;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      !<a class="code" href="SimplifyLibCalls_8cpp.html#ae817e73e41b3b26068e6b8a50cd447af">callHasFP128Argument</a>(CI)) {</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <span class="keyword">auto</span> SmallPrintFFn = <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(M, *TLI, LibFunc_small_printf, FT,</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                                            <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getAttributes());</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = cast&lt;CallInst&gt;(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setCalledFunction(SmallPrintFFn);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Insert(New);</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  }</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160; </div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;}</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160; </div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeSPrintFString(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                                                <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;  <span class="comment">// Check for a fixed format string.</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> FormatStr;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), FormatStr))</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160; </div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;  <span class="comment">// If we just have a format string (nothing else crazy) transform it.</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dest = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() == 2) {</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="comment">// Make sure there&#39;s no % in the constant array.  We could try to handle</span></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    <span class="comment">// %% -&gt; % in the future if we cared.</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a83a294111af6d4412163b209725ca556">contains</a>(<span class="charliteral">&#39;%&#39;</span>))</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// we found a format specifier, bail out.</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160; </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="comment">// sprintf(str, fmt) -&gt; llvm.memcpy(align 1 str, align 1 fmt, strlen(fmt)+1)</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        Dest, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="structllvm_1_1Align.html">Align</a>(1),</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()),</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                         FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() + 1)); <span class="comment">// Copy the null byte.</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>());</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  }</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160; </div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  <span class="comment">// The remaining optimizations require the format string to be &quot;%s&quot; or &quot;%c&quot;</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  <span class="comment">// and have an extra operand.</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;  <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() != 2 || FormatStr[0] != <span class="charliteral">&#39;%&#39;</span> || CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() &lt; 3)</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; </div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  <span class="comment">// Decode the second character of the format string.</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  <span class="keywordflow">if</span> (FormatStr[1] == <span class="charliteral">&#39;c&#39;</span>) {</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <span class="comment">// sprintf(dst, &quot;%c&quot;, chr) --&gt; *(i8*)dst = chr; *((i8*)dst+1) = 0</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateTrunc(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <span class="stringliteral">&quot;char&quot;</span>);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="namespacellvm.html#a1f00bd493d9df4474770b08908867a69">castToCStr</a>(Dest, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(V, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt32(1), <span class="stringliteral">&quot;nul&quot;</span>);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8(0), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160; </div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 1);</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160; </div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  <span class="keywordflow">if</span> (FormatStr[1] == <span class="charliteral">&#39;s&#39;</span>) {</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="comment">// sprintf(dest, &quot;%s&quot;, str) -&gt; llvm.memcpy(align 1 dest, align 1 str,</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="comment">// strlen(str)+1)</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160; </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <span class="comment">// sprintf(dest, &quot;%s&quot;, str) -&gt; strcpy(dest, str)</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#ae1777b151b5f4127a3af26fa2f841a99">emitStrCpy</a>(Dest, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160; </div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SrcLen = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    <span class="keywordflow">if</span> (SrcLen) {</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;      <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;          Dest, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="structllvm_1_1Align.html">Align</a>(1),</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;          <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()), SrcLen));</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <span class="comment">// Returns total number of characters written without null-character.</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), SrcLen - 1);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="namespacellvm.html#aa2219174d1d70af115609449fea112b1">emitStpCpy</a>(Dest, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI)) {</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="comment">// sprintf(dest, &quot;%s&quot;, str) -&gt; stpcpy(dest, str) - dest</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="comment">// Handle mismatched pointer types (goes away with typeless pointers?).</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreatePointerCast(V, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8PtrTy());</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      Dest = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreatePointerCast(Dest, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8PtrTy());</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *PtrDiff = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreatePtrDiff(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), V, Dest);</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(PtrDiff, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    }</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160; </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="keywordtype">bool</span> OptForSize = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a1c455e007178a24dfb18ac0e200ea02c">hasOptSize</a>() ||</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                      <a class="code" href="namespacellvm.html#a3af72f14ea20f2c762c751d2d49e5ea3">llvm::shouldOptimizeForSize</a>(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), PSI, <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>,</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;                                                  <a class="code" href="namespacellvm.html#aec7c967a5416fa6e154433965357a50ea089e7eb4db258e05f70eef4ed5aa10bb">PGSOQueryType::IRPass</a>);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordflow">if</span> (OptForSize)</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160; </div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <span class="keywordflow">if</span> (!Len)</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IncLen =</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateAdd(Len, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a>-&gt;getType(), 1), <span class="stringliteral">&quot;leninc&quot;</span>);</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(Dest, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), IncLen);</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160; </div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="comment">// The sprintf result is the unincremented number of bytes in the string.</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(Len, CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;  }</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;}</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; </div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeSPrintF(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *FT = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>();</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeSPrintFString(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>)) {</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;  }</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160; </div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, {0, 1});</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  <span class="comment">// sprintf(str, format, ...) -&gt; siprintf(str, format, ...) if no floating</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  <span class="comment">// point arguments.</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_siprintf) &amp;&amp;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      !<a class="code" href="SimplifyLibCalls_8cpp.html#ae56877b571bfd107841dabb130c9f2ca">callHasFloatingPointArgument</a>(CI)) {</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> SIPrintFFn = <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(M, *TLI, LibFunc_siprintf,</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                                                   FT, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getAttributes());</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = cast&lt;CallInst&gt;(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setCalledFunction(SIPrintFFn);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Insert(New);</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;  }</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160; </div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;  <span class="comment">// sprintf(str, format, ...) -&gt; __small_sprintf(str, format, ...) if no 128-bit</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;  <span class="comment">// floating point arguments.</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_small_sprintf) &amp;&amp;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      !<a class="code" href="SimplifyLibCalls_8cpp.html#ae817e73e41b3b26068e6b8a50cd447af">callHasFP128Argument</a>(CI)) {</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="keyword">auto</span> SmallSPrintFFn = <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(M, *TLI, LibFunc_small_sprintf, FT,</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;                                             <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getAttributes());</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = cast&lt;CallInst&gt;(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setCalledFunction(SmallSPrintFFn);</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Insert(New);</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;  }</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;}</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160; </div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="comment">// Transform an snprintf call CI with the bound N to format the string Str</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="comment">// either to a call to memcpy, or to single character a store, or to nothing,</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="comment">// and fold the result to a constant.  A nonnull StrArg refers to the string</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;<span class="comment">// argument being formatted.  Otherwise the call is one with N &lt; 2 and</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="comment">// the &quot;%c&quot; directive to format a single character.</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::emitSnPrintfMemCpy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1Value.html">Value</a> *StrArg,</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                                             <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>,</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;                                             <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StrArg || (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &lt; 2 &amp;&amp; Str.size() == 1));</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  <span class="keywordtype">unsigned</span> IntBits = TLI-&gt;getIntSize();</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> IntMax = <a class="code" href="namespacellvm.html#a08b6d5c69d7933ac65aae84e1b50fa62">maxIntN</a>(IntBits);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  <span class="keywordflow">if</span> (Str.size() &gt; IntMax)</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="comment">// Bail if the string is longer than INT_MAX.  POSIX requires</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    <span class="comment">// implementations to set errno to EOVERFLOW in this case, in</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    <span class="comment">// addition to when N is larger than that (checked by the caller).</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160; </div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StrLen = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Str.size());</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> == 0)</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    <span class="keywordflow">return</span> StrLen;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160; </div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  <span class="comment">// Set to the number of bytes to copy fron StrArg which is also</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  <span class="comment">// the offset of the terinating nul.</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NCopy;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &gt; Str.size())</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <span class="comment">// Copy the full string, including the terminating nul (which must</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="comment">// be present regardless of the bound).</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    NCopy = Str.size() + 1;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    NCopy = <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> - 1;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160; </div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DstArg = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="keywordflow">if</span> (NCopy &amp;&amp; StrArg)</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="comment">// Transform the call to lvm.memcpy(dst, fmt, N).</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;         *CI,</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;          <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                         DstArg, <a class="code" href="structllvm_1_1Align.html">Align</a>(1), StrArg, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1),</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;              <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()), NCopy)));</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160; </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &gt; Str.size())</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    <span class="comment">// Return early when the whole format string, including the final nul,</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <span class="comment">// has been copied.</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <span class="keywordflow">return</span> StrLen;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; </div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <span class="comment">// Otherwise, when truncating the string append a terminating nul.</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Int8Ty = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty();</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NulOff = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntN(IntBits, NCopy);</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DstEnd = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(Int8Ty, DstArg, NulOff, <span class="stringliteral">&quot;endptr&quot;</span>);</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(Int8Ty, 0), DstEnd);</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  <span class="keywordflow">return</span> StrLen;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;}</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160; </div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeSnPrintFString(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                                                 <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  <span class="comment">// Check for size</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  <span class="keywordflow">if</span> (!Size)</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160; </div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>-&gt;getZExtValue();</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> IntMax = <a class="code" href="namespacellvm.html#a08b6d5c69d7933ac65aae84e1b50fa62">maxIntN</a>(TLI-&gt;getIntSize());</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &gt; IntMax)</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="comment">// Bail if the bound exceeds INT_MAX.  POSIX requires implementations</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <span class="comment">// to set errno to EOVERFLOW in this case.</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160; </div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DstArg = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FmtArg = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160; </div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  <span class="comment">// Check for a fixed format string.</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> FormatStr;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(FmtArg, FormatStr))</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;  <span class="comment">// If we just have a format string (nothing else crazy) transform it.</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() == 3) {</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a83a294111af6d4412163b209725ca556">contains</a>(<span class="charliteral">&#39;%&#39;</span>))</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      <span class="comment">// Bail if the format string contains a directive and there are</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <span class="comment">// no arguments.  We could handle &quot;%%&quot; in the future.</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160; </div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    <span class="keywordflow">return</span> emitSnPrintfMemCpy(CI, FmtArg, FormatStr, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;  }</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160; </div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  <span class="comment">// The remaining optimizations require the format string to be &quot;%s&quot; or &quot;%c&quot;</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  <span class="comment">// and have an extra operand.</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;  <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() != 2 || FormatStr[0] != <span class="charliteral">&#39;%&#39;</span> || CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() != 4)</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160; </div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;  <span class="comment">// Decode the second character of the format string.</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;  <span class="keywordflow">if</span> (FormatStr[1] == <span class="charliteral">&#39;c&#39;</span>) {</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> &lt;= 1) {</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      <span class="comment">// Use an arbitary string of length 1 to transform the call into</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;      <span class="comment">// either a nul store (N == 1) or a no-op (N == 0) and fold it</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;      <span class="comment">// to one.</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;      <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> CharStr(<span class="stringliteral">&quot;*&quot;</span>);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      <span class="keywordflow">return</span> emitSnPrintfMemCpy(CI, <span class="keyword">nullptr</span>, CharStr, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    }</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160; </div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    <span class="comment">// snprintf(dst, size, &quot;%c&quot;, chr) --&gt; *(i8*)dst = chr; *((i8*)dst+1) = 0</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateTrunc(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <span class="stringliteral">&quot;char&quot;</span>);</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="namespacellvm.html#a1f00bd493d9df4474770b08908867a69">castToCStr</a>(DstArg, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(V, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt32(1), <span class="stringliteral">&quot;nul&quot;</span>);</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateStore(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8(0), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 1);</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  }</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160; </div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  <span class="keywordflow">if</span> (FormatStr[1] != <span class="charliteral">&#39;s&#39;</span>)</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160; </div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StrArg = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  <span class="comment">// snprintf(dest, size, &quot;%s&quot;, str) to llvm.memcpy(dest, str, len+1, 1)</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(StrArg, Str))</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160; </div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  <span class="keywordflow">return</span> emitSnPrintfMemCpy(CI, StrArg, Str, <a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;}</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160; </div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeSnPrintF(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeSnPrintFString(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>)) {</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  }</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160; </div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(CI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;}</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160; </div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFPrintFString(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;                                                <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  optimizeErrorReporting(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, 0);</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160; </div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  <span class="comment">// All the optimizations depend on the format string.</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> FormatStr;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), FormatStr))</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;  <span class="comment">// Do not do any of the following transformations if the fprintf return</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  <span class="comment">// value is used, in general the fprintf return value is not compatible</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;  <span class="comment">// with fwrite(), fputc() or fputs().</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160; </div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;  <span class="comment">// fprintf(F, &quot;foo&quot;) --&gt; fwrite(&quot;foo&quot;, 3, 1, F)</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() == 2) {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    <span class="comment">// Could handle %% -&gt; % if we cared.</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a83a294111af6d4412163b209725ca556">contains</a>(<span class="charliteral">&#39;%&#39;</span>))</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// We found a format specifier.</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160; </div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="keywordtype">unsigned</span> SizeTBits = TLI-&gt;getSizeTSize(*CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>());</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTTy = <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), SizeTBits);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        *CI, <a class="code" href="namespacellvm.html#a9a2a45b5fd2f1698d6fd10a06a0a38f2">emitFWrite</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                        <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTTy, FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>()),</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                        CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  }</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;  <span class="comment">// The remaining optimizations require the format string to be &quot;%s&quot; or &quot;%c&quot;</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  <span class="comment">// and have an extra operand.</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  <span class="keywordflow">if</span> (FormatStr.<a class="code" href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">size</a>() != 2 || FormatStr[0] != <span class="charliteral">&#39;%&#39;</span> || CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>() &lt; 3)</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160; </div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;  <span class="comment">// Decode the second character of the format string.</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;  <span class="keywordflow">if</span> (FormatStr[1] == <span class="charliteral">&#39;c&#39;</span>) {</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <span class="comment">// fprintf(F, &quot;%c&quot;, chr) --&gt; fputc((int)chr, F)</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntNTy(TLI-&gt;getIntSize());</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), IntTy, <span class="comment">/*isSigned*/</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;                               <span class="stringliteral">&quot;chari&quot;</span>);</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a8a6b92032e49dc6da4a5c4a05771878f">emitFPutC</a>(V, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  <span class="keywordflow">if</span> (FormatStr[1] == <span class="charliteral">&#39;s&#39;</span>) {</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <span class="comment">// fprintf(F, &quot;%s&quot;, str) --&gt; fputs(str, F)</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        *CI, <a class="code" href="namespacellvm.html#a689dd439a7989cc49b73cd6eb52d90dc">emitFPutS</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  }</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;}</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160; </div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFPrintF(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  <a class="code" href="classllvm_1_1FunctionType.html">FunctionType</a> *FT = <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;<a class="code" href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">getFunctionType</a>();</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeFPrintFString(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>)) {</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;  }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160; </div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;  <span class="comment">// fprintf(stream, format, ...) -&gt; fiprintf(stream, format, ...) if no</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;  <span class="comment">// floating point arguments.</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_fiprintf) &amp;&amp;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      !<a class="code" href="SimplifyLibCalls_8cpp.html#ae56877b571bfd107841dabb130c9f2ca">callHasFloatingPointArgument</a>(CI)) {</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;    <a class="code" href="classllvm_1_1FunctionCallee.html">FunctionCallee</a> FIPrintFFn = <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(M, *TLI, LibFunc_fiprintf,</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                                                   FT, <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getAttributes());</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = cast&lt;CallInst&gt;(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setCalledFunction(FIPrintFFn);</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Insert(New);</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  }</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160; </div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  <span class="comment">// fprintf(stream, format, ...) -&gt; __small_fprintf(stream, format, ...) if no</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  <span class="comment">// 128-bit floating point arguments.</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, LibFunc_small_fprintf) &amp;&amp;</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;      !<a class="code" href="SimplifyLibCalls_8cpp.html#ae817e73e41b3b26068e6b8a50cd447af">callHasFP128Argument</a>(CI)) {</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    <span class="keyword">auto</span> SmallFPrintFFn =</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        <a class="code" href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">getOrInsertLibFunc</a>(M, *TLI, LibFunc_small_fprintf, FT,</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                           <a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getAttributes());</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = cast&lt;CallInst&gt;(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>());</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setCalledFunction(SmallFPrintFFn);</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.Insert(New);</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;  }</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160; </div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;}</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160; </div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFWrite(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;  optimizeErrorReporting(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, 3);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160; </div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;  <span class="comment">// Get the element size and count.</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *SizeC = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1));</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CountC = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <span class="keywordflow">if</span> (SizeC &amp;&amp; CountC) {</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Bytes = SizeC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>() * CountC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; </div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    <span class="comment">// If this is writing zero records, remove the call (it&#39;s a noop).</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <span class="keywordflow">if</span> (Bytes == 0)</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 0);</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160; </div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    <span class="comment">// If this is writing one byte, turn it into fputc.</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    <span class="comment">// This optimisation is only valid, if the return value is unused.</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <span class="keywordflow">if</span> (Bytes == 1 &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>()) { <span class="comment">// fwrite(S,1,1,F) -&gt; fputc(S[0],F)</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1pdb.html#a29a5bdf367e3f74df9228dfce2c93a6fa8e95e84813830072b7516cfaa7dbc1a9">Char</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateLoad(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(),</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;                                 <a class="code" href="namespacellvm.html#a1f00bd493d9df4474770b08908867a69">castToCStr</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>), <span class="stringliteral">&quot;char&quot;</span>);</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getIntNTy(TLI-&gt;getIntSize());</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Cast = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(Char, IntTy, <span class="comment">/*isSigned*/</span> <span class="keyword">true</span>, <span class="stringliteral">&quot;chari&quot;</span>);</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NewCI = <a class="code" href="namespacellvm.html#a8a6b92032e49dc6da4a5c4a05771878f">emitFPutC</a>(Cast, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI);</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      <span class="keywordflow">return</span> NewCI ? <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 1) : nullptr;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    }</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;  }</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160; </div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;}</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160; </div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFPuts(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  optimizeErrorReporting(CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, 1);</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160; </div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;  <span class="comment">// Don&#39;t rewrite fputs to fwrite when optimising for size because fwrite</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  <span class="comment">// requires more arguments and thus extra MOVs are required.</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  <span class="keywordtype">bool</span> OptForSize = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">getFunction</a>()-&gt;<a class="code" href="classllvm_1_1Function.html#a1c455e007178a24dfb18ac0e200ea02c">hasOptSize</a>() ||</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;                    <a class="code" href="namespacellvm.html#a3af72f14ea20f2c762c751d2d49e5ea3">llvm::shouldOptimizeForSize</a>(CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), PSI, <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>,</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;                                                <a class="code" href="namespacellvm.html#aec7c967a5416fa6e154433965357a50ea089e7eb4db258e05f70eef4ed5aa10bb">PGSOQueryType::IRPass</a>);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;  <span class="keywordflow">if</span> (OptForSize)</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160; </div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  <span class="comment">// We can&#39;t optimize if return value is used.</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  <span class="comment">// fputs(s,F) --&gt; fwrite(s,strlen(s),1,F)</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;  <span class="keywordflow">if</span> (!Len)</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160; </div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;  <span class="comment">// Known to have no uses (see above).</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;  <span class="keywordtype">unsigned</span> SizeTBits = TLI-&gt;getSizeTSize(*CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>());</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTTy = <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), SizeTBits);</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;      *CI,</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <a class="code" href="namespacellvm.html#a9a2a45b5fd2f1698d6fd10a06a0a38f2">emitFWrite</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0),</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                 <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTTy, Len - 1),</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                 CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI));</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;}</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160; </div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizePuts(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;  <a class="code" href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a>(CI, 0);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  <span class="keywordflow">if</span> (!CI-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160; </div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  <span class="comment">// Check for a constant string.</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <span class="comment">// puts(&quot;&quot;) -&gt; putchar(&#39;\n&#39;)</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Str;</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">getConstantStringInfo</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), Str) &amp;&amp; Str.empty()) {</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    <span class="comment">// putchar takes an argument of the same type as puts returns, i.e.,</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    <span class="comment">// int, which need not be 32 bits wide.</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy = CI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a11b84a626ef34d3ced2e131937e58ddd">emitPutChar</a>(<a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(IntTy, <span class="charliteral">&#39;\n&#39;</span>), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  }</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160; </div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;}</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160; </div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeBCopy(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;  <span class="comment">// bcopy(src, dst, n) -&gt; llvm.memmove(dst, src, n)</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemMove(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="structllvm_1_1Align.html">Align</a>(1),</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                                        CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="structllvm_1_1Align.html">Align</a>(1),</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                                        CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2)));</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;}</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; </div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="keywordtype">bool</span> LibCallSimplifier::hasFloatVersion(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Module.html">Module</a> *M, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> FuncName) {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  <a class="code" href="classllvm_1_1SmallString.html">SmallString&lt;20&gt;</a> FloatFuncName = FuncName;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;  FloatFuncName += <span class="charliteral">&#39;f&#39;</span>;</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, FloatFuncName);</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;}</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160; </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeStringMemoryLibCall(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> <a class="code" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  <span class="comment">// Check for string/memory library functions.</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  <span class="keywordflow">if</span> (TLI-&gt;getLibFunc(*Callee, Func) &amp;&amp; <a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(M, TLI, Func)) {</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <span class="comment">// Make sure we never change the calling convention.</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;        (<a class="code" href="SimplifyLibCalls_8cpp.html#a613c1a46385c58d54da4ac29ec17994c">ignoreCallingConv</a>(Func) ||</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;         <a class="code" href="classllvm_1_1TargetLibraryInfoImpl.html#a6fe2425902ca5775f3b350cfbe49cc8f">TargetLibraryInfoImpl::isCallingConvCCompatible</a>(CI)) &amp;&amp;</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;        <span class="stringliteral">&quot;Optimizing string/memory libcall would change the calling convention&quot;</span>);</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <span class="keywordflow">switch</span> (Func) {</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <span class="keywordflow">case</span> LibFunc_strcat:</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;      <span class="keywordflow">return</span> optimizeStrCat(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="keywordflow">case</span> LibFunc_strncat:</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      <span class="keywordflow">return</span> optimizeStrNCat(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    <span class="keywordflow">case</span> LibFunc_strchr:</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      <span class="keywordflow">return</span> optimizeStrChr(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <span class="keywordflow">case</span> LibFunc_strrchr:</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      <span class="keywordflow">return</span> optimizeStrRChr(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    <span class="keywordflow">case</span> LibFunc_strcmp:</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      <span class="keywordflow">return</span> optimizeStrCmp(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    <span class="keywordflow">case</span> LibFunc_strncmp:</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;      <span class="keywordflow">return</span> optimizeStrNCmp(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    <span class="keywordflow">case</span> LibFunc_strcpy:</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;      <span class="keywordflow">return</span> optimizeStrCpy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    <span class="keywordflow">case</span> LibFunc_stpcpy:</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      <span class="keywordflow">return</span> optimizeStpCpy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;    <span class="keywordflow">case</span> LibFunc_strlcpy:</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;      <span class="keywordflow">return</span> optimizeStrLCpy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    <span class="keywordflow">case</span> LibFunc_stpncpy:</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;      <span class="keywordflow">return</span> optimizeStringNCpy(CI, <span class="comment">/*RetEnd=*/</span><span class="keyword">true</span>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    <span class="keywordflow">case</span> LibFunc_strncpy:</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;      <span class="keywordflow">return</span> optimizeStringNCpy(CI, <span class="comment">/*RetEnd=*/</span><span class="keyword">false</span>, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    <span class="keywordflow">case</span> LibFunc_strlen:</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <span class="keywordflow">return</span> optimizeStrLen(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    <span class="keywordflow">case</span> LibFunc_strnlen:</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      <span class="keywordflow">return</span> optimizeStrNLen(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;    <span class="keywordflow">case</span> LibFunc_strpbrk:</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      <span class="keywordflow">return</span> optimizeStrPBrk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    <span class="keywordflow">case</span> LibFunc_strndup:</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;      <span class="keywordflow">return</span> optimizeStrNDup(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtol:</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtod:</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtof:</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtoul:</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtoll:</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtold:</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtoull:</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      <span class="keywordflow">return</span> optimizeStrTo(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;    <span class="keywordflow">case</span> LibFunc_strspn:</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      <span class="keywordflow">return</span> optimizeStrSpn(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    <span class="keywordflow">case</span> LibFunc_strcspn:</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      <span class="keywordflow">return</span> optimizeStrCSpn(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;    <span class="keywordflow">case</span> LibFunc_strstr:</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <span class="keywordflow">return</span> optimizeStrStr(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <span class="keywordflow">case</span> LibFunc_memchr:</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;      <span class="keywordflow">return</span> optimizeMemChr(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <span class="keywordflow">case</span> LibFunc_memrchr:</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      <span class="keywordflow">return</span> optimizeMemRChr(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    <span class="keywordflow">case</span> LibFunc_bcmp:</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      <span class="keywordflow">return</span> optimizeBCmp(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    <span class="keywordflow">case</span> LibFunc_memcmp:</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      <span class="keywordflow">return</span> optimizeMemCmp(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    <span class="keywordflow">case</span> LibFunc_memcpy:</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      <span class="keywordflow">return</span> optimizeMemCpy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keywordflow">case</span> LibFunc_memccpy:</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      <span class="keywordflow">return</span> optimizeMemCCpy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;    <span class="keywordflow">case</span> LibFunc_mempcpy:</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;      <span class="keywordflow">return</span> optimizeMemPCpy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;    <span class="keywordflow">case</span> LibFunc_memmove:</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;      <span class="keywordflow">return</span> optimizeMemMove(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <span class="keywordflow">case</span> LibFunc_memset:</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;      <span class="keywordflow">return</span> optimizeMemSet(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    <span class="keywordflow">case</span> LibFunc_realloc:</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      <span class="keywordflow">return</span> optimizeRealloc(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <span class="keywordflow">case</span> LibFunc_wcslen:</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;      <span class="keywordflow">return</span> optimizeWcslen(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    <span class="keywordflow">case</span> LibFunc_bcopy:</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      <span class="keywordflow">return</span> optimizeBCopy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;    }</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  }</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;}</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; </div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *LibCallSimplifier::optimizeFloatingPointLibCall(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                                                       <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> Func,</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                                                       <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160; </div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  <span class="comment">// Don&#39;t optimize calls that require strict floating point semantics.</span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a300433f583bb9e2862b84df663f43f40">isStrictFP</a>())</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160; </div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="SimplifyLibCalls_8cpp.html#af91095dff7bacd615e3add3634f489ea">optimizeTrigReflections</a>(CI, Func, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>))</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160; </div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;  <span class="keywordflow">switch</span> (Func) {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;  <span class="keywordflow">case</span> LibFunc_sinpif:</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;  <span class="keywordflow">case</span> LibFunc_sinpi:</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;  <span class="keywordflow">case</span> LibFunc_cospif:</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;  <span class="keywordflow">case</span> LibFunc_cospi:</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <span class="keywordflow">return</span> optimizeSinCosPi(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;  <span class="keywordflow">case</span> LibFunc_powf:</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;  <span class="keywordflow">case</span> LibFunc_pow:</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;  <span class="keywordflow">case</span> LibFunc_powl:</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <span class="keywordflow">return</span> optimizePow(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;  <span class="keywordflow">case</span> LibFunc_exp2l:</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;  <span class="keywordflow">case</span> LibFunc_exp2:</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;  <span class="keywordflow">case</span> LibFunc_exp2f:</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    <span class="keywordflow">return</span> optimizeExp2(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;  <span class="keywordflow">case</span> LibFunc_fabsf:</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;  <span class="keywordflow">case</span> LibFunc_fabs:</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;  <span class="keywordflow">case</span> LibFunc_fabsl:</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Intrinsic::fabs);</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;  <span class="keywordflow">case</span> LibFunc_sqrtf:</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;  <span class="keywordflow">case</span> LibFunc_sqrt:</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;  <span class="keywordflow">case</span> LibFunc_sqrtl:</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    <span class="keywordflow">return</span> optimizeSqrt(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;  <span class="keywordflow">case</span> LibFunc_logf:</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;  <span class="keywordflow">case</span> LibFunc_log:</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;  <span class="keywordflow">case</span> LibFunc_logl:</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;  <span class="keywordflow">case</span> LibFunc_log10f:</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;  <span class="keywordflow">case</span> LibFunc_log10:</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;  <span class="keywordflow">case</span> LibFunc_log10l:</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  <span class="keywordflow">case</span> LibFunc_log1pf:</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;  <span class="keywordflow">case</span> LibFunc_log1p:</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;  <span class="keywordflow">case</span> LibFunc_log1pl:</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;  <span class="keywordflow">case</span> LibFunc_log2f:</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;  <span class="keywordflow">case</span> LibFunc_log2:</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;  <span class="keywordflow">case</span> LibFunc_log2l:</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;  <span class="keywordflow">case</span> LibFunc_logbf:</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;  <span class="keywordflow">case</span> LibFunc_logb:</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;  <span class="keywordflow">case</span> LibFunc_logbl:</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    <span class="keywordflow">return</span> optimizeLog(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  <span class="keywordflow">case</span> LibFunc_tan:</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  <span class="keywordflow">case</span> LibFunc_tanf:</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  <span class="keywordflow">case</span> LibFunc_tanl:</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;    <span class="keywordflow">return</span> optimizeTan(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;  <span class="keywordflow">case</span> LibFunc_ceil:</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="README-FPStack_8txt.html#a9209b9930d4d7750a6b8b38b3b4ddd6a">Intrinsic::ceil</a>);</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;  <span class="keywordflow">case</span> LibFunc_floor:</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="README-FPStack_8txt.html#ac25bbfa16d28ab1f83da03668addad0a">Intrinsic::floor</a>);</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;  <span class="keywordflow">case</span> LibFunc_round:</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="xxhash_8cpp.html#ae4e947c75dafebd71b8de03cd0dbf5d6">Intrinsic::round</a>);</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;  <span class="keywordflow">case</span> LibFunc_roundeven:</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Intrinsic::roundeven);</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;  <span class="keywordflow">case</span> LibFunc_nearbyint:</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Intrinsic::nearbyint);</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;  <span class="keywordflow">case</span> LibFunc_rint:</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Intrinsic::rint);</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;  <span class="keywordflow">case</span> LibFunc_trunc:</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="README-FPStack_8txt.html#aeb9a134c2755c0ad7801bf630a790904">Intrinsic::trunc</a>);</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;  <span class="keywordflow">case</span> LibFunc_acos:</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;  <span class="keywordflow">case</span> LibFunc_acosh:</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;  <span class="keywordflow">case</span> LibFunc_asin:</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;  <span class="keywordflow">case</span> LibFunc_asinh:</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  <span class="keywordflow">case</span> LibFunc_atan:</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;  <span class="keywordflow">case</span> LibFunc_atanh:</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;  <span class="keywordflow">case</span> LibFunc_cbrt:</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;  <span class="keywordflow">case</span> LibFunc_cosh:</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;  <span class="keywordflow">case</span> LibFunc_exp:</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;  <span class="keywordflow">case</span> LibFunc_exp10:</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;  <span class="keywordflow">case</span> LibFunc_expm1:</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;  <span class="keywordflow">case</span> LibFunc_cos:</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;  <span class="keywordflow">case</span> LibFunc_sin:</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;  <span class="keywordflow">case</span> LibFunc_sinh:</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;  <span class="keywordflow">case</span> LibFunc_tanh:</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    <span class="keywordflow">if</span> (UnsafeFPShrink &amp;&amp; hasFloatVersion(M, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()))</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3">optimizeUnaryDoubleFP</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, TLI, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;  <span class="keywordflow">case</span> LibFunc_copysign:</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    <span class="keywordflow">if</span> (hasFloatVersion(M, CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()))</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a4826c8503f42d50634e8fdce6e756be1">optimizeBinaryDoubleFP</a>(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, TLI);</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;  <span class="keywordflow">case</span> LibFunc_fminf:</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;  <span class="keywordflow">case</span> LibFunc_fmin:</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;  <span class="keywordflow">case</span> LibFunc_fminl:</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;  <span class="keywordflow">case</span> LibFunc_fmaxf:</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;  <span class="keywordflow">case</span> LibFunc_fmax:</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;  <span class="keywordflow">case</span> LibFunc_fmaxl:</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    <span class="keywordflow">return</span> optimizeFMinFMax(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;  <span class="keywordflow">case</span> LibFunc_cabs:</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;  <span class="keywordflow">case</span> LibFunc_cabsf:</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;  <span class="keywordflow">case</span> LibFunc_cabsl:</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    <span class="keywordflow">return</span> optimizeCAbs(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;  }</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;}</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160; </div>
<div class="line"><a name="l03564"></a><span class="lineno"><a class="line" href="classllvm_1_1LibCallSimplifier.html#a73c4a774eb638f963533b77f7124293b"> 3564</a></span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classllvm_1_1LibCallSimplifier.html#a73c4a774eb638f963533b77f7124293b">LibCallSimplifier::optimizeCall</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>();</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!CI-&gt;<a class="code" href="classllvm_1_1CallInst.html#ad3c897ba734b78e973db4622dff7bdcb">isMustTailCall</a>() &amp;&amp; <span class="stringliteral">&quot;These transforms aren&#39;t musttail safe.&quot;</span>);</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160; </div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;  <span class="comment">// TODO: Split out the code below that operates on FP calls so that</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;  <span class="comment">//       we can all non-FP calls with the StrictFP attribute to be</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  <span class="comment">//       optimized.</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;  <span class="keywordflow">if</span> (CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a1fb374eb65dcf7cd3d1671efb2616f76">isNoBuiltin</a>())</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160; </div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> Func;</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;  <span class="keywordtype">bool</span> IsCallingConvC = <a class="code" href="classllvm_1_1TargetLibraryInfoImpl.html#a6fe2425902ca5775f3b350cfbe49cc8f">TargetLibraryInfoImpl::isCallingConvCCompatible</a>(CI);</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160; </div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;OperandBundleDef, 2&gt;</a> OpBundles;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;  CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a19263fff7f5b3a9d22b48151fa0d85d0">getOperandBundlesAsDefs</a>(OpBundles);</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160; </div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1OperandBundlesGuard.html">IRBuilderBase::OperandBundlesGuard</a> Guard(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.setDefaultOperandBundles(OpBundles);</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160; </div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;  <span class="comment">// Command-line parameter overrides instruction attribute.</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  <span class="comment">// This can&#39;t be moved to optimizeFloatingPointLibCall() because it may be</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  <span class="comment">// used by the intrinsic optimizations.</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SimplifyLibCalls_8cpp.html#a1485593d8fe2ff9daade68b22fc01249">EnableUnsafeFPShrink</a>.<a class="code" href="classllvm_1_1cl_1_1Option.html#a2dc75fafb68e7669e776e19da7857cdf">getNumOccurrences</a>() &gt; 0)</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    UnsafeFPShrink = <a class="code" href="SimplifyLibCalls_8cpp.html#a1485593d8fe2ff9daade68b22fc01249">EnableUnsafeFPShrink</a>;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;FPMathOperator&gt;(CI) &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">isFast</a>())</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    UnsafeFPShrink = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160; </div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;  <span class="comment">// First, check for intrinsics.</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = dyn_cast&lt;IntrinsicInst&gt;(CI)) {</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    <span class="keywordflow">if</span> (!IsCallingConvC)</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    <span class="comment">// The FP intrinsics have corresponding constrained versions so we don&#39;t</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    <span class="comment">// need to check for the StrictFP attribute here.</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    <span class="keywordflow">switch</span> (II-&gt;getIntrinsicID()) {</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    <span class="keywordflow">case</span> Intrinsic::pow:</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      <span class="keywordflow">return</span> optimizePow(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="keywordflow">case</span> Intrinsic::exp2:</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;      <span class="keywordflow">return</span> optimizeExp2(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="keywordflow">case</span> Intrinsic::log:</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">Intrinsic::log2</a>:</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    <span class="keywordflow">case</span> Intrinsic::log10:</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      <span class="keywordflow">return</span> optimizeLog(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <span class="keywordflow">case</span> Intrinsic::sqrt:</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;      <span class="keywordflow">return</span> optimizeSqrt(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;    <span class="keywordflow">case</span> Intrinsic::memset:</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;      <span class="keywordflow">return</span> optimizeMemSet(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">Intrinsic::memcpy</a>:</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      <span class="keywordflow">return</span> optimizeMemCpy(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    <span class="keywordflow">case</span> Intrinsic::memmove:</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;      <span class="keywordflow">return</span> optimizeMemMove(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;    }</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;  }</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160; </div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  <span class="comment">// Also try to simplify calls to fortified library functions.</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *SimplifiedFortifiedCI =</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;          FortifiedSimplifier.optimizeCall(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>)) {</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    <span class="comment">// Try to further simplify the result.</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *SimplifiedCI = dyn_cast&lt;CallInst&gt;(SimplifiedFortifiedCI);</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    <span class="keywordflow">if</span> (SimplifiedCI &amp;&amp; SimplifiedCI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>()) {</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      <span class="comment">// Ensure that SimplifiedCI&#39;s uses are complete, since some calls have</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      <span class="comment">// their uses analyzed.</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      <a class="code" href="CodeGenPrepare_8cpp.html#a19e092ecf7889abf7277f13824e0c601">replaceAllUsesWith</a>(CI, SimplifiedCI);</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160; </div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;      <span class="comment">// Set insertion point to SimplifiedCI to guarantee we reach all uses</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      <span class="comment">// we might replace later on.</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      <a class="code" href="classllvm_1_1IRBuilderBase_1_1InsertPointGuard.html">IRBuilderBase::InsertPointGuard</a> Guard(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(SimplifiedCI);</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeStringMemoryLibCall(SimplifiedCI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>)) {</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;        <span class="comment">// If we were able to further simplify, remove the now redundant call.</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        substituteInParent(SimplifiedCI, V);</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;      }</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <span class="keywordflow">return</span> SimplifiedFortifiedCI;</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  }</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160; </div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;  <span class="comment">// Then check for known library functions.</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  <span class="keywordflow">if</span> (TLI-&gt;getLibFunc(*<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, Func) &amp;&amp; <a class="code" href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">isLibFuncEmittable</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, TLI, Func)) {</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;    <span class="comment">// We never change the calling convention.</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SimplifyLibCalls_8cpp.html#a613c1a46385c58d54da4ac29ec17994c">ignoreCallingConv</a>(Func) &amp;&amp; !IsCallingConvC)</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeStringMemoryLibCall(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>))</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = optimizeFloatingPointLibCall(CI, Func, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>))</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    <span class="keywordflow">switch</span> (Func) {</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    <span class="keywordflow">case</span> LibFunc_ffs:</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    <span class="keywordflow">case</span> LibFunc_ffsl:</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;    <span class="keywordflow">case</span> LibFunc_ffsll:</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      <span class="keywordflow">return</span> optimizeFFS(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    <span class="keywordflow">case</span> LibFunc_fls:</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    <span class="keywordflow">case</span> LibFunc_flsl:</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    <span class="keywordflow">case</span> LibFunc_flsll:</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      <span class="keywordflow">return</span> optimizeFls(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    <span class="keywordflow">case</span> LibFunc_abs:</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    <span class="keywordflow">case</span> LibFunc_labs:</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    <span class="keywordflow">case</span> LibFunc_llabs:</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;      <span class="keywordflow">return</span> optimizeAbs(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    <span class="keywordflow">case</span> LibFunc_isdigit:</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;      <span class="keywordflow">return</span> optimizeIsDigit(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    <span class="keywordflow">case</span> LibFunc_isascii:</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      <span class="keywordflow">return</span> optimizeIsAscii(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    <span class="keywordflow">case</span> LibFunc_toascii:</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      <span class="keywordflow">return</span> optimizeToAscii(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;    <span class="keywordflow">case</span> LibFunc_atoi:</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    <span class="keywordflow">case</span> LibFunc_atol:</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    <span class="keywordflow">case</span> LibFunc_atoll:</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <span class="keywordflow">return</span> optimizeAtoi(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtol:</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtoll:</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;      <span class="keywordflow">return</span> optimizeStrToInt(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <span class="comment">/*AsSigned=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtoul:</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    <span class="keywordflow">case</span> LibFunc_strtoull:</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;      <span class="keywordflow">return</span> optimizeStrToInt(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <span class="comment">/*AsSigned=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    <span class="keywordflow">case</span> LibFunc_printf:</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      <span class="keywordflow">return</span> optimizePrintF(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    <span class="keywordflow">case</span> LibFunc_sprintf:</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;      <span class="keywordflow">return</span> optimizeSPrintF(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    <span class="keywordflow">case</span> LibFunc_snprintf:</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      <span class="keywordflow">return</span> optimizeSnPrintF(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    <span class="keywordflow">case</span> LibFunc_fprintf:</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <span class="keywordflow">return</span> optimizeFPrintF(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    <span class="keywordflow">case</span> LibFunc_fwrite:</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;      <span class="keywordflow">return</span> optimizeFWrite(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    <span class="keywordflow">case</span> LibFunc_fputs:</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      <span class="keywordflow">return</span> optimizeFPuts(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    <span class="keywordflow">case</span> LibFunc_puts:</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      <span class="keywordflow">return</span> optimizePuts(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    <span class="keywordflow">case</span> LibFunc_perror:</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;      <span class="keywordflow">return</span> optimizeErrorReporting(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    <span class="keywordflow">case</span> LibFunc_vfprintf:</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    <span class="keywordflow">case</span> LibFunc_fiprintf:</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;      <span class="keywordflow">return</span> optimizeErrorReporting(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, 0);</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    }</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;  }</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;}</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160; </div>
<div class="line"><a name="l03707"></a><span class="lineno"><a class="line" href="classllvm_1_1LibCallSimplifier.html#a3f992eacdcd3c0f985a4ab77d8d4e937"> 3707</a></span>&#160;<a class="code" href="classllvm_1_1LibCallSimplifier.html#a3f992eacdcd3c0f985a4ab77d8d4e937">LibCallSimplifier::LibCallSimplifier</a>(</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI,</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE,</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>, <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI,</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keywordtype">void</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *, <a class="code" href="classllvm_1_1Value.html">Value</a> *)&gt; Replacer,</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<span class="keywordtype">void</span>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *)&gt; Eraser)</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    : FortifiedSimplifier(TLI), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), TLI(TLI), ORE(ORE), <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>(<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>), PSI(PSI),</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      Replacer(Replacer), Eraser(Eraser) {}</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160; </div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;<span class="keywordtype">void</span> LibCallSimplifier::replaceAllUsesWith(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *With) {</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  <span class="comment">// Indirect through the replacer used in this instance.</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;  Replacer(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, With);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;}</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160; </div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;<span class="keywordtype">void</span> LibCallSimplifier::eraseFromParent(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  Eraser(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;}</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160; </div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="comment">// TODO:</span></div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;<span class="comment">//   Additional cases that we need to add to this file:</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;<span class="comment">// cbrt:</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;<span class="comment">//   * cbrt(expN(X))  -&gt; expN(x/3)</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;<span class="comment">//   * cbrt(sqrt(x))  -&gt; pow(x,1/6)</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="comment">//   * cbrt(cbrt(x))  -&gt; pow(x,1/9)</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;<span class="comment">// exp, expf, expl:</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="comment">//   * exp(log(x))  -&gt; x</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;<span class="comment">// log, logf, logl:</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;<span class="comment">//   * log(exp(x))   -&gt; x</span></div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="comment">//   * log(exp(y))   -&gt; y*log(e)</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;<span class="comment">//   * log(exp10(y)) -&gt; y*log(10)</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;<span class="comment">//   * log(sqrt(x))  -&gt; 0.5*log(x)</span></div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;<span class="comment">// pow, powf, powl:</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;<span class="comment">//   * pow(sqrt(x),y) -&gt; pow(x,y*0.5)</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="comment">//   * pow(pow(x,y),z)-&gt; pow(x,y*z)</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="comment">// signbit:</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="comment">//   * signbit(cnst) -&gt; cnst&#39;</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="comment">//   * signbit(nncst) -&gt; 0 (if pstv is a non-negative constant)</span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="comment">// sqrt, sqrtf, sqrtl:</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="comment">//   * sqrt(expN(x))  -&gt; expN(x*0.5)</span></div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="comment">//   * sqrt(Nroot(x)) -&gt; pow(x,1/(2*N))</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="comment">//   * sqrt(pow(x,y)) -&gt; pow(|x|,y*0.5)</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160; </div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;<span class="comment">// Fortified Library Call Optimizations</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160; </div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;<span class="keywordtype">bool</span> FortifiedLibCallSimplifier::isFortifiedCallFoldable(</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI, <span class="keywordtype">unsigned</span> ObjSizeOp, std::optional&lt;unsigned&gt; SizeOp,</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;    std::optional&lt;unsigned&gt; StrOp, std::optional&lt;unsigned&gt; FlagOp) {</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;  <span class="comment">// If this function takes a flag argument, the implementation may use it to</span></div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;  <span class="comment">// perform extra checks. Don&#39;t fold into the non-checking variant.</span></div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  <span class="keywordflow">if</span> (FlagOp) {</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023">Flag</a> = dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(*FlagOp));</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023">Flag</a> || !<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023">Flag</a>-&gt;isZero())</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;  }</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160; </div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;  <span class="keywordflow">if</span> (SizeOp &amp;&amp; CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(ObjSizeOp) == CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(*SizeOp))</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160; </div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *ObjSizeCI =</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;          dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(ObjSizeOp))) {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;    <span class="keywordflow">if</span> (ObjSizeCI-&gt;isMinusOne())</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;    <span class="comment">// If the object size wasn&#39;t -1 (unknown), bail out if we were asked to.</span></div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;    <span class="keywordflow">if</span> (OnlyLowerUnknownSize)</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;    <span class="keywordflow">if</span> (StrOp) {</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(*StrOp));</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;      <span class="comment">// If the length is 0 we don&#39;t know how long it is and so we can&#39;t</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;      <span class="comment">// remove the check.</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      <span class="keywordflow">if</span> (Len)</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, *StrOp, Len);</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      <span class="keywordflow">return</span> ObjSizeCI-&gt;getZExtValue() &gt;= <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a>;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;    }</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160; </div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;    <span class="keywordflow">if</span> (SizeOp) {</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *SizeCI =</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;              dyn_cast&lt;ConstantInt&gt;(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(*SizeOp)))</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;        <span class="keywordflow">return</span> ObjSizeCI-&gt;getZExtValue() &gt;= SizeCI-&gt;getZExtValue();</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;    }</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;  }</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;}</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160; </div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeMemCpyChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;                                                     <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3, 2)) {</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI =</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemCpy(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                       <a class="code" href="structllvm_1_1Align.html">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;    <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;  }</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;}</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160; </div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeMemMoveChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3, 2)) {</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI =</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;        <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemMove(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="structllvm_1_1Align.html">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                        <a class="code" href="structllvm_1_1Align.html">Align</a>(1), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2));</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;    <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;  }</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;}</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160; </div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeMemSetChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                                                     <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3, 2)) {</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateIntCast(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *NewCI = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateMemSet(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), Val,</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                                     CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="structllvm_1_1Align.html">Align</a>(1));</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(NewCI, *CI);</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;    <span class="keywordflow">return</span> CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;  }</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;}</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160; </div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeMemPCpyChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3, 2))</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Call = <a class="code" href="namespacellvm.html#ae76b9bfb5e62fe86e9133d4a5b5bd275">emitMemPCpy</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;                                  CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI)) {</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a>(cast&lt;CallInst&gt;(Call), *CI);</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;    }</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;}</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160; </div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeStrpCpyChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                                                      <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> Func) {</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dst = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), *Src = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;        *ObjSize = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160; </div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  <span class="comment">// __stpcpy_chk(x,x,...)  -&gt; x+strlen(x)</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;  <span class="keywordflow">if</span> (Func == LibFunc_stpcpy_chk &amp;&amp; !OnlyLowerUnknownSize &amp;&amp; Dst == Src) {</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *StrLen = <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(Src, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI);</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    <span class="keywordflow">return</span> StrLen ? <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst, StrLen) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;  }</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160; </div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;  <span class="comment">// If a) we don&#39;t have any length information, or b) we know this will</span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;  <span class="comment">// fit then just lower to a plain st[rp]cpy. Otherwise we&#39;ll keep our</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;  <span class="comment">// st[rp]cpy_chk call which may fail at runtime if the size is too long.</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;  <span class="comment">// TODO: It might be nice to get a maximum length out of the possible</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;  <span class="comment">// string lengths for varying.</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 2, std::nullopt, 1)) {</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;    <span class="keywordflow">if</span> (Func == LibFunc_strcpy_chk)</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#ae1777b151b5f4127a3af26fa2f841a99">emitStrCpy</a>(Dst, Src, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#aa2219174d1d70af115609449fea112b1">emitStpCpy</a>(Dst, Src, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;  }</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160; </div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;  <span class="keywordflow">if</span> (OnlyLowerUnknownSize)</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160; </div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;  <span class="comment">// Maybe we can stil fold __st[rp]cpy_chk to __memcpy_chk.</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">GetStringLength</a>(Src);</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  <span class="keywordflow">if</span> (Len)</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    <a class="code" href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a>(CI, 1, Len);</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160; </div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;  <span class="keywordtype">unsigned</span> SizeTBits = TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a5b8cd043d27c642730b103a0eb241bd7">getSizeTSize</a>(*CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>());</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTTy = <a class="code" href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(CI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), SizeTBits);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LenV = <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTTy, Len);</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> = <a class="code" href="namespacellvm.html#a1484bdcb6b4c84ceb447270f8acca352">emitMemCpyChk</a>(Dst, Src, LenV, ObjSize, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TLI);</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;  <span class="comment">// If the function was an __stpcpy_chk, and we were able to fold it into</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;  <span class="comment">// a __memcpy_chk, we still need to return the correct end pointer.</span></div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a> &amp;&amp; Func == LibFunc_stpcpy_chk)</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.CreateInBoundsGEP(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>.getInt8Ty(), Dst,</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;                               <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(SizeTTy, Len - 1));</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, cast&lt;CallInst&gt;(<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">Ret</a>));</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;}</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160; </div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeStrLenChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;                                                     <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 1, std::nullopt, 0))</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI, <a class="code" href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">emitStrLen</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;                                     CI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>(), TLI));</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;}</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160; </div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeStrpNCpyChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;                                                       <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>,</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;                                                       <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> Func) {</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3, 2)) {</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    <span class="keywordflow">if</span> (Func == LibFunc_strncpy_chk)</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;                       <a class="code" href="namespacellvm.html#a14a05ffce8dd7f9e6fe4a0b96dc313e6">emitStrNCpy</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;                                   CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                       <a class="code" href="namespacellvm.html#a8c2ffb91a5485fa7becad0e00d7e1815">emitStpNCpy</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                                   CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;  }</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160; </div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;}</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160; </div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeMemCCpyChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 4, 3))</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        *CI, <a class="code" href="namespacellvm.html#ad286c87289a5549b40e06096076e2974">emitMemCCpy</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;                         CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160; </div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;}</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160; </div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeSNPrintfChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;                                                       <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3, 1, std::nullopt, 2)) {</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> VariadicArgs(<a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ac63dbb4994494c46f025715272cdb81e">args</a>(), 5));</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                     <a class="code" href="namespacellvm.html#a9b45cdd248363e4cae6c330d167f93f0">emitSNPrintf</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                                  CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(4), VariadicArgs, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;  }</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160; </div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;}</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160; </div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeSPrintfChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 2, std::nullopt, std::nullopt, 1)) {</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 8&gt;</a> VariadicArgs(<a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ac63dbb4994494c46f025715272cdb81e">args</a>(), 4));</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                     <a class="code" href="namespacellvm.html#a35f8c517a70dfe8d3d066407c441894f">emitSPrintf</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3),</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                                 VariadicArgs, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;  }</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160; </div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;}</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160; </div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeStrCatChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                                                     <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 2))</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;        *CI, <a class="code" href="namespacellvm.html#a8da8a33e55b9283587506d8ba68c0ab2">emitStrCat</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160; </div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;}</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160; </div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeStrLCat(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;                                                   <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3))</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;                     <a class="code" href="namespacellvm.html#a392fe07b95bac44c375179b4f16df1ec">emitStrLCat</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                                 CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160; </div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;}</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160; </div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeStrNCatChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3))</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                     <a class="code" href="namespacellvm.html#a572e1b920d8a5f2a338570c82bbeb446">emitStrNCat</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;                                 CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160; </div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;}</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160; </div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeStrLCpyChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                                                      <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3))</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                     <a class="code" href="namespacellvm.html#adee6ec38d5e042d13294bf047abc3245">emitStrLCpy</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;                                 CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160; </div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;}</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160; </div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeVSNPrintfChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;                                                        <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 3, 1, std::nullopt, 2))</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;        *CI, <a class="code" href="namespacellvm.html#a5d61091498dd892d586e250c8d29fe3a">emitVSNPrintf</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1),</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;                           CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(4), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(5), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160; </div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;}</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160; </div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *FortifiedLibCallSimplifier::optimizeVSPrintfChk(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;                                                       <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>) {</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;  <span class="keywordflow">if</span> (isFortifiedCallFoldable(CI, 2, std::nullopt, std::nullopt, 1))</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a>(*CI,</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                     <a class="code" href="namespacellvm.html#a9310a89abda7116ac06bf226544daadd">emitVSPrintf</a>(CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0), CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(3),</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                                  CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(4), <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, TLI));</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160; </div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;}</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160; </div>
<div class="line"><a name="l04013"></a><span class="lineno"><a class="line" href="classllvm_1_1FortifiedLibCallSimplifier.html#ab5f693b48590402b0109cfdca55ec335"> 4013</a></span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classllvm_1_1FortifiedLibCallSimplifier.html#ab5f693b48590402b0109cfdca55ec335">FortifiedLibCallSimplifier::optimizeCall</a>(<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI,</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;                                                <a class="code" href="classllvm_1_1IRBuilderBase.html">IRBuilderBase</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>) {</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;  <span class="comment">// FIXME: We shouldn&#39;t be changing &quot;nobuiltin&quot; or TLI unavailable calls here.</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;  <span class="comment">// Some clang users checked for _chk libcall availability using:</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;  <span class="comment">//   __has_builtin(__builtin___memcpy_chk)</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;  <span class="comment">// When compiling with -fno-builtin, this is always true.</span></div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;  <span class="comment">// When passing -ffreestanding/-mkernel, which both imply -fno-builtin, we</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;  <span class="comment">// end up with fortified libcalls, which isn&#39;t acceptable in a freestanding</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  <span class="comment">// environment which only provides their non-fortified counterparts.</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  <span class="comment">// Until we change clang and/or teach external users to check for availability</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;  <span class="comment">// differently, disregard the &quot;nobuiltin&quot; attribute and TLI::has.</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  <span class="comment">// PR23093.</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160; </div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;  <a class="code" href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">LibFunc</a> Func;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">getCalledFunction</a>();</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;  <span class="keywordtype">bool</span> IsCallingConvC = <a class="code" href="classllvm_1_1TargetLibraryInfoImpl.html#a6fe2425902ca5775f3b350cfbe49cc8f">TargetLibraryInfoImpl::isCallingConvCCompatible</a>(CI);</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160; </div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;OperandBundleDef, 2&gt;</a> OpBundles;</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;  CI-&gt;<a class="code" href="classllvm_1_1CallBase.html#a19263fff7f5b3a9d22b48151fa0d85d0">getOperandBundlesAsDefs</a>(OpBundles);</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160; </div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;  <a class="code" href="classllvm_1_1IRBuilderBase_1_1OperandBundlesGuard.html">IRBuilderBase::OperandBundlesGuard</a> Guard(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.setDefaultOperandBundles(OpBundles);</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160; </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;  <span class="comment">// First, check that this is a known library functions and that the prototype</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;  <span class="comment">// is correct.</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;  <span class="keywordflow">if</span> (!TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a97cfbbed8869e3582142012a071a9052">getLibFunc</a>(*<a class="code" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, Func))</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160; </div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  <span class="comment">// We never change the calling convention.</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SimplifyLibCalls_8cpp.html#a613c1a46385c58d54da4ac29ec17994c">ignoreCallingConv</a>(Func) &amp;&amp; !IsCallingConvC)</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160; </div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  <span class="keywordflow">switch</span> (Func) {</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;  <span class="keywordflow">case</span> LibFunc_memcpy_chk:</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    <span class="keywordflow">return</span> optimizeMemCpyChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;  <span class="keywordflow">case</span> LibFunc_mempcpy_chk:</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="keywordflow">return</span> optimizeMemPCpyChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;  <span class="keywordflow">case</span> LibFunc_memmove_chk:</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    <span class="keywordflow">return</span> optimizeMemMoveChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;  <span class="keywordflow">case</span> LibFunc_memset_chk:</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    <span class="keywordflow">return</span> optimizeMemSetChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;  <span class="keywordflow">case</span> LibFunc_stpcpy_chk:</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;  <span class="keywordflow">case</span> LibFunc_strcpy_chk:</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    <span class="keywordflow">return</span> optimizeStrpCpyChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Func);</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;  <span class="keywordflow">case</span> LibFunc_strlen_chk:</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    <span class="keywordflow">return</span> optimizeStrLenChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;  <span class="keywordflow">case</span> LibFunc_stpncpy_chk:</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;  <span class="keywordflow">case</span> LibFunc_strncpy_chk:</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <span class="keywordflow">return</span> optimizeStrpNCpyChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, Func);</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;  <span class="keywordflow">case</span> LibFunc_memccpy_chk:</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    <span class="keywordflow">return</span> optimizeMemCCpyChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;  <span class="keywordflow">case</span> LibFunc_snprintf_chk:</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;    <span class="keywordflow">return</span> optimizeSNPrintfChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;  <span class="keywordflow">case</span> LibFunc_sprintf_chk:</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    <span class="keywordflow">return</span> optimizeSPrintfChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;  <span class="keywordflow">case</span> LibFunc_strcat_chk:</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="keywordflow">return</span> optimizeStrCatChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  <span class="keywordflow">case</span> LibFunc_strlcat_chk:</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    <span class="keywordflow">return</span> optimizeStrLCat(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;  <span class="keywordflow">case</span> LibFunc_strncat_chk:</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <span class="keywordflow">return</span> optimizeStrNCatChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;  <span class="keywordflow">case</span> LibFunc_strlcpy_chk:</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <span class="keywordflow">return</span> optimizeStrLCpyChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;  <span class="keywordflow">case</span> LibFunc_vsnprintf_chk:</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    <span class="keywordflow">return</span> optimizeVSNPrintfChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;  <span class="keywordflow">case</span> LibFunc_vsprintf_chk:</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;    <span class="keywordflow">return</span> optimizeVSPrintfChk(CI, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;  }</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;}</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160; </div>
<div class="line"><a name="l04088"></a><span class="lineno"><a class="line" href="classllvm_1_1FortifiedLibCallSimplifier.html#a8a27937b281cb7fe3db8433b8cd5835d"> 4088</a></span>&#160;<a class="code" href="classllvm_1_1FortifiedLibCallSimplifier.html#a8a27937b281cb7fe3db8433b8cd5835d">FortifiedLibCallSimplifier::FortifiedLibCallSimplifier</a>(</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI, <span class="keywordtype">bool</span> OnlyLowerUnknownSize)</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    : TLI(TLI), OnlyLowerUnknownSize(OnlyLowerUnknownSize) {}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1Check_html_a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396"><div class="ttname"><a href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">llvm::Check::Size</a></div><div class="ttdeci">@ Size</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8h_source.html#l00077">FileCheck.h:77</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="anamespacellvm_1_1lltok_html_af353621f14cb4b4b3af5ffaff84076b1a56697632782c9ab774d6c132a955674a"><div class="ttname"><a href="namespacellvm_1_1lltok.html#af353621f14cb4b4b3af5ffaff84076b1a56697632782c9ab774d6c132a955674a">llvm::lltok::APFloat</a></div><div class="ttdeci">@ APFloat</div><div class="ttdef"><b>Definition:</b> <a href="LLToken_8h_source.html#l00461">LLToken.h:461</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a8269fab998356ea27a76ad45bd6cc8fe"><div class="ttname"><a href="classllvm_1_1APFloat.html#a8269fab998356ea27a76ad45bd6cc8fe">llvm::APFloat::convertToFloat</a></div><div class="ttdeci">float convertToFloat() const</div><div class="ttdoc">Converts this APFloat to host float value.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l05436">APFloat.cpp:5436</a></div></div>
<div class="ttc" id="aCodeGenPrepare_8cpp_html_a19e092ecf7889abf7277f13824e0c601"><div class="ttname"><a href="CodeGenPrepare_8cpp.html#a19e092ecf7889abf7277f13824e0c601">replaceAllUsesWith</a></div><div class="ttdeci">static void replaceAllUsesWith(Value *Old, Value *New, SmallSet&lt; BasicBlock *, 32 &gt; &amp;FreshBBs, bool IsHuge)</div><div class="ttdoc">Replace all old uses with new ones, and push the updated BBs into FreshBBs.</div><div class="ttdef"><b>Definition:</b> <a href="CodeGenPrepare_8cpp_source.html#l01029">CodeGenPrepare.cpp:1029</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9d3ba236d13373cde794da2023acc7a0"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9d3ba236d13373cde794da2023acc7a0">Attrs</a></div><div class="ttdeci">Function Attrs</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00215">README_ALTIVEC.txt:215</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a900a32da3983469187b1848189681705"><div class="ttname"><a href="classllvm_1_1Function.html#a900a32da3983469187b1848189681705">llvm::Function::isIntrinsic</a></div><div class="ttdeci">bool isIntrinsic() const</div><div class="ttdoc">isIntrinsic - Returns true if the function's name starts with &quot;llvm.&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00209">Function.h:209</a></div></div>
<div class="ttc" id="aMathExtras_8h_html"><div class="ttname"><a href="MathExtras_8h.html">MathExtras.h</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a1fb374eb65dcf7cd3d1671efb2616f76"><div class="ttname"><a href="classllvm_1_1CallBase.html#a1fb374eb65dcf7cd3d1671efb2616f76">llvm::CallBase::isNoBuiltin</a></div><div class="ttdeci">bool isNoBuiltin() const</div><div class="ttdoc">Return true if the call should not be treated as a call to a builtin.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01858">InstrTypes.h:1858</a></div></div>
<div class="ttc" id="aclassllvm_1_1FastMathFlags_html_acd492b88eb98461e692085ed400db114"><div class="ttname"><a href="classllvm_1_1FastMathFlags.html#acd492b88eb98461e692085ed400db114">llvm::FastMathFlags::getFast</a></div><div class="ttdeci">static FastMathFlags getFast()</div><div class="ttdef"><b>Definition:</b> <a href="FMF_8h_source.html#l00052">FMF.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a19263fff7f5b3a9d22b48151fa0d85d0"><div class="ttname"><a href="classllvm_1_1CallBase.html#a19263fff7f5b3a9d22b48151fa0d85d0">llvm::CallBase::getOperandBundlesAsDefs</a></div><div class="ttdeci">void getOperandBundlesAsDefs(SmallVectorImpl&lt; OperandBundleDef &gt; &amp;Defs) const</div><div class="ttdoc">Return the list of operand bundles attached to this instruction as a vector of OperandBundleDefs.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00425">Instructions.cpp:425</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a181299935120519ce8b8953da4d4d354"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a181299935120519ce8b8953da4d4d354">convertStrToInt</a></div><div class="ttdeci">static Value * convertStrToInt(CallInst *CI, StringRef &amp;Str, Value *EndPtr, uint64_t Base, bool AsSigned, IRBuilderBase &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00087">SimplifyLibCalls.cpp:87</a></div></div>
<div class="ttc" id="anamespacellvm_html_a02981de53fb6ffd384d39addc4d25f37"><div class="ttname"><a href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a></div><div class="ttdeci">auto drop_begin(T &amp;&amp;RangeOrContainer, size_t N=1)</div><div class="ttdoc">Return a range covering RangeOrContainer with the first N elements excluded.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00386">STLExtras.h:386</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a18fc4545474c6ebb6f7c547f64f4fb31"><div class="ttname"><a href="classllvm_1_1StructType.html#a18fc4545474c6ebb6f7c547f64f4fb31">llvm::StructType::get</a></div><div class="ttdeci">static StructType * get(LLVMContext &amp;Context, ArrayRef&lt; Type * &gt; Elements, bool isPacked=false)</div><div class="ttdoc">This static method is the primary way to create a literal StructType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00408">Type.cpp:408</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="astructllvm_1_1ConstantDataArraySlice_html_ac259d8d452474b84269b58dd573ed291"><div class="ttname"><a href="structllvm_1_1ConstantDataArraySlice.html#ac259d8d452474b84269b58dd573ed291">llvm::ConstantDataArraySlice::Array</a></div><div class="ttdeci">const ConstantDataArray * Array</div><div class="ttdoc">ConstantDataArray pointer.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8h_source.html#l00297">ValueTracking.h:297</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="anamespacellvm_html_aac36edd0f1ce976f0025c98e88d3830eab48b2a9934af7a531cfd7236ded9d50e"><div class="ttname"><a href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eab48b2a9934af7a531cfd7236ded9d50e">llvm::RecurKind::FMul</a></div><div class="ttdeci">@ FMul</div><div class="ttdoc">Product of floats.</div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a43117391a6d351518362783bff747d44"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a43117391a6d351518362783bff747d44">llvm::PatternMatch::m_SpecificFP</a></div><div class="ttdeci">specific_fpval m_SpecificFP(double V)</div><div class="ttdoc">Match a specific floating point value or vector with all elements equal to the value.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00815">PatternMatch.h:815</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a29a5bdf367e3f74df9228dfce2c93a6fa8e95e84813830072b7516cfaa7dbc1a9"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a29a5bdf367e3f74df9228dfce2c93a6fa8e95e84813830072b7516cfaa7dbc1a9">llvm::pdb::PDB_BuiltinType::Char</a></div><div class="ttdeci">@ Char</div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a0b931781aa589c6ebe64a76c1447e5b2"><div class="ttname"><a href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">llvm::User::operands</a></div><div class="ttdeci">op_range operands()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00242">User.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a2c8498183c5bce88fb4f651ee4169611"><div class="ttname"><a href="classllvm_1_1Instruction.html#a2c8498183c5bce88fb4f651ee4169611">llvm::Instruction::hasNoSignedZeros</a></div><div class="ttdeci">bool hasNoSignedZeros() const LLVM_READONLY</div><div class="ttdoc">Determine whether the no-signed-zeros flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00319">Instruction.cpp:319</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3b996fbf8458aafffc86cb98a68d0a47"><div class="ttname"><a href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const</div><div class="ttdoc">True if this is an instance of PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00249">Type.h:249</a></div></div>
<div class="ttc" id="aREADME-FPStack_8txt_html_a9209b9930d4d7750a6b8b38b3b4ddd6a"><div class="ttname"><a href="README-FPStack_8txt.html#a9209b9930d4d7750a6b8b38b3b4ddd6a">ceil</a></div><div class="ttdeci">We have fiadd patterns now but the followings have the same cost and complexity We need a way to specify the later is more profitable def def The FP stackifier should handle simple permutates to reduce number of shuffle e g ceil</div><div class="ttdef"><b>Definition:</b> <a href="README-FPStack_8txt_source.html#l00054">README-FPStack.txt:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a44602b2ea058f08b290a8fa0185909d1"><div class="ttname"><a href="classllvm_1_1APFloat.html#a44602b2ea058f08b290a8fa0185909d1">llvm::APFloat::add</a></div><div class="ttdeci">opStatus add(const APFloat &amp;RHS, roundingMode RM)</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01006">APFloat.h:1006</a></div></div>
<div class="ttc" id="astructllvm_1_1APFloatBase_html_a0c5765e9acba977f6e462c2917276d8f"><div class="ttname"><a href="structllvm_1_1APFloatBase.html#a0c5765e9acba977f6e462c2917276d8f">llvm::APFloatBase::IEEEsingle</a></div><div class="ttdeci">static const fltSemantics &amp; IEEEsingle() LLVM_READNONE</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l00244">APFloat.cpp:244</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a4471d0813af2c29201b8c3191e146370"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a4471d0813af2c29201b8c3191e146370">memChrToCharCompare</a></div><div class="ttdeci">static Value * memChrToCharCompare(CallInst *CI, Value *NBytes, IRBuilderBase &amp;B, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00395">SimplifyLibCalls.cpp:395</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a2e6d43b46806f4a27f61ae2fd14c0f69"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a2e6d43b46806f4a27f61ae2fd14c0f69">optimizeMemCmpConstantSize</a></div><div class="ttdeci">static Value * optimizeMemCmpConstantSize(CallInst *CI, Value *LHS, Value *RHS, uint64_t Len, IRBuilderBase &amp;B, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01458">SimplifyLibCalls.cpp:1458</a></div></div>
<div class="ttc" id="aLoads_8h_html"><div class="ttname"><a href="Loads_8h.html">Loads.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1FastMathFlags_html_a9b87b2b5c4b6b7d083212a0c93684f72"><div class="ttname"><a href="classllvm_1_1FastMathFlags.html#a9b87b2b5c4b6b7d083212a0c93684f72">llvm::FastMathFlags::setNoSignedZeros</a></div><div class="ttdeci">void setNoSignedZeros(bool B=true)</div><div class="ttdef"><b>Definition:</b> <a href="FMF_8h_source.html#l00086">FMF.h:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_ae0c6424784f132b91eb387a3ee0b57c9"><div class="ttname"><a href="classllvm_1_1StringRef.html#ae0c6424784f132b91eb387a3ee0b57c9">llvm::StringRef::compare</a></div><div class="ttdeci">int compare(StringRef RHS) const</div><div class="ttdoc">compare - Compare two strings; the result is negative, zero, or positive if this string is lexicograp...</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00177">StringRef.h:177</a></div></div>
<div class="ttc" id="aclassT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_aca14d9ec64ba4ab7fb2cef37c57d9ce4"><div class="ttname"><a href="classllvm_1_1APInt.html#aca14d9ec64ba4ab7fb2cef37c57d9ce4">llvm::APInt::ule</a></div><div class="ttdeci">bool ule(const APInt &amp;RHS) const</div><div class="ttdoc">Unsigned less or equal comparison.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01128">APInt.h:1128</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a766df1ea3c4bf3cbc8586f310562034f"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a766df1ea3c4bf3cbc8586f310562034f">isReportingError</a></div><div class="ttdeci">static bool isReportingError(Function *Callee, CallInst *CI, int StreamArg)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l02795">SimplifyLibCalls.cpp:2795</a></div></div>
<div class="ttc" id="aclassllvm_1_1Triple_html_a547abd13f7a3c063aa72c8192a868154a0eefa3e53db25b90828e42c64b138648"><div class="ttname"><a href="classllvm_1_1Triple.html#a547abd13f7a3c063aa72c8192a868154a0eefa3e53db25b90828e42c64b138648">llvm::Triple::x86</a></div><div class="ttdeci">@ x86</div><div class="ttdef"><b>Definition:</b> <a href="Triple_8h_source.html#l00085">Triple.h:85</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a8f87f39b5e0dedd0793bb3a450f463cf"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a8f87f39b5e0dedd0793bb3a450f463cf">llvm::PatternMatch::m_FPOne</a></div><div class="ttdeci">specific_fpval m_FPOne()</div><div class="ttdoc">Match a float 1.0 or vector with all elements equal to 1.0.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00818">PatternMatch.h:818</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a4abb39a66573f61fda80469faa5d861d"><div class="ttname"><a href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">llvm::Type::getScalarType</a></div><div class="ttdeci">Type * getScalarType() const</div><div class="ttdoc">If this is a vector type, return the element type, otherwise return 'this'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00341">Type.h:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_ad0f54a163ac500b144590640c6f1eb6b"><div class="ttname"><a href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">llvm::StringRef::npos</a></div><div class="ttdeci">static constexpr size_t npos</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00052">StringRef.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="anamespacellvm_html_a08d868189c5335a01b6415e379a0c68c"><div class="ttname"><a href="namespacellvm.html#a08d868189c5335a01b6415e379a0c68c">llvm::emitUnaryFloatFnCall</a></div><div class="ttdeci">Value * emitUnaryFloatFnCall(Value *Op, const TargetLibraryInfo *TLI, StringRef Name, IRBuilderBase &amp;B, const AttributeList &amp;Attrs)</div><div class="ttdoc">Emit a call to the unary function named 'Name' (e.g.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01719">BuildLibCalls.cpp:1719</a></div></div>
<div class="ttc" id="anamespacellvm_html_a64f1b4176cc7b8012657e7e04a687e66"><div class="ttname"><a href="namespacellvm.html#a64f1b4176cc7b8012657e7e04a687e66">llvm::emitMemCmp</a></div><div class="ttdeci">Value * emitMemCmp(Value *Ptr1, Value *Ptr2, Value *Len, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the memcmp function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01572">BuildLibCalls.cpp:1572</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9a2a45b5fd2f1698d6fd10a06a0a38f2"><div class="ttname"><a href="namespacellvm.html#a9a2a45b5fd2f1698d6fd10a06a0a38f2">llvm::emitFWrite</a></div><div class="ttdeci">Value * emitFWrite(Value *Ptr, Value *Size, Value *File, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the fwrite function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01877">BuildLibCalls.cpp:1877</a></div></div>
<div class="ttc" id="aSizeOpts_8h_html"><div class="ttname"><a href="SizeOpts_8h.html">SizeOpts.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantDataSequential_html_a9409db5c707242fc05b7b2abeba38506"><div class="ttname"><a href="classllvm_1_1ConstantDataSequential.html#a9409db5c707242fc05b7b2abeba38506">llvm::ConstantDataSequential::getElementAsInteger</a></div><div class="ttdeci">uint64_t getElementAsInteger(unsigned i) const</div><div class="ttdoc">If this is a sequential container of integers (of any size), return the specified element in the low ...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l03118">Constants.cpp:3118</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_ace4517dbbab7dbdefa0d31e29db55969"><div class="ttname"><a href="classllvm_1_1APFloat.html#ace4517dbbab7dbdefa0d31e29db55969">llvm::APFloat::isInteger</a></div><div class="ttdeci">bool isInteger() const</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01276">APFloat.h:1276</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalVariable_8h_source.html#l00039">GlobalVariable.h:39</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a35aa038c66bf741a35e18bf9d9d89493"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a35aa038c66bf741a35e18bf9d9d89493">createPowWithIntegerExponent</a></div><div class="ttdeci">static Value * createPowWithIntegerExponent(Value *Base, Value *Expo, Module *M, IRBuilderBase &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l02092">SimplifyLibCalls.cpp:2092</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_ae79d05dd3d0b05e080e08f8c5c33f880"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#ae79d05dd3d0b05e080e08f8c5c33f880">llvm::ConstantExpr::getBitCast</a></div><div class="ttdeci">static Constant * getBitCast(Constant *C, Type *Ty, bool OnlyIfReduced=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02229">Constants.cpp:2229</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad286c87289a5549b40e06096076e2974"><div class="ttname"><a href="namespacellvm.html#ad286c87289a5549b40e06096076e2974">llvm::emitMemCCpy</a></div><div class="ttdeci">Value * emitMemCCpy(Value *Ptr1, Value *Ptr2, Value *Val, Value *Len, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the memccpy function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01592">BuildLibCalls.cpp:1592</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_a5cc6492c8f2e06a8bae9dc0d121fab9f"><div class="ttname"><a href="classllvm_1_1AttributeList.html#a5cc6492c8f2e06a8bae9dc0d121fab9f">llvm::AttributeList::get</a></div><div class="ttdeci">static AttributeList get(LLVMContext &amp;C, ArrayRef&lt; std::pair&lt; unsigned, Attribute &gt;&gt; Attrs)</div><div class="ttdoc">Create an AttributeList with the specified parameters in it.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01132">Attributes.cpp:1132</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFP_html_a6f2864671b22c9f6135b6ae5d41bcf54"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a6f2864671b22c9f6135b6ae5d41bcf54">llvm::ConstantFP::getInfinity</a></div><div class="ttdeci">static Constant * getInfinity(Type *Ty, bool Negative=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01041">Constants.cpp:1041</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_acd794d7b3653822f61ba126e1678e03f"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#acd794d7b3653822f61ba126e1678e03f">llvm::PatternMatch::m_APFloat</a></div><div class="ttdeci">apfloat_match m_APFloat(const APFloat *&amp;Res)</div><div class="ttdoc">Match a ConstantFP or splatted ConstantVector, binding the specified pointer to the contained APFloat...</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00295">PatternMatch.h:295</a></div></div>
<div class="ttc" id="aclassllvm_1_1Triple_html"><div class="ttname"><a href="classllvm_1_1Triple.html">llvm::Triple</a></div><div class="ttdoc">Triple - Helper class for working with autoconf configuration names.</div><div class="ttdef"><b>Definition:</b> <a href="Triple_8h_source.html#l00044">Triple.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a2fbfe5377a984518a7c03d8558df726d"><div class="ttname"><a href="classllvm_1_1CallBase.html#a2fbfe5377a984518a7c03d8558df726d">llvm::CallBase::hasFnAttr</a></div><div class="ttdeci">bool hasFnAttr(Attribute::AttrKind Kind) const</div><div class="ttdoc">Determine whether this call has the given attribute.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01493">InstrTypes.h:1493</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="astructllvm_1_1ConstantDataArraySlice_html_aa521d739527c924cc3d0c7b40936ea45"><div class="ttname"><a href="structllvm_1_1ConstantDataArraySlice.html#aa521d739527c924cc3d0c7b40936ea45">llvm::ConstantDataArraySlice::Offset</a></div><div class="ttdeci">uint64_t Offset</div><div class="ttdoc">Slice starts at this Offset.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8h_source.html#l00300">ValueTracking.h:300</a></div></div>
<div class="ttc" id="anamespacellvm_html_a07256e6859fcb3b9d5eb02ecea9e9a38"><div class="ttname"><a href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">llvm::isKnownNonZero</a></div><div class="ttdeci">bool isKnownNonZero(const Value *V, const DataLayout &amp;DL, unsigned Depth=0, AssumptionCache *AC=nullptr, const Instruction *CxtI=nullptr, const DominatorTree *DT=nullptr, bool UseInstrInfo=true)</div><div class="ttdoc">Return true if the given value is known to be non-zero when defined.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00313">ValueTracking.cpp:313</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a300433f583bb9e2862b84df663f43f40"><div class="ttname"><a href="classllvm_1_1CallBase.html#a300433f583bb9e2862b84df663f43f40">llvm::CallBase::isStrictFP</a></div><div class="ttdeci">bool isStrictFP() const</div><div class="ttdoc">Determine if the call requires strict floating point semantics.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01864">InstrTypes.h:1864</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a152743f94b060fbc99d10736c1b430e5"><div class="ttname"><a href="classllvm_1_1APFloat.html#a152743f94b060fbc99d10736c1b430e5">llvm::APFloat::isFiniteNonZero</a></div><div class="ttdeci">bool isFiniteNonZero() const</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01269">APFloat.h:1269</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a93b15a8c0022febbe39d17ab933737a8"><div class="ttname"><a href="classllvm_1_1StringRef.html#a93b15a8c0022febbe39d17ab933737a8">llvm::StringRef::find_first_of</a></div><div class="ttdeci">size_t find_first_of(char C, size_t From=0) const</div><div class="ttdoc">Find the first character in the string that is C, or npos if not found.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00376">StringRef.h:376</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_ae817e73e41b3b26068e6b8a50cd447af"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#ae817e73e41b3b26068e6b8a50cd447af">callHasFP128Argument</a></div><div class="ttdeci">static bool callHasFP128Argument(const CallInst *CI)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00074">SimplifyLibCalls.cpp:74</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Triple_html_a547abd13f7a3c063aa72c8192a868154a13d8ce5e71051718a537277c6a594062"><div class="ttname"><a href="classllvm_1_1Triple.html#a547abd13f7a3c063aa72c8192a868154a13d8ce5e71051718a537277c6a594062">llvm::Triple::x86_64</a></div><div class="ttdeci">@ x86_64</div><div class="ttdef"><b>Definition:</b> <a href="Triple_8h_source.html#l00086">Triple.h:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a10d8839494fe8385aa1ddbca6f801d79"><div class="ttname"><a href="classllvm_1_1Instruction.html#a10d8839494fe8385aa1ddbca6f801d79">llvm::Instruction::hasNoInfs</a></div><div class="ttdeci">bool hasNoInfs() const LLVM_READONLY</div><div class="ttdoc">Determine whether the no-infs flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00314">Instruction.cpp:314</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html"><div class="ttname"><a href="classllvm_1_1AttributeList.html">llvm::AttributeList</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00432">Attributes.h:432</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a3c0710aa6b054662f67b480712fa2b95"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a3c0710aa6b054662f67b480712fa2b95">llvm::tgtok::Bits</a></div><div class="ttdeci">@ Bits</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00050">TGLexer.h:50</a></div></div>
<div class="ttc" id="astructllvm_1_1MaybeAlign_html_a06846474be3ab85f8d30c388faf3b116"><div class="ttname"><a href="structllvm_1_1MaybeAlign.html#a06846474be3ab85f8d30c388faf3b116">llvm::MaybeAlign::valueOrOne</a></div><div class="ttdeci">Align valueOrOne() const</div><div class="ttdoc">For convenience, returns a valid alignment or 1 if undefined.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00141">Alignment.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ae0c55761fce39dd71617690b04385193"><div class="ttname"><a href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">llvm::CallBase::getAttributes</a></div><div class="ttdeci">AttributeList getAttributes() const</div><div class="ttdoc">Return the parameter attributes for this call.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01484">InstrTypes.h:1484</a></div></div>
<div class="ttc" id="anamespacellvm_html_a08b6d5c69d7933ac65aae84e1b50fa62"><div class="ttname"><a href="namespacellvm.html#a08b6d5c69d7933ac65aae84e1b50fa62">llvm::maxIntN</a></div><div class="ttdeci">int64_t maxIntN(int64_t N)</div><div class="ttdoc">Gets the maximum value for a N-bit signed integer.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00247">MathExtras.h:247</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_ae56877b571bfd107841dabb130c9f2ca"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#ae56877b571bfd107841dabb130c9f2ca">callHasFloatingPointArgument</a></div><div class="ttdeci">static bool callHasFloatingPointArgument(const CallInst *CI)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00068">SimplifyLibCalls.cpp:68</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_aee5d0f05688dce3f38e3c495744d49e8"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#aee5d0f05688dce3f38e3c495744d49e8">optimizeMemCmpVarSize</a></div><div class="ttdeci">static Value * optimizeMemCmpVarSize(CallInst *CI, Value *LHS, Value *RHS, Value *Size, bool StrNCmp, IRBuilderBase &amp;B, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01416">SimplifyLibCalls.cpp:1416</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba366e1eac31eeb1a1892d62ccfc0c8cf8">llvm::MipsISD::Ret</a></div><div class="ttdeci">@ Ret</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00119">MipsISelLowering.h:119</a></div></div>
<div class="ttc" id="astructllvm_1_1ConstantDataArraySlice_html_a87f5d145b113af758f48fb50f6ea92b9"><div class="ttname"><a href="structllvm_1_1ConstantDataArraySlice.html#a87f5d145b113af758f48fb50f6ea92b9">llvm::ConstantDataArraySlice::Length</a></div><div class="ttdeci">uint64_t Length</div><div class="ttdoc">Length of the slice.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8h_source.html#l00303">ValueTracking.h:303</a></div></div>
<div class="ttc" id="aclassllvm_1_1FortifiedLibCallSimplifier_html_ab5f693b48590402b0109cfdca55ec335"><div class="ttname"><a href="classllvm_1_1FortifiedLibCallSimplifier.html#ab5f693b48590402b0109cfdca55ec335">llvm::FortifiedLibCallSimplifier::optimizeCall</a></div><div class="ttdeci">Value * optimizeCall(CallInst *CI, IRBuilderBase &amp;B)</div><div class="ttdoc">Take the given call instruction and return a more optimal value to replace the instruction with or 0 ...</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l04013">SimplifyLibCalls.cpp:4013</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00264">Instructions.h:264</a></div></div>
<div class="ttc" id="aclassllvm_1_1FastMathFlags_html"><div class="ttname"><a href="classllvm_1_1FastMathFlags.html">llvm::FastMathFlags</a></div><div class="ttdoc">Convenience struct for specifying and reasoning about fast-math flags.</div><div class="ttdef"><b>Definition:</b> <a href="FMF_8h_source.html#l00021">FMF.h:21</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26a5e408fc09c5664d2bbb2d7fae154ea2552a9aa363fba3520d8e8e1a7eca566"><div class="ttname"><a href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154ea2552a9aa363fba3520d8e8e1a7eca566">llvm::NotLibFunc</a></div><div class="ttdeci">@ NotLibFunc</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00041">TargetLibraryInfo.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ae5d05ec2b9a60806746addff3f2a71a9"><div class="ttname"><a href="classllvm_1_1CallBase.html#ae5d05ec2b9a60806746addff3f2a71a9">llvm::CallBase::addParamAttr</a></div><div class="ttdeci">void addParamAttr(unsigned ArgNo, Attribute::AttrKind Kind)</div><div class="ttdoc">Adds the attribute to the indicated argument.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01536">InstrTypes.h:1536</a></div></div>
<div class="ttc" id="astructllvm_1_1APFloatBase_html_a1ba0fce5daa7f716936cabcf00373f0e"><div class="ttname"><a href="structllvm_1_1APFloatBase.html#a1ba0fce5daa7f716936cabcf00373f0e">llvm::APFloatBase::rmTowardNegative</a></div><div class="ttdeci">static constexpr roundingMode rmTowardNegative</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00220">APFloat.h:220</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a037ff294d9d370e29651cbc99442a575"><div class="ttname"><a href="classllvm_1_1APFloat.html#a037ff294d9d370e29651cbc99442a575">llvm::APFloat::getSemantics</a></div><div class="ttdeci">const fltSemantics &amp; getSemantics() const</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01267">APFloat.h:1267</a></div></div>
<div class="ttc" id="aConstantFolding_8h_html"><div class="ttname"><a href="ConstantFolding_8h.html">ConstantFolding.h</a></div></div>
<div class="ttc" id="astructllvm_1_1Bitfield_html"><div class="ttname"><a href="structllvm_1_1Bitfield.html">llvm::Bitfield</a></div><div class="ttdoc">Holds functions to get, set or test bitfields.</div><div class="ttdef"><b>Definition:</b> <a href="Bitfields_8h_source.html#l00212">Bitfields.h:212</a></div></div>
<div class="ttc" id="anamespacellvm_1_1APIntOps_html_aa606171b17bdde9015fa656e226ca9e0"><div class="ttname"><a href="namespacellvm_1_1APIntOps.html#aa606171b17bdde9015fa656e226ca9e0">llvm::APIntOps::umin</a></div><div class="ttdeci">const APInt &amp; umin(const APInt &amp;A, const APInt &amp;B)</div><div class="ttdoc">Determine the smaller of two APInts considered to be unsigned.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l02185">APInt.h:2185</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a6c37b337aa071e70058f7a6dc7b0e911"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a6c37b337aa071e70058f7a6dc7b0e911">mergeAttributesAndFlags</a></div><div class="ttdeci">static Value * mergeAttributesAndFlags(CallInst *NewCI, const CallInst &amp;Old)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00291">SimplifyLibCalls.cpp:291</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aKnownBits_8h_html"><div class="ttname"><a href="KnownBits_8h.html">KnownBits.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aREADME-FPStack_8txt_html_ac25bbfa16d28ab1f83da03668addad0a"><div class="ttname"><a href="README-FPStack_8txt.html#ac25bbfa16d28ab1f83da03668addad0a">floor</a></div><div class="ttdeci">We have fiadd patterns now but the followings have the same cost and complexity We need a way to specify the later is more profitable def def The FP stackifier should handle simple permutates to reduce number of shuffle e g floor</div><div class="ttdef"><b>Definition:</b> <a href="README-FPStack_8txt_source.html#l00054">README-FPStack.txt:54</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aca6428e7fec51ba0b55594f469eb9691"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aca6428e7fec51ba0b55594f469eb9691">llvm::PatternMatch::m_OneUse</a></div><div class="ttdeci">OneUse_match&lt; T &gt; m_OneUse(const T &amp;SubPattern)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00067">PatternMatch.h:67</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_aac9e78b3aa02ec087c4621358f506718"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#aac9e78b3aa02ec087c4621358f506718">llvm::PatternMatch::m_APInt</a></div><div class="ttdeci">apint_match m_APInt(const APInt *&amp;Res)</div><div class="ttdoc">Match a ConstantInt or splatted ConstantVector, binding the specified pointer to the contained APInt.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00278">PatternMatch.h:278</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1LibCallSimplifier_html_a3f992eacdcd3c0f985a4ab77d8d4e937"><div class="ttname"><a href="classllvm_1_1LibCallSimplifier.html#a3f992eacdcd3c0f985a4ab77d8d4e937">llvm::LibCallSimplifier::LibCallSimplifier</a></div><div class="ttdeci">LibCallSimplifier(const DataLayout &amp;DL, const TargetLibraryInfo *TLI, OptimizationRemarkEmitter &amp;ORE, BlockFrequencyInfo *BFI, ProfileSummaryInfo *PSI, function_ref&lt; void(Instruction *, Value *)&gt; Replacer=&amp;replaceAllUsesWithDefault, function_ref&lt; void(Instruction *)&gt; Eraser=&amp;eraseFromParentDefault)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l03707">SimplifyLibCalls.cpp:3707</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html_a157efd68e8b4b838829cad165b1583f8"><div class="ttname"><a href="structllvm_1_1KnownBits.html#a157efd68e8b4b838829cad165b1583f8">llvm::KnownBits::isNonNegative</a></div><div class="ttdeci">bool isNonNegative() const</div><div class="ttdoc">Returns true if this value is known to be non-negative.</div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00099">KnownBits.h:99</a></div></div>
<div class="ttc" id="anamespacellvm_html_a70223109f2fd6a814865c58a738b4925"><div class="ttname"><a href="namespacellvm.html#a70223109f2fd6a814865c58a738b4925">llvm::emitStrDup</a></div><div class="ttdeci">Value * emitStrDup(Value *Ptr, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strdup function to the builder, for the specified pointer.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01465">BuildLibCalls.cpp:1465</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8a6b92032e49dc6da4a5c4a05771878f"><div class="ttname"><a href="namespacellvm.html#a8a6b92032e49dc6da4a5c4a05771878f">llvm::emitFPutC</a></div><div class="ttdeci">Value * emitFPutC(Value *Char, Value *File, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the fputc function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01837">BuildLibCalls.cpp:1837</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a2ab5d0b4d639b3f79ff3922441e0082e"><div class="ttname"><a href="classllvm_1_1CallBase.html#a2ab5d0b4d639b3f79ff3922441e0082e">llvm::CallBase::removeParamAttr</a></div><div class="ttdeci">void removeParamAttr(unsigned ArgNo, Attribute::AttrKind Kind)</div><div class="ttdoc">Removes the attribute from the given argument.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01578">InstrTypes.h:1578</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html">llvm::BlockFrequencyInfo</a></div><div class="ttdoc">BlockFrequencyInfo pass uses BlockFrequencyInfoImpl implementation to estimate IR basic block frequen...</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00037">BlockFrequencyInfo.h:37</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3af72f14ea20f2c762c751d2d49e5ea3"><div class="ttname"><a href="namespacellvm.html#a3af72f14ea20f2c762c751d2d49e5ea3">llvm::shouldOptimizeForSize</a></div><div class="ttdeci">bool shouldOptimizeForSize(const MachineFunction *MF, ProfileSummaryInfo *PSI, const MachineBlockFrequencyInfo *BFI, PGSOQueryType QueryType=PGSOQueryType::Other)</div><div class="ttdoc">Returns true if machine function MF is suggested to be size-optimized based on the profile.</div><div class="ttdef"><b>Definition:</b> <a href="MachineSizeOpts_8cpp_source.html#l00183">MachineSizeOpts.cpp:183</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_aae1f09de4bf1aab27149a7d328715e30"><div class="ttname"><a href="classllvm_1_1APFloat.html#aae1f09de4bf1aab27149a7d328715e30">llvm::APFloat::convertToInteger</a></div><div class="ttdeci">opStatus convertToInteger(MutableArrayRef&lt; integerPart &gt; Input, unsigned int Width, bool IsSigned, roundingMode RM, bool *IsExact) const</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01149">APFloat.h:1149</a></div></div>
<div class="ttc" id="anamespacellvm_html_aac36edd0f1ce976f0025c98e88d3830eac33315685a0cba3ce53be378b3c7874b"><div class="ttname"><a href="namespacellvm.html#aac36edd0f1ce976f0025c98e88d3830eac33315685a0cba3ce53be378b3c7874b">llvm::RecurKind::And</a></div><div class="ttdeci">@ And</div><div class="ttdoc">Bitwise or logical AND of integers.</div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_ae18cffa676178ae60f0692ad4410e940"><div class="ttname"><a href="classllvm_1_1AttributeList.html#ae18cffa676178ae60f0692ad4410e940">llvm::AttributeList::addParamAttributes</a></div><div class="ttdeci">AttributeList addParamAttributes(LLVMContext &amp;C, unsigned ArgNo, const AttrBuilder &amp;B) const</div><div class="ttdoc">Add an argument attribute to the list.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l00591">Attributes.h:591</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a32e606ac4c88f71f14212e42b808e7f4"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a32e606ac4c88f71f14212e42b808e7f4">llvm::GlobalValue::isDeclaration</a></div><div class="ttdeci">bool isDeclaration() const</div><div class="ttdoc">Return true if the primary definition of this global value is outside of the current translation unit...</div><div class="ttdef"><b>Definition:</b> <a href="Globals_8cpp_source.html#l00275">Globals.cpp:275</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_addb87fe3f509b7803d3f5933ee24b560"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#addb87fe3f509b7803d3f5933ee24b560">llvm::PatternMatch::m_Select</a></div><div class="ttdeci">ThreeOps_match&lt; Cond, LHS, RHS, Instruction::Select &gt; m_Select(const Cond &amp;C, const LHS &amp;L, const RHS &amp;R)</div><div class="ttdoc">Matches SelectInst.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01462">PatternMatch.h:1462</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a84cd09ccc918883d51a387f0e0f374f3"><div class="ttname"><a href="classllvm_1_1StringRef.html#a84cd09ccc918883d51a387f0e0f374f3">llvm::StringRef::startswith</a></div><div class="ttdeci">bool startswith(StringRef Prefix) const</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00261">StringRef.h:261</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1LibCallSimplifier_html_a73c4a774eb638f963533b77f7124293b"><div class="ttname"><a href="classllvm_1_1LibCallSimplifier.html#a73c4a774eb638f963533b77f7124293b">llvm::LibCallSimplifier::optimizeCall</a></div><div class="ttdeci">Value * optimizeCall(CallInst *CI, IRBuilderBase &amp;B)</div><div class="ttdoc">optimizeCall - Take the given call instruction and return a more optimal value to replace the instruc...</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l03564">SimplifyLibCalls.cpp:3564</a></div></div>
<div class="ttc" id="aSmallString_8h_html"><div class="ttname"><a href="SmallString_8h.html">SmallString.h</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26a5e408fc09c5664d2bbb2d7fae154e"><div class="ttname"><a href="namespacellvm.html#a26a5e408fc09c5664d2bbb2d7fae154e">llvm::LibFunc</a></div><div class="ttdeci">LibFunc</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00036">TargetLibraryInfo.h:36</a></div></div>
<div class="ttc" id="anamespacellvm_html_a607b7fac55adc5ea9ed40a78e48a5b00"><div class="ttname"><a href="namespacellvm.html#a607b7fac55adc5ea9ed40a78e48a5b00">llvm::getKnownAlignment</a></div><div class="ttdeci">Align getKnownAlignment(Value *V, const DataLayout &amp;DL, const Instruction *CxtI=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr)</div><div class="ttdoc">Try to infer an alignment for the specified pointer.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8h_source.html#l00222">Local.h:222</a></div></div>
<div class="ttc" id="aIntrinsics_8h_html"><div class="ttname"><a href="Intrinsics_8h.html">Intrinsics.h</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78bad92f160316221fd4090520bb2b3cefc5"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bad92f160316221fd4090520bb2b3cefc5">llvm::CmpInst::ICMP_ULE</a></div><div class="ttdeci">@ ICMP_ULE</div><div class="ttdoc">unsigned less or equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00744">InstrTypes.h:744</a></div></div>
<div class="ttc" id="axxhash_8cpp_html_ae4e947c75dafebd71b8de03cd0dbf5d6"><div class="ttname"><a href="xxhash_8cpp.html#ae4e947c75dafebd71b8de03cd0dbf5d6">round</a></div><div class="ttdeci">static uint64_t round(uint64_t Acc, uint64_t Input)</div><div class="ttdef"><b>Definition:</b> <a href="xxhash_8cpp_source.html#l00056">xxhash.cpp:56</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a83b8c9e572130f403445c0b0f69b837c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a83b8c9e572130f403445c0b0f69b837c">llvm::CallBase::getCalledFunction</a></div><div class="ttdeci">Function * getCalledFunction() const</div><div class="ttdoc">Returns the function called, or null if this is an indirect function invocation or the function signa...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01406">InstrTypes.h:1406</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a9da3b29e8e71b9be4645874e1721207a"><div class="ttname"><a href="classllvm_1_1CallBase.html#a9da3b29e8e71b9be4645874e1721207a">llvm::CallBase::setAttributes</a></div><div class="ttdeci">void setAttributes(AttributeList A)</div><div class="ttdoc">Set the parameter attributes for this call.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01488">InstrTypes.h:1488</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Instruction iterator methods.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00314">BasicBlock.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8da8a33e55b9283587506d8ba68c0ab2"><div class="ttname"><a href="namespacellvm.html#a8da8a33e55b9283587506d8ba68c0ab2">llvm::emitStrCat</a></div><div class="ttdeci">Value * emitStrCat(Value *Dest, Value *Src, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strcat function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01627">BuildLibCalls.cpp:1627</a></div></div>
<div class="ttc" id="aOcamlGCPrinter_8cpp_html_afcf2f797ed287a723263583c9b1c1bce"><div class="ttname"><a href="OcamlGCPrinter_8cpp.html#afcf2f797ed287a723263583c9b1c1bce">Y</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; OcamlGCMetadataPrinter &gt; Y(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible collector&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a2d9fe4a8103a58d5dee8ff09e6fa2152"><div class="ttname"><a href="classllvm_1_1CallBase.html#a2d9fe4a8103a58d5dee8ff09e6fa2152">llvm::CallBase::removeRetAttrs</a></div><div class="ttdeci">void removeRetAttrs(const AttributeMask &amp;AttrsToRemove)</div><div class="ttdoc">Removes the attributes from the return value.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01573">InstrTypes.h:1573</a></div></div>
<div class="ttc" id="anamespacellvm_html_adee6ec38d5e042d13294bf047abc3245"><div class="ttname"><a href="namespacellvm.html#adee6ec38d5e042d13294bf047abc3245">llvm::emitStrLCpy</a></div><div class="ttdeci">Value * emitStrLCpy(Value *Dest, Value *Src, Value *Size, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strlcpy function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01634">BuildLibCalls.cpp:1634</a></div></div>
<div class="ttc" id="astructllvm_1_1APFloatBase_html_aee544c332088dbef348a0c1c97e21a6aaba98149aef517089f9868bde5b8c41bc"><div class="ttname"><a href="structllvm_1_1APFloatBase.html#aee544c332088dbef348a0c1c97e21a6aaba98149aef517089f9868bde5b8c41bc">llvm::APFloatBase::opInexact</a></div><div class="ttdeci">@ opInexact</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00239">APFloat.h:239</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">llvm::ms_demangle::QualifierMangleMode::Result</a></div><div class="ttdeci">@ Result</div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a80f54c2de948fe93fbb7acbf7c8bcee5"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a80f54c2de948fe93fbb7acbf7c8bcee5">getIntToFPVal</a></div><div class="ttdeci">static Value * getIntToFPVal(Value *I2F, IRBuilderBase &amp;B, unsigned DstWidth)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01840">SimplifyLibCalls.cpp:1840</a></div></div>
<div class="ttc" id="ac_2DataTypes_8h_html_a30654b4b67d97c42ca3f9b6052dda916"><div class="ttname"><a href="c_2DataTypes_8h.html#a30654b4b67d97c42ca3f9b6052dda916">UINT64_MAX</a></div><div class="ttdeci">#define UINT64_MAX</div><div class="ttdef"><b>Definition:</b> <a href="c_2DataTypes_8h_source.html#l00077">DataTypes.h:77</a></div></div>
<div class="ttc" id="astructllvm_1_1APFloatBase_html_aee544c332088dbef348a0c1c97e21a6aa8092c6b52c0412d8198a63bc995761e9"><div class="ttname"><a href="structllvm_1_1APFloatBase.html#aee544c332088dbef348a0c1c97e21a6aa8092c6b52c0412d8198a63bc995761e9">llvm::APFloatBase::opOK</a></div><div class="ttdeci">@ opOK</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00234">APFloat.h:234</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a1bc022868b23918efa44df511f4d5b61"><div class="ttname"><a href="classllvm_1_1Type.html#a1bc022868b23918efa44df511f4d5b61">llvm::Type::isVectorTy</a></div><div class="ttdeci">bool isVectorTy() const</div><div class="ttdoc">True if this is an instance of VectorType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00258">Type.h:258</a></div></div>
<div class="ttc" id="anamespacellvm_html_afb65eef479f0473d0fe1666b80155237"><div class="ttname"><a href="namespacellvm.html#afb65eef479f0473d0fe1666b80155237">llvm::NextPowerOf2</a></div><div class="ttdeci">constexpr uint64_t NextPowerOf2(uint64_t A)</div><div class="ttdoc">Returns the next power of two (in 64-bits) that is strictly greater than A.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00450">MathExtras.h:450</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1IntegerType_html"><div class="ttname"><a href="classllvm_1_1IntegerType.html">llvm::IntegerType</a></div><div class="ttdoc">Class to represent integer types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00040">DerivedTypes.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html_a97cfbbed8869e3582142012a071a9052"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html#a97cfbbed8869e3582142012a071a9052">llvm::TargetLibraryInfo::getLibFunc</a></div><div class="ttdeci">bool getLibFunc(StringRef funcName, LibFunc &amp;F) const</div><div class="ttdoc">Searches for a particular function name.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00306">TargetLibraryInfo.h:306</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_af431ec215bba8bb9c56e7541d99920f2"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#af431ec215bba8bb9c56e7541d99920f2">llvm::PatternMatch::m_FNeg</a></div><div class="ttdeci">FNeg_match&lt; OpTy &gt; m_FNeg(const OpTy &amp;X)</div><div class="ttdoc">Match 'fneg X' as 'fsub -0.0, X'.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01033">PatternMatch.h:1033</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a2b901c3a0625a7d7173e9bd4864e2775"><div class="ttname"><a href="classllvm_1_1APFloat.html#a2b901c3a0625a7d7173e9bd4864e2775">llvm::APFloat::isNegative</a></div><div class="ttdeci">bool isNegative() const</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01259">APFloat.h:1259</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a37733c4c22afc6a48194783dbd25487c"><div class="ttname"><a href="classllvm_1_1APFloat.html#a37733c4c22afc6a48194783dbd25487c">llvm::APFloat::convertToDouble</a></div><div class="ttdeci">double convertToDouble() const</div><div class="ttdoc">Converts this APFloat to host double value.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l05423">APFloat.cpp:5423</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023">llvm::MCID::Flag</a></div><div class="ttdeci">Flag</div><div class="ttdoc">These should be considered private to the implementation of the MCInstrDesc class.</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00148">MCInstrDesc.h:148</a></div></div>
<div class="ttc" id="anamespacellvm_html_aec7c967a5416fa6e154433965357a50ea089e7eb4db258e05f70eef4ed5aa10bb"><div class="ttname"><a href="namespacellvm.html#aec7c967a5416fa6e154433965357a50ea089e7eb4db258e05f70eef4ed5aa10bb">llvm::PGSOQueryType::IRPass</a></div><div class="ttdeci">@ IRPass</div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a0f72a62efd0912aba72c6818c720023c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a0f72a62efd0912aba72c6818c720023c">llvm::CallBase::addFnAttr</a></div><div class="ttdeci">void addFnAttr(Attribute::AttrKind Kind)</div><div class="ttdoc">Adds the attribute to the function.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01516">InstrTypes.h:1516</a></div></div>
<div class="ttc" id="aclassllvm_1_1APSInt_html"><div class="ttname"><a href="classllvm_1_1APSInt.html">llvm::APSInt</a></div><div class="ttdoc">An arbitrary precision integer that knows its signedness.</div><div class="ttdef"><b>Definition:</b> <a href="APSInt_8h_source.html#l00023">APSInt.h:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a217e0207d9cc8e046c2dccbf0e4bb198"><div class="ttname"><a href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">llvm::APInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Get zero extended value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01494">APInt.h:1494</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFP_html"><div class="ttname"><a href="classllvm_1_1ConstantFP.html">llvm::ConstantFP</a></div><div class="ttdoc">ConstantFP - Floating Point Values [float, double].</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00256">Constants.h:256</a></div></div>
<div class="ttc" id="anamespacellvm_html_a11b84a626ef34d3ced2e131937e58ddd"><div class="ttname"><a href="namespacellvm.html#a11b84a626ef34d3ced2e131937e58ddd">llvm::emitPutChar</a></div><div class="ttdeci">Value * emitPutChar(Value *Char, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the putchar function. This assumes that Char is an 'int'.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01800">BuildLibCalls.cpp:1800</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_adfa827b083d21f99d75f9e3e08205fee"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#adfa827b083d21f99d75f9e3e08205fee">isOnlyUsedInComparisonWithZero</a></div><div class="ttdeci">static bool isOnlyUsedInComparisonWithZero(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00189">SimplifyLibCalls.cpp:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1Option_html_a2dc75fafb68e7669e776e19da7857cdf"><div class="ttname"><a href="classllvm_1_1cl_1_1Option.html#a2dc75fafb68e7669e776e19da7857cdf">llvm::cl::Option::getNumOccurrences</a></div><div class="ttdeci">int getNumOccurrences() const</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00401">CommandLine.h:401</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_ac88d9af30f3e67bd725bfe03e786f50c"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#ac88d9af30f3e67bd725bfe03e786f50c">getSqrtCall</a></div><div class="ttdeci">static Value * getSqrtCall(Value *V, AttributeList Attrs, bool NoErrno, Module *M, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l02017">SimplifyLibCalls.cpp:2017</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2bcd261c0da622d37e1c5aeb02496e12"><div class="ttname"><a href="namespacellvm.html#a2bcd261c0da622d37e1c5aeb02496e12">llvm::getConstantStringInfo</a></div><div class="ttdeci">bool getConstantStringInfo(const Value *V, StringRef &amp;Str, bool TrimAtNul=true)</div><div class="ttdoc">This function computes the length of a null-terminated C string pointed to by V.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04389">ValueTracking.cpp:4389</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionCallee_html_a9d67a499a48bda24fa4e87138341f613"><div class="ttname"><a href="classllvm_1_1FunctionCallee.html#a9d67a499a48bda24fa4e87138341f613">llvm::FunctionCallee::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType()</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00182">DerivedTypes.h:182</a></div></div>
<div class="ttc" id="anamespacellvm_html_ade8f600187cb9c664701443e796111e7"><div class="ttname"><a href="namespacellvm.html#ade8f600187cb9c664701443e796111e7">llvm::isGEPBasedOnPointerToString</a></div><div class="ttdeci">bool isGEPBasedOnPointerToString(const GEPOperator *GEP, unsigned CharSize=8)</div><div class="ttdoc">Returns true if the GEP is based on a pointer to a string (array of.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04268">ValueTracking.cpp:4268</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a043cdaf7b89aaeeb127be5d93411637f"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a></div><div class="ttdeci">uint64_t Align</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00082">ELFObjHandler.cpp:82</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_ab4cd2984c6254a6d8bd4d05d2d6fddde"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#ab4cd2984c6254a6d8bd4d05d2d6fddde">valueHasFloatPrecision</a></div><div class="ttdeci">static Value * valueHasFloatPrecision(Value *Val)</div><div class="ttdoc">Return a variant of Val with float type.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01680">SimplifyLibCalls.cpp:1680</a></div></div>
<div class="ttc" id="aclassllvm_1_1FixedVectorType_html_af9a870d5df50fe0133a410b7c9114c80"><div class="ttname"><a href="classllvm_1_1FixedVectorType.html#af9a870d5df50fe0133a410b7c9114c80">llvm::FixedVectorType::get</a></div><div class="ttdeci">static FixedVectorType * get(Type *ElementType, unsigned NumElts)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00686">Type.cpp:686</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="anamespacellvm_html_a38b79d4f932b987c3ff538cacebb106f"><div class="ttname"><a href="namespacellvm.html#a38b79d4f932b987c3ff538cacebb106f">llvm::emitMemRChr</a></div><div class="ttdeci">Value * emitMemRChr(Value *Ptr, Value *Val, Value *Len, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the memrchr function, analogously to emitMemChr.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01562">BuildLibCalls.cpp:1562</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a37269632d3b68130c5b7019cd795be44"><div class="ttname"><a href="classllvm_1_1CallBase.html#a37269632d3b68130c5b7019cd795be44">llvm::CallBase::getParamDereferenceableBytes</a></div><div class="ttdeci">uint64_t getParamDereferenceableBytes(unsigned i) const</div><div class="ttdoc">Extract the number of dereferenceable bytes for a call or parameter (0=unknown).</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01814">InstrTypes.h:1814</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6235f3b5af61e1da8ecb017f6f909f1f"><div class="ttname"><a href="namespacellvm.html#a6235f3b5af61e1da8ecb017f6f909f1f">llvm::emitStrNCmp</a></div><div class="ttdeci">Value * emitStrNCmp(Value *Ptr1, Value *Ptr2, Value *Len, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strncmp function to the builder.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01479">BuildLibCalls.cpp:1479</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a13e877ef779ba7a0688081079f4f9b03"><div class="ttname"><a href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">llvm::Type::getIntegerBitWidth</a></div><div class="ttdeci">unsigned getIntegerBitWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00097">DerivedTypes.h:97</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a9d7de807ebdfe1819df3ff6cb0f16158"><div class="ttname"><a href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00344">Value.h:344</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a4826c8503f42d50634e8fdce6e756be1"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a4826c8503f42d50634e8fdce6e756be1">optimizeBinaryDoubleFP</a></div><div class="ttdeci">static Value * optimizeBinaryDoubleFP(CallInst *CI, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI, bool isPrecise=false)</div><div class="ttdoc">Shrink double -&gt; float for binary functions.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01765">SimplifyLibCalls.cpp:1765</a></div></div>
<div class="ttc" id="aErlangGCPrinter_8cpp_html_a74b474c0616ab55c1d9487f11fd31d26"><div class="ttname"><a href="ErlangGCPrinter_8cpp.html#a74b474c0616ab55c1d9487f11fd31d26">X</a></div><div class="ttdeci">static GCMetadataPrinterRegistry::Add&lt; ErlangGCPrinter &gt; X(&quot;erlang&quot;, &quot;erlang-compatible garbage collector&quot;)</div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d"><div class="ttname"><a href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">llvm::omp::RTLDependInfoFields::Len</a></div><div class="ttdeci">@ Len</div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_afac5b39bcbb90d660f83d9b4bd8c6d95"><div class="ttname"><a href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">llvm::CallBase::getCaller</a></div><div class="ttdeci">Function * getCaller()</div><div class="ttdoc">Helper to get the caller (the parent function).</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00293">Instructions.cpp:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallString_html"><div class="ttname"><a href="classllvm_1_1SmallString.html">llvm::SmallString</a></div><div class="ttdoc">SmallString - A SmallString is just a SmallVector with methods and accessors that make it work better...</div><div class="ttdef"><b>Definition:</b> <a href="SmallString_8h_source.html#l00026">SmallString.h:26</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a24da6451c0e494831c85fa96cb572c9a"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a24da6451c0e494831c85fa96cb572c9a">insertSinCosCall</a></div><div class="ttdeci">static bool insertSinCosCall(IRBuilderBase &amp;B, Function *OrigCallee, Value *Arg, bool UseFloat, Value *&amp;Sin, Value *&amp;Cos, Value *&amp;SinCos, const TargetLibraryInfo *TLI)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l02535">SimplifyLibCalls.cpp:2535</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_aa11ca53210de69609754994339179e10"><div class="ttname"><a href="classllvm_1_1Instruction.html#aa11ca53210de69609754994339179e10">llvm::Instruction::hasApproxFunc</a></div><div class="ttdeci">bool hasApproxFunc() const LLVM_READONLY</div><div class="ttdoc">Determine whether the approximate-math-functions flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00334">Instruction.cpp:334</a></div></div>
<div class="ttc" id="anamespacellvm_html_a636de400e4dd2bc090b729329a99e75b"><div class="ttname"><a href="namespacellvm.html#a636de400e4dd2bc090b729329a99e75b">llvm::maxnum</a></div><div class="ttdeci">LLVM_READONLY APFloat maxnum(const APFloat &amp;A, const APFloat &amp;B)</div><div class="ttdoc">Implements IEEE maxNum semantics.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01357">APFloat.h:1357</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html">llvm::ProfileSummaryInfo</a></div><div class="ttdoc">Analysis providing profile information.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00040">ProfileSummaryInfo.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1FortifiedLibCallSimplifier_html_a8a27937b281cb7fe3db8433b8cd5835d"><div class="ttname"><a href="classllvm_1_1FortifiedLibCallSimplifier.html#a8a27937b281cb7fe3db8433b8cd5835d">llvm::FortifiedLibCallSimplifier::FortifiedLibCallSimplifier</a></div><div class="ttdeci">FortifiedLibCallSimplifier(const TargetLibraryInfo *TLI, bool OnlyLowerUnknownSize=false)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l04088">SimplifyLibCalls.cpp:4088</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a7477aafbbe989ad35b96fac186d8e9fd"><div class="ttname"><a href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeList getAttributes() const</div><div class="ttdoc">Return the attribute list for this Function.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00313">Function.h:313</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="aclassllvm_1_1function__ref_html"><div class="ttname"><a href="classllvm_1_1function__ref.html">llvm::function_ref</a></div><div class="ttdoc">An efficient, type-erasing, non-owning reference to a callable.</div><div class="ttdef"><b>Definition:</b> <a href="STLFunctionalExtras_8h_source.html#l00036">STLFunctionalExtras.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a2dc80c585ad5882da8cae7b5968f7e74"><div class="ttname"><a href="classllvm_1_1StringRef.html#a2dc80c585ad5882da8cae7b5968f7e74">llvm::StringRef::empty</a></div><div class="ttdeci">constexpr bool empty() const</div><div class="ttdoc">empty - Check if the string is empty.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00134">StringRef.h:134</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1c4687f9c44e149d4893bd81b7ddce3b"><div class="ttname"><a href="namespacellvm.html#a1c4687f9c44e149d4893bd81b7ddce3b">llvm::isOnlyUsedInZeroEqualityComparison</a></div><div class="ttdeci">bool isOnlyUsedInZeroEqualityComparison(const Instruction *CxtI)</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00290">ValueTracking.cpp:290</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a67acb174a712823e6cf5e5b03bed3fdf"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a67acb174a712823e6cf5e5b03bed3fdf">annotateDereferenceableBytes</a></div><div class="ttdeci">static void annotateDereferenceableBytes(CallInst *CI, ArrayRef&lt; unsigned &gt; ArgNos, uint64_t DereferenceableBytes)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00215">SimplifyLibCalls.cpp:215</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_abaf8a257af9e537d7cd8b05299e5090c"><div class="ttname"><a href="classllvm_1_1CallBase.html#abaf8a257af9e537d7cd8b05299e5090c">llvm::CallBase::getParamDereferenceableOrNullBytes</a></div><div class="ttdeci">uint64_t getParamDereferenceableOrNullBytes(unsigned i) const</div><div class="ttdoc">Extract the number of dereferenceable_or_null bytes for a parameter (0=unknown).</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01832">InstrTypes.h:1832</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_1_1FastMathFlagGuard_html"><div class="ttname"><a href="classllvm_1_1IRBuilderBase_1_1FastMathFlagGuard.html">llvm::IRBuilderBase::FastMathFlagGuard</a></div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00383">IRBuilder.h:383</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_afb28a4deafe2954b0534cc6399ce518b"><div class="ttname"><a href="classllvm_1_1Function.html#afb28a4deafe2954b0534cc6399ce518b">llvm::Function::hasFnAttribute</a></div><div class="ttdeci">bool hasFnAttribute(Attribute::AttrKind Kind) const</div><div class="ttdoc">Return true if the function has the attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00640">Function.cpp:640</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html"><div class="ttname"><a href="classllvm_1_1APFloat.html">llvm::APFloat</a></div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00744">APFloat.h:744</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="anamespacellvm_html_a35f8c517a70dfe8d3d066407c441894f"><div class="ttname"><a href="namespacellvm.html#a35f8c517a70dfe8d3d066407c441894f">llvm::emitSPrintf</a></div><div class="ttdeci">Value * emitSPrintf(Value *Dest, Value *Fmt, ArrayRef&lt; Value * &gt; VariadicArgs, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the sprintf function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01615">BuildLibCalls.cpp:1615</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6110fc30bc7311a6cf99814530362e21"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">llvm::AMDGPU::Hwreg::Offset</a></div><div class="ttdeci">Offset</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00432">SIDefines.h:432</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a2d989cf6c0da10e436e1e95e380e0e09"><div class="ttname"><a href="classllvm_1_1CallBase.html#a2d989cf6c0da10e436e1e95e380e0e09">llvm::CallBase::doesNotAccessMemory</a></div><div class="ttdeci">bool doesNotAccessMemory(unsigned OpNo) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01724">InstrTypes.h:1724</a></div></div>
<div class="ttc" id="aclassllvm_1_1ICmpInst_html"><div class="ttname"><a href="classllvm_1_1ICmpInst.html">llvm::ICmpInst</a></div><div class="ttdoc">This instruction compares its operands according to the predicate given to the constructor.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01197">Instructions.h:1197</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a753c7e658af5b364f756cb18b620e3c5"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a753c7e658af5b364f756cb18b620e3c5">optimizeDoubleFP</a></div><div class="ttdeci">static Value * optimizeDoubleFP(CallInst *CI, IRBuilderBase &amp;B, bool isBinary, const TargetLibraryInfo *TLI, bool isPrecise=false)</div><div class="ttdoc">Shrink double -&gt; float functions.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01698">SimplifyLibCalls.cpp:1698</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00652">GlobalValue.h:652</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1484bdcb6b4c84ceb447270f8acca352"><div class="ttname"><a href="namespacellvm.html#a1484bdcb6b4c84ceb447270f8acca352">llvm::emitMemCpyChk</a></div><div class="ttdeci">Value * emitMemCpyChk(Value *Dst, Value *Src, Value *Len, Value *ObjSize, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the __memcpy_chk function to the builder.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01519">BuildLibCalls.cpp:1519</a></div></div>
<div class="ttc" id="anamespacellvm_html_a48857a8252dd37eb41884773de34738f"><div class="ttname"><a href="namespacellvm.html#a48857a8252dd37eb41884773de34738f">llvm::hasFloatFn</a></div><div class="ttdeci">bool hasFloatFn(const Module *M, const TargetLibraryInfo *TLI, Type *Ty, LibFunc DoubleFn, LibFunc FloatFn, LibFunc LongDoubleFn)</div><div class="ttdoc">Check whether the overloaded floating point function corresponding to Ty is available.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01387">BuildLibCalls.cpp:1387</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_ad633d6152693e0c1dd402507ac156289"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#ad633d6152693e0c1dd402507ac156289">isTrigLibCall</a></div><div class="ttdeci">static bool isTrigLibCall(CallInst *CI)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l02528">SimplifyLibCalls.cpp:2528</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="anamespacellvm_html_a392fe07b95bac44c375179b4f16df1ec"><div class="ttname"><a href="namespacellvm.html#a392fe07b95bac44c375179b4f16df1ec">llvm::emitStrLCat</a></div><div class="ttdeci">Value * emitStrLCat(Value *Dest, Value *Src, Value *Size, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strlcat function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01643">BuildLibCalls.cpp:1643</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html">llvm::AttrBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8h_source.html#l01040">Attributes.h:1040</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a20cdc3911828248e70dbeae018106b76"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a20cdc3911828248e70dbeae018106b76">llvm::FunctionType::getParamType</a></div><div class="ttdeci">Type * getParamType(unsigned i) const</div><div class="ttdoc">Parameter type accessors.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00135">DerivedTypes.h:135</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9cb2daa4b6729813d1f8d39b9e037a5a"><div class="ttname"><a href="namespacellvm.html#a9cb2daa4b6729813d1f8d39b9e037a5a">llvm::SaturatingMultiplyAdd</a></div><div class="ttdeci">std::enable_if_t&lt; std::is_unsigned&lt; T &gt;::value, T &gt; SaturatingMultiplyAdd(T X, T Y, T A, bool *ResultOverflowed=nullptr)</div><div class="ttdoc">Multiply two unsigned integers, X and Y, and add the unsigned integer, A to the product.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00658">MathExtras.h:658</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html_a4b2c8769ea6c7af6f24285e87a7e3aa1"><div class="ttname"><a href="classllvm_1_1Attribute.html#a4b2c8769ea6c7af6f24285e87a7e3aa1">llvm::Attribute::getWithDereferenceableBytes</a></div><div class="ttdeci">static Attribute getWithDereferenceableBytes(LLVMContext &amp;Context, uint64_t Bytes)</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00177">Attributes.cpp:177</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html_a825476b2436eb817b735fdd34ee521c4"><div class="ttname"><a href="structllvm_1_1KnownBits.html#a825476b2436eb817b735fdd34ee521c4">llvm::KnownBits::getMaxValue</a></div><div class="ttdeci">APInt getMaxValue() const</div><div class="ttdoc">Return the maximal unsigned value possible given these KnownBits.</div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00136">KnownBits.h:136</a></div></div>
<div class="ttc" id="anamespacellvm_html_a87cba3c4c88ab5df01a7f7dece1e0266"><div class="ttname"><a href="namespacellvm.html#a87cba3c4c88ab5df01a7f7dece1e0266">llvm::getOrInsertLibFunc</a></div><div class="ttdeci">FunctionCallee getOrInsertLibFunc(Module *M, const TargetLibraryInfo &amp;TLI, LibFunc TheLibFunc, FunctionType *T, AttributeList AttributeList)</div><div class="ttdoc">Calls getOrInsertFunction() and then makes sure to add mandatory argument attributes.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01285">BuildLibCalls.cpp:1285</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7e2b6aee30057f25f3a9537ff74775a8"><div class="ttname"><a href="namespacellvm.html#a7e2b6aee30057f25f3a9537ff74775a8">llvm::emitBCmp</a></div><div class="ttdeci">Value * emitBCmp(Value *Ptr1, Value *Ptr2, Value *Len, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the bcmp function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01582">BuildLibCalls.cpp:1582</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa1f8f0633edd8b9a1c5ec15bb9fc5640"><div class="ttname"><a href="namespacellvm.html#aa1f8f0633edd8b9a1c5ec15bb9fc5640">llvm::computeKnownBits</a></div><div class="ttdeci">void computeKnownBits(const Value *V, KnownBits &amp;Known, const DataLayout &amp;DL, unsigned Depth=0, AssumptionCache *AC=nullptr, const Instruction *CxtI=nullptr, const DominatorTree *DT=nullptr, OptimizationRemarkEmitter *ORE=nullptr, bool UseInstrInfo=true)</div><div class="ttdoc">Determine which bits of V are known to be either zero or one and return them in the KnownZero/KnownOn...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00186">ValueTracking.cpp:186</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ae2bb081d94f22e64ca6bc4bd58512a93"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a></div><div class="ttdeci">&lt;%struct.s * &gt; cast struct s *S to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *agg result to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *memtmp to sbyte *&lt; sbyte * &gt; sbyte uint ret void llc ends up issuing two memcpy or custom lower memcpy(of small size) to be ldmia/stmia. I think option 2 is better but the current register allocator cannot allocate a chunk of registers at a time. A feasible temporary solution is to use specific physical registers at the lowering time for small(&lt;</div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a613c1a46385c58d54da4ac29ec17994c"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a613c1a46385c58d54da4ac29ec17994c">ignoreCallingConv</a></div><div class="ttdeci">static bool ignoreCallingConv(LibFunc Func)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00051">SimplifyLibCalls.cpp:51</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae76b9bfb5e62fe86e9133d4a5b5bd275"><div class="ttname"><a href="namespacellvm.html#ae76b9bfb5e62fe86e9133d4a5b5bd275">llvm::emitMemPCpy</a></div><div class="ttdeci">Value * emitMemPCpy(Value *Dst, Value *Src, Value *Len, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the mempcpy function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01543">BuildLibCalls.cpp:1543</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8c2ffb91a5485fa7becad0e00d7e1815"><div class="ttname"><a href="namespacellvm.html#a8c2ffb91a5485fa7becad0e00d7e1815">llvm::emitStpNCpy</a></div><div class="ttdeci">Value * emitStpNCpy(Value *Dst, Value *Src, Value *Len, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the stpncpy function to the builder, for the specified pointer arguments and length.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01511">BuildLibCalls.cpp:1511</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9a167f91db810097d281b1ed627f4575"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9a167f91db810097d281b1ed627f4575">llvm::Instruction::getFastMathFlags</a></div><div class="ttdeci">FastMathFlags getFastMathFlags() const LLVM_READONLY</div><div class="ttdoc">Convenience function for getting all the fast-math flags, which must be an operator which supports th...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00339">Instruction.cpp:339</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="aAPSInt_8h_html"><div class="ttname"><a href="APSInt_8h.html">APSInt.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_ae851887270f35d2a2670a79b9833d45b"><div class="ttname"><a href="classllvm_1_1StringRef.html#ae851887270f35d2a2670a79b9833d45b">llvm::StringRef::find_first_not_of</a></div><div class="ttdeci">size_t find_first_not_of(char C, size_t From=0) const</div><div class="ttdoc">Find the first character in the string that is not C or npos if not found.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8cpp_source.html#l00251">StringRef.cpp:251</a></div></div>
<div class="ttc" id="anamespacellvm_html_a572e1b920d8a5f2a338570c82bbeb446"><div class="ttname"><a href="namespacellvm.html#a572e1b920d8a5f2a338570c82bbeb446">llvm::emitStrNCat</a></div><div class="ttdeci">Value * emitStrNCat(Value *Dest, Value *Src, Value *Size, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strncat function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01652">BuildLibCalls.cpp:1652</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">llvm::Length</a></div><div class="ttdeci">@ Length</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a095a10eac0b263743eb5086a581e4020"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a095a10eac0b263743eb5086a581e4020">isOnlyUsedInEqualityComparison</a></div><div class="ttdeci">static bool isOnlyUsedInEqualityComparison(Value *V, Value *With)</div><div class="ttdoc">Return true if it is only used in equality comparisons with With.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00057">SimplifyLibCalls.cpp:57</a></div></div>
<div class="ttc" id="aclassllvm_1_1GEPOperator_html"><div class="ttname"><a href="classllvm_1_1GEPOperator.html">llvm::GEPOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="Operator_8h_source.html#l00378">Operator.h:378</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1IsaInfo_html_ab6e8b39aa26af871d8ede5fa8c791ee6ad15305d7a4e34e02489c74a5ef542f36"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1IsaInfo.html#ab6e8b39aa26af871d8ede5fa8c791ee6ad15305d7a4e34e02489c74a5ef542f36">llvm::AMDGPU::IsaInfo::TargetIDSetting::Off</a></div><div class="ttdeci">@ Off</div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a24bca8838396aa81b87de8e7ac774b19"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a24bca8838396aa81b87de8e7ac774b19">llvm::PatternMatch::m_Value</a></div><div class="ttdeci">class_match&lt; Value &gt; m_Value()</div><div class="ttdoc">Match an arbitrary value and ignore it.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00076">PatternMatch.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a3b305866956465f5e380e8eecef077e3"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a3b305866956465f5e380e8eecef077e3">optimizeUnaryDoubleFP</a></div><div class="ttdeci">static Value * optimizeUnaryDoubleFP(CallInst *CI, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI, bool isPrecise=false)</div><div class="ttdoc">Shrink double -&gt; float for unary functions.</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01758">SimplifyLibCalls.cpp:1758</a></div></div>
<div class="ttc" id="aTriple_8h_html"><div class="ttname"><a href="Triple_8h.html">Triple.h</a></div></div>
<div class="ttc" id="aPPCReduceCRLogicals_8cpp_html_a2f97198e249f3b493a0abed59c1de605"><div class="ttname"><a href="PPCReduceCRLogicals_8cpp.html#a2f97198e249f3b493a0abed59c1de605">isBinary</a></div><div class="ttdeci">static bool isBinary(MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="PPCReduceCRLogicals_8cpp_source.html#l00253">PPCReduceCRLogicals.cpp:253</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a4d0a7baab8d078065b2de10e3460892a"><div class="ttname"><a href="classllvm_1_1Function.html#a4d0a7baab8d078065b2de10e3460892a">llvm::Function::getIntrinsicID</a></div><div class="ttdeci">Intrinsic::ID getIntrinsicID() const LLVM_READONLY</div><div class="ttdoc">getIntrinsicID - This method returns the ID number of the specified function, or Intrinsic::not_intri...</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00204">Function.h:204</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a0a4d51e372293abe5e5f6dac133e80a6"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">llvm::Instruction::clone</a></div><div class="ttdeci">Instruction * clone() const</div><div class="ttdoc">Create a copy of 'this' instruction that is identical in all ways except the following:</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00903">Instruction.cpp:903</a></div></div>
<div class="ttc" id="aRustDemangle_8cpp_html_a12d4f37888b638bcbd9fc0201492c776"><div class="ttname"><a href="RustDemangle_8cpp.html#a12d4f37888b638bcbd9fc0201492c776">isDigit</a></div><div class="ttdeci">static bool isDigit(const char C)</div><div class="ttdef"><b>Definition:</b> <a href="RustDemangle_8cpp_source.html#l00173">RustDemangle.cpp:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef&lt; unsigned &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html_a5b8cd043d27c642730b103a0eb241bd7"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html#a5b8cd043d27c642730b103a0eb241bd7">llvm::TargetLibraryInfo::getSizeTSize</a></div><div class="ttdeci">unsigned getSizeTSize(const Module &amp;M) const</div><div class="ttdoc">Returns the size of the size_t type in bits.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00504">TargetLibraryInfo.h:504</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_html_a36b03d4697c30b32e8762cb0dfd66761"><div class="ttname"><a href="namespacellvm.html#a36b03d4697c30b32e8762cb0dfd66761">llvm::getConstantDataArrayInfo</a></div><div class="ttdeci">bool getConstantDataArrayInfo(const Value *V, ConstantDataArraySlice &amp;Slice, unsigned ElementSize, uint64_t Offset=0)</div><div class="ttdoc">Returns true if the value V is a pointer into a ConstantDataArray.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04294">ValueTracking.cpp:4294</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8h_html"><div class="ttname"><a href="SimplifyLibCalls_8h.html">SimplifyLibCalls.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">llvm::CmpInst::ICMP_ULT</a></div><div class="ttdeci">@ ICMP_ULT</div><div class="ttdoc">unsigned less than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00743">InstrTypes.h:743</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_aebd8fb1e50c14f4988226de940a067ed"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#aebd8fb1e50c14f4988226de940a067ed">annotateNonNullNoUndefBasedOnAccess</a></div><div class="ttdeci">static void annotateNonNullNoUndefBasedOnAccess(CallInst *CI, ArrayRef&lt; unsigned &gt; ArgNos)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00240">SimplifyLibCalls.cpp:240</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a1906d8faa09882a3104e2f8bcd06ec19"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a1906d8faa09882a3104e2f8bcd06ec19">annotateNonNullAndDereferenceable</a></div><div class="ttdeci">static void annotateNonNullAndDereferenceable(CallInst *CI, ArrayRef&lt; unsigned &gt; ArgNos, Value *Size, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00262">SimplifyLibCalls.cpp:262</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a882d55a6aa2028e1a5ad708b275334e0"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a882d55a6aa2028e1a5ad708b275334e0">llvm::ConstantInt::isZero</a></div><div class="ttdeci">bool isZero() const</div><div class="ttdoc">This is just a convenience method to make client code smaller for a common code.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00193">Constants.h:193</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6a66ebb3aa12757479a3c88de77d78f8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6a66ebb3aa12757479a3c88de77d78f8">llvm::Instruction::getFunction</a></div><div class="ttdeci">const Function * getFunction() const</div><div class="ttdoc">Return the function this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00074">Instruction.cpp:74</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">llvm::ms_demangle::IntrinsicFunctionKind::New</a></div><div class="ttdeci">@ New</div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_a07b994620d0144569ae8250ba59d0d6e"><div class="ttname"><a href="classllvm_1_1CallInst.html#a07b994620d0144569ae8250ba59d0d6e">llvm::CallInst::isNoTailCall</a></div><div class="ttdeci">bool isNoTailCall() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01684">Instructions.h:1684</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_1_1InsertPointGuard_html"><div class="ttname"><a href="classllvm_1_1IRBuilderBase_1_1InsertPointGuard.html">llvm::IRBuilderBase::InsertPointGuard</a></div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00361">IRBuilder.h:361</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html">llvm::IRBuilderBase</a></div><div class="ttdoc">Common base class shared among various IRBuilders.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00094">IRBuilder.h:94</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa2219174d1d70af115609449fea112b1"><div class="ttname"><a href="namespacellvm.html#aa2219174d1d70af115609449fea112b1">llvm::emitStpCpy</a></div><div class="ttdeci">Value * emitStpCpy(Value *Dst, Value *Src, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the stpcpy function to the builder, for the specified pointer arguments.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01496">BuildLibCalls.cpp:1496</a></div></div>
<div class="ttc" id="aclassllvm_1_1FPExtInst_html"><div class="ttname"><a href="classllvm_1_1FPExtInst.html">llvm::FPExtInst</a></div><div class="ttdoc">This class represents an extension of floating point types.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04969">Instructions.h:4969</a></div></div>
<div class="ttc" id="aREADME-FPStack_8txt_html_aeb9a134c2755c0ad7801bf630a790904"><div class="ttname"><a href="README-FPStack_8txt.html#aeb9a134c2755c0ad7801bf630a790904">trunc</a></div><div class="ttdeci">We have fiadd patterns now but the followings have the same cost and complexity We need a way to specify the later is more profitable def def The FP stackifier should handle simple permutates to reduce number of shuffle e g trunc</div><div class="ttdef"><b>Definition:</b> <a href="README-FPStack_8txt_source.html#l00063">README-FPStack.txt:63</a></div></div>
<div class="ttc" id="anamespacellvm_html_a670d4ce84e762e337fbf51e582316e13"><div class="ttname"><a href="namespacellvm.html#a670d4ce84e762e337fbf51e582316e13">llvm::isKnownNeverInfinity</a></div><div class="ttdeci">bool isKnownNeverInfinity(const Value *V, const TargetLibraryInfo *TLI, unsigned Depth=0)</div><div class="ttdoc">Return true if the floating-point scalar value is not an infinity or if the floating-point vector val...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l03766">ValueTracking.cpp:3766</a></div></div>
<div class="ttc" id="anamespacellvm_html_a89b0cdc1642ef7f90fcbf492429d1ad8"><div class="ttname"><a href="namespacellvm.html#a89b0cdc1642ef7f90fcbf492429d1ad8">llvm::emitStrLen</a></div><div class="ttdeci">Value * emitStrLen(Value *Ptr, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strlen function to the builder, for the specified pointer.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01458">BuildLibCalls.cpp:1458</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_ad3c897ba734b78e973db4622dff7bdcb"><div class="ttname"><a href="classllvm_1_1CallInst.html#ad3c897ba734b78e973db4622dff7bdcb">llvm::CallInst::isMustTailCall</a></div><div class="ttdeci">bool isMustTailCall() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01682">Instructions.h:1682</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae1777b151b5f4127a3af26fa2f841a99"><div class="ttname"><a href="namespacellvm.html#ae1777b151b5f4127a3af26fa2f841a99">llvm::emitStrCpy</a></div><div class="ttdeci">Value * emitStrCpy(Value *Dst, Value *Src, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strcpy function to the builder, for the specified pointer arguments.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01489">BuildLibCalls.cpp:1489</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa8f4be0661aa64f5b1f20b15e93bb403"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">llvm::ConstantInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit integer value after it has been sign extended as appropriate for the ...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00147">Constants.h:147</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPUISD_html_a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996"><div class="ttname"><a href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">llvm::AMDGPUISD::BFI</a></div><div class="ttdeci">@ BFI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUISelLowering_8h_source.html#l00441">AMDGPUISelLowering.h:441</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ifs_html_adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df"><div class="ttname"><a href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">llvm::ifs::IFSSymbolType::Func</a></div><div class="ttdeci">@ Func</div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a93306a4da12371d571912f295ccc8a36"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a93306a4da12371d571912f295ccc8a36">copyFlags</a></div><div class="ttdeci">static Value * copyFlags(const CallInst &amp;Old, Value *New)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00283">SimplifyLibCalls.cpp:283</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a4cbb2344996abd4332716e76178ad4f4"><div class="ttname"><a href="classllvm_1_1CallBase.html#a4cbb2344996abd4332716e76178ad4f4">llvm::CallBase::paramHasAttr</a></div><div class="ttdeci">bool paramHasAttr(unsigned ArgNo, Attribute::AttrKind Kind) const</div><div class="ttdoc">Determine whether the argument or parameter has the given attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00352">Instructions.cpp:352</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_aefa39f6b622360ce4e947feb9f671b73"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=std::nullopt)</div><div class="ttdoc">Create or insert an LLVM Function declaration for an intrinsic, and return it.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l01502">Function.cpp:1502</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a0d4bb13ba43d71cfe58184ab1bb4abd1"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0d4bb13ba43d71cfe58184ab1bb4abd1">llvm::Instruction::hasNoNaNs</a></div><div class="ttdeci">bool hasNoNaNs() const LLVM_READONLY</div><div class="ttdoc">Determine whether the no-NaNs flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00309">Instruction.cpp:309</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_aa87fae97a8c702741eca5a95748af49d"><div class="ttname"><a href="classllvm_1_1CallBase.html#aa87fae97a8c702741eca5a95748af49d">llvm::CallBase::doesNotThrow</a></div><div class="ttdeci">bool doesNotThrow() const</div><div class="ttdoc">Determine if the call cannot unwind.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01908">InstrTypes.h:1908</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a1c455e007178a24dfb18ac0e200ea02c"><div class="ttname"><a href="classllvm_1_1Function.html#a1c455e007178a24dfb18ac0e200ea02c">llvm::Function::hasOptSize</a></div><div class="ttdeci">bool hasOptSize() const</div><div class="ttdoc">Optimize this function for size (-Os) or minimum size (-Oz).</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00644">Function.h:644</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ac09a21c371a9c535cbc13e8f82503aec"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit unsigned integer value after it has been zero extended as appropriate...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00141">Constants.h:141</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad95650d790f6f9d252cf0cd0e0094368"><div class="ttname"><a href="namespacellvm.html#ad95650d790f6f9d252cf0cd0e0094368">llvm::ConstantFoldLoadFromConstPtr</a></div><div class="ttdeci">Constant * ConstantFoldLoadFromConstPtr(Constant *C, Type *Ty, APInt Offset, const DataLayout &amp;DL)</div><div class="ttdoc">Return the value that a load from C with offset Offset would produce if it is constant and determinab...</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolding_8cpp_source.html#l00729">ConstantFolding.cpp:729</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_a537c835c34f0b44b6ad2696643754390"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Callee</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a5db9240c74644c67759dd0f901fc3c7d"><div class="ttname"><a href="classllvm_1_1StringRef.html#a5db9240c74644c67759dd0f901fc3c7d">llvm::StringRef::size</a></div><div class="ttdeci">constexpr size_t size() const</div><div class="ttdoc">size - Get the string size.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00137">StringRef.h:137</a></div></div>
<div class="ttc" id="anamespacellvm_html_a86ed66258951782b18db38fb510cca4d"><div class="ttname"><a href="namespacellvm.html#a86ed66258951782b18db38fb510cca4d">llvm::GetStringLength</a></div><div class="ttdeci">uint64_t GetStringLength(const Value *V, unsigned CharSize=8)</div><div class="ttdoc">If we can compute the length of the string pointed to by the specified pointer, return 'len+1'.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04500">ValueTracking.cpp:4500</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57d0e3799b16937e1f8df20ca1f1f3df"><div class="ttname"><a href="namespacellvm.html#a57d0e3799b16937e1f8df20ca1f1f3df">llvm::isLibFuncEmittable</a></div><div class="ttdeci">bool isLibFuncEmittable(const Module *M, const TargetLibraryInfo *TLI, LibFunc TheLibFunc)</div><div class="ttdoc">Check whether the library function is available on target and also that it in the current Module is a...</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01363">BuildLibCalls.cpp:1363</a></div></div>
<div class="ttc" id="astructllvm_1_1APFloatBase_html_a482d9cf95b588eb05cefeaa5c05be9a3"><div class="ttname"><a href="structllvm_1_1APFloatBase.html#a482d9cf95b588eb05cefeaa5c05be9a3">llvm::APFloatBase::rmTowardZero</a></div><div class="ttdeci">static constexpr roundingMode rmTowardZero</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00221">APFloat.h:221</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa656aa475d13ec6a900414eadabe86b0"><div class="ttname"><a href="namespacellvm.html#aa656aa475d13ec6a900414eadabe86b0">llvm::minnum</a></div><div class="ttdeci">LLVM_READONLY APFloat minnum(const APFloat &amp;A, const APFloat &amp;B)</div><div class="ttdoc">Implements IEEE minNum semantics.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01346">APFloat.h:1346</a></div></div>
<div class="ttc" id="anamespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00050">GraphWriter.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdoc">Constructor to create a '0' constant of arbitrary type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00356">Constants.cpp:356</a></div></div>
<div class="ttc" id="astructllvm_1_1KnownBits_html"><div class="ttname"><a href="structllvm_1_1KnownBits.html">llvm::KnownBits</a></div><div class="ttdef"><b>Definition:</b> <a href="KnownBits_8h_source.html#l00023">KnownBits.h:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3ffc75c3a4cb82ba307a3334483eb4ac"><div class="ttname"><a href="classllvm_1_1Type.html#a3ffc75c3a4cb82ba307a3334483eb4ac">llvm::Type::isFloatTy</a></div><div class="ttdeci">bool isFloatTy() const</div><div class="ttdoc">Return true if this is 'float', a 32-bit IEEE fp type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00154">Type.h:154</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86_html_a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e"><div class="ttname"><a href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">llvm::X86::FirstMacroFusionInstKind::Cmp</a></div><div class="ttdeci">@ Cmp</div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_adde2ea00dd2613ee41bfe91908e4e68e"><div class="ttname"><a href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">llvm::CallBase::arg_size</a></div><div class="ttdeci">unsigned arg_size() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01349">InstrTypes.h:1349</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a5e12ccb17d041c296cf5abc1e4628fb8"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a5e12ccb17d041c296cf5abc1e4628fb8">replaceUnaryCall</a></div><div class="ttdeci">static Value * replaceUnaryCall(CallInst *CI, IRBuilderBase &amp;B, Intrinsic::ID IID)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01661">SimplifyLibCalls.cpp:1661</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFP_html_a5eb8f7a5d3cfdd127ad9db2e425e14eb"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a5eb8f7a5d3cfdd127ad9db2e425e14eb">llvm::ConstantFP::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, double V)</div><div class="ttdoc">This returns a ConstantFP, or a vector containing a splat of a ConstantFP, for the specified value in...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00934">Constants.cpp:934</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_abee0df5f7f703bb4462aba260ba0a60f"><div class="ttname"><a href="namespacellvm.html#abee0df5f7f703bb4462aba260ba0a60f">llvm::BitWidth</a></div><div class="ttdeci">constexpr unsigned BitWidth</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00147">BitmaskEnum.h:147</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_adc01a7457de85fc52a3bb860d7e1c6a4"><div class="ttname"><a href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0) const</div><div class="ttdoc">Return a pointer to the current type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00776">Type.cpp:776</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdoc">Provides information about what library functions are available for the current target.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00234">TargetLibraryInfo.h:234</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_aa0fd6bf3d33236279db7b707bba755f4"><div class="ttname"><a href="classllvm_1_1Type.html#aa0fd6bf3d33236279db7b707bba755f4">llvm::Type::isDoubleTy</a></div><div class="ttdeci">bool isDoubleTy() const</div><div class="ttdoc">Return true if this is 'double', a 64-bit IEEE fp type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00157">Type.h:157</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a5cef66dcb1fc369e64240a0bff194597"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a5cef66dcb1fc369e64240a0bff194597">powi</a></div><div class="ttdeci">This is blocked on not handling X *X *X powi(X, 3)(see note above). The issue is that we end up getting t</div></div>
<div class="ttc" id="anamespacellvm_html_a689dd439a7989cc49b73cd6eb52d90dc"><div class="ttname"><a href="namespacellvm.html#a689dd439a7989cc49b73cd6eb52d90dc">llvm::emitFPutS</a></div><div class="ttdeci">Value * emitFPutS(Value *Str, Value *File, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the fputs function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01857">BuildLibCalls.cpp:1857</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AttributeFuncs_html_ae48bd752d74f193a0651b89931b28025"><div class="ttname"><a href="namespacellvm_1_1AttributeFuncs.html#ae48bd752d74f193a0651b89931b28025">llvm::AttributeFuncs::typeIncompatible</a></div><div class="ttdeci">AttributeMask typeIncompatible(Type *Ty, AttributeSafetyKind ASK=ASK_ALL)</div><div class="ttdoc">Which attributes cannot be applied to a type.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01889">Attributes.cpp:1889</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0f4bd88bd90f06f0e66d0b20f877cd1e"><div class="ttname"><a href="namespacellvm.html#a0f4bd88bd90f06f0e66d0b20f877cd1e">llvm::log2</a></div><div class="ttdeci">static double log2(double V)</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00794">AMDGPULibCalls.cpp:794</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6467ebe1e09a75203dd5f14bdfe21d11"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">llvm::AMDGPU::Hwreg::Width</a></div><div class="ttdeci">Width</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00449">SIDefines.h:449</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac76c99e44c5f3570a3666c9234caf222"><div class="ttname"><a href="namespacellvm.html#ac76c99e44c5f3570a3666c9234caf222">llvm::emitMalloc</a></div><div class="ttdeci">Value * emitMalloc(Value *Num, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the malloc function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01901">BuildLibCalls.cpp:1901</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a83a294111af6d4412163b209725ca556"><div class="ttname"><a href="classllvm_1_1StringRef.html#a83a294111af6d4412163b209725ca556">llvm::StringRef::contains</a></div><div class="ttdeci">bool contains(StringRef Other) const</div><div class="ttdoc">Return true if the given string is a substring of *this, and false otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00423">StringRef.h:423</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1f00bd493d9df4474770b08908867a69"><div class="ttname"><a href="namespacellvm.html#a1f00bd493d9df4474770b08908867a69">llvm::castToCStr</a></div><div class="ttdeci">Value * castToCStr(Value *V, IRBuilderBase &amp;B)</div><div class="ttdoc">Return V if it is an i8*, otherwise cast it to i8*.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01424">BuildLibCalls.cpp:1424</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ab9370b798ae530641518075b0832723a"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ab9370b798ae530641518075b0832723a">llvm::PatternMatch::m_AnyZeroFP</a></div><div class="ttdeci">cstfp_pred_ty&lt; is_any_zero_fp &gt; m_AnyZeroFP()</div><div class="ttdoc">Match a floating-point negative zero or positive zero.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00664">PatternMatch.h:664</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a43efe9700a64d52fdf51d350923eef33"><div class="ttname"><a href="classllvm_1_1APFloat.html#a43efe9700a64d52fdf51d350923eef33">llvm::APFloat::isExactlyValue</a></div><div class="ttdeci">bool isExactlyValue(double V) const</div><div class="ttdoc">We don't rely on operator== working on double values, as it returns true for things that are clearly ...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01242">APFloat.h:1242</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_aed565a1dfd056c37a481581db8cdbedd"><div class="ttname"><a href="classllvm_1_1Instruction.html#aed565a1dfd056c37a481581db8cdbedd">llvm::Instruction::hasAllowReassoc</a></div><div class="ttdeci">bool hasAllowReassoc() const LLVM_READONLY</div><div class="ttdoc">Determine whether the allow-reassociation flag is set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00304">Instruction.cpp:304</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a60311aae406df2143c650f3bce27e036"><div class="ttname"><a href="classllvm_1_1Instruction.html#a60311aae406df2143c650f3bce27e036">llvm::Instruction::isFast</a></div><div class="ttdeci">bool isFast() const LLVM_READONLY</div><div class="ttdoc">Determine whether all fast-math-flags are set.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00299">Instruction.cpp:299</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="astructllvm_1_1APFloatBase_html_a22ed74f1ed33c4d33f524a650ea536a6"><div class="ttname"><a href="structllvm_1_1APFloatBase.html#a22ed74f1ed33c4d33f524a650ea536a6">llvm::APFloatBase::rmNearestTiesToEven</a></div><div class="ttdeci">static constexpr roundingMode rmNearestTiesToEven</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00217">APFloat.h:217</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a257e3cb529defa79ad7a9f42072f339a"><div class="ttname"><a href="classllvm_1_1APFloat.html#a257e3cb529defa79ad7a9f42072f339a">llvm::APFloat::convert</a></div><div class="ttdeci">opStatus convert(const fltSemantics &amp;ToSemantics, roundingMode RM, bool *losesInfo)</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8cpp_source.html#l05364">APFloat.cpp:5364</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a81eef9d7336f7ee43be79630d8e8ec86"><div class="ttname"><a href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">llvm::Type::isStructTy</a></div><div class="ttdeci">bool isStructTy() const</div><div class="ttdoc">True if this is an instance of StructType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00243">Type.h:243</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">llvm::pdb::DbgHeaderType::Max</a></div><div class="ttdeci">@ Max</div></div>
<div class="ttc" id="anamespacellvm_html_a14a05ffce8dd7f9e6fe4a0b96dc313e6"><div class="ttname"><a href="namespacellvm.html#a14a05ffce8dd7f9e6fe4a0b96dc313e6">llvm::emitStrNCpy</a></div><div class="ttdeci">Value * emitStrNCpy(Value *Dst, Value *Src, Value *Len, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strncpy function to the builder, for the specified pointer arguments and length.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01503">BuildLibCalls.cpp:1503</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba607cecdc5172814382033e001ed11fad"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba607cecdc5172814382033e001ed11fad">llvm::CmpInst::ICMP_UGT</a></div><div class="ttdeci">@ ICMP_UGT</div><div class="ttdoc">unsigned greater than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00741">InstrTypes.h:741</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a86ec13a58628abfcbee9652dcd8633ed"><div class="ttname"><a href="classllvm_1_1Module.html#a86ec13a58628abfcbee9652dcd8633ed">llvm::Module::getTargetTriple</a></div><div class="ttdeci">const std::string &amp; getTargetTriple() const</div><div class="ttdoc">Get the target triple which is a string describing the target host.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00258">Module.h:258</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aclassllvm_1_1FPTruncInst_html"><div class="ttname"><a href="classllvm_1_1FPTruncInst.html">llvm::FPTruncInst</a></div><div class="ttdoc">This class represents a truncation of floating point types.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04930">Instructions.h:4930</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_aa7414ba9f658ff1287d22a4b8fe81bcb"><div class="ttname"><a href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const</div><div class="ttdoc">Return the predicate for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00808">InstrTypes.h:808</a></div></div>
<div class="ttc" id="anamespacellvm_html_a656b9d85656ae6dd73f482f6d5639b97"><div class="ttname"><a href="namespacellvm.html#a656b9d85656ae6dd73f482f6d5639b97">llvm::emitBinaryFloatFnCall</a></div><div class="ttdeci">Value * emitBinaryFloatFnCall(Value *Op1, Value *Op2, const TargetLibraryInfo *TLI, StringRef Name, IRBuilderBase &amp;B, const AttributeList &amp;Attrs)</div><div class="ttdoc">Emit a call to the binary function named 'Name' (e.g.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01769">BuildLibCalls.cpp:1769</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a5b6faabb08339ea1dd11e9d37a668634"><div class="ttname"><a href="classllvm_1_1StringRef.html#a5b6faabb08339ea1dd11e9d37a668634">llvm::StringRef::back</a></div><div class="ttdeci">char back() const</div><div class="ttdoc">back - Get the last character in the string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00146">StringRef.h:146</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionCallee_html"><div class="ttname"><a href="classllvm_1_1FunctionCallee.html">llvm::FunctionCallee</a></div><div class="ttdoc">A handy container for a FunctionType+Callee-pointer pair, which can be passed around as a single enti...</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00165">DerivedTypes.h:165</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a3fd487d9643d814ffb8ef37443e70a27acad39a154bffb61175f674d6eefaf6d0"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a3fd487d9643d814ffb8ef37443e70a27acad39a154bffb61175f674d6eefaf6d0">llvm::codeview::CompileSym3Flags::Exp</a></div><div class="ttdeci">@ Exp</div></div>
<div class="ttc" id="anamespacellvm_html_a9b45cdd248363e4cae6c330d167f93f0"><div class="ttname"><a href="namespacellvm.html#a9b45cdd248363e4cae6c330d167f93f0">llvm::emitSNPrintf</a></div><div class="ttdeci">Value * emitSNPrintf(Value *Dest, Value *Size, Value *Fmt, ArrayRef&lt; Value * &gt; Args, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the snprintf function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01602">BuildLibCalls.cpp:1602</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad0f8cc4358373eeb5363cd620bbdaeab"><div class="ttname"><a href="namespacellvm.html#ad0f8cc4358373eeb5363cd620bbdaeab">llvm::emitPutS</a></div><div class="ttdeci">Value * emitPutS(Value *Str, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the puts function. This assumes that Str is some pointer.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01819">BuildLibCalls.cpp:1819</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl&lt; CallInst * &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0ba6a71235e219f0d87ab9f7c43476a9"><div class="ttname"><a href="namespacellvm.html#a0ba6a71235e219f0d87ab9f7c43476a9">llvm::emitStrChr</a></div><div class="ttdeci">Value * emitStrChr(Value *Ptr, char C, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the strchr function to the builder, for the specified pointer and character.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01471">BuildLibCalls.cpp:1471</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a6d883605206368bc536cc9ded97209b8"><div class="ttname"><a href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">llvm::Module::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Get the data layout for the module's target platform.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00398">Module.cpp:398</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_aab312a8386488873bac2eddfc67c22be"><div class="ttname"><a href="classllvm_1_1StringRef.html#aab312a8386488873bac2eddfc67c22be">llvm::StringRef::find</a></div><div class="ttdeci">size_t find(char C, size_t From=0) const</div><div class="ttdoc">Search for the first character C in the string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00295">StringRef.h:295</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntegerType_html_a14f7b4f1aed38192fb6b7772eb506bdb"><div class="ttname"><a href="classllvm_1_1IntegerType.html#a14f7b4f1aed38192fb6b7772eb506bdb">llvm::IntegerType::get</a></div><div class="ttdeci">static IntegerType * get(LLVMContext &amp;C, unsigned NumBits)</div><div class="ttdoc">This static method is the primary way of constructing an IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00313">Type.cpp:313</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfoImpl_html_a6fe2425902ca5775f3b350cfbe49cc8f"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfoImpl.html#a6fe2425902ca5775f3b350cfbe49cc8f">llvm::TargetLibraryInfoImpl::isCallingConvCCompatible</a></div><div class="ttdeci">static bool isCallingConvCCompatible(CallBase *CI)</div><div class="ttdoc">Returns true if call site / callee has cdecl-compatible calling conventions.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00137">TargetLibraryInfo.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a244bfbe5aae876e56cf5e62f0f27867a"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a244bfbe5aae876e56cf5e62f0f27867a">llvm::ConstantInt::isOne</a></div><div class="ttdeci">bool isOne() const</div><div class="ttdoc">This is just a convenience method to make client code smaller for a common case.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00199">Constants.h:199</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="astructllvm_1_1ConstantDataArraySlice_html"><div class="ttname"><a href="structllvm_1_1ConstantDataArraySlice.html">llvm::ConstantDataArraySlice</a></div><div class="ttdoc">Represents offset+length into a ConstantDataArray.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8h_source.html#l00294">ValueTracking.h:294</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_ab845621311caa169682acb9c65516ae1"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#ab845621311caa169682acb9c65516ae1">substr</a></div><div class="ttdeci">static StringRef substr(StringRef Str, uint64_t Len)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00299">SimplifyLibCalls.cpp:299</a></div></div>
<div class="ttc" id="anamespacellvm_html_af80bd4ec8a9b2f8e7d9d75ab708a55c2"><div class="ttname"><a href="namespacellvm.html#af80bd4ec8a9b2f8e7d9d75ab708a55c2">llvm::maxUIntN</a></div><div class="ttdeci">uint64_t maxUIntN(uint64_t N)</div><div class="ttdoc">Gets the maximum value for a N-bit unsigned integer.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00229">MathExtras.h:229</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdoc">Transfer the name from V to this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00381">Value.cpp:381</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a76adb4549f349676de0a703a497ca5a5"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a76adb4549f349676de0a703a497ca5a5">Mod</a></div><div class="ttdeci">Module * Mod</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00054">PassBuilderBindings.cpp:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeSet_html_abbebeeab2f7fc663ae61eb5c391a79db"><div class="ttname"><a href="classllvm_1_1AttributeSet.html#abbebeeab2f7fc663ae61eb5c391a79db">llvm::AttributeSet::getAlignment</a></div><div class="ttdeci">MaybeAlign getAlignment() const</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l00776">Attributes.cpp:776</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7b03ed78a8e299bde6d26a8793cd4e06"><div class="ttname"><a href="namespacellvm.html#a7b03ed78a8e299bde6d26a8793cd4e06">llvm::NullPointerIsDefined</a></div><div class="ttdeci">bool NullPointerIsDefined(const Function *F, unsigned AS=0)</div><div class="ttdoc">Check whether null pointer dereferencing is considered undefined behavior for a given function or an ...</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l02136">Function.cpp:2136</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a24ff4e69025be7564b19025b93cac8d9"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a24ff4e69025be7564b19025b93cac8d9">canTransformToMemCmp</a></div><div class="ttdeci">static bool canTransformToMemCmp(CallInst *CI, Value *Str, uint64_t Len, const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l00201">SimplifyLibCalls.cpp:201</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feeda94ec9273479164e4aec1d5d91b71dc85">llvm::CallingConv::Cold</a></div><div class="ttdeci">@ Cold</div><div class="ttdoc">Attempts to make code in the caller as efficient as possible under the assumption that the call is no...</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00047">CallingConv.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_ada7a173c40ca7ac048a4b7099ceb71c0"><div class="ttname"><a href="classllvm_1_1AttributeList.html#ada7a173c40ca7ac048a4b7099ceb71c0">llvm::AttributeList::getParamAttrs</a></div><div class="ttdeci">AttributeSet getParamAttrs(unsigned ArgNo) const</div><div class="ttdoc">The attributes for the argument or parameter at the given index are returned.</div><div class="ttdef"><b>Definition:</b> <a href="Attributes_8cpp_source.html#l01454">Attributes.cpp:1454</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_a1485593d8fe2ff9daade68b22fc01249"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#a1485593d8fe2ff9daade68b22fc01249">EnableUnsafeFPShrink</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableUnsafeFPShrink(&quot;enable-double-float-shrink&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Enable unsafe double to float &quot; &quot;shrinking for math lib calls&quot;))</div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a7aff89f4f22502c8ad9118bed59ce21c"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a7aff89f4f22502c8ad9118bed59ce21c">llvm::PatternMatch::m_FMul</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, Instruction::FMul &gt; m_FMul(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l01051">PatternMatch.h:1051</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2816e84a08c108d18bc4665bc1817e01"><div class="ttname"><a href="namespacellvm.html#a2816e84a08c108d18bc4665bc1817e01">llvm::abs</a></div><div class="ttdeci">APFloat abs(APFloat X)</div><div class="ttdoc">Returns the absolute value of the argument.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01332">APFloat.h:1332</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9310a89abda7116ac06bf226544daadd"><div class="ttname"><a href="namespacellvm.html#a9310a89abda7116ac06bf226544daadd">llvm::emitVSPrintf</a></div><div class="ttdeci">Value * emitVSPrintf(Value *Dest, Value *Fmt, Value *VAList, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the vsprintf function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01672">BuildLibCalls.cpp:1672</a></div></div>
<div class="ttc" id="aBuildLibCalls_8h_html"><div class="ttname"><a href="BuildLibCalls_8h.html">BuildLibCalls.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5d61091498dd892d586e250c8d29fe3a"><div class="ttname"><a href="namespacellvm.html#a5d61091498dd892d586e250c8d29fe3a">llvm::emitVSNPrintf</a></div><div class="ttdeci">Value * emitVSNPrintf(Value *Dest, Value *Size, Value *Fmt, Value *VAList, IRBuilderBase &amp;B, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the vsnprintf function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01661">BuildLibCalls.cpp:1661</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_a8f907245246e05c0220934144c013aee"><div class="ttname"><a href="classllvm_1_1CallInst.html#a8f907245246e05c0220934144c013aee">llvm::CallInst::getTailCallKind</a></div><div class="ttdeci">TailCallKind getTailCallKind() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01673">Instructions.h:1673</a></div></div>
<div class="ttc" id="aSimplifyLibCalls_8cpp_html_af91095dff7bacd615e3add3634f489ea"><div class="ttname"><a href="SimplifyLibCalls_8cpp.html#af91095dff7bacd615e3add3634f489ea">optimizeTrigReflections</a></div><div class="ttdeci">static Value * optimizeTrigReflections(CallInst *Call, LibFunc Func, IRBuilderBase &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="SimplifyLibCalls_8cpp_source.html#l01801">SimplifyLibCalls.cpp:1801</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ac63dbb4994494c46f025715272cdb81e"><div class="ttname"><a href="classllvm_1_1CallBase.html#ac63dbb4994494c46f025715272cdb81e">llvm::CallBase::args</a></div><div class="ttdeci">iterator_range&lt; User::op_iterator &gt; args()</div><div class="ttdoc">Iteration adapter for range-for loops.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01342">InstrTypes.h:1342</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_1_1OperandBundlesGuard_html"><div class="ttname"><a href="classllvm_1_1IRBuilderBase_1_1OperandBundlesGuard.html">llvm::IRBuilderBase::OperandBundlesGuard</a></div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00412">IRBuilder.h:412</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_ae2705fd641fb3d1eefa2691b5117cf22"><div class="ttname"><a href="classllvm_1_1StringRef.html#ae2705fd641fb3d1eefa2691b5117cf22">llvm::StringRef::drop_back</a></div><div class="ttdeci">StringRef drop_back(size_t N=1) const</div><div class="ttdoc">Return a StringRef equal to 'this' but with the last N elements dropped.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00604">StringRef.h:604</a></div></div>
<div class="ttc" id="anamespacellvm_html_acaee7c149092d8a3f5c9b626030c6fa9"><div class="ttname"><a href="namespacellvm.html#acaee7c149092d8a3f5c9b626030c6fa9">llvm::emitMemChr</a></div><div class="ttdeci">Value * emitMemChr(Value *Ptr, Value *Val, Value *Len, IRBuilderBase &amp;B, const DataLayout &amp;DL, const TargetLibraryInfo *TLI)</div><div class="ttdoc">Emit a call to the memchr function.</div><div class="ttdef"><b>Definition:</b> <a href="BuildLibCalls_8cpp_source.html#l01552">BuildLibCalls.cpp:1552</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2da012cb3e5534bbee33563d309bc354"><div class="ttname"><a href="namespacellvm.html#a2da012cb3e5534bbee33563d309bc354">llvm::isDereferenceableAndAlignedPointer</a></div><div class="ttdeci">bool isDereferenceableAndAlignedPointer(const Value *V, Type *Ty, Align Alignment, const DataLayout &amp;DL, const Instruction *CtxI=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Returns true if V is always a dereferenceable pointer with alignment greater or equal than requested.</div><div class="ttdef"><b>Definition:</b> <a href="Loads_8cpp_source.html#l00201">Loads.cpp:201</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html"><div class="ttname"><a href="classllvm_1_1FunctionType.html">llvm::FunctionType</a></div><div class="ttdoc">Class to represent function types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00103">DerivedTypes.h:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a833daf718a49c5cd637d8c9ddeaebe07"><div class="ttname"><a href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">TypeSize getPrimitiveSizeInBits() const LLVM_READONLY</div><div class="ttdoc">Return the basic size of this type if it is a primitive type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00163">Type.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_a80add6b3b1cdaec560907995127adc16"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">llvm::Intrinsic::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00039">TargetTransformInfo.h:39</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:38:09 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
