<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/MCA/IncrementalSourceMgr.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_cb45c0f3679d3f959ecd5a490a86aa87.html">MCA</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">IncrementalSourceMgr.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="IncrementalSourceMgr_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===-------------------- IncrementalSourceMgr.cpp ------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// \file</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// This file defines some implementations for IncrementalSourceMgr.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IncrementalSourceMgr_8h.html">llvm/MCA/IncrementalSourceMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Format_8h.html">llvm/Support/Format.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1mca.html">llvm::mca</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#aac1bf46c1b8d46f2675e857ff328b2e1">   22</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#aac1bf46c1b8d46f2675e857ff328b2e1">IncrementalSourceMgr::clear</a>() {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  Staging.clear();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  InstStorage.clear();</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  TotalCounter = 0U;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  EOS = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#ae7e7a65dca58ec0969862ae9fe6ba64e">   29</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#ae7e7a65dca58ec0969862ae9fe6ba64e">IncrementalSourceMgr::updateNext</a>() {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  ++TotalCounter;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="classllvm_1_1mca_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Staging.front();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  Staging.pop_front();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;reset();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">if</span> (InstFreedCB)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    InstFreedCB(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#a55086232b62ba76e882e380ca1e4576a">   40</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#a55086232b62ba76e882e380ca1e4576a">IncrementalSourceMgr::printStatistic</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">unsigned</span> MaxInstStorageSize = InstStorage.size();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">if</span> (MaxInstStorageSize &lt;= TotalCounter) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">auto</span> Ratio = <a class="code" href="README-SSE_8txt.html#a698e4bd87a8adc0c042ae6b6e10ee6e1">double</a>(MaxInstStorageSize) / <a class="code" href="README-SSE_8txt.html#a698e4bd87a8adc0c042ae6b6e10ee6e1">double</a>(TotalCounter);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;Cache ratio = &quot;</span> &lt;&lt; MaxInstStorageSize &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; TotalCounter</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       &lt;&lt; <a class="code" href="namespacellvm.html#a66f0c57e04037076030c6a6e48f44f2d">llvm::format</a>(<span class="stringliteral">&quot; (%.2f%%)&quot;</span>, (1.0 - Ratio) * 100.0) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;Error: Number of created instructions &quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;are larger than the number of issued instructions\n&quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_1_1mca_html"><div class="ttname"><a href="namespacellvm_1_1mca.html">llvm::mca</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegistry_8h_source.html#l00060">TargetRegistry.h:60</a></div></div>
<div class="ttc" id="aclassllvm_1_1mca_1_1IncrementalSourceMgr_html_ae7e7a65dca58ec0969862ae9fe6ba64e"><div class="ttname"><a href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#ae7e7a65dca58ec0969862ae9fe6ba64e">llvm::mca::IncrementalSourceMgr::updateNext</a></div><div class="ttdeci">void updateNext() override</div><div class="ttdoc">Advance to the next SourceRef.</div><div class="ttdef"><b>Definition:</b> <a href="IncrementalSourceMgr_8cpp_source.html#l00029">IncrementalSourceMgr.cpp:29</a></div></div>
<div class="ttc" id="aIncrementalSourceMgr_8h_html"><div class="ttname"><a href="IncrementalSourceMgr_8h.html">IncrementalSourceMgr.h</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a698e4bd87a8adc0c042ae6b6e10ee6e1"><div class="ttname"><a href="README-SSE_8txt.html#a698e4bd87a8adc0c042ae6b6e10ee6e1">double</a></div><div class="ttdeci">into xmm2 addss xmm2 xmm1 xmm3 addss xmm3 movaps xmm0 unpcklps xmm0 ret seems silly when it could just be one addps Expand libm rounding functions main should enable SSE DAZ mode and other fast SSE modes Think about doing i64 math in SSE regs on x86 This testcase should have no SSE instructions in and only one load from a constant double</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00085">README-SSE.txt:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1mca_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1mca_1_1Instruction.html">llvm::mca::Instruction</a></div><div class="ttdoc">An instruction propagated through the simulated instruction pipeline.</div><div class="ttdef"><b>Definition:</b> <a href="MCA_2Instruction_8h_source.html#l00600">Instruction.h:600</a></div></div>
<div class="ttc" id="aFormat_8h_html"><div class="ttname"><a href="Format_8h.html">Format.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1mca_1_1IncrementalSourceMgr_html_aac1bf46c1b8d46f2675e857ff328b2e1"><div class="ttname"><a href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#aac1bf46c1b8d46f2675e857ff328b2e1">llvm::mca::IncrementalSourceMgr::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="IncrementalSourceMgr_8cpp_source.html#l00022">IncrementalSourceMgr.cpp:22</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00052">raw_ostream.h:52</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_html_a66f0c57e04037076030c6a6e48f44f2d"><div class="ttname"><a href="namespacellvm.html#a66f0c57e04037076030c6a6e48f44f2d">llvm::format</a></div><div class="ttdeci">format_object&lt; Ts... &gt; format(const char *Fmt, const Ts &amp;... Vals)</div><div class="ttdoc">These are helper functions used to produce formatted output.</div><div class="ttdef"><b>Definition:</b> <a href="Format_8h_source.html#l00124">Format.h:124</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1mca_1_1IncrementalSourceMgr_html_a55086232b62ba76e882e380ca1e4576a"><div class="ttname"><a href="classllvm_1_1mca_1_1IncrementalSourceMgr.html#a55086232b62ba76e882e380ca1e4576a">llvm::mca::IncrementalSourceMgr::printStatistic</a></div><div class="ttdeci">void printStatistic(raw_ostream &amp;OS)</div><div class="ttdoc">Print statistic about instruction recycling stats.</div><div class="ttdef"><b>Definition:</b> <a href="IncrementalSourceMgr_8cpp_source.html#l00040">IncrementalSourceMgr.cpp:40</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:06:41 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
