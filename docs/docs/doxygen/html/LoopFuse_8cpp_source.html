<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Scalar/LoopFuse.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_e6e1f1f37d351595fa984b942927b205.html">Scalar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LoopFuse.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="LoopFuse_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- LoopFuse.cpp - Loop Fusion Pass ------------------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// \file</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// This file implements the loop fusion pass.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/// The implementation is largely based on the following document:</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">///       Code Transformations to Augment the Scope of Loop Fusion in a</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">///         Production Compiler</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">///       Christopher Mark Barton</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">///       MSc Thesis</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">///       https://webdocs.cs.ualberta.ca/~amaral/thesis/ChristopherBartonMSc.pdf</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/// The general approach taken is to collect sets of control flow equivalent</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/// loops and test whether they can be fused. The necessary conditions for</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/// fusion are:</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">///    1. The loops must be adjacent (there cannot be any statements between</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">///       the two loops).</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">///    2. The loops must be conforming (they must execute the same number of</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">///       iterations).</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">///    3. The loops must be control flow equivalent (if one loop executes, the</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">///       other is guaranteed to execute).</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">///    4. There cannot be any negative distance dependencies between the loops.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/// If all of these conditions are satisfied, it is safe to fuse the loops.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/// This implementation creates FusionCandidates that represent the loop and the</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/// necessary information needed by fusion. It then operates on the fusion</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/// candidates, first confirming that the candidate is eligible for fusion. The</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/// candidates are then collected into control flow equivalent sets, sorted in</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/// dominance order. Each set of control flow equivalent candidates is then</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/// traversed, attempting to fuse pairs of candidates in the set. If all</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/// requirements for fusion are met, the two candidates are fused, creating a</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/// new (fused) candidate which is then added back into the set to consider for</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/// additional fusion.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/// This implementation currently does not make any modifications to remove</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// conditions for fusion. Code transformations to make loops conform to each of</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/// the conditions for fusion are discussed in more detail in the document</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// above. These can be added to the current implementation in the future.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopFuse_8h.html">llvm/Transforms/Scalar/LoopFuse.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AssumptionCache_8h.html">llvm/Analysis/AssumptionCache.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DependenceAnalysis_8h.html">llvm/Analysis/DependenceAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DomTreeUpdater_8h.html">llvm/Analysis/DomTreeUpdater.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostDominators_8h.html">llvm/Analysis/PostDominators.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolution_8h.html">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpressions_8h.html">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Verifier_8h.html">llvm/IR/Verifier.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_8h.html">llvm/Transforms/Utils.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeMoverUtils_8h.html">llvm/Transforms/Utils/CodeMoverUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopPeel_8h.html">llvm/Transforms/Utils/LoopPeel.h</a>&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopSimplify_8h.html">llvm/Transforms/Utils/LoopSimplify.h</a>&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="LoopFuse_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   74</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;loop-fusion&quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(FuseCounter, <span class="stringliteral">&quot;Loops fused&quot;</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumFusionCandidates, <span class="stringliteral">&quot;Number of candidates for loop fusion&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(InvalidPreheader, <span class="stringliteral">&quot;Loop has invalid preheader&quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(InvalidHeader, <span class="stringliteral">&quot;Loop has invalid header&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(InvalidExitingBlock, <span class="stringliteral">&quot;Loop has invalid exiting blocks&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(InvalidExitBlock, <span class="stringliteral">&quot;Loop has invalid exit block&quot;</span>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(InvalidLatch, <span class="stringliteral">&quot;Loop has invalid latch&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(InvalidLoop, <span class="stringliteral">&quot;Loop is invalid&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(AddressTakenBB, <span class="stringliteral">&quot;Basic block has address taken&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(MayThrowException, <span class="stringliteral">&quot;Loop may throw an exception&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(ContainsVolatileAccess, <span class="stringliteral">&quot;Loop contains a volatile access&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NotSimplifiedForm, <span class="stringliteral">&quot;Loop is not in simplified form&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(InvalidDependencies, <span class="stringliteral">&quot;Dependencies prevent fusion&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(UnknownTripCount, <span class="stringliteral">&quot;Loop has unknown trip count&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(UncomputableTripCount, <span class="stringliteral">&quot;SCEV cannot compute trip count of loop&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NonEqualTripCount, <span class="stringliteral">&quot;Loop trip counts are not the same&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NonAdjacent, <span class="stringliteral">&quot;Loops are not adjacent&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    NonEmptyPreheader,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="stringliteral">&quot;Loop has a non-empty preheader with instructions that cannot be moved&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(FusionNotBeneficial, <span class="stringliteral">&quot;Fusion is not beneficial&quot;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NonIdenticalGuards, <span class="stringliteral">&quot;Candidates have different guards&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NonEmptyExitBlock, <span class="stringliteral">&quot;Candidate has a non-empty exit block with &quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                             <span class="stringliteral">&quot;instructions that cannot be moved&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NonEmptyGuardBlock, <span class="stringliteral">&quot;Candidate has a non-empty guard block with &quot;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                              <span class="stringliteral">&quot;instructions that cannot be moved&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NotRotated, <span class="stringliteral">&quot;Candidate is not rotated&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(OnlySecondCandidateIsGuarded,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <span class="stringliteral">&quot;The second candidate is guarded while the first one is not&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumHoistedInsts, <span class="stringliteral">&quot;Number of hoisted preheader instructions.&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumSunkInsts, <span class="stringliteral">&quot;Number of hoisted preheader instructions.&quot;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50b">  108</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50b">FusionDependenceAnalysisChoice</a> {</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50bae2968bc1b6d284f07e96fac3ce78bc54">  109</a></span>&#160;  <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50bae2968bc1b6d284f07e96fac3ce78bc54">FUSION_DEPENDENCE_ANALYSIS_SCEV</a>,</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba88a2ef6139ee028e3fa8addb323b3917">  110</a></span>&#160;  <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba88a2ef6139ee028e3fa8addb323b3917">FUSION_DEPENDENCE_ANALYSIS_DA</a>,</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba9f38e26f008e10a2cd493e477865cf72">  111</a></span>&#160;  <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba9f38e26f008e10a2cd493e477865cf72">FUSION_DEPENDENCE_ANALYSIS_ALL</a>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;};</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;FusionDependenceAnalysisChoice&gt;</a> <a class="code" href="LoopFuse_8cpp.html#a99bce8ce3073cdc43397fb851d80e81f">FusionDependenceAnalysis</a>(</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="stringliteral">&quot;loop-fusion-dependence-analysis&quot;</span>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Which dependence analysis should loop fusion use?&quot;</span>),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a8fa743aa76b6902028f8a643dfb87171">cl::values</a>(<a class="code" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50bae2968bc1b6d284f07e96fac3ce78bc54">FUSION_DEPENDENCE_ANALYSIS_SCEV</a>, <span class="stringliteral">&quot;scev&quot;</span>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                          <span class="stringliteral">&quot;Use the scalar evolution interface&quot;</span>),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;               <a class="code" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba88a2ef6139ee028e3fa8addb323b3917">FUSION_DEPENDENCE_ANALYSIS_DA</a>, <span class="stringliteral">&quot;da&quot;</span>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                          <span class="stringliteral">&quot;Use the dependence analysis interface&quot;</span>),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;               <a class="code" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba9f38e26f008e10a2cd493e477865cf72">FUSION_DEPENDENCE_ANALYSIS_ALL</a>, <span class="stringliteral">&quot;all&quot;</span>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                          <span class="stringliteral">&quot;Use all available analyses&quot;</span>)),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba9f38e26f008e10a2cd493e477865cf72">FUSION_DEPENDENCE_ANALYSIS_ALL</a>));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="LoopFuse_8cpp.html#a56c800ff50c72a9547dc77a1ef29a329">FusionPeelMaxCount</a>(</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="stringliteral">&quot;loop-fusion-peel-max-count&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Max number of iterations to be peeled from a loop, such that &quot;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;             <span class="stringliteral">&quot;fusion can take place&quot;</span>));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>(<span class="stringliteral">&quot;loop-fusion-verbose-debug&quot;</span>,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                           <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable verbose debugging for Loop Fusion&quot;</span>),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                           <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">namespace </span>{<span class="comment"></span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">/// This class is used to represent a candidate for loop fusion. When it is</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">/// constructed, it checks the conditions for loop fusion to ensure that it</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">/// represents a valid candidate. It caches several parts of a loop that are</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/// used throughout loop fusion (e.g., loop preheader, loop header, etc) instead</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">/// of continually querying the underlying Loop to retrieve these values. It is</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/// assumed these will not change throughout loop fusion.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/// The invalidate method should be used to indicate that the FusionCandidate is</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/// no longer a valid candidate for fusion. Similarly, the isValid() method can</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">/// be used to ensure that the FusionCandidate is still valid for fusion.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span><span class="keyword">struct </span>FusionCandidate {<span class="comment"></span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">  /// Cache of parts of the loop used throughout loop fusion. These should not</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">  /// need to change throughout the analysis and transformation.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">  /// These parts are cached to avoid repeatedly looking up in the Loop class.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">  /// Preheader of the loop this candidate represents</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Preheader;<span class="comment"></span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">  /// Header of the loop this candidate represents</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header;<span class="comment"></span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">  /// Blocks in the loop that exit the loop</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitingBlock;<span class="comment"></span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">  /// The successor block of this loop (where the exiting blocks go to)</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ExitBlock;<span class="comment"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">  /// Latch of the loop</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Latch;<span class="comment"></span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">  /// The loop that this fusion candidate represents</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L;<span class="comment"></span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">  /// Vector of instructions in this loop that read from memory</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 16&gt;</a> MemReads;<span class="comment"></span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">  /// Vector of instructions in this loop that write to memory</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 16&gt;</a> MemWrites;<span class="comment"></span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">  /// Are all of the members of this fusion candidate still valid</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> Valid;<span class="comment"></span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">  /// Guard branch of the loop, if it exists</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *GuardBranch;<span class="comment"></span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">  /// Peeling Paramaters of the Loop.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span>  <a class="code" href="structllvm_1_1TargetTransformInfo_1_1PeelingPreferences.html">TTI::PeelingPreferences</a> PP;<span class="comment"></span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">  /// Can you Peel this Loop?</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> AbleToPeel;<span class="comment"></span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">  /// Has this loop been Peeled</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> Peeled;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">  /// Dominator and PostDominator trees are needed for the</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">  /// FusionCandidateCompare function, required by FusionCandidateSet to</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">  /// determine where the FusionCandidate should be inserted into the set. These</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">  /// are used to establish ordering of the FusionCandidates based on dominance.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1PostDominatorTree.html">PostDominatorTree</a> *PDT;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  FusionCandidate(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT, <span class="keyword">const</span> <a class="code" href="classllvm_1_1PostDominatorTree.html">PostDominatorTree</a> *PDT,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE, <a class="code" href="structllvm_1_1TargetTransformInfo_1_1PeelingPreferences.html">TTI::PeelingPreferences</a> PP)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      : Preheader(L-&gt;getLoopPreheader()), Header(L-&gt;getHeader()),</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        ExitingBlock(L-&gt;getExitingBlock()), ExitBlock(L-&gt;getExitBlock()),</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        Latch(L-&gt;getLoopLatch()), L(L), Valid(<a class="code" href="BasicAliasAnalysis_8cpp.html#af6d5cafbdfc5313e65d990120021a3ec">true</a>),</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        GuardBranch(L-&gt;getLoopGuardBranch()), PP(PP), AbleToPeel(<a class="code" href="namespacellvm.html#a3aea1e78510aa7469457aade10808e51">canPeel</a>(L)),</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        Peeled(<a class="code" href="namespacefalse.html">false</a>), DT(DT), PDT(PDT), ORE(ORE) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// Walk over all blocks in the loop and check for conditions that may</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// prevent fusion. For each block, walk over all instructions and collect</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// the memory reads and writes If any instructions that prevent fusion are</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// found, invalidate this object and return.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>()) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;hasAddressTaken()) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        invalidate();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(AddressTakenBB);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayThrow()) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          invalidate();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(MayThrowException);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isVolatile()) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            invalidate();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(ContainsVolatileAccess);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="keywordflow">if</span> (LI-&gt;isVolatile()) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            invalidate();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(ContainsVolatileAccess);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayWriteToMemory())</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          MemWrites.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayReadFromMemory())</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          MemReads.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">  /// Check if all members of the class are valid.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="RustDemangle_8cpp.html#a103d8cfe62c1651cd70e181746f8a840">isValid</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span> Preheader &amp;&amp; Header &amp;&amp; ExitingBlock &amp;&amp; ExitBlock &amp;&amp; Latch &amp;&amp; L &amp;&amp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;           !L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a7cea07afaa9cb9cb11334832b90eaf0a">isInvalid</a>() &amp;&amp; Valid;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">  /// Verify that all members are in sync with the Loop object.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="PPCCTRLoopsVerify_8cpp.html#a593cc2f204f7b2edc16ee222c37c3196">verify</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="RustDemangle_8cpp.html#a103d8cfe62c1651cd70e181746f8a840">isValid</a>() &amp;&amp; <span class="stringliteral">&quot;Candidate is not valid!!&quot;</span>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a7cea07afaa9cb9cb11334832b90eaf0a">isInvalid</a>() &amp;&amp; <span class="stringliteral">&quot;Loop is invalid!&quot;</span>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Preheader == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>() &amp;&amp; <span class="stringliteral">&quot;Preheader is out of sync&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Header == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>() &amp;&amp; <span class="stringliteral">&quot;Header is out of sync&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ExitingBlock == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">getExitingBlock</a>() &amp;&amp;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;           <span class="stringliteral">&quot;Exiting Blocks is out of sync&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ExitBlock == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>() &amp;&amp; <span class="stringliteral">&quot;Exit block is out of sync&quot;</span>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Latch == L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>() &amp;&amp; <span class="stringliteral">&quot;Latch is out of sync&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /// Get the entry block for this fusion candidate.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">  /// If this fusion candidate represents a guarded loop, the entry block is the</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  /// loop guard block. If it represents an unguarded loop, the entry block is</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">  /// the preheader of the loop.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *getEntryBlock()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (GuardBranch)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">return</span> GuardBranch-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">return</span> Preheader;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">  /// After Peeling the loop is modified quite a bit, hence all of the Blocks</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">  /// need to be updated accordingly.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> updateAfterPeeling() {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    Preheader = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    Header = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    ExitingBlock = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">getExitingBlock</a>();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    ExitBlock = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    Latch = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="PPCCTRLoopsVerify_8cpp.html#a593cc2f204f7b2edc16ee222c37c3196">verify</a>();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  /// Given a guarded loop, get the successor of the guard that is not in the</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">  /// loop.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">  /// This method returns the successor of the loop guard that is not located</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  /// within the loop (i.e., the successor of the guard that is not the</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">  /// preheader).</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">  /// This method is only valid for guarded loops.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *getNonLoopBlock()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GuardBranch &amp;&amp; <span class="stringliteral">&quot;Only valid on guarded loops.&quot;</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GuardBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">isConditional</a>() &amp;&amp;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;           <span class="stringliteral">&quot;Expecting guard to be a conditional branch.&quot;</span>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (Peeled)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">return</span> GuardBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(1);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> (GuardBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0) == Preheader)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;               ? GuardBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(1)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;               : GuardBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a> <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tGuardBranch: &quot;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (GuardBranch)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *GuardBranch;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;nullptr&quot;</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;           &lt;&lt; (GuardBranch ? GuardBranch-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : <span class="stringliteral">&quot;nullptr&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\tPreheader: &quot;</span> &lt;&lt; (Preheader ? Preheader-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : <span class="stringliteral">&quot;nullptr&quot;</span>)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\tHeader: &quot;</span> &lt;&lt; (Header ? Header-&gt;getName() : <span class="stringliteral">&quot;nullptr&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\tExitingBB: &quot;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;           &lt;&lt; (ExitingBlock ? ExitingBlock-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : <span class="stringliteral">&quot;nullptr&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\tExitBB: &quot;</span> &lt;&lt; (ExitBlock ? ExitBlock-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : <span class="stringliteral">&quot;nullptr&quot;</span>)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\tLatch: &quot;</span> &lt;&lt; (Latch ? Latch-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : <span class="stringliteral">&quot;nullptr&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\tEntryBlock: &quot;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;           &lt;&lt; (getEntryBlock() ? getEntryBlock()-&gt;getName() : <span class="stringliteral">&quot;nullptr&quot;</span>)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">  /// Determine if a fusion candidate (representing a loop) is eligible for</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">  /// fusion. Note that this only checks whether a single loop can be fused - it</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">  /// does not check whether it is *legal* to fuse two loops together.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isEligibleForFusion(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> &amp;SE)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="RustDemangle_8cpp.html#a103d8cfe62c1651cd70e181746f8a840">isValid</a>()) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;FC has invalid CFG requirements!\n&quot;</span>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">if</span> (!Preheader)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        ++InvalidPreheader;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (!Header)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        ++InvalidHeader;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">if</span> (!ExitingBlock)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        ++InvalidExitingBlock;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">if</span> (!ExitBlock)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        ++InvalidExitBlock;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> (!Latch)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        ++InvalidLatch;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a7cea07afaa9cb9cb11334832b90eaf0a">isInvalid</a>())</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        ++InvalidLoop;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// Require ScalarEvolution to be able to determine a trip count.</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (!SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a91ac801aa45c78e0d0edbc36115ef054">hasLoopInvariantBackedgeTakenCount</a>(L)) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop &quot;</span> &lt;&lt; L-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>()</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; trip count not computable!\n&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(UnknownTripCount);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1Loop.html#ac233a2693163ed58305215ca2f6921e3">isLoopSimplifyForm</a>()) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop &quot;</span> &lt;&lt; L-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>()</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; is not in simplified form!\n&quot;</span>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(NotSimplifiedForm);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1Loop.html#a94bf09763773a48bc03a0461fb572a0c">isRotatedForm</a>()) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop &quot;</span> &lt;&lt; L-&gt;<a class="code" href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">getName</a>() &lt;&lt; <span class="stringliteral">&quot; is not rotated!\n&quot;</span>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(NotRotated);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// This is only used internally for now, to clear the MemWrites and MemReads</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// list and setting Valid to false. I can&#39;t envision other uses of this right</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// now, since once FusionCandidates are put into the FusionCandidateSet they</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// are immutable. Thus, any time we need to change/update a FusionCandidate,</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// we must create a new one and insert it into the FusionCandidateSet to</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">// ensure the FusionCandidateSet remains ordered correctly.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">void</span> invalidate() {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    MemWrites.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    MemReads.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    Valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a>(<a class="code" href="classllvm_1_1TrackingStatistic.html">llvm::Statistic</a> &amp;Stat)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">using namespace </span>ore;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L &amp;&amp; Preheader &amp;&amp; <span class="stringliteral">&quot;Fusion candidate not initialized properly!&quot;</span>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#if LLVM_ENABLE_STATS</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    ++Stat;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>(<a class="code" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a>(<a class="code" href="LoopFuse_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, Stat.getName(),</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                        L-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(), Preheader)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; Preheader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot;]: &quot;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Loop is not a candidate for fusion: &quot;</span> &lt;&lt; Stat.getDesc());</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;};</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keyword">struct </span>FusionCandidateCompare {<span class="comment"></span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">  /// Comparison functor to sort two Control Flow Equivalent fusion candidates</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">  /// into dominance order.</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">  /// If LHS dominates RHS and RHS post-dominates LHS, return true;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">  /// If RHS dominates LHS and LHS post-dominates RHS, return false;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">  /// If both LHS and RHS are not dominating each other then, non-strictly</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">  /// post dominate check will decide the order of candidates. If RHS</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">  /// non-strictly post dominates LHS then, return true. If LHS non-strictly</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">  /// post dominates RHS then, return false. If both are non-strictly post</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">  /// dominate each other then, level in the post dominator tree will decide</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  /// the order of candidates.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> FusionCandidate &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                  <span class="keyword">const</span> FusionCandidate &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT = &amp;(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.DT);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LHSEntryBlock = <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getEntryBlock();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *RHSEntryBlock = <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.getEntryBlock();</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// Do not save PDT to local variable as it is only used in asserts and thus</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// will trigger an unused variable warning if building without asserts.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PDT &amp;&amp; <span class="stringliteral">&quot;Expecting valid dominator tree&quot;</span>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// Do this compare first so if LHS == RHS, function returns false.</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(RHSEntryBlock, LHSEntryBlock)) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="comment">// RHS dominates LHS</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="comment">// Verify LHS post-dominates RHS</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PDT-&gt;dominates(LHSEntryBlock, RHSEntryBlock));</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(LHSEntryBlock, RHSEntryBlock)) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">// Verify RHS Postdominates LHS</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PDT-&gt;dominates(RHSEntryBlock, LHSEntryBlock));</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// If two FusionCandidates are in the same level of dominator tree,</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// they will not dominate each other, but may still be control flow</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// equivalent. To sort those FusionCandidates, nonStrictlyPostDominate()</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// function is needed.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">bool</span> WrongOrder =</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="namespacellvm.html#a90896a5c2c14e27297f4fdb0196e24b3">nonStrictlyPostDominate</a>(LHSEntryBlock, RHSEntryBlock, DT, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PDT);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">bool</span> RightOrder =</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="namespacellvm.html#a90896a5c2c14e27297f4fdb0196e24b3">nonStrictlyPostDominate</a>(RHSEntryBlock, LHSEntryBlock, DT, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PDT);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (WrongOrder &amp;&amp; RightOrder) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="comment">// If common predecessor of LHS and RHS post dominates both</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="comment">// FusionCandidates then, Order of FusionCandidate can be</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="comment">// identified by its level in post dominator tree.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="classllvm_1_1DomTreeNodeBase.html">DomTreeNode</a> *LNode = <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PDT-&gt;getNode(LHSEntryBlock);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="classllvm_1_1DomTreeNodeBase.html">DomTreeNode</a> *RNode = <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PDT-&gt;getNode(RHSEntryBlock);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">return</span> LNode-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#ab73bfd7dc4d5a446db965380e340810e">getLevel</a>() &gt; RNode-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#ab73bfd7dc4d5a446db965380e340810e">getLevel</a>();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WrongOrder)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RightOrder)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// If LHS does not non-strict Postdominate RHS and RHS does not non-strict</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// Postdominate LHS then, there is no dominance relationship between the</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// two FusionCandidates. Thus, they should not be in the same set together.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="stringliteral">&quot;No dominance relationship between these fusion candidates!&quot;</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;};</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keyword">using</span> LoopVector = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Loop *, 4&gt;</a>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">// Set of Control Flow Equivalent (CFE) Fusion Candidates, sorted in dominance</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">// order. Thus, if FC0 comes *before* FC1 in a FusionCandidateSet, then FC0</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">// dominates FC1 and FC1 post-dominates FC0.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">// std::set was chosen because we want a sorted data structure with stable</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">// iterators. A subsequent patch to loop fusion will enable fusing non-adjacent</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">// loops by moving intervening code around. When this intervening code contains</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">// loops, those loops will be moved also. The corresponding FusionCandidates</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">// will also need to be moved accordingly. As this is done, having stable</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">// iterators will simplify the logic. Similarly, having an efficient insert that</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">// keeps the FusionCandidateSet sorted will also simplify the implementation.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">using</span> FusionCandidateSet = std::set&lt;FusionCandidate, FusionCandidateCompare&gt;;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keyword">using</span> FusionCandidateCollection = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;FusionCandidateSet, 4&gt;</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a> &amp;<a class="code" href="namespacellvm.html#a5ee0a415cf089775fd277550b257f74e">operator&lt;&lt;</a>(<a class="code" href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                     <span class="keyword">const</span> FusionCandidate &amp;<a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a>) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a>.isValid())</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a>.Preheader-&gt;getName();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;&lt;Invalid&gt;&quot;</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a> &amp;<a class="code" href="namespacellvm.html#a5ee0a415cf089775fd277550b257f74e">operator&lt;&lt;</a>(<a class="code" href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                     <span class="keyword">const</span> FusionCandidateSet &amp;CandSet) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> FusionCandidate &amp;<a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a> : CandSet)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;printFusionCandidates(<span class="keyword">const</span> FusionCandidateCollection &amp;FusionCandidates) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion Candidates: \n&quot;</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;CandidateSet : FusionCandidates) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;*** Fusion Candidate Set ***\n&quot;</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; CandidateSet;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;****************************\n&quot;</span>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">/// Collect all loops in function at the same nest level, starting at the</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">/// outermost level.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">/// This data structure collects all loops at the same nest level for a</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">/// given function (specified by the LoopInfo object). It starts at the</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">/// outermost level.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span><span class="keyword">struct </span>LoopDepthTree {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keyword">using</span> LoopsOnLevelTy = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;LoopVector, 4&gt;</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keyword">using</span> iterator = LoopsOnLevelTy::iterator;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keyword">using</span> const_iterator = LoopsOnLevelTy::const_iterator;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  LoopDepthTree(<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI) : <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>(1) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> (!LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a83d8036930a033b196409ced5c9409e5">empty</a>())</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      LoopsOnLevel.emplace_back(LoopVector(LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#ad491e953f7f6ef6129f2dfcc51a4b3da">rbegin</a>(), LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a4b3bd736cc047e31bab2291e2b1d4767">rend</a>()));</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">  /// Test whether a given loop has been removed from the function, and thus is</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  /// no longer valid.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isRemovedLoop(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> RemovedLoops.count(L); }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">  /// Record that a given loop has been removed from the function and is no</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">  /// longer valid.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> removeLoop(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) { RemovedLoops.insert(L); }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">  /// Descend the tree to the next (inner) nesting level</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> descend() {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    LoopsOnLevelTy LoopsOnNextLevel;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> LoopVector &amp;LV : *<span class="keyword">this</span>)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : LV)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">if</span> (!isRemovedLoop(L) &amp;&amp; L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af2f81059dc7566164b018aac6555eb1a">begin</a>() != L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a98eb0888f30e7a27151a7b02fa053205">end</a>())</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          LoopsOnNextLevel.emplace_back(LoopVector(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af2f81059dc7566164b018aac6555eb1a">begin</a>(), L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a98eb0888f30e7a27151a7b02fa053205">end</a>()));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    LoopsOnLevel = LoopsOnNextLevel;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    RemovedLoops.clear();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>++;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordtype">bool</span> empty()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>() == 0; }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> LoopsOnLevel.size() - RemovedLoops.size(); }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordtype">unsigned</span> getDepth()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>; }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>() { <span class="keywordflow">return</span> LoopsOnLevel.<a class="code" href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a88c072843122519fd4f3547f2a0ab178">begin</a>(); }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>() { <span class="keywordflow">return</span> LoopsOnLevel.<a class="code" href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a8a503d1cbee10d1b8c8f5ac2a03b90df">end</a>(); }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> LoopsOnLevel.<a class="code" href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a88c072843122519fd4f3547f2a0ab178">begin</a>(); }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> LoopsOnLevel.<a class="code" href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a8a503d1cbee10d1b8c8f5ac2a03b90df">end</a>(); }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  /// Set of loops that have been removed from the function and are no longer</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">  /// valid.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const Loop *, 8&gt;</a> RemovedLoops;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">  /// Depth of the current level, starting at 1 (outermost loops).</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /// Vector of loops at the current depth level that have the same parent loop</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span>  LoopsOnLevelTy LoopsOnLevel;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;};</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> printLoopVector(<span class="keyword">const</span> LoopVector &amp;LV) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;****************************\n&quot;</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *L : LV)</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="namespacellvm.html#af74d55b9091c302365e3af53f446a2a2">printLoop</a>(*L, <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;****************************\n&quot;</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keyword">struct </span>LoopFuser {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">// Sets of control flow equivalent fusion candidates for a given nest level.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  FusionCandidateCollection FusionCandidates;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  LoopDepthTree LDT;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="classllvm_1_1DomTreeUpdater.html">DomTreeUpdater</a> DTU;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="classllvm_1_1DependenceInfo.html">DependenceInfo</a> &amp;DI;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> &amp;SE;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <a class="code" href="classllvm_1_1PostDominatorTree.html">PostDominatorTree</a> &amp;PDT;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;AC;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">TTI</a>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  LoopFuser(<a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> &amp;LI, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT, <a class="code" href="classllvm_1_1DependenceInfo.html">DependenceInfo</a> &amp;DI,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> &amp;SE, <a class="code" href="classllvm_1_1PostDominatorTree.html">PostDominatorTree</a> &amp;PDT,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> &amp;ORE, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;AC, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      : LDT(LI), DTU(DT, PDT, <a class="code" href="classllvm_1_1DomTreeUpdater.html">DomTreeUpdater</a>::UpdateStrategy::Lazy), LI(LI),</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        DT(DT), DI(DI), SE(SE), PDT(PDT), ORE(ORE), AC(AC), <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>(<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>) {}</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">  /// This is the main entry point for loop fusion. It will traverse the</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">  /// specified function and collect candidate loops to fuse, starting at the</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">  /// outermost nesting level and working inwards.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> fuseLoops(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a486674b70a58582bee32dbd7aa604967">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Performing Loop Fusion on function &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName()</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">while</span> (!LDT.empty()) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Got &quot;</span> &lt;&lt; LDT.size() &lt;&lt; <span class="stringliteral">&quot; loop sets for depth &quot;</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        &lt;&lt; LDT.getDepth() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> LoopVector &amp;LV : LDT) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LV.size() &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Empty loop set was build!&quot;</span>);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">// Skip singleton loop sets as they do not offer fusion opportunities on</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">// this level.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">if</span> (LV.size() == 1)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Visit loop set (#&quot;</span> &lt;&lt; LV.size() &lt;&lt; <span class="stringliteral">&quot;):\n&quot;</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            printLoopVector(LV);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          });</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        collectFusionCandidates(LV);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        Changed |= fuseCandidates();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="comment">// Finished analyzing candidates at this level.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="comment">// Descend to the next level and clear all of the candidates currently</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// collected. Note that it will not be possible to fuse any of the</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="comment">// existing candidates with new candidates because the new candidates will</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="comment">// be at a different nest level and thus not be control flow equivalent</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="comment">// with all of the candidates collected so far.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Descend one level!\n&quot;</span>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      LDT.descend();</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      FusionCandidates.clear();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">if</span> (Changed)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Function after Loop Fusion: \n&quot;</span>; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.dump(););</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a1f08f2925fec05b265e540d29066b9c8">verify</a>());</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PDT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a1f08f2925fec05b265e540d29066b9c8">verify</a>());</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a17a8f7aba5cca5c7f9faa779a3c4bc37">verify</a>(DT);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#aff82c03c1ce8b945170bcb1f0f624c17">verify</a>();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop Fusion complete\n&quot;</span>);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">  /// Determine if two fusion candidates are control flow equivalent.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">  /// Two fusion candidates are control flow equivalent if when one executes,</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">  /// the other is guaranteed to execute. This is determined using dominators</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">  /// and post-dominators: if A dominates B and B post-dominates A then A and B</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">  /// are control-flow equivalent.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a86a71a2b6a39dfb4ddb69ab4ed006eac">isControlFlowEquivalent</a>(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                               <span class="keyword">const</span> FusionCandidate &amp;FC1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0.Preheader &amp;&amp; FC1.Preheader &amp;&amp; <span class="stringliteral">&quot;Expecting valid preheaders&quot;</span>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="namespacellvm.html#a86a71a2b6a39dfb4ddb69ab4ed006eac">return ::isControlFlowEquivalent</a>(*FC0.getEntryBlock(), *FC1.getEntryBlock(),</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                     DT, PDT);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">  /// Iterate over all loops in the given loop set and identify the loops that</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">  /// are eligible for fusion. Place all eligible fusion candidates into Control</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">  /// Flow Equivalent sets, sorted by dominance.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> collectFusionCandidates(<span class="keyword">const</span> LoopVector &amp;LV) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : LV) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="structllvm_1_1TargetTransformInfo_1_1PeelingPreferences.html">TTI::PeelingPreferences</a> PP =</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          <a class="code" href="namespacellvm.html#a6e86d0ac2e968adc60290ca52da02e42">gatherPeelingPreferences</a>(L, SE, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>, std::nullopt, std::nullopt);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      FusionCandidate CurrCand(L, DT, &amp;PDT, ORE, PP);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">if</span> (!CurrCand.isEligibleForFusion(SE))</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="comment">// Go through each list in FusionCandidates and determine if L is control</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="comment">// flow equivalent with the first loop in that list. If it is, append LV.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="comment">// If not, go to the next list.</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="comment">// If no suitable list is found, start another list and add it to</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="comment">// FusionCandidates.</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordtype">bool</span> FoundSet = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;CurrCandSet : FusionCandidates) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a86a71a2b6a39dfb4ddb69ab4ed006eac">isControlFlowEquivalent</a>(*CurrCandSet.begin(), CurrCand)) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          CurrCandSet.insert(CurrCand);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          FoundSet = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding &quot;</span> &lt;&lt; CurrCand</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot; to existing candidate set\n&quot;</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">if</span> (!FoundSet) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="comment">// No set was found. Create a new set and add to FusionCandidates</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Adding &quot;</span> &lt;&lt; CurrCand &lt;&lt; <span class="stringliteral">&quot; to new set\n&quot;</span>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        FusionCandidateSet NewCandSet;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        NewCandSet.insert(CurrCand);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        FusionCandidates.push_back(NewCandSet);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      NumFusionCandidates++;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">  /// Determine if it is beneficial to fuse two loops.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">  /// For now, this method simply returns true because we want to fuse as much</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">  /// as possible (primarily to test the pass). This method will evolve, over</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">  /// time, to add heuristics for profitability of fusion.</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isBeneficialFusion(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                          <span class="keyword">const</span> FusionCandidate &amp;FC1) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">  /// Determine if two fusion candidates have the same trip count (i.e., they</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">  /// execute the same number of iterations).</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">  /// This function will return a pair of values. The first is a boolean,</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">  /// stating whether or not the two candidates are known at compile time to</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">  /// have the same TripCount. The second is the difference in the two</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">  /// TripCounts. This information can be used later to determine whether or not</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">  /// peeling can be performed on either one of the candidates.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment"></span>  std::pair&lt;bool, std::optional&lt;unsigned&gt;&gt;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  haveIdenticalTripCounts(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                          <span class="keyword">const</span> FusionCandidate &amp;FC1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *TripCount0 = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a22d9bcbd44563106d7217f3bd9a4039e">getBackedgeTakenCount</a>(FC0.L);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SCEVCouldNotCompute&gt;(TripCount0)) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      UncomputableTripCount++;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Trip count of first loop could not be computed!&quot;</span>);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">return</span> {<span class="keyword">false</span>, std::nullopt};</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *TripCount1 = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a22d9bcbd44563106d7217f3bd9a4039e">getBackedgeTakenCount</a>(FC1.L);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SCEVCouldNotCompute&gt;(TripCount1)) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      UncomputableTripCount++;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Trip count of second loop could not be computed!&quot;</span>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">return</span> {<span class="keyword">false</span>, std::nullopt};</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tTrip counts: &quot;</span> &lt;&lt; *TripCount0 &lt;&lt; <span class="stringliteral">&quot; &amp; &quot;</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                      &lt;&lt; *TripCount1 &lt;&lt; <span class="stringliteral">&quot; are &quot;</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                      &lt;&lt; (TripCount0 == TripCount1 ? <span class="stringliteral">&quot;identical&quot;</span> : <span class="stringliteral">&quot;different&quot;</span>)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">if</span> (TripCount0 == TripCount1)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">return</span> {<span class="keyword">true</span>, 0};</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;The loops do not have the same tripcount, &quot;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                         <span class="stringliteral">&quot;determining the difference between trip counts\n&quot;</span>);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// Currently only considering loops with a single exit point</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">// and a non-constant trip count.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> TC0 = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#abec0c616087c002528fcf80c6583eadd">getSmallConstantTripCount</a>(FC0.L);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> TC1 = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#abec0c616087c002528fcf80c6583eadd">getSmallConstantTripCount</a>(FC1.L);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// If any of the tripcounts are zero that means that loop(s) do not have</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// a single exit or a constant tripcount.</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">if</span> (TC0 == 0 || TC1 == 0) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop(s) do not have a single exit point or do not &quot;</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                           <span class="stringliteral">&quot;have a constant number of iterations. Peeling &quot;</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                           <span class="stringliteral">&quot;is not benefical\n&quot;</span>);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">return</span> {<span class="keyword">false</span>, std::nullopt};</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    std::optional&lt;unsigned&gt; Difference;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordtype">int</span> Diff = TC0 - TC1;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">if</span> (Diff &gt; 0)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      Difference = Diff;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Difference is less than 0. FC1 (second loop) has more &quot;</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <span class="stringliteral">&quot;iterations than the first one. Currently not supported\n&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Difference in loop trip count is: &quot;</span> &lt;&lt; Difference</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">return</span> {<span class="keyword">false</span>, Difference};</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordtype">void</span> peelFusionCandidate(FusionCandidate &amp;FC0, <span class="keyword">const</span> FusionCandidate &amp;FC1,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                           <span class="keywordtype">unsigned</span> PeelCount) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0.AbleToPeel &amp;&amp; <span class="stringliteral">&quot;Should be able to peel loop&quot;</span>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Attempting to peel first &quot;</span> &lt;&lt; PeelCount</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; iterations of the first loop. \n&quot;</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> VMap;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    FC0.Peeled = <a class="code" href="namespacellvm.html#afdb3eec2f46233c924c30c0838a3c8fe">peelLoop</a>(FC0.L, PeelCount, &amp;LI, &amp;SE, DT, &amp;AC, <span class="keyword">true</span>, VMap);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (FC0.Peeled) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Done Peeling\n&quot;</span>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keyword">auto</span> IdenticalTripCount = haveIdenticalTripCounts(FC0, FC1);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IdenticalTripCount.first &amp;&amp; *IdenticalTripCount.second == 0 &amp;&amp;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;             <span class="stringliteral">&quot;Loops should have identical trip counts after peeling&quot;</span>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      FC0.PP.PeelCount += PeelCount;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">// Peeling does not update the PDT</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      PDT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#aa0641ae965656ff9988d67a35140e4d9">recalculate</a>(*FC0.Preheader-&gt;getParent());</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      FC0.updateAfterPeeling();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="comment">// In this case the iterations of the loop are constant, so the first</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="comment">// loop will execute completely (will not jump from one of</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// the peeled blocks to the second loop). Here we are updating the</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="comment">// branch conditions of each of the peeled blocks, such that it will</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="comment">// branch to its successor which is not the preheader of the second loop</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="comment">// in the case of unguarded loops, or the succesors of the exit block of</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">// the first loop otherwise. Doing this update will ensure that the entry</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="comment">// block of the first loop dominates the entry block of the second loop.</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> =</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;          FC0.GuardBranch ? FC0.ExitBlock-&gt;getUniqueSuccessor() : FC1.Preheader;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DominatorTree::UpdateType, 8&gt;</a> TreeUpdates;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> WorkList;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)) {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;          <span class="keywordflow">if</span> (Pred != FC0.ExitBlock) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            WorkList.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(Pred-&gt;getTerminator());</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, Pred, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>));</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// Cannot modify the predecessors inside the above loop as it will cause</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="comment">// the iterators to be nullptrs, causing memory errors.</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CurrentBranch : WorkList) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ = CurrentBranch-&gt;getSuccessor(0);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          <span class="keywordflow">if</span> (Succ == <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            Succ = CurrentBranch-&gt;getSuccessor(1);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          <a class="code" href="namespacellvm.html#a016a85f7487f995fe80141e102a7a5ae">ReplaceInstWithInst</a>(CurrentBranch, <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(Succ));</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#aae522cd1928cfac6850b50c7a3e22185">applyUpdates</a>(TreeUpdates);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#a0b21e3233f5a0309838edeae7358ffd7">flush</a>();</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Sucessfully peeled &quot;</span> &lt;&lt; FC0.PP.PeelCount</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; iterations from the first loop.\n&quot;</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    <span class="stringliteral">&quot;Both Loops have the same number of iterations now.\n&quot;</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">  /// Walk each set of control flow equivalent fusion candidates and attempt to</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">  /// fuse them. This does a single linear traversal of all candidates in the</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">  /// set. The conditions for legal fusion are checked at this point. If a pair</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">  /// of fusion candidates passes all legality checks, they are fused together</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">  /// and a new fusion candidate is created and added to the FusionCandidateSet.</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">  /// The original fusion candidates are then removed, as they are no longer</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">  /// valid.</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> fuseCandidates() {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordtype">bool</span> Fused = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(printFusionCandidates(FusionCandidates));</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;CandidateSet : FusionCandidates) {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">if</span> (CandidateSet.size() &lt; 2)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Attempting fusion on Candidate Set:\n&quot;</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        &lt;&lt; CandidateSet &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> FC0 = CandidateSet.begin(); FC0 != CandidateSet.end(); ++FC0) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!LDT.isRemovedLoop(FC0-&gt;L) &amp;&amp;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;               <span class="stringliteral">&quot;Should not have removed loops in CandidateSet!&quot;</span>);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keyword">auto</span> FC1 = FC0;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">for</span> (++FC1; FC1 != CandidateSet.end(); ++FC1) {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!LDT.isRemovedLoop(FC1-&gt;L) &amp;&amp;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                 <span class="stringliteral">&quot;Should not have removed loops in CandidateSet!&quot;</span>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Attempting to fuse candidate \n&quot;</span>; FC0-&gt;dump();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                     <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; with\n&quot;</span>; FC1-&gt;dump(); <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          FC0-&gt;verify();</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;          FC1-&gt;verify();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          <span class="comment">// Check if the candidates have identical tripcounts (first value of</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <span class="comment">// pair), and if not check the difference in the tripcounts between</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="comment">// the loops (second value of pair). The difference is not equal to</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;          <span class="comment">// std::nullopt iff the loops iterate a constant number of times, and</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          <span class="comment">// have a single exit.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;          std::pair&lt;bool, std::optional&lt;unsigned&gt;&gt; IdenticalTripCountRes =</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;              haveIdenticalTripCounts(*FC0, *FC1);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          <span class="keywordtype">bool</span> SameTripCount = IdenticalTripCountRes.first;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          std::optional&lt;unsigned&gt; TCDifference = IdenticalTripCountRes.second;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          <span class="comment">// Here we are checking that FC0 (the first loop) can be peeled, and</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;          <span class="comment">// both loops have different tripcounts.</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          <span class="keywordflow">if</span> (FC0-&gt;AbleToPeel &amp;&amp; !SameTripCount &amp;&amp; TCDifference) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="keywordflow">if</span> (*TCDifference &gt; <a class="code" href="LoopFuse_8cpp.html#a56c800ff50c72a9547dc77a1ef29a329">FusionPeelMaxCount</a>) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;              <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;Difference in loop trip counts: &quot;</span> &lt;&lt; *TCDifference</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot; is greater than maximum peel count specificed: &quot;</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                         &lt;&lt; <a class="code" href="LoopFuse_8cpp.html#a56c800ff50c72a9547dc77a1ef29a329">FusionPeelMaxCount</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;              <span class="comment">// Dependent on peeling being performed on the first loop, and</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;              <span class="comment">// assuming all other conditions for fusion return true.</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;              SameTripCount = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          <span class="keywordflow">if</span> (!SameTripCount) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion candidates do not have identical trip &quot;</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                 <span class="stringliteral">&quot;counts. Not fusing.\n&quot;</span>);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                                       NonEqualTripCount);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          <span class="keywordflow">if</span> (!isAdjacent(*FC0, *FC1)) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;Fusion candidates are not adjacent. Not fusing.\n&quot;</span>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1, NonAdjacent);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          <span class="keywordflow">if</span> ((!FC0-&gt;GuardBranch &amp;&amp; FC1-&gt;GuardBranch) ||</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;              (FC0-&gt;GuardBranch &amp;&amp; !FC1-&gt;GuardBranch)) {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;The one of candidate is guarded while the &quot;</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                 <span class="stringliteral">&quot;another one is not. Not fusing.\n&quot;</span>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            reportLoopFusion&lt;OptimizationRemarkMissed&gt;(</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                *FC0, *FC1, OnlySecondCandidateIsGuarded);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          <span class="comment">// Ensure that FC0 and FC1 have identical guards.</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          <span class="comment">// If one (or both) are not guarded, this check is not necessary.</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          <span class="keywordflow">if</span> (FC0-&gt;GuardBranch &amp;&amp; FC1-&gt;GuardBranch &amp;&amp;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;              !haveIdenticalGuards(*FC0, *FC1) &amp;&amp; !TCDifference) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion candidates do not have identical &quot;</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                 <span class="stringliteral">&quot;guards. Not Fusing.\n&quot;</span>);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1,</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                                       NonIdenticalGuards);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;          <span class="keywordflow">if</span> (FC0-&gt;GuardBranch) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC1-&gt;GuardBranch &amp;&amp; <span class="stringliteral">&quot;Expecting valid FC1 guard branch&quot;</span>);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#adffe8dd96d1c957f04909ca9c2cd79ba">isSafeToMoveBefore</a>(*FC0-&gt;ExitBlock,</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                    *FC1-&gt;ExitBlock-&gt;getFirstNonPHIOrDbg(), DT,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                    &amp;PDT, &amp;DI)) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;              <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion candidate contains unsafe &quot;</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                   <span class="stringliteral">&quot;instructions in exit block. Not fusing.\n&quot;</span>);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;              reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1,</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                                         NonEmptyExitBlock);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#adffe8dd96d1c957f04909ca9c2cd79ba">isSafeToMoveBefore</a>(</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    *FC1-&gt;GuardBranch-&gt;getParent(),</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    *FC0-&gt;GuardBranch-&gt;getParent()-&gt;getTerminator(), DT, &amp;PDT,</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    &amp;DI)) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;              <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;Fusion candidate contains unsafe &quot;</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                            <span class="stringliteral">&quot;instructions in guard block. Not fusing.\n&quot;</span>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;              reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1,</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                                         NonEmptyGuardBlock);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;          }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          <span class="comment">// Check the dependencies across the loops and do not fuse if it would</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;          <span class="comment">// violate them.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          <span class="keywordflow">if</span> (!dependencesAllowFusion(*FC0, *FC1)) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Memory dependencies do not allow fusion!\n&quot;</span>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1,</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                                       InvalidDependencies);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          <span class="comment">// If the second loop has instructions in the pre-header, attempt to</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          <span class="comment">// hoist them up to the first loop&#39;s pre-header or sink them into the</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;          <span class="comment">// body of the second loop.</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;          <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> SafeToHoist;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;          <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> SafeToSink;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;          <span class="comment">// At this point, this is the last remaining legality check.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="comment">// Which means if we can make this pre-header empty, we can fuse</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;          <span class="comment">// these loops</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;          <span class="keywordflow">if</span> (!isEmptyPreheader(*FC1)) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion candidate does not have empty &quot;</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                 <span class="stringliteral">&quot;preheader.\n&quot;</span>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="comment">// If it is not safe to hoist/sink all instructions in the</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="comment">// pre-header, we cannot fuse these loops.</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">if</span> (!collectMovablePreheaderInsts(*FC0, *FC1, SafeToHoist,</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                              SafeToSink)) {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;              <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not hoist/sink all instructions in &quot;</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                   <span class="stringliteral">&quot;Fusion Candidate Pre-header.\n&quot;</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                &lt;&lt; <span class="stringliteral">&quot;Not Fusing.\n&quot;</span>);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;              reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                                         NonEmptyPreheader);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;          }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;          <span class="keywordtype">bool</span> BeneficialToFuse = isBeneficialFusion(*FC0, *FC1);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\tFusion appears to be &quot;</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                     &lt;&lt; (BeneficialToFuse ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;un&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;profitable!\n&quot;</span>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          <span class="keywordflow">if</span> (!BeneficialToFuse) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            reportLoopFusion&lt;OptimizationRemarkMissed&gt;(*FC0, *FC1,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                                       FusionNotBeneficial);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <span class="comment">// All analysis has completed and has determined that fusion is legal</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          <span class="comment">// and profitable. At this point, start transforming the code and</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <span class="comment">// perform fusion.</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          <span class="comment">// Execute the hoist/sink operations on preheader instructions</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          movePreheaderInsts(*FC0, *FC1, SafeToHoist, SafeToSink);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tFusion is performed: &quot;</span> &lt;&lt; *FC0 &lt;&lt; <span class="stringliteral">&quot; and &quot;</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                            &lt;&lt; *FC1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          FusionCandidate FC0Copy = *FC0;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          <span class="comment">// Peel the loop after determining that fusion is legal. The Loops</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;          <span class="comment">// will still be safe to fuse after the peeling is performed.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;          <span class="keywordtype">bool</span> Peel = TCDifference &amp;&amp; *TCDifference &gt; 0;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          <span class="keywordflow">if</span> (Peel)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            peelFusionCandidate(FC0Copy, *FC1, *TCDifference);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;          <span class="comment">// Report fusion to the Optimization Remarks.</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;          <span class="comment">// Note this needs to be done *before* performFusion because</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          <span class="comment">// performFusion will change the original loops, making it not</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;          <span class="comment">// possible to identify them after fusion is complete.</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;          reportLoopFusion&lt;OptimizationRemark&gt;((Peel ? FC0Copy : *FC0), *FC1,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                               FuseCounter);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;          FusionCandidate FusedCand(</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;              performFusion((Peel ? FC0Copy : *FC0), *FC1), DT, &amp;PDT, ORE,</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;              FC0Copy.PP);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;          FusedCand.verify();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FusedCand.isEligibleForFusion(SE) &amp;&amp;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                 <span class="stringliteral">&quot;Fused candidate should be eligible for fusion!&quot;</span>);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;          <span class="comment">// Notify the loop-depth-tree that these loops are not valid objects</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;          LDT.removeLoop(FC1-&gt;L);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          CandidateSet.erase(FC0);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          CandidateSet.erase(FC1);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          <span class="keyword">auto</span> InsertPos = CandidateSet.insert(FusedCand);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InsertPos.second &amp;&amp;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                 <span class="stringliteral">&quot;Unable to insert TargetCandidate in CandidateSet!&quot;</span>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          <span class="comment">// Reset FC0 and FC1 the new (fused) candidate. Subsequent iterations</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;          <span class="comment">// of the FC1 loop will attempt to fuse the new (fused) loop with the</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;          <span class="comment">// remaining candidates in the current candidate set.</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          FC0 = FC1 = InsertPos.first;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Candidate Set (after fusion): &quot;</span> &lt;&lt; CandidateSet</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;          Fused = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">return</span> Fused;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="comment">// Returns true if the instruction \p I can be hoisted to the end of the</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="comment">// preheader of \p FC0. \p SafeToHoist contains the instructions that are</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="comment">// known to be safe to hoist. The instructions encountered that cannot be</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="comment">// hoisted are in \p NotHoisting.</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="comment">// TODO: Move functionality into CodeMoverUtils</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordtype">bool</span> canHoistInst(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> &amp;SafeToHoist,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> &amp;NotHoisting,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    <span class="keyword">const</span> FusionCandidate &amp;FC0)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FC0PreheaderTarget = FC0.Preheader-&gt;getSingleSuccessor();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0PreheaderTarget &amp;&amp;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;           <span class="stringliteral">&quot;Expected single successor for loop preheader.&quot;</span>);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands()) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *OpInst = dyn_cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordtype">bool</span> OpHoisted = <a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">is_contained</a>(SafeToHoist, OpInst);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="comment">// Check if we have already decided to hoist this operand. In this</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="comment">// case, it does not dominate FC0 *yet*, but will after we hoist it.</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">if</span> (!(OpHoisted || DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(OpInst, FC0PreheaderTarget))) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">// PHIs in FC1&#39;s header only have FC0 blocks as predecessors. PHIs</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="comment">// cannot be hoisted and should be sunk to the exit of the fused loop.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">// If this isn&#39;t a memory inst, hoisting is safe</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayReadOrWriteMemory())</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Checking if this mem inst can be hoisted.\n&quot;</span>);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NotHoistedInst : NotHoisting) {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = DI.<a class="code" href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">depends</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, NotHoistedInst, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="comment">// Dependency is not read-before-write, write-before-read or</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="comment">// write-before-write</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isFlow() || <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isAnti() || <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isOutput()) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inst depends on an instruction in FC1&#39;s &quot;</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                               <span class="stringliteral">&quot;preheader that is not being hoisted.\n&quot;</span>);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ReadInst : FC0.MemReads) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = DI.<a class="code" href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">depends</a>(ReadInst, &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="comment">// Dependency is not read-before-write</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isAnti()) {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inst depends on a read instruction in FC0.\n&quot;</span>);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WriteInst : FC0.MemWrites) {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = DI.<a class="code" href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">depends</a>(WriteInst, &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">// Dependency is not write-before-read or write-before-write</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isFlow() || <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isOutput()) {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inst depends on a write instruction in FC0.\n&quot;</span>);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="comment">// Returns true if the instruction \p I can be sunk to the top of the exit</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="comment">// block of \p FC1.</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="comment">// TODO: Move functionality into CodeMoverUtils</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordtype">bool</span> canSinkInst(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> FusionCandidate &amp;FC1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.users()) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *UI{dyn_cast&lt;Instruction&gt;(U)}) {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="comment">// Cannot sink if user in loop</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">// If FC1 has phi users of this value, we cannot sink it into FC1.</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="keywordflow">if</span> (FC1.L-&gt;contains(UI)) {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          <span class="comment">// Cannot hoist or sink this instruction. No hoisting/sinking</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <span class="comment">// should take place, loops should not fuse</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// If this isn&#39;t a memory inst, sinking is safe</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayReadOrWriteMemory())</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ReadInst : FC1.MemReads) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = DI.<a class="code" href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">depends</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ReadInst, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="comment">// Dependency is not write-before-read</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isFlow()) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inst depends on a read instruction in FC1.\n&quot;</span>);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WriteInst : FC1.MemWrites) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = DI.<a class="code" href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">depends</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, WriteInst, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="comment">// Dependency is not write-before-write or read-before-write</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isOutput() || <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isAnti()) {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inst depends on a write instruction in FC1.\n&quot;</span>);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">  /// Collect instructions in the \p FC1 Preheader that can be hoisted</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">  /// to the \p FC0 Preheader or sunk into the \p FC1 Body</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> collectMovablePreheaderInsts(</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keyword">const</span> FusionCandidate &amp;FC0, <span class="keyword">const</span> FusionCandidate &amp;FC1,</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> &amp;SafeToHoist,</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> &amp;SafeToSink)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FC1Preheader = FC1.Preheader;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="comment">// Save the instructions that are not being hoisted, so we know not to hoist</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// mem insts that they dominate.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> NotHoisting;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *FC1Preheader) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="comment">// Can&#39;t move a branch</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="keywordflow">if</span> (&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == FC1Preheader-&gt;getTerminator())</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="comment">// If the instruction has side-effects, give up.</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <span class="comment">// TODO: The case of mayReadFromMemory we can handle but requires</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="comment">// additional work with a dependence analysis so for now we give</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="comment">// up on memory reads.</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayThrow() || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.willReturn()) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inst: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot; may throw or won&#39;t return.\n&quot;</span>);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Checking Inst: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isAtomic() || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isVolatile()) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tInstruction is volatile or atomic. Cannot move it.\n&quot;</span>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordflow">if</span> (canHoistInst(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, SafeToHoist, NotHoisting, FC0)) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        SafeToHoist.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tSafe to hoist.\n&quot;</span>);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tCould not hoist. Trying to sink...\n&quot;</span>);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        NotHoisting.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keywordflow">if</span> (canSinkInst(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, FC1)) {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;          SafeToSink.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tSafe to sink.\n&quot;</span>);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\tCould not sink.\n&quot;</span>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;All preheader instructions could be sunk or hoisted!\n&quot;</span>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">  /// Rewrite all additive recurrences in a SCEV to use a new loop.</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment"></span>  <span class="keyword">class </span>AddRecLoopReplacer : <span class="keyword">public</span> <a class="code" href="classllvm_1_1SCEVRewriteVisitor.html">SCEVRewriteVisitor</a>&lt;AddRecLoopReplacer&gt; {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    AddRecLoopReplacer(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> &amp;SE, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;OldL, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;NewL,</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                       <span class="keywordtype">bool</span> UseMax = <span class="keyword">true</span>)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        : <a class="code" href="classllvm_1_1SCEVRewriteVisitor.html">SCEVRewriteVisitor</a>(SE), Valid(<a class="code" href="BasicAliasAnalysis_8cpp.html#af6d5cafbdfc5313e65d990120021a3ec">true</a>), UseMax(UseMax), OldL(OldL),</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          NewL(NewL) {}</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *visitAddRecExpr(<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *Expr) {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *ExprL = Expr-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>();</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const SCEV *, 2&gt;</a> <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keywordflow">if</span> (ExprL == &amp;OldL) {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <a class="code" href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">append_range</a>(<a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>, Expr-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a980d0688dfa2b96b0043950aa1aa88b3">operands</a>());</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">return</span> SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(<a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>, &amp;NewL, Expr-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a7275347a4dce174f4fecd548fd3255dc">getNoWrapFlags</a>());</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <span class="keywordflow">if</span> (OldL.contains(ExprL)) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keywordtype">bool</span> Pos = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a672708a81ae8da8fb56e32638ca9b3">isKnownPositive</a>(Expr-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">getStepRecurrence</a>(SE));</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keywordflow">if</span> (!UseMax || !Pos || !Expr-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>()) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          Valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          <span class="keywordflow">return</span> Expr;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">return</span> visit(Expr-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">getStart</a>());</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : Expr-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a980d0688dfa2b96b0043950aa1aa88b3">operands</a>())</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>.push_back(visit(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>));</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordflow">return</span> SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(<a class="code" href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a>, ExprL, Expr-&gt;<a class="code" href="classllvm_1_1SCEVNAryExpr.html#a7275347a4dce174f4fecd548fd3255dc">getNoWrapFlags</a>());</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordtype">bool</span> wasValidSCEV()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Valid; }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordtype">bool</span> Valid, UseMax;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;OldL, &amp;NewL;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  };</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">  /// Return false if the access functions of \p I0 and \p I1 could cause</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">  /// a negative dependence.</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> accessDiffIsPositive(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;L0, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;L1, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;I0,</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                            <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;I1, <span class="keywordtype">bool</span> EqualIsInvalid) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr0 = <a class="code" href="namespacellvm.html#aee44336886a06f3c1b8c35c701ba8316">getLoadStorePointerOperand</a>(&amp;I0);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr1 = <a class="code" href="namespacellvm.html#aee44336886a06f3c1b8c35c701ba8316">getLoadStorePointerOperand</a>(&amp;I1);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordflow">if</span> (!Ptr0 || !Ptr1)</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *SCEVPtr0 = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(Ptr0, &amp;L0);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *SCEVPtr1 = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">getSCEVAtScope</a>(Ptr1, &amp;L1);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>)</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Access function check: &quot;</span> &lt;&lt; *SCEVPtr0 &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                        &lt;&lt; *SCEVPtr1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    AddRecLoopReplacer <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(SE, L0, L1);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    SCEVPtr0 = <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.visit(SCEVPtr0);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Access function after rewrite: &quot;</span> &lt;&lt; *SCEVPtr0</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; [Valid: &quot;</span> &lt;&lt; <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.wasValidSCEV() &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.wasValidSCEV())</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">// TODO: isKnownPredicate doesnt work well when one SCEV is loop carried (by</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">//       L0) and the other is not. We could check if it is monotone and test</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">//       the beginning and end value instead.</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *L0Header = L0.<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keyword">auto</span> HasNonLinearDominanceRelation = [&amp;](<span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AddRec = dyn_cast&lt;SCEVAddRecExpr&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="keywordflow">if</span> (!AddRec)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keywordflow">return</span> !DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(L0Header, AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>()-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()) &amp;&amp;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;             !DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(AddRec-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>()-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>(), L0Header);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    };</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#affb88623037a9864e030154052747ba1">SCEVExprContains</a>(SCEVPtr1, HasNonLinearDominanceRelation))</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">ICmpInst::Predicate</a> Pred =</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        EqualIsInvalid ? <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba720a42e85f7e981afd61e28473b0000a">ICmpInst::ICMP_SGT</a> : <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac1aa7b798ba11d2e497d5cce6ce6d3dc">ICmpInst::ICMP_SGE</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordtype">bool</span> IsAlwaysGE = SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a60a56343d06195ae01b61d087e672afd">isKnownPredicate</a>(Pred, SCEVPtr0, SCEVPtr1);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Relation: &quot;</span> &lt;&lt; *SCEVPtr0</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                        &lt;&lt; (IsAlwaysGE ? <span class="stringliteral">&quot;  &gt;=  &quot;</span> : <span class="stringliteral">&quot;  may &lt;  &quot;</span>) &lt;&lt; *SCEVPtr1</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">return</span> IsAlwaysGE;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  }</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">  /// Return true if the dependences between @p I0 (in @p L0) and @p I1 (in</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">  /// @p L1) allow loop fusion of @p L0 and @p L1. The dependence analyses</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">  /// specified by @p DepChoice are used to determine this.</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> dependencesAllowFusion(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                              <span class="keyword">const</span> FusionCandidate &amp;FC1, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;I0,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                              <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;I1, <span class="keywordtype">bool</span> AnyDep,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                              <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50b">FusionDependenceAnalysisChoice</a> DepChoice) {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>) {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Check dep: &quot;</span> &lt;&lt; I0 &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; I1 &lt;&lt; <span class="stringliteral">&quot; : &quot;</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                        &lt;&lt; DepChoice &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">switch</span> (DepChoice) {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50bae2968bc1b6d284f07e96fac3ce78bc54">FUSION_DEPENDENCE_ANALYSIS_SCEV</a>:</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">return</span> accessDiffIsPositive(*FC0.L, *FC1.L, I0, I1, AnyDep);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba88a2ef6139ee028e3fa8addb323b3917">FUSION_DEPENDENCE_ANALYSIS_DA</a>: {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keyword">auto</span> DepResult = DI.<a class="code" href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">depends</a>(&amp;I0, &amp;I1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="keywordflow">if</span> (!DepResult)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>) {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;DA res: &quot;</span>; DepResult-&gt;dump(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                   <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; [#l: &quot;</span> &lt;&lt; DepResult-&gt;getLevels() &lt;&lt; <span class="stringliteral">&quot;][Ordered: &quot;</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                          &lt;&lt; (DepResult-&gt;isOrdered() ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>)</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;DepResult Levels: &quot;</span> &lt;&lt; DepResult-&gt;getLevels()</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordflow">if</span> (DepResult-&gt;getNextPredecessor() || DepResult-&gt;getNextSuccessor())</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;TODO: Implement pred/succ dependence handling!\n&quot;</span>);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="comment">// TODO: Can we actually use the dependence info analysis here?</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba9f38e26f008e10a2cd493e477865cf72">FUSION_DEPENDENCE_ANALYSIS_ALL</a>:</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keywordflow">return</span> dependencesAllowFusion(FC0, FC1, I0, I1, AnyDep,</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                    <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50bae2968bc1b6d284f07e96fac3ce78bc54">FUSION_DEPENDENCE_ANALYSIS_SCEV</a>) ||</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;             dependencesAllowFusion(FC0, FC1, I0, I1, AnyDep,</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                    <a class="code" href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba88a2ef6139ee028e3fa8addb323b3917">FUSION_DEPENDENCE_ANALYSIS_DA</a>);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown fusion dependence analysis choice!&quot;</span>);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">  /// Perform a dependence check and return if @p FC0 and @p FC1 can be fused.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> dependencesAllowFusion(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                              <span class="keyword">const</span> FusionCandidate &amp;FC1) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Check if &quot;</span> &lt;&lt; FC0 &lt;&lt; <span class="stringliteral">&quot; can be fused with &quot;</span> &lt;&lt; FC1</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0.L-&gt;getLoopDepth() == FC1.L-&gt;getLoopDepth());</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(FC0.getEntryBlock(), FC1.getEntryBlock()));</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WriteL0 : FC0.MemWrites) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WriteL1 : FC1.MemWrites)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <span class="keywordflow">if</span> (!dependencesAllowFusion(FC0, FC1, *WriteL0, *WriteL1,</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                    <span class="comment">/* AnyDep */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                    <a class="code" href="LoopFuse_8cpp.html#a99bce8ce3073cdc43397fb851d80e81f">FusionDependenceAnalysis</a>)) {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          InvalidDependencies++;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ReadL1 : FC1.MemReads)</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="keywordflow">if</span> (!dependencesAllowFusion(FC0, FC1, *WriteL0, *ReadL1,</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                    <span class="comment">/* AnyDep */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                    <a class="code" href="LoopFuse_8cpp.html#a99bce8ce3073cdc43397fb851d80e81f">FusionDependenceAnalysis</a>)) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          InvalidDependencies++;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WriteL1 : FC1.MemWrites) {</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *WriteL0 : FC0.MemWrites)</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="keywordflow">if</span> (!dependencesAllowFusion(FC0, FC1, *WriteL0, *WriteL1,</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                    <span class="comment">/* AnyDep */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                    <a class="code" href="LoopFuse_8cpp.html#a99bce8ce3073cdc43397fb851d80e81f">FusionDependenceAnalysis</a>)) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;          InvalidDependencies++;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ReadL0 : FC0.MemReads)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">if</span> (!dependencesAllowFusion(FC0, FC1, *ReadL0, *WriteL1,</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                    <span class="comment">/* AnyDep */</span> <span class="keyword">false</span>,</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                    <a class="code" href="LoopFuse_8cpp.html#a99bce8ce3073cdc43397fb851d80e81f">FusionDependenceAnalysis</a>)) {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;          InvalidDependencies++;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    }</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160; </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// Walk through all uses in FC1. For each use, find the reaching def. If the</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="comment">// def is located in FC0 then it is is not safe to fuse.</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : FC1.L-&gt;blocks())</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands())</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a> = dyn_cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            <span class="keywordflow">if</span> (FC0.L-&gt;contains(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>-&gt;getParent())) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;              InvalidDependencies++;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">  /// Determine if two fusion candidates are adjacent in the CFG.</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">  /// This method will determine if there are additional basic blocks in the CFG</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">  /// between the exit of \p FC0 and the entry of \p FC1.</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">  /// If the two candidates are guarded loops, then it checks whether the</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">  /// non-loop successor of the \p FC0 guard branch is the entry block of \p</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">  /// FC1. If not, then the loops are not adjacent. If the two candidates are</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">  /// not guarded loops, then it checks whether the exit block of \p FC0 is the</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">  /// preheader of \p FC1.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isAdjacent(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                  <span class="keyword">const</span> FusionCandidate &amp;FC1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// If the successor of the guard branch is FC1, then the loops are adjacent</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (FC0.GuardBranch)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">return</span> FC0.getNonLoopBlock() == FC1.getEntryBlock();</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keywordflow">return</span> FC0.ExitBlock == FC1.getEntryBlock();</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keywordtype">bool</span> isEmptyPreheader(<span class="keyword">const</span> FusionCandidate &amp;<a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a>.Preheader-&gt;size() == 1;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">  /// Hoist \p FC1 Preheader instructions to \p FC0 Preheader</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">  /// and sink others into the body of \p FC1.</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> movePreheaderInsts(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                          <span class="keyword">const</span> FusionCandidate &amp;FC1,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                          <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> &amp;HoistInsts,</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                          <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> &amp;SinkInsts)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">// All preheader instructions except the branch must be hoisted or sunk</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(HoistInsts.size() + SinkInsts.size() == FC1.Preheader-&gt;size() - 1 &amp;&amp;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;           <span class="stringliteral">&quot;Attempting to sink and hoist preheader instructions, but not all &quot;</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;           <span class="stringliteral">&quot;the preheader instructions are accounted for.&quot;</span>);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    NumHoistedInsts += HoistInsts.size();</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    NumSunkInsts += SinkInsts.size();</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<span class="keywordflow">if</span> (<a class="code" href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a>) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="keywordflow">if</span> (!HoistInsts.empty())</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Hoisting: \n&quot;</span>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : HoistInsts)</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="keywordflow">if</span> (!SinkInsts.empty())</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Sinking: \n&quot;</span>;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : SinkInsts)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    });</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : HoistInsts) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent() == FC1.Preheader);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;moveBefore(FC0.Preheader-&gt;getTerminator());</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// insert instructions in reverse order to maintain dominance relationship</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(SinkInsts)) {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent() == FC1.Preheader);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;moveBefore(&amp;*FC1.ExitBlock-&gt;getFirstInsertionPt());</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">  /// Determine if two fusion candidates have identical guards</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">  /// This method will determine if two fusion candidates have the same guards.</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">  /// The guards are considered the same if:</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">  ///   1. The instructions to compute the condition used in the compare are</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">  ///      identical.</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">  ///   2. The successors of the guard have the same flow into/around the loop.</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">  /// If the compare instructions are identical, then the first successor of the</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">  /// guard must go to the same place (either the preheader of the loop or the</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">  /// NonLoopBlock). In other words, the the first successor of both loops must</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">  /// both go into the loop (i.e., the preheader) or go around the loop (i.e.,</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">  /// the NonLoopBlock). The same must be true for the second successor.</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> haveIdenticalGuards(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                           <span class="keyword">const</span> FusionCandidate &amp;FC1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0.GuardBranch &amp;&amp; FC1.GuardBranch &amp;&amp;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;           <span class="stringliteral">&quot;Expecting FC0 and FC1 to be guarded loops.&quot;</span>);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> FC0CmpInst =</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            dyn_cast&lt;Instruction&gt;(FC0.GuardBranch-&gt;getCondition()))</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> FC1CmpInst =</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;              dyn_cast&lt;Instruction&gt;(FC1.GuardBranch-&gt;getCondition()))</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="keywordflow">if</span> (!FC0CmpInst-&gt;isIdenticalTo(FC1CmpInst))</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// The compare instructions are identical.</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">// Now make sure the successor of the guards have the same flow into/around</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">// the loop</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">if</span> (FC0.GuardBranch-&gt;getSuccessor(0) == FC0.Preheader)</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">return</span> (FC1.GuardBranch-&gt;getSuccessor(0) == FC1.Preheader);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="keywordflow">return</span> (FC1.GuardBranch-&gt;getSuccessor(1) == FC1.Preheader);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">  /// Modify the latch branch of FC to be unconditional since successors of the</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">  /// branch are the same.</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> simplifyLatchBranch(<span class="keyword">const</span> FusionCandidate &amp;<a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *FCLatchBranch = dyn_cast&lt;BranchInst&gt;(<a class="code" href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">FC</a>.Latch-&gt;getTerminator());</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">if</span> (FCLatchBranch) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FCLatchBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">isConditional</a>() &amp;&amp;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;             FCLatchBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0) == FCLatchBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(1) &amp;&amp;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;             <span class="stringliteral">&quot;Expecting the two successors of FCLatchBranch to be the same&quot;</span>);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *NewBranch =</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          <a class="code" href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">BranchInst::Create</a>(FCLatchBranch-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0));</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <a class="code" href="namespacellvm.html#a016a85f7487f995fe80141e102a7a5ae">ReplaceInstWithInst</a>(FCLatchBranch, NewBranch);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">  /// Move instructions from FC0.Latch to FC1.Latch. If FC0.Latch has an unique</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">  /// successor, then merge FC0.Latch with its unique successor.</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> mergeLatch(<span class="keyword">const</span> FusionCandidate &amp;FC0, <span class="keyword">const</span> FusionCandidate &amp;FC1) {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <a class="code" href="namespacellvm.html#a9cfb65e6e11fa2b005afc1680a7756df">moveInstructionsToTheBeginning</a>(*FC0.Latch, *FC1.Latch, DT, PDT, DI);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ = FC0.Latch-&gt;getUniqueSuccessor()) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <a class="code" href="namespacellvm.html#aa76a2cf19b821f320ab439d5659ef4b9">MergeBlockIntoPredecessor</a>(Succ, &amp;DTU, &amp;LI);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#a0b21e3233f5a0309838edeae7358ffd7">flush</a>();</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">  /// Fuse two fusion candidates, creating a new fused loop.</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">  /// This method contains the mechanics of fusing two loops, represented by \p</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">  /// FC0 and \p FC1. It is assumed that \p FC0 dominates \p FC1 and \p FC1</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">  /// postdominates \p FC0 (making them control flow equivalent). It also</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">  /// assumes that the other conditions for fusion have been met: adjacent,</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">  /// identical trip counts, and no negative distance dependencies exist that</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">  /// would prevent fusion. Thus, there is no checking for these conditions in</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">  /// this method.</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">  /// Fusion is performed by rewiring the CFG to update successor blocks of the</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">  /// components of tho loop. Specifically, the following changes are done:</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">  ///   1. The preheader of \p FC1 is removed as it is no longer necessary</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">  ///   (because it is currently only a single statement block).</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">  ///   2. The latch of \p FC0 is modified to jump to the header of \p FC1.</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">  ///   3. The latch of \p FC1 i modified to jump to the header of \p FC0.</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">  ///   4. All blocks from \p FC1 are removed from FC1 and added to FC0.</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">  /// All of these modifications are done with dominator tree updates, thus</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">  /// keeping the dominator (and post dominator) information up-to-date.</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">  /// This can be improved in the future by actually merging blocks during</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">  /// fusion. For example, the preheader of \p FC1 can be merged with the</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">  /// preheader of \p FC0. This would allow loops with more than a single</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">  /// statement in the preheader to be fused. Similarly, the latch blocks of the</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">  /// two loops could also be fused into a single block. This will require</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">  /// analysis to prove it is safe to move the contents of the block past</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">  /// existing code, which currently has not been implemented.</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *performFusion(<span class="keyword">const</span> FusionCandidate &amp;FC0, <span class="keyword">const</span> FusionCandidate &amp;FC1) {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0.isValid() &amp;&amp; FC1.isValid() &amp;&amp;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;           <span class="stringliteral">&quot;Expecting valid fusion candidates&quot;</span>);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion Candidate 0: \n&quot;</span>; FC0.dump();</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;               <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion Candidate 1: \n&quot;</span>; FC1.dump(););</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">// Move instructions from the preheader of FC1 to the end of the preheader</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">// of FC0.</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <a class="code" href="namespacellvm.html#a4972d73b274f1c9bb08ff314cba26522">moveInstructionsToTheEnd</a>(*FC1.Preheader, *FC0.Preheader, DT, PDT, DI);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">// Fusing guarded loops is handled slightly differently than non-guarded</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="comment">// loops and has been broken out into a separate method instead of trying to</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="comment">// intersperse the logic within a single method.</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">if</span> (FC0.GuardBranch)</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordflow">return</span> fuseGuardedLoops(FC0, FC1);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC1.Preheader ==</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;           (FC0.Peeled ? FC0.ExitBlock-&gt;getUniqueSuccessor() : FC0.ExitBlock));</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC1.Preheader-&gt;size() == 1 &amp;&amp;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;           FC1.Preheader-&gt;getSingleSuccessor() == FC1.Header);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="comment">// Remember the phi nodes originally in the header of FC0 in order to rewire</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="comment">// them later. However, this is only necessary if the new loop carried</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">// values might not dominate the exiting branch. While we do not generally</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// test if this is the case but simply insert intermediate phi nodes, we</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">// need to make sure these intermediate phi nodes have different</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">// predecessors. To this end, we filter the special case where the exiting</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">// block is the latch block of the first loop. Nothing needs to be done</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">// anyway as all loop carried values dominate the latch and thereby also the</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">// exiting branch.</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> OriginalFC0PHIs;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordflow">if</span> (FC0.ExitingBlock != FC0.Latch)</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : FC0.Header-&gt;phis())</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        OriginalFC0PHIs.push_back(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">// Replace incoming blocks for header PHIs first.</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    FC1.Preheader-&gt;replaceSuccessorsPhiUsesWith(FC0.Preheader);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    FC0.Latch-&gt;replaceSuccessorsPhiUsesWith(FC1.Latch);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">// Then modify the control flow and update DT and PDT.</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DominatorTree::UpdateType, 8&gt;</a> TreeUpdates;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="comment">// The old exiting block of the first loop (FC0) has to jump to the header</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="comment">// of the second as we need to execute the code in the second header block</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="comment">// regardless of the trip count. That is, if the trip count is 0, so the</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">// back edge is never taken, we still have to execute both loop headers,</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">// especially (but not only!) if the second is a do-while style loop.</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// However, doing so might invalidate the phi nodes of the first loop as</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// the new values do only need to dominate their latch and not the exiting</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// predicate. To remedy this potential problem we always introduce phi</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">// nodes in the header of the second loop later that select the loop carried</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">// value, if the second header was reached through an old latch of the</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">// first, or undef otherwise. This is sound as exiting the first implies the</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="comment">// second will exit too, __without__ taking the back-edge. [Their</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="comment">// trip-counts are equal after all.</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="comment">// KB: Would this sequence be simpler to just just make FC0.ExitingBlock go</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="comment">// to FC1.Header? I think this is basically what the three sequences are</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">// trying to accomplish; however, doing this directly in the CFG may mean</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// the DT/PDT becomes invalid</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">if</span> (!FC0.Peeled) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      FC0.ExitingBlock-&gt;getTerminator()-&gt;replaceUsesOfWith(FC1.Preheader,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                                                           FC1.Header);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC0.ExitingBlock, FC1.Preheader));</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>, FC0.ExitingBlock, FC1.Header));</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC0.ExitBlock, FC1.Preheader));</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="comment">// Remove the ExitBlock of the first Loop (also not needed)</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      FC0.ExitingBlock-&gt;getTerminator()-&gt;replaceUsesOfWith(FC0.ExitBlock,</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                                                           FC1.Header);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC0.ExitingBlock, FC0.ExitBlock));</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      FC0.ExitBlock-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>, FC0.ExitingBlock, FC1.Header));</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <span class="keyword">new</span> <a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a>(FC0.ExitBlock-&gt;getContext(), FC0.ExitBlock);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="comment">// The pre-header of L1 is not necessary anymore.</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#ad66c4759666aab78529658362b498c74">pred_empty</a>(FC1.Preheader));</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    FC1.Preheader-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keyword">new</span> <a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a>(FC1.Preheader-&gt;getContext(), FC1.Preheader);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC1.Preheader, FC1.Header));</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="comment">// Moves the phi nodes from the second to the first loops header block.</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = dyn_cast&lt;PHINode&gt;(&amp;FC1.Header-&gt;front())) {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <span class="keywordflow">if</span> (SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getType()))</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a804545e5b568edec8b970da32cd37359">forgetValue</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;hasNUsesOrMore(1))</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;moveBefore(&amp;*FC0.Header-&gt;getFirstInsertionPt());</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">// Introduce new phi nodes in the second loop header to ensure</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">// exiting the first and jumping to the header of the second does not break</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="comment">// the SSA property of the phis originally in the first loop. See also the</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">// comment above.</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *L1HeaderIP = &amp;FC1.Header-&gt;front();</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *LCPHI : OriginalFC0PHIs) {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordtype">int</span> L1LatchBBIdx = LCPHI-&gt;getBasicBlockIndex(FC1.Latch);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L1LatchBBIdx &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;             <span class="stringliteral">&quot;Expected loop carried value to be rewired at this point!&quot;</span>);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *LCV = LCPHI-&gt;getIncomingValue(L1LatchBBIdx);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *L1HeaderPHI = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          LCV-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 2, LCPHI-&gt;getName() + <span class="stringliteral">&quot;.afterFC0&quot;</span>, L1HeaderIP);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      L1HeaderPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(LCV, FC0.Latch);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      L1HeaderPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(LCV-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()),</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                               FC0.ExitingBlock);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      LCPHI-&gt;setIncomingValue(L1LatchBBIdx, L1HeaderPHI);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">// Replace latch terminator destinations.</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    FC0.Latch-&gt;getTerminator()-&gt;replaceUsesOfWith(FC0.Header, FC1.Header);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    FC1.Latch-&gt;getTerminator()-&gt;replaceUsesOfWith(FC1.Header, FC0.Header);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="comment">// Modify the latch branch of FC0 to be unconditional as both successors of</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="comment">// the branch are the same.</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    simplifyLatchBranch(FC0);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="comment">// If FC0.Latch and FC0.ExitingBlock are the same then we have already</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">// performed the updates above.</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span> (FC0.Latch != FC0.ExitingBlock)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>, FC0.Latch, FC1.Header));</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>,</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                                                       FC0.Latch, FC0.Header));</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>,</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                                                       FC1.Latch, FC0.Header));</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>,</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                                                       FC1.Latch, FC1.Header));</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">// Update DT/PDT</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#aae522cd1928cfac6850b50c7a3e22185">applyUpdates</a>(TreeUpdates);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a52cb018f4f53613b5369ddb5d9873286">removeBlock</a>(FC1.Preheader);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#adcca375fa8086f6844e863abbf58f83b">deleteBB</a>(FC1.Preheader);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> (FC0.Peeled) {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a52cb018f4f53613b5369ddb5d9873286">removeBlock</a>(FC0.ExitBlock);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#adcca375fa8086f6844e863abbf58f83b">deleteBB</a>(FC0.ExitBlock);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#a0b21e3233f5a0309838edeae7358ffd7">flush</a>();</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="comment">// Is there a way to keep SE up-to-date so we don&#39;t need to forget the loops</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">// and rebuild the information in subsequent passes of fusion?</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">// Note: Need to forget the loops before merging the loop latches, as</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">// mergeLatch may remove the only block in FC1.</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(FC1.L);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(FC0.L);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#abb9c0178bec51fd25f95b4399faa569c">forgetLoopDispositions</a>();</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; </div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// Move instructions from FC0.Latch to FC1.Latch.</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="comment">// Note: mergeLatch requires an updated DT.</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    mergeLatch(FC0, FC1);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">// Merge the loops.</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> Blocks(FC1.L-&gt;blocks());</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : Blocks) {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      FC0.L-&gt;addBlockEntry(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      FC1.L-&gt;removeBlockFromLoop(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keywordflow">if</span> (LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) != FC1.L)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a97de9fb6fdce68e4e31300fcf0e5a20c">changeLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, FC0.L);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">while</span> (!FC1.L-&gt;isInnermost()) {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ChildLoopIt = FC1.L-&gt;begin();</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <a class="code" href="classllvm_1_1Loop.html">Loop</a> *ChildLoop = *ChildLoopIt;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      FC1.L-&gt;removeChildLoop(ChildLoopIt);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      FC0.L-&gt;addChildLoop(ChildLoop);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    }</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">// Delete the now empty loop L1.</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfo.html#ab508a6297bcb823ca9d561facc241470">erase</a>(FC1.L);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm.html#a26389c546573f058ad8ecbdc5c1933cf">verifyFunction</a>(*FC0.Header-&gt;getParent(), &amp;<a class="code" href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()));</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a1f08f2925fec05b265e540d29066b9c8">verify</a>(<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309ea258d0fc76498bc434cf57e73ea5adbfc">DominatorTree::VerificationLevel::Fast</a>));</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PDT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a1f08f2925fec05b265e540d29066b9c8">verify</a>());</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a17a8f7aba5cca5c7f9faa779a3c4bc37">verify</a>(DT);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#aff82c03c1ce8b945170bcb1f0f624c17">verify</a>();</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion done:\n&quot;</span>);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="keywordflow">return</span> FC0.L;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  }</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">  /// Report details on loop fusion opportunities.</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">  /// This template function can be used to report both successful and missed</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">  /// loop fusion opportunities, based on the RemarkKind. The RemarkKind should</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">  /// be one of:</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">  ///   - OptimizationRemarkMissed to report when loop fusion is unsuccessful</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">  ///     given two valid fusion candidates.</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">  ///   - OptimizationRemark to report successful fusion of two fusion</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">  ///     candidates.</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment">  /// The remarks will be printed using the form:</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment">  ///    &lt;path/filename&gt;:&lt;line number&gt;:&lt;column number&gt;: [&lt;function name&gt;]:</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">  ///       &lt;Cand1 Preheader&gt; and &lt;Cand2 Preheader&gt;: &lt;Stat Description&gt;</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment"></span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> RemarkKind&gt;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="keywordtype">void</span> reportLoopFusion(<span class="keyword">const</span> FusionCandidate &amp;FC0, <span class="keyword">const</span> FusionCandidate &amp;FC1,</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                        <a class="code" href="classllvm_1_1TrackingStatistic.html">llvm::Statistic</a> &amp;Stat) {</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0.Preheader &amp;&amp; FC1.Preheader &amp;&amp;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;           <span class="stringliteral">&quot;Expecting valid fusion candidates&quot;</span>);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keyword">using namespace </span>ore;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="preprocessor">#if LLVM_ENABLE_STATS</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    ++Stat;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    ORE.<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>(RemarkKind(<a class="code" href="LoopFuse_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, Stat.getName(), FC0.L-&gt;getStartLoc(),</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                        FC0.Preheader)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; FC0.Preheader-&gt;getParent()-&gt;getName()</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;]: &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;Cand1&quot;</span>, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a>(FC0.Preheader-&gt;getName()))</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">NV</a>(<span class="stringliteral">&quot;Cand2&quot;</span>, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a>(FC1.Preheader-&gt;getName()))</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; Stat.getDesc());</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">  /// Fuse two guarded fusion candidates, creating a new fused loop.</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">  /// Fusing guarded loops is handled much the same way as fusing non-guarded</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">  /// loops. The rewiring of the CFG is slightly different though, because of</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">  /// the presence of the guards around the loops and the exit blocks after the</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">  /// loop body. As such, the new loop is rewired as follows:</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment">  ///    1. Keep the guard branch from FC0 and use the non-loop block target</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment">  /// from the FC1 guard branch.</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment">  ///    2. Remove the exit block from FC0 (this exit block should be empty</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment">  /// right now).</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">  ///    3. Remove the guard branch for FC1</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">  ///    4. Remove the preheader for FC1.</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">  /// The exit block successor for the latch of FC0 is updated to be the header</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">  /// of FC1 and the non-exit block successor of the latch of FC1 is updated to</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">  /// be the header of FC0, thus creating the fused loop.</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *fuseGuardedLoops(<span class="keyword">const</span> FusionCandidate &amp;FC0,</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                         <span class="keyword">const</span> FusionCandidate &amp;FC1) {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0.GuardBranch &amp;&amp; FC1.GuardBranch &amp;&amp; <span class="stringliteral">&quot;Expecting guarded loops&quot;</span>);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FC0GuardBlock = FC0.GuardBranch-&gt;getParent();</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FC1GuardBlock = FC1.GuardBranch-&gt;getParent();</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FC0NonLoopBlock = FC0.getNonLoopBlock();</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FC1NonLoopBlock = FC1.getNonLoopBlock();</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FC0ExitBlockSuccessor = FC0.ExitBlock-&gt;getUniqueSuccessor();</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">// Move instructions from the exit block of FC0 to the beginning of the exit</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// block of FC1, in the case that the FC0 loop has not been peeled. In the</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// case that FC0 loop is peeled, then move the instructions of the successor</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">// of the FC0 Exit block to the beginning of the exit block of FC1.</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <a class="code" href="namespacellvm.html#a9cfb65e6e11fa2b005afc1680a7756df">moveInstructionsToTheBeginning</a>(</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        (FC0.Peeled ? *FC0ExitBlockSuccessor : *FC0.ExitBlock), *FC1.ExitBlock,</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        DT, PDT, DI);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">// Move instructions from the guard block of FC1 to the end of the guard</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">// block of FC0.</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <a class="code" href="namespacellvm.html#a4972d73b274f1c9bb08ff314cba26522">moveInstructionsToTheEnd</a>(*FC1GuardBlock, *FC0GuardBlock, DT, PDT, DI);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FC0NonLoopBlock == FC1GuardBlock &amp;&amp; <span class="stringliteral">&quot;Loops are not adjacent&quot;</span>);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;DominatorTree::UpdateType, 8&gt;</a> TreeUpdates;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="comment"></span>    <span class="comment">// Update the Loop Guard</span><span class="comment"></span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment"></span>    <span class="comment">// The guard for FC0 is updated to guard both FC0 and FC1. This is done by</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="comment">// changing the NonLoopGuardBlock for FC0 to the NonLoopGuardBlock for FC1.</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="comment">// Thus, one path from the guard goes to the preheader for FC0 (and thus</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="comment">// executes the new fused loop) and the other path goes to the NonLoopBlock</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">// for FC1 (where FC1 guard would have gone if FC1 was not executed).</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    FC1NonLoopBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(FC1GuardBlock, FC0GuardBlock);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    FC0.GuardBranch-&gt;replaceUsesOfWith(FC0NonLoopBlock, FC1NonLoopBlock);</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BBToUpdate = FC0.Peeled ? FC0ExitBlockSuccessor : FC0.ExitBlock;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    BBToUpdate-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">replaceUsesOfWith</a>(FC1GuardBlock, FC1.Header);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="comment">// The guard of FC1 is not necessary anymore.</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    FC1.GuardBranch-&gt;eraseFromParent();</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keyword">new</span> <a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a>(FC1GuardBlock-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), FC1GuardBlock);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC1GuardBlock, FC1.Preheader));</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC1GuardBlock, FC1NonLoopBlock));</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC0GuardBlock, FC1GuardBlock));</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>, FC0GuardBlock, FC1NonLoopBlock));</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">if</span> (FC0.Peeled) {</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="comment">// Remove the Block after the ExitBlock of FC0</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC0ExitBlockSuccessor, FC1GuardBlock));</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      FC0ExitBlockSuccessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keyword">new</span> <a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a>(FC0ExitBlockSuccessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(),</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                          FC0ExitBlockSuccessor);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#ad66c4759666aab78529658362b498c74">pred_empty</a>(FC1GuardBlock) &amp;&amp;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;           <span class="stringliteral">&quot;Expecting guard block to have no predecessors&quot;</span>);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#a126a78caf2176eb39d879c899bdd749c">succ_empty</a>(FC1GuardBlock) &amp;&amp;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;           <span class="stringliteral">&quot;Expecting guard block to have no successors&quot;</span>);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="comment">// Remember the phi nodes originally in the header of FC0 in order to rewire</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="comment">// them later. However, this is only necessary if the new loop carried</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">// values might not dominate the exiting branch. While we do not generally</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="comment">// test if this is the case but simply insert intermediate phi nodes, we</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="comment">// need to make sure these intermediate phi nodes have different</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">// predecessors. To this end, we filter the special case where the exiting</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">// block is the latch block of the first loop. Nothing needs to be done</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">// anyway as all loop carried values dominate the latch and thereby also the</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">// exiting branch.</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">// KB: This is no longer necessary because FC0.ExitingBlock == FC0.Latch</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="comment">// (because the loops are rotated. Thus, nothing will ever be added to</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">// OriginalFC0PHIs.</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> OriginalFC0PHIs;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">if</span> (FC0.ExitingBlock != FC0.Latch)</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : FC0.Header-&gt;phis())</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        OriginalFC0PHIs.push_back(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OriginalFC0PHIs.empty() &amp;&amp; <span class="stringliteral">&quot;Expecting OriginalFC0PHIs to be empty!&quot;</span>);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="comment">// Replace incoming blocks for header PHIs first.</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    FC1.Preheader-&gt;replaceSuccessorsPhiUsesWith(FC0.Preheader);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    FC0.Latch-&gt;replaceSuccessorsPhiUsesWith(FC1.Latch);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="comment">// The old exiting block of the first loop (FC0) has to jump to the header</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="comment">// of the second as we need to execute the code in the second header block</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="comment">// regardless of the trip count. That is, if the trip count is 0, so the</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="comment">// back edge is never taken, we still have to execute both loop headers,</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">// especially (but not only!) if the second is a do-while style loop.</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="comment">// However, doing so might invalidate the phi nodes of the first loop as</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="comment">// the new values do only need to dominate their latch and not the exiting</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="comment">// predicate. To remedy this potential problem we always introduce phi</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// nodes in the header of the second loop later that select the loop carried</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">// value, if the second header was reached through an old latch of the</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="comment">// first, or undef otherwise. This is sound as exiting the first implies the</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">// second will exit too, __without__ taking the back-edge (their</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="comment">// trip-counts are equal after all).</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    FC0.ExitingBlock-&gt;getTerminator()-&gt;replaceUsesOfWith(FC0.ExitBlock,</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                                                         FC1.Header);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC0.ExitingBlock, FC0.ExitBlock));</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>, FC0.ExitingBlock, FC1.Header));</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="comment">// Remove FC0 Exit Block</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="comment">// The exit block for FC0 is no longer needed since control will flow</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="comment">// directly to the header of FC1. Since it is an empty block, it can be</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="comment">// removed at this point.</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="comment">// TODO: In the future, we can handle non-empty exit blocks my merging any</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="comment">// instructions from FC0 exit block into FC1 exit block prior to removing</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">// the block.</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#ad66c4759666aab78529658362b498c74">pred_empty</a>(FC0.ExitBlock) &amp;&amp; <span class="stringliteral">&quot;Expecting exit block to be empty&quot;</span>);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    FC0.ExitBlock-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keyword">new</span> <a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a>(FC0.ExitBlock-&gt;getContext(), FC0.ExitBlock);</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="comment">// Remove FC1 Preheader</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="comment">// The pre-header of L1 is not necessary anymore.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#ad66c4759666aab78529658362b498c74">pred_empty</a>(FC1.Preheader));</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    FC1.Preheader-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keyword">new</span> <a class="code" href="classllvm_1_1UnreachableInst.html">UnreachableInst</a>(FC1.Preheader-&gt;getContext(), FC1.Preheader);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>, FC1.Preheader, FC1.Header));</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="comment">// Moves the phi nodes from the second to the first loops header block.</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = dyn_cast&lt;PHINode&gt;(&amp;FC1.Header-&gt;front())) {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keywordflow">if</span> (SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getType()))</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a804545e5b568edec8b970da32cd37359">forgetValue</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;hasNUsesOrMore(1))</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;moveBefore(&amp;*FC0.Header-&gt;getFirstInsertionPt());</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">// Introduce new phi nodes in the second loop header to ensure</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">// exiting the first and jumping to the header of the second does not break</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">// the SSA property of the phis originally in the first loop. See also the</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">// comment above.</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *L1HeaderIP = &amp;FC1.Header-&gt;front();</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *LCPHI : OriginalFC0PHIs) {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordtype">int</span> L1LatchBBIdx = LCPHI-&gt;getBasicBlockIndex(FC1.Latch);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L1LatchBBIdx &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;             <span class="stringliteral">&quot;Expected loop carried value to be rewired at this point!&quot;</span>);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *LCV = LCPHI-&gt;getIncomingValue(L1LatchBBIdx);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *L1HeaderPHI = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;          LCV-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), 2, LCPHI-&gt;getName() + <span class="stringliteral">&quot;.afterFC0&quot;</span>, L1HeaderIP);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      L1HeaderPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(LCV, FC0.Latch);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      L1HeaderPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(LCV-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()),</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                               FC0.ExitingBlock);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; </div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      LCPHI-&gt;setIncomingValue(L1LatchBBIdx, L1HeaderPHI);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// Update the latches</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="comment">// Replace latch terminator destinations.</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    FC0.Latch-&gt;getTerminator()-&gt;replaceUsesOfWith(FC0.Header, FC1.Header);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    FC1.Latch-&gt;getTerminator()-&gt;replaceUsesOfWith(FC1.Header, FC0.Header);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="comment">// Modify the latch branch of FC0 to be unconditional as both successors of</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="comment">// the branch are the same.</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    simplifyLatchBranch(FC0);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="comment">// If FC0.Latch and FC0.ExitingBlock are the same then we have already</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <span class="comment">// performed the updates above.</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="keywordflow">if</span> (FC0.Latch != FC0.ExitingBlock)</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;          <a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>, FC0.Latch, FC1.Header));</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160; </div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>,</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                                                       FC0.Latch, FC0.Header));</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">DominatorTree::Insert</a>,</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                                                       FC1.Latch, FC0.Header));</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    TreeUpdates.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">DominatorTree::UpdateType</a>(<a class="code" href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">DominatorTree::Delete</a>,</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                                                       FC1.Latch, FC1.Header));</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="comment">// All done</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="comment">// Apply the updates to the Dominator Tree and cleanup.</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#a126a78caf2176eb39d879c899bdd749c">succ_empty</a>(FC1GuardBlock) &amp;&amp; <span class="stringliteral">&quot;FC1GuardBlock has successors!!&quot;</span>);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#ad66c4759666aab78529658362b498c74">pred_empty</a>(FC1GuardBlock) &amp;&amp; <span class="stringliteral">&quot;FC1GuardBlock has predecessors!!&quot;</span>);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="comment">// Update DT/PDT</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#aae522cd1928cfac6850b50c7a3e22185">applyUpdates</a>(TreeUpdates);</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a52cb018f4f53613b5369ddb5d9873286">removeBlock</a>(FC1GuardBlock);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a52cb018f4f53613b5369ddb5d9873286">removeBlock</a>(FC1.Preheader);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a52cb018f4f53613b5369ddb5d9873286">removeBlock</a>(FC0.ExitBlock);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="keywordflow">if</span> (FC0.Peeled) {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a52cb018f4f53613b5369ddb5d9873286">removeBlock</a>(FC0ExitBlockSuccessor);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#adcca375fa8086f6844e863abbf58f83b">deleteBB</a>(FC0ExitBlockSuccessor);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#adcca375fa8086f6844e863abbf58f83b">deleteBB</a>(FC1GuardBlock);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#adcca375fa8086f6844e863abbf58f83b">deleteBB</a>(FC1.Preheader);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#adcca375fa8086f6844e863abbf58f83b">deleteBB</a>(FC0.ExitBlock);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    DTU.<a class="code" href="classllvm_1_1DomTreeUpdater.html#a0b21e3233f5a0309838edeae7358ffd7">flush</a>();</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">// Is there a way to keep SE up-to-date so we don&#39;t need to forget the loops</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="comment">// and rebuild the information in subsequent passes of fusion?</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="comment">// Note: Need to forget the loops before merging the loop latches, as</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="comment">// mergeLatch may remove the only block in FC1.</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(FC1.L);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(FC0.L);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#abb9c0178bec51fd25f95b4399faa569c">forgetLoopDispositions</a>();</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="comment">// Move instructions from FC0.Latch to FC1.Latch.</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="comment">// Note: mergeLatch requires an updated DT.</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    mergeLatch(FC0, FC1);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; </div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">// Merge the loops.</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> Blocks(FC1.L-&gt;blocks());</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : Blocks) {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      FC0.L-&gt;addBlockEntry(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      FC1.L-&gt;removeBlockFromLoop(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="keywordflow">if</span> (LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) != FC1.L)</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a97de9fb6fdce68e4e31300fcf0e5a20c">changeLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, FC0.L);</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    }</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">while</span> (!FC1.L-&gt;isInnermost()) {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ChildLoopIt = FC1.L-&gt;begin();</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <a class="code" href="classllvm_1_1Loop.html">Loop</a> *ChildLoop = *ChildLoopIt;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      FC1.L-&gt;removeChildLoop(ChildLoopIt);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      FC0.L-&gt;addChildLoop(ChildLoop);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">// Delete the now empty loop L1.</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfo.html#ab508a6297bcb823ca9d561facc241470">erase</a>(FC1.L);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm.html#a26389c546573f058ad8ecbdc5c1933cf">verifyFunction</a>(*FC0.Header-&gt;getParent(), &amp;<a class="code" href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()));</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a1f08f2925fec05b265e540d29066b9c8">verify</a>(<a class="code" href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309ea258d0fc76498bc434cf57e73ea5adbfc">DominatorTree::VerificationLevel::Fast</a>));</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PDT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a1f08f2925fec05b265e540d29066b9c8">verify</a>());</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    LI.<a class="code" href="classllvm_1_1LoopInfoBase.html#a17a8f7aba5cca5c7f9faa779a3c4bc37">verify</a>(DT);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    SE.<a class="code" href="classllvm_1_1ScalarEvolution.html#aff82c03c1ce8b945170bcb1f0f624c17">verify</a>();</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Fusion done:\n&quot;</span>);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160; </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="keywordflow">return</span> FC0.L;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;};</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"><a class="line" href="classllvm_1_1LoopFusePass.html#a971f40ada3f1410759faede02bfbace7"> 2066</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1LoopFusePass.html#a971f40ada3f1410759faede02bfbace7">LoopFusePass::run</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <span class="keyword">auto</span> &amp;LI = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1LoopAnalysis.html">LoopAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="keyword">auto</span> &amp;DT = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeAnalysis.html">DominatorTreeAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="keyword">auto</span> &amp;DI = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1DependenceAnalysis.html">DependenceAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="keyword">auto</span> &amp;SE = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolutionAnalysis.html">ScalarEvolutionAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <span class="keyword">auto</span> &amp;PDT = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1PostDominatorTreeAnalysis.html">PostDominatorTreeAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keyword">auto</span> &amp;ORE = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">OptimizationRemarkEmitterAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="keyword">auto</span> &amp;AC = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1AssumptionAnalysis.html">AssumptionAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;<a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a> = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1TargetIRAnalysis.html">TargetIRAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getDataLayout();</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="comment">// Ensure loops are in simplifed form which is a pre-requisite for loop fusion</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="comment">// pass. Added only for new PM since the legacy PM has already added</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="comment">// LoopSimplify pass as a dependency.</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;L : LI) {</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    Changed |=</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <a class="code" href="namespacellvm.html#a0083a69883e0f97e111dbff064c60f42">simplifyLoop</a>(L, &amp;DT, &amp;LI, &amp;SE, &amp;AC, <span class="keyword">nullptr</span>, <span class="keyword">false</span> <span class="comment">/* PreserveLCSSA */</span>);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">if</span> (Changed)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    PDT.recalculate(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  LoopFuser LF(LI, DT, DI, SE, PDT, ORE, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, AC, <a class="code" href="classllvm_1_1TargetTransformInfo.html">TTI</a>);</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  Changed |= LF.fuseLoops(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordflow">if</span> (!Changed)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> PA;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">preserve</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeAnalysis.html">DominatorTreeAnalysis</a>&gt;();</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">preserve</a>&lt;<a class="code" href="classllvm_1_1PostDominatorTreeAnalysis.html">PostDominatorTreeAnalysis</a>&gt;();</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">preserve</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolutionAnalysis.html">ScalarEvolutionAnalysis</a>&gt;();</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">preserve</a>&lt;<a class="code" href="classllvm_1_1LoopAnalysis.html">LoopAnalysis</a>&gt;();</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordflow">return</span> PA;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aAssumptionCache_8h_html"><div class="ttname"><a href="AssumptionCache_8h.html">AssumptionCache.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a91ac801aa45c78e0d0edbc36115ef054"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a91ac801aa45c78e0d0edbc36115ef054">llvm::ScalarEvolution::hasLoopInvariantBackedgeTakenCount</a></div><div class="ttdeci">bool hasLoopInvariantBackedgeTakenCount(const Loop *L)</div><div class="ttdoc">Return true if the specified loop has an analyzable loop-invariant backedge-taken count.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l13494">ScalarEvolution.cpp:13494</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetIRAnalysis_html"><div class="ttname"><a href="classllvm_1_1TargetIRAnalysis.html">llvm::TargetIRAnalysis</a></div><div class="ttdoc">Analysis pass providing the TargetTransformInfo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l02626">TargetTransformInfo.h:2626</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolutionAnalysis_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolutionAnalysis.html">llvm::ScalarEvolutionAnalysis</a></div><div class="ttdoc">Analysis pass that exposes the ScalarEvolution for a function.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l02219">ScalarEvolution.h:2219</a></div></div>
<div class="ttc" id="aCompiler_8h_html_aa863693eef567397d9c292da5bf22d34"><div class="ttname"><a href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a></div><div class="ttdeci">#define LLVM_DUMP_METHOD</div><div class="ttdoc">Mark debug helper function definitions like dump() that should not be stripped from debug builds.</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00492">Compiler.h:492</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aLoopSimplify_8h_html"><div class="ttname"><a href="LoopSimplify_8h.html">LoopSimplify.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1sys_1_1path_1_1const__iterator_html_a8a503d1cbee10d1b8c8f5ac2a03b90df"><div class="ttname"><a href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a8a503d1cbee10d1b8c8f5ac2a03b90df">llvm::sys::path::const_iterator::end</a></div><div class="ttdeci">friend const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00235">Path.cpp:235</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">llvm::tgtok::Def</a></div><div class="ttdeci">@ Def</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00050">TGLexer.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeUpdater_html_adcca375fa8086f6844e863abbf58f83b"><div class="ttname"><a href="classllvm_1_1DomTreeUpdater.html#adcca375fa8086f6844e863abbf58f83b">llvm::DomTreeUpdater::deleteBB</a></div><div class="ttdeci">void deleteBB(BasicBlock *DelBB)</div><div class="ttdoc">Delete DelBB.</div><div class="ttdef"><b>Definition:</b> <a href="DomTreeUpdater_8cpp_source.html#l00177">DomTreeUpdater.cpp:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ab48af53a5000ecede46c76dabb4578d2"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">llvm::LoopBase::getExitBlock</a></div><div class="ttdeci">BlockT * getExitBlock() const</div><div class="ttdoc">If getExitBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00107">LoopInfoImpl.h:107</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_html_a016a85f7487f995fe80141e102a7a5ae"><div class="ttname"><a href="namespacellvm.html#a016a85f7487f995fe80141e102a7a5ae">llvm::ReplaceInstWithInst</a></div><div class="ttdeci">void ReplaceInstWithInst(BasicBlock *BB, BasicBlock::iterator &amp;BI, Instruction *I)</div><div class="ttdoc">Replace the instruction specified by BI with the instruction specified by I.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00576">BasicBlockUtils.cpp:576</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdoc">This enumeration lists the possible predicates for CmpInst subclasses.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00718">InstrTypes.h:718</a></div></div>
<div class="ttc" id="aAMDGPURewriteUndefForPHI_8cpp_html_a2e83cb1bc3f5e8986cbd14575755a134"><div class="ttname"><a href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a></div><div class="ttdeci">Rewrite undef for PHI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPURewriteUndefForPHI_8cpp_source.html#l00101">AMDGPURewriteUndefForPHI.cpp:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a54bb7394d874cbbef1d81e6bea89d4f3"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a54bb7394d874cbbef1d81e6bea89d4f3">llvm::SCEVAddRecExpr::isAffine</a></div><div class="ttdeci">bool isAffine() const</div><div class="ttdoc">Return true if this represents an expression A + B*x where A and B are loop invariant values.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00358">ScalarEvolutionExpressions.h:358</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeUpdater_html_aae522cd1928cfac6850b50c7a3e22185"><div class="ttname"><a href="classllvm_1_1DomTreeUpdater.html#aae522cd1928cfac6850b50c7a3e22185">llvm::DomTreeUpdater::applyUpdates</a></div><div class="ttdeci">void applyUpdates(ArrayRef&lt; DominatorTree::UpdateType &gt; Updates)</div><div class="ttdoc">Submit updates to all available trees.</div><div class="ttdef"><b>Definition:</b> <a href="DomTreeUpdater_8cpp_source.html#l00230">DomTreeUpdater.cpp:230</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a1d3a0e869e478018c481a577ed9d25ee"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a1d3a0e869e478018c481a577ed9d25ee">llvm::SCEVAddRecExpr::getStart</a></div><div class="ttdeci">const SCEV * getStart() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00341">ScalarEvolutionExpressions.h:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a17a8f7aba5cca5c7f9faa779a3c4bc37"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a17a8f7aba5cca5c7f9faa779a3c4bc37">llvm::LoopInfoBase::verify</a></div><div class="ttdeci">void verify(const DominatorTreeBase&lt; BlockT, false &gt; &amp;DomTree) const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00699">LoopInfoImpl.h:699</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a659b27f6737fcb7eaf333b0279da1154"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a659b27f6737fcb7eaf333b0279da1154">llvm::ScalarEvolution::getAddRecExpr</a></div><div class="ttdeci">const SCEV * getAddRecExpr(const SCEV *Start, const SCEV *Step, const Loop *L, SCEV::NoWrapFlags Flags)</div><div class="ttdoc">Get an add recurrence expression for the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l03653">ScalarEvolution.cpp:3653</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00196">TargetTransformInfo.h:196</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a615131659002c10601eef598d42d025e"><div class="ttname"><a href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">llvm::Loop::getStartLoc</a></div><div class="ttdeci">DebugLoc getStartLoc() const</div><div class="ttdoc">Return the debug location of the start of this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00631">LoopInfo.cpp:631</a></div></div>
<div class="ttc" id="aDomTreeUpdater_8h_html"><div class="ttname"><a href="DomTreeUpdater_8h.html">DomTreeUpdater.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdoc">The main scalar evolution driver.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00452">ScalarEvolution.h:452</a></div></div>
<div class="ttc" id="anamespaceR600__InstFlag_html_a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522"><div class="ttname"><a href="namespaceR600__InstFlag.html#a23106439cc906be24dc8953eedd3940da8949a42ff4563a29d1e70e18338fd522">R600_InstFlag::FC</a></div><div class="ttdeci">@ FC</div><div class="ttdef"><b>Definition:</b> <a href="R600Defines_8h_source.html#l00032">R600Defines.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a97de9fb6fdce68e4e31300fcf0e5a20c"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a97de9fb6fdce68e4e31300fcf0e5a20c">llvm::LoopInfoBase::changeLoopFor</a></div><div class="ttdeci">void changeLoopFor(BlockT *BB, LoopT *L)</div><div class="ttdoc">Change the top-level loop that contains BB to the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01030">LoopInfo.h:1030</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a486674b70a58582bee32dbd7aa604967"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a486674b70a58582bee32dbd7aa604967">llvm::LoopInfoBase::print</a></div><div class="ttdeci">void print(raw_ostream &amp;OS) const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00630">LoopInfoImpl.h:630</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26389c546573f058ad8ecbdc5c1933cf"><div class="ttname"><a href="namespacellvm.html#a26389c546573f058ad8ecbdc5c1933cf">llvm::verifyFunction</a></div><div class="ttdeci">bool verifyFunction(const Function &amp;F, raw_ostream *OS=nullptr)</div><div class="ttdoc">Check a function for errors, useful for use when debugging a pass.</div><div class="ttdef"><b>Definition:</b> <a href="Verifier_8cpp_source.html#l06428">Verifier.cpp:6428</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639"><div class="ttname"><a href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">llvm::Depth</a></div><div class="ttdeci">@ Depth</div><div class="ttdef"><b>Definition:</b> <a href="SIMachineScheduler_8h_source.html#l00036">SIMachineScheduler.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78ba720a42e85f7e981afd61e28473b0000a"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78ba720a42e85f7e981afd61e28473b0000a">llvm::CmpInst::ICMP_SGT</a></div><div class="ttdeci">@ ICMP_SGT</div><div class="ttdoc">signed greater than</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00745">InstrTypes.h:745</a></div></div>
<div class="ttc" id="aScalarEvolution_8h_html"><div class="ttname"><a href="ScalarEvolution_8h.html">ScalarEvolution.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a52cb018f4f53613b5369ddb5d9873286"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a52cb018f4f53613b5369ddb5d9873286">llvm::LoopInfoBase::removeBlock</a></div><div class="ttdeci">void removeBlock(BlockT *BB)</div><div class="ttdoc">This method completely removes BB from all data structures, including all of the Loop objects it is n...</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01057">LoopInfo.h:1057</a></div></div>
<div class="ttc" id="astructllvm_1_1TargetTransformInfo_1_1PeelingPreferences_html"><div class="ttname"><a href="structllvm_1_1TargetTransformInfo_1_1PeelingPreferences.html">llvm::TargetTransformInfo::PeelingPreferences</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00547">TargetTransformInfo.h:547</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a214ec2f04ffd92636ed4bd2717607a1d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">llvm::sys::path::end</a></div><div class="ttdeci">const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00235">Path.cpp:235</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a00a76a729b319dc47beffbe07325565f"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path, Style style=Style::native)</div><div class="ttdoc">Get begin iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00226">Path.cpp:226</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a9aeeca2833810f01b20545a46fe22503"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a9aeeca2833810f01b20545a46fe22503">llvm::DominatorTreeBase&lt; BasicBlock, false &gt;::Insert</a></div><div class="ttdeci">static constexpr UpdateKind Insert</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00258">GenericDomTree.h:258</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_af2f81059dc7566164b018aac6555eb1a"><div class="ttname"><a href="classllvm_1_1LoopBase.html#af2f81059dc7566164b018aac6555eb1a">llvm::LoopBase::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00171">LoopInfo.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a8f5533240c6722d987a2443cba42019d"><div class="ttname"><a href="namespacellvm_1_1ore.html#a8f5533240c6722d987a2443cba42019d">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVNAryExpr_html_a980d0688dfa2b96b0043950aa1aa88b3"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html#a980d0688dfa2b96b0043950aa1aa88b3">llvm::SCEVNAryExpr::operands</a></div><div class="ttdeci">ArrayRef&lt; const SCEV * &gt; operands() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00201">ScalarEvolutionExpressions.h:201</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9a7b5c68c90f85baaedaa854cc5002cc"><div class="ttname"><a href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">llvm::errs</a></div><div class="ttdeci">raw_fd_ostream &amp; errs()</div><div class="ttdoc">This returns a reference to a raw_ostream for standard error.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8cpp_source.html#l00899">raw_ostream.cpp:899</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_a1ab1a3714b11541ec7a09424d4d237eb"><div class="ttname"><a href="LoopFuse_8cpp.html#a1ab1a3714b11541ec7a09424d4d237eb">VerboseFusionDebugging</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; VerboseFusionDebugging(&quot;loop-fusion-verbose-debug&quot;, cl::desc(&quot;Enable verbose debugging for Loop Fusion&quot;), cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="anamespacellvm_html_a03503773241005f01b090b9862aad304"><div class="ttname"><a href="namespacellvm.html#a03503773241005f01b090b9862aad304">llvm::dump</a></div><div class="ttdeci">void dump(const SparseBitVector&lt; ElementSize &gt; &amp;LHS, raw_ostream &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="SparseBitVector_8h_source.html#l00877">SparseBitVector.h:877</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3aea1e78510aa7469457aade10808e51"><div class="ttname"><a href="namespacellvm.html#a3aea1e78510aa7469457aade10808e51">llvm::canPeel</a></div><div class="ttdeci">bool canPeel(const Loop *L)</div><div class="ttdef"><b>Definition:</b> <a href="LoopPeel_8cpp_source.html#l00083">LoopPeel.cpp:83</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Sched_html_ac1547cccaf660851fcd6863d1e60309ea258d0fc76498bc434cf57e73ea5adbfc"><div class="ttname"><a href="namespacellvm_1_1Sched.html#ac1547cccaf660851fcd6863d1e60309ea258d0fc76498bc434cf57e73ea5adbfc">llvm::Sched::Fast</a></div><div class="ttdeci">@ Fast</div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00105">TargetLowering.h:105</a></div></div>
<div class="ttc" id="anamespacellvm_html_a126a78caf2176eb39d879c899bdd749c"><div class="ttname"><a href="namespacellvm.html#a126a78caf2176eb39d879c899bdd749c">llvm::succ_empty</a></div><div class="ttdeci">bool succ_empty(const Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="IR_2CFG_8h_source.html#l00255">CFG.h:255</a></div></div>
<div class="ttc" id="anamespacellvm_html_a86a71a2b6a39dfb4ddb69ab4ed006eac"><div class="ttname"><a href="namespacellvm.html#a86a71a2b6a39dfb4ddb69ab4ed006eac">llvm::isControlFlowEquivalent</a></div><div class="ttdeci">bool isControlFlowEquivalent(const Instruction &amp;I0, const Instruction &amp;I1, const DominatorTree &amp;DT, const PostDominatorTree &amp;PDT)</div><div class="ttdoc">Return true if I0 and I1 are control flow equivalent.</div><div class="ttdef"><b>Definition:</b> <a href="CodeMoverUtils_8cpp_source.html#l00231">CodeMoverUtils.cpp:231</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa76a2cf19b821f320ab439d5659ef4b9"><div class="ttname"><a href="namespacellvm.html#aa76a2cf19b821f320ab439d5659ef4b9">llvm::MergeBlockIntoPredecessor</a></div><div class="ttdeci">bool MergeBlockIntoPredecessor(BasicBlock *BB, DomTreeUpdater *DTU=nullptr, LoopInfo *LI=nullptr, MemorySSAUpdater *MSSAU=nullptr, MemoryDependenceResults *MemDep=nullptr, bool PredecessorWithTwoSuccessors=false, DominatorTree *DT=nullptr)</div><div class="ttdoc">Attempts to merge a block into its predecessor, if possible.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00179">BasicBlockUtils.cpp:179</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_a56c800ff50c72a9547dc77a1ef29a329"><div class="ttname"><a href="LoopFuse_8cpp.html#a56c800ff50c72a9547dc77a1ef29a329">FusionPeelMaxCount</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; FusionPeelMaxCount(&quot;loop-fusion-peel-max-count&quot;, cl::init(0), cl::Hidden, cl::desc(&quot;Max number of iterations to be peeled from a loop, such that &quot; &quot;fusion can take place&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_a90896a5c2c14e27297f4fdb0196e24b3"><div class="ttname"><a href="namespacellvm.html#a90896a5c2c14e27297f4fdb0196e24b3">llvm::nonStrictlyPostDominate</a></div><div class="ttdeci">bool nonStrictlyPostDominate(const BasicBlock *ThisBlock, const BasicBlock *OtherBlock, const DominatorTree *DT, const PostDominatorTree *PDT)</div><div class="ttdoc">In case that two BBs ThisBlock and OtherBlock are control flow equivalent but they do not strictly do...</div><div class="ttdef"><b>Definition:</b> <a href="CodeMoverUtils_8cpp_source.html#l00436">CodeMoverUtils.cpp:436</a></div></div>
<div class="ttc" id="aVirtRegMap_8cpp_html_a1ad52109a2ff430460c8776286b97b2e"><div class="ttname"><a href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a></div><div class="ttdeci">Virtual Register Rewriter</div><div class="ttdef"><b>Definition:</b> <a href="VirtRegMap_8cpp_source.html#l00237">VirtRegMap.cpp:237</a></div></div>
<div class="ttc" id="aPostDominators_8h_html"><div class="ttname"><a href="PostDominators_8h.html">PostDominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_aca76acb70a839a2462d3e9ae346e1eb0"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#aca76acb70a839a2462d3e9ae346e1eb0">llvm::DominatorTreeBase&lt; BasicBlock, false &gt;::UpdateType</a></div><div class="ttdeci">cfg::Update&lt; NodePtr &gt; UpdateType</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00256">GenericDomTree.h:256</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a98eb0888f30e7a27151a7b02fa053205"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a98eb0888f30e7a27151a7b02fa053205">llvm::LoopBase::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00172">LoopInfo.h:172</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a40f34cc77d2b3bc73384f535c8101858"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">llvm::LoopBase::blocks</a></div><div class="ttdeci">iterator_range&lt; block_iterator &gt; blocks() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00195">LoopInfo.h:195</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00141">StackSlotColoring.cpp:141</a></div></div>
<div class="ttc" id="anamespacellvm_html_af74d55b9091c302365e3af53f446a2a2"><div class="ttname"><a href="namespacellvm.html#af74d55b9091c302365e3af53f446a2a2">llvm::printLoop</a></div><div class="ttdeci">void printLoop(Loop &amp;L, raw_ostream &amp;OS, const std::string &amp;Banner=&quot;&quot;)</div><div class="ttdoc">Function to print a loop's contents as LLVM's text IR assembly.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00977">LoopInfo.cpp:977</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a60a56343d06195ae01b61d087e672afd"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a60a56343d06195ae01b61d087e672afd">llvm::ScalarEvolution::isKnownPredicate</a></div><div class="ttdeci">bool isKnownPredicate(ICmpInst::Predicate Pred, const SCEV *LHS, const SCEV *RHS)</div><div class="ttdoc">Test if the given expression is known to satisfy the condition described by Pred, LHS,...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l10904">ScalarEvolution.cpp:10904</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="anamespacellvm_html_affb88623037a9864e030154052747ba1"><div class="ttname"><a href="namespacellvm.html#affb88623037a9864e030154052747ba1">llvm::SCEVExprContains</a></div><div class="ttdeci">bool SCEVExprContains(const SCEV *Root, PredTy Pred)</div><div class="ttdoc">Return true if any node in Root satisfies the predicate Pred.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00711">ScalarEvolutionExpressions.h:711</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00052">raw_ostream.h:52</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5ee0a415cf089775fd277550b257f74e"><div class="ttname"><a href="namespacellvm.html#a5ee0a415cf089775fd277550b257f74e">llvm::operator&lt;&lt;</a></div><div class="ttdeci">raw_ostream &amp; operator&lt;&lt;(raw_ostream &amp;OS, const APFixedPoint &amp;FX)</div><div class="ttdef"><b>Definition:</b> <a href="APFixedPoint_8h_source.html#l00292">APFixedPoint.h:292</a></div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'undef' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01740">Constants.cpp:1740</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeUpdater_html"><div class="ttname"><a href="classllvm_1_1DomTreeUpdater.html">llvm::DomTreeUpdater</a></div><div class="ttdef"><b>Definition:</b> <a href="DomTreeUpdater_8h_source.html#l00028">DomTreeUpdater.h:28</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_ab2ce98edbf00ac5582eba4ec2630b50bae2968bc1b6d284f07e96fac3ce78bc54"><div class="ttname"><a href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50bae2968bc1b6d284f07e96fac3ce78bc54">FUSION_DEPENDENCE_ANALYSIS_SCEV</a></div><div class="ttdeci">@ FUSION_DEPENDENCE_ANALYSIS_SCEV</div><div class="ttdef"><b>Definition:</b> <a href="LoopFuse_8cpp_source.html#l00109">LoopFuse.cpp:109</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="LoopFuse_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="LoopFuse_8cpp_source.html#l00074">LoopFuse.cpp:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_adf6f53d7652b471c995b7d10f3dd2729"><div class="ttname"><a href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">llvm::LoopBase::getExitingBlock</a></div><div class="ttdeci">BlockT * getExitingBlock() const</div><div class="ttdoc">If getExitingBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00048">LoopInfoImpl.h:48</a></div></div>
<div class="ttc" id="aTransforms_2Utils_8h_html"><div class="ttname"><a href="Transforms_2Utils_8h.html">Utils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a917a64b00c1745fd0c78c2b2320cd4ad"><div class="ttname"><a href="classllvm_1_1Loop.html#a917a64b00c1745fd0c78c2b2320cd4ad">llvm::Loop::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00891">LoopInfo.h:891</a></div></div>
<div class="ttc" id="anamespacellvm_html_afdb3eec2f46233c924c30c0838a3c8fe"><div class="ttname"><a href="namespacellvm.html#afdb3eec2f46233c924c30c0838a3c8fe">llvm::peelLoop</a></div><div class="ttdeci">bool peelLoop(Loop *L, unsigned PeelCount, LoopInfo *LI, ScalarEvolution *SE, DominatorTree &amp;DT, AssumptionCache *AC, bool PreserveLCSSA, ValueToValueMapTy &amp;VMap)</div><div class="ttdoc">VMap is the value-map that maps instructions from the original loop to instructions in the last peele...</div><div class="ttdef"><b>Definition:</b> <a href="LoopPeel_8cpp_source.html#l00855">LoopPeel.cpp:855</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aMIRNamerPass_8cpp_html_a05e4be4ec3e2c3587dda0e376bb6822c"><div class="ttname"><a href="MIRNamerPass_8cpp.html#a05e4be4ec3e2c3587dda0e376bb6822c">Operands</a></div><div class="ttdeci">mir Rename Register Operands</div><div class="ttdef"><b>Definition:</b> <a href="MIRNamerPass_8cpp_source.html#l00074">MIRNamerPass.cpp:74</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aLoopFuse_8h_html"><div class="ttname"><a href="LoopFuse_8h.html">LoopFuse.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_abec0c616087c002528fcf80c6583eadd"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#abec0c616087c002528fcf80c6583eadd">llvm::ScalarEvolution::getSmallConstantTripCount</a></div><div class="ttdeci">unsigned getSmallConstantTripCount(const Loop *L)</div><div class="ttdoc">Returns the exact trip count of the loop if we can compute it, and the result is a small constant.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08105">ScalarEvolution.cpp:8105</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_ac233a2693163ed58305215ca2f6921e3"><div class="ttname"><a href="classllvm_1_1Loop.html#ac233a2693163ed58305215ca2f6921e3">llvm::Loop::isLoopSimplifyForm</a></div><div class="ttdeci">bool isLoopSimplifyForm() const</div><div class="ttdoc">Return true if the Loop is in the form that the LoopSimplify form transforms loops to,...</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00479">LoopInfo.cpp:479</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdoc">This class represents an analyzed expression in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00075">ScalarEvolution.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1DependenceInfo_html"><div class="ttname"><a href="classllvm_1_1DependenceInfo.html">llvm::DependenceInfo</a></div><div class="ttdoc">DependenceInfo - This class is the main dependence-analysis driver.</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00293">DependenceAnalysis.h:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a8fa743aa76b6902028f8a643dfb87171"><div class="ttname"><a href="namespacellvm_1_1cl.html#a8fa743aa76b6902028f8a643dfb87171">llvm::cl::values</a></div><div class="ttdeci">ValuesClass values(OptsTy... Options)</div><div class="ttdoc">Helper to build a ValuesClass by forwarding a variable number of arguments as an initializer list to ...</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00703">CommandLine.h:703</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4972d73b274f1c9bb08ff314cba26522"><div class="ttname"><a href="namespacellvm.html#a4972d73b274f1c9bb08ff314cba26522">llvm::moveInstructionsToTheEnd</a></div><div class="ttdeci">void moveInstructionsToTheEnd(BasicBlock &amp;FromBB, BasicBlock &amp;ToBB, DominatorTree &amp;DT, const PostDominatorTree &amp;PDT, DependenceInfo &amp;DI)</div><div class="ttdoc">Move instructions, in an order-preserving manner, from FromBB to the end of ToBB when proven safe.</div><div class="ttdef"><b>Definition:</b> <a href="CodeMoverUtils_8cpp_source.html#l00424">CodeMoverUtils.cpp:424</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_aff82c03c1ce8b945170bcb1f0f624c17"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#aff82c03c1ce8b945170bcb1f0f624c17">llvm::ScalarEvolution::verify</a></div><div class="ttdeci">void verify() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l14026">ScalarEvolution.cpp:14026</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a9bf617fd3367180fb96cebccfaae8dfa"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a></div><div class="ttdeci">static GCRegistry::Add&lt; StatepointGC &gt; D(&quot;statepoint-example&quot;, &quot;an example strategy for statepoint&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionAnalysis_html"><div class="ttname"><a href="classllvm_1_1AssumptionAnalysis.html">llvm::AssumptionAnalysis</a></div><div class="ttdoc">A function analysis which provides an AssumptionCache.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00173">AssumptionCache.h:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_ad966bea18aa62ffb9e040509adc7c99f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">llvm::PreservedAnalyses::preserve</a></div><div class="ttdeci">void preserve()</div><div class="ttdoc">Mark an analysis as preserved.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00173">PassManager.h:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a38df51256d4b415b6a817b5e1c6d4d36"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a38df51256d4b415b6a817b5e1c6d4d36">llvm::BranchInst::Create</a></div><div class="ttdeci">static BranchInst * Create(BasicBlock *IfTrue, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03195">Instructions.h:3195</a></div></div>
<div class="ttc" id="aBasicAliasAnalysis_8cpp_html_af6d5cafbdfc5313e65d990120021a3ec"><div class="ttname"><a href="BasicAliasAnalysis_8cpp.html#af6d5cafbdfc5313e65d990120021a3ec">true</a></div><div class="ttdeci">basic Basic Alias true</div><div class="ttdef"><b>Definition:</b> <a href="BasicAliasAnalysis_8cpp_source.html#l01804">BasicAliasAnalysis.cpp:1804</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a7a7c8e0e4f836c13c015b62e18f386bd"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">llvm::LoopInfoBase::getLoopFor</a></div><div class="ttdeci">LoopT * getLoopFor(const BlockT *BB) const</div><div class="ttdoc">Return the inner most loop that BB lives in.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00992">LoopInfo.h:992</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ac3280e7f76f955403fe17eacf126b90d"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const</div><div class="ttdoc">If there is a preheader for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00183">LoopInfoImpl.h:183</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd1cd968cb420c82d70926920fcdc7d7"><div class="ttname"><a href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a></div><div class="ttdeci">bool is_contained(R &amp;&amp;Range, const E &amp;Element)</div><div class="ttdoc">Wrapper function around std::find to detect if an element exists in a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01869">STLExtras.h:1869</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVRewriteVisitor_html"><div class="ttname"><a href="classllvm_1_1SCEVRewriteVisitor.html">llvm::SCEVRewriteVisitor</a></div><div class="ttdoc">This visitor recursively visits a SCEV expression and re-writes it.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00738">ScalarEvolutionExpressions.h:738</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a804545e5b568edec8b970da32cd37359"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a804545e5b568edec8b970da32cd37359">llvm::ScalarEvolution::forgetValue</a></div><div class="ttdeci">void forgetValue(Value *V)</div><div class="ttdoc">This method should be called by the client when it has changed a value in a way that may effect its v...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08523">ScalarEvolution.cpp:8523</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a1230fd674d2609b96527fe65eaf40b1b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const</div><div class="ttdoc">If there is a single latch block for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00232">LoopInfoImpl.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1sys_1_1path_1_1const__iterator_html_a88c072843122519fd4f3547f2a0ab178"><div class="ttname"><a href="classllvm_1_1sys_1_1path_1_1const__iterator.html#a88c072843122519fd4f3547f2a0ab178">llvm::sys::path::const_iterator::begin</a></div><div class="ttdeci">friend const_iterator begin(StringRef path, Style style)</div><div class="ttdoc">Get begin iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00226">Path.cpp:226</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html_aae6a98aea85aa3af87357cc5448db499"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">llvm::OptimizationRemarkEmitter::emit</a></div><div class="ttdeci">void emit(DiagnosticInfoOptimizationBase &amp;OptDiag)</div><div class="ttdoc">Output the remark via the diagnostic handler and to the optimization record file.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00079">OptimizationRemarkEmitter.cpp:79</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa0d69e81725c10fa5407f0bf34462068"><div class="ttname"><a href="namespacellvm.html#aa0d69e81725c10fa5407f0bf34462068">llvm::TTI</a></div><div class="ttdeci">TargetTransformInfo TTI</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00191">TargetTransformInfo.h:191</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html_ab508a6297bcb823ca9d561facc241470"><div class="ttname"><a href="classllvm_1_1LoopInfo.html#ab508a6297bcb823ca9d561facc241470">llvm::LoopInfo::erase</a></div><div class="ttdeci">void erase(Loop *L)</div><div class="ttdoc">Update LoopInfo after removing the last backedge from a loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00876">LoopInfo.cpp:876</a></div></div>
<div class="ttc" id="anamespacellvm_html_a10f3d955592ae2bc745f57e5b48ae115"><div class="ttname"><a href="namespacellvm.html#a10f3d955592ae2bc745f57e5b48ae115">llvm::size</a></div><div class="ttdeci">auto size(R &amp;&amp;Range, std::enable_if_t&lt; std::is_base_of&lt; std::random_access_iterator_tag, typename std::iterator_traits&lt; decltype(Range.begin())&gt;::iterator_category &gt;::value, void &gt; *=nullptr)</div><div class="ttdoc">Get the size of a range.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01716">STLExtras.h:1716</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_ab2ce98edbf00ac5582eba4ec2630b50ba9f38e26f008e10a2cd493e477865cf72"><div class="ttname"><a href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba9f38e26f008e10a2cd493e477865cf72">FUSION_DEPENDENCE_ANALYSIS_ALL</a></div><div class="ttdeci">@ FUSION_DEPENDENCE_ANALYSIS_ALL</div><div class="ttdef"><b>Definition:</b> <a href="LoopFuse_8cpp_source.html#l00111">LoopFuse.cpp:111</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_abb9c0178bec51fd25f95b4399faa569c"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#abb9c0178bec51fd25f95b4399faa569c">llvm::ScalarEvolution::forgetLoopDispositions</a></div><div class="ttdeci">void forgetLoopDispositions()</div><div class="ttdoc">Called when the client has changed the disposition of values in this loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08550">ScalarEvolution.cpp:8550</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_aa0641ae965656ff9988d67a35140e4d9"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#aa0641ae965656ff9988d67a35140e4d9">llvm::DominatorTreeBase::recalculate</a></div><div class="ttdeci">void recalculate(ParentType &amp;Func)</div><div class="ttdoc">recalculate - compute a dominator tree for the given function</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00795">GenericDomTree.h:795</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVNAryExpr_html_a7275347a4dce174f4fecd548fd3255dc"><div class="ttname"><a href="classllvm_1_1SCEVNAryExpr.html#a7275347a4dce174f4fecd548fd3255dc">llvm::SCEVNAryExpr::getNoWrapFlags</a></div><div class="ttdeci">NoWrapFlags getNoWrapFlags(NoWrapFlags Mask=NoWrapMask) const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00205">ScalarEvolutionExpressions.h:205</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCache_html"><div class="ttname"><a href="classllvm_1_1AssumptionCache.html">llvm::AssumptionCache</a></div><div class="ttdoc">A cache of @llvm.assume calls within a function.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00042">AssumptionCache.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1PostDominatorTree_html"><div class="ttname"><a href="classllvm_1_1PostDominatorTree.html">llvm::PostDominatorTree</a></div><div class="ttdoc">PostDominatorTree Class - Concrete subclass of DominatorTree that is used to compute the post-dominat...</div><div class="ttdef"><b>Definition:</b> <a href="PostDominators_8h_source.html#l00028">PostDominators.h:28</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="anamespacellvm_html_a39d3d23a084c4544ee5903203db10e8a"><div class="ttname"><a href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a></div><div class="ttdeci">void append_range(Container &amp;C, Range &amp;&amp;R)</div><div class="ttdoc">Wrapper function to append a range to a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l02014">STLExtras.h:2014</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6e86d0ac2e968adc60290ca52da02e42"><div class="ttname"><a href="namespacellvm.html#a6e86d0ac2e968adc60290ca52da02e42">llvm::gatherPeelingPreferences</a></div><div class="ttdeci">TargetTransformInfo::PeelingPreferences gatherPeelingPreferences(Loop *L, ScalarEvolution &amp;SE, const TargetTransformInfo &amp;TTI, std::optional&lt; bool &gt; UserAllowPeeling, std::optional&lt; bool &gt; UserAllowProfileBasedPeeling, bool UnrollingSpecficValues=false)</div><div class="ttdef"><b>Definition:</b> <a href="LoopPeel_8cpp_source.html#l00811">LoopPeel.cpp:811</a></div></div>
<div class="ttc" id="aclassllvm_1_1DependenceAnalysis_html"><div class="ttname"><a href="classllvm_1_1DependenceAnalysis.html">llvm::DependenceAnalysis</a></div><div class="ttdoc">AnalysisPass to compute dependence information in a function.</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00978">DependenceAnalysis.h:978</a></div></div>
<div class="ttc" id="aCommandLine_8h_html_a187fd767976b311c09dff5e05ac0c1bc"><div class="ttname"><a href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a></div><div class="ttdeci">#define clEnumValN(ENUMVAL, FLAGNAME, DESC)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00678">CommandLine.h:678</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9cfb65e6e11fa2b005afc1680a7756df"><div class="ttname"><a href="namespacellvm.html#a9cfb65e6e11fa2b005afc1680a7756df">llvm::moveInstructionsToTheBeginning</a></div><div class="ttdeci">void moveInstructionsToTheBeginning(BasicBlock &amp;FromBB, BasicBlock &amp;ToBB, DominatorTree &amp;DT, const PostDominatorTree &amp;PDT, DependenceInfo &amp;DI)</div><div class="ttdoc">Move instructions, in an order-preserving manner, from FromBB to the beginning of ToBB when proven sa...</div><div class="ttdef"><b>Definition:</b> <a href="CodeMoverUtils_8cpp_source.html#l00411">CodeMoverUtils.cpp:411</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aCodeMoverUtils_8h_html"><div class="ttname"><a href="CodeMoverUtils_8h.html">CodeMoverUtils.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad66c4759666aab78529658362b498c74"><div class="ttname"><a href="namespacellvm.html#ad66c4759666aab78529658362b498c74">llvm::pred_empty</a></div><div class="ttdeci">bool pred_empty(const BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="IR_2CFG_8h_source.html#l00118">CFG.h:118</a></div></div>
<div class="ttc" id="aCodeMoverUtils_8cpp_html_a134ee84d052b18522fd2d6bca5cf0778"><div class="ttname"><a href="CodeMoverUtils_8cpp.html#a134ee84d052b18522fd2d6bca5cf0778">reportInvalidCandidate</a></div><div class="ttdeci">static bool reportInvalidCandidate(const Instruction &amp;I, llvm::Statistic &amp;Stat)</div><div class="ttdef"><b>Definition:</b> <a href="CodeMoverUtils_8cpp_source.html#l00269">CodeMoverUtils.cpp:269</a></div></div>
<div class="ttc" id="aclassllvm_1_1TrackingStatistic_html"><div class="ttname"><a href="classllvm_1_1TrackingStatistic.html">llvm::TrackingStatistic</a></div><div class="ttdef"><b>Definition:</b> <a href="Statistic_8h_source.html#l00050">Statistic.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkAnalysis.html">llvm::OptimizationRemarkAnalysis</a></div><div class="ttdoc">Diagnostic information for optimization analysis remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00780">DiagnosticInfo.h:780</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeUpdater_html_a0b21e3233f5a0309838edeae7358ffd7"><div class="ttname"><a href="classllvm_1_1DomTreeUpdater.html#a0b21e3233f5a0309838edeae7358ffd7">llvm::DomTreeUpdater::flush</a></div><div class="ttdeci">void flush()</div><div class="ttdoc">Apply all pending updates to available trees and flush all BasicBlocks awaiting deletion.</div><div class="ttdef"><b>Definition:</b> <a href="DomTreeUpdater_8cpp_source.html#l00073">DomTreeUpdater.cpp:73</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html">llvm::DomTreeNodeBase&lt; BasicBlock &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1ValueMap_html"><div class="ttname"><a href="classllvm_1_1ValueMap.html">llvm::ValueMap&lt; const Value *, WeakTrackingVH &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a1600c7959045cb6b6a5f5a1d427ec67e"><div class="ttname"><a href="classllvm_1_1User.html#a1600c7959045cb6b6a5f5a1d427ec67e">llvm::User::replaceUsesOfWith</a></div><div class="ttdeci">bool replaceUsesOfWith(Value *From, Value *To)</div><div class="ttdoc">Replace uses of one Value with another.</div><div class="ttdef"><b>Definition:</b> <a href="User_8cpp_source.html#l00021">User.cpp:21</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a5a672708a81ae8da8fb56e32638ca9b3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5a672708a81ae8da8fb56e32638ca9b3">llvm::ScalarEvolution::isKnownPositive</a></div><div class="ttdeci">bool isKnownPositive(const SCEV *S)</div><div class="ttdoc">Test if the given expression is known to be positive.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l10825">ScalarEvolution.cpp:10825</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_aa286a0f7f5d38488d593bb7ef0ba183e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">llvm::BasicBlock::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">Get the context in which this basic block lives.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00035">BasicBlock.cpp:35</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopFusePass_html_a971f40ada3f1410759faede02bfbace7"><div class="ttname"><a href="classllvm_1_1LoopFusePass.html#a971f40ada3f1410759faede02bfbace7">llvm::LoopFusePass::run</a></div><div class="ttdeci">PreservedAnalyses run(Function &amp;F, FunctionAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition:</b> <a href="LoopFuse_8cpp_source.html#l02066">LoopFuse.cpp:2066</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a7349a5d6bf71f3d3344b37104dc25bf4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">llvm::BasicBlock::replacePhiUsesWith</a></div><div class="ttdeci">void replacePhiUsesWith(BasicBlock *Old, BasicBlock *New)</div><div class="ttdoc">Update all phi nodes in this basic block to refer to basic block New instead of basic block Old.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00487">BasicBlock.cpp:487</a></div></div>
<div class="ttc" id="aVerifier_8h_html"><div class="ttname"><a href="Verifier_8h.html">Verifier.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a592bdd7731b14ff4ff5d646f6f399900"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">llvm::ScalarEvolution::forgetLoop</a></div><div class="ttdeci">void forgetLoop(const Loop *L)</div><div class="ttdoc">This method should be called by the client when it has changed a loop in a way that may effect Scalar...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08463">ScalarEvolution.cpp:8463</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_af6314c51a3cc5a619beb697246177bf0"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">llvm::SCEVAddRecExpr::getLoop</a></div><div class="ttdeci">const Loop * getLoop() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00342">ScalarEvolutionExpressions.h:342</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html_ab73bfd7dc4d5a446db965380e340810e"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html#ab73bfd7dc4d5a446db965380e340810e">llvm::DomTreeNodeBase::getLevel</a></div><div class="ttdeci">unsigned getLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00091">GenericDomTree.h:91</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ab0ff669b12c20c07137705c38872ec63"><div class="ttname"><a href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02750">Instructions.h:2750</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a7cea07afaa9cb9cb11334832b90eaf0a"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a7cea07afaa9cb9cb11334832b90eaf0a">llvm::LoopBase::isInvalid</a></div><div class="ttdeci">bool isInvalid() const</div><div class="ttdoc">Return true if this loop is no longer valid.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00232">LoopInfo.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html">llvm::SCEVAddRecExpr</a></div><div class="ttdoc">This node represents a polynomial recurrence on the trip count of the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00330">ScalarEvolutionExpressions.h:330</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_ad491e953f7f6ef6129f2dfcc51a4b3da"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#ad491e953f7f6ef6129f2dfcc51a4b3da">llvm::LoopInfoBase::rbegin</a></div><div class="ttdeci">reverse_iterator rbegin() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00969">LoopInfo.h:969</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6d8769a72303e2b06ef63129cb231855"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">llvm::ScalarEvolution::isSCEVable</a></div><div class="ttdeci">bool isSCEVable(Type *Ty) const</div><div class="ttdoc">Test if values of the given type are analyzable within the SCEV framework.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04420">ScalarEvolution.cpp:4420</a></div></div>
<div class="ttc" id="aPPCCTRLoopsVerify_8cpp_html_a593cc2f204f7b2edc16ee222c37c3196"><div class="ttname"><a href="PPCCTRLoopsVerify_8cpp.html#a593cc2f204f7b2edc16ee222c37c3196">verify</a></div><div class="ttdeci">ppc ctr loops verify</div><div class="ttdef"><b>Definition:</b> <a href="PPCCTRLoopsVerify_8cpp_source.html#l00076">PPCCTRLoopsVerify.cpp:76</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_a99bce8ce3073cdc43397fb851d80e81f"><div class="ttname"><a href="LoopFuse_8cpp.html#a99bce8ce3073cdc43397fb851d80e81f">FusionDependenceAnalysis</a></div><div class="ttdeci">static cl::opt&lt; FusionDependenceAnalysisChoice &gt; FusionDependenceAnalysis(&quot;loop-fusion-dependence-analysis&quot;, cl::desc(&quot;Which dependence analysis should loop fusion use?&quot;), cl::values(clEnumValN(FUSION_DEPENDENCE_ANALYSIS_SCEV, &quot;scev&quot;, &quot;Use the scalar evolution interface&quot;), clEnumValN(FUSION_DEPENDENCE_ANALYSIS_DA, &quot;da&quot;, &quot;Use the dependence analysis interface&quot;), clEnumValN(FUSION_DEPENDENCE_ANALYSIS_ALL, &quot;all&quot;, &quot;Use all available analyses&quot;)), cl::Hidden, cl::init(FUSION_DEPENDENCE_ANALYSIS_ALL))</div></div>
<div class="ttc" id="anamespacellvm_html_a0083a69883e0f97e111dbff064c60f42"><div class="ttname"><a href="namespacellvm.html#a0083a69883e0f97e111dbff064c60f42">llvm::simplifyLoop</a></div><div class="ttdeci">bool simplifyLoop(Loop *L, DominatorTree *DT, LoopInfo *LI, ScalarEvolution *SE, AssumptionCache *AC, MemorySSAUpdater *MSSAU, bool PreserveLCSSA)</div><div class="ttdoc">Simplify each loop in a loop nest recursively.</div><div class="ttdef"><b>Definition:</b> <a href="LoopSimplify_8cpp_source.html#l00708">LoopSimplify.cpp:708</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00614">SmallVector.h:614</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78bac1aa7b798ba11d2e497d5cce6ce6d3dc"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78bac1aa7b798ba11d2e497d5cce6ce6d3dc">llvm::CmpInst::ICMP_SGE</a></div><div class="ttdeci">@ ICMP_SGE</div><div class="ttdoc">signed greater or equal</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00746">InstrTypes.h:746</a></div></div>
<div class="ttc" id="aScalarEvolutionExpressions_8h_html"><div class="ttname"><a href="ScalarEvolutionExpressions_8h.html">ScalarEvolutionExpressions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeAnalysis_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeAnalysis.html">llvm::DominatorTreeAnalysis</a></div><div class="ttdoc">Analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00279">Dominators.h:279</a></div></div>
<div class="ttc" id="aclassllvm_1_1DependenceInfo_html_a49197b24cced248bed2d2c89c641a6dd"><div class="ttname"><a href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">llvm::DependenceInfo::depends</a></div><div class="ttdeci">std::unique_ptr&lt; Dependence &gt; depends(Instruction *Src, Instruction *Dst, bool PossiblyLoopIndependent)</div><div class="ttdoc">depends - Tests for a dependence between the Src and Dst instructions.</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8cpp_source.html#l03590">DependenceAnalysis.cpp:3590</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a4b3bd736cc047e31bab2291e2b1d4767"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a4b3bd736cc047e31bab2291e2b1d4767">llvm::LoopInfoBase::rend</a></div><div class="ttdeci">reverse_iterator rend() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00970">LoopInfo.h:970</a></div></div>
<div class="ttc" id="aRustDemangle_8cpp_html_a103d8cfe62c1651cd70e181746f8a840"><div class="ttname"><a href="RustDemangle_8cpp.html#a103d8cfe62c1651cd70e181746f8a840">isValid</a></div><div class="ttdeci">static bool isValid(const char C)</div><div class="ttdoc">Returns true if C is a valid mangled character: &lt;0-9a-zA-Z_&gt;.</div><div class="ttdef"><b>Definition:</b> <a href="RustDemangle_8cpp_source.html#l00184">RustDemangle.cpp:184</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a1f08f2925fec05b265e540d29066b9c8"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a1f08f2925fec05b265e540d29066b9c8">llvm::DominatorTreeBase::verify</a></div><div class="ttdeci">bool verify(VerificationLevel VL=VerificationLevel::Full) const</div><div class="ttdoc">verify - checks if the tree is correct.</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00819">GenericDomTree.h:819</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_ab2ce98edbf00ac5582eba4ec2630b50b"><div class="ttname"><a href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50b">FusionDependenceAnalysisChoice</a></div><div class="ttdeci">FusionDependenceAnalysisChoice</div><div class="ttdef"><b>Definition:</b> <a href="LoopFuse_8cpp_source.html#l00108">LoopFuse.cpp:108</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a83d8036930a033b196409ced5c9409e5"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a83d8036930a033b196409ced5c9409e5">llvm::LoopInfoBase::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00971">LoopInfo.h:971</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6b0ac1fa4f05de76413c5e0ca6334035"><div class="ttname"><a href="namespacellvm.html#a6b0ac1fa4f05de76413c5e0ca6334035">llvm::reverse</a></div><div class="ttdeci">auto reverse(ContainerTy &amp;&amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00484">STLExtras.h:484</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="anamespacellvm_html_aee44336886a06f3c1b8c35c701ba8316"><div class="ttname"><a href="namespacellvm.html#aee44336886a06f3c1b8c35c701ba8316">llvm::getLoadStorePointerOperand</a></div><div class="ttdeci">const Value * getLoadStorePointerOperand(const Value *V)</div><div class="ttdoc">A helper function that returns the pointer operand of a load or store instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05363">Instructions.h:5363</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1UnreachableInst_html"><div class="ttname"><a href="classllvm_1_1UnreachableInst.html">llvm::UnreachableInst</a></div><div class="ttdoc">This function has undefined behavior.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l04773">Instructions.h:4773</a></div></div>
<div class="ttc" id="aclassllvm_1_1PostDominatorTreeAnalysis_html"><div class="ttname"><a href="classllvm_1_1PostDominatorTreeAnalysis.html">llvm::PostDominatorTreeAnalysis</a></div><div class="ttdoc">Analysis pass which computes a PostDominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="PostDominators_8h_source.html#l00047">PostDominators.h:47</a></div></div>
<div class="ttc" id="aDependenceAnalysis_8h_html"><div class="ttname"><a href="DependenceAnalysis_8h.html">DependenceAnalysis.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_adffe8dd96d1c957f04909ca9c2cd79ba"><div class="ttname"><a href="namespacellvm.html#adffe8dd96d1c957f04909ca9c2cd79ba">llvm::isSafeToMoveBefore</a></div><div class="ttdeci">bool isSafeToMoveBefore(Instruction &amp;I, Instruction &amp;InsertPoint, DominatorTree &amp;DT, const PostDominatorTree *PDT=nullptr, DependenceInfo *DI=nullptr, bool CheckForEntireBlock=false)</div><div class="ttdoc">Return true if I can be safely moved before InsertPoint.</div><div class="ttdef"><b>Definition:</b> <a href="CodeMoverUtils_8cpp_source.html#l00312">CodeMoverUtils.cpp:312</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a94bf09763773a48bc03a0461fb572a0c"><div class="ttname"><a href="classllvm_1_1Loop.html#a94bf09763773a48bc03a0461fb572a0c">llvm::Loop::isRotatedForm</a></div><div class="ttdeci">bool isRotatedForm() const</div><div class="ttdoc">Return true if the loop is in rotated form.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00810">LoopInfo.h:810</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a22d9bcbd44563106d7217f3bd9a4039e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a22d9bcbd44563106d7217f3bd9a4039e">llvm::ScalarEvolution::getBackedgeTakenCount</a></div><div class="ttdeci">const SCEV * getBackedgeTakenCount(const Loop *L, ExitCountKind Kind=Exact)</div><div class="ttdoc">If the specified loop has a predictable backedge-taken count, return it, otherwise return a SCEVCould...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08331">ScalarEvolution.cpp:8331</a></div></div>
<div class="ttc" id="aLoopFuse_8cpp_html_ab2ce98edbf00ac5582eba4ec2630b50ba88a2ef6139ee028e3fa8addb323b3917"><div class="ttname"><a href="LoopFuse_8cpp.html#ab2ce98edbf00ac5582eba4ec2630b50ba88a2ef6139ee028e3fa8addb323b3917">FUSION_DEPENDENCE_ANALYSIS_DA</a></div><div class="ttdeci">@ FUSION_DEPENDENCE_ANALYSIS_DA</div><div class="ttdef"><b>Definition:</b> <a href="LoopFuse_8cpp_source.html#l00110">LoopFuse.cpp:110</a></div></div>
<div class="ttc" id="aLoopPeel_8h_html"><div class="ttname"><a href="LoopPeel_8h.html">LoopPeel.h</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitterAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">llvm::OptimizationRemarkEmitterAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00164">OptimizationRemarkEmitter.h:164</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a21d6ee82eed29080d911dbb548a8bb68"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a21d6ee82eed29080d911dbb548a8bb68">llvm::ScalarEvolution::getSCEVAtScope</a></div><div class="ttdeci">const SCEV * getSCEVAtScope(const SCEV *S, const Loop *L)</div><div class="ttdoc">Return a SCEV expression for the specified value at the specified scope in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l09735">ScalarEvolution.cpp:9735</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a7e4be8b16fbd68c9045a388904044e01"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03218">Instructions.h:3218</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad97f2e60cf22f15e0cf617af52309031"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03232">Instructions.h:3232</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_a7eec28400b00678b1fb2b5f55ef7ac1b"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#a7eec28400b00678b1fb2b5f55ef7ac1b">llvm::SCEVAddRecExpr::getStepRecurrence</a></div><div class="ttdeci">const SCEV * getStepRecurrence(ScalarEvolution &amp;SE) const</div><div class="ttdoc">Constructs and returns the recurrence indicating how much this expression steps by.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00348">ScalarEvolutionExpressions.h:348</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopAnalysis_html"><div class="ttname"><a href="classllvm_1_1LoopAnalysis.html">llvm::LoopAnalysis</a></div><div class="ttdoc">Analysis pass that exposes the LoopInfo for a function.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01268">LoopInfo.h:1268</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a71c91cbbfc1c0ecf9a69e10ccf739bd7"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a71c91cbbfc1c0ecf9a69e10ccf739bd7">llvm::DominatorTreeBase&lt; BasicBlock, false &gt;::Delete</a></div><div class="ttdeci">static constexpr UpdateKind Delete</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00259">GenericDomTree.h:259</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:31:45 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
