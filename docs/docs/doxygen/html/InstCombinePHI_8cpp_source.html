<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/InstCombine/InstCombinePHI.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_99567d9c0c7f3685f25b19ecc341a865.html">InstCombine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">InstCombinePHI.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="InstCombinePHI_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- InstCombinePHI.cpp -------------------------------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements the visitPHINode function.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstCombineInternal_8h.html">InstCombineInternal.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstructionSimplify_8h.html">llvm/Analysis/InstructionSimplify.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstCombiner_8h.html">llvm/Transforms/InstCombine/InstCombiner.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="InstCombinePHI_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   28</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;instcombine&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<a class="code" href="InstCombinePHI_8cpp.html#ac278b4fd2017bfc63c0e8fe5488f7da3">MaxNumPhis</a>(<span class="stringliteral">&quot;instcombine-max-num-phis&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(512),</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;           <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Maximum number phis to handle in intptr/ptrint folding&quot;</span>));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumPHIsOfInsertValues,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;          <span class="stringliteral">&quot;Number of phi-of-insertvalue turned into insertvalue-of-phis&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumPHIsOfExtractValues,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;          <span class="stringliteral">&quot;Number of phi-of-extractvalue turned into extractvalue-of-phi&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumPHICSEs, <span class="stringliteral">&quot;Number of PHI&#39;s that got CSE&#39;d&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/// The PHI arguments will be folded into a single operation with a PHI node</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/// as input. The debug location of the single operation will be the merged</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// locations of the original PHI node arguments.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#ad6c837ffd3a1932f53de13120ad1551a">   43</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classllvm_1_1InstCombinerImpl.html#ad6c837ffd3a1932f53de13120ad1551a">InstCombinerImpl::PHIArgMergedDebugLoc</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keyword">auto</span> *FirstInst = cast&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(FirstInst-&gt;getDebugLoc());</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// We do not expect a CallInst here, otherwise, N-way merging of DebugLoc</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// will be inefficient.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!isa&lt;CallInst&gt;(Inst));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(V);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a7279ed8b15d2a6dc8d246a7de2e08604">applyMergedLocation</a>(Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc());</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// Replace Integer typed PHI PN if the PHI&#39;s value is used as a pointer value.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// If there is an existing pointer typed PHI that produces the same value as PN,</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// replace PN and the IntToPtr operation with it. Otherwise, synthesize a new</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// PHI node:</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// Case-1:</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// bb1:</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//     int_init = PtrToInt(ptr_init)</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//     br label %bb2</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// bb2:</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//    int_val = PHI([int_init, %bb1], [int_val_inc, %bb2]</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//    ptr_val = PHI([ptr_init, %bb1], [ptr_val_inc, %bb2]</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//    ptr_val2 = IntToPtr(int_val)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//    use(ptr_val2)</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//    ptr_val_inc = ...</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//    inc_val_inc = PtrToInt(ptr_val_inc)</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// ==&gt;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// bb1:</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//     br label %bb2</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">// bb2:</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//    ptr_val = PHI([ptr_init, %bb1], [ptr_val_inc, %bb2]</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//    use(ptr_val)</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//    ptr_val_inc = ...</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// Case-2:</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// bb1:</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//    int_ptr = BitCast(ptr_ptr)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//    int_init = Load(int_ptr)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//    br label %bb2</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">// bb2:</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//    int_val = PHI([int_init, %bb1], [int_val_inc, %bb2]</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//    ptr_val2 = IntToPtr(int_val)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//    use(ptr_val2)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//    ptr_val_inc = ...</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//    inc_val_inc = PtrToInt(ptr_val_inc)</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// ==&gt;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">// bb1:</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//    ptr_init = Load(ptr_ptr)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//    br label %bb2</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// bb2:</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//    ptr_val = PHI([ptr_init, %bb1], [ptr_val_inc, %bb2]</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//    use(ptr_val)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//    ptr_val_inc = ...</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//    ...</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#aab1473644ffe7926032a4e01ed4bad78">  106</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1InstCombinerImpl.html#aab1473644ffe7926032a4e01ed4bad78">InstCombinerImpl::foldIntegerTypedPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (!PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">if</span> (!PN.<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>())</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">auto</span> *IntToPtr = dyn_cast&lt;IntToPtrInst&gt;(PN.<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (!IntToPtr)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// Check if the pointer is actually used as pointer:</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keyword">auto</span> HasPointerUse = [](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IIP) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : IIP-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LoadI = dyn_cast&lt;LoadInst&gt;(U)) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = LoadI-&gt;getPointerOperand();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(U)) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *GI = dyn_cast&lt;GetElementPtrInst&gt;(U)) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = GI-&gt;getPointerOperand();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> &amp;&amp; <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> == IIP)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  };</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (!HasPointerUse(IntToPtr))</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSizeInBits(IntToPtr-&gt;getAddressSpace()) !=</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(IntToPtr-&gt;getOperand(0)-&gt;getType()))</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> AvailablePtrVals;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// First look backward:</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PI = dyn_cast&lt;PtrToIntInst&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      AvailablePtrVals.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(PI-&gt;getOperand(0));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// Next look forward:</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ArgIntToPtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>-&gt;users()) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">if</span> (isa&lt;IntToPtrInst&gt;(U) &amp;&amp; U-&gt;getType() == IntToPtr-&gt;getType() &amp;&amp;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          (DT.dominates(cast&lt;Instruction&gt;(U), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) ||</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;           cast&lt;Instruction&gt;(U)-&gt;getParent() == <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        ArgIntToPtr = U;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (ArgIntToPtr) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      AvailablePtrVals.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(ArgIntToPtr);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// If Arg is defined by a PHI, allow it. This will also create</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// more opportunities iteratively.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>)) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      AvailablePtrVals.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// For a single use integer load:</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">auto</span> *LoadI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!LoadI)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (!LoadI-&gt;hasOneUse())</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Push the integer typed Load instruction into the available</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// value set, and fix it up later when the pointer typed PHI</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// is synthesized.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    AvailablePtrVals.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(LoadI);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// Now search for a matching PHI</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AvailablePtrVals.size() == PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>() &amp;&amp;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;         <span class="stringliteral">&quot;Not enough available ptr typed incoming values&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *MatchingPtrPHI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">unsigned</span> NumPhis = 0;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PtrPHI : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;phis()) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// FIXME: consider handling this in AggressiveInstCombine</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (NumPhis++ &gt; <a class="code" href="InstCombinePHI_8cpp.html#ac278b4fd2017bfc63c0e8fe5488f7da3">MaxNumPhis</a>)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (&amp;PtrPHI == &amp;PN || PtrPHI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != IntToPtr-&gt;getType())</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), AvailablePtrVals),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;               [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;BlockAndValue) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                 BasicBlock *BB = std::get&lt;0&gt;(BlockAndValue);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                 Value *V = std::get&lt;1&gt;(BlockAndValue);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                 return PtrPHI.getIncomingValueForBlock(BB) != V;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;               }))</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    MatchingPtrPHI = &amp;PtrPHI;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span> (MatchingPtrPHI) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MatchingPtrPHI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == IntToPtr-&gt;getType() &amp;&amp;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;           <span class="stringliteral">&quot;Phi&#39;s Type does not match with IntToPtr&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// Explicitly replace the inttoptr (rather than inserting a ptrtoint) here,</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// to make sure another transform can&#39;t undo it in the meantime.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    replaceInstUsesWith(*IntToPtr, MatchingPtrPHI);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    eraseInstFromFunction(*IntToPtr);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    eraseInstFromFunction(PN);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// If it requires a conversion for every PHI operand, do not do it.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(AvailablePtrVals, [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">return</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != IntToPtr-&gt;getType()) || isa&lt;IntToPtrInst&gt;(V);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      }))</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// If any of the operand that requires casting is a terminator</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// instruction, do not do it. Similarly, do not do the transform if the value</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// is PHI in a block with no insertion point, for example, a catchswitch</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// block, since we will not be able to insert a cast after the PHI.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(AvailablePtrVals, [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == IntToPtr-&gt;getType())</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keyword">auto</span> *Inst = dyn_cast&lt;Instruction&gt;(V);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a> (!Inst)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (Inst-&gt;isTerminator())</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = Inst-&gt;getParent();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a> (isa&lt;PHINode&gt;(Inst) &amp;&amp; <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getFirstInsertionPt() == <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end())</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      }))</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPtrPHI = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      IntToPtr-&gt;getType(), PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(), PN.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.ptr&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  InsertNewInstBefore(NewPtrPHI, PN);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Value *, Instruction *&gt;</a> Casts;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), AvailablePtrVals)) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">auto</span> *IncomingBB = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">auto</span> *IncomingVal = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (IncomingVal-&gt;getType() == IntToPtr-&gt;getType()) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      NewPtrPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(IncomingVal, IncomingBB);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LoadI = dyn_cast&lt;LoadInst&gt;(IncomingVal);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((isa&lt;PHINode&gt;(IncomingVal) ||</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            IncomingVal-&gt;getType()-&gt;isPointerTy() ||</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            (LoadI &amp;&amp; LoadI-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>())) &amp;&amp;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;           <span class="stringliteral">&quot;Can not replace LoadInst with multiple uses&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// Need to insert a BitCast.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// For an integer Load instruction with a single use, the load + IntToPtr</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// cast will be simplified into a pointer load:</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// %v = load i64, i64* %a.ip, align 8</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// %v.cast = inttoptr i64 %v to float **</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// ==&gt;</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// %v.ptrp = bitcast i64 * %a.ip to float **</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// %v.cast = load float *, float ** %v.ptrp, align 8</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *&amp;CI = Casts[IncomingVal];</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (!CI) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      CI = <a class="code" href="classllvm_1_1CastInst.html#a31d2885660f654b31d8741726c3ea8d9">CastInst::CreateBitOrPointerCast</a>(IncomingVal, IntToPtr-&gt;getType(),</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                            IncomingVal-&gt;getName() + <span class="stringliteral">&quot;.ptr&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *IncomingI = dyn_cast&lt;Instruction&gt;(IncomingVal)) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> InsertPos(IncomingI);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        InsertPos++;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = IncomingI-&gt;getParent();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(IncomingI))</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          InsertPos = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getFirstInsertionPt();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InsertPos != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end() &amp;&amp; <span class="stringliteral">&quot;should have checked above&quot;</span>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        InsertNewInstBefore(CI, *InsertPos);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keyword">auto</span> *InsertBB = &amp;IncomingBB-&gt;getParent()-&gt;getEntryBlock();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        InsertNewInstBefore(CI, *InsertBB-&gt;getFirstInsertionPt());</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    NewPtrPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(CI, IncomingBB);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// Explicitly replace the inttoptr (rather than inserting a ptrtoint) here,</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// to make sure another transform can&#39;t undo it in the meantime.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  replaceInstUsesWith(*IntToPtr, NewPtrPHI);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  eraseInstFromFunction(*IntToPtr);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  eraseInstFromFunction(PN);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">// Remove RoundTrip IntToPtr/PtrToInt Cast on PHI-Operand and</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">// fold Phi-operand to bitcast.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#abd122b6678d6a8f14b6ab6bc18863b27">  307</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#abd122b6678d6a8f14b6ab6bc18863b27">InstCombinerImpl::foldPHIArgIntToPtrToPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// convert ptr2int ( phi[ int2ptr(ptr2int(x))] ) --&gt; ptr2int ( phi [ x ] )</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// Make sure all uses of phi are ptr2int.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(PN.<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>(), [](<a class="code" href="classllvm_1_1User.html">User</a> *U) { return isa&lt;PtrToIntInst&gt;(U); }))</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// Iterating over all operands to check presence of target pointers for</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// optimization.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">bool</span> OperandWithRoundTripCast = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> OpNum = 0; OpNum != PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); ++OpNum) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *NewOp =</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            simplifyIntToPtrRoundTripCast(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(OpNum))) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      PN.<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(OpNum, NewOp);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      OperandWithRoundTripCast = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">if</span> (!OperandWithRoundTripCast)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">return</span> &amp;PN;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/// If we have something like phi [insertvalue(a,b,0), insertvalue(c,d,0)],</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/// turn this into a phi[a,c] and phi[b,d] and a single insertvalue.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#a29028fb86efd0ff0ea01f243f47684fc">  331</a></span>&#160;<a class="code" href="classllvm_1_1InstCombinerImpl.html#a29028fb86efd0ff0ea01f243f47684fc">InstCombinerImpl::foldPHIArgInsertValueInstructionIntoPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keyword">auto</span> *FirstIVI = cast&lt;InsertValueInst&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// Scan to see if all operands are `insertvalue`&#39;s with the same indicies,</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// and all have a single use.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;InsertValueInst&gt;(V);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasOneUser() || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIndices() != FirstIVI-&gt;getIndices())</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// For each operand of an `insertvalue`</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  std::array&lt;PHINode *, 2&gt; NewOperands;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> OpIdx : {0, 1}) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">auto</span> *&amp;NewOperand = NewOperands[OpIdx];</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// Create a new PHI node to receive the values the operand has in each</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// incoming basic block.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    NewOperand = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        FirstIVI-&gt;getOperand(OpIdx)-&gt;getType(), PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        FirstIVI-&gt;getOperand(OpIdx)-&gt;getName() + <span class="stringliteral">&quot;.pn&quot;</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// And populate each operand&#39;s PHI with said values.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      NewOperand-&gt;addIncoming(</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          cast&lt;InsertValueInst&gt;(std::get&lt;1&gt;(Incoming))-&gt;getOperand(OpIdx),</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          std::get&lt;0&gt;(Incoming));</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    InsertNewInstBefore(NewOperand, PN);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// And finally, create `insertvalue` over the newly-formed PHI nodes.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keyword">auto</span> *NewIVI = <a class="code" href="classllvm_1_1InsertValueInst.html#a40315c7d4fb418dd3c967898ee070f40">InsertValueInst::Create</a>(NewOperands[0], NewOperands[1],</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                         FirstIVI-&gt;getIndices(), PN.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  PHIArgMergedDebugLoc(NewIVI, PN);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  ++NumPHIsOfInsertValues;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">return</span> NewIVI;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/// If we have something like phi [extractvalue(a,0), extractvalue(b,0)],</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">/// turn this into a phi[a,b] and a single extractvalue.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *</div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#af4dbcb044eda11161781dfbf3f007f04">  371</a></span>&#160;<a class="code" href="classllvm_1_1InstCombinerImpl.html#af4dbcb044eda11161781dfbf3f007f04">InstCombinerImpl::foldPHIArgExtractValueInstructionIntoPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keyword">auto</span> *FirstEVI = cast&lt;ExtractValueInst&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// Scan to see if all operands are `extractvalue`&#39;s with the same indicies,</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// and all have a single use.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;ExtractValueInst&gt;(V);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasOneUser() || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIndices() != FirstEVI-&gt;getIndices() ||</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getAggregateOperand()-&gt;getType() !=</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            FirstEVI-&gt;getAggregateOperand()-&gt;getType())</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// Create a new PHI node to receive the values the aggregate operand has</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// in each incoming basic block.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keyword">auto</span> *NewAggregateOperand = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      FirstEVI-&gt;getAggregateOperand()-&gt;getType(), PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      FirstEVI-&gt;getAggregateOperand()-&gt;getName() + <span class="stringliteral">&quot;.pn&quot;</span>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// And populate the PHI with said values.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    NewAggregateOperand-&gt;addIncoming(</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        cast&lt;ExtractValueInst&gt;(std::get&lt;1&gt;(Incoming))-&gt;getAggregateOperand(),</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        std::get&lt;0&gt;(Incoming));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  InsertNewInstBefore(NewAggregateOperand, PN);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// And finally, create `extractvalue` over the newly-formed PHI nodes.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keyword">auto</span> *NewEVI = <a class="code" href="classllvm_1_1ExtractValueInst.html#a1cccf41f6be0351ccceed2c6447ff04a">ExtractValueInst::Create</a>(NewAggregateOperand,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                          FirstEVI-&gt;getIndices(), PN.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  PHIArgMergedDebugLoc(NewEVI, PN);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  ++NumPHIsOfExtractValues;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">return</span> NewEVI;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/// If we have something like phi [add (a,b), add(a,c)] and if a/b/c and the</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/// adds all have a single user, turn this into a phi and a single binop.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#a4df124d92129ffa8748086388a420b73">  407</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#a4df124d92129ffa8748086388a420b73">InstCombinerImpl::foldPHIArgBinOpIntoPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FirstInst = cast&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;BinaryOperator&gt;(FirstInst) || isa&lt;CmpInst&gt;(FirstInst));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">unsigned</span> Opc = FirstInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *LHSVal = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RHSVal = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *LHSType = LHSVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *RHSType = RHSVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">// Scan to see if all operands are the same opcode, and all have one user.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() != Opc || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasOneUser() ||</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// Verify type of the LHS matches so we don&#39;t fold cmp&#39;s of different</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">// types.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0)-&gt;getType() != LHSType ||</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1)-&gt;getType() != RHSType)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// If they are CmpInst instructions, check their predicates</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *CI = dyn_cast&lt;CmpInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> (CI-&gt;getPredicate() != cast&lt;CmpInst&gt;(FirstInst)-&gt;getPredicate())</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// Keep track of which operand needs a phi node.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0) != LHSVal) LHSVal = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1) != RHSVal) RHSVal = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// If both LHS and RHS would need a PHI, don&#39;t do this transformation,</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// because it would increase the number of PHIs entering the block,</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">// which leads to higher register pressure. This is especially</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// bad when the PHIs are in the header of a loop.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">if</span> (!LHSVal &amp;&amp; !RHSVal)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// Otherwise, this is safe to transform!</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *InLHS = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *InRHS = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewLHS = <span class="keyword">nullptr</span>, *NewRHS = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (!LHSVal) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    NewLHS = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(LHSType, PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                             FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.pn&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    NewLHS-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(InLHS, PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0));</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    InsertNewInstBefore(NewLHS, PN);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    LHSVal = NewLHS;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">if</span> (!RHSVal) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    NewRHS = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(RHSType, PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                             FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1)-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.pn&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    NewRHS-&gt;addIncoming(InRHS, PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    InsertNewInstBefore(NewRHS, PN);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    RHSVal = NewRHS;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// Add all operands to the new PHIs.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordflow">if</span> (NewLHS || NewRHS) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(<a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InBB = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InInst = cast&lt;Instruction&gt;(InVal);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">if</span> (NewLHS) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *NewInLHS = InInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        NewLHS-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewInLHS, InBB);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keywordflow">if</span> (NewRHS) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *NewInRHS = InInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        NewRHS-&gt;addIncoming(NewInRHS, InBB);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *CIOp = dyn_cast&lt;CmpInst&gt;(FirstInst)) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *NewCI = <a class="code" href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">CmpInst::Create</a>(CIOp-&gt;getOpcode(), CIOp-&gt;getPredicate(),</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                     LHSVal, RHSVal);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    PHIArgMergedDebugLoc(NewCI, PN);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">return</span> NewCI;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BinOp = cast&lt;BinaryOperator&gt;(FirstInst);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *NewBinOp =</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(BinOp-&gt;<a class="code" href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>(), LHSVal, RHSVal);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  NewBinOp-&gt;<a class="code" href="classllvm_1_1Instruction.html#a3e6d2896c39a84cfa6c47f34cdc584ff">copyIRFlags</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    NewBinOp-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ea9acbe7fd20332ea6ccdb0183d6395">andIRFlags</a>(V);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  PHIArgMergedDebugLoc(NewBinOp, PN);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">return</span> NewBinOp;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;}</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#acc9feb478a72bb822133b6eec00bef9f">  502</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#acc9feb478a72bb822133b6eec00bef9f">InstCombinerImpl::foldPHIArgGEPIntoPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *FirstInst =cast&lt;GetElementPtrInst&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value*, 16&gt;</a> FixedOperands(FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(),</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                        FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>());</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// This is true if all GEP bases are allocas and if all indices into them are</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">// constants.</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordtype">bool</span> AllBasePointersAreAllocas = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// We don&#39;t want to replace this phi if the replacement would require</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// more than one phi, which leads to higher register pressure. This is</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// especially bad when the PHIs are in the header of a loop.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordtype">bool</span> NeededPhi = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordtype">bool</span> AllInBounds = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// Scan to see if all operands are the same opcode, and all have one user.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(V);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> || !<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;hasOneUser() ||</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getSourceElementType() != FirstInst-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#a565374c44dbf08e54528a87448e10df5">getSourceElementType</a>() ||</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getNumOperands() != FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">getNumOperands</a>())</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    AllInBounds &amp;= <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;isInBounds();</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// Keep track of whether or not all GEPs are of alloca pointers.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (AllBasePointersAreAllocas &amp;&amp;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        (!isa&lt;AllocaInst&gt;(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(0)) ||</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         !<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;hasAllConstantIndices()))</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      AllBasePointersAreAllocas = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// Compare the operand lists.</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">getNumOperands</a>(); <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">if</span> (FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>) == <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>))</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="comment">// Don&#39;t merge two GEPs when two operands differ (introducing phi nodes)</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="comment">// if one of the PHIs has a constant for the index.  The index may be</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="comment">// substantially cheaper to compute for the constants, so making it a</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="comment">// variable index could pessimize the path.  This also handles the case</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="comment">// for struct indices, which must always be constant.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">if</span> (isa&lt;ConstantInt&gt;(FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)) ||</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          isa&lt;ConstantInt&gt;(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)))</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">if</span> (FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() !=</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)-&gt;getType())</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="comment">// If we already needed a PHI for an earlier operand, and another operand</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="comment">// also requires a PHI, we&#39;d be introducing more PHIs than we&#39;re</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="comment">// eliminating, which increases register pressure on entry to the PHI&#39;s</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="comment">// block.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordflow">if</span> (NeededPhi)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      FixedOperands[<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>] = <span class="keyword">nullptr</span>; <span class="comment">// Needs a PHI.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      NeededPhi = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// If all of the base pointers of the PHI&#39;d GEPs are from allocas, don&#39;t</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// bother doing this transformation.  At best, this will just save a bit of</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// offset calculation, but all the predecessors will have to materialize the</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">// stack address into a register anyway.  We&#39;d actually rather *clone* the</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// load up into the predecessors so that we have a load of a gep of an alloca,</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// which can usually all be folded into the load.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> (AllBasePointersAreAllocas)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// Otherwise, this is safe to transform.  Insert PHI nodes for each operand</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// that is variable.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode*, 16&gt;</a> OperandPhis(FixedOperands.size());</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordtype">bool</span> HasAnyPHIs = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = FixedOperands.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span> (FixedOperands[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>])</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">continue</span>; <span class="comment">// operand doesn&#39;t need a phi.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *FirstOp = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN =</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(FirstOp-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>, FirstOp-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.pn&quot;</span>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    InsertNewInstBefore(NewPN, PN);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(FirstOp, PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0));</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    OperandPhis[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = NewPN;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    FixedOperands[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = NewPN;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    HasAnyPHIs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// Add all operands to the new PHIs.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">if</span> (HasAnyPHIs) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(<a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InBB = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *InGEP = cast&lt;GetElementPtrInst&gt;(InVal);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = OperandPhis.size(); <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OpPhi = OperandPhis[<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>])</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          OpPhi-&gt;addIncoming(InGEP-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>), InBB);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = FixedOperands[0];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *NewGEP =</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <a class="code" href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">GetElementPtrInst::Create</a>(FirstInst-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#a565374c44dbf08e54528a87448e10df5">getSourceElementType</a>(), <a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef</a>(FixedOperands).slice(1));</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (AllInBounds) NewGEP-&gt;<a class="code" href="classllvm_1_1GetElementPtrInst.html#a837e9f272fd070a5f8fc79c07a951106">setIsInBounds</a>();</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  PHIArgMergedDebugLoc(NewGEP, PN);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">return</span> NewGEP;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">/// Return true if we know that it is safe to sink the load out of the block</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">/// that defines it. This means that it must be obvious the value of the load is</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">/// not changed from the point of the load to the end of the block it is in.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">/// Finally, it is safe, but not profitable, to sink a load targeting a</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">/// non-address-taken alloca.  Doing so will cause us to not promote the alloca</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">/// to a register.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="InstCombinePHI_8cpp.html#a6b46ea77082dda0b24b9fea490ae8fc8">  621</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombinePHI_8cpp.html#a6b46ea77082dda0b24b9fea490ae8fc8">isSafeAndProfitableToSinkLoad</a>(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *L) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> BBI = L-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = L-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">for</span> (++BBI; BBI != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++BBI)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">if</span> (BBI-&gt;mayWriteToMemory()) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="comment">// Calls that only access inaccessible memory do not block sinking the</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="comment">// load.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(BBI))</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">if</span> (CB-&gt;onlyAccessesInaccessibleMemory())</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// Check for non-address taken alloca.  If not address-taken already, it isn&#39;t</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// profitable to do this xform.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI = dyn_cast&lt;AllocaInst&gt;(L-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0))) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">bool</span> IsAddressTaken = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : AI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(U)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(U)) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="comment">// If storing TO the alloca, then the address isn&#39;t taken.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getOperand(1) == AI) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      IsAddressTaken = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span> (!IsAddressTaken &amp;&amp; AI-&gt;isStaticAlloca())</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// If this load is a load from a GEP with a constant offset from an alloca,</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="comment">// then we don&#39;t want to sink it.  In its present form, it will be</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// load [constant stack offset].  Sinking it will cause us to have to</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="comment">// materialize the stack addresses in each predecessor in a register only to</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">// do a shared load from register in the successor.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(L-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)))</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI = dyn_cast&lt;AllocaInst&gt;(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(0)))</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">if</span> (AI-&gt;isStaticAlloca() &amp;&amp; <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;hasAllConstantIndices())</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;}</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#aa8a186c50cdf60ac11ae1d0b884d468d">  665</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#aa8a186c50cdf60ac11ae1d0b884d468d">InstCombinerImpl::foldPHIArgLoadIntoPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *FirstLI = cast&lt;LoadInst&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// Can&#39;t forward swifterror through a phi.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">if</span> (FirstLI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a98897a3d01f6a4d7f10a5ac8fe862c82">isSwiftError</a>())</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">// FIXME: This is overconservative; this transform is allowed in some cases</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// for atomic operations.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">if</span> (FirstLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">isAtomic</a>())</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// When processing loads, we need to propagate two bits of information to the</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">// sunk load: whether it is volatile, and what its alignment is.</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a> = FirstLI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> LoadAlignment = FirstLI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> LoadAddrSpace = FirstLI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// We can&#39;t sink the load if the loaded value could be modified between the</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">// load and the PHI.</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">if</span> (FirstLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0) ||</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      !<a class="code" href="InstCombinePHI_8cpp.html#a6b46ea77082dda0b24b9fea490ae8fc8">isSafeAndProfitableToSinkLoad</a>(FirstLI))</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// If the PHI is of volatile loads and the load block has multiple</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// successors, sinking it would remove a load of the volatile value from</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// the path through the other successor.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a> &amp;&amp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      FirstLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>() != 1)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(<a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InBB = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(InVal);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (!LI || !LI-&gt;<a class="code" href="classllvm_1_1Value.html#a2e987c6af902aad6baa39bd5b7ef322c">hasOneUser</a>() || LI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">isAtomic</a>())</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// Make sure all arguments are the same type of operation.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>() != <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a> ||</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">getPointerAddressSpace</a>() != LoadAddrSpace)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// Can&#39;t forward swifterror through a phi.</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a98897a3d01f6a4d7f10a5ac8fe862c82">isSwiftError</a>())</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// We can&#39;t sink the load if the loaded value could be modified between</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// the load and the PHI.</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != InBB || !<a class="code" href="InstCombinePHI_8cpp.html#a6b46ea77082dda0b24b9fea490ae8fc8">isSafeAndProfitableToSinkLoad</a>(LI))</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    LoadAlignment = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(LoadAlignment, LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>());</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// If the PHI is of volatile loads and the load block has multiple</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// successors, sinking it would remove a load of the volatile value from</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">// the path through the other successor.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a> &amp;&amp; LI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>() != 1)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">// Okay, they are all the same operation.  Create a new PHI node of the</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">// correct type, and PHI together all of the LHS&#39;s of the instructions.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(FirstLI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                   PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                   PN.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()+<span class="stringliteral">&quot;.in&quot;</span>);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = FirstLI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(InVal, PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0));</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *NewLI =</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keyword">new</span> <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>(FirstLI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), NewPN, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a>, LoadAlignment);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordtype">unsigned</span> KnownIDs[] = {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    LLVMContext::MD_tbaa,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    LLVMContext::MD_range,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    LLVMContext::MD_invariant_load,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    LLVMContext::MD_alias_scope,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    LLVMContext::MD_noalias,</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    LLVMContext::MD_nonnull,</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    LLVMContext::MD_align,</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    LLVMContext::MD_dereferenceable,</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    LLVMContext::MD_dereferenceable_or_null,</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    LLVMContext::MD_access_group,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    LLVMContext::MD_noundef,</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  };</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a> : KnownIDs)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    NewLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>, FirstLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae22f493ba8327ce92e87d3b96bce7017">getMetadata</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>));</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// Add all operands to the new PHI and combine TBAA metadata.</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(<a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = cast&lt;LoadInst&gt;(V);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="namespacellvm.html#a929b458d1b5080256b6f6c8141bbdfea">combineMetadata</a>(NewLI, LI, KnownIDs, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewInVal = LI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span> (NewInVal != InVal)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      InVal = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewInVal, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">if</span> (InVal) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// The new PHI unions all of the same values together.  This is really</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// common, so we handle it intelligently here for compile-time speed.</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    NewLI-&gt;<a class="code" href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(0, InVal);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keyword">delete</span> NewPN;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    InsertNewInstBefore(NewPN, PN);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// If this was a volatile load that we are merging, make sure to loop through</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">// and mark all the input loads as non-volatile.  If we don&#39;t do this, we will</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="comment">// insert a new volatile load and the old ones will not be deletable.</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a>)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *IncValue : PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      cast&lt;LoadInst&gt;(IncValue)-&gt;setVolatile(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  PHIArgMergedDebugLoc(NewLI, PN);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">return</span> NewLI;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;}</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">/// TODO: This function could handle other cast types, but then it might</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">/// require special-casing a cast from the &#39;i1&#39; type. See the comment in</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">/// FoldPHIArgOpIntoPHI() about pessimizing illegal integer types.</span></div>
<div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#a84318f31145b081677697de64401238a">  789</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#a84318f31145b081677697de64401238a">InstCombinerImpl::foldPHIArgZextsIntoPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;Phi) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="comment">// We cannot create a new instruction after the PHI if the terminator is an</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// EHPad because there is no valid insertion point.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI = Phi.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>())</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (TI-&gt;isEHPad())</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">// Early exit for the common case of a phi with two operands. These are</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="comment">// handled elsewhere. See the comment below where we check the count of zexts</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// and constants for more details.</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordtype">unsigned</span> NumIncomingValues = Phi.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">if</span> (NumIncomingValues &lt; 3)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// Find the narrower type specified by the first zext.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *NarrowType = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : Phi.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Zext = dyn_cast&lt;ZExtInst&gt;(V)) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      NarrowType = Zext-&gt;getSrcTy();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">if</span> (!NarrowType)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">// Walk the phi operands checking that we only have zexts or constants that</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// we can shrink for free. Store the new operands for the new phi.</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> NewIncoming;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordtype">unsigned</span> NumZexts = 0;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordtype">unsigned</span> NumConsts = 0;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : Phi.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Zext = dyn_cast&lt;ZExtInst&gt;(V)) {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">// All zexts must be identical and have one user.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">if</span> (Zext-&gt;getSrcTy() != NarrowType || !Zext-&gt;hasOneUser())</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      NewIncoming.push_back(Zext-&gt;getOperand(0));</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      NumZexts++;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;Constant&gt;(V)) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="comment">// Make sure that constants can fit in the new type.</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *Trunc = <a class="code" href="classllvm_1_1ConstantExpr.html#af238147cf5453729781a0fcc7322e1c6">ConstantExpr::getTrunc</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, NarrowType);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantExpr.html#a58d6359cee16e5da66861058836dcca9">ConstantExpr::getZExt</a>(Trunc, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) != <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      NewIncoming.push_back(Trunc);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      NumConsts++;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="comment">// If it&#39;s not a cast or a constant, bail out.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">// The more common cases of a phi with no constant operands or just one</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">// variable operand are handled by FoldPHIArgOpIntoPHI() and foldOpIntoPhi()</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// respectively. foldOpIntoPhi() wants to do the opposite transform that is</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">// performed here. It tries to replicate a cast in the phi operand&#39;s basic</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// block to expose other folding opportunities. Thus, InstCombine will</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// infinite loop without this check.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordflow">if</span> (NumConsts == 0 || NumZexts &lt; 2)</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// All incoming values are zexts or constants that are safe to truncate.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">// Create a new phi node of the narrow type, phi together all of the new</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="comment">// operands, and zext the result back to the original type.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPhi = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(NarrowType, NumIncomingValues,</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                    Phi.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.shrunk&quot;</span>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != NumIncomingValues; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewIncoming[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], Phi.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  InsertNewInstBefore(NewPhi, Phi);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#a3f02c25d97697736a70f0808ddab1eed">CastInst::CreateZExtOrBitCast</a>(NewPhi, Phi.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">/// If all operands to a PHI node are the same &quot;unary&quot; operator and they all are</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">/// only used by the PHI, PHI together their inputs, and do the operation once,</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">/// to the result of the PHI.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#a7a3e32edb65b5b1c216d4454f14df21c">  863</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#a7a3e32edb65b5b1c216d4454f14df21c">InstCombinerImpl::foldPHIArgOpIntoPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="comment">// We cannot create a new instruction after the PHI if the terminator is an</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="comment">// EHPad because there is no valid insertion point.</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI = PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>())</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (TI-&gt;isEHPad())</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *FirstInst = cast&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">if</span> (isa&lt;GetElementPtrInst&gt;(FirstInst))</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">return</span> foldPHIArgGEPIntoPHI(PN);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(FirstInst))</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">return</span> foldPHIArgLoadIntoPHI(PN);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">if</span> (isa&lt;InsertValueInst&gt;(FirstInst))</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">return</span> foldPHIArgInsertValueInstructionIntoPHI(PN);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ExtractValueInst&gt;(FirstInst))</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">return</span> foldPHIArgExtractValueInstructionIntoPHI(PN);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="comment">// Scan the instruction, looking for input operations that can be folded away.</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">// If all input operands to the phi are the same instruction (e.g. a cast from</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">// the same type or &quot;+42&quot;) we can pull the operation through the PHI, reducing</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="comment">// code size and simplifying code.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *ConstantOp = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CastSrcTy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keywordflow">if</span> (isa&lt;CastInst&gt;(FirstInst)) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    CastSrcTy = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">// Be careful about transforming integer PHIs.  We don&#39;t want to pessimize</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// the code by turning an i32 into an i1293.</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span> (PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp; CastSrcTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">if</span> (!shouldChangeType(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), CastSrcTy))</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;BinaryOperator&gt;(FirstInst) || isa&lt;CmpInst&gt;(FirstInst)) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// Can fold binop, compare or shift here if the RHS is a constant,</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// otherwise call FoldPHIArgBinOpIntoPHI.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    ConstantOp = dyn_cast&lt;Constant&gt;(FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (!ConstantOp)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keywordflow">return</span> foldPHIArgBinOpIntoPHI(PN);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;  <span class="comment">// Cannot fold this operation.</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// Check to see if all arguments are the same operation.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;hasOneUser() || !<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isSameOperationAs(FirstInst))</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">if</span> (CastSrcTy) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0)-&gt;getType() != CastSrcTy)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// Cast operation must match.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1) != ConstantOp) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">// Okay, they are all the same operation.  Create a new PHI node of the</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">// correct type, and PHI together all of the LHS&#39;s of the instructions.</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                   PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                   PN.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()+<span class="stringliteral">&quot;.in&quot;</span>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = FirstInst-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(InVal, PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(0));</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// Add all operands to the new PHI.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(<a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewInVal = cast&lt;Instruction&gt;(V)-&gt;getOperand(0);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (NewInVal != InVal)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      InVal = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewInVal, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *PhiVal;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordflow">if</span> (InVal) {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// The new PHI unions all of the same values together.  This is really</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">// common, so we handle it intelligently here for compile-time speed.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    PhiVal = InVal;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keyword">delete</span> NewPN;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    InsertNewInstBefore(NewPN, PN);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    PhiVal = NewPN;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// Insert and return the new operation.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *FirstCI = dyn_cast&lt;CastInst&gt;(FirstInst)) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="classllvm_1_1CastInst.html">CastInst</a> *NewCI = <a class="code" href="classllvm_1_1CastInst.html#a643fe5a9e7042f032dae78109c2b1e72">CastInst::Create</a>(FirstCI-&gt;getOpcode(), PhiVal,</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                       PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    PHIArgMergedDebugLoc(NewCI, PN);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">return</span> NewCI;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1BinaryOperator.html">BinaryOperator</a> *BinOp = dyn_cast&lt;BinaryOperator&gt;(FirstInst)) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    BinOp = <a class="code" href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">BinaryOperator::Create</a>(BinOp-&gt;getOpcode(), PhiVal, ConstantOp);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    BinOp-&gt;copyIRFlags(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0));</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()))</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      BinOp-&gt;andIRFlags(V);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    PHIArgMergedDebugLoc(BinOp, PN);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">return</span> BinOp;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *CIOp = cast&lt;CmpInst&gt;(FirstInst);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *NewCI = <a class="code" href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">CmpInst::Create</a>(CIOp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#af4abe8e5b55577f35032131a6264fe4f">getOpcode</a>(), CIOp-&gt;<a class="code" href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">getPredicate</a>(),</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                   PhiVal, ConstantOp);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  PHIArgMergedDebugLoc(NewCI, PN);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="keywordflow">return</span> NewCI;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;}</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">/// Return true if this PHI node is only used by a PHI node cycle that is dead.</span></div>
<div class="line"><a name="l00977"></a><span class="lineno"><a class="line" href="InstCombinePHI_8cpp.html#a6456ccbd595a3334c6101e465a78c3c7">  977</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombinePHI_8cpp.html#a6456ccbd595a3334c6101e465a78c3c7">isDeadPHICycle</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN,</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                           <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;PHINode *&gt;</a> &amp;PotentiallyDeadPHIs) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">if</span> (PN-&gt;<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>()) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">if</span> (!PN-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="comment">// Remember this node, and if we find the cycle, return.</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordflow">if</span> (!PotentiallyDeadPHIs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(PN).second)</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="comment">// Don&#39;t scan crazily complex things.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="keywordflow">if</span> (PotentiallyDeadPHIs.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>() == 16)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PU = dyn_cast&lt;PHINode&gt;(PN-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>()))</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="InstCombinePHI_8cpp.html#a6456ccbd595a3334c6101e465a78c3c7">isDeadPHICycle</a>(PU, PotentiallyDeadPHIs);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;}</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">/// Return true if this phi node is always equal to NonPhiInVal.</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">/// This happens with mutually cyclic phi nodes like:</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">///   z = some value; x = phi (y, z); y = phi (x, z)</span></div>
<div class="line"><a name="l00999"></a><span class="lineno"><a class="line" href="InstCombinePHI_8cpp.html#ae5dd05cfcd95f839d90b4c935f36cec3">  999</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="InstCombinePHI_8cpp.html#ae5dd05cfcd95f839d90b4c935f36cec3">PHIsEqualValue</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN, <a class="code" href="classllvm_1_1Value.html">Value</a> *NonPhiInVal,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                           <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;PHINode*&gt;</a> &amp;ValueEqualPHIs) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// See if we already saw this PHI node.</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="keywordflow">if</span> (!ValueEqualPHIs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(PN).second)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">// Don&#39;t scan crazily complex things.</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">if</span> (ValueEqualPHIs.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>() == 16)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="comment">// Scan the operands to see if they are either phi nodes or are equal to</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="comment">// the value.</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>()) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OpPN = dyn_cast&lt;PHINode&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="InstCombinePHI_8cpp.html#ae5dd05cfcd95f839d90b4c935f36cec3">PHIsEqualValue</a>(OpPN, NonPhiInVal, ValueEqualPHIs))</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> != NonPhiInVal)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">/// Return an existing non-zero constant if this phi node has one, otherwise</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">/// return constant 1.</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="InstCombinePHI_8cpp.html#aa2a90d2c1ecab0b3271d574a3e480509"> 1024</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="InstCombinePHI_8cpp.html#aa2a90d2c1ecab0b3271d574a3e480509">getAnyNonZeroConstInt</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;IntegerType&gt;(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp; <span class="stringliteral">&quot;Expect only integer type phi&quot;</span>);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V : PN.<a class="code" href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>())</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *ConstVA = dyn_cast&lt;ConstantInt&gt;(V))</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">if</span> (!ConstVA-&gt;isZero())</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordflow">return</span> ConstVA;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(cast&lt;IntegerType&gt;(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), 1);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="keyword">struct </span>PHIUsageRecord {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordtype">unsigned</span> PHIId;     <span class="comment">// The ID # of the PHI (something determinstic to sort on)</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;     <span class="comment">// The amount shifted.</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst;  <span class="comment">// The trunc instruction.</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  PHIUsageRecord(<span class="keywordtype">unsigned</span> Pn, <span class="keywordtype">unsigned</span> Sh, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1User.html">User</a>)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      : PHIId(Pn), <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>(Sh), Inst(<a class="code" href="classllvm_1_1User.html">User</a>) {}</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">operator&lt;</a>(<span class="keyword">const</span> PHIUsageRecord &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">if</span> (PHIId &lt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.PHIId) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">if</span> (PHIId &gt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.PHIId) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> &lt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Shift) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> &gt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Shift) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">return</span> Inst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>() &lt;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;           <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Inst-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>();</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;};</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="keyword">struct </span>LoweredPHIRecord {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN;        <span class="comment">// The PHI that was lowered.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>;     <span class="comment">// The amount shifted.</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>;     <span class="comment">// The width extracted.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  LoweredPHIRecord(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi, <span class="keywordtype">unsigned</span> Sh, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      : PN(Phi), <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>(Sh), <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>(Ty-&gt;getPrimitiveSizeInBits()) {}</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">// Ctor form used by DenseMap.</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  LoweredPHIRecord(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Phi, <span class="keywordtype">unsigned</span> Sh) : PN(Phi), <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>(Sh), <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a>(0) {}</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;};</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l01067"></a><span class="lineno"><a class="line" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html"> 1067</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structllvm_1_1DenseMapInfo.html">DenseMapInfo</a>&lt;LoweredPHIRecord&gt; {</div>
<div class="line"><a name="l01068"></a><span class="lineno"><a class="line" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#ac14fca6703560f602ebe8d4a49b165ce"> 1068</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">inline</span> LoweredPHIRecord <a class="code" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#ac14fca6703560f602ebe8d4a49b165ce">getEmptyKey</a>() {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">return</span> LoweredPHIRecord(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div>
<div class="line"><a name="l01071"></a><span class="lineno"><a class="line" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#ad01126ce2b0450d630993b4211934894"> 1071</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">inline</span> LoweredPHIRecord <a class="code" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#ad01126ce2b0450d630993b4211934894">getTombstoneKey</a>() {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordflow">return</span> LoweredPHIRecord(<span class="keyword">nullptr</span>, 1);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div>
<div class="line"><a name="l01074"></a><span class="lineno"><a class="line" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#a7b37a8b69d44fe5ed9f17c311bcdc6ea"> 1074</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#a7b37a8b69d44fe5ed9f17c311bcdc6ea">getHashValue</a>(<span class="keyword">const</span> LoweredPHIRecord &amp;Val) {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1DenseMapInfo.html">DenseMapInfo&lt;PHINode*&gt;::getHashValue</a>(Val.PN) ^ (Val.Shift&gt;&gt;3) ^</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;             (Val.Width&gt;&gt;3);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    }</div>
<div class="line"><a name="l01078"></a><span class="lineno"><a class="line" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#a6bd456c628d8cee23d1640040d98e70f"> 1078</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#a6bd456c628d8cee23d1640040d98e70f">isEqual</a>(<span class="keyword">const</span> LoweredPHIRecord &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                        <span class="keyword">const</span> LoweredPHIRecord &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.PN == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.PN &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.Shift == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Shift &amp;&amp;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;             <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.Width == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.Width;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  };</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;} <span class="comment">// namespace llvm</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">/// This is an integer PHI and we know that it has an illegal type: see if it is</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">/// only used by trunc or trunc(lshr) operations. If so, we split the PHI into</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">/// the various pieces being extracted. This sort of thing is introduced when</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">/// SROA promotes an aggregate to large integer values.</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">/// TODO: The user of the trunc may be an bitcast to float/double/vector or an</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">/// inttoptr.  We should produce new PHIs in the right type.</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#ac8cb4401526dd424f15566e4501792f7"> 1095</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#ac8cb4401526dd424f15566e4501792f7">InstCombinerImpl::SliceUpIllegalIntegerPHI</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;FirstPhi) {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">// PHIUsers - Keep track of all of the truncated values extracted from a set</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">// of PHIs, along with their offset.  These are the things we want to rewrite.</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHIUsageRecord, 16&gt;</a> PHIUsers;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// PHIs are often mutually cyclic, so we keep track of a whole set of PHI</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">// nodes which are extracted from. PHIsToSlice is a set we use to avoid</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">// revisiting PHIs, PHIsInspected is a ordered list of PHIs that we need to</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">// check the uses of (to ensure they are all extracts).</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode*, 8&gt;</a> PHIsToSlice;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;PHINode*, 8&gt;</a> PHIsInspected;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  PHIsToSlice.push_back(&amp;FirstPhi);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  PHIsInspected.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;FirstPhi);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> PHIId = 0; PHIId != PHIsToSlice.size(); ++PHIId) {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = PHIsToSlice[PHIId];</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">// Scan the input list of the PHI.  If any input is an invoke, and if the</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">// input is defined in the predecessor, then we won&#39;t be split the critical</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">// edge which is required to insert a truncate.  Because of this, we have to</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// bail out.</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *V = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <a class="code" href="classllvm_1_1InvokeInst.html">InvokeInst</a> *II = dyn_cast&lt;InvokeInst&gt;(V);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">if</span> (!II)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">if</span> (II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="comment">// If we have a phi, and if it&#39;s directly in the predecessor, then we have</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="comment">// a critical edge where we need to put the truncate.  Since we can&#39;t</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="comment">// split the edge in instcombine, we have to bail out.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">// If the incoming value is a PHI node before a catchswitch, we cannot</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">// extract the value within that BB because we cannot insert any non-PHI</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="comment">// instructions in the BB.</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Pred : PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>())</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordflow">if</span> (Pred-&gt;getFirstInsertionPt() == Pred-&gt;end())</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : PN-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UserI = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="comment">// If the user is a PHI, inspect its uses recursively.</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *UserPN = dyn_cast&lt;PHINode&gt;(UserI)) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keywordflow">if</span> (PHIsInspected.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(UserPN).second)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;          PHIsToSlice.push_back(UserPN);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="comment">// Truncates are always ok.</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keywordflow">if</span> (isa&lt;TruncInst&gt;(UserI)) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        PHIUsers.push_back(PHIUsageRecord(PHIId, 0, UserI));</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="comment">// Otherwise it must be a lshr which can only be used by one trunc.</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keywordflow">if</span> (UserI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() != Instruction::LShr ||</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          !UserI-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() || !isa&lt;TruncInst&gt;(UserI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>()) ||</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          !isa&lt;ConstantInt&gt;(UserI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1)))</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="comment">// Bail on out of range shifts.</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordtype">unsigned</span> SizeInBits = UserI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>();</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="keywordflow">if</span> (cast&lt;ConstantInt&gt;(UserI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))-&gt;getValue().uge(SizeInBits))</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a> = cast&lt;ConstantInt&gt;(UserI-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1))-&gt;getZExtValue();</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      PHIUsers.push_back(PHIUsageRecord(PHIId, <a class="code" href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a>, UserI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>()));</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="comment">// If we have no users, they must be all self uses, just nuke the PHI.</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">if</span> (PHIUsers.empty())</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">return</span> replaceInstUsesWith(FirstPhi, <a class="code" href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(FirstPhi.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="comment">// If this phi node is transformable, create new PHIs for all the pieces</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="comment">// extracted out of it.  First, sort the users by their offset and size.</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="namespacellvm.html#add1eb5637dd671428b6f138ed3db6428">array_pod_sort</a>(PHIUsers.begin(), PHIUsers.end());</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SLICING UP PHI: &quot;</span> &lt;&lt; FirstPhi &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != PHIsToSlice.size(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;AND USER PHI #&quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; *PHIsToSlice[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="comment">// PredValues - This is a temporary used when rewriting PHI nodes.  It is</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">// hoisted out here to avoid construction/destruction thrashing.</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;BasicBlock*, Value*&gt;</a> PredValues;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">// ExtractedVals - Each new PHI we introduce is saved here so we don&#39;t</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">// introduce redundant PHIs.</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;LoweredPHIRecord, PHINode*&gt;</a> ExtractedVals;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> UserI = 0, UserE = PHIUsers.size(); UserI != UserE; ++UserI) {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordtype">unsigned</span> PHIId = PHIUsers[UserI].PHIId;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = PHIsToSlice[PHIId];</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordtype">unsigned</span> Offset = PHIUsers[UserI].Shift;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = PHIUsers[UserI].Inst-&gt;getType();</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *EltPHI;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">// If we&#39;ve already lowered a user like this, reuse the previously lowered</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="comment">// value.</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">if</span> ((EltPHI = ExtractedVals[LoweredPHIRecord(PN, Offset, Ty)]) == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="comment">// Otherwise, Create the new PHI node for this user.</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      EltPHI = <a class="code" href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">PHINode::Create</a>(Ty, PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                               PN-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()+<span class="stringliteral">&quot;.off&quot;</span>+<a class="code" href="classllvm_1_1Twine.html">Twine</a>(Offset), PN);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EltPHI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != PN-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() &amp;&amp;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;             <span class="stringliteral">&quot;Truncate didn&#39;t shrink phi?&quot;</span>);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> Incoming : <a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>(), PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred = std::get&lt;0&gt;(Incoming);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = std::get&lt;1&gt;(Incoming);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;PredVal = PredValues[Pred];</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">// If we already have a value for this predecessor, reuse it.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">if</span> (PredVal) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;          EltPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(PredVal, Pred);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="comment">// Handle the PHI self-reuse case.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keywordflow">if</span> (InVal == PN) {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;          PredVal = EltPHI;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;          EltPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(PredVal, Pred);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *InPHI = dyn_cast&lt;PHINode&gt;(PN)) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;          <span class="comment">// If the incoming value was a PHI, and if it was one of the PHIs we</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;          <span class="comment">// already rewrote it, just use the lowered value.</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Res = ExtractedVals[LoweredPHIRecord(InPHI, Offset, Ty)]) {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            PredVal = Res;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            EltPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(PredVal, Pred);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="comment">// Otherwise, do an extract in the predecessor.</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(Pred-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Res = InVal;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">if</span> (Offset)</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          Res = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLShr(</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;              Res, <a class="code" href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">ConstantInt::get</a>(InVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), Offset), <span class="stringliteral">&quot;extract&quot;</span>);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        Res = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateTrunc(Res, Ty, <span class="stringliteral">&quot;extract.t&quot;</span>);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        PredVal = Res;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        EltPHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(Res, Pred);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="comment">// If the incoming value was a PHI, and if it was one of the PHIs we are</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="comment">// rewriting, we will ultimately delete the code we inserted.  This</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="comment">// means we need to revisit that PHI to make sure we extract out the</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="comment">// needed piece.</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *OldInVal = dyn_cast&lt;PHINode&gt;(InVal))</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          <span class="keywordflow">if</span> (PHIsInspected.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(OldInVal)) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordtype">unsigned</span> RefPHIId =</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                <a class="code" href="namespacellvm.html#a086e9fbdb06276db7753101a08a63adf">find</a>(PHIsToSlice, OldInVal) - PHIsToSlice.begin();</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            PHIUsers.push_back(</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                PHIUsageRecord(RefPHIId, Offset, cast&lt;Instruction&gt;(Res)));</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            ++UserE;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;          }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      PredValues.<a class="code" href="classllvm_1_1DenseMapBase.html#adf4e7878fc0b3b8dcde545178564190d">clear</a>();</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Made element PHI for offset &quot;</span> &lt;&lt; Offset &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                        &lt;&lt; *EltPHI &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      ExtractedVals[LoweredPHIRecord(PN, Offset, Ty)] = EltPHI;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="comment">// Replace the use of this piece with the PHI node.</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    replaceInstUsesWith(*PHIUsers[UserI].Inst, EltPHI);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">// Replace all the remaining uses of the PHI nodes (self uses and the lshrs)</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="comment">// with poison.</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Poison = <a class="code" href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(FirstPhi.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">drop_begin</a>(PHIsToSlice))</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    replaceInstUsesWith(*<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, Poison);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordflow">return</span> replaceInstUsesWith(FirstPhi, Poison);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;}</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"><a class="line" href="InstCombinePHI_8cpp.html#af1686daf97b5e313b29e4fdf48cd11ac"> 1279</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="InstCombinePHI_8cpp.html#af1686daf97b5e313b29e4fdf48cd11ac">simplifyUsingControlFlow</a>(<a class="code" href="classllvm_1_1InstCombiner.html">InstCombiner</a> &amp;Self, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN,</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="comment">// Simplify the following patterns:</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="comment">//       if (cond)</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="comment">//       /       \</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">  //      ...      ...</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">//       \       /</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="comment">//    phi [true] [false]</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="comment">// and</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="comment">//        switch (cond)</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// case v1: /       \ case v2:</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="comment">//         ...      ...</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">//          \       /</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">//       phi [v1] [v2]</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">// Make sure all inputs are constants.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(PN.<a class="code" href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>(), [](<a class="code" href="classllvm_1_1Value.html">Value</a> *V) { return isa&lt;ConstantInt&gt;(V); }))</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">// Do not bother with unreachable instructions.</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">if</span> (!DT.<a class="code" href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">isReachableFromEntry</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="comment">// Determine which value the condition of the idom has for which successor.</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a> = PN.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>();</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keyword">auto</span> *IDom = DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">getNode</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#aa22cb3ff8c95bb05185acad8c569d4b6">getIDom</a>()-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#a6a15a030098342e06ea73e1241d614c9">getBlock</a>();</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;ConstantInt *, BasicBlock *, 8&gt;</a> SuccForValue;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;BasicBlock *, unsigned, 8&gt;</a> SuccCount;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="keyword">auto</span> AddSucc = [&amp;](<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ) {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    SuccForValue[<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>] = Succ;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    ++SuccCount[Succ];</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  };</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *BI = dyn_cast&lt;BranchInst&gt;(IDom-&gt;getTerminator())) {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">if</span> (BI-&gt;isUnconditional())</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160; </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = BI-&gt;getCondition();</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    AddSucc(<a class="code" href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">ConstantInt::getTrue</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>), BI-&gt;getSuccessor(0));</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    AddSucc(<a class="code" href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">ConstantInt::getFalse</a>(<a class="code" href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a>), BI-&gt;getSuccessor(1));</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;SwitchInst&gt;(IDom-&gt;getTerminator())) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition();</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    ++SuccCount[<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getDefaultDest()];</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Case : <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;cases())</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      AddSucc(Case.getCaseValue(), Case.getCaseSuccessor());</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>-&gt;getType() != PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">// Check that edges outgoing from the idom&#39;s terminators dominate respective</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">// inputs of the Phi.</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  std::optional&lt;bool&gt; Invert;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> Pair : <a class="code" href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">zip</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>(), PN.<a class="code" href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">blocks</a>())) {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keyword">auto</span> *Input = cast&lt;ConstantInt&gt;(std::get&lt;0&gt;(Pair));</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred = std::get&lt;1&gt;(Pair);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keyword">auto</span> IsCorrectInput = [&amp;](<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Input) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="comment">// The input needs to be dominated by the corresponding edge of the idom.</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="comment">// This edge cannot be a multi-edge, as that would imply that multiple</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="comment">// different condition values follow the same edge.</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keyword">auto</span> It = SuccForValue.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(Input);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">return</span> It != SuccForValue.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp; SuccCount[It-&gt;second] == 1 &amp;&amp;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;             DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(<a class="code" href="classllvm_1_1BasicBlockEdge.html">BasicBlockEdge</a>(IDom, It-&gt;second),</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                          <a class="code" href="classllvm_1_1BasicBlockEdge.html">BasicBlockEdge</a>(Pred, <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>));</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    };</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">// Depending on the constant, the condition may need to be inverted.</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordtype">bool</span> NeedsInvert;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordflow">if</span> (IsCorrectInput(Input))</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      NeedsInvert = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsCorrectInput(cast&lt;ConstantInt&gt;(<a class="code" href="classllvm_1_1ConstantExpr.html#a5b43a866f0fca605556f0f69f70c522a">ConstantExpr::getNot</a>(Input))))</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      NeedsInvert = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="comment">// Make sure the inversion requirement is always the same.</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span> (Invert &amp;&amp; *Invert != NeedsInvert)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    Invert = NeedsInvert;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="keywordflow">if</span> (!*Invert)</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="comment">// This Phi is actually opposite to branching condition of IDom. We invert</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="comment">// the condition that will potentially open up some opportunities for</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// sinking.</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keyword">auto</span> InsertPt = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getFirstInsertionPt();</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">if</span> (InsertPt != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end()) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    Self.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(&amp;*InsertPt);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">return</span> Self.<a class="code" href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">Builder</a>.<a class="code" href="classllvm_1_1IRBuilderBase.html#a4b2c1cc89c04d885ab3036597446f0cd">CreateNot</a>(<a class="code" href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;}</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">// PHINode simplification</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"><a class="line" href="classllvm_1_1InstCombinerImpl.html#a752efe4724ac3a97d07ee81d5f779c92"> 1380</a></span>&#160;<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="classllvm_1_1InstCombinerImpl.html#a752efe4724ac3a97d07ee81d5f779c92">InstCombinerImpl::visitPHINode</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">simplifyInstruction</a>(&amp;PN, SQ.getWithInstruction(&amp;PN)))</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">return</span> replaceInstUsesWith(PN, V);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160; </div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Result = foldPHIArgZextsIntoPHI(PN))</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">return</span> Result;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Result = foldPHIArgIntToPtrToPHI(PN))</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">return</span> Result;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="comment">// If all PHI operands are the same operation, pull them through the PHI,</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="comment">// reducing code size.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0)) &amp;&amp;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      isa&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(1)) &amp;&amp;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      cast&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0))-&gt;getOpcode() ==</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          cast&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(1))-&gt;getOpcode() &amp;&amp;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a2e987c6af902aad6baa39bd5b7ef322c">hasOneUser</a>())</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Result = foldPHIArgOpIntoPHI(PN))</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keywordflow">return</span> Result;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="comment">// If the incoming values are pointer casts of the same original value,</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="comment">// replace the phi with a single cast iff we can insert a non-PHI instruction.</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">if</span> (PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>() != PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IV0 = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(0);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *IV0Stripped = IV0-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>();</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">// Set to keep track of values known to be equal to IV0Stripped after</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// stripping pointer casts.</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Value *, 4&gt;</a> CheckedIVs;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    CheckedIVs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(IV0);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordflow">if</span> (IV0 != IV0Stripped &amp;&amp;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(PN.<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>(), [&amp;CheckedIVs, IV0Stripped](<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a>) {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          return !CheckedIVs.insert(IV).second ||</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                 IV0Stripped == IV-&gt;stripPointerCasts();</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        })) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">CastInst::CreatePointerCast</a>(IV0Stripped, PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="comment">// If this is a trivial cycle in the PHI node graph, remove it.  Basically, if</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="comment">// this PHI only has a single use (a PHI), and if that PHI only has one use (a</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="comment">// PHI)... break the cycle.</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="keywordflow">if</span> (PN.<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>()) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">if</span> (foldIntegerTypedPHI(PN))</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PHIUser = cast&lt;Instruction&gt;(PN.<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>());</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PU = dyn_cast&lt;PHINode&gt;(PHIUser)) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;PHINode*, 16&gt;</a> PotentiallyDeadPHIs;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      PotentiallyDeadPHIs.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;PN);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="InstCombinePHI_8cpp.html#a6456ccbd595a3334c6101e465a78c3c7">isDeadPHICycle</a>(PU, PotentiallyDeadPHIs))</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="keywordflow">return</span> replaceInstUsesWith(PN, <a class="code" href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// If this phi has a single use, and if that use just computes a value for</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">// the next iteration of a loop, delete the phi.  This occurs with unused</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// induction variables, e.g. &quot;for (int j = 0; ; ++j);&quot;.  Detecting this</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">// common case here is good because the only other things that catch this</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// are induction variable analysis (sometimes) and ADCE, which is only run</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// late.</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">if</span> (PHIUser-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() &amp;&amp;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        (isa&lt;BinaryOperator&gt;(PHIUser) || isa&lt;GetElementPtrInst&gt;(PHIUser)) &amp;&amp;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        PHIUser-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>() == &amp;PN) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">return</span> replaceInstUsesWith(PN, <a class="code" href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">// When a PHI is used only to be compared with zero, it is safe to replace</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// an incoming value proved as known nonzero with any non-zero constant.</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">// For example, in the code below, the incoming value %v can be replaced</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">// with any non-zero constant based on the fact that the PHI is only used to</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// be compared with zero and %v is a known non-zero value:</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">// %v = select %cond, 1, 2</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="comment">// %p = phi [%v, BB] ...</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="comment">//      icmp eq, %p, 0</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> = dyn_cast&lt;ICmpInst&gt;(PHIUser);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">// FIXME: To be simple, handle only integer type for now.</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> &amp;&amp; isa&lt;IntegerType&gt;(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp; <a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a>-&gt;<a class="code" href="classllvm_1_1CmpInst.html#a38d34fceda94c01af95b775632ba8299">isEquality</a>() &amp;&amp;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <a class="code" href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">match</a>(<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a>-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), <a class="code" href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">m_Zero</a>())) {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *NonZeroConst = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CtxI = PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *VA = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">isKnownNonZero</a>(VA, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, 0, &amp;AC, CtxI, &amp;DT)) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          <span class="keywordflow">if</span> (!NonZeroConst)</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            NonZeroConst = <a class="code" href="InstCombinePHI_8cpp.html#aa2a90d2c1ecab0b3271d574a3e480509">getAnyNonZeroConstInt</a>(PN);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;          <span class="keywordflow">if</span> (NonZeroConst != VA) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            replaceOperand(PN, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, NonZeroConst);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;          }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        }</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordflow">if</span> (MadeChange)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">return</span> &amp;PN;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    }</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="comment">// We sometimes end up with phi cycles that non-obviously end up being the</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">// same value, for example:</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="comment">//   z = some value; x = phi (y, z); y = phi (x, z)</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">// where the phi nodes don&#39;t necessarily need to be in the same block.  Do a</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// quick check to see if the PHI node only contains a single non-phi value, if</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="comment">// so, scan to see if the phi cycle is actually equal to that value.</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">unsigned</span> InValNo = 0, NumIncomingVals = PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>();</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">// Scan for the first non-phi operand.</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">while</span> (InValNo != NumIncomingVals &amp;&amp;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;           isa&lt;PHINode&gt;(PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(InValNo)))</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      ++InValNo;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordflow">if</span> (InValNo != NumIncomingVals) {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NonPhiInVal = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(InValNo);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="comment">// Scan the rest of the operands to see if there are any conflicts, if so</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="comment">// there is no need to recursively scan other phis.</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="keywordflow">for</span> (++InValNo; InValNo != NumIncomingVals; ++InValNo) {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *OpVal = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(InValNo);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="keywordflow">if</span> (OpVal != NonPhiInVal &amp;&amp; !isa&lt;PHINode&gt;(OpVal))</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="comment">// If we scanned over all operands, then we have one unique value plus</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="comment">// phi values.  Scan PHI nodes to see if they all merge in each other or</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="comment">// the value.</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordflow">if</span> (InValNo == NumIncomingVals) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;PHINode*, 16&gt;</a> ValueEqualPHIs;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="InstCombinePHI_8cpp.html#ae5dd05cfcd95f839d90b4c935f36cec3">PHIsEqualValue</a>(&amp;PN, NonPhiInVal, ValueEqualPHIs))</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;          <span class="keywordflow">return</span> replaceInstUsesWith(PN, NonPhiInVal);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">// If there are multiple PHIs, sort their operands so that they all list</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="comment">// the blocks in the same order. This will help identical PHIs be eliminated</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="comment">// by other passes. Other passes shouldn&#39;t depend on this for correctness</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="comment">// however.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *FirstPN = cast&lt;PHINode&gt;(PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keywordflow">if</span> (&amp;PN != FirstPN)</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = FirstPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BBA = PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BBB = FirstPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="keywordflow">if</span> (BBA != BBB) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *VA = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordtype">unsigned</span> J = PN.<a class="code" href="classllvm_1_1PHINode.html#ae9562b96f6f3fa41bd36538c080035ee">getBasicBlockIndex</a>(BBB);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1codeview.html#af3d64ff2173fb2f45fdc714699cad09fa236ce469d991c10b68c9e2872f684779">VB</a> = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(J);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        PN.<a class="code" href="classllvm_1_1PHINode.html#a5ba57877c55dfdbe6e3bbfdacd9ef8c1">setIncomingBlock</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BBB);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        PN.<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1codeview.html#af3d64ff2173fb2f45fdc714699cad09fa236ce469d991c10b68c9e2872f684779">VB</a>);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        PN.<a class="code" href="classllvm_1_1PHINode.html#a5ba57877c55dfdbe6e3bbfdacd9ef8c1">setIncomingBlock</a>(J, BBA);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        PN.<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(J, VA);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="comment">// NOTE: Instcombine normally would want us to &quot;return &amp;PN&quot; if we</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="comment">// modified any of the operands of an instruction.  However, since we</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="comment">// aren&#39;t adding or removing uses (just rearranging them) we don&#39;t do</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="comment">// this in this case.</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="comment">// Is there an identical PHI node in this basic block?</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;IdenticalPN : PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="comment">// Ignore the PHI node itself.</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">if</span> (&amp;IdenticalPN == &amp;PN)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">// Note that even though we&#39;ve just canonicalized this PHI, due to the</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// worklist visitation order, there are no guarantess that *every* PHI</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">// has been canonicalized, so we can&#39;t just compare operands ranges.</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">if</span> (!PN.<a class="code" href="classllvm_1_1Instruction.html#a69c17ef87a64dfcb3e5795b870cf69fa">isIdenticalToWhenDefined</a>(&amp;IdenticalPN))</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">// Just use that PHI instead then.</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    ++NumPHICSEs;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordflow">return</span> replaceInstUsesWith(PN, &amp;IdenticalPN);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="comment">// If this is an integer PHI and we know that it has an illegal type, see if</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">// it is only used by trunc or trunc(lshr) operations.  If so, we split the</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="comment">// PHI into the various pieces being extracted.  This sort of thing is</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="comment">// introduced when SROA promotes an aggregate to a single large integer type.</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="keywordflow">if</span> (PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      !<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isLegalInteger(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>()))</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Res = SliceUpIllegalIntegerPHI(PN))</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="keywordflow">return</span> Res;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="comment">// Ultimately, try to replace this Phi with a dominating condition.</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *V = <a class="code" href="InstCombinePHI_8cpp.html#af1686daf97b5e313b29e4fdf48cd11ac">simplifyUsingControlFlow</a>(*<span class="keyword">this</span>, PN, DT))</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="keywordflow">return</span> replaceInstUsesWith(PN, V);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_html_add1eb5637dd671428b6f138ed3db6428"><div class="ttname"><a href="namespacellvm.html#add1eb5637dd671428b6f138ed3db6428">llvm::array_pod_sort</a></div><div class="ttdeci">void array_pod_sort(IteratorTy Start, IteratorTy End)</div><div class="ttdoc">array_pod_sort - This sorts an array with the specified start and end extent.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01643">STLExtras.h:1643</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a837e9f272fd070a5f8fc79c07a951106"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a837e9f272fd070a5f8fc79c07a951106">llvm::GetElementPtrInst::setIsInBounds</a></div><div class="ttdeci">void setIsInBounds(bool b=true)</div><div class="ttdoc">Set or clear the inbounds flag on this GEP instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01938">Instructions.cpp:1938</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a3287172f2d13af086e6d66364e8c6de3"><div class="ttname"><a href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">llvm::Instruction::getNumSuccessors</a></div><div class="ttdeci">unsigned getNumSuccessors() const LLVM_READONLY</div><div class="ttdoc">Return the number of successors that this instruction has.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00823">Instruction.cpp:823</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_ace45cae6925c65e9d6916e09dd5b17cc"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#ace45cae6925c65e9d6916e09dd5b17cc">llvm::IRBuilderBase::SetInsertPoint</a></div><div class="ttdeci">void SetInsertPoint(BasicBlock *TheBB)</div><div class="ttdoc">This specifies that created instructions should be appended to the end of the specified block.</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00180">IRBuilder.h:180</a></div></div>
<div class="ttc" id="anamespacellvm_html_a929b458d1b5080256b6f6c8141bbdfea"><div class="ttname"><a href="namespacellvm.html#a929b458d1b5080256b6f6c8141bbdfea">llvm::combineMetadata</a></div><div class="ttdeci">void combineMetadata(Instruction *K, const Instruction *J, ArrayRef&lt; unsigned &gt; KnownIDs, bool DoesKMove)</div><div class="ttdoc">Combine the metadata of two instructions so that K can replace J.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02651">Local.cpp:2651</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="astructllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4_html_a7b37a8b69d44fe5ed9f17c311bcdc6ea"><div class="ttname"><a href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#a7b37a8b69d44fe5ed9f17c311bcdc6ea">llvm::DenseMapInfo&lt; LoweredPHIRecord &gt;::getHashValue</a></div><div class="ttdeci">static unsigned getHashValue(const LoweredPHIRecord &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01074">InstCombinePHI.cpp:1074</a></div></div>
<div class="ttc" id="anamespacellvm_html_a02981de53fb6ffd384d39addc4d25f37"><div class="ttname"><a href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a></div><div class="ttdeci">auto drop_begin(T &amp;&amp;RangeOrContainer, size_t N=1)</div><div class="ttdoc">Return a range covering RangeOrContainer with the first N elements excluded.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00386">STLExtras.h:386</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a5b43a866f0fca605556f0f69f70c522a"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a5b43a866f0fca605556f0f69f70c522a">llvm::ConstantExpr::getNot</a></div><div class="ttdeci">static Constant * getNot(Constant *C)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02651">Constants.cpp:2651</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a1f0ff79b64a40d383b891f1baba89c6b"><div class="ttname"><a href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">llvm::PHINode::incoming_values</a></div><div class="ttdeci">op_range incoming_values()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02784">Instructions.h:2784</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aInstCombiner_8h_html"><div class="ttname"><a href="InstCombiner_8h.html">InstCombiner.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a0b931781aa589c6ebe64a76c1447e5b2"><div class="ttname"><a href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">llvm::User::operands</a></div><div class="ttdeci">op_range operands()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00242">User.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aAMDGPURewriteUndefForPHI_8cpp_html_a2e83cb1bc3f5e8986cbd14575755a134"><div class="ttname"><a href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a></div><div class="ttdeci">Rewrite undef for PHI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPURewriteUndefForPHI_8cpp_source.html#l00101">AMDGPURewriteUndefForPHI.cpp:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_a4df124d92129ffa8748086388a420b73"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#a4df124d92129ffa8748086388a420b73">llvm::InstCombinerImpl::foldPHIArgBinOpIntoPHI</a></div><div class="ttdeci">Instruction * foldPHIArgBinOpIntoPHI(PHINode &amp;PN)</div><div class="ttdoc">If we have something like phi [add (a,b), add(a,c)] and if a/b/c and the adds all have a single user,...</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00407">InstCombinePHI.cpp:407</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3b996fbf8458aafffc86cb98a68d0a47"><div class="ttname"><a href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const</div><div class="ttdoc">True if this is an instance of PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00249">Type.h:249</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a58d6359cee16e5da66861058836dcca9"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a58d6359cee16e5da66861058836dcca9">llvm::ConstantExpr::getZExt</a></div><div class="ttdeci">static Constant * getZExt(Constant *C, Type *Ty, bool OnlyIfReduced=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02119">Constants.cpp:2119</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_af4dbcb044eda11161781dfbf3f007f04"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#af4dbcb044eda11161781dfbf3f007f04">llvm::InstCombinerImpl::foldPHIArgExtractValueInstructionIntoPHI</a></div><div class="ttdeci">Instruction * foldPHIArgExtractValueInstructionIntoPHI(PHINode &amp;PN)</div><div class="ttdoc">If we have something like phi [extractvalue(a,0), extractvalue(b,0)], turn this into a phi[a,...</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00371">InstCombinePHI.cpp:371</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html_ae1d331bc844ecb92bdeb0b706ae04396"><div class="ttname"><a href="classllvm_1_1InstCombiner.html#ae1d331bc844ecb92bdeb0b706ae04396">llvm::InstCombiner::Builder</a></div><div class="ttdeci">BuilderTy &amp; Builder</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00058">InstCombiner.h:58</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a69c17ef87a64dfcb3e5795b870cf69fa"><div class="ttname"><a href="classllvm_1_1Instruction.html#a69c17ef87a64dfcb3e5795b870cf69fa">llvm::Instruction::isIdenticalToWhenDefined</a></div><div class="ttdeci">bool isIdenticalToWhenDefined(const Instruction *I) const LLVM_READONLY</div><div class="ttdoc">This is like isIdenticalTo, except that it ignores the SubclassOptionalData flags,...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00557">Instruction.cpp:557</a></div></div>
<div class="ttc" id="aclassllvm_1_1InsertValueInst_html_a40315c7d4fb418dd3c967898ee070f40"><div class="ttname"><a href="classllvm_1_1InsertValueInst.html#a40315c7d4fb418dd3c967898ee070f40">llvm::InsertValueInst::Create</a></div><div class="ttdeci">static InsertValueInst * Create(Value *Agg, Value *Val, ArrayRef&lt; unsigned &gt; Idxs, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02605">Instructions.h:2605</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_a643fe5a9e7042f032dae78109c2b1e72"><div class="ttname"><a href="classllvm_1_1CastInst.html#a643fe5a9e7042f032dae78109c2b1e72">llvm::CastInst::Create</a></div><div class="ttdeci">static CastInst * Create(Instruction::CastOps, Value *S, Type *Ty, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Provides a way to construct any of the CastInst subclasses using an opcode instead of the subclass's ...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03354">Instructions.cpp:3354</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00880">DenseMap.h:880</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_acc9feb478a72bb822133b6eec00bef9f"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#acc9feb478a72bb822133b6eec00bef9f">llvm::InstCombinerImpl::foldPHIArgGEPIntoPHI</a></div><div class="ttdeci">Instruction * foldPHIArgGEPIntoPHI(PHINode &amp;PN)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00502">InstCombinePHI.cpp:502</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="anamespacellvm_html_a07256e6859fcb3b9d5eb02ecea9e9a38"><div class="ttname"><a href="namespacellvm.html#a07256e6859fcb3b9d5eb02ecea9e9a38">llvm::isKnownNonZero</a></div><div class="ttdeci">bool isKnownNonZero(const Value *V, const DataLayout &amp;DL, unsigned Depth=0, AssumptionCache *AC=nullptr, const Instruction *CxtI=nullptr, const DominatorTree *DT=nullptr, bool UseInstrInfo=true)</div><div class="ttdoc">Return true if the given value is known to be non-zero when defined.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00313">ValueTracking.cpp:313</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a8db36c82f32d6f6a4d35a00e55be03a8"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a8db36c82f32d6f6a4d35a00e55be03a8">Shift</a></div><div class="ttdeci">bool Shift</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00468">README.txt:468</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a38d34fceda94c01af95b775632ba8299"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a38d34fceda94c01af95b775632ba8299">llvm::CmpInst::isEquality</a></div><div class="ttdeci">static bool isEquality(Predicate pred)</div><div class="ttdoc">Determine if this is an equals/not equals predicate.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l04068">Instructions.cpp:4068</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlockEdge_html"><div class="ttname"><a href="classllvm_1_1BasicBlockEdge.html">llvm::BasicBlockEdge</a></div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00098">Dominators.h:98</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a4344e66fb61ea313a85a9e054124ac55"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">llvm::DominatorTreeBase::getNode</a></div><div class="ttdeci">DomTreeNodeBase&lt; NodeT &gt; * getNode(const NodeT *BB) const</div><div class="ttdoc">getNode - return the (Post)DominatorTree node for the specified basic block.</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00367">GenericDomTree.h:367</a></div></div>
<div class="ttc" id="aInstCombinePHI_8cpp_html_ae5dd05cfcd95f839d90b4c935f36cec3"><div class="ttname"><a href="InstCombinePHI_8cpp.html#ae5dd05cfcd95f839d90b4c935f36cec3">PHIsEqualValue</a></div><div class="ttdeci">static bool PHIsEqualValue(PHINode *PN, Value *NonPhiInVal, SmallPtrSetImpl&lt; PHINode * &gt; &amp;ValueEqualPHIs)</div><div class="ttdoc">Return true if this phi node is always equal to NonPhiInVal.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00999">InstCombinePHI.cpp:999</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a2e987c6af902aad6baa39bd5b7ef322c"><div class="ttname"><a href="classllvm_1_1Value.html#a2e987c6af902aad6baa39bd5b7ef322c">llvm::Value::hasOneUser</a></div><div class="ttdeci">bool hasOneUser() const</div><div class="ttdoc">Return true if there is exactly one user of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00156">Value.cpp:156</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_af4abe8e5b55577f35032131a6264fe4f"><div class="ttname"><a href="classllvm_1_1CmpInst.html#af4abe8e5b55577f35032131a6264fe4f">llvm::CmpInst::getOpcode</a></div><div class="ttdeci">OtherOps getOpcode() const</div><div class="ttdoc">Get the opcode casted to the right type.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00803">InstrTypes.h:803</a></div></div>
<div class="ttc" id="aSTLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html_aa22cb3ff8c95bb05185acad8c569d4b6"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html#aa22cb3ff8c95bb05185acad8c569d4b6">llvm::DomTreeNodeBase::getIDom</a></div><div class="ttdeci">DomTreeNodeBase * getIDom() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00090">GenericDomTree.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_af51c113a039c82f6870df5dc9666b5e3"><div class="ttname"><a href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">llvm::LoadInst::getAlign</a></div><div class="ttdeci">Align getAlign() const</div><div class="ttdoc">Return the alignment of the access that is being performed.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00220">Instructions.h:220</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a88cdefb709309eddc6e5daca0be6a7b4"><div class="ttname"><a href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">llvm::PHINode::setIncomingValue</a></div><div class="ttdeci">void setIncomingValue(unsigned i, Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02797">Instructions.h:2797</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_abd122b6678d6a8f14b6ab6bc18863b27"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#abd122b6678d6a8f14b6ab6bc18863b27">llvm::InstCombinerImpl::foldPHIArgIntToPtrToPHI</a></div><div class="ttdeci">Instruction * foldPHIArgIntToPtrToPHI(PHINode &amp;PN)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00307">InstCombinePHI.cpp:307</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a565374c44dbf08e54528a87448e10df5"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a565374c44dbf08e54528a87448e10df5">llvm::GetElementPtrInst::getSourceElementType</a></div><div class="ttdeci">Type * getSourceElementType() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01015">Instructions.h:1015</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a88c1c3dd33d232dc889a5d29c75b75f3"><div class="ttname"><a href="classllvm_1_1PHINode.html#a88c1c3dd33d232dc889a5d29c75b75f3">llvm::PHINode::blocks</a></div><div class="ttdeci">iterator_range&lt; const_block_iterator &gt; blocks() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02780">Instructions.h:2780</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9247a212ea89acc9573fa7e7f557eaba"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">llvm::Instruction::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdoc">Set the metadata of the specified kind to the specified node.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01455">Metadata.cpp:1455</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a98897a3d01f6a4d7f10a5ac8fe862c82"><div class="ttname"><a href="classllvm_1_1Value.html#a98897a3d01f6a4d7f10a5ac8fe862c82">llvm::Value::isSwiftError</a></div><div class="ttdeci">bool isSwiftError() const</div><div class="ttdoc">Return true if this value is a swifterror value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l01015">Value.cpp:1015</a></div></div>
<div class="ttc" id="astructllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4_html_ac14fca6703560f602ebe8d4a49b165ce"><div class="ttname"><a href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#ac14fca6703560f602ebe8d4a49b165ce">llvm::DenseMapInfo&lt; LoweredPHIRecord &gt;::getEmptyKey</a></div><div class="ttdeci">static LoweredPHIRecord getEmptyKey()</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01068">InstCombinePHI.cpp:1068</a></div></div>
<div class="ttc" id="aNVVMIntrRange_8cpp_html_afad351d7bf10ac0446b64e7827634e94"><div class="ttname"><a href="NVVMIntrRange_8cpp.html#afad351d7bf10ac0446b64e7827634e94">Context</a></div><div class="ttdeci">LLVMContext &amp; Context</div><div class="ttdef"><b>Definition:</b> <a href="NVVMIntrRange_8cpp_source.html#l00066">NVVMIntrRange.cpp:66</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="astructllvm_1_1DenseMapInfo_html"><div class="ttname"><a href="structllvm_1_1DenseMapInfo.html">llvm::DenseMapInfo</a></div><div class="ttdoc">An information struct used to provide DenseMap with the various necessary components for a given valu...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00034">APInt.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4e05d690df389b8b1477c90387b575f"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns a member of one of the enums like Instruction::Add.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00168">Instruction.h:168</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="aInstCombineInternal_8h_html"><div class="ttname"><a href="InstCombineInternal_8h.html">InstCombineInternal.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_a25d956d9e0beadd47ce4bc255dfa811d"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#a25d956d9e0beadd47ce4bc255dfa811d">llvm::PatternMatch::match</a></div><div class="ttdeci">bool match(Val *V, const Pattern &amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00049">PatternMatch.h:49</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a16c39eb6e60b42a40c399d8d65347bb6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const</div><div class="ttdoc">Return incoming value number x.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02794">Instructions.h:2794</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_ad6c837ffd3a1932f53de13120ad1551a"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#ad6c837ffd3a1932f53de13120ad1551a">llvm::InstCombinerImpl::PHIArgMergedDebugLoc</a></div><div class="ttdeci">void PHIArgMergedDebugLoc(Instruction *Inst, PHINode &amp;PN)</div><div class="ttdoc">Helper function for FoldPHIArgXIntoPHI() to set debug location for the folded operation.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00043">InstCombinePHI.cpp:43</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a57efb022f2ee2e19e4cdf582f4d27f2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">llvm::Instruction::isAtomic</a></div><div class="ttdeci">bool isAtomic() const LLVM_READONLY</div><div class="ttdoc">Return true if this instruction has an AtomicOrdering of unordered or higher.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00666">Instruction.cpp:666</a></div></div>
<div class="ttc" id="astructllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4_html_a6bd456c628d8cee23d1640040d98e70f"><div class="ttname"><a href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#a6bd456c628d8cee23d1640040d98e70f">llvm::DenseMapInfo&lt; LoweredPHIRecord &gt;::isEqual</a></div><div class="ttdeci">static bool isEqual(const LoweredPHIRecord &amp;LHS, const LoweredPHIRecord &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01078">InstCombinePHI.cpp:1078</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_aa8a186c50cdf60ac11ae1d0b884d468d"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#aa8a186c50cdf60ac11ae1d0b884d468d">llvm::InstCombinerImpl::foldPHIArgLoadIntoPHI</a></div><div class="ttdeci">Instruction * foldPHIArgLoadIntoPHI(PHINode &amp;PN)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00665">InstCombinePHI.cpp:665</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Instruction iterator methods.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00314">BasicBlock.h:314</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a7279ed8b15d2a6dc8d246a7de2e08604"><div class="ttname"><a href="classllvm_1_1Instruction.html#a7279ed8b15d2a6dc8d246a7de2e08604">llvm::Instruction::applyMergedLocation</a></div><div class="ttdeci">void applyMergedLocation(const DILocation *LocA, const DILocation *LocB)</div><div class="ttdoc">Merge 2 debug locations and apply it to the Instruction.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l00896">DebugInfo.cpp:896</a></div></div>
<div class="ttc" id="aInstCombinePHI_8cpp_html_a6456ccbd595a3334c6101e465a78c3c7"><div class="ttname"><a href="InstCombinePHI_8cpp.html#a6456ccbd595a3334c6101e465a78c3c7">isDeadPHICycle</a></div><div class="ttdeci">static bool isDeadPHICycle(PHINode *PN, SmallPtrSetImpl&lt; PHINode * &gt; &amp;PotentiallyDeadPHIs)</div><div class="ttdoc">Return true if this PHI node is only used by a PHI node cycle that is dead.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00977">InstCombinePHI.cpp:977</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00245">BasicBlock.cpp:245</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a31bf07f3f61525486633bc1d0bbaf029"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a31bf07f3f61525486633bc1d0bbaf029">llvm::BinaryOperator::getOpcode</a></div><div class="ttdeci">BinaryOps getOpcode() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00391">InstrTypes.h:391</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a9f382207d841377156d4c7868b66b9a5"><div class="ttname"><a href="classllvm_1_1Type.html#a9f382207d841377156d4c7868b66b9a5">llvm::Type::getScalarSizeInBits</a></div><div class="ttdeci">unsigned getScalarSizeInBits() const LLVM_READONLY</div><div class="ttdoc">If this is a vector type, return the getPrimitiveSizeInBits value for the element type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00188">Type.cpp:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a72516971c5734dc0f7546e64affca425"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">llvm::BasicBlock::phis</a></div><div class="ttdeci">iterator_range&lt; const_phi_iterator &gt; phis() const</div><div class="ttdoc">Returns a range that iterates over the phis in the basic block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00372">BasicBlock.h:372</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_aab1473644ffe7926032a4e01ed4bad78"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#aab1473644ffe7926032a4e01ed4bad78">llvm::InstCombinerImpl::foldIntegerTypedPHI</a></div><div class="ttdeci">bool foldIntegerTypedPHI(PHINode &amp;PN)</div><div class="ttdoc">If an integer typed PHI has only one use which is an IntToPtr operation, replace the PHI with an exis...</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00106">InstCombinePHI.cpp:106</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a969709dd49c28865a482d8b870f87c46"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a969709dd49c28865a482d8b870f87c46">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool IsSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00887">Constants.cpp:887</a></div></div>
<div class="ttc" id="aInstCombinePHI_8cpp_html_af1686daf97b5e313b29e4fdf48cd11ac"><div class="ttname"><a href="InstCombinePHI_8cpp.html#af1686daf97b5e313b29e4fdf48cd11ac">simplifyUsingControlFlow</a></div><div class="ttdeci">static Value * simplifyUsingControlFlow(InstCombiner &amp;Self, PHINode &amp;PN, const DominatorTree &amp;DT)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01279">InstCombinePHI.cpp:1279</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_aef51af4b490af6b3bf2dfbc8737a8f9f"><div class="ttname"><a href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const</div><div class="ttdoc">Return the number of incoming edges.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02790">Instructions.h:2790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a9d7de807ebdfe1819df3ff6cb0f16158"><div class="ttname"><a href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00344">Value.h:344</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae22f493ba8327ce92e87d3b96bce7017"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae22f493ba8327ce92e87d3b96bce7017">llvm::Instruction::getMetadata</a></div><div class="ttdeci">MDNode * getMetadata(unsigned KindID) const</div><div class="ttdoc">Get the metadata of given kind attached to this Instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00275">Instruction.h:275</a></div></div>
<div class="ttc" id="aclassllvm_1_1InvokeInst_html"><div class="ttname"><a href="classllvm_1_1InvokeInst.html">llvm::InvokeInst</a></div><div class="ttdoc">Invoke instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03814">Instructions.h:3814</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html"><div class="ttname"><a href="classllvm_1_1CmpInst.html">llvm::CmpInst</a></div><div class="ttdoc">This class is the base class for the comparison instructions.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00708">InstrTypes.h:708</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_a7a3e32edb65b5b1c216d4454f14df21c"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#a7a3e32edb65b5b1c216d4454f14df21c">llvm::InstCombinerImpl::foldPHIArgOpIntoPHI</a></div><div class="ttdeci">Instruction * foldPHIArgOpIntoPHI(PHINode &amp;PN)</div><div class="ttdoc">Try to rotate an operation below a PHI node, using PHI nodes for its operands.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00863">InstCombinePHI.cpp:863</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_a752efe4724ac3a97d07ee81d5f779c92"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#a752efe4724ac3a97d07ee81d5f779c92">llvm::InstCombinerImpl::visitPHINode</a></div><div class="ttdeci">Instruction * visitPHINode(PHINode &amp;PN)</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01380">InstCombinePHI.cpp:1380</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ea9acbe7fd20332ea6ccdb0183d6395"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ea9acbe7fd20332ea6ccdb0183d6395">llvm::Instruction::andIRFlags</a></div><div class="ttdeci">void andIRFlags(const Value *V)</div><div class="ttdoc">Logical 'and' of any supported wrapping, exact, and fast-math flags of V and this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00372">Instruction.cpp:372</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_af238147cf5453729781a0fcc7322e1c6"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#af238147cf5453729781a0fcc7322e1c6">llvm::ConstantExpr::getTrunc</a></div><div class="ttdeci">static Constant * getTrunc(Constant *C, Type *Ty, bool OnlyIfReduced=false)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l02091">Constants.cpp:2091</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a161c2db145827f4e181e7fe662b53a81"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">llvm::LoadInst::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Returns the address space of the pointer operand.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00270">Instructions.h:270</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html_ae77be336e228cf9aa00709a8606dfb98"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html#ae77be336e228cf9aa00709a8606dfb98">llvm::PatternMatch::m_Zero</a></div><div class="ttdeci">is_zero m_Zero()</div><div class="ttdoc">Match any null constant or a vector with all elements equal to 0.</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00537">PatternMatch.h:537</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aInstCombinePHI_8cpp_html_aa2a90d2c1ecab0b3271d574a3e480509"><div class="ttname"><a href="InstCombinePHI_8cpp.html#aa2a90d2c1ecab0b3271d574a3e480509">getAnyNonZeroConstInt</a></div><div class="ttdeci">static ConstantInt * getAnyNonZeroConstInt(PHINode &amp;PN)</div><div class="ttdoc">Return an existing non-zero constant if this phi node has one, otherwise return constant 1.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01024">InstCombinePHI.cpp:1024</a></div></div>
<div class="ttc" id="astructllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4_html_ad01126ce2b0450d630993b4211934894"><div class="ttname"><a href="structllvm_1_1DenseMapInfo_3_01LoweredPHIRecord_01_4.html#ad01126ce2b0450d630993b4211934894">llvm::DenseMapInfo&lt; LoweredPHIRecord &gt;::getTombstoneKey</a></div><div class="ttdeci">static LoweredPHIRecord getTombstoneKey()</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01071">InstCombinePHI.cpp:1071</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_adf4e7878fc0b3b8dcde545178564190d"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#adf4e7878fc0b3b8dcde545178564190d">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00110">DenseMap.h:110</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html_a6a15a030098342e06ea73e1241d614c9"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html#a6a15a030098342e06ea73e1241d614c9">llvm::DomTreeNodeBase::getBlock</a></div><div class="ttdeci">NodeT * getBlock() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00089">GenericDomTree.h:89</a></div></div>
<div class="ttc" id="aclassllvm_1_1ExtractValueInst_html_a1cccf41f6be0351ccceed2c6447ff04a"><div class="ttname"><a href="classllvm_1_1ExtractValueInst.html#a1cccf41f6be0351ccceed2c6447ff04a">llvm::ExtractValueInst::Create</a></div><div class="ttdeci">static ExtractValueInst * Create(Value *Agg, ArrayRef&lt; unsigned &gt; Idxs, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02481">Instructions.h:2481</a></div></div>
<div class="ttc" id="anamespacellvm_html_a086e9fbdb06276db7753101a08a63adf"><div class="ttname"><a href="namespacellvm.html#a086e9fbdb06276db7753101a08a63adf">llvm::find</a></div><div class="ttdeci">auto find(R &amp;&amp;Range, const T &amp;Val)</div><div class="ttdoc">Provide wrappers to std::find which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01755">STLExtras.h:1755</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a2fd1d2dc14e22227cfa8238778ab87b8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">llvm::Instruction::user_back</a></div><div class="ttdeci">Instruction * user_back()</div><div class="ttdoc">Specialize the methods defined in Value, as we know that an instruction can only be used by other ins...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00087">Instruction.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a5ba57877c55dfdbe6e3bbfdacd9ef8c1"><div class="ttname"><a href="classllvm_1_1PHINode.html#a5ba57877c55dfdbe6e3bbfdacd9ef8c1">llvm::PHINode::setIncomingBlock</a></div><div class="ttdeci">void setIncomingBlock(unsigned i, BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02833">Instructions.h:2833</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00067">LLVMContext.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_a29028fb86efd0ff0ea01f243f47684fc"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#a29028fb86efd0ff0ea01f243f47684fc">llvm::InstCombinerImpl::foldPHIArgInsertValueInstructionIntoPHI</a></div><div class="ttdeci">Instruction * foldPHIArgInsertValueInstructionIntoPHI(PHINode &amp;PN)</div><div class="ttdoc">If we have something like phi [insertvalue(a,b,0), insertvalue(c,d,0)], turn this into a phi[a,...</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00331">InstCombinePHI.cpp:331</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="anamespacellvm_html_a061b224a1a3c3486fd854e5009a858c9"><div class="ttname"><a href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">llvm::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(int64_t V1, const APSInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APSInt_8h_source.html#l00361">APSInt.h:361</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdoc">an instruction for type-safe pointer arithmetic to access elements of arrays and structs</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00940">Instructions.h:940</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ae9562b96f6f3fa41bd36538c080035ee"><div class="ttname"><a href="classllvm_1_1PHINode.html#ae9562b96f6f3fa41bd36538c080035ee">llvm::PHINode::getBasicBlockIndex</a></div><div class="ttdeci">int getBasicBlockIndex(const BasicBlock *BB) const</div><div class="ttdoc">Return the first index of the specified basic block in the value list for this PHI.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02882">Instructions.h:2882</a></div></div>
<div class="ttc" id="anamespacellvm_html_aab02db480f387fca92956ef1c9a01941"><div class="ttname"><a href="namespacellvm.html#aab02db480f387fca92956ef1c9a01941">llvm::simplifyInstruction</a></div><div class="ttdeci">Value * simplifyInstruction(Instruction *I, const SimplifyQuery &amp;Q, OptimizationRemarkEmitter *ORE=nullptr)</div><div class="ttdoc">See if we can compute a simplified version of this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8cpp_source.html#l06731">InstructionSimplify.cpp:6731</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; SmallDenseMap&lt; KeyT, ValueT, 4, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a1a70f2c359aadd76a72aaaede16aca4a"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">llvm::DominatorTree::isReachableFromEntry</a></div><div class="ttdeci">bool isReachableFromEntry(const Use &amp;U) const</div><div class="ttdoc">Provide an overload for a Use.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00335">Dominators.cpp:335</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a5fa9b8e1842b354f64c1ba6be0a4a17f"><div class="ttname"><a href="classllvm_1_1User.html#a5fa9b8e1842b354f64c1ba6be0a4a17f">llvm::User::setOperand</a></div><div class="ttdeci">void setOperand(unsigned i, Value *Val)</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00174">User.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a74c47d18ecd4ca3399785e6ae07134dc"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a74c47d18ecd4ca3399785e6ae07134dc">llvm::GetElementPtrInst::Create</a></div><div class="ttdeci">static GetElementPtrInst * Create(Type *PointeeType, Value *Ptr, ArrayRef&lt; Value * &gt; IdxList, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00966">Instructions.h:966</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html">llvm::BinaryOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00187">InstrTypes.h:187</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockSections_8cpp_source.html#l00137">BasicBlockSections.cpp:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="ainclude_2llvm_2Support_2CMakeLists_8txt_html_aef9367eb0b7430eaf70b1f2725488f2a"><div class="ttname"><a href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a></div><div class="ttdeci">if(llvm_vc STREQUAL &quot;&quot;) set(fake_version_inc &quot;$</div><div class="ttdef"><b>Definition:</b> <a href="include_2llvm_2Support_2CMakeLists_8txt_source.html#l00014">CMakeLists.txt:14</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html"><div class="ttname"><a href="classllvm_1_1CastInst.html">llvm::CastInst</a></div><div class="ttdoc">This is the base class for all instructions that perform data casts.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00428">InstrTypes.h:428</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key_html_a4eea8fbc268a347761cbbc80e3660544"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">llvm::AMDGPU::HSAMD::Kernel::Arg::Key::IsVolatile</a></div><div class="ttdeci">constexpr char IsVolatile[]</div><div class="ttdoc">Key for Kernel::Arg::Metadata::mIsVolatile.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00199">AMDGPUMetadata.h:199</a></div></div>
<div class="ttc" id="aInstCombinePHI_8cpp_html_ac278b4fd2017bfc63c0e8fe5488f7da3"><div class="ttname"><a href="InstCombinePHI_8cpp.html#ac278b4fd2017bfc63c0e8fe5488f7da3">MaxNumPhis</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxNumPhis(&quot;instcombine-max-num-phis&quot;, cl::init(512), cl::desc(&quot;Maximum number phis to handle in intptr/ptrint folding&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a966eb231e7d4e572874d2cb49b18faea"><div class="ttname"><a href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">llvm::Value::stripPointerCasts</a></div><div class="ttdeci">const Value * stripPointerCasts() const</div><div class="ttdoc">Strip off pointer casts, all-zero GEPs and address space casts.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00685">Value.cpp:685</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa7cce62ac5cc6df09cce0535874336b7"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">llvm::ConstantInt::getFalse</a></div><div class="ttdeci">static ConstantInt * getFalse(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00842">Constants.cpp:842</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_a0e1c3175b0ac22fe3853651c28e1ecb8"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#a0e1c3175b0ac22fe3853651c28e1ecb8">llvm::SmallPtrSetImplBase::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00093">SmallPtrSet.h:93</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdoc">Twine - A lightweight data structure for efficiently representing the concatenation of temporary valu...</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a82dbbd8e3688b0bc1eedb338864d0d0c"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">llvm::ConstantInt::getTrue</a></div><div class="ttdeci">static ConstantInt * getTrue(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00835">Constants.cpp:835</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_a31d2885660f654b31d8741726c3ea8d9"><div class="ttname"><a href="classllvm_1_1CastInst.html#a31d2885660f654b31d8741726c3ea8d9">llvm::CastInst::CreateBitOrPointerCast</a></div><div class="ttdeci">static CastInst * CreateBitOrPointerCast(Value *S, Type *Ty, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Create a BitCast, a PtrToInt, or an IntToPTr cast instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03509">Instructions.cpp:3509</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; SmallDenseMap&lt; KeyT, ValueT, 4, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ab0ff669b12c20c07137705c38872ec63"><div class="ttname"><a href="classllvm_1_1PHINode.html#ab0ff669b12c20c07137705c38872ec63">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02750">Instructions.h:2750</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_a84318f31145b081677697de64401238a"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#a84318f31145b081677697de64401238a">llvm::InstCombinerImpl::foldPHIArgZextsIntoPHI</a></div><div class="ttdeci">Instruction * foldPHIArgZextsIntoPHI(PHINode &amp;PN)</div><div class="ttdoc">TODO: This function could handle other cast types, but then it might require special-casing a cast fr...</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00789">InstCombinePHI.cpp:789</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombinerImpl_html_ac8cb4401526dd424f15566e4501792f7"><div class="ttname"><a href="classllvm_1_1InstCombinerImpl.html#ac8cb4401526dd424f15566e4501792f7">llvm::InstCombinerImpl::SliceUpIllegalIntegerPHI</a></div><div class="ttdeci">Instruction * SliceUpIllegalIntegerPHI(PHINode &amp;PN)</div><div class="ttdoc">This is an integer PHI and we know that it has an illegal type: see if it is only used by trunc or tr...</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l01095">InstCombinePHI.cpp:1095</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstCombiner_html"><div class="ttname"><a href="classllvm_1_1InstCombiner.html">llvm::InstCombiner</a></div><div class="ttdoc">The core instruction combiner logic.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombiner_8h_source.html#l00045">InstCombiner.h:45</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6467ebe1e09a75203dd5f14bdfe21d11"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">llvm::AMDGPU::Hwreg::Width</a></div><div class="ttdeci">Width</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00449">SIDefines.h:449</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_af3d64ff2173fb2f45fdc714699cad09fa236ce469d991c10b68c9e2872f684779"><div class="ttname"><a href="namespacellvm_1_1codeview.html#af3d64ff2173fb2f45fdc714699cad09fa236ce469d991c10b68c9e2872f684779">llvm::codeview::VB</a></div><div class="ttdeci">@ VB</div><div class="ttdef"><b>Definition:</b> <a href="CodeView_8h_source.html#l00155">CodeView.h:155</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a3b4a54b076454fec43b13554b28252a9"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a3b4a54b076454fec43b13554b28252a9">llvm::CmpInst::Create</a></div><div class="ttdeci">static CmpInst * Create(OtherOps Op, Predicate predicate, Value *S1, Value *S2, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Construct a compare instruction, given the opcode, the predicate and the two operands.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l04025">Instructions.cpp:4025</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_addec638786f763d967811b45cb662f1f"><div class="ttname"><a href="classllvm_1_1User.html#addec638786f763d967811b45cb662f1f">llvm::User::getNumOperands</a></div><div class="ttdeci">unsigned getNumOperands() const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00191">User.h:191</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a2eccc19f9061eeb7ad1e30e21f76034d"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">llvm::LoadInst::isVolatile</a></div><div class="ttdeci">bool isVolatile() const</div><div class="ttdoc">Return true if this is a load from a volatile memory location.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00214">Instructions.h:214</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2edb650de7b28add81349f5abf7ed7aa"><div class="ttname"><a href="namespacellvm.html#a2edb650de7b28add81349f5abf7ed7aa">llvm::zip</a></div><div class="ttdeci">detail::zippy&lt; detail::zip_shortest, T, U, Args... &gt; zip(T &amp;&amp;t, U &amp;&amp;u, Args &amp;&amp;...args)</div><div class="ttdoc">zip iterator for two or more iteratable types.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00882">STLExtras.h:882</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a2eeb1c7ed1cfe403f2ae0470e36c07e2"><div class="ttname"><a href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">llvm::User::op_begin</a></div><div class="ttdeci">op_iterator op_begin()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00234">User.h:234</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aInstructionSimplify_8h_html"><div class="ttname"><a href="InstructionSimplify_8h.html">InstructionSimplify.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_aa7414ba9f658ff1287d22a4b8fe81bcb"><div class="ttname"><a href="classllvm_1_1CmpInst.html#aa7414ba9f658ff1287d22a4b8fe81bcb">llvm::CmpInst::getPredicate</a></div><div class="ttdeci">Predicate getPredicate() const</div><div class="ttdoc">Return the predicate for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00808">InstrTypes.h:808</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a8ce0c4746a1ec805e66409d20ae93922"><div class="ttname"><a href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const</div><div class="ttdoc">Return incoming basic block number i.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02814">Instructions.h:2814</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PatternMatch_html"><div class="ttname"><a href="namespacellvm_1_1PatternMatch.html">llvm::PatternMatch</a></div><div class="ttdef"><b>Definition:</b> <a href="PatternMatch_8h_source.html#l00047">PatternMatch.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a3e6d2896c39a84cfa6c47f34cdc584ff"><div class="ttname"><a href="classllvm_1_1Instruction.html#a3e6d2896c39a84cfa6c47f34cdc584ff">llvm::Instruction::copyIRFlags</a></div><div class="ttdeci">void copyIRFlags(const Value *V, bool IncludeWrapFlags=true)</div><div class="ttdoc">Convenience method to copy supported exact, fast-math, and (optionally) wrapping flags from V to this...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00348">Instruction.cpp:348</a></div></div>
<div class="ttc" id="ablake3__impl_8h_html_a78823051d1dad34b9b3d8120112e674d"><div class="ttname"><a href="blake3__impl_8h.html#a78823051d1dad34b9b3d8120112e674d">IV</a></div><div class="ttdeci">static const uint32_t IV[8]</div><div class="ttdef"><b>Definition:</b> <a href="blake3__impl_8h_source.html#l00077">blake3_impl.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_html_a4b2c1cc89c04d885ab3036597446f0cd"><div class="ttname"><a href="classllvm_1_1IRBuilderBase.html#a4b2c1cc89c04d885ab3036597446f0cd">llvm::IRBuilderBase::CreateNot</a></div><div class="ttdeci">Value * CreateNot(Value *V, const Twine &amp;Name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l01664">IRBuilder.h:1664</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html">llvm::SmallPtrSetImpl</a></div><div class="ttdoc">A templated base class for SmallPtrSet which provides the typesafe interface that is common across al...</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00344">SmallPtrSet.h:344</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_acd347d07162a5a80dac61e5bdea9616c"><div class="ttname"><a href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">llvm::CastInst::CreatePointerCast</a></div><div class="ttdeci">static CastInst * CreatePointerCast(Value *S, Type *Ty, const Twine &amp;Name, BasicBlock *InsertAtEnd)</div><div class="ttdoc">Create a BitCast AddrSpaceCast, or a PtrToInt cast instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03446">Instructions.cpp:3446</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdoc">an instruction to allocate memory on the stack</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_a3f02c25d97697736a70f0808ddab1eed"><div class="ttname"><a href="classllvm_1_1CastInst.html#a3f02c25d97697736a70f0808ddab1eed">llvm::CastInst::CreateZExtOrBitCast</a></div><div class="ttdeci">static CastInst * CreateZExtOrBitCast(Value *S, Type *Ty, const Twine &amp;Name=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Create a ZExt or BitCast cast instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03398">Instructions.cpp:3398</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1BinaryOperator_html_a02ce9966395063ac501ecbc1623deda4"><div class="ttname"><a href="classllvm_1_1BinaryOperator.html#a02ce9966395063ac501ecbc1623deda4">llvm::BinaryOperator::Create</a></div><div class="ttdeci">static BinaryOperator * Create(BinaryOps Op, Value *S1, Value *S2, const Twine &amp;Name=Twine(), Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Construct a binary instruction, given the opcode and the two operands.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l02950">Instructions.cpp:2950</a></div></div>
<div class="ttc" id="aInstCombinePHI_8cpp_html_a6b46ea77082dda0b24b9fea490ae8fc8"><div class="ttname"><a href="InstCombinePHI_8cpp.html#a6b46ea77082dda0b24b9fea490ae8fc8">isSafeAndProfitableToSinkLoad</a></div><div class="ttdeci">static bool isSafeAndProfitableToSinkLoad(LoadInst *L)</div><div class="ttdoc">Return true if we know that it is safe to sink the load out of the block that defines it.</div><div class="ttdef"><b>Definition:</b> <a href="InstCombinePHI_8cpp_source.html#l00621">InstCombinePHI.cpp:621</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a833daf718a49c5cd637d8c9ddeaebe07"><div class="ttname"><a href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">TypeSize getPrimitiveSizeInBits() const LLVM_READONLY</div><div class="ttdoc">Return the basic size of this type if it is a primitive type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00163">Type.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_af41f58e730804d10b91fcff39b035f74"><div class="ttname"><a href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">llvm::User::op_end</a></div><div class="ttdeci">op_iterator op_end()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00236">User.h:236</a></div></div>
<div class="ttc" id="aclassllvm_1_1PoisonValue_html_a1bf08613fb664a2e377a9a72c59a6b66"><div class="ttname"><a href="classllvm_1_1PoisonValue.html#a1bf08613fb664a2e377a9a72c59a6b66">llvm::PoisonValue::get</a></div><div class="ttdeci">static PoisonValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'poison' object of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l01759">Constants.cpp:1759</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:23:44 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
