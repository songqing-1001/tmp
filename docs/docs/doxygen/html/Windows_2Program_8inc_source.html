<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Support/Windows/Program.inc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_f0dc79bace318df7ec0fa0bdb179ed95.html">Support</a></li><li class="navelem"><a class="el" href="dir_3517577039c8cab3aba0e0e4cb0c6785.html">Windows</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Program.inc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Windows_2Program_8inc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- Win32/Program.cpp - Win32 Program Implementation ------- -*- C++ -*-===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file provides the Win32 specific implementation of the Program class.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BitVector_8h.html">llvm/ADT/BitVector.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringExtras_8h.html">llvm/ADT/StringExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConvertUTF_8h.html">llvm/Support/ConvertUTF.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Errc_8h.html">llvm/Support/Errc.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FileSystem_8h.html">llvm/Support/FileSystem.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Path_8h.html">llvm/Support/Path.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="WindowsSupport_8h.html">llvm/Support/Windows/WindowsSupport.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="WindowsError_8h.html">llvm/Support/WindowsError.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;io.h&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;malloc.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;psapi.h&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//=== WARNING: Implementation here must contain only Win32 specific code</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//===          and must not be UNIX code</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<a class="code" href="structllvm_1_1sys_1_1ProcessInfo.html#a8f904a7e686cd044958b4eceb4297cde">ProcessInfo::ProcessInfo</a>() : Pid(0), Process(0), ReturnCode(0) {}</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;ErrorOr&lt;std::string&gt; <a class="code" href="namespacellvm_1_1sys.html#a7f2dd714b9f4a359e62b257376e38d33">sys::findProgramByName</a>(StringRef Name,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                            ArrayRef&lt;StringRef&gt; Paths) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>.empty() &amp;&amp; <span class="stringliteral">&quot;Must have a name!&quot;</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>.find_first_of(<span class="stringliteral">&quot;/\\&quot;</span>) != <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">return</span> std::string(Name);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">wchar_t</span> *<a class="code" href="namespacellvm_1_1pdb.html#ac10322dc19a928c2dbb83ec9689dc23caac70412e939d72a9234cdebb1af5867b">Path</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  std::wstring PathStorage;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span> (!Paths.empty()) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    PathStorage.reserve(Paths.size() * MAX_PATH);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Paths.size(); ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        PathStorage.push_back(L<span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      StringRef <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = Paths[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      SmallVector&lt;wchar_t, MAX_PATH&gt; TmpPath;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordflow">if</span> (std::error_code EC = windows::UTF8ToUTF16(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, TmpPath))</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      PathStorage.append(TmpPath.begin(), TmpPath.end());</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="namespacellvm_1_1pdb.html#ac10322dc19a928c2dbb83ec9689dc23caac70412e939d72a9234cdebb1af5867b">Path</a> = PathStorage.c_str();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  SmallVector&lt;wchar_t, MAX_PATH&gt; U16Name;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (std::error_code EC = windows::UTF8ToUTF16(Name, U16Name))</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  SmallVector&lt;StringRef, 12&gt; PathExts;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  PathExts.push_back(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  PathExts.push_back(<span class="stringliteral">&quot;.exe&quot;</span>); <span class="comment">// FIXME: This must be in %PATHEXT%.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *PathExtEnv = std::getenv(<span class="stringliteral">&quot;PATHEXT&quot;</span>))</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    SplitString(PathExtEnv, PathExts, <span class="stringliteral">&quot;;&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  SmallVector&lt;char, MAX_PATH&gt; U8Result;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">for</span> (StringRef <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> : PathExts) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    SmallVector&lt;wchar_t, MAX_PATH&gt; U16Result;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = MAX_PATH;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      U16Result.resize_for_overwrite(Len);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="comment">// Lets attach the extension manually. That is needed for files</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">// with a point in name like aaa.bbb. SearchPathW will not add extension</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="comment">// from its argument to such files because it thinks they already had one.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      SmallVector&lt;wchar_t, MAX_PATH&gt; U16NameExt;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">if</span> (std::error_code EC =</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;              windows::UTF8ToUTF16(Twine(Name + <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a>).str(), U16NameExt))</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = ::SearchPathW(Path, <a class="code" href="namespacellvm.html#af11d71816b6dc7c266e71fcff02be291">c_str</a>(U16NameExt), <span class="keyword">nullptr</span>, U16Result.size(),</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                          U16Result.data(), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    } <span class="keywordflow">while</span> (Len &gt; U16Result.size());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> (Len == 0)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    U16Result.truncate(Len);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span> (std::error_code EC =</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            windows::UTF16ToUTF8(U16Result.data(), U16Result.size(), U8Result))</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sys_1_1fs.html#ad3a7c62e8f9554d7f8e7fdb989f1c68e">sys::fs::can_execute</a>(U8Result))</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">break</span>; <span class="comment">// Found it.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    U8Result.clear();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> (U8Result.empty())</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#af0799d74677708a87dee45acdd40bab2">mapWindowsError</a>(::GetLastError());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="namespacellvm_1_1sys_1_1path.html#a58dcbf859a69b30932a6ed45806f8a5b">llvm::sys::path::make_preferred</a>(U8Result);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">return</span> std::string(U8Result.begin(), U8Result.end());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(std::string *ErrMsg, <span class="keyword">const</span> std::string &amp;prefix) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">if</span> (!ErrMsg)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">char</span> *buffer = NULL;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> LastError = GetLastError();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = FormatMessageA(FORMAT_MESSAGE_ALLOCATE_BUFFER |</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                               FORMAT_MESSAGE_FROM_SYSTEM |</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                               FORMAT_MESSAGE_MAX_WIDTH_MASK,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                           NULL, LastError, 0, (LPSTR)&amp;buffer, 1, NULL);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">if</span> (R)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    *ErrMsg = prefix + <span class="stringliteral">&quot;: &quot;</span> + buffer;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    *ErrMsg = prefix + <span class="stringliteral">&quot;: Unknown error&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  *ErrMsg += <span class="stringliteral">&quot; (0x&quot;</span> + llvm::utohexstr(LastError) + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  LocalFree(buffer);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> != 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">static</span> HANDLE RedirectIO(std::optional&lt;StringRef&gt; Path, <span class="keywordtype">int</span> fd,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                         std::string *ErrMsg) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  HANDLE <a class="code" href="log_8txt.html#aa3ab6cc3a59c1050d2f016175ec5c682">h</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (!Path) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (!DuplicateHandle(GetCurrentProcess(), (HANDLE)_get_osfhandle(fd),</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                         GetCurrentProcess(), &amp;<a class="code" href="log_8txt.html#aa3ab6cc3a59c1050d2f016175ec5c682">h</a>, 0, TRUE,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                         DUPLICATE_SAME_ACCESS))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">return</span> INVALID_HANDLE_VALUE;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="log_8txt.html#aa3ab6cc3a59c1050d2f016175ec5c682">h</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  std::string fname;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#ac10322dc19a928c2dbb83ec9689dc23caac70412e939d72a9234cdebb1af5867b">Path</a>-&gt;empty())</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    fname = <span class="stringliteral">&quot;NUL&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    fname = std::string(*Path);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  SECURITY_ATTRIBUTES sa;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  sa.nLength = <span class="keyword">sizeof</span>(sa);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  sa.lpSecurityDescriptor = 0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  sa.bInheritHandle = TRUE;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  SmallVector&lt;wchar_t, 128&gt; fnameUnicode;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1pdb.html#ac10322dc19a928c2dbb83ec9689dc23caac70412e939d72a9234cdebb1af5867b">Path</a>-&gt;empty()) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// Don&#39;t play long-path tricks on &quot;NUL&quot;.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (windows::UTF8ToUTF16(fname, fnameUnicode))</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">return</span> INVALID_HANDLE_VALUE;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sys_1_1windows.html#accc4b526d349a99a2a18875de6b36b5c">sys::windows::widenPath</a>(fname, fnameUnicode))</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">return</span> INVALID_HANDLE_VALUE;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="log_8txt.html#aa3ab6cc3a59c1050d2f016175ec5c682">h</a> = CreateFileW(fnameUnicode.data(), fd ? GENERIC_WRITE : GENERIC_READ,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                  FILE_SHARE_READ, &amp;sa, fd == 0 ? OPEN_EXISTING : CREATE_ALWAYS,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                  FILE_ATTRIBUTE_NORMAL, NULL);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log_8txt.html#aa3ab6cc3a59c1050d2f016175ec5c682">h</a> == INVALID_HANDLE_VALUE) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;               fname + <span class="stringliteral">&quot;: Can&#39;t open file for &quot;</span> + (fd ? <span class="stringliteral">&quot;input&quot;</span> : <span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="log_8txt.html#aa3ab6cc3a59c1050d2f016175ec5c682">h</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;} <span class="comment">// namespace llvm</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1pdb.html#a39ee700138913a49bc90faf2c1db0b9ba40cd014b7b6251e3a22e6a45a73a64e1">Execute</a>(ProcessInfo &amp;PI, StringRef Program,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    ArrayRef&lt;StringRef&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>, std::optional&lt;ArrayRef&lt;StringRef&gt;&gt; Env,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    <a class="code" href="namespacellvm.html#ab9c6b351507d3c0730f4290919d43a12">ArrayRef</a>&lt;std::optional&lt;StringRef&gt;&gt; Redirects,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    <span class="keywordtype">unsigned</span> MemoryLimit, std::string *ErrMsg,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    BitVector *AffinityMask) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1sys_1_1fs.html#ad3a7c62e8f9554d7f8e7fdb989f1c68e">sys::fs::can_execute</a>(Program)) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (ErrMsg)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      *ErrMsg = <span class="stringliteral">&quot;program not executable&quot;</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// can_execute may succeed by looking at Program + &quot;.exe&quot;. CreateProcessW</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// will implicitly add the .exe if we provide a command line without an</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// executable path, but since we use an explicit executable, we have to add</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// &quot;.exe&quot; ourselves.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  SmallString&lt;64&gt; ProgramStorage;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a645a607ffcccb12f16a5736db991e7d9">sys::fs::exists</a>(Program))</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    Program = Twine(Program + <span class="stringliteral">&quot;.exe&quot;</span>).toStringRef(ProgramStorage);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// Windows wants a command line, not an array of args, to pass to the new</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// process.  We have to concatenate them all, while quoting the args that</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// have embedded spaces (or are empty).</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = flattenWindowsCommandLine(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span> (std::error_code ec = <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.getError()) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    SetLastError(ec.value());</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, std::string(<span class="stringliteral">&quot;Unable to convert command-line to UTF-16&quot;</span>));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  std::wstring Command = *<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// The pointer to the environment block for the new process.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  std::vector&lt;wchar_t&gt; EnvBlock;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (Env) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// An environment block consists of a null-terminated block of</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// null-terminated strings. Convert the array of environment variables to</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// an environment block by concatenating them.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">for</span> (StringRef <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> : *Env) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      SmallVector&lt;wchar_t, MAX_PATH&gt; EnvString;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">if</span> (std::error_code ec = windows::UTF8ToUTF16(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>, EnvString)) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        SetLastError(ec.value());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, <span class="stringliteral">&quot;Unable to convert environment variable to UTF-16&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <a class="code" href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a>(EnvBlock, EnvString);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      EnvBlock.push_back(0);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    EnvBlock.push_back(0);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Create a child process.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  STARTUPINFOW si;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  memset(&amp;si, 0, <span class="keyword">sizeof</span>(si));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  si.cb = <span class="keyword">sizeof</span>(si);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  si.hStdInput = INVALID_HANDLE_VALUE;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  si.hStdOutput = INVALID_HANDLE_VALUE;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  si.hStdError = INVALID_HANDLE_VALUE;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (!Redirects.empty()) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    si.dwFlags = STARTF_USESTDHANDLES;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    si.hStdInput = RedirectIO(Redirects[0], 0, ErrMsg);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (si.hStdInput == INVALID_HANDLE_VALUE) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, <span class="stringliteral">&quot;can&#39;t redirect stdin&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    si.hStdOutput = RedirectIO(Redirects[1], 1, ErrMsg);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (si.hStdOutput == INVALID_HANDLE_VALUE) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      CloseHandle(si.hStdInput);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, <span class="stringliteral">&quot;can&#39;t redirect stdout&quot;</span>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (Redirects[1] &amp;&amp; Redirects[2] &amp;&amp; *Redirects[1] == *Redirects[2]) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">// If stdout and stderr should go to the same place, redirect stderr</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="comment">// to the handle already open for stdout.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (!DuplicateHandle(GetCurrentProcess(), si.hStdOutput,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                           GetCurrentProcess(), &amp;si.hStdError, 0, TRUE,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                           DUPLICATE_SAME_ACCESS)) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        CloseHandle(si.hStdInput);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        CloseHandle(si.hStdOutput);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, <span class="stringliteral">&quot;can&#39;t dup stderr to stdout&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="comment">// Just redirect stderr</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      si.hStdError = RedirectIO(Redirects[2], 2, ErrMsg);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span> (si.hStdError == INVALID_HANDLE_VALUE) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        CloseHandle(si.hStdInput);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        CloseHandle(si.hStdOutput);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, <span class="stringliteral">&quot;can&#39;t redirect stderr&quot;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  PROCESS_INFORMATION <a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  memset(&amp;<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  fflush(stdout);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  fflush(stderr);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  SmallVector&lt;wchar_t, MAX_PATH&gt; ProgramUtf16;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span> (std::error_code ec = <a class="code" href="namespacellvm_1_1sys_1_1windows.html#accc4b526d349a99a2a18875de6b36b5c">sys::windows::widenPath</a>(Program, ProgramUtf16)) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    SetLastError(ec.value());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;               std::string(<span class="stringliteral">&quot;Unable to convert application name to UTF-16&quot;</span>));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">unsigned</span> CreateFlags = CREATE_UNICODE_ENVIRONMENT;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span> (AffinityMask)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    CreateFlags |= CREATE_SUSPENDED;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  std::vector&lt;wchar_t&gt; CommandUtf16(Command.size() + 1, 0);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="lib_2Target_2WebAssembly_2README_8txt.html#a79ea041233b5866026c3071dfc464ec0">std::copy</a>(Command.begin(), Command.end(), CommandUtf16.begin());</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  BOOL <a class="code" href="HexagonBitTracker_8cpp.html#a2e1b5bd9424a1d1082d4bd670b1a0be6">rc</a> = CreateProcessW(ProgramUtf16.data(), CommandUtf16.data(), 0, 0, TRUE,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                           CreateFlags, EnvBlock.empty() ? 0 : EnvBlock.data(),</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                           0, &amp;si, &amp;<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> err = GetLastError();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// Regardless of whether the process got created or not, we are done with</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// the handles we created for it to inherit.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  CloseHandle(si.hStdInput);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  CloseHandle(si.hStdOutput);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  CloseHandle(si.hStdError);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// Now return an error if the process didn&#39;t get created.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="HexagonBitTracker_8cpp.html#a2e1b5bd9424a1d1082d4bd670b1a0be6">rc</a>) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    SetLastError(err);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               std::string(<span class="stringliteral">&quot;Couldn&#39;t execute program &#39;&quot;</span>) + Program.str() + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  PI.Pid = <a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.dwProcessId;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  PI.Process = <a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.hProcess;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// Make sure these get closed no matter what.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="namespacellvm.html#a1b31339301d33bf27bd0bdddeb289738">ScopedCommonHandle</a> hThread(<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.hThread);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// Assign the process to a job if a memory limit is defined.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="namespacellvm.html#a52d5a456ff24b34840b071b305691f24">ScopedJobHandle</a> hJob;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">if</span> (MemoryLimit != 0) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    hJob = CreateJobObjectW(0, 0);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1coverage.html#ab7cd3c4d014c0e03d0e0dbcc94c192e6a260ca9dd8a4577fc00b7bd5810298076">success</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (hJob) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      JOBOBJECT_EXTENDED_LIMIT_INFORMATION jeli;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      memset(&amp;jeli, 0, <span class="keyword">sizeof</span>(jeli));</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      jeli.BasicLimitInformation.LimitFlags = JOB_OBJECT_LIMIT_PROCESS_MEMORY;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      jeli.ProcessMemoryLimit = uintptr_t(MemoryLimit) * 1048576;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">if</span> (SetInformationJobObject(hJob, JobObjectExtendedLimitInformation,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                  &amp;jeli, <span class="keyword">sizeof</span>(jeli))) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span> (AssignProcessToJobObject(hJob, <a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.hProcess))</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          <a class="code" href="namespacellvm_1_1coverage.html#ab7cd3c4d014c0e03d0e0dbcc94c192e6a260ca9dd8a4577fc00b7bd5810298076">success</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (!success) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      SetLastError(GetLastError());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, std::string(<span class="stringliteral">&quot;Unable to set memory limit&quot;</span>));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      TerminateProcess(<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.hProcess, 1);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      WaitForSingleObject(<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.hProcess, INFINITE);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// Set the affinity mask</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span> (AffinityMask) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    ::SetProcessAffinityMask(<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.hProcess,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                             (DWORD_PTR)AffinityMask-&gt;getData().front());</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    ::ResumeThread(<a class="code" href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">pi</a>.hThread);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> argNeedsQuotes(StringRef <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.empty())</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a> != <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.find_first_of(<span class="stringliteral">&quot;\t \&quot;&amp;\&#39;()*&lt;&gt;\\`^|\n&quot;</span>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keyword">static</span> std::string quoteSingleArg(StringRef <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  std::string <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.push_back(<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.empty()) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">size_t</span> FirstNonBackslash = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.find_first_not_of(<span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">size_t</span> BackslashCount = FirstNonBackslash;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (FirstNonBackslash == <a class="code" href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">StringRef::npos</a>) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">// The entire remainder of the argument is backslashes.  Escape all of</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">// them and just early out.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      BackslashCount = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.size();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.append(BackslashCount * 2, <span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>[FirstNonBackslash] == <span class="charliteral">&#39;\&quot;&#39;</span>) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="comment">// This is an embedded quote.  Escape all preceding backslashes, then</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">// add one additional backslash to escape the quote.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.append(BackslashCount * 2 + 1, <span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.push_back(<span class="charliteral">&#39;\&quot;&#39;</span>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="comment">// This is just a normal character.  Don&#39;t escape any of the preceding</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">// backslashes, just append them as they are and then append the</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">// character.</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.append(BackslashCount, <span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.push_back(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>[FirstNonBackslash]);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// Drop all the backslashes, plus the following character.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> = <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.drop_front(FirstNonBackslash + 1);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.push_back(<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;ErrorOr&lt;std::wstring&gt; sys::flattenWindowsCommandLine(ArrayRef&lt;StringRef&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  std::string Command;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">for</span> (StringRef <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> : <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span> (argNeedsQuotes(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>))</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      Command += quoteSingleArg(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      Command += <a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    Command.push_back(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  SmallVector&lt;wchar_t, MAX_PATH&gt; CommandUtf16;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> (std::error_code ec = windows::UTF8ToUTF16(Command, CommandUtf16))</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">return</span> ec;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">return</span> std::wstring(CommandUtf16.begin(), CommandUtf16.end());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;ProcessInfo <a class="code" href="namespacellvm_1_1sys.html#a7defb51d8d6a2eba7a428d1a22f08bad">sys::Wait</a>(<span class="keyword">const</span> ProcessInfo &amp;PI,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                      std::optional&lt;unsigned&gt; SecondsToWait,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                      std::string *ErrMsg,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                      std::optional&lt;ProcessStatistics&gt; *ProcStat,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                      <span class="keywordtype">bool</span> Polling) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PI.Pid &amp;&amp; <span class="stringliteral">&quot;invalid pid to wait on, process not started?&quot;</span>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((PI.Process &amp;&amp; PI.Process != INVALID_HANDLE_VALUE) &amp;&amp;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         <span class="stringliteral">&quot;invalid process handle to wait on, process not started?&quot;</span>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> milliSecondsToWait = SecondsToWait ? *SecondsToWait * 1000 : INFINITE;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  ProcessInfo WaitResult = PI;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">if</span> (ProcStat)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    ProcStat-&gt;reset();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> WaitStatus = WaitForSingleObject(PI.Process, milliSecondsToWait);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">if</span> (WaitStatus == WAIT_TIMEOUT) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (!Polling &amp;&amp; *SecondsToWait &gt; 0) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">if</span> (!TerminateProcess(PI.Process, 1)) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">if</span> (ErrMsg)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, <span class="stringliteral">&quot;Failed to terminate timed-out program&quot;</span>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">// -2 indicates a crash or timeout as opposed to failure to execute.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        WaitResult.ReturnCode = -2;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        CloseHandle(PI.Process);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">return</span> WaitResult;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      WaitForSingleObject(PI.Process, INFINITE);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      CloseHandle(PI.Process);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="comment">// Non-blocking wait.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">return</span> ProcessInfo();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// Get process execution statistics.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">if</span> (ProcStat) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    FILETIME CreationTime, ExitTime, KernelTime, UserTime;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    PROCESS_MEMORY_COUNTERS MemInfo;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (GetProcessTimes(PI.Process, &amp;CreationTime, &amp;ExitTime, &amp;KernelTime,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                        &amp;UserTime) &amp;&amp;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        GetProcessMemoryInfo(PI.Process, &amp;MemInfo, <span class="keyword">sizeof</span>(MemInfo))) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keyword">auto</span> UserT = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <a class="code" href="namespacellvm_1_1sys.html#a1a420333641cfdaa22a032c78e92aa55">toDuration</a>(UserTime));</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keyword">auto</span> KernelT = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          <a class="code" href="namespacellvm_1_1sys.html#a1a420333641cfdaa22a032c78e92aa55">toDuration</a>(KernelTime));</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> PeakMemory = MemInfo.PeakPagefileUsage / 1024;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      *ProcStat = ProcessStatistics{UserT + KernelT, UserT, PeakMemory};</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// Get its exit status.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">status</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  BOOL <a class="code" href="HexagonBitTracker_8cpp.html#a2e1b5bd9424a1d1082d4bd670b1a0be6">rc</a> = GetExitCodeProcess(PI.Process, &amp;<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">status</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <a class="code" href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">DWORD</a> err = GetLastError();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> (err != ERROR_INVALID_HANDLE)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    CloseHandle(PI.Process);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="HexagonBitTracker_8cpp.html#a2e1b5bd9424a1d1082d4bd670b1a0be6">rc</a>) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    SetLastError(err);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (ErrMsg)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="namespacellvm.html#a737f46882195837060ea24b51019969d">MakeErrMsg</a>(ErrMsg, <span class="stringliteral">&quot;Failed getting status for program&quot;</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// -2 indicates a crash or timeout as opposed to failure to execute.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    WaitResult.ReturnCode = -2;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">return</span> WaitResult;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">status</a>)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">return</span> WaitResult;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// Pass 10(Warning) and 11(Error) to the callee as negative value.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">status</a> &amp; 0xBFFF0000U) == 0x80000000U)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    WaitResult.ReturnCode = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">status</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">status</a> &amp; 0xFF)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    WaitResult.ReturnCode = <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">status</a> &amp; 0x7FFFFFFF;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    WaitResult.ReturnCode = 1;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">return</span> WaitResult;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;std::error_code <a class="code" href="namespacellvm_1_1sys.html#a1b6956e6c738949193efee28bffe29f5">llvm::sys::ChangeStdinMode</a>(<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695">sys::fs::OpenFlags</a> Flags) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (!(Flags &amp; <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695a8e4195851e96284a52d5270ff40950b7">fs::OF_CRLF</a>))</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1sys.html#a74b492689c767075c865526e04296d02">ChangeStdinToBinary</a>();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">return</span> std::error_code();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;std::error_code <a class="code" href="namespacellvm_1_1sys.html#aa8e20bc263db62de532feb3d46aead63">llvm::sys::ChangeStdoutMode</a>(<a class="code" href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695">sys::fs::OpenFlags</a> Flags) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">if</span> (!(Flags &amp; <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695a8e4195851e96284a52d5270ff40950b7">fs::OF_CRLF</a>))</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1sys.html#ac35445acb02a4d09fe5aeaeaa3ad5165">ChangeStdoutToBinary</a>();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">return</span> std::error_code();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;std::error_code <a class="code" href="namespacellvm_1_1sys.html#a74b492689c767075c865526e04296d02">sys::ChangeStdinToBinary</a>() {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="README__P9_8txt.html#ae070adaf1b4bf0e7c12fcae2b9c5ae67">result</a> = _setmode(_fileno(stdin), _O_BINARY);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="README__P9_8txt.html#ae070adaf1b4bf0e7c12fcae2b9c5ae67">result</a> == -1)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">return</span> std::error_code(errno, std::generic_category());</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">return</span> std::error_code();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;std::error_code <a class="code" href="namespacellvm_1_1sys.html#ac35445acb02a4d09fe5aeaeaa3ad5165">sys::ChangeStdoutToBinary</a>() {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="README__P9_8txt.html#ae070adaf1b4bf0e7c12fcae2b9c5ae67">result</a> = _setmode(_fileno(stdout), _O_BINARY);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="README__P9_8txt.html#ae070adaf1b4bf0e7c12fcae2b9c5ae67">result</a> == -1)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> std::error_code(errno, std::generic_category());</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">return</span> std::error_code();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;std::error_code</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<a class="code" href="namespacellvm_1_1sys.html#ae1fa64c0bf9c723c5960fdd815df37df">llvm::sys::writeFileWithEncoding</a>(StringRef FileName, StringRef Contents,</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                 <a class="code" href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6c">WindowsEncodingMethod</a> Encoding) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  std::error_code <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <a class="code" href="classllvm_1_1raw__fd__ostream.html">llvm::raw_fd_ostream</a> <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>(FileName, EC, <a class="code" href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695ab505c2c79499fbe180989bffbf108a50">llvm::sys::fs::OF_TextWithCRLF</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">if</span> (EC)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">if</span> (Encoding == <a class="code" href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6caf0fd365beea6ebcbd1e26eb24015da53">WEM_UTF8</a>) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; Contents;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Encoding == <a class="code" href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6ca4a36ece054fa83562738192455180088">WEM_CurrentCodePage</a>) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    SmallVector&lt;wchar_t, 1&gt; ArgsUTF16;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    SmallVector&lt;char, 1&gt; ArgsCurCP;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> ((EC = windows::UTF8ToUTF16(Contents, ArgsUTF16)))</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span> ((EC = windows::UTF16ToCurCP(ArgsUTF16.data(), ArgsUTF16.size(),</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                    ArgsCurCP)))</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>.<a class="code" href="classllvm_1_1raw__ostream.html#a6e0cbc5c8568d8446c284c8538b2c9f1">write</a>(ArgsCurCP.data(), ArgsCurCP.size());</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Encoding == <a class="code" href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6ca89ceaeaaf604a94c4691ea915ada8c3c">WEM_UTF16</a>) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    SmallVector&lt;wchar_t, 1&gt; ArgsUTF16;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span> ((EC = windows::UTF8ToUTF16(Contents, ArgsUTF16)))</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// Endianness guessing</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">char</span> BOM[2];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classuint16__t.html">uint16_t</a> src = <a class="code" href="ConvertUTF_8h.html#af04ebcc9bd96acb50f34a94772fa4dbb">UNI_UTF16_BYTE_ORDER_MARK_NATIVE</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a>(BOM, &amp;src, 2);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>.<a class="code" href="classllvm_1_1raw__ostream.html#a6e0cbc5c8568d8446c284c8538b2c9f1">write</a>(BOM, 2);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>.<a class="code" href="classllvm_1_1raw__ostream.html#a6e0cbc5c8568d8446c284c8538b2c9f1">write</a>((<span class="keywordtype">char</span> *)ArgsUTF16.data(), ArgsUTF16.size() &lt;&lt; 1);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown encoding&quot;</span>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>.has_error())</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a20e3e08c7de6a230cd66f9e4322c3fbe">make_error_code</a>(<a class="code" href="namespacellvm.html#a59739a4f15fb2ec57a6b7fcfe938546bacccc32f2a5f7dc7b87d2f85daea66789">errc::io_error</a>);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1sys.html#a8f03c560e53b510e60a472723126bb52">llvm::sys::commandLineFitsWithinSystemLimits</a>(StringRef Program,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                                  ArrayRef&lt;StringRef&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// The documentation on CreateProcessW states that the size of the argument</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// lpCommandLine must not be greater than 32767 characters, including the</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// Unicode terminating null character. We use smaller value to reduce risk</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// of getting invalid command line due to unaccounted factors.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> MaxCommandStringLength = 32000;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  SmallVector&lt;StringRef, 8&gt; FullArgs;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  FullArgs.push_back(Program);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  FullArgs.append(<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.begin(), <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.end());</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = flattenWindowsCommandLine(FullArgs);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.getError());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>-&gt;size() + 1) &lt;= MaxCommandStringLength;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;} <span class="comment">// namespace llvm</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1coverage_html_ab7cd3c4d014c0e03d0e0dbcc94c192e6a260ca9dd8a4577fc00b7bd5810298076"><div class="ttname"><a href="namespacellvm_1_1coverage.html#ab7cd3c4d014c0e03d0e0dbcc94c192e6a260ca9dd8a4577fc00b7bd5810298076">llvm::coverage::coveragemap_error::success</a></div><div class="ttdeci">@ success</div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_a7f2dd714b9f4a359e62b257376e38d33"><div class="ttname"><a href="namespacellvm_1_1sys.html#a7f2dd714b9f4a359e62b257376e38d33">llvm::sys::findProgramByName</a></div><div class="ttdeci">ErrorOr&lt; std::string &gt; findProgramByName(StringRef Name, ArrayRef&lt; StringRef &gt; Paths={})</div><div class="ttdoc">Find the first executable file Name in Paths.</div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aConvertUTF_8h_html_af04ebcc9bd96acb50f34a94772fa4dbb"><div class="ttname"><a href="ConvertUTF_8h.html#af04ebcc9bd96acb50f34a94772fa4dbb">UNI_UTF16_BYTE_ORDER_MARK_NATIVE</a></div><div class="ttdeci">#define UNI_UTF16_BYTE_ORDER_MARK_NATIVE</div><div class="ttdef"><b>Definition:</b> <a href="ConvertUTF_8h_source.html#l00142">ConvertUTF.h:142</a></div></div>
<div class="ttc" id="aFileSystem_8h_html"><div class="ttname"><a href="FileSystem_8h.html">FileSystem.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_aa8e20bc263db62de532feb3d46aead63"><div class="ttname"><a href="namespacellvm_1_1sys.html#aa8e20bc263db62de532feb3d46aead63">llvm::sys::ChangeStdoutMode</a></div><div class="ttdeci">std::error_code ChangeStdoutMode(fs::OpenFlags Flags)</div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_ad0f54a163ac500b144590640c6f1eb6b"><div class="ttname"><a href="classllvm_1_1StringRef.html#ad0f54a163ac500b144590640c6f1eb6b">llvm::StringRef::npos</a></div><div class="ttdeci">static constexpr size_t npos</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00052">StringRef.h:52</a></div></div>
<div class="ttc" id="aPath_8h_html"><div class="ttname"><a href="Path_8h.html">Path.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_a7defb51d8d6a2eba7a428d1a22f08bad"><div class="ttname"><a href="namespacellvm_1_1sys.html#a7defb51d8d6a2eba7a428d1a22f08bad">llvm::sys::Wait</a></div><div class="ttdeci">ProcessInfo Wait(const ProcessInfo &amp;PI, std::optional&lt; unsigned &gt; SecondsToWait, std::string *ErrMsg=nullptr, std::optional&lt; ProcessStatistics &gt; *ProcStat=nullptr, bool Polling=false)</div><div class="ttdoc">This function waits for the process specified by PI to finish.</div></div>
<div class="ttc" id="aWindowsSupport_8h_html"><div class="ttname"><a href="WindowsSupport_8h.html">WindowsSupport.h</a></div></div>
<div class="ttc" id="aErrc_8h_html"><div class="ttname"><a href="Errc_8h.html">Errc.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_ae1fa64c0bf9c723c5960fdd815df37df"><div class="ttname"><a href="namespacellvm_1_1sys.html#ae1fa64c0bf9c723c5960fdd815df37df">llvm::sys::writeFileWithEncoding</a></div><div class="ttdeci">std::error_code writeFileWithEncoding(StringRef FileName, StringRef Contents, WindowsEncodingMethod Encoding=WEM_UTF8)</div><div class="ttdoc">Saves the UTF8-encoded contents string into the file FileName using a specific encoding.</div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aREADME__P9_8txt_html_ae070adaf1b4bf0e7c12fcae2b9c5ae67"><div class="ttname"><a href="README__P9_8txt.html#ae070adaf1b4bf0e7c12fcae2b9c5ae67">result</a></div><div class="ttdeci">It looks like we only need to define PPCfmarto for these because according to these instructions perform RTO on fma s result</div><div class="ttdef"><b>Definition:</b> <a href="README__P9_8txt_source.html#l00256">README_P9.txt:256</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_aad87650fa22966074a3b341d0e5cef6caf0fd365beea6ebcbd1e26eb24015da53"><div class="ttname"><a href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6caf0fd365beea6ebcbd1e26eb24015da53">llvm::sys::WEM_UTF8</a></div><div class="ttdeci">@ WEM_UTF8</div><div class="ttdoc">UTF-8 is the LLVM native encoding, being the same as &quot;do not perform     encoding conversion&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="Program_8h_source.html#l00172">Program.h:172</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a662978c0cdf81de0d448032f142a3695a8e4195851e96284a52d5270ff40950b7"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695a8e4195851e96284a52d5270ff40950b7">llvm::sys::fs::OF_CRLF</a></div><div class="ttdeci">@ OF_CRLF</div><div class="ttdoc">The file should use a carriage linefeed '\r '.</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00765">FileSystem.h:765</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a58dcbf859a69b30932a6ed45806f8a5b"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a58dcbf859a69b30932a6ed45806f8a5b">llvm::sys::path::make_preferred</a></div><div class="ttdeci">void make_preferred(SmallVectorImpl&lt; char &gt; &amp;path, Style style=Style::native)</div><div class="ttdoc">For Windows path styles, convert path to use the preferred path separators.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8h_source.html#l00269">Path.h:269</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="astructllvm_1_1sys_1_1ProcessInfo_html_a8f904a7e686cd044958b4eceb4297cde"><div class="ttname"><a href="structllvm_1_1sys_1_1ProcessInfo.html#a8f904a7e686cd044958b4eceb4297cde">llvm::sys::ProcessInfo::ProcessInfo</a></div><div class="ttdeci">ProcessInfo()</div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_ac35445acb02a4d09fe5aeaeaa3ad5165"><div class="ttname"><a href="namespacellvm_1_1sys.html#ac35445acb02a4d09fe5aeaeaa3ad5165">llvm::sys::ChangeStdoutToBinary</a></div><div class="ttdeci">std::error_code ChangeStdoutToBinary()</div></div>
<div class="ttc" id="alog_8txt_html_aa3ab6cc3a59c1050d2f016175ec5c682"><div class="ttname"><a href="log_8txt.html#aa3ab6cc3a59c1050d2f016175ec5c682">h</a></div><div class="ttdeci">IR OperandTraits h</div><div class="ttdef"><b>Definition:</b> <a href="log_8txt_source.html#l00005">log.txt:5</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">llvm::ms_demangle::QualifierMangleMode::Result</a></div><div class="ttdeci">@ Result</div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html_a6e0cbc5c8568d8446c284c8538b2c9f1"><div class="ttname"><a href="classllvm_1_1raw__ostream.html#a6e0cbc5c8568d8446c284c8538b2c9f1">llvm::raw_ostream::write</a></div><div class="ttdeci">raw_ostream &amp; write(unsigned char C)</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8cpp_source.html#l00219">raw_ostream.cpp:219</a></div></div>
<div class="ttc" id="anamespacellvm_html_af0799d74677708a87dee45acdd40bab2"><div class="ttname"><a href="namespacellvm.html#af0799d74677708a87dee45acdd40bab2">llvm::mapWindowsError</a></div><div class="ttdeci">std::error_code mapWindowsError(unsigned EV)</div></div>
<div class="ttc" id="aBitVector_8h_html"><div class="ttname"><a href="BitVector_8h.html">BitVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_ac10322dc19a928c2dbb83ec9689dc23caac70412e939d72a9234cdebb1af5867b"><div class="ttname"><a href="namespacellvm_1_1pdb.html#ac10322dc19a928c2dbb83ec9689dc23caac70412e939d72a9234cdebb1af5867b">llvm::pdb::PDB_ColorItem::Path</a></div><div class="ttdeci">@ Path</div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d"><div class="ttname"><a href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">llvm::omp::RTLDependInfoFields::Len</a></div><div class="ttdeci">@ Len</div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a662978c0cdf81de0d448032f142a3695ab505c2c79499fbe180989bffbf108a50"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695ab505c2c79499fbe180989bffbf108a50">llvm::sys::fs::OF_TextWithCRLF</a></div><div class="ttdeci">@ OF_TextWithCRLF</div><div class="ttdoc">The file should be opened in text mode and use a carriage linefeed '\r '.</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00770">FileSystem.h:770</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aHexagonBitTracker_8cpp_html_a2e1b5bd9424a1d1082d4bd670b1a0be6"><div class="ttname"><a href="HexagonBitTracker_8cpp.html#a2e1b5bd9424a1d1082d4bd670b1a0be6">rc</a></div><div class="ttdeci">#define rc(i)</div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_a74b492689c767075c865526e04296d02"><div class="ttname"><a href="namespacellvm_1_1sys.html#a74b492689c767075c865526e04296d02">llvm::sys::ChangeStdinToBinary</a></div><div class="ttdeci">std::error_code ChangeStdinToBinary()</div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">llvm::MipsISD::Ext</a></div><div class="ttdeci">@ Ext</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00159">MipsISelLowering.h:159</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a645a607ffcccb12f16a5736db991e7d9"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a645a607ffcccb12f16a5736db991e7d9">llvm::sys::fs::exists</a></div><div class="ttdeci">bool exists(const basic_file_status &amp;status)</div><div class="ttdoc">Does file exist?</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l01077">Path.cpp:1077</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_aad87650fa22966074a3b341d0e5cef6c"><div class="ttname"><a href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6c">llvm::sys::WindowsEncodingMethod</a></div><div class="ttdeci">WindowsEncodingMethod</div><div class="ttdoc">File encoding options when writing contents that a non-UTF8 tool will read (on Windows systems).</div><div class="ttdef"><b>Definition:</b> <a href="Program_8h_source.html#l00169">Program.h:169</a></div></div>
<div class="ttc" id="aStringExtras_8h_html"><div class="ttname"><a href="StringExtras_8h.html">StringExtras.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SDWA_html_a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SDWA.html#a487d59303b94fbf4adddd9a08c30da0aaddbc3f8d705f646af626fd73cdf3618b">llvm::AMDGPU::SDWA::DWORD</a></div><div class="ttdeci">@ DWORD</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00782">SIDefines.h:782</a></div></div>
<div class="ttc" id="anamespacellvm_html_a737f46882195837060ea24b51019969d"><div class="ttname"><a href="namespacellvm.html#a737f46882195837060ea24b51019969d">llvm::MakeErrMsg</a></div><div class="ttdeci">bool MakeErrMsg(std::string *ErrMsg, const std::string &amp;prefix)</div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ae2bb081d94f22e64ca6bc4bd58512a93"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a></div><div class="ttdeci">&lt;%struct.s * &gt; cast struct s *S to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *agg result to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *memtmp to sbyte *&lt; sbyte * &gt; sbyte uint ret void llc ends up issuing two memcpy or custom lower memcpy(of small size) to be ldmia/stmia. I think option 2 is better but the current register allocator cannot allocate a chunk of registers at a time. A feasible temporary solution is to use specific physical registers at the lowering time for small(&lt;</div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">llvm::codeview::CompileSym2Flags::EC</a></div><div class="ttdeci">@ EC</div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_aad87650fa22966074a3b341d0e5cef6ca4a36ece054fa83562738192455180088"><div class="ttname"><a href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6ca4a36ece054fa83562738192455180088">llvm::sys::WEM_CurrentCodePage</a></div><div class="ttdeci">@ WEM_CurrentCodePage</div><div class="ttdef"><b>Definition:</b> <a href="Program_8h_source.html#l00173">Program.h:173</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1windows_html_accc4b526d349a99a2a18875de6b36b5c"><div class="ttname"><a href="namespacellvm_1_1sys_1_1windows.html#accc4b526d349a99a2a18875de6b36b5c">llvm::sys::windows::widenPath</a></div><div class="ttdeci">std::error_code widenPath(const Twine &amp;Path8, SmallVectorImpl&lt; wchar_t &gt; &amp;Path16, size_t MaxPathLen=MAX_PATH)</div><div class="ttdoc">Convert UTF-8 path to a suitable UTF-16 path for use with the Win32 Unicode File API.</div></div>
<div class="ttc" id="anamespacellvm_html_a52d5a456ff24b34840b071b305691f24"><div class="ttname"><a href="namespacellvm.html#a52d5a456ff24b34840b071b305691f24">llvm::ScopedJobHandle</a></div><div class="ttdeci">ScopedHandle&lt; JobHandleTraits &gt; ScopedJobHandle</div><div class="ttdef"><b>Definition:</b> <a href="WindowsSupport_8h_source.html#l00189">WindowsSupport.h:189</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="anamespacellvm_html_a39d3d23a084c4544ee5903203db10e8a"><div class="ttname"><a href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a></div><div class="ttdeci">void append_range(Container &amp;C, Range &amp;&amp;R)</div><div class="ttdoc">Wrapper function to append a range to a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l02014">STLExtras.h:2014</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__fd__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__fd__ostream.html">llvm::raw_fd_ostream</a></div><div class="ttdoc">A raw_ostream that writes to a file descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00454">raw_ostream.h:454</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aConvertUTF_8h_html"><div class="ttname"><a href="ConvertUTF_8h.html">ConvertUTF.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a20e3e08c7de6a230cd66f9e4322c3fbe"><div class="ttname"><a href="namespacellvm.html#a20e3e08c7de6a230cd66f9e4322c3fbe">llvm::make_error_code</a></div><div class="ttdeci">std::error_code make_error_code(BitcodeError E)</div><div class="ttdef"><b>Definition:</b> <a href="BitcodeReader_8h_source.html#l00311">BitcodeReader.h:311</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_aad87650fa22966074a3b341d0e5cef6ca89ceaeaaf604a94c4691ea915ada8c3c"><div class="ttname"><a href="namespacellvm_1_1sys.html#aad87650fa22966074a3b341d0e5cef6ca89ceaeaaf604a94c4691ea915ada8c3c">llvm::sys::WEM_UTF16</a></div><div class="ttdeci">@ WEM_UTF16</div><div class="ttdef"><b>Definition:</b> <a href="Program_8h_source.html#l00174">Program.h:174</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_a1b6956e6c738949193efee28bffe29f5"><div class="ttname"><a href="namespacellvm_1_1sys.html#a1b6956e6c738949193efee28bffe29f5">llvm::sys::ChangeStdinMode</a></div><div class="ttdeci">std::error_code ChangeStdinMode(fs::OpenFlags Flags)</div></div>
<div class="ttc" id="anamespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00050">GraphWriter.h:50</a></div></div>
<div class="ttc" id="aclassuint16__t_html"><div class="ttname"><a href="classuint16__t.html">uint16_t</a></div></div>
<div class="ttc" id="anamespacellvm_html_af11d71816b6dc7c266e71fcff02be291"><div class="ttname"><a href="namespacellvm.html#af11d71816b6dc7c266e71fcff02be291">llvm::c_str</a></div><div class="ttdeci">SmallVectorImpl&lt; T &gt;::const_pointer c_str(SmallVectorImpl&lt; T &gt; &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="WindowsSupport_8h_source.html#l00196">WindowsSupport.h:196</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_a1a420333641cfdaa22a032c78e92aa55"><div class="ttname"><a href="namespacellvm_1_1sys.html#a1a420333641cfdaa22a032c78e92aa55">llvm::sys::toDuration</a></div><div class="ttdeci">std::chrono::nanoseconds toDuration(FILETIME Time)</div><div class="ttdef"><b>Definition:</b> <a href="WindowsSupport_8h_source.html#l00204">WindowsSupport.h:204</a></div></div>
<div class="ttc" id="anamespacellvm_html_a59739a4f15fb2ec57a6b7fcfe938546bacccc32f2a5f7dc7b87d2f85daea66789"><div class="ttname"><a href="namespacellvm.html#a59739a4f15fb2ec57a6b7fcfe938546bacccc32f2a5f7dc7b87d2f85daea66789">llvm::errc::io_error</a></div><div class="ttdeci">@ io_error</div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a662978c0cdf81de0d448032f142a3695"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a662978c0cdf81de0d448032f142a3695">llvm::sys::fs::OpenFlags</a></div><div class="ttdeci">OpenFlags</div><div class="ttdef"><b>Definition:</b> <a href="FileSystem_8h_source.html#l00756">FileSystem.h:756</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1b31339301d33bf27bd0bdddeb289738"><div class="ttname"><a href="namespacellvm.html#a1b31339301d33bf27bd0bdddeb289738">llvm::ScopedCommonHandle</a></div><div class="ttdeci">ScopedHandle&lt; CommonHandleTraits &gt; ScopedCommonHandle</div><div class="ttdef"><b>Definition:</b> <a href="WindowsSupport_8h_source.html#l00184">WindowsSupport.h:184</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_aeedab8a7355d9f65b7c2ba263ddc2065"><div class="ttname"><a href="namespacellvm_1_1numbers.html#aeedab8a7355d9f65b7c2ba263ddc2065">llvm::numbers::pi</a></div><div class="ttdeci">constexpr double pi</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00037">MathExtras.h:37</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_a5f126cc7b64d31cd709215b48656d83d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#a5f126cc7b64d31cd709215b48656d83d">llvm::sys::fs::status</a></div><div class="ttdeci">std::error_code status(const Twine &amp;path, file_status &amp;result, bool follow=true)</div><div class="ttdoc">Get file status as if by POSIX stat().</div></div>
<div class="ttc" id="anamespacellvm_html_ab9c6b351507d3c0730f4290919d43a12"><div class="ttname"><a href="namespacellvm.html#ab9c6b351507d3c0730f4290919d43a12">llvm::ArrayRef</a></div><div class="ttdeci">ArrayRef(const T &amp;OneElt) -&gt; ArrayRef&lt; T &gt;</div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_html_a8f03c560e53b510e60a472723126bb52"><div class="ttname"><a href="namespacellvm_1_1sys.html#a8f03c560e53b510e60a472723126bb52">llvm::sys::commandLineFitsWithinSystemLimits</a></div><div class="ttdeci">bool commandLineFitsWithinSystemLimits(StringRef Program, ArrayRef&lt; StringRef &gt; Args)</div><div class="ttdoc">Return true if the given arguments fit within system-specific argument length limits.</div></div>
<div class="ttc" id="alib_2Target_2WebAssembly_2README_8txt_html_a79ea041233b5866026c3071dfc464ec0"><div class="ttname"><a href="lib_2Target_2WebAssembly_2README_8txt.html#a79ea041233b5866026c3071dfc464ec0">copy</a></div><div class="ttdeci">we should consider alternate ways to model stack dependencies Lots of things could be done in WebAssemblyTargetTransformInfo cpp there are numerous optimization related hooks that can be overridden in WebAssemblyTargetLowering Instead of the OptimizeReturned which should consider preserving the returned attribute through to MachineInstrs and extending the MemIntrinsicResults pass to do this optimization on calls too That would also let the WebAssemblyPeephole pass clean up dead defs for such as it does for stores Consider implementing and or getMachineCombinerPatterns Find a clean way to fix the problem which leads to the Shrink Wrapping pass being run after the WebAssembly PEI pass When setting multiple variables to the same we currently get code like const It could be done with a smaller encoding like local tee $pop5 local copy</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2WebAssembly_2README_8txt_source.html#l00101">README.txt:101</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a39ee700138913a49bc90faf2c1db0b9ba40cd014b7b6251e3a22e6a45a73a64e1"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a39ee700138913a49bc90faf2c1db0b9ba40cd014b7b6251e3a22e6a45a73a64e1">llvm::pdb::OMFSegDescFlags::Execute</a></div><div class="ttdeci">@ Execute</div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1fs_html_ad3a7c62e8f9554d7f8e7fdb989f1c68e"><div class="ttname"><a href="namespacellvm_1_1sys_1_1fs.html#ad3a7c62e8f9554d7f8e7fdb989f1c68e">llvm::sys::fs::can_execute</a></div><div class="ttdeci">bool can_execute(const Twine &amp;Path)</div><div class="ttdoc">Can we execute this file?</div></div>
<div class="ttc" id="aWindowsError_8h_html"><div class="ttname"><a href="WindowsError_8h.html">WindowsError.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:07:46 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
