<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Scalar/LoopInterchange.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_e6e1f1f37d351595fa984b942927b205.html">Scalar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LoopInterchange.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="LoopInterchange_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- LoopInterchange.cpp - Loop interchange pass-------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This Pass handles loop interchange transform.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// This pass interchanges loops to provide a more cache-friendly memory access</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// patterns.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInterchange_8h.html">llvm/Transforms/Scalar/LoopInterchange.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DependenceAnalysis_8h.html">llvm/Analysis/DependenceAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopCacheAnalysis_8h.html">llvm/Analysis/LoopCacheAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopNestAnalysis_8h.html">llvm/Analysis/LoopNestAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopPass_8h.html">llvm/Analysis/LoopPass.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolution_8h.html">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolutionExpressions_8h.html">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DiagnosticInfo_8h.html">llvm/IR/DiagnosticInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="User_8h.html">llvm/IR/User.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopPassManager_8h.html">llvm/Transforms/Scalar/LoopPassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopUtils_8h.html">llvm/Transforms/Utils/LoopUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   56</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;loop-interchange&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(LoopsInterchanged, <span class="stringliteral">&quot;Number of loops interchanged&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="LoopInterchange_8cpp.html#a41e5bdc1b4af2dfdf79d6925bdaf4dab">LoopInterchangeCostThreshold</a>(</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="stringliteral">&quot;loop-interchange-threshold&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(0), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Interchange if you gain more than this number&quot;</span>));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">using</span> LoopVector = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Loop *, 8&gt;</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// TODO: Check if we can use a sparse matrix here.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">using</span> CharMatrix = std::vector&lt;std::vector&lt;char&gt;&gt;;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// Maximum number of dependencies that can be handled in the dependency matrix.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#ad79065fb9f4aed2ac594495597b9b1c8">   74</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopInterchange_8cpp.html#ad79065fb9f4aed2ac594495597b9b1c8">MaxMemInstrCount</a> = 100;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">// Maximum loop depth supported.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a7d11a8560b7f0dc294b5799593571228">   77</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="LoopInterchange_8cpp.html#a7d11a8560b7f0dc294b5799593571228">MaxLoopNestDepth</a> = 10;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#ifdef DUMP_DEP_MATRICIES</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> printDepMatrix(CharMatrix &amp;DepMatrix) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Row : DepMatrix) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> : Row)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#aff1e7d5809a00598adae1a0f4476fec7">   89</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopInterchange_8cpp.html#aff1e7d5809a00598adae1a0f4476fec7">populateDependencyMatrix</a>(CharMatrix &amp;DepMatrix, <span class="keywordtype">unsigned</span> Level,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                     <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1DependenceInfo.html">DependenceInfo</a> *DI,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                     <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">using</span> ValueVector = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 16&gt;</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  ValueVector MemInstr;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// For each block.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>()) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Scan the BB and collect legal loads and stores.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;Instruction&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Ld = dyn_cast&lt;LoadInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (!Ld-&gt;isSimple())</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        MemInstr.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *St = dyn_cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span> (!St-&gt;isSimple())</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        MemInstr.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; MemInstr.size()</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; Loads and Stores to analyze\n&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  ValueVector::iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>, J, JE;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = MemInstr.begin(), <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a> = MemInstr.end(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">for</span> (J = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, JE = MemInstr.end(); J != JE; ++J) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      std::vector&lt;char&gt; Dep;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Src = cast&lt;Instruction&gt;(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Dst = cast&lt;Instruction&gt;(*J);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="comment">// Ignore Input dependencies.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(Src) &amp;&amp; isa&lt;LoadInst&gt;(Dst))</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">// Track Output, Flow, and Anti dependencies.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a> = DI-&gt;<a class="code" href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">depends</a>(Src, Dst, <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isOrdered() &amp;&amp; <span class="stringliteral">&quot;Expected an output, flow or anti dep.&quot;</span>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// If the direction vector is negative, normalize it to</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// make it non-negative.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;normalize(SE))</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Negative dependence vector normalized.\n&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> DepType =</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                       <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isFlow() ? <span class="stringliteral">&quot;flow&quot;</span> : <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isAnti() ? <span class="stringliteral">&quot;anti&quot;</span> : <span class="stringliteral">&quot;output&quot;</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                   <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; DepType</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; dependency between Src and Dst\n&quot;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; Src:&quot;</span> &lt;&lt; *Src &lt;&lt; <span class="stringliteral">&quot;\n Dst:&quot;</span> &lt;&lt; *Dst &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordtype">unsigned</span> Levels = <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;getLevels();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">char</span> <a class="code" href="LoopInfo_8cpp.html#ab4c7e3039b29b12e4dc97bcae93d79c3">Direction</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> II = 1; II &lt;= Levels; ++II) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;isScalar(II)) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> = <span class="charliteral">&#39;S&#39;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            Dep.push_back(<a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordtype">unsigned</span> Dir = <a class="code" href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a>-&gt;getDirection(II);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">if</span> (Dir == <a class="code" href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea5796b2f4edcf01eb52e88d01493f1d58">Dependence::DVEntry::LT</a> ||</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                Dir == <a class="code" href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea76afd933ba76f92a06c8b0f90cccfd1f">Dependence::DVEntry::LE</a>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;              <a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> = <span class="charliteral">&#39;&lt;&#39;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dir == <a class="code" href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea03e1c9598683e23868735e72b8caaabd">Dependence::DVEntry::GT</a> ||</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                     Dir == <a class="code" href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea5e8f49d1ad8ec7e245f3afb075bb7844">Dependence::DVEntry::GE</a>)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;              <a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> = <span class="charliteral">&#39;&gt;&#39;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dir == <a class="code" href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cead4051c16e1d2336250f8e267c1e03281">Dependence::DVEntry::EQ</a>)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;              <a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> = <span class="charliteral">&#39;=&#39;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;              <a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> = <span class="charliteral">&#39;*&#39;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            Dep.push_back(<a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">while</span> (Dep.size() != Level) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          Dep.push_back(<span class="charliteral">&#39;I&#39;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        DepMatrix.push_back(Dep);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span> (DepMatrix.size() &gt; <a class="code" href="LoopInterchange_8cpp.html#ad79065fb9f4aed2ac594495597b9b1c8">MaxMemInstrCount</a>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cannot handle more than &quot;</span> &lt;&lt; <a class="code" href="LoopInterchange_8cpp.html#ad79065fb9f4aed2ac594495597b9b1c8">MaxMemInstrCount</a></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; dependencies inside loop\n&quot;</span>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">// A loop is moved from index &#39;from&#39; to an index &#39;to&#39;. Update the Dependence</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">// matrix by exchanging the two columns.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a6fdefa5e30cfe78c973990812d4a8900">  179</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopInterchange_8cpp.html#a6fdefa5e30cfe78c973990812d4a8900">interChangeDependencies</a>(CharMatrix &amp;DepMatrix, <span class="keywordtype">unsigned</span> FromIndx,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                    <span class="keywordtype">unsigned</span> ToIndx) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = DepMatrix.size(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(DepMatrix[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>][ToIndx], DepMatrix[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>][FromIndx]);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">// After interchanging, check if the direction vector is valid.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">// [Theorem] A permutation of the loops in a perfect nest is legal if and only</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">// if the direction matrix, after the same permutation is applied to its</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">// columns, has no &quot;&gt;&quot; direction as the leftmost non-&quot;=&quot; direction in any row.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#aea03c1dffdd4b48507295e18f88601a7">  189</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopInterchange_8cpp.html#aea03c1dffdd4b48507295e18f88601a7">isLexicographicallyPositive</a>(std::vector&lt;char&gt; &amp;DV) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Level = 0; Level &lt; DV.size(); ++Level) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> = DV[Level];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> == <span class="charliteral">&#39;&lt;&#39;</span>)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> == <span class="charliteral">&#39;&gt;&#39;</span> || <a class="code" href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">Direction</a> == <span class="charliteral">&#39;*&#39;</span>)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">// Checks if it is legal to interchange 2 loops.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#ad16cef97c234c14b44e54eb45763a8c8">  201</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopInterchange_8cpp.html#ad16cef97c234c14b44e54eb45763a8c8">isLegalToInterChangeLoops</a>(CharMatrix &amp;DepMatrix,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                      <span class="keywordtype">unsigned</span> InnerLoopId,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                      <span class="keywordtype">unsigned</span> OuterLoopId) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">unsigned</span> NumRows = DepMatrix.size();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  std::vector&lt;char&gt; Cur;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// For each row check if it is valid to interchange.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Row = 0; Row &lt; NumRows; ++Row) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Create temporary DepVector check its lexicographical order</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// before and after swapping OuterLoop vs InnerLoop</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    Cur = DepMatrix[Row];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="LoopInterchange_8cpp.html#aea03c1dffdd4b48507295e18f88601a7">isLexicographicallyPositive</a>(Cur))</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Cur[InnerLoopId], Cur[OuterLoopId]);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="LoopInterchange_8cpp.html#aea03c1dffdd4b48507295e18f88601a7">isLexicographicallyPositive</a>(Cur))</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#ada6d2508cfa150fd7974bef2dc21c40f">  220</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopInterchange_8cpp.html#ada6d2508cfa150fd7974bef2dc21c40f">populateWorklist</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> &amp;L, LoopVector &amp;LoopList) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Calling populateWorklist on Func: &quot;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    &lt;&lt; L.<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="stringliteral">&quot; Loop: %&quot;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    &lt;&lt; L.<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoopList.empty() &amp;&amp; <span class="stringliteral">&quot;LoopList should initially be empty!&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurrentLoop = &amp;L;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keyword">const</span> std::vector&lt;Loop *&gt; *Vec = &amp;CurrentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a47bb4b8ffdd881717123e9b244a10b12">getSubLoops</a>();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">while</span> (!Vec-&gt;empty()) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// The current loop has multiple subloops in it hence it is not tightly</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// nested.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Discard all loops above it added into Worklist.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (Vec-&gt;size() != 1) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      LoopList = {};</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    LoopList.push_back(CurrentLoop);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    CurrentLoop = Vec-&gt;front();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    Vec = &amp;CurrentLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a47bb4b8ffdd881717123e9b244a10b12">getSubLoops</a>();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  LoopList.push_back(CurrentLoop);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">/// LoopInterchangeLegality checks if it is legal to interchange the loop.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span><span class="keyword">class </span>LoopInterchangeLegality {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  LoopInterchangeLegality(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *Outer, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Inner, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                          <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      : OuterLoop(<a class="code" href="namespacellvm_1_1codeview.html#a7c84cffd04a037f3e087b309bf176929ae6e36dccbeaf26fca4a6813bf2e83a28">Outer</a>), InnerLoop(Inner), SE(SE), ORE(ORE) {}</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">  /// Check if the loops can be interchanged.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> canInterchangeLoops(<span class="keywordtype">unsigned</span> InnerLoopId, <span class="keywordtype">unsigned</span> OuterLoopId,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                           CharMatrix &amp;DepMatrix);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">  /// Discover induction PHIs in the header of \p L. Induction</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  /// PHIs are added to \p Inductions.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> findInductions(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;PHINode *&gt;</a> &amp;Inductions);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">  /// Check if the loop structure is understood. We do not handle triangular</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">  /// loops for now.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isLoopStructureUnderstood();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordtype">bool</span> currentLimitations();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;PHINode *&gt;</a> &amp;getOuterInnerReductions()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">return</span> OuterInnerReductions;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;PHINode *&gt;</a> &amp;getInnerLoopInductions()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> InnerLoopInductions;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">bool</span> tightlyNested(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *Outer, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Inner);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">bool</span> containsUnsafeInstructions(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">  /// Discover induction and reduction PHIs in the header of \p L. Induction</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">  /// PHIs are added to \p Inductions, reductions are added to</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">  /// OuterInnerReductions. When the outer loop is passed, the inner loop needs</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  /// to be passed as \p InnerLoop.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> findInductionAndReductions(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> &amp;Inductions,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">  /// Interface to emit optimization remarks.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">  /// Set of reduction PHIs taking part of a reduction across the inner and</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">  /// outer loop.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;PHINode *, 4&gt;</a> OuterInnerReductions;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">  /// Set of inner loop induction PHIs</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> InnerLoopInductions;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;};</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">/// LoopInterchangeProfitability checks if it is profitable to interchange the</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/// loop.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span><span class="keyword">class </span>LoopInterchangeProfitability {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  LoopInterchangeProfitability(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *Outer, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Inner, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                               <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      : OuterLoop(<a class="code" href="namespacellvm_1_1codeview.html#a7c84cffd04a037f3e087b309bf176929ae6e36dccbeaf26fca4a6813bf2e83a28">Outer</a>), InnerLoop(Inner), SE(SE), ORE(ORE) {}</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">  /// Check if the loop interchange is profitable.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isProfitable(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <span class="keywordtype">unsigned</span> InnerLoopId, <span class="keywordtype">unsigned</span> OuterLoopId,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    CharMatrix &amp;DepMatrix,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Loop *, unsigned&gt;</a> &amp;CostMap,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    std::unique_ptr&lt;CacheCost&gt; &amp;<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">int</span> getInstrOrderCost();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  std::optional&lt;bool&gt; isProfitablePerLoopCacheAnalysis(</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Loop *, unsigned&gt;</a> &amp;CostMap,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      std::unique_ptr&lt;CacheCost&gt; &amp;<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  std::optional&lt;bool&gt; isProfitablePerInstrOrderCost();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  std::optional&lt;bool&gt; isProfitableForVectorization(<span class="keywordtype">unsigned</span> InnerLoopId,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                                   <span class="keywordtype">unsigned</span> OuterLoopId,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                                   CharMatrix &amp;DepMatrix);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">  /// Scev analysis.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">  /// Interface to emit optimization remarks.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;};</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">/// LoopInterchangeTransform interchanges the loop.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span><span class="keyword">class </span>LoopInterchangeTransform {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  LoopInterchangeTransform(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *Outer, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *Inner, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                           <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                           <span class="keyword">const</span> LoopInterchangeLegality &amp;LIL)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      : OuterLoop(<a class="code" href="namespacellvm_1_1codeview.html#a7c84cffd04a037f3e087b309bf176929ae6e36dccbeaf26fca4a6813bf2e83a28">Outer</a>), InnerLoop(Inner), SE(SE), LI(LI), DT(DT), LIL(LIL) {}</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">  /// Interchange OuterLoop and InnerLoop.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a615619b0b2879029152b9a20e96624bc">transform</a>();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordtype">void</span> restructureLoops(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *NewInner, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *NewOuter,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigInnerPreHeader,</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                        <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigOuterPreHeader);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">void</span> removeChildLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordtype">bool</span> adjustLoopLinks();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">bool</span> adjustLoopBranches();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">  /// Scev analysis.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">const</span> LoopInterchangeLegality &amp;LIL;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;};</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keyword">struct </span>LoopInterchange {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="classllvm_1_1DependenceInfo.html">DependenceInfo</a> *DI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  std::unique_ptr&lt;CacheCost&gt; <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">  /// Interface to emit optimization remarks.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  LoopInterchange(<a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI, <a class="code" href="classllvm_1_1DependenceInfo.html">DependenceInfo</a> *DI,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT, std::unique_ptr&lt;CacheCost&gt; &amp;<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> *ORE)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      : SE(SE), LI(LI), DI(DI), DT(DT), <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>(<a class="code" href="namespacestd.html">std</a>::<a class="code" href="namespacellvm.html#abfc9c7ecf70f66901e439f7c04ef3dbb">move</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>)), ORE(ORE) {}</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">run</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a62733c3335a87750623dbfc5b3ae4f6c">getParentLoop</a>())</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Loop *, 8&gt;</a> LoopList;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="LoopInterchange_8cpp.html#ada6d2508cfa150fd7974bef2dc21c40f">populateWorklist</a>(*L, LoopList);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">return</span> processLoopList(LoopList);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">run</a>(<a class="code" href="classllvm_1_1LoopNest.html">LoopNest</a> &amp;LN) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Loop *, 8&gt;</a> LoopList(LN.<a class="code" href="classllvm_1_1LoopNest.html#a76910b27c22c1ec00680bc5362806678">getLoops</a>().begin(), LN.<a class="code" href="classllvm_1_1LoopNest.html#a76910b27c22c1ec00680bc5362806678">getLoops</a>().end());</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; LoopList.size(); ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">if</span> (LoopList[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]-&gt;getParentLoop() != LoopList[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> - 1])</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">return</span> processLoopList(LoopList);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordtype">bool</span> isComputableLoopNest(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Loop *&gt;</a> LoopList) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : LoopList) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *ExitCountOuter = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a22d9bcbd44563106d7217f3bd9a4039e">getBackedgeTakenCount</a>(L);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">if</span> (isa&lt;SCEVCouldNotCompute&gt;(ExitCountOuter)) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t compute backedge count\n&quot;</span>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a389bb3581ba3c8094b89642efaf8e514">getNumBackEdges</a>() != 1) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;NumBackEdges is not equal to 1\n&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">getExitingBlock</a>()) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop doesn&#39;t have unique exit block\n&quot;</span>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">unsigned</span> selectLoopForInterchange(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Loop *&gt;</a> LoopList) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// TODO: Add a better heuristic to select the loop to be interchanged based</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// on the dependence matrix. Currently we select the innermost loop.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">return</span> LoopList.<a class="code" href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>() - 1;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordtype">bool</span> processLoopList(<a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Loop *&gt;</a> &amp;LoopList) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">unsigned</span> LoopNestDepth = LoopList.size();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (LoopNestDepth &lt; 2) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop doesn&#39;t contain minimum nesting level.\n&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (LoopNestDepth &gt; <a class="code" href="LoopInterchange_8cpp.html#a7d11a8560b7f0dc294b5799593571228">MaxLoopNestDepth</a>) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cannot handle loops of depth greater than &quot;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        &lt;&lt; <a class="code" href="LoopInterchange_8cpp.html#a7d11a8560b7f0dc294b5799593571228">MaxLoopNestDepth</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (!isComputableLoopNest(LoopList)) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Not valid loop candidate for interchange\n&quot;</span>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Processing LoopList of size = &quot;</span> &lt;&lt; LoopNestDepth</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    CharMatrix DependencyMatrix;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterMostLoop = *(LoopList.begin());</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="LoopInterchange_8cpp.html#aff1e7d5809a00598adae1a0f4476fec7">populateDependencyMatrix</a>(DependencyMatrix, LoopNestDepth,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                  OuterMostLoop, DI, SE)) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Populating dependency matrix failed\n&quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#ifdef DUMP_DEP_MATRICIES</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Dependence before interchange\n&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    printDepMatrix(DependencyMatrix);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// Get the Outermost loop exit.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopNestExit = OuterMostLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (!LoopNestExit) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;OuterMostLoop needs an unique exit block&quot;</span>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordtype">unsigned</span> SelecLoopId = selectLoopForInterchange(LoopList);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// Obtain the loop vector returned from loop cache analysis beforehand,</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// and put each &lt;Loop, index&gt; pair into a map for constant time query</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// later. Indices in loop vector reprsent the optimal order of the</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// corresponding loop, e.g., given a loopnest with depth N, index 0</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// indicates the loop should be placed as the outermost loop and index N</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// indicates the loop should be placed as the innermost loop.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// For the old pass manager CacheCost would be null.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Loop *, unsigned&gt;</a> CostMap;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;LoopCosts = <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>-&gt;getLoopCosts();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; LoopCosts.size(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        CostMap[LoopCosts[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>].first] = <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// We try to achieve the globally optimal memory access for the loopnest,</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// and do interchange based on a bubble-sort fasion. We start from</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// the innermost loop, move it outwards to the best possible position</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// and repeat this process.</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> = SelecLoopId; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a> &gt; 0; <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>--) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordtype">bool</span> ChangedPerIter = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = SelecLoopId; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; SelecLoopId - <a class="code" href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a>; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>--) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordtype">bool</span> Interchanged = processLoop(LoopList[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>], LoopList[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1], <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                        DependencyMatrix, CostMap);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">if</span> (!Interchanged)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">// Loops interchanged, update LoopList accordingly.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LoopList[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1], LoopList[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">// Update the DependencyMatrix</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="LoopInterchange_8cpp.html#a6fdefa5e30cfe78c973990812d4a8900">interChangeDependencies</a>(DependencyMatrix, <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#ifdef DUMP_DEP_MATRICIES</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Dependence after interchange\n&quot;</span>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        printDepMatrix(DependencyMatrix);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        ChangedPerIter |= Interchanged;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        Changed |= Interchanged;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="comment">// Early abort if there was no interchange during an entire round of</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="comment">// moving loops outwards.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">if</span> (!ChangedPerIter)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">bool</span> processLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop, <span class="keywordtype">unsigned</span> InnerLoopId,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                   <span class="keywordtype">unsigned</span> OuterLoopId,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                   std::vector&lt;std::vector&lt;char&gt;&gt; &amp;DependencyMatrix,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Loop *, unsigned&gt;</a> &amp;CostMap) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Processing InnerLoopId = &quot;</span> &lt;&lt; InnerLoopId</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; and OuterLoopId = &quot;</span> &lt;&lt; OuterLoopId &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    LoopInterchangeLegality LIL(OuterLoop, InnerLoop, SE, ORE);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (!LIL.canInterchangeLoops(InnerLoopId, OuterLoopId, DependencyMatrix)) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Not interchanging loops. Cannot prove legality.\n&quot;</span>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loops are legal to interchange\n&quot;</span>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    LoopInterchangeProfitability LIP(OuterLoop, InnerLoop, SE, ORE);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">if</span> (!LIP.isProfitable(InnerLoop, OuterLoop, InnerLoopId, OuterLoopId,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                          DependencyMatrix, CostMap, <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>)) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Interchanging loops not profitable.\n&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;Interchanged&quot;</span>,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Loop interchanged with enclosing loop.&quot;</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    });</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    LoopInterchangeTransform LIT(OuterLoop, InnerLoop, SE, LI, DT, LIL);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    LIT.transform();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loops interchanged.\n&quot;</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    LoopsInterchanged++;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="namespacellvm.html#a30e47ae014eb35bea24e45097c2bd731">llvm::formLCSSARecursively</a>(*OuterLoop, *DT, LI, SE);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;};</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeLegality::containsUnsafeInstructions(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(*<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayHaveSideEffects() || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayReadFromMemory();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  });</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeLegality::tightlyNested(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopHeader = OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopPreHeader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopLatch = OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Checking if loops are tightly nested\n&quot;</span>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// A perfectly nested loop will not have any branch in between the outer and</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// inner block i.e. outer header will branch to either inner preheader and</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// outerloop latch.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *OuterLoopHeaderBI =</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      dyn_cast&lt;BranchInst&gt;(OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">if</span> (!OuterLoopHeaderBI)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(OuterLoopHeaderBI))</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (Succ != InnerLoopPreHeader &amp;&amp; Succ != InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>() &amp;&amp;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        Succ != OuterLoopLatch)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Checking instructions in Loop header and Loop latch\n&quot;</span>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// We do not have any basic block in between now make sure the outer header</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// and outer loop latch doesn&#39;t contain any unsafe instructions.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (containsUnsafeInstructions(OuterLoopHeader) ||</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      containsUnsafeInstructions(OuterLoopLatch))</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// Also make sure the inner loop preheader does not contain any unsafe</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// instructions. Note that all instructions in the preheader will be moved to</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">// the outer loop header when interchanging.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">if</span> (InnerLoopPreHeader != OuterLoopHeader &amp;&amp;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      containsUnsafeInstructions(InnerLoopPreHeader))</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopExit = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// Ensure the inner loop exit block flows to the outer loop latch possibly</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// through empty blocks.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;SuccInner =</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <a class="code" href="classllvm_1_1LoopNest.html#a0c3d91a5a6e71c114dea21819cc71382">LoopNest::skipEmptyBlockUntil</a>(InnerLoopExit, OuterLoopLatch);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">if</span> (&amp;SuccInner != OuterLoopLatch) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inner loop exit block &quot;</span> &lt;&lt; *InnerLoopExit</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; does not lead to the outer loop latch.\n&quot;</span>;);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// The inner loop exit block does flow to the outer loop latch and not some</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">// other BBs, now make sure it contains safe instructions, since it will be</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// moved into the (new) inner loop after interchange.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">if</span> (containsUnsafeInstructions(InnerLoopExit))</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loops are perfectly nested\n&quot;</span>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// We have a perfect loop nest.</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;}</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeLegality::isLoopStructureUnderstood() {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopPreheader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *InnerInduction : InnerLoopInductions) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">unsigned</span> Num = InnerInduction-&gt;getNumOperands();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Num; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Val = InnerInduction-&gt;getOperand(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">if</span> (isa&lt;Constant&gt;(Val))</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(Val);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="comment">// TODO: Handle triangular loops.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="comment">// e.g. for(int i=0;i&lt;N;i++)</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">//        for(int j=i;j&lt;N;j++)</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordtype">unsigned</span> IncomBlockIndx = <a class="code" href="classllvm_1_1PHINode.html#aca414c43a6d42c13998208463637a20d">PHINode::getIncomingValueNumForOperand</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">if</span> (InnerInduction-&gt;getIncomingBlock(IncomBlockIndx) ==</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;              InnerLoopPreheader &amp;&amp;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          !OuterLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">isLoopInvariant</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">// TODO: Handle triangular loops of another form.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// e.g. for(int i=0;i&lt;N;i++)</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">//        for(int j=0;j&lt;i;j++)</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// or,</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">//      for(int i=0;i&lt;N;i++)</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">//        for(int j=0;j*i&lt;N;j++)</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopLatch = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *InnerLoopLatchBI =</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      dyn_cast&lt;BranchInst&gt;(InnerLoopLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordflow">if</span> (!InnerLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">isConditional</a>())</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CmpInst.html">CmpInst</a> *InnerLoopCmp =</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          dyn_cast&lt;CmpInst&gt;(InnerLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">getCondition</a>())) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op0 = InnerLoopCmp-&gt;getOperand(0);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Op1 = InnerLoopCmp-&gt;getOperand(1);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">// LHS and RHS of the inner loop exit condition, e.g.,</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// in &quot;for(int j=0;j&lt;i;j++)&quot;, LHS is j and RHS is i.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#a2554a96c67bdd7d0a62855a844ec55b0a945d5e233cf7d6240f6b783b36a374ff">Left</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="README__P9_8txt.html#acc80d72f12f6f9e1d8eda2ec3d74133c">Right</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// Check if V only involves inner loop induction variable.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// Return true if V is InnerInduction, or a cast from</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">// InnerInduction, or a binary operator that involves</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// InnerInduction and a constant.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;bool(<a class="code" href="classllvm_1_1Value.html">Value</a> *)&gt; IsPathToInnerIndVar;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    IsPathToInnerIndVar = [<span class="keyword">this</span>, &amp;IsPathToInnerIndVar](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a>(InnerLoopInductions, V))</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">if</span> (isa&lt;CastInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">return</span> IsPathToInnerIndVar(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0));</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">if</span> (isa&lt;BinaryOperator&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">return</span> IsPathToInnerIndVar(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(0)) &amp;&amp;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;               IsPathToInnerIndVar(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOperand(1));</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    };</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">// In case of multiple inner loop indvars, it is okay if LHS and RHS</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// are both inner indvar related variables.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> (IsPathToInnerIndVar(Op0) &amp;&amp; IsPathToInnerIndVar(Op1))</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// Otherwise we check if the cmp instruction compares an inner indvar</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">// related variable (Left) with a outer loop invariant (Right).</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">if</span> (IsPathToInnerIndVar(Op0) &amp;&amp; !isa&lt;Constant&gt;(Op0)) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <a class="code" href="namespacellvm.html#a2554a96c67bdd7d0a62855a844ec55b0a945d5e233cf7d6240f6b783b36a374ff">Left</a> = Op0;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <a class="code" href="README__P9_8txt.html#acc80d72f12f6f9e1d8eda2ec3d74133c">Right</a> = Op1;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsPathToInnerIndVar(Op1) &amp;&amp; !isa&lt;Constant&gt;(Op1)) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <a class="code" href="namespacellvm.html#a2554a96c67bdd7d0a62855a844ec55b0a945d5e233cf7d6240f6b783b36a374ff">Left</a> = Op1;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <a class="code" href="README__P9_8txt.html#acc80d72f12f6f9e1d8eda2ec3d74133c">Right</a> = Op0;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">if</span> (Left == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Right);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, OuterLoop))</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">// If SV is a LCSSA PHI node with a single incoming value, return the incoming</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">// value.</span></div>
<div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a5a88a338e277e1d3708cc4274ef12f9a">  700</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="LoopInterchange_8cpp.html#a5a88a338e277e1d3708cc4274ef12f9a">followLCSSA</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *SV) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = dyn_cast&lt;PHINode&gt;(SV);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">return</span> SV;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getNumIncomingValues() != 1)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">return</span> SV;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="LoopInterchange_8cpp.html#a5a88a338e277e1d3708cc4274ef12f9a">followLCSSA</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getIncomingValue(0));</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;}</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">// Check V&#39;s users to see if it is involved in a reduction in L.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a08a4eaf5865b2e8d68f18281f77a7e47">  711</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="LoopInterchange_8cpp.html#a08a4eaf5865b2e8d68f18281f77a7e47">findInnerReductionPhi</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">// Reduction variables cannot be constants.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordflow">if</span> (isa&lt;Constant&gt;(V))</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classllvm_1_1User.html">User</a> : V-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = dyn_cast&lt;PHINode&gt;(<a class="code" href="classllvm_1_1User.html">User</a>)) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getNumIncomingValues() == 1)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <a class="code" href="classllvm_1_1RecurrenceDescriptor.html">RecurrenceDescriptor</a> RD;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1RecurrenceDescriptor.html#a484f974fc232e862a87a6380d3a7587d">RecurrenceDescriptor::isReductionPHI</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, L, RD)) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// Detect floating point reduction only when it can be reordered.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">if</span> (RD.<a class="code" href="classllvm_1_1RecurrenceDescriptor.html#aa94672fc5b505badff2cb5592c5e7389">getExactFPMathInst</a>() != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;}</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeLegality::findInductionAndReductions(</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> &amp;Inductions, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> (!L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>() || !L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a88575baf2ad9f4cd2e2432e6da4a976b">getLoopPredecessor</a>())</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <a class="code" href="classllvm_1_1RecurrenceDescriptor.html">RecurrenceDescriptor</a> RD;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="classllvm_1_1InductionDescriptor.html">InductionDescriptor</a> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1InductionDescriptor.html#acdb97daf1829f811db20dff44887fe9e">InductionDescriptor::isInductionPHI</a>(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, L, SE, <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>))</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      Inductions.push_back(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="comment">// PHIs in inner loops need to be part of a reduction in the outer loop,</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="comment">// discovered when checking the PHIs of the outer loop earlier.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keywordflow">if</span> (!InnerLoop) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">if</span> (!OuterInnerReductions.count(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>)) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inner loop PHI is not part of reductions &quot;</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                               <span class="stringliteral">&quot;across the outer loop.\n&quot;</span>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.getNumIncomingValues() == 2 &amp;&amp;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;               <span class="stringliteral">&quot;Phis in loop header should have exactly 2 incoming values&quot;</span>);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="comment">// Check if we have a PHI node in the outer loop that has a reduction</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="comment">// result from the inner loop as an incoming value.</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="LoopInterchange_8cpp.html#a5a88a338e277e1d3708cc4274ef12f9a">followLCSSA</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.getIncomingValueForBlock(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>()));</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *InnerRedPhi = <a class="code" href="LoopInterchange_8cpp.html#a08a4eaf5865b2e8d68f18281f77a7e47">findInnerReductionPhi</a>(InnerLoop, V);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">if</span> (!InnerRedPhi ||</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            !<a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a>(InnerRedPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>(), &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>)) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;              <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Failed to recognize PHI as an induction or reduction.\n&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        OuterInnerReductions.insert(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        OuterInnerReductions.insert(InnerRedPhi);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;}</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">// This function indicates the current limitations in the transform as a result</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">// of which we do not proceed.</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeLegality::currentLimitations() {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopLatch = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="comment">// transform currently expects the loop latches to also be the exiting</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// blocks.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">getExitingBlock</a>() != InnerLoopLatch ||</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">getExitingBlock</a>() != OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>() ||</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      !isa&lt;BranchInst&gt;(InnerLoopLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()) ||</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      !isa&lt;BranchInst&gt;(OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>())) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loops where the latch is not the exiting block are not&quot;</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; supported currently.\n&quot;</span>);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;ExitingNotLatch&quot;</span>,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                      OuterLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                      OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Loops where the latch is not the exiting block cannot be&quot;</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="stringliteral">&quot; interchange currently.&quot;</span>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    });</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> Inductions;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">if</span> (!findInductionAndReductions(OuterLoop, Inductions, InnerLoop)) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Only outer loops with induction or reduction PHI nodes &quot;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;are supported currently.\n&quot;</span>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnsupportedPHIOuter&quot;</span>,</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                      OuterLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                      OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Only outer loops with induction or reduction PHI nodes can be&quot;</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <span class="stringliteral">&quot; interchanged currently.&quot;</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    });</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  Inductions.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">// For multi-level loop nests, make sure that all phi nodes for inner loops</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// at all levels can be recognized as a induction or reduction phi. Bail out</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// if a phi node at a certain nesting level cannot be properly recognized.</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *CurLevelLoop = OuterLoop;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">while</span> (!CurLevelLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a47bb4b8ffdd881717123e9b244a10b12">getSubLoops</a>().empty()) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// We already made sure that the loop nest is tightly nested.</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    CurLevelLoop = CurLevelLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a47bb4b8ffdd881717123e9b244a10b12">getSubLoops</a>().front();</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (!findInductionAndReductions(CurLevelLoop, Inductions, <span class="keyword">nullptr</span>)) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Only inner loops with induction or reduction PHI nodes &quot;</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;are supported currently.\n&quot;</span>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnsupportedPHIInner&quot;</span>,</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                                        CurLevelLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                        CurLevelLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Only inner loops with induction or reduction PHI nodes can be&quot;</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                  <span class="stringliteral">&quot; interchange currently.&quot;</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      });</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// TODO: Triangular loops are not handled for now.</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">if</span> (!isLoopStructureUnderstood()) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loop structure not understood by pass\n&quot;</span>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnsupportedStructureInner&quot;</span>,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Inner loop structure not understood currently.&quot;</span>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    });</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeLegality::findInductions(</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;PHINode *&gt;</a> &amp;Inductions) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="classllvm_1_1InductionDescriptor.html">InductionDescriptor</a> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1InductionDescriptor.html#acdb97daf1829f811db20dff44887fe9e">InductionDescriptor::isInductionPHI</a>(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, L, SE, <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>))</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      Inductions.push_back(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">return</span> !Inductions.empty();</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;}</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">// We currently only support LCSSA PHI nodes in the inner loop exit, if their</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">// users are either reduction PHIs or PHIs outside the outer loop (which means</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">// the we are only interested in the final value after the loop).</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#ad50c8a25364117c5dd799586dd5b0904">  865</a></span>&#160;<a class="code" href="LoopInterchange_8cpp.html#ad50c8a25364117c5dd799586dd5b0904">areInnerLoopExitPHIsSupported</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerL, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterL,</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                              <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;PHINode *&gt;</a> &amp;Reductions) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerExit = OuterL-&gt;<a class="code" href="classllvm_1_1LoopBase.html#afd50c2de451ac9fc0865dc747dd2d485">getUniqueExitBlock</a>();</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : InnerExit-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// Reduction lcssa phi will have only 1 incoming block that from loop latch.</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.getNumIncomingValues() &gt; 1)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.users(), [&amp;Reductions, OuterL](<a class="code" href="classllvm_1_1User.html">User</a> *U) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          PHINode *PN = dyn_cast&lt;PHINode&gt;(U);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;          return !PN ||</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                 (!Reductions.count(PN) &amp;&amp; OuterL-&gt;contains(PN-&gt;getParent()));</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        })) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">// We currently support LCSSA PHI nodes in the outer loop exit, if their</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">// incoming values do not come from the outer loop latch or if the</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">// outer loop latch has a single predecessor. In that case, the value will</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">// be available if both the inner and outer loop conditions are true, which</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">// will still be true after interchanging. If we have multiple predecessor,</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">// that may not be the case, e.g. because the outer loop latch may be executed</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">// if the inner loop is not executed.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a6080253e27bfa816dce219371e6a820c">  890</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopInterchange_8cpp.html#a6080253e27bfa816dce219371e6a820c">areOuterLoopExitPHIsSupported</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *LoopNestExit = OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#afd50c2de451ac9fc0865dc747dd2d485">getUniqueExitBlock</a>();</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : LoopNestExit-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.getNumIncomingValues(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *IncomingI = dyn_cast&lt;Instruction&gt;(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.getIncomingValue(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">if</span> (!IncomingI || IncomingI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>())</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="comment">// The incoming value is defined in the outer loop latch. Currently we</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="comment">// only support that in case the outer loop latch has a single predecessor.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="comment">// This guarantees that the outer loop latch is executed if and only if</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="comment">// the inner loop is executed (because tightlyNested() guarantees that the</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="comment">// outer loop header only branches to the inner loop or the outer loop</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="comment">// latch).</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="comment">// FIXME: We could weaken this logic and allow multiple predecessors,</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="comment">//        if the values are produced outside the loop latch. We would need</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="comment">//        additional logic to update the PHI nodes in the exit block as</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="comment">//        well.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">if</span> (OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">getUniquePredecessor</a>() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">// In case of multi-level nested loops, it may occur that lcssa phis exist in</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">// the latch of InnerLoop, i.e., when defs of the incoming values are further</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">// inside the loopnest. Sometimes those incoming values are not available</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">// after interchange, since the original inner latch will become the new outer</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">// latch which may have predecessor paths that do not include those incoming</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">// values.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">// TODO: Handle transformation of lcssa phis in the InnerLoop latch in case of</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">// multi-level loop nests.</span></div>
<div class="line"><a name="l00923"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#ac0eeb33419165d13b0fa5c5f6fc69505">  923</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="LoopInterchange_8cpp.html#ac0eeb33419165d13b0fa5c5f6fc69505">areInnerLoopLatchPHIsSupported</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop) {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">if</span> (InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a47bb4b8ffdd881717123e9b244a10b12">getSubLoops</a>().empty())</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">// If the original outer latch has only one predecessor, then values defined</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// further inside the looploop, e.g., in the innermost loop, will be available</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">// at the new outer latch after interchange.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span> (OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">getUniquePredecessor</a>() != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// The outer latch has more than one predecessors, i.e., the inner</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// exit and the inner header.</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">// PHI nodes in the inner latch are lcssa phis where the incoming values</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">// are defined further inside the loopnest. Check if those phis are used</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">// in the original inner latch. If that is the case then bail out since</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">// those incoming values may not be available at the new outer latch.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopLatch = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : InnerLoopLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *U : <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.users()) {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UI = cast&lt;Instruction&gt;(U);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">if</span> (InnerLoopLatch == UI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>())</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeLegality::canInterchangeLoops(<span class="keywordtype">unsigned</span> InnerLoopId,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                                  <span class="keywordtype">unsigned</span> OuterLoopId,</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                                                  CharMatrix &amp;DepMatrix) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopInterchange_8cpp.html#ad16cef97c234c14b44e54eb45763a8c8">isLegalToInterChangeLoops</a>(DepMatrix, InnerLoopId, OuterLoopId)) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed interchange InnerLoopId = &quot;</span> &lt;&lt; InnerLoopId</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; and OuterLoopId = &quot;</span> &lt;&lt; OuterLoopId</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; due to dependence\n&quot;</span>);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;Dependence&quot;</span>,</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Cannot interchange loops due to dependences.&quot;</span>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    });</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// Check if outer and inner loop contain legal instructions only.</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>())</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;instructionsWithoutDebug())</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="comment">// readnone functions do not prevent interchanging.</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">if</span> (CI-&gt;onlyWritesMemory())</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loops with call instructions cannot be interchanged &quot;</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;safely.&quot;</span>);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;CallInst&quot;</span>,</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                          CI-&gt;getDebugLoc(),</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                          CI-&gt;getParent())</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Cannot interchange loops due to call instruction.&quot;</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        });</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordflow">if</span> (!findInductions(InnerLoop, InnerLoopInductions)) {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cound not find inner loop induction variables.\n&quot;</span>);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopInterchange_8cpp.html#ac0eeb33419165d13b0fa5c5f6fc69505">areInnerLoopLatchPHIsSupported</a>(OuterLoop, InnerLoop)) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found unsupported PHI nodes in inner loop latch.\n&quot;</span>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnsupportedInnerLatchPHI&quot;</span>,</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Cannot interchange loops because unsupported PHI nodes found &quot;</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <span class="stringliteral">&quot;in inner loop latch.&quot;</span>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    });</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// TODO: The loops could not be interchanged due to current limitations in the</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">// transform module.</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">if</span> (currentLimitations()) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Not legal because of current transform limitation\n&quot;</span>);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="comment">// Check if the loops are tightly nested.</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">if</span> (!tightlyNested(OuterLoop, InnerLoop)) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Loops not tightly nested\n&quot;</span>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;NotTightlyNested&quot;</span>,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Cannot interchange loops because they are not tightly &quot;</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                <span class="stringliteral">&quot;nested.&quot;</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    });</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopInterchange_8cpp.html#ad50c8a25364117c5dd799586dd5b0904">areInnerLoopExitPHIsSupported</a>(OuterLoop, InnerLoop,</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                     OuterInnerReductions)) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found unsupported PHI nodes in inner loop exit.\n&quot;</span>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnsupportedExitPHI&quot;</span>,</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Found unsupported PHI node in loop exit.&quot;</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    });</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="LoopInterchange_8cpp.html#a6080253e27bfa816dce219371e6a820c">areOuterLoopExitPHIsSupported</a>(OuterLoop, InnerLoop)) {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found unsupported PHI nodes in outer loop exit.\n&quot;</span>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;UnsupportedExitPHI&quot;</span>,</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                      OuterLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                      OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Found unsupported PHI node in loop exit.&quot;</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    });</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;}</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="keywordtype">int</span> LoopInterchangeProfitability::getInstrOrderCost() {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordtype">unsigned</span> GoodOrder, BadOrder;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  BadOrder = GoodOrder = 0;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>()) {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363">Ins</a> : *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(&amp;<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363">Ins</a>)) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordtype">unsigned</span> NumOp = <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getNumOperands();</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordtype">bool</span> FoundInnerInduction = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordtype">bool</span> FoundOuterInduction = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NumOp; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;          <span class="comment">// Skip operands that are not SCEV-able.</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;          <span class="keywordflow">if</span> (!SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;getType()))</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *OperandVal = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getOperand(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEVAddRecExpr.html">SCEVAddRecExpr</a> *AR = dyn_cast&lt;SCEVAddRecExpr&gt;(OperandVal);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          <span class="keywordflow">if</span> (!AR)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;          <span class="comment">// If we find the inner induction after an outer induction e.g.</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          <span class="comment">// for(int i=0;i&lt;N;i++)</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;          <span class="comment">//   for(int j=0;j&lt;N;j++)</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <span class="comment">//     A[i][j] = A[i-1][j-1]+k;</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <span class="comment">// then it is a good order.</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          <span class="keywordflow">if</span> (AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() == InnerLoop) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="comment">// We found an InnerLoop induction after OuterLoop induction. It is</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="comment">// a good order.</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            FoundInnerInduction = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="keywordflow">if</span> (FoundOuterInduction) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;              GoodOrder++;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          <span class="comment">// If we find the outer induction after an inner induction e.g.</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;          <span class="comment">// for(int i=0;i&lt;N;i++)</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          <span class="comment">//   for(int j=0;j&lt;N;j++)</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;          <span class="comment">//     A[j][i] = A[j-1][i-1]+k;</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;          <span class="comment">// then it is a bad order.</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;          <span class="keywordflow">if</span> (AR-&gt;<a class="code" href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">getLoop</a>() == OuterLoop) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="comment">// We found an OuterLoop induction after InnerLoop induction. It is</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="comment">// a bad order.</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            FoundOuterInduction = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordflow">if</span> (FoundInnerInduction) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;              BadOrder++;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">return</span> GoodOrder - BadOrder;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;}</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;std::optional&lt;bool&gt;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;LoopInterchangeProfitability::isProfitablePerLoopCacheAnalysis(</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Loop *, unsigned&gt;</a> &amp;CostMap,</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    std::unique_ptr&lt;CacheCost&gt; &amp;<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>) {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="comment">// This is the new cost model returned from loop cache analysis.</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="comment">// A smaller index means the loop should be placed an outer loop, and vice</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">// versa.</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">if</span> (CostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(InnerLoop) != CostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>() &amp;&amp;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      CostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(OuterLoop) != CostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordtype">unsigned</span> InnerIndex = 0, OuterIndex = 0;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    InnerIndex = CostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(InnerLoop)-&gt;second;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    OuterIndex = CostMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(OuterLoop)-&gt;second;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;InnerIndex = &quot;</span> &lt;&lt; InnerIndex</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, OuterIndex = &quot;</span> &lt;&lt; OuterIndex &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span> (InnerIndex &lt; OuterIndex)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;bool&gt;(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InnerIndex != OuterIndex &amp;&amp; <span class="stringliteral">&quot;CostMap should assign unique &quot;</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                       <span class="stringliteral">&quot;numbers to each loop&quot;</span>);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>-&gt;getLoopCost(*OuterLoop) == <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>-&gt;getLoopCost(*InnerLoop))</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">return</span> std::optional&lt;bool&gt;(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;}</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;std::optional&lt;bool&gt;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;LoopInterchangeProfitability::isProfitablePerInstrOrderCost() {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="comment">// Legacy cost model: this is rough cost estimation algorithm. It counts the</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="comment">// good and bad order of induction variables in the instruction and allows</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="comment">// reordering if number of bad orders is more than good.</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">Cost</a> = getInstrOrderCost();</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cost = &quot;</span> &lt;&lt; Cost &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">if</span> (Cost &lt; 0 &amp;&amp; Cost &lt; <a class="code" href="LoopInterchange_8cpp.html#a41e5bdc1b4af2dfdf79d6925bdaf4dab">LoopInterchangeCostThreshold</a>)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">return</span> std::optional&lt;bool&gt;(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;}</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;std::optional&lt;bool&gt; LoopInterchangeProfitability::isProfitableForVectorization(</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordtype">unsigned</span> InnerLoopId, <span class="keywordtype">unsigned</span> OuterLoopId, CharMatrix &amp;DepMatrix) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Row : DepMatrix) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">// If the inner loop is loop independent or doesn&#39;t carry any dependency</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">// it is not profitable to move this to outer position, since we are</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">// likely able to do inner loop vectorization already.</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (Row[InnerLoopId] == <span class="charliteral">&#39;I&#39;</span> || Row[InnerLoopId] == <span class="charliteral">&#39;=&#39;</span>)</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;bool&gt;(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// If the outer loop is not loop independent it is not profitable to move</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">// this to inner position, since doing so would not enable inner loop</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// parallelism.</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (Row[OuterLoopId] != <span class="charliteral">&#39;I&#39;</span> &amp;&amp; Row[OuterLoopId] != <span class="charliteral">&#39;=&#39;</span>)</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">return</span> std::optional&lt;bool&gt;(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">// If inner loop has dependence and outer loop is loop independent then it</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="comment">// is/ profitable to interchange to enable inner loop parallelism.</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="comment">// If there are no dependences, interchanging will not improve anything.</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keywordflow">return</span> std::optional&lt;bool&gt;(!DepMatrix.empty());</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;}</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeProfitability::isProfitable(</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop, <span class="keywordtype">unsigned</span> InnerLoopId,</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordtype">unsigned</span> OuterLoopId, CharMatrix &amp;DepMatrix,</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;const Loop *, unsigned&gt;</a> &amp;CostMap,</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    std::unique_ptr&lt;CacheCost&gt; &amp;<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>) {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="comment">// isProfitable() is structured to avoid endless loop interchange.</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="comment">// If loop cache analysis could decide the profitability then,</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="comment">// profitability check will stop and return the analysis result.</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">// If cache analysis failed to analyze the loopnest (e.g.,</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">// due to delinearization issues) then only check whether it is</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">// profitable for InstrOrderCost. Likewise, if InstrOrderCost failed to</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="comment">// analysis the profitability then only, isProfitableForVectorization</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">// will decide.</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  std::optional&lt;bool&gt; shouldInterchange =</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      isProfitablePerLoopCacheAnalysis(CostMap, <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">if</span> (!shouldInterchange.has_value()) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    shouldInterchange = isProfitablePerInstrOrderCost();</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span> (!shouldInterchange.has_value())</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      shouldInterchange =</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;          isProfitableForVectorization(InnerLoopId, OuterLoopId, DepMatrix);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">if</span> (!shouldInterchange.has_value()) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;InterchangeNotProfitable&quot;</span>,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Insufficient information to calculate the cost of loop for &quot;</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <span class="stringliteral">&quot;interchange.&quot;</span>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    });</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!shouldInterchange.value()) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    ORE-&gt;<a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">emit</a>([&amp;]() {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1OptimizationRemarkMissed.html">OptimizationRemarkMissed</a>(<a class="code" href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;InterchangeNotProfitable&quot;</span>,</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">getStartLoc</a>(),</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                      InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>())</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Interchanging loops is not considered to improve cache &quot;</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                <span class="stringliteral">&quot;locality nor vectorization.&quot;</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    });</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;}</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="keywordtype">void</span> LoopInterchangeTransform::removeChildLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoop,</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                               <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L : *OuterLoop)</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">if</span> (L == InnerLoop) {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      OuterLoop-&gt;removeChildLoop(L);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Couldn&#39;t find loop&quot;</span>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;}</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">/// Update LoopInfo, after interchanging. NewInner and NewOuter refer to the</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">/// new inner and outer loop after interchanging: NewInner is the original</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">/// outer loop and NewOuter is the original inner loop.</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">/// Before interchanging, we have the following structure</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">/// Outer preheader</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment"></span><span class="comment">//  Outer header</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">//    Inner preheader</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">//    Inner header</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">//      Inner body</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">//      Inner latch</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">//   outer bbs</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">//   Outer latch</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">// After interchanging:</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">// Inner preheader</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">// Inner header</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">//   Outer preheader</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">//   Outer header</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">//     Inner body</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">//     outer bbs</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">//     Outer latch</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">//   Inner latch</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="keywordtype">void</span> LoopInterchangeTransform::restructureLoops(</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <a class="code" href="classllvm_1_1Loop.html">Loop</a> *NewInner, <a class="code" href="classllvm_1_1Loop.html">Loop</a> *NewOuter, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigInnerPreHeader,</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigOuterPreHeader) {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <a class="code" href="classllvm_1_1Loop.html">Loop</a> *OuterLoopParent = OuterLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a62733c3335a87750623dbfc5b3ae4f6c">getParentLoop</a>();</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="comment">// The original inner loop preheader moves from the new inner loop to</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="comment">// the parent loop, if there is one.</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  NewInner-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1b9dddb31a33eea763f49038e9cf7d63">removeBlockFromLoop</a>(OrigInnerPreHeader);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a97de9fb6fdce68e4e31300fcf0e5a20c">changeLoopFor</a>(OrigInnerPreHeader, OuterLoopParent);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">// Switch the loop levels.</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordflow">if</span> (OuterLoopParent) {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">// Remove the loop from its parent loop.</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    removeChildLoop(OuterLoopParent, NewInner);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    removeChildLoop(NewInner, NewOuter);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    OuterLoopParent-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a990a86b0de7a84a9f489d2034878e330">addChildLoop</a>(NewOuter);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    removeChildLoop(NewInner, NewOuter);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a4b66429a04a74cd9713153f1e0428d6e">changeTopLevelLoop</a>(NewInner, NewOuter);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  <span class="keywordflow">while</span> (!NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a16165c1e5da45acaa086c3a54a188d34">isInnermost</a>())</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    NewInner-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a990a86b0de7a84a9f489d2034878e330">addChildLoop</a>(NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a03756cfd4ce082eda8c52cc7666edfcf">removeChildLoop</a>(NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af2f81059dc7566164b018aac6555eb1a">begin</a>()));</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a990a86b0de7a84a9f489d2034878e330">addChildLoop</a>(NewInner);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="comment">// BBs from the original inner loop.</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock *, 8&gt;</a> OrigInnerBBs(NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>());</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="comment">// Add BBs from the original outer loop to the original inner loop (excluding</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// BBs already in inner loop)</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : NewInner-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">blocks</a>())</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) == NewInner)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab0a5e875687fec396caa916b3950e0a3">addBlockEntry</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="comment">// Now remove inner loop header and latch from the new inner loop and move</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">// other BBs (the loop body) to the new inner loop.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterHeader = NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLatch = NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : OrigInnerBBs) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">// Nothing will change for BBs in child loops.</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) != NewOuter)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="comment">// Remove the new outer loop header and latch from the new inner loop.</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> == OuterHeader || <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> == OuterLatch)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      NewInner-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1b9dddb31a33eea763f49038e9cf7d63">removeBlockFromLoop</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a97de9fb6fdce68e4e31300fcf0e5a20c">changeLoopFor</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, NewInner);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="comment">// The preheader of the original outer loop becomes part of the new</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="comment">// outer loop.</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  NewOuter-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab0a5e875687fec396caa916b3950e0a3">addBlockEntry</a>(OrigOuterPreHeader);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a97de9fb6fdce68e4e31300fcf0e5a20c">changeLoopFor</a>(OrigOuterPreHeader, NewOuter);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="comment">// Tell SE that we move the loops around.</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">forgetLoop</a>(NewOuter);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;}</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="lib_2Target_2README_8txt.html#a69955d334349c9adad86cd95171dce4c">LoopInterchangeTransform::transform</a>() {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordtype">bool</span> Transformed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">if</span> (InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a47bb4b8ffdd881717123e9b244a10b12">getSubLoops</a>().empty()) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopPreHeader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Splitting the inner loop latch\n&quot;</span>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keyword">auto</span> &amp;InductionPHIs = LIL.getInnerLoopInductions();</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">if</span> (InductionPHIs.empty()) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to find the point to split loop latch \n&quot;</span>);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> InnerIndexVarList;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *CurInductionPHI : InductionPHIs) {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="keywordflow">if</span> (CurInductionPHI-&gt;getIncomingBlock(0) == InnerLoopPreHeader)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        InnerIndexVarList.push_back(</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            dyn_cast&lt;Instruction&gt;(CurInductionPHI-&gt;getIncomingValue(1)));</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        InnerIndexVarList.push_back(</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            dyn_cast&lt;Instruction&gt;(CurInductionPHI-&gt;getIncomingValue(0)));</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="comment">// Create a new latch block for the inner loop. We split at the</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="comment">// current latch&#39;s terminator and then move the condition and all</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// operands that are not either loop-invariant or the induction PHI into the</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// new latch block.</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewLatch =</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>(),</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                   InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>(), DT, LI);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;Instruction *, 4&gt;</a> WorkList;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keyword">auto</span> MoveInstructions = [&amp;<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>, &amp;WorkList, <span class="keyword">this</span>, &amp;InductionPHIs, NewLatch]() {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <span class="keywordflow">for</span> (; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; WorkList.size(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="comment">// Duplicate instruction and move it the new latch. Update uses that</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="comment">// have been moved.</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewI = WorkList[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">clone</a>();</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        NewI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(NewLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!NewI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">mayHaveSideEffects</a>() &amp;&amp;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;               <span class="stringliteral">&quot;Moving instructions with side-effects may change behavior of &quot;</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;               <span class="stringliteral">&quot;the loop nest!&quot;</span>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a>(WorkList[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="README-SSE_8txt.html#a0cd314eb6ec4d97be014a36348d9dff0">uses</a>())) {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UserI = cast&lt;Instruction&gt;(U.getUser());</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          <span class="keywordflow">if</span> (!InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(UserI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) ||</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;              UserI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() == NewLatch ||</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;              <a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a>(InductionPHIs, UserI))</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            U.set(NewI);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="comment">// Add operands of moved instruction to the worklist, except if they are</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="comment">// outside the inner loop or are the induction PHI.</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : WorkList[<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;operands()) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OpI = dyn_cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          <span class="keywordflow">if</span> (!OpI ||</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;              this-&gt;LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(OpI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) != <a class="code" href="lib_2Analysis_2README_8txt.html#ad5ccdce1179bbfb942a084b3005f360d">this</a>-&gt;InnerLoop ||</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;              <a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a>(InductionPHIs, OpI))</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;          WorkList.insert(OpI);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    };</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">// FIXME: Should we interchange when we have a constant condition?</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *CondI = dyn_cast&lt;Instruction&gt;(</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        cast&lt;BranchInst&gt;(InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>())</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            -&gt;getCondition());</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span> (CondI)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      WorkList.insert(CondI);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    MoveInstructions();</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InnerIndexVar : InnerIndexVarList)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      WorkList.insert(cast&lt;Instruction&gt;(InnerIndexVar));</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    MoveInstructions();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  }</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">// Ensure the inner loop phi nodes have a separate basic block.</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopHeader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">if</span> (InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>() != InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <a class="code" href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">SplitBlock</a>(InnerLoopHeader, InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>(), DT, LI);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;splitting InnerLoopHeader done\n&quot;</span>);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="comment">// Instructions in the original inner loop preheader may depend on values</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="comment">// defined in the outer loop header. Move them there, because the original</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// inner loop preheader will become the entry into the interchanged loop nest.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">// Currently we move all instructions and rely on LICM to move invariant</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="comment">// instructions outside the loop nest.</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopPreHeader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopHeader = OuterLoop-&gt;getHeader();</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="keywordflow">if</span> (InnerLoopPreHeader != OuterLoopHeader) {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> NeedsMoving;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> :</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;         <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">make_early_inc_range</a>(<a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(InnerLoopPreHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(),</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                         std::prev(InnerLoopPreHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()))))</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.moveBefore(OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  Transformed |= adjustLoopLinks();</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keywordflow">if</span> (!Transformed) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;adjustLoopLinks failed\n&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">/// \brief Move all instructions except the terminator from FromBB right before</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">/// InsertBefore</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a64307c8cbf811329320f43f90c434c08"> 1398</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopInterchange_8cpp.html#a64307c8cbf811329320f43f90c434c08">moveBBContents</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *FromBB, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertBefore) {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *ToBB = InsertBefore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  ToBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#af29f89e91dfd0ae90950f0b1bf49798d">splice</a>(InsertBefore-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>(), FromBB, FromBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(),</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;               FromBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>()-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>());</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">/// Swap instructions between \p BB1 and \p BB2 but keep terminators intact.</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a96e05005577b2873e5ef9b3c99c4e30c"> 1406</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopInterchange_8cpp.html#a96e05005577b2873e5ef9b3c99c4e30c">swapBBContents</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB1, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB2) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="comment">// Save all non-terminator instructions of BB1 into TempInstrs and unlink them</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="comment">// from BB1 afterwards.</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keyword">auto</span> Iter = <a class="code" href="namespacellvm.html#a51c7cbd21e1104ee6841c18d7daa6edb">map_range</a>(*BB1, [](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) { <span class="keywordflow">return</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>; });</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> TempInstrs(Iter.begin(), std::prev(Iter.end()));</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : TempInstrs)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;removeFromParent();</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="comment">// Move instructions from BB2 to BB1.</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#a64307c8cbf811329320f43f90c434c08">moveBBContents</a>(BB2, BB1-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="comment">// Move instructions from TempInstrs to BB2.</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : TempInstrs)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;insertBefore(BB2-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;}</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">// Update BI to jump to NewBB instead of OldBB. Records updates to the</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">// dominator tree in DTUpdates. If \p MustUpdateOnce is true, assert that</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment">// \p OldBB  is exactly once in BI&#39;s successor list.</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa"> 1425</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(<a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *BI, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OldBB,</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                            <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB,</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                            std::vector&lt;DominatorTree::UpdateType&gt; &amp;DTUpdates,</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                            <span class="keywordtype">bool</span> MustUpdateOnce = <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!MustUpdateOnce ||</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          <a class="code" href="namespacellvm.html#ac214df91cdc242f4710ea5a93939c678">llvm::count_if</a>(<a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(BI),</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                         [OldBB](<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                           <span class="keywordflow">return</span> <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> == OldBB;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                         }) == 1) &amp;&amp; <span class="stringliteral">&quot;BI must jump to OldBB exactly once.&quot;</span>);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : BI-&gt;<a class="code" href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>())</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> == OldBB) {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>.set(NewBB);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordflow">if</span> (Changed) {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    DTUpdates.push_back(</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        {<a class="code" href="namespacellvm_1_1cfg.html#a90f12723ad8d5cff45b6f06408a33da8aa458be0f08b7e4ff3c0f633c100176c0">DominatorTree::UpdateKind::Insert</a>, BI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), NewBB});</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    DTUpdates.push_back(</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        {<a class="code" href="namespacellvm_1_1cfg.html#a90f12723ad8d5cff45b6f06408a33da8af2a6c498fb90ee345d997f888fce3b18">DominatorTree::UpdateKind::Delete</a>, BI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>(), OldBB});</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Changed &amp;&amp; <span class="stringliteral">&quot;Expected a successor to be updated&quot;</span>);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;}</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">// Move Lcssa PHIs to the right place.</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"><a class="line" href="LoopInterchange_8cpp.html#a76f2308b91faa139968810fd02d26891"> 1451</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="LoopInterchange_8cpp.html#a76f2308b91faa139968810fd02d26891">moveLCSSAPhis</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerExit, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerHeader,</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLatch, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterHeader,</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLatch, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterExit,</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                          <a class="code" href="classllvm_1_1Loop.html">Loop</a> *InnerLoop, <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI) {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="comment">// Deal with LCSSA PHI nodes in the exit block of the inner loop, that are</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="comment">// defined either in the header or latch. Those blocks will become header and</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="comment">// latch of the new outer loop, and the only possible users can PHI nodes</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="comment">// in the exit block of the loop nest or the outer loop header (reduction</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="comment">// PHIs, in that case, the incoming value must be defined in the inner loop</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="comment">// header). We can just substitute the user with the incoming value and remove</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="comment">// the PHI.</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">make_early_inc_range</a>(InnerExit-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>())) {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.getNumIncomingValues() == 1 &amp;&amp;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;           <span class="stringliteral">&quot;Only loops with a single exit are supported!&quot;</span>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">// Incoming values are guaranteed be instructions currently.</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keyword">auto</span> IncI = cast&lt;Instruction&gt;(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.getIncomingValueForBlock(InnerLatch));</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// In case of multi-level nested loops, follow LCSSA to find the incoming</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">// value defined from the innermost loop.</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keyword">auto</span> IncIInnerMost = cast&lt;Instruction&gt;(<a class="code" href="LoopInterchange_8cpp.html#a5a88a338e277e1d3708cc4274ef12f9a">followLCSSA</a>(IncI));</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">// Skip phis with incoming values from the inner loop body, excluding the</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">// header and latch.</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">if</span> (IncIInnerMost-&gt;getParent() != InnerLatch &amp;&amp;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        IncIInnerMost-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>() != InnerHeader)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.users(),</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                  [OuterHeader, OuterExit, IncI, InnerHeader](<a class="code" href="classllvm_1_1User.html">User</a> *U) {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                    return (cast&lt;PHINode&gt;(U)-&gt;getParent() == OuterHeader &amp;&amp;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                            IncI-&gt;getParent() == InnerHeader) ||</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                           cast&lt;PHINode&gt;(U)-&gt;getParent() == OuterExit;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                  }) &amp;&amp;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;           <span class="stringliteral">&quot;Can only replace phis iff the uses are in the loop nest exit or &quot;</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;           <span class="stringliteral">&quot;the incoming value is defined in the inner header (it will &quot;</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;           <span class="stringliteral">&quot;dominate all loop blocks after interchanging)&quot;</span>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.replaceAllUsesWith(IncI);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.eraseFromParent();</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> LcssaInnerExit;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : InnerExit-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>())</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    LcssaInnerExit.push_back(&amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 8&gt;</a> LcssaInnerLatch;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : InnerLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>())</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    LcssaInnerLatch.push_back(&amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">// Lcssa PHIs for values used outside the inner loop are in InnerExit.</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="comment">// If a PHI node has users outside of InnerExit, it has a use outside the</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">// interchanged loop and we have to preserve it. We move these to</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">// InnerLatch, which will become the new exit block for the innermost</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">// loop after interchanging.</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : LcssaInnerExit)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>-&gt;moveBefore(InnerLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">// If the inner loop latch contains LCSSA PHIs, those come from a child loop</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="comment">// and we have to move them to the new inner latch.</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : LcssaInnerLatch)</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>-&gt;moveBefore(InnerExit-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">// Deal with LCSSA PHI nodes in the loop nest exit block. For PHIs that have</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="comment">// incoming values defined in the outer loop, we have to add a new PHI</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="comment">// in the inner loop latch, which became the exit block of the outer loop,</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="comment">// after interchanging.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordflow">if</span> (OuterExit) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : OuterExit-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>()) {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.getNumIncomingValues() != 1)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="comment">// Skip Phis with incoming values defined in the inner loop. Those should</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="comment">// already have been updated.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.getIncomingValue(0));</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> || LI-&gt;<a class="code" href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">getLoopFor</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()) == InnerLoop)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPhi = dyn_cast&lt;PHINode&gt;(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.clone());</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(0, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.getIncomingValue(0));</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a5ba57877c55dfdbe6e3bbfdacd9ef8c1">setIncomingBlock</a>(0, OuterLatch);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="comment">// We might have incoming edges from other BBs, i.e., the original outer</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="comment">// header.</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Pred : <a class="code" href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">predecessors</a>(InnerLatch)) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keywordflow">if</span> (Pred == OuterLatch)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        NewPhi-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.getIncomingValue(0), Pred);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      NewPhi-&gt;<a class="code" href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">insertBefore</a>(InnerLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.setIncomingValue(0, NewPhi);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">// Now adjust the incoming blocks for the LCSSA PHIs.</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="comment">// For PHIs moved from Inner&#39;s exit block, we need to replace Inner&#39;s latch</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="comment">// with the new latch.</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  InnerLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(InnerLatch, OuterLatch);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;}</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeTransform::adjustLoopBranches() {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;adjustLoopBranches called\n&quot;</span>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  std::vector&lt;DominatorTree::UpdateType&gt; DTUpdates;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopPreHeader = OuterLoop-&gt;getLoopPreheader();</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopPreHeader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OuterLoopPreHeader != OuterLoop-&gt;getHeader() &amp;&amp;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;         InnerLoopPreHeader != InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>() &amp;&amp; OuterLoopPreHeader &amp;&amp;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;         InnerLoopPreHeader &amp;&amp; <span class="stringliteral">&quot;Guaranteed by loop-simplify form&quot;</span>);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="comment">// Ensure that both preheaders do not contain PHI nodes and have single</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="comment">// predecessors. This allows us to move them easily. We use</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="comment">// InsertPreHeaderForLoop to create an &#39;extra&#39; preheader, if the existing</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="comment">// preheaders do not satisfy those conditions.</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(OuterLoopPreHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>()) ||</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      !OuterLoopPreHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">getUniquePredecessor</a>())</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    OuterLoopPreHeader =</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <a class="code" href="namespacellvm.html#a0ced274818512cfd52e26d828ec1fcf2">InsertPreheaderForLoop</a>(OuterLoop, DT, LI, <span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keywordflow">if</span> (InnerLoopPreHeader == OuterLoop-&gt;getHeader())</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    InnerLoopPreHeader =</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <a class="code" href="namespacellvm.html#a0ced274818512cfd52e26d828ec1fcf2">InsertPreheaderForLoop</a>(InnerLoop, DT, LI, <span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">// Adjust the loop preheader</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopHeader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopHeader = OuterLoop-&gt;getHeader();</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopLatch = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">getLoopLatch</a>();</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopLatch = OuterLoop-&gt;getLoopLatch();</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopPredecessor = OuterLoopPreHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">getUniquePredecessor</a>();</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopLatchPredecessor =</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      InnerLoopLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">getUniquePredecessor</a>();</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopLatchSuccessor;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopLatchSuccessor;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *OuterLoopLatchBI =</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      dyn_cast&lt;BranchInst&gt;(OuterLoopLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *InnerLoopLatchBI =</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      dyn_cast&lt;BranchInst&gt;(InnerLoopLatch-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *OuterLoopHeaderBI =</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      dyn_cast&lt;BranchInst&gt;(OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *InnerLoopHeaderBI =</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      dyn_cast&lt;BranchInst&gt;(InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span> (!OuterLoopPredecessor || !InnerLoopLatchPredecessor ||</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      !OuterLoopLatchBI || !InnerLoopLatchBI || !OuterLoopHeaderBI ||</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      !InnerLoopHeaderBI)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *InnerLoopLatchPredecessorBI =</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      dyn_cast&lt;BranchInst&gt;(InnerLoopLatchPredecessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <a class="code" href="classllvm_1_1BranchInst.html">BranchInst</a> *OuterLoopPredecessorBI =</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      dyn_cast&lt;BranchInst&gt;(OuterLoopPredecessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordflow">if</span> (!OuterLoopPredecessorBI || !InnerLoopLatchPredecessorBI)</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopHeaderSuccessor = InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a57f1945911ca1e95d0f51d7c3516b529">getUniqueSuccessor</a>();</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordflow">if</span> (!InnerLoopHeaderSuccessor)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="comment">// Adjust Loop Preheader and headers.</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="comment">// The branches in the outer loop predecessor and the outer loop header can</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="comment">// be unconditional branches or conditional branches with duplicates. Consider</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="comment">// this when updating the successors.</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(OuterLoopPredecessorBI, OuterLoopPreHeader,</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                  InnerLoopPreHeader, DTUpdates, <span class="comment">/*MustUpdateOnce=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">// The outer loop header might or might not branch to the outer latch.</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="comment">// We are guaranteed to branch to the inner loop preheader.</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a>(OuterLoopHeaderBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad37b3ffc4c5f3cbe9248d587a2efb850">successors</a>(), OuterLoopLatch)) {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">// In this case the outerLoopHeader should branch to the InnerLoopLatch.</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(OuterLoopHeaderBI, OuterLoopLatch, InnerLoopLatch,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                    DTUpdates,</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                    <span class="comment">/*MustUpdateOnce=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(OuterLoopHeaderBI, InnerLoopPreHeader,</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                  InnerLoopHeaderSuccessor, DTUpdates,</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                  <span class="comment">/*MustUpdateOnce=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="comment">// Adjust reduction PHI&#39;s now that the incoming block has changed.</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  InnerLoopHeaderSuccessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(InnerLoopHeader,</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                                               OuterLoopHeader);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(InnerLoopHeaderBI, InnerLoopHeaderSuccessor,</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                  OuterLoopPreHeader, DTUpdates);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="comment">// -------------Adjust loop latches-----------</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordflow">if</span> (InnerLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0) == InnerLoopHeader)</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    InnerLoopLatchSuccessor = InnerLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(1);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    InnerLoopLatchSuccessor = InnerLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(InnerLoopLatchPredecessorBI, InnerLoopLatch,</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                  InnerLoopLatchSuccessor, DTUpdates);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="keywordflow">if</span> (OuterLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0) == OuterLoopHeader)</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    OuterLoopLatchSuccessor = OuterLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(1);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    OuterLoopLatchSuccessor = OuterLoopLatchBI-&gt;<a class="code" href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">getSuccessor</a>(0);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(InnerLoopLatchBI, InnerLoopLatchSuccessor,</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                  OuterLoopLatchSuccessor, DTUpdates);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a>(OuterLoopLatchBI, OuterLoopLatchSuccessor, InnerLoopLatch,</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                  DTUpdates);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  DT-&gt;<a class="code" href="classllvm_1_1DominatorTreeBase.html#a470b5b573c7915fe13bd529b22c9adbc">applyUpdates</a>(DTUpdates);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  restructureLoops(OuterLoop, InnerLoop, InnerLoopPreHeader,</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                   OuterLoopPreHeader);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160; </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <a class="code" href="LoopInterchange_8cpp.html#a76f2308b91faa139968810fd02d26891">moveLCSSAPhis</a>(InnerLoopLatchSuccessor, InnerLoopHeader, InnerLoopLatch,</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                OuterLoopHeader, OuterLoopLatch, InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">getExitBlock</a>(),</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                InnerLoop, LI);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="comment">// For PHIs in the exit block of the outer loop, outer&#39;s latch has been</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="comment">// replaced by Inners&#39;.</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  OuterLoopLatchSuccessor-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(OuterLoopLatch, InnerLoopLatch);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="keyword">auto</span> &amp;OuterInnerReductions = LIL.getOuterInnerReductions();</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">// Now update the reduction PHIs in the inner and outer loop headers.</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;PHINode *, 4&gt;</a> InnerLoopPHIs, OuterLoopPHIs;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>())</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordflow">if</span> (OuterInnerReductions.contains(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>))</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      InnerLoopPHIs.push_back(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">phis</a>())</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keywordflow">if</span> (OuterInnerReductions.contains(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>))</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      OuterLoopPHIs.push_back(&amp;<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="comment">// Now move the remaining reduction PHIs from outer to inner loop header and</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="comment">// vice versa. The PHI nodes must be part of a reduction across the inner and</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <span class="comment">// outer loop and all the remains to do is and updating the incoming blocks.</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : OuterLoopPHIs) {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Outer loop reduction PHIs:\n&quot;</span>; <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;dump(););</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;moveBefore(InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OuterInnerReductions.count(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>) &amp;&amp; <span class="stringliteral">&quot;Expected a reduction PHI node&quot;</span>);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : InnerLoopPHIs) {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Inner loop reduction PHIs:\n&quot;</span>; <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;dump(););</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;moveBefore(OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OuterInnerReductions.count(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>) &amp;&amp; <span class="stringliteral">&quot;Expected a reduction PHI node&quot;</span>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  }</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="comment">// Update the incoming blocks for moved PHI nodes.</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(InnerLoopPreHeader, OuterLoopPreHeader);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(InnerLoopLatch, OuterLoopLatch);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(OuterLoopPreHeader, InnerLoopPreHeader);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  InnerLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">replacePhiUsesWith</a>(OuterLoopLatch, InnerLoopLatch);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="comment">// Values defined in the outer loop header could be used in the inner loop</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="comment">// latch. In that case, we need to create LCSSA phis for them, because after</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="comment">// interchanging they will be defined in the new inner loop and used in the</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="comment">// new outer loop.</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>());</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> MayNeedLCSSAPhis;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> :</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;       <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), std::prev(OuterLoopHeader-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>())))</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    MayNeedLCSSAPhis.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <a class="code" href="namespacellvm.html#aab718ad81e23736bb92a9185c91ff68d">formLCSSAForInstructions</a>(MayNeedLCSSAPhis, *DT, *LI, SE, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;}</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="keywordtype">bool</span> LoopInterchangeTransform::adjustLoopLinks() {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="comment">// Adjust all branches in the inner and outer loop.</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordtype">bool</span> Changed = adjustLoopBranches();</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">if</span> (Changed) {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">// We have interchanged the preheaders so we need to interchange the data in</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">// the preheaders as well. This is because the content of the inner</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="comment">// preheader was previously executed inside the outer loop.</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OuterLoopPreHeader = OuterLoop-&gt;getLoopPreheader();</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *InnerLoopPreHeader = InnerLoop-&gt;<a class="code" href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">getLoopPreheader</a>();</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <a class="code" href="LoopInterchange_8cpp.html#a96e05005577b2873e5ef9b3c99c4e30c">swapBBContents</a>(OuterLoopPreHeader, InnerLoopPreHeader);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;}</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"><a class="line" href="structllvm_1_1LoopInterchangePass.html#a99a46045e2cc7182d6a786d400604d76"> 1719</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="structllvm_1_1LoopInterchangePass.html#a99a46045e2cc7182d6a786d400604d76">LoopInterchangePass::run</a>(<a class="code" href="classllvm_1_1LoopNest.html">LoopNest</a> &amp;LN,</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                                           <a class="code" href="classllvm_1_1AnalysisManager.html">LoopAnalysisManager</a> &amp;AM,</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                           <a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html">LoopStandardAnalysisResults</a> &amp;AR,</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                                           <a class="code" href="classllvm_1_1LPMUpdater.html">LPMUpdater</a> &amp;U) {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = *LN.<a class="code" href="classllvm_1_1LoopNest.html#ac047689641fc4a651c1fc58b85dc555b">getParent</a>();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <a class="code" href="classllvm_1_1DependenceInfo.html">DependenceInfo</a> DI(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#abd7da877be8576011299f4fcaaf299be">AA</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#a124376878e24aef4252795ba9fea420f">SE</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#aa09379aa4435be95eb717dd9b5d8b4c5">LI</a>);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  std::unique_ptr&lt;CacheCost&gt; <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> =</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <a class="code" href="classllvm_1_1CacheCost.html#aa74e490a12ab54ad9687e6844fe605f1">CacheCost::getCacheCost</a>(LN.<a class="code" href="classllvm_1_1LoopNest.html#ac9a27bb5250b3aadddc4696c07678dd0">getOutermostLoop</a>(), AR, DI);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <a class="code" href="classllvm_1_1OptimizationRemarkEmitter.html">OptimizationRemarkEmitter</a> ORE(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">if</span> (!LoopInterchange(&amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#a124376878e24aef4252795ba9fea420f">SE</a>, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#aa09379aa4435be95eb717dd9b5d8b4c5">LI</a>, &amp;DI, &amp;AR.<a class="code" href="structllvm_1_1LoopStandardAnalysisResults.html#aaa96df870a1b3d7ffc56bec3eb0b0cff">DT</a>, <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>, &amp;ORE).run(LN))</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  U.<a class="code" href="classllvm_1_1LPMUpdater.html#a1b9987b7e794ba7a222d762cf3e438a5">markLoopNestChanged</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#ac7294ba4e105807674fe3a394437fcc1">getLoopPassPreservedAnalyses</a>();</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_ad16cef97c234c14b44e54eb45763a8c8"><div class="ttname"><a href="LoopInterchange_8cpp.html#ad16cef97c234c14b44e54eb45763a8c8">isLegalToInterChangeLoops</a></div><div class="ttdeci">static bool isLegalToInterChangeLoops(CharMatrix &amp;DepMatrix, unsigned InnerLoopId, unsigned OuterLoopId)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00201">LoopInterchange.cpp:201</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a64307c8cbf811329320f43f90c434c08"><div class="ttname"><a href="LoopInterchange_8cpp.html#a64307c8cbf811329320f43f90c434c08">moveBBContents</a></div><div class="ttdeci">static void moveBBContents(BasicBlock *FromBB, Instruction *InsertBefore)</div><div class="ttdoc">Move all instructions except the terminator from FromBB right before InsertBefore.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l01398">LoopInterchange.cpp:1398</a></div></div>
<div class="ttc" id="astructllvm_1_1Dependence_1_1DVEntry_html_a36df4bc73e8888285552e52e6591a9cea5e8f49d1ad8ec7e245f3afb075bb7844"><div class="ttname"><a href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea5e8f49d1ad8ec7e245f3afb075bb7844">llvm::Dependence::DVEntry::GE</a></div><div class="ttdeci">@ GE</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00092">DependenceAnalysis.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_af29f89e91dfd0ae90950f0b1bf49798d"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#af29f89e91dfd0ae90950f0b1bf49798d">llvm::BasicBlock::splice</a></div><div class="ttdeci">void splice(BasicBlock::iterator ToIt, BasicBlock *FromBB)</div><div class="ttdoc">Transfer all instructions from FromBB to this basic block at ToIt.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00468">BasicBlock.h:468</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a5a88a338e277e1d3708cc4274ef12f9a"><div class="ttname"><a href="LoopInterchange_8cpp.html#a5a88a338e277e1d3708cc4274ef12f9a">followLCSSA</a></div><div class="ttdeci">static Value * followLCSSA(Value *SV)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00700">LoopInterchange.cpp:700</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkMissed_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkMissed.html">llvm::OptimizationRemarkMissed</a></div><div class="ttdoc">Diagnostic information for missed-optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00734">DiagnosticInfo.h:734</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a6cb6a58fb0ded82b4c7755fc4c27c86d"><div class="ttname"><a href="classllvm_1_1Loop.html#a6cb6a58fb0ded82b4c7755fc4c27c86d">llvm::Loop::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const Value *V) const</div><div class="ttdoc">Return true if the specified value is loop invariant.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00060">LoopInfo.cpp:60</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_afd50c2de451ac9fc0865dc747dd2d485"><div class="ttname"><a href="classllvm_1_1LoopBase.html#afd50c2de451ac9fc0865dc747dd2d485">llvm::LoopBase::getUniqueExitBlock</a></div><div class="ttdeci">BlockT * getUniqueExitBlock() const</div><div class="ttdoc">If getUniqueExitBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00158">LoopInfoImpl.h:158</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad37b3ffc4c5f3cbe9248d587a2efb850"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad37b3ffc4c5f3cbe9248d587a2efb850">llvm::BranchInst::successors</a></div><div class="ttdeci">iterator_range&lt; succ_op_iterator &gt; successors()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03249">Instructions.h:3249</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ab48af53a5000ecede46c76dabb4578d2"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ab48af53a5000ecede46c76dabb4578d2">llvm::LoopBase::getExitBlock</a></div><div class="ttdeci">BlockT * getExitBlock() const</div><div class="ttdoc">If getExitBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00107">LoopInfoImpl.h:107</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a1f0ff79b64a40d383b891f1baba89c6b"><div class="ttname"><a href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">llvm::PHINode::incoming_values</a></div><div class="ttdeci">op_range incoming_values()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02784">Instructions.h:2784</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a0b931781aa589c6ebe64a76c1447e5b2"><div class="ttname"><a href="classllvm_1_1User.html#a0b931781aa589c6ebe64a76c1447e5b2">llvm::User::operands</a></div><div class="ttdeci">op_range operands()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00242">User.h:242</a></div></div>
<div class="ttc" id="aAMDGPURewriteUndefForPHI_8cpp_html_a2e83cb1bc3f5e8986cbd14575755a134"><div class="ttname"><a href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a></div><div class="ttdeci">Rewrite undef for PHI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPURewriteUndefForPHI_8cpp_source.html#l00101">AMDGPURewriteUndefForPHI.cpp:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cfg_html_a90f12723ad8d5cff45b6f06408a33da8aa458be0f08b7e4ff3c0f633c100176c0"><div class="ttname"><a href="namespacellvm_1_1cfg.html#a90f12723ad8d5cff45b6f06408a33da8aa458be0f08b7e4ff3c0f633c100176c0">llvm::cfg::UpdateKind::Insert</a></div><div class="ttdeci">@ Insert</div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a04337b572d34ea413c35dbac5d75530b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const</div><div class="ttdoc">Return true if the specified loop is contained within in this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00139">LoopInfo.h:139</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="LoopInterchange_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00056">LoopInterchange.cpp:56</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26e2a938b431eaa6eca2beaa96410c9d"><div class="ttname"><a href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a></div><div class="ttdeci">auto successors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01265">MachineBasicBlock.h:1265</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a0cd314eb6ec4d97be014a36348d9dff0"><div class="ttname"><a href="README-SSE_8txt.html#a0cd314eb6ec4d97be014a36348d9dff0">uses</a></div><div class="ttdeci">This might compile to this xmm1 xorps xmm0 movss xmm0 ret Now consider if the code caused xmm1 to get spilled This might produce this xmm1 movaps xmm0 movaps xmm1 movss xmm0 ret since the reload is only used by these we could fold it into the uses</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00258">README-SSE.txt:258</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt; Loop *, 8 &gt;</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a88575baf2ad9f4cd2e2432e6da4a976b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a88575baf2ad9f4cd2e2432e6da4a976b">llvm::LoopBase::getLoopPredecessor</a></div><div class="ttdeci">BlockT * getLoopPredecessor() const</div><div class="ttdoc">If the given loop's header has exactly one unique predecessor outside the loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00211">LoopInfoImpl.h:211</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html"><div class="ttname"><a href="Support_2ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html_a615131659002c10601eef598d42d025e"><div class="ttname"><a href="classllvm_1_1Loop.html#a615131659002c10601eef598d42d025e">llvm::Loop::getStartLoc</a></div><div class="ttdeci">DebugLoc getStartLoc() const</div><div class="ttdoc">Return the debug location of the start of this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00631">LoopInfo.cpp:631</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdoc">The main scalar evolution driver.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00452">ScalarEvolution.h:452</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a97de9fb6fdce68e4e31300fcf0e5a20c"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a97de9fb6fdce68e4e31300fcf0e5a20c">llvm::LoopInfoBase::changeLoopFor</a></div><div class="ttdeci">void changeLoopFor(BlockT *BB, LoopT *L)</div><div class="ttdoc">Change the top-level loop that contains BB to the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01030">LoopInfo.h:1030</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a76f2308b91faa139968810fd02d26891"><div class="ttname"><a href="LoopInterchange_8cpp.html#a76f2308b91faa139968810fd02d26891">moveLCSSAPhis</a></div><div class="ttdeci">static void moveLCSSAPhis(BasicBlock *InnerExit, BasicBlock *InnerHeader, BasicBlock *InnerLatch, BasicBlock *OuterHeader, BasicBlock *OuterLatch, BasicBlock *OuterExit, Loop *InnerLoop, LoopInfo *LI)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l01451">LoopInterchange.cpp:1451</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a482498a1c760122fd33c7fc8190dd277"><div class="ttname"><a href="classllvm_1_1Instruction.html#a482498a1c760122fd33c7fc8190dd277">llvm::Instruction::insertBefore</a></div><div class="ttdeci">void insertBefore(Instruction *InsertPos)</div><div class="ttdoc">Insert an unlinked instruction into a basic block immediately before the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00088">Instruction.cpp:88</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aREADME__P9_8txt_html_acc80d72f12f6f9e1d8eda2ec3d74133c"><div class="ttname"><a href="README__P9_8txt.html#acc80d72f12f6f9e1d8eda2ec3d74133c">Right</a></div><div class="ttdeci">Vector Shift Left Right</div><div class="ttdef"><b>Definition:</b> <a href="README__P9_8txt_source.html#l00118">README_P9.txt:118</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aScalarEvolution_8h_html"><div class="ttname"><a href="ScalarEvolution_8h.html">ScalarEvolution.h</a></div></div>
<div class="ttc" id="astructllvm_1_1Dependence_1_1DVEntry_html_a36df4bc73e8888285552e52e6591a9cea03e1c9598683e23868735e72b8caaabd"><div class="ttname"><a href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea03e1c9598683e23868735e72b8caaabd">llvm::Dependence::DVEntry::GT</a></div><div class="ttdeci">@ GT</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00090">DependenceAnalysis.h:90</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html">llvm::LoopStandardAnalysisResults</a></div><div class="ttdoc">The adaptor from a function pass to a loop pass computes these analyses and makes them available to t...</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00051">LoopAnalysisManager.h:51</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cfg_html_a90f12723ad8d5cff45b6f06408a33da8af2a6c498fb90ee345d997f888fce3b18"><div class="ttname"><a href="namespacellvm_1_1cfg.html#a90f12723ad8d5cff45b6f06408a33da8af2a6c498fb90ee345d997f888fce3b18">llvm::cfg::UpdateKind::Delete</a></div><div class="ttdeci">@ Delete</div></div>
<div class="ttc" id="anamespacellvm_html_a30e47ae014eb35bea24e45097c2bd731"><div class="ttname"><a href="namespacellvm.html#a30e47ae014eb35bea24e45097c2bd731">llvm::formLCSSARecursively</a></div><div class="ttdeci">bool formLCSSARecursively(Loop &amp;L, const DominatorTree &amp;DT, const LoopInfo *LI, ScalarEvolution *SE)</div><div class="ttdoc">Put a loop nest into LCSSA form.</div><div class="ttdef"><b>Definition:</b> <a href="LCSSA_8cpp_source.html#l00410">LCSSA.cpp:410</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_af2f81059dc7566164b018aac6555eb1a"><div class="ttname"><a href="classllvm_1_1LoopBase.html#af2f81059dc7566164b018aac6555eb1a">llvm::LoopBase::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00171">LoopInfo.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1LPMUpdater_html_a1b9987b7e794ba7a222d762cf3e438a5"><div class="ttname"><a href="classllvm_1_1LPMUpdater.html#a1b9987b7e794ba7a222d762cf3e438a5">llvm::LPMUpdater::markLoopNestChanged</a></div><div class="ttdeci">void markLoopNestChanged(bool Changed)</div><div class="ttdoc">Loopnest passes should use this method to indicate if the loopnest has been modified.</div><div class="ttdef"><b>Definition:</b> <a href="LoopPassManager_8h_source.html#l00365">LoopPassManager.h:365</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a08a4eaf5865b2e8d68f18281f77a7e47"><div class="ttname"><a href="LoopInterchange_8cpp.html#a08a4eaf5865b2e8d68f18281f77a7e47">findInnerReductionPhi</a></div><div class="ttdeci">static PHINode * findInnerReductionPhi(Loop *L, Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00711">LoopInterchange.cpp:711</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a7c84cffd04a037f3e087b309bf176929ae6e36dccbeaf26fca4a6813bf2e83a28"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a7c84cffd04a037f3e087b309bf176929ae6e36dccbeaf26fca4a6813bf2e83a28">llvm::codeview::VFTableSlotKind::Outer</a></div><div class="ttdeci">@ Outer</div></div>
<div class="ttc" id="aSTLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_ada6d2508cfa150fd7974bef2dc21c40f"><div class="ttname"><a href="LoopInterchange_8cpp.html#ada6d2508cfa150fd7974bef2dc21c40f">populateWorklist</a></div><div class="ttdeci">static void populateWorklist(Loop &amp;L, LoopVector &amp;LoopList)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00220">LoopInterchange.cpp:220</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_aaa96df870a1b3d7ffc56bec3eb0b0cff"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#aaa96df870a1b3d7ffc56bec3eb0b0cff">llvm::LoopStandardAnalysisResults::DT</a></div><div class="ttdeci">DominatorTree &amp; DT</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00054">LoopAnalysisManager.h:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a88cdefb709309eddc6e5daca0be6a7b4"><div class="ttname"><a href="classllvm_1_1PHINode.html#a88cdefb709309eddc6e5daca0be6a7b4">llvm::PHINode::setIncomingValue</a></div><div class="ttdeci">void setIncomingValue(unsigned i, Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02797">Instructions.h:2797</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac214df91cdc242f4710ea5a93939c678"><div class="ttname"><a href="namespacellvm.html#ac214df91cdc242f4710ea5a93939c678">llvm::count_if</a></div><div class="ttdeci">auto count_if(R &amp;&amp;Range, UnaryPredicate P)</div><div class="ttdoc">Wrapper function around std::count_if to count the number of times an element satisfying a given pred...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01903">STLExtras.h:1903</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a470b5b573c7915fe13bd529b22c9adbc"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a470b5b573c7915fe13bd529b22c9adbc">llvm::DominatorTreeBase::applyUpdates</a></div><div class="ttdeci">void applyUpdates(ArrayRef&lt; UpdateType &gt; Updates)</div><div class="ttdoc">Inform the dominator tree about a sequence of CFG edge insertions and deletions and perform a batch u...</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00561">GenericDomTree.h:561</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a57f1945911ca1e95d0f51d7c3516b529"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a57f1945911ca1e95d0f51d7c3516b529">llvm::BasicBlock::getUniqueSuccessor</a></div><div class="ttdeci">const BasicBlock * getUniqueSuccessor() const</div><div class="ttdoc">Return the successor of this block if it has a unique successor.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00322">BasicBlock.cpp:322</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2554a96c67bdd7d0a62855a844ec55b0a945d5e233cf7d6240f6b783b36a374ff"><div class="ttname"><a href="namespacellvm.html#a2554a96c67bdd7d0a62855a844ec55b0a945d5e233cf7d6240f6b783b36a374ff">llvm::AlignStyle::Left</a></div><div class="ttdeci">@ Left</div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a62733c3335a87750623dbfc5b3ae4f6c"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a62733c3335a87750623dbfc5b3ae4f6c">llvm::LoopBase::getParentLoop</a></div><div class="ttdeci">LoopT * getParentLoop() const</div><div class="ttdoc">Return the parent loop if it exists or nullptr for top level loops.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00114">LoopInfo.h:114</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a47bb4b8ffdd881717123e9b244a10b12"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a47bb4b8ffdd881717123e9b244a10b12">llvm::LoopBase::getSubLoops</a></div><div class="ttdeci">const std::vector&lt; LoopT * &gt; &amp; getSubLoops() const</div><div class="ttdoc">Return the loops contained entirely within this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00160">LoopInfo.h:160</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="aclassllvm_1_1InductionDescriptor_html"><div class="ttname"><a href="classllvm_1_1InductionDescriptor.html">llvm::InductionDescriptor</a></div><div class="ttdoc">A struct for saving information about induction variables.</div><div class="ttdef"><b>Definition:</b> <a href="IVDescriptors_8h_source.html#l00306">IVDescriptors.h:306</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_ad50c8a25364117c5dd799586dd5b0904"><div class="ttname"><a href="LoopInterchange_8cpp.html#ad50c8a25364117c5dd799586dd5b0904">areInnerLoopExitPHIsSupported</a></div><div class="ttdeci">static bool areInnerLoopExitPHIsSupported(Loop *InnerL, Loop *OuterL, SmallPtrSetImpl&lt; PHINode * &gt; &amp;Reductions)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00865">LoopInterchange.cpp:865</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a20b4f77bd00b4f63a49ec8e08f3bf6a6">InlinePriorityMode::Cost</a></div><div class="ttdeci">@ Cost</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1RecurrenceDescriptor_html_aa94672fc5b505badff2cb5592c5e7389"><div class="ttname"><a href="classllvm_1_1RecurrenceDescriptor.html#aa94672fc5b505badff2cb5592c5e7389">llvm::RecurrenceDescriptor::getExactFPMathInst</a></div><div class="ttdeci">Instruction * getExactFPMathInst() const</div><div class="ttdoc">Returns 1st non-reassociative FP instruction in the PHI node's use-chain.</div><div class="ttdef"><b>Definition:</b> <a href="IVDescriptors_8h_source.html#l00213">IVDescriptors.h:213</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a990a86b0de7a84a9f489d2034878e330"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a990a86b0de7a84a9f489d2034878e330">llvm::LoopBase::addChildLoop</a></div><div class="ttdeci">void addChildLoop(LoopT *NewChild)</div><div class="ttdoc">Add the specified loop to be a child of this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00412">LoopInfo.h:412</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a7d11a8560b7f0dc294b5799593571228"><div class="ttname"><a href="LoopInterchange_8cpp.html#a7d11a8560b7f0dc294b5799593571228">MaxLoopNestDepth</a></div><div class="ttdeci">static const unsigned MaxLoopNestDepth</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00077">LoopInterchange.cpp:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Instruction iterator methods.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00314">BasicBlock.h:314</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a96e05005577b2873e5ef9b3c99c4e30c"><div class="ttname"><a href="LoopInterchange_8cpp.html#a96e05005577b2873e5ef9b3c99c4e30c">swapBBContents</a></div><div class="ttdeci">static void swapBBContents(BasicBlock *BB1, BasicBlock *BB2)</div><div class="ttdoc">Swap instructions between BB1 and BB2 but keep terminators intact.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l01406">LoopInterchange.cpp:1406</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a40f34cc77d2b3bc73384f535c8101858"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a40f34cc77d2b3bc73384f535c8101858">llvm::LoopBase::blocks</a></div><div class="ttdeci">iterator_range&lt; block_iterator &gt; blocks() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00195">LoopInfo.h:195</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a72516971c5734dc0f7546e64affca425"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a72516971c5734dc0f7546e64affca425">llvm::BasicBlock::phis</a></div><div class="ttdeci">iterator_range&lt; const_phi_iterator &gt; phis() const</div><div class="ttdoc">Returns a range that iterates over the phis in the basic block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00372">BasicBlock.h:372</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aLoopUtils_8h_html"><div class="ttname"><a href="LoopUtils_8h.html">LoopUtils.h</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a41e5bdc1b4af2dfdf79d6925bdaf4dab"><div class="ttname"><a href="LoopInterchange_8cpp.html#a41e5bdc1b4af2dfdf79d6925bdaf4dab">LoopInterchangeCostThreshold</a></div><div class="ttdeci">static cl::opt&lt; int &gt; LoopInterchangeCostThreshold(&quot;loop-interchange-threshold&quot;, cl::init(0), cl::Hidden, cl::desc(&quot;Interchange if you gain more than this number&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_adf6f53d7652b471c995b7d10f3dd2729"><div class="ttname"><a href="classllvm_1_1LoopBase.html#adf6f53d7652b471c995b7d10f3dd2729">llvm::LoopBase::getExitingBlock</a></div><div class="ttdeci">BlockT * getExitingBlock() const</div><div class="ttdoc">If getExitingBlocks would return exactly one block, return that block.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00048">LoopInfoImpl.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a46ef6115027606b67adcf4d28f3dac17"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">llvm::BasicBlock::getFirstNonPHI</a></div><div class="ttdeci">const Instruction * getFirstNonPHI() const</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00208">BasicBlock.cpp:208</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_ac0eeb33419165d13b0fa5c5f6fc69505"><div class="ttname"><a href="LoopInterchange_8cpp.html#ac0eeb33419165d13b0fa5c5f6fc69505">areInnerLoopLatchPHIsSupported</a></div><div class="ttdeci">static bool areInnerLoopLatchPHIsSupported(Loop *OuterLoop, Loop *InnerLoop)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00923">LoopInterchange.cpp:923</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a1b9dddb31a33eea763f49038e9cf7d63"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1b9dddb31a33eea763f49038e9cf7d63">llvm::LoopBase::removeBlockFromLoop</a></div><div class="ttdeci">void removeBlockFromLoop(BlockT *BB)</div><div class="ttdoc">This removes the specified basic block from the current loop, updating the Blocks as appropriate.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00477">LoopInfo.h:477</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="astructllvm_1_1Loop_1_1LoopBounds_html_a1c06ad0290f168148c08edc0ce69703f"><div class="ttname"><a href="structllvm_1_1Loop_1_1LoopBounds.html#a1c06ad0290f168148c08edc0ce69703f">llvm::Loop::LoopBounds::Direction</a></div><div class="ttdeci">Direction</div><div class="ttdoc">An enum for the direction of the loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00723">LoopInfo.h:723</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dxil_1_1PointerTypeAnalysis_html_ae574a4c1d84b9e67bc94489f356805b4"><div class="ttname"><a href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">llvm::dxil::PointerTypeAnalysis::run</a></div><div class="ttdeci">PointerTypeMap run(const Module &amp;M)</div><div class="ttdoc">Compute the PointerTypeMap for the module M.</div><div class="ttdef"><b>Definition:</b> <a href="PointerTypeAnalysis_8cpp_source.html#l00189">PointerTypeAnalysis.cpp:189</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_aac456a62894c9f0f8e9f06373bbf40f0"><div class="ttname"><a href="classllvm_1_1BranchInst.html#aac456a62894c9f0f8e9f06373bbf40f0">llvm::BranchInst::getCondition</a></div><div class="ttdeci">Value * getCondition() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03220">Instructions.h:3220</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__PROC_html_a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">llvm::ARM_PROC::IE</a></div><div class="ttdeci">@ IE</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00027">ARMBaseInfo.h:27</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a30bd18ac905eacf3601bc6a553a9ff49"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a30bd18ac905eacf3601bc6a553a9ff49">llvm::ScalarEvolution::getSCEV</a></div><div class="ttdeci">const SCEV * getSCEV(Value *V)</div><div class="ttdoc">Return a SCEV expression for the full generality of the specified expression.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04534">ScalarEvolution.cpp:4534</a></div></div>
<div class="ttc" id="anamespacellvm_html_acb22fb04083152eee862457e42e8dc31"><div class="ttname"><a href="namespacellvm.html#acb22fb04083152eee862457e42e8dc31">llvm::predecessors</a></div><div class="ttdeci">auto predecessors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01266">MachineBasicBlock.h:1266</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_aca414c43a6d42c13998208463637a20d"><div class="ttname"><a href="classllvm_1_1PHINode.html#aca414c43a6d42c13998208463637a20d">llvm::PHINode::getIncomingValueNumForOperand</a></div><div class="ttdeci">static unsigned getIncomingValueNumForOperand(unsigned i)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02808">Instructions.h:2808</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html"><div class="ttname"><a href="classllvm_1_1CmpInst.html">llvm::CmpInst</a></div><div class="ttdoc">This class is the base class for the comparison instructions.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00708">InstrTypes.h:708</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0ced274818512cfd52e26d828ec1fcf2"><div class="ttname"><a href="namespacellvm.html#a0ced274818512cfd52e26d828ec1fcf2">llvm::InsertPreheaderForLoop</a></div><div class="ttdeci">BasicBlock * InsertPreheaderForLoop(Loop *L, DominatorTree *DT, LoopInfo *LI, MemorySSAUpdater *MSSAU, bool PreserveLCSSA)</div><div class="ttdoc">InsertPreheaderForLoop - Once we discover that a loop doesn't have a preheader, this method is called...</div><div class="ttdef"><b>Definition:</b> <a href="LoopSimplify_8cpp_source.html#l00118">LoopSimplify.cpp:118</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac7294ba4e105807674fe3a394437fcc1"><div class="ttname"><a href="namespacellvm.html#ac7294ba4e105807674fe3a394437fcc1">llvm::getLoopPassPreservedAnalyses</a></div><div class="ttdeci">PreservedAnalyses getLoopPassPreservedAnalyses()</div><div class="ttdoc">Returns the minimum set of Analyses that all loop passes must preserve.</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8cpp_source.html#l00138">LoopAnalysisManager.cpp:138</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdoc">This class represents an analyzed expression in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00075">ScalarEvolution.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1DependenceInfo_html"><div class="ttname"><a href="classllvm_1_1DependenceInfo.html">llvm::DependenceInfo</a></div><div class="ttdoc">DependenceInfo - This class is the main dependence-analysis driver.</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00293">DependenceAnalysis.h:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1CacheCost_html_aa74e490a12ab54ad9687e6844fe605f1"><div class="ttname"><a href="classllvm_1_1CacheCost.html#aa74e490a12ab54ad9687e6844fe605f1">llvm::CacheCost::getCacheCost</a></div><div class="ttdeci">static std::unique_ptr&lt; CacheCost &gt; getCacheCost(Loop &amp;Root, LoopStandardAnalysisResults &amp;AR, DependenceInfo &amp;DI, std::optional&lt; unsigned &gt; TRT=std::nullopt)</div><div class="ttdoc">Create a CacheCost for the loop nest rooted by Root.</div><div class="ttdef"><b>Definition:</b> <a href="LoopCacheAnalysis_8cpp_source.html#l00575">LoopCacheAnalysis.cpp:575</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a9bf617fd3367180fb96cebccfaae8dfa"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a9bf617fd3367180fb96cebccfaae8dfa">D</a></div><div class="ttdeci">static GCRegistry::Add&lt; StatepointGC &gt; D(&quot;statepoint-example&quot;, &quot;an example strategy for statepoint&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1LPMUpdater_html"><div class="ttname"><a href="classllvm_1_1LPMUpdater.html">llvm::LPMUpdater</a></div><div class="ttdoc">This class provides an interface for updating the loop pass manager based on mutations to the loop ne...</div><div class="ttdef"><b>Definition:</b> <a href="LoopPassManager_8h_source.html#l00262">LoopPassManager.h:262</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a5ba57877c55dfdbe6e3bbfdacd9ef8c1"><div class="ttname"><a href="classllvm_1_1PHINode.html#a5ba57877c55dfdbe6e3bbfdacd9ef8c1">llvm::PHINode::setIncomingBlock</a></div><div class="ttdeci">void setIncomingBlock(unsigned i, BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02833">Instructions.h:2833</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopNest_html_a0c3d91a5a6e71c114dea21819cc71382"><div class="ttname"><a href="classllvm_1_1LoopNest.html#a0c3d91a5a6e71c114dea21819cc71382">llvm::LoopNest::skipEmptyBlockUntil</a></div><div class="ttdeci">static const BasicBlock &amp; skipEmptyBlockUntil(const BasicBlock *From, const BasicBlock *End, bool CheckUniquePred=false)</div><div class="ttdoc">Recursivelly traverse all empty 'single successor' basic blocks of From (if there are any).</div><div class="ttdef"><b>Definition:</b> <a href="LoopNestAnalysis_8cpp_source.html#l00288">LoopNestAnalysis.cpp:288</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a7a7c8e0e4f836c13c015b62e18f386bd"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a7a7c8e0e4f836c13c015b62e18f386bd">llvm::LoopInfoBase::getLoopFor</a></div><div class="ttdeci">LoopT * getLoopFor(const BlockT *BB) const</div><div class="ttdoc">Return the inner most loop that BB lives in.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00992">LoopInfo.h:992</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdoc">an instruction for type-safe pointer arithmetic to access elements of arrays and structs</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00940">Instructions.h:940</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ac3280e7f76f955403fe17eacf126b90d"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ac3280e7f76f955403fe17eacf126b90d">llvm::LoopBase::getLoopPreheader</a></div><div class="ttdeci">BlockT * getLoopPreheader() const</div><div class="ttdoc">If there is a preheader for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00183">LoopInfoImpl.h:183</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd1cd968cb420c82d70926920fcdc7d7"><div class="ttname"><a href="namespacellvm.html#acd1cd968cb420c82d70926920fcdc7d7">llvm::is_contained</a></div><div class="ttdeci">bool is_contained(R &amp;&amp;Range, const E &amp;Element)</div><div class="ttdoc">Wrapper function around std::find to detect if an element exists in a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01869">STLExtras.h:1869</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a1230fd674d2609b96527fe65eaf40b1b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a1230fd674d2609b96527fe65eaf40b1b">llvm::LoopBase::getLoopLatch</a></div><div class="ttdeci">BlockT * getLoopLatch() const</div><div class="ttdoc">If there is a single latch block for this loop, return it.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfoImpl_8h_source.html#l00232">LoopInfoImpl.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="anamespacellvm_html_abfc9c7ecf70f66901e439f7c04ef3dbb"><div class="ttname"><a href="namespacellvm.html#abfc9c7ecf70f66901e439f7c04ef3dbb">llvm::move</a></div><div class="ttdeci">OutputIt move(R &amp;&amp;Range, OutputIt Out)</div><div class="ttdoc">Provide wrappers to std::move which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01862">STLExtras.h:1862</a></div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html_aae6a98aea85aa3af87357cc5448db499"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html#aae6a98aea85aa3af87357cc5448db499">llvm::OptimizationRemarkEmitter::emit</a></div><div class="ttdeci">void emit(DiagnosticInfoOptimizationBase &amp;OptDiag)</div><div class="ttdoc">Output the remark via the diagnostic handler and to the optimization record file.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8cpp_source.html#l00079">OptimizationRemarkEmitter.cpp:79</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aLoopNestAnalysis_8h_html"><div class="ttname"><a href="LoopNestAnalysis_8h.html">LoopNestAnalysis.h</a></div></div>
<div class="ttc" id="aLoopPassManager_8h_html"><div class="ttname"><a href="LoopPassManager_8h.html">LoopPassManager.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopNest_html_ac9a27bb5250b3aadddc4696c07678dd0"><div class="ttname"><a href="classllvm_1_1LoopNest.html#ac9a27bb5250b3aadddc4696c07678dd0">llvm::LoopNest::getOutermostLoop</a></div><div class="ttdeci">Loop &amp; getOutermostLoop() const</div><div class="ttdoc">Return the outermost loop in the loop nest.</div><div class="ttdef"><b>Definition:</b> <a href="LoopNestAnalysis_8h_source.html#l00080">LoopNestAnalysis.h:80</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aLoopInterchange_8h_html"><div class="ttname"><a href="LoopInterchange_8h.html">LoopInterchange.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a0a4d51e372293abe5e5f6dac133e80a6"><div class="ttname"><a href="classllvm_1_1Instruction.html#a0a4d51e372293abe5e5f6dac133e80a6">llvm::Instruction::clone</a></div><div class="ttdeci">Instruction * clone() const</div><div class="ttdoc">Create a copy of 'this' instruction that is identical in all ways except the following:</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00903">Instruction.cpp:903</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a03756cfd4ce082eda8c52cc7666edfcf"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a03756cfd4ce082eda8c52cc7666edfcf">llvm::LoopBase::removeChildLoop</a></div><div class="ttdeci">LoopT * removeChildLoop(iterator I)</div><div class="ttdoc">This removes the specified child from being a subloop of this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00421">LoopInfo.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitter_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitter.html">llvm::OptimizationRemarkEmitter</a></div><div class="ttdoc">The optimization diagnostic interface.</div><div class="ttdef"><b>Definition:</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00033">OptimizationRemarkEmitter.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="alib_2Analysis_2README_8txt_html_ad5ccdce1179bbfb942a084b3005f360d"><div class="ttname"><a href="lib_2Analysis_2README_8txt.html#ad5ccdce1179bbfb942a084b3005f360d">this</a></div><div class="ttdeci">Analysis the ScalarEvolution expression for r is this</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Analysis_2README_8txt_source.html#l00008">README.txt:8</a></div></div>
<div class="ttc" id="astructllvm_1_1Dependence_1_1DVEntry_html_a36df4bc73e8888285552e52e6591a9cea5796b2f4edcf01eb52e88d01493f1d58"><div class="ttname"><a href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea5796b2f4edcf01eb52e88d01493f1d58">llvm::Dependence::DVEntry::LT</a></div><div class="ttdeci">@ LT</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00087">DependenceAnalysis.h:87</a></div></div>
<div class="ttc" id="aLoopPass_8h_html"><div class="ttname"><a href="LoopPass_8h.html">LoopPass.h</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="anamespacellvm_html_a615619b0b2879029152b9a20e96624bc"><div class="ttname"><a href="namespacellvm.html#a615619b0b2879029152b9a20e96624bc">llvm::transform</a></div><div class="ttdeci">OutputIt transform(R &amp;&amp;Range, OutputIt d_first, UnaryFunction F)</div><div class="ttdoc">Wrapper function around std::transform to apply a function to a range and store the result elsewhere.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01910">STLExtras.h:1910</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a74aa9daea070e2ad3394a3ec58b7316a"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">llvm::BasicBlock::getUniquePredecessor</a></div><div class="ttdeci">const BasicBlock * getUniquePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a unique predecessor block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00292">BasicBlock.cpp:292</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_aa09379aa4435be95eb717dd9b5d8b4c5"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#aa09379aa4435be95eb717dd9b5d8b4c5">llvm::LoopStandardAnalysisResults::LI</a></div><div class="ttdeci">LoopInfo &amp; LI</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00055">LoopAnalysisManager.h:55</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aRISCVRedundantCopyElimination_8cpp_html_a77c69067ae8279bc00ab8757731e90d7"><div class="ttname"><a href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a></div><div class="ttdeci">auto CC</div><div class="ttdef"><b>Definition:</b> <a href="RISCVRedundantCopyElimination_8cpp_source.html#l00079">RISCVRedundantCopyElimination.cpp:79</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopNest_html_ac047689641fc4a651c1fc58b85dc555b"><div class="ttname"><a href="classllvm_1_1LoopNest.html#ac047689641fc4a651c1fc58b85dc555b">llvm::LoopNest::getParent</a></div><div class="ttdeci">Function * getParent() const</div><div class="ttdoc">Return the function to which the loop-nest belongs.</div><div class="ttdef"><b>Definition:</b> <a href="LoopNestAnalysis_8h_source.html#l00176">LoopNestAnalysis.h:176</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_aff1e7d5809a00598adae1a0f4476fec7"><div class="ttname"><a href="LoopInterchange_8cpp.html#aff1e7d5809a00598adae1a0f4476fec7">populateDependencyMatrix</a></div><div class="ttdeci">static bool populateDependencyMatrix(CharMatrix &amp;DepMatrix, unsigned Level, Loop *L, DependenceInfo *DI, ScalarEvolution *SE)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00089">LoopInterchange.cpp:89</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a5a19768af81df7e5fe571bc08dcd48b3"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a5a19768af81df7e5fe571bc08dcd48b3">llvm::ScalarEvolution::isLoopInvariant</a></div><div class="ttdeci">bool isLoopInvariant(const SCEV *S, const Loop *L)</div><div class="ttdoc">Return true if the value of the given SCEV is unchanging in the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l13775">ScalarEvolution.cpp:13775</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a6080253e27bfa816dce219371e6a820c"><div class="ttname"><a href="LoopInterchange_8cpp.html#a6080253e27bfa816dce219371e6a820c">areOuterLoopExitPHIsSupported</a></div><div class="ttdeci">static bool areOuterLoopExitPHIsSupported(Loop *OuterLoop, Loop *InnerLoop)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00890">LoopInterchange.cpp:890</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6ea260be710ac7b61309534308da3147"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">llvm::Instruction::mayHaveSideEffects</a></div><div class="ttdeci">bool mayHaveSideEffects() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction may have side effects.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00745">Instruction.cpp:745</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_aa286a0f7f5d38488d593bb7ef0ba183e"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#aa286a0f7f5d38488d593bb7ef0ba183e">llvm::BasicBlock::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">Get the context in which this basic block lives.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00035">BasicBlock.cpp:35</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a3a76669632041022e6976766a22bd2b0"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a3a76669632041022e6976766a22bd2b0">j</a></div><div class="ttdeci">return j(j&lt;&lt; 16)</div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a16165c1e5da45acaa086c3a54a188d34"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a16165c1e5da45acaa086c3a54a188d34">llvm::LoopBase::isInnermost</a></div><div class="ttdeci">bool isInnermost() const</div><div class="ttdoc">Return true if the loop does not contain any (natural) loops.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00182">LoopInfo.h:182</a></div></div>
<div class="ttc" id="aclassllvm_1_1InductionDescriptor_html_acdb97daf1829f811db20dff44887fe9e"><div class="ttname"><a href="classllvm_1_1InductionDescriptor.html#acdb97daf1829f811db20dff44887fe9e">llvm::InductionDescriptor::isInductionPHI</a></div><div class="ttdeci">static bool isInductionPHI(PHINode *Phi, const Loop *L, ScalarEvolution *SE, InductionDescriptor &amp;D, const SCEV *Expr=nullptr, SmallVectorImpl&lt; Instruction * &gt; *CastsToIgnore=nullptr)</div><div class="ttdoc">Returns true if Phi is an induction in the loop L.</div><div class="ttdef"><b>Definition:</b> <a href="IVDescriptors_8cpp_source.html#l01524">IVDescriptors.cpp:1524</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a7349a5d6bf71f3d3344b37104dc25bf4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a7349a5d6bf71f3d3344b37104dc25bf4">llvm::BasicBlock::replacePhiUsesWith</a></div><div class="ttdeci">void replacePhiUsesWith(BasicBlock *Old, BasicBlock *New)</div><div class="ttdoc">Update all phi nodes in this basic block to refer to basic block New instead of basic block Old.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00487">BasicBlock.cpp:487</a></div></div>
<div class="ttc" id="anamespacellvm_html_a51c7cbd21e1104ee6841c18d7daa6edb"><div class="ttname"><a href="namespacellvm.html#a51c7cbd21e1104ee6841c18d7daa6edb">llvm::map_range</a></div><div class="ttdeci">auto map_range(ContainerTy &amp;&amp;C, FuncTy F)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00434">STLExtras.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a592bdd7731b14ff4ff5d646f6f399900"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a592bdd7731b14ff4ff5d646f6f399900">llvm::ScalarEvolution::forgetLoop</a></div><div class="ttdeci">void forgetLoop(const Loop *L)</div><div class="ttdoc">This method should be called by the client when it has changed a loop in a way that may effect Scalar...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08463">ScalarEvolution.cpp:8463</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html_af6314c51a3cc5a619beb697246177bf0"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html#af6314c51a3cc5a619beb697246177bf0">llvm::SCEVAddRecExpr::getLoop</a></div><div class="ttdeci">const Loop * getLoop() const</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00342">ScalarEvolutionExpressions.h:342</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00851">BitVector.h:851</a></div></div>
<div class="ttc" id="astructllvm_1_1Dependence_1_1DVEntry_html_a36df4bc73e8888285552e52e6591a9cea76afd933ba76f92a06c8b0f90cccfd1f"><div class="ttname"><a href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cea76afd933ba76f92a06c8b0f90cccfd1f">llvm::Dependence::DVEntry::LE</a></div><div class="ttdeci">@ LE</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00089">DependenceAnalysis.h:89</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_a6fdefa5e30cfe78c973990812d4a8900"><div class="ttname"><a href="LoopInterchange_8cpp.html#a6fdefa5e30cfe78c973990812d4a8900">interChangeDependencies</a></div><div class="ttdeci">static void interChangeDependencies(CharMatrix &amp;DepMatrix, unsigned FromIndx, unsigned ToIndx)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00179">LoopInterchange.cpp:179</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_aea03c1dffdd4b48507295e18f88601a7"><div class="ttname"><a href="LoopInterchange_8cpp.html#aea03c1dffdd4b48507295e18f88601a7">isLexicographicallyPositive</a></div><div class="ttdeci">static bool isLexicographicallyPositive(std::vector&lt; char &gt; &amp;DV)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00189">LoopInterchange.cpp:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEVAddRecExpr_html"><div class="ttname"><a href="classllvm_1_1SCEVAddRecExpr.html">llvm::SCEVAddRecExpr</a></div><div class="ttdoc">This node represents a polynomial recurrence on the trip count of the specified loop.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolutionExpressions_8h_source.html#l00330">ScalarEvolutionExpressions.h:330</a></div></div>
<div class="ttc" id="aLoopInfo_8cpp_html_ab4c7e3039b29b12e4dc97bcae93d79c3"><div class="ttname"><a href="LoopInfo_8cpp.html#ab4c7e3039b29b12e4dc97bcae93d79c3">Direction</a></div><div class="ttdeci">Loop::LoopBounds::Direction Direction</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8cpp_source.html#l00230">LoopInfo.cpp:230</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aDiagnosticInfo_8h_html"><div class="ttname"><a href="DiagnosticInfo_8h.html">DiagnosticInfo.h</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a6d8769a72303e2b06ef63129cb231855"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a6d8769a72303e2b06ef63129cb231855">llvm::ScalarEvolution::isSCEVable</a></div><div class="ttdeci">bool isSCEVable(Type *Ty) const</div><div class="ttdoc">Test if values of the given type are analyzable within the SCEV framework.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l04420">ScalarEvolution.cpp:4420</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_ab0a5e875687fec396caa916b3950e0a3"><div class="ttname"><a href="classllvm_1_1LoopBase.html#ab0a5e875687fec396caa916b3950e0a3">llvm::LoopBase::addBlockEntry</a></div><div class="ttdeci">void addBlockEntry(BlockT *BB)</div><div class="ttdoc">This adds a basic block directly to the basic block list.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00440">LoopInfo.h:440</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a69955d334349c9adad86cd95171dce4c"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a69955d334349c9adad86cd95171dce4c">transform</a></div><div class="ttdeci">instcombine should handle this transform</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00262">README.txt:262</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00614">SmallVector.h:614</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a389bb3581ba3c8094b89642efaf8e514"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a389bb3581ba3c8094b89642efaf8e514">llvm::LoopBase::getNumBackEdges</a></div><div class="ttdeci">unsigned getNumBackEdges() const</div><div class="ttdoc">Calculate the number of back edges to the loop header.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00267">LoopInfo.h:267</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_ae5687ce1ab4b7719d53c0173d87355aa"><div class="ttname"><a href="LoopInterchange_8cpp.html#ae5687ce1ab4b7719d53c0173d87355aa">updateSuccessor</a></div><div class="ttdeci">static void updateSuccessor(BranchInst *BI, BasicBlock *OldBB, BasicBlock *NewBB, std::vector&lt; DominatorTree::UpdateType &gt; &amp;DTUpdates, bool MustUpdateOnce=true)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l01425">LoopInterchange.cpp:1425</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_a124376878e24aef4252795ba9fea420f"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#a124376878e24aef4252795ba9fea420f">llvm::LoopStandardAnalysisResults::SE</a></div><div class="ttdeci">ScalarEvolution &amp; SE</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00056">LoopAnalysisManager.h:56</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopStandardAnalysisResults_html_abd7da877be8576011299f4fcaaf299be"><div class="ttname"><a href="structllvm_1_1LoopStandardAnalysisResults.html#abd7da877be8576011299f4fcaaf299be">llvm::LoopStandardAnalysisResults::AA</a></div><div class="ttdeci">AAResults &amp; AA</div><div class="ttdef"><b>Definition:</b> <a href="LoopAnalysisManager_8h_source.html#l00052">LoopAnalysisManager.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopNest_html_a76910b27c22c1ec00680bc5362806678"><div class="ttname"><a href="classllvm_1_1LoopNest.html#a76910b27c22c1ec00680bc5362806678">llvm::LoopNest::getLoops</a></div><div class="ttdeci">ArrayRef&lt; Loop * &gt; getLoops() const</div><div class="ttdoc">Get the loops in the nest.</div><div class="ttdef"><b>Definition:</b> <a href="LoopNestAnalysis_8h_source.html#l00117">LoopNestAnalysis.h:117</a></div></div>
<div class="ttc" id="aScalarEvolutionExpressions_8h_html"><div class="ttname"><a href="ScalarEvolutionExpressions_8h.html">ScalarEvolutionExpressions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1RecurrenceDescriptor_html"><div class="ttname"><a href="classllvm_1_1RecurrenceDescriptor.html">llvm::RecurrenceDescriptor</a></div><div class="ttdoc">The RecurrenceDescriptor is used to identify recurrences variables in a loop.</div><div class="ttdef"><b>Definition:</b> <a href="IVDescriptors_8h_source.html#l00069">IVDescriptors.h:69</a></div></div>
<div class="ttc" id="aclassllvm_1_1DependenceInfo_html_a49197b24cced248bed2d2c89c641a6dd"><div class="ttname"><a href="classllvm_1_1DependenceInfo.html#a49197b24cced248bed2d2c89c641a6dd">llvm::DependenceInfo::depends</a></div><div class="ttdeci">std::unique_ptr&lt; Dependence &gt; depends(Instruction *Src, Instruction *Dst, bool PossiblyLoopIndependent)</div><div class="ttdoc">depends - Tests for a dependence between the Src and Dst instructions.</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8cpp_source.html#l03590">DependenceAnalysis.cpp:3590</a></div></div>
<div class="ttc" id="anamespacellvm_html_aab718ad81e23736bb92a9185c91ff68d"><div class="ttname"><a href="namespacellvm.html#aab718ad81e23736bb92a9185c91ff68d">llvm::formLCSSAForInstructions</a></div><div class="ttdeci">bool formLCSSAForInstructions(SmallVectorImpl&lt; Instruction * &gt; &amp;Worklist, const DominatorTree &amp;DT, const LoopInfo &amp;LI, ScalarEvolution *SE, IRBuilderBase &amp;Builder, SmallVectorImpl&lt; PHINode * &gt; *PHIsToRemove=nullptr)</div><div class="ttdoc">Ensures LCSSA form for every instruction from the Worklist in the scope of innermost containing loop.</div><div class="ttdef"><b>Definition:</b> <a href="LCSSA_8cpp_source.html#l00078">LCSSA.cpp:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition:</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aUser_8h_html"><div class="ttname"><a href="User_8h.html">User.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoBase_html_a4b66429a04a74cd9713153f1e0428d6e"><div class="ttname"><a href="classllvm_1_1LoopInfoBase.html#a4b66429a04a74cd9713153f1e0428d6e">llvm::LoopInfoBase::changeTopLevelLoop</a></div><div class="ttdeci">void changeTopLevelLoop(LoopT *OldLoop, LoopT *NewLoop)</div><div class="ttdoc">Replace the specified loop in the top-level loops list with the indicated loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01040">LoopInfo.h:1040</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a85ffb6531d4cda988ea81f18d4e56fb7"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">llvm::ArrayRef::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">size - Get the array size.</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00163">ArrayRef.h:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aLoopCacheAnalysis_8h_html"><div class="ttname"><a href="LoopCacheAnalysis_8h.html">LoopCacheAnalysis.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363">llvm::MipsISD::Ins</a></div><div class="ttdeci">@ Ins</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00160">MipsISelLowering.h:160</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdoc">This class consists of common code factored out of the SmallVector class to reduce code duplication b...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00042">APFloat.h:42</a></div></div>
<div class="ttc" id="astructllvm_1_1LoopInterchangePass_html_a99a46045e2cc7182d6a786d400604d76"><div class="ttname"><a href="structllvm_1_1LoopInterchangePass.html#a99a46045e2cc7182d6a786d400604d76">llvm::LoopInterchangePass::run</a></div><div class="ttdeci">PreservedAnalyses run(LoopNest &amp;L, LoopAnalysisManager &amp;AM, LoopStandardAnalysisResults &amp;AR, LPMUpdater &amp;U)</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l01719">LoopInterchange.cpp:1719</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html">llvm::SmallPtrSetImpl</a></div><div class="ttdoc">A templated base class for SmallPtrSet which provides the typesafe interface that is common across al...</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00344">SmallPtrSet.h:344</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSetVector_html"><div class="ttname"><a href="classllvm_1_1SmallSetVector.html">llvm::SmallSetVector</a></div><div class="ttdoc">A SetVector that performs no allocations if smaller than a certain size.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00300">SetVector.h:300</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1RecurrenceDescriptor_html_a484f974fc232e862a87a6380d3a7587d"><div class="ttname"><a href="classllvm_1_1RecurrenceDescriptor.html#a484f974fc232e862a87a6380d3a7587d">llvm::RecurrenceDescriptor::isReductionPHI</a></div><div class="ttdeci">static bool isReductionPHI(PHINode *Phi, Loop *TheLoop, RecurrenceDescriptor &amp;RedDes, DemandedBits *DB=nullptr, AssumptionCache *AC=nullptr, DominatorTree *DT=nullptr, ScalarEvolution *SE=nullptr)</div><div class="ttdoc">Returns true if Phi is a reduction in TheLoop.</div><div class="ttdef"><b>Definition:</b> <a href="IVDescriptors_8cpp_source.html#l00831">IVDescriptors.cpp:831</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aDependenceAnalysis_8h_html"><div class="ttname"><a href="DependenceAnalysis_8h.html">DependenceAnalysis.h</a></div></div>
<div class="ttc" id="aLoopInterchange_8cpp_html_ad79065fb9f4aed2ac594495597b9b1c8"><div class="ttname"><a href="LoopInterchange_8cpp.html#ad79065fb9f4aed2ac594495597b9b1c8">MaxMemInstrCount</a></div><div class="ttdeci">static const unsigned MaxMemInstrCount</div><div class="ttdef"><b>Definition:</b> <a href="LoopInterchange_8cpp_source.html#l00074">LoopInterchange.cpp:74</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html"><div class="ttname"><a href="classllvm_1_1BranchInst.html">llvm::BranchInst</a></div><div class="ttdoc">Conditional or Unconditional Branch instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03139">Instructions.h:3139</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="astructllvm_1_1Dependence_1_1DVEntry_html_a36df4bc73e8888285552e52e6591a9cead4051c16e1d2336250f8e267c1e03281"><div class="ttname"><a href="structllvm_1_1Dependence_1_1DVEntry.html#a36df4bc73e8888285552e52e6591a9cead4051c16e1d2336250f8e267c1e03281">llvm::Dependence::DVEntry::EQ</a></div><div class="ttdeci">@ EQ</div><div class="ttdef"><b>Definition:</b> <a href="DependenceAnalysis_8h_source.html#l00088">DependenceAnalysis.h:88</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a22d9bcbd44563106d7217f3bd9a4039e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a22d9bcbd44563106d7217f3bd9a4039e">llvm::ScalarEvolution::getBackedgeTakenCount</a></div><div class="ttdeci">const SCEV * getBackedgeTakenCount(const Loop *L, ExitCountKind Kind=Exact)</div><div class="ttdoc">If the specified loop has a predictable backedge-taken count, return it, otherwise return a SCEVCould...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08331">ScalarEvolution.cpp:8331</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad295cb34421c21507bc9cdefe1ba3f16"><div class="ttname"><a href="namespacellvm.html#ad295cb34421c21507bc9cdefe1ba3f16">llvm::SplitBlock</a></div><div class="ttdeci">BasicBlock * SplitBlock(BasicBlock *Old, Instruction *SplitPt, DominatorTree *DT, LoopInfo *LI=nullptr, MemorySSAUpdater *MSSAU=nullptr, const Twine &amp;BBName=&quot;&quot;, bool Before=false)</div><div class="ttdoc">Split the specified block at the specified instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00935">BasicBlockUtils.cpp:935</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopNest_html"><div class="ttname"><a href="classllvm_1_1LoopNest.html">llvm::LoopNest</a></div><div class="ttdoc">This class represents a loop nest and can be used to query its properties.</div><div class="ttdef"><b>Definition:</b> <a href="LoopNestAnalysis_8h_source.html#l00028">LoopNestAnalysis.h:28</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a7e4be8b16fbd68c9045a388904044e01"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a7e4be8b16fbd68c9045a388904044e01">llvm::BranchInst::isConditional</a></div><div class="ttdeci">bool isConditional() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03218">Instructions.h:3218</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_ad97f2e60cf22f15e0cf617af52309031"><div class="ttname"><a href="classllvm_1_1BranchInst.html#ad97f2e60cf22f15e0cf617af52309031">llvm::BranchInst::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l03232">Instructions.h:3232</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:31:50 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
