<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/IPO/SampleProfileProbe.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_13abb262e9c52ddea8d07639819afd6c.html">IPO</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SampleProfileProbe.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SampleProfileProbe_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- SampleProfileProbe.cpp - Pseudo probe Instrumentation -------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file implements the SampleProfileProber transformation.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SampleProfileProbe_8h.html">llvm/Transforms/IPO/SampleProfileProbe.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BlockFrequencyInfo_8h.html">llvm/Analysis/BlockFrequencyInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="EHUtils_8h.html">llvm/Analysis/EHUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DebugInfoMetadata_8h.html">llvm/IR/DebugInfoMetadata.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MDBuilder_8h.html">llvm/IR/MDBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PseudoProbe_8h.html">llvm/IR/PseudoProbe.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SampleProf_8h.html">llvm/ProfileData/SampleProf.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CRC_8h.html">llvm/Support/CRC.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Target_2TargetMachine_8h.html">llvm/Target/TargetMachine.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instrumentation_8h.html">llvm/Transforms/Instrumentation.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ModuleUtils_8h.html">llvm/Transforms/Utils/ModuleUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="SampleProfileProbe_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   36</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;pseudo-probe&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(ArtificialDbgLine,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;          <span class="stringliteral">&quot;Number of probes that have an artificial debug line&quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="SampleProfileProbe_8cpp.html#a8fca23a0fb55c1de838effa119f4dc1f">VerifyPseudoProbe</a>(<span class="stringliteral">&quot;verify-pseudo-probe&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                      <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Do pseudo probe verification&quot;</span>));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1list.html">cl::list&lt;std::string&gt;</a> <a class="code" href="SampleProfileProbe_8cpp.html#ae8f2e6a856ee45255fca57f861b0086d">VerifyPseudoProbeFuncList</a>(</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="stringliteral">&quot;verify-pseudo-probe-funcs&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The option to specify the name of the functions to verify.&quot;</span>));</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="SampleProfileProbe_8cpp.html#a5cc791e9d426308d91e43ff28a4fac7f">UpdatePseudoProbe</a>(<span class="stringliteral">&quot;update-pseudo-probe&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                      <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Update pseudo probe distribution factor&quot;</span>));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="SampleProfileProbe_8cpp.html#abf72653c55323ec0be11bb13c103bf08">   53</a></span>&#160;<span class="keyword">static</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="SampleProfileProbe_8cpp.html#abf72653c55323ec0be11bb13c103bf08">getCallStackHash</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DILocation.html">DILocation</a> *DIL) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Hash = 0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DILocation.html">DILocation</a> *InlinedAt = DIL ? DIL-&gt;getInlinedAt() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">while</span> (InlinedAt) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    Hash ^= <a class="code" href="namespacellvm.html#abcc6aac115764c36b17d83e4bd4cc36e">MD5Hash</a>(<a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(InlinedAt-&gt;getLine()));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    Hash ^= <a class="code" href="namespacellvm.html#abcc6aac115764c36b17d83e4bd4cc36e">MD5Hash</a>(<a class="code" href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">std::to_string</a>(InlinedAt-&gt;getColumn()));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DISubprogram.html">DISubprogram</a> *SP = InlinedAt-&gt;getScope()-&gt;getSubprogram();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// Use linkage name for C++ if possible.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keyword">auto</span> Name = SP-&gt;getLinkageName();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (Name.empty())</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      Name = SP-&gt;<a class="code" href="classllvm_1_1DIScope.html#a4b0548df6ca16114b44faf5986a11f76">getName</a>();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    Hash ^= <a class="code" href="namespacellvm.html#abcc6aac115764c36b17d83e4bd4cc36e">MD5Hash</a>(Name);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    InlinedAt = InlinedAt-&gt;getInlinedAt();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">return</span> Hash;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="SampleProfileProbe_8cpp.html#aba5d19de3041eb7a532c035bbb898d3f">   70</a></span>&#160;<span class="keyword">static</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="SampleProfileProbe_8cpp.html#aba5d19de3041eb7a532c035bbb898d3f">computeCallStackHash</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SampleProfileProbe_8cpp.html#abf72653c55323ec0be11bb13c103bf08">getCallStackHash</a>(Inst.<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">bool</span> PseudoProbeVerifier::shouldVerifyFunction(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// Skip function declaration.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;isDeclaration())</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// Skip function that will not be emitted into object file. The prevailing</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// defintion will be verified instead.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;hasAvailableExternallyLinkage())</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// Do a name matching.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">static</span> std::unordered_set&lt;std::string&gt; VerifyFuncNames(</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="SampleProfileProbe_8cpp.html#ae8f2e6a856ee45255fca57f861b0086d">VerifyPseudoProbeFuncList</a>.begin(), <a class="code" href="SampleProfileProbe_8cpp.html#ae8f2e6a856ee45255fca57f861b0086d">VerifyPseudoProbeFuncList</a>.end());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">return</span> VerifyFuncNames.empty() || VerifyFuncNames.count(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName().str());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classllvm_1_1PseudoProbeVerifier.html#a3c0c496c912a11733edef199e5ae5473">   88</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#a3c0c496c912a11733edef199e5ae5473">PseudoProbeVerifier::registerCallbacks</a>(<a class="code" href="classllvm_1_1PassInstrumentationCallbacks.html">PassInstrumentationCallbacks</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ad4d247df65c12507f447383be37d7ccb">PIC</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SampleProfileProbe_8cpp.html#a8fca23a0fb55c1de838effa119f4dc1f">VerifyPseudoProbe</a>) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="PassBuilderBindings_8cpp.html#ad4d247df65c12507f447383be37d7ccb">PIC</a>.<a class="code" href="classllvm_1_1PassInstrumentationCallbacks.html#affcb37cf440a3ee656caec2c5333fa9f">registerAfterPassCallback</a>(</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        [<span class="keyword">this</span>](<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="classllvm_1_1Any.html">Any</a> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> &amp;) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;          this-&gt;<a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(P, <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        });</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// Callback to run after each transformation for the new pass manager.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">   98</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">PseudoProbeVerifier::runAfterPass</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a> PassID, <a class="code" href="classllvm_1_1Any.html">Any</a> <a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  std::string Banner =</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="stringliteral">&quot;\n*** Pseudo Probe Verification After &quot;</span> + PassID.<a class="code" href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">str</a>() + <span class="stringliteral">&quot; ***\n&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; Banner;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> **<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = any_cast&lt;const Module *&gt;(&amp;<a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>))</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(*<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> **<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = any_cast&lt;const Function *&gt;(&amp;<a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>))</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(*<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> **<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = any_cast&lt;const LazyCallGraph::SCC *&gt;(&amp;<a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>))</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> **L = any_cast&lt;const Loop *&gt;(&amp;<a class="code" href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a>))</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(*L);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown IR unit&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">PseudoProbeVerifier::runAfterPass</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Module.html">Module</a> *M) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : *M)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">PseudoProbeVerifier::runAfterPass</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> : *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(&amp;<a class="code" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">PseudoProbeVerifier::runAfterPass</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span> (!shouldVerifyFunction(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="namespacellvm.html#a975f223d509a065002374e34b51ee354">ProbeFactorMap</a> ProbeFactors;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    collectProbeFactors(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, ProbeFactors);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  verifyProbeFactors(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ProbeFactors);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">PseudoProbeVerifier::runAfterPass</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">runAfterPass</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordtype">void</span> PseudoProbeVerifier::collectProbeFactors(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Block,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                              <a class="code" href="namespacellvm.html#a975f223d509a065002374e34b51ee354">ProbeFactorMap</a> &amp;ProbeFactors) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *Block) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (std::optional&lt;PseudoProbe&gt; Probe = <a class="code" href="namespacellvm.html#a7b3e8a01dfede6141c79e012a44ec9e4">extractProbe</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Hash = <a class="code" href="SampleProfileProbe_8cpp.html#aba5d19de3041eb7a532c035bbb898d3f">computeCallStackHash</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      ProbeFactors[{Probe-&gt;Id, Hash}] += Probe-&gt;Factor;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">void</span> PseudoProbeVerifier::verifyProbeFactors(</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">const</span> <a class="code" href="namespacellvm.html#a975f223d509a065002374e34b51ee354">ProbeFactorMap</a> &amp;ProbeFactors) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">bool</span> BannerPrinted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keyword">auto</span> &amp;PrevProbeFactors = FunctionProbeFactors[<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName()];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : ProbeFactors) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">float</span> CurProbeFactor = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.second;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (PrevProbeFactors.count(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.first)) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">float</span> PrevProbeFactor = PrevProbeFactors[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.first];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a2816e84a08c108d18bc4665bc1817e01">std::abs</a>(CurProbeFactor - PrevProbeFactor) &gt;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          DistributionFactorVariance) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> (!BannerPrinted) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Function &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          BannerPrinted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Probe &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.first.first &lt;&lt; <span class="stringliteral">&quot;\tprevious factor &quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm.html#a66f0c57e04037076030c6a6e48f44f2d">format</a>(<span class="stringliteral">&quot;%0.2f&quot;</span>, PrevProbeFactor) &lt;&lt; <span class="stringliteral">&quot;\tcurrent factor &quot;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;               &lt;&lt; <a class="code" href="namespacellvm.html#a66f0c57e04037076030c6a6e48f44f2d">format</a>(<span class="stringliteral">&quot;%0.2f&quot;</span>, CurProbeFactor) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Update</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    PrevProbeFactors[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.first] = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.second;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classllvm_1_1PseudoProbeManager.html#a5653bb2cb34bd77183e9d7466d6643fd">  173</a></span>&#160;<a class="code" href="classllvm_1_1PseudoProbeManager.html#a5653bb2cb34bd77183e9d7466d6643fd">PseudoProbeManager::PseudoProbeManager</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1NamedMDNode.html">NamedMDNode</a> *FuncInfo = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getNamedMetadata(<a class="code" href="namespacellvm.html#afe8cddc1b878bbfc7598e672f96cfbf1">PseudoProbeDescMetadataName</a>)) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *Operand : FuncInfo-&gt;operands()) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> *MD = cast&lt;MDNode&gt;(Operand);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keyword">auto</span> GUID =</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          mdconst::dyn_extract&lt;ConstantInt&gt;(MD-&gt;getOperand(0))-&gt;getZExtValue();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keyword">auto</span> Hash =</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          mdconst::dyn_extract&lt;ConstantInt&gt;(MD-&gt;getOperand(1))-&gt;getZExtValue();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      GUIDToProbeDescMap.try_emplace(GUID, <a class="code" href="classllvm_1_1PseudoProbeDescriptor.html">PseudoProbeDescriptor</a>(GUID, Hash));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keyword">const</span> <a class="code" href="classllvm_1_1PseudoProbeDescriptor.html">PseudoProbeDescriptor</a> *</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;PseudoProbeManager::getDesc(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = GUIDToProbeDescMap.find(</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="classllvm_1_1GlobalValue.html#a71ee7e63264e4997a3340a781d44832e">Function::getGUID</a>(<a class="code" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa7122a07ea48e47fc71083e68b829003">FunctionSamples::getCanonicalFnName</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == GUIDToProbeDescMap.end() ? nullptr : &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;second;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classllvm_1_1PseudoProbeManager.html#a99ac6be1e268ff9d411de8fe3e6a420a">  193</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1PseudoProbeManager.html#a99ac6be1e268ff9d411de8fe3e6a420a">PseudoProbeManager::moduleIsProbed</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getNamedMetadata(<a class="code" href="namespacellvm.html#afe8cddc1b878bbfc7598e672f96cfbf1">PseudoProbeDescMetadataName</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classllvm_1_1PseudoProbeManager.html#a4fd58a5254559990a364252fbf4e5577">  197</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1PseudoProbeManager.html#a4fd58a5254559990a364252fbf4e5577">PseudoProbeManager::profileIsValid</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> &amp;Samples)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> *Desc = getDesc(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">if</span> (!Desc) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Probe descriptor missing for Function &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName()</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (Desc-&gt;getFunctionHash() != Samples.<a class="code" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a7ffff5be739dfce8ccdb944c3f485306">getFunctionHash</a>()) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Hash mismatch for Function &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName()</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classllvm_1_1SampleProfileProber.html#ab08b01da1545aac97550c1aead3b25b8">  214</a></span>&#160;<a class="code" href="classllvm_1_1SampleProfileProber.html#ab08b01da1545aac97550c1aead3b25b8">SampleProfileProber::SampleProfileProber</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Func,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                         <span class="keyword">const</span> std::string &amp;CurModuleUniqueId)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(&amp;Func), CurModuleUniqueId(CurModuleUniqueId) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  BlockProbeIds.clear();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  CallProbeIds.clear();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  LastProbeId = (<a class="code" href="classuint32__t.html">uint32_t</a>)<a class="code" href="namespacellvm.html#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">PseudoProbeReservedId::Last</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  computeProbeIdForBlocks();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  computeProbeIdForCallsites();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  computeCFGHash();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">// Compute Hash value for the CFG: the lower 32 bits are CRC32 of the index</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// value of each BB in the CFG. The higher 32 bits record the number of edges</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">// preceded by the number of indirect calls.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">// This is derived from FuncPGOInstrumentation&lt;Edge, BBInfo&gt;::computeCFGHash().</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">void</span> SampleProfileProber::computeCFGHash() {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  std::vector&lt;uint8_t&gt; Indexes;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="classllvm_1_1JamCRC.html">JamCRC</a> JC;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : *F) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">auto</span> *TI = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.getTerminator();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = TI-&gt;getNumSuccessors(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keyword">auto</span> *Succ = TI-&gt;getSuccessor(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = getBlockId(Succ);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> J = 0; J &lt; 4; J++)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        Indexes.push_back((uint8_t)(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &gt;&gt; (J * 8)));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  JC.<a class="code" href="classllvm_1_1JamCRC.html#af4c43564c4a47b6d9741736e3962e279">update</a>(Indexes);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  FunctionHash = (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)CallProbeIds.size() &lt;&lt; 48 |</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                 (<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>)Indexes.size() &lt;&lt; 32 | JC.<a class="code" href="classllvm_1_1JamCRC.html#a90e799935e361788dee83dfb9b2d5099">getCRC</a>();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// Reserve bit 60-63 for other information purpose.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  FunctionHash &amp;= 0x0FFFFFFFFFFFFFFF;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FunctionHash &amp;&amp; <span class="stringliteral">&quot;Function checksum should not be zero&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nFunction Hash Computation for &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName()</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; CRC = &quot;</span> &lt;&lt; JC.<a class="code" href="classllvm_1_1JamCRC.html#a90e799935e361788dee83dfb9b2d5099">getCRC</a>() &lt;&lt; <span class="stringliteral">&quot;, Edges = &quot;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    &lt;&lt; Indexes.size() &lt;&lt; <span class="stringliteral">&quot;, ICSites = &quot;</span> &lt;&lt; CallProbeIds.size()</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;, Hash = &quot;</span> &lt;&lt; FunctionHash &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keywordtype">void</span> SampleProfileProber::computeProbeIdForBlocks() {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> KnownColdBlocks;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="namespacellvm.html#a87783f5762b2359e185e5341a744030a">computeEHOnlyBlocks</a>(*F, KnownColdBlocks);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// Insert pseudo probe to non-cold blocks only. This will reduce IR size as</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">// well as the binary size while retaining the profile quality.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : *F) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    ++LastProbeId;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (!KnownColdBlocks.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      BlockProbeIds[&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>] = LastProbeId;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordtype">void</span> SampleProfileProber::computeProbeIdForCallsites() {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : *F) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">if</span> (!isa&lt;CallBase&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">if</span> (isa&lt;IntrinsicInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      CallProbeIds[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = ++LastProbeId;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<a class="code" href="classuint32__t.html">uint32_t</a> SampleProfileProber::getBlockId(<span class="keyword">const</span> <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BlockProbeIds.find(<span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<span class="keyword">&gt;</span>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>));</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == BlockProbeIds.end() ? 0 : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;second;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<a class="code" href="classuint32__t.html">uint32_t</a> SampleProfileProber::getCallsiteId(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Call)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keyword">auto</span> Iter = CallProbeIds.find(<span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<span class="keyword">&gt;</span>(Call));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">return</span> Iter == CallProbeIds.end() ? 0 : Iter-&gt;second;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classllvm_1_1SampleProfileProber.html#af77769bc44a5fe5006bbc89befd75e4b">  290</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classllvm_1_1SampleProfileProber.html#af77769bc44a5fe5006bbc89befd75e4b">SampleProfileProber::instrumentOneFunc</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="classllvm_1_1MDBuilder.html">MDBuilder</a> MDB(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// Compute a GUID without considering the function&#39;s linkage type. This is</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// fine since function name is the only key in the profile database.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Guid = <a class="code" href="classllvm_1_1GlobalValue.html#a71ee7e63264e4997a3340a781d44832e">Function::getGUID</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName());</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// Assign an artificial debug line to a probe that doesn&#39;t come with a real</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// line. A probe not having a debug line will get an incomplete inline</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// context. This will cause samples collected on the probe to be counted</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// into the base profile instead of a context profile. The line number</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// itself is not important though.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keyword">auto</span> AssignDebugLoc = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((isa&lt;PseudoProbeInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;CallBase&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &amp;&amp;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;           <span class="stringliteral">&quot;Expecting pseudo probe or call instructions&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc()) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SP = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getSubprogram()) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keyword">auto</span> DIL = <a class="code" href="classllvm_1_1MDNode.html#a7d10a7b9b7f40b04d27ed97c38ea1950">DILocation::get</a>(SP-&gt;getContext(), 0, 0, SP);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;setDebugLoc(DIL);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        ArtificialDbgLine++;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nIn Function &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName()</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; Probe gets an artificial debug line\n&quot;</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;dump();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        });</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  };</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// Probe basic blocks.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : BlockProbeIds) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.first;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.second;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// Insert a probe before an instruction with a valid debug line number which</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// will be assigned to the probe. The line number will be used later to</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// model the inline context when the probe is inlined into other functions.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// Debug instructions, phi nodes and lifetime markers do not have an valid</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// line number. Real instructions generated by optimizations may not come</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// with a line number either.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">auto</span> HasValidDbgLine = [](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *J) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">return</span> !isa&lt;PHINode&gt;(J) &amp;&amp; !isa&lt;DbgInfoIntrinsic&gt;(J) &amp;&amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;             !J-&gt;isLifetimeStartOrEnd() &amp;&amp; J-&gt;getDebugLoc();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    };</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *J = &amp;*<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getFirstInsertionPt();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">while</span> (J != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getTerminator() &amp;&amp; !HasValidDbgLine(J)) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      J = J-&gt;<a class="code" href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">getNextNode</a>();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(J);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.GetInsertPoint() != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;end() &amp;&amp;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;           <span class="stringliteral">&quot;Cannot get the probing point&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classllvm_1_1Function.html">Function</a> *ProbeFn =</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">llvm::Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>, Intrinsic::pseudoprobe);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>[] = {<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(Guid), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>),</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                     <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32(0),</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                     <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(<a class="code" href="namespacellvm.html#ac5679aef816604c7680e46b137df48fa">PseudoProbeFullDistributionFactor</a>)};</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">auto</span> *Probe = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateCall(ProbeFn, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    AssignDebugLoc(Probe);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">// Probe both direct calls and indirect calls. Direct calls are probed so that</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// their probe ID can be used as an call site identifier to represent a</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// calling context.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : CallProbeIds) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">auto</span> *Call = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.first;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.second;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="classllvm_1_1Type.html">Type</a> = cast&lt;CallBase&gt;(Call)-&gt;getCalledFunction()</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        ? (<a class="code" href="classuint32__t.html">uint32_t</a>)<a class="code" href="namespacellvm.html#a0e00fad9c34de40b1e31f3aa6f8e024caf8d0d4845b0b074d9f2e0f2ace6683da">PseudoProbeType::DirectCall</a></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        : (<a class="code" href="classuint32__t.html">uint32_t</a>)<a class="code" href="namespacellvm.html#a0e00fad9c34de40b1e31f3aa6f8e024ca9c73278820c265864adec96a189ba744">PseudoProbeType::IndirectCall</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    AssignDebugLoc(Call);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// Levarge the 32-bit discriminator field of debug data to store the ID and</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// type of a callsite probe. This gets rid of the dependency on plumbing a</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// customized metadata through the codegen pipeline.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> V = <a class="code" href="structllvm_1_1PseudoProbeDwarfDiscriminator.html#a2a433b6e29c3329d34a9bbbb35b00274">PseudoProbeDwarfDiscriminator::packProbeData</a>(</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, <a class="code" href="classllvm_1_1Type.html">Type</a>, 0, <a class="code" href="structllvm_1_1PseudoProbeDwarfDiscriminator.html#a6b09a010984cf76a900ab84d3574b8b2">PseudoProbeDwarfDiscriminator::FullDistributionFactor</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> DIL = Call-&gt;getDebugLoc()) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      DIL = DIL-&gt;cloneWithDiscriminator(V);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      Call-&gt;setDebugLoc(DIL);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// Create module-level metadata that contains function info necessary to</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// synthesize probe-based sample counts,  which are</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// - FunctionGUID</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// - FunctionHash.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// - FunctionName</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">auto</span> Hash = getFunctionHash();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keyword">auto</span> *MD = MDB.<a class="code" href="classllvm_1_1MDBuilder.html#a3e951f38f5a4b5cb365959819a60d4d3">createPseudoProbeDesc</a>(Guid, Hash, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keyword">auto</span> *NMD = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getNamedMetadata(<a class="code" href="namespacellvm.html#afe8cddc1b878bbfc7598e672f96cfbf1">PseudoProbeDescMetadataName</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NMD &amp;&amp; <span class="stringliteral">&quot;llvm.pseudo_probe_desc should be pre-created&quot;</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  NMD-&gt;addOperand(MD);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// Preserve a comdat group to hold all probes materialized later. This</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// allows that when the function is considered dead and removed, the</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// materialized probes are disposed too.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// Imported functions are defined in another module. They do not need</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// the following handling since same care will be taken for them in their</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// original module. The pseudo probes inserted into an imported functions</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// above will naturally not be emitted since the imported function is free</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// from object emission. However they will be emitted together with the</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// inliner functions that the imported function is inlined into. We are not</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// creating a comdat group for an import function since it&#39;s useless anyway.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclarationForLinker()) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keyword">auto</span> <a class="code" href="classllvm_1_1Triple.html">Triple</a> = <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>-&gt;getTargetTriple();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Triple.html">Triple</a>.<a class="code" href="classllvm_1_1Triple.html#a49a399e1ef632107f1a062a3d22f2118">supportsCOMDAT</a>() &amp;&amp; <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>-&gt;getFunctionSections())</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="namespacellvm.html#a9176c73c5484c0f85a02eaa609d8a38c">getOrCreateFunctionComdat</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1Triple.html">Triple</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="classllvm_1_1SampleProfileProbePass.html#a8c1accd469872b7673c9c8a033e30a0c">  402</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1SampleProfileProbePass.html#a8c1accd469872b7673c9c8a033e30a0c">SampleProfileProbePass::run</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                              <a class="code" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keyword">auto</span> ModuleId = <a class="code" href="namespacellvm.html#a6b8599f07b1b0181899c650b7b385b26">getUniqueModuleId</a>(&amp;<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// Create the pseudo probe desc metadata beforehand.</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// Note that modules with only data but no functions will require this to</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// be set up so that they will be known as probed later.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>.getOrInsertNamedMetadata(<a class="code" href="namespacellvm.html#afe8cddc1b878bbfc7598e672f96cfbf1">PseudoProbeDescMetadataName</a>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration())</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="classllvm_1_1SampleProfileProber.html">SampleProfileProber</a> ProbeManager(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ModuleId);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    ProbeManager.<a class="code" href="classllvm_1_1SampleProfileProber.html#af77769bc44a5fe5006bbc89befd75e4b">instrumentOneFunc</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, TM);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordtype">void</span> PseudoProbeUpdatePass::runOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                          <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a> = <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1BlockFrequencyAnalysis.html">BlockFrequencyAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">auto</span> BBProfileCount = [&amp;<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>](<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>.getBlockProfileCount(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>).value_or(0);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  };</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// Collect the sum of execution weight for each probe.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <a class="code" href="namespacellvm.html#a975f223d509a065002374e34b51ee354">ProbeFactorMap</a> ProbeFactors;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Block : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Block) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">if</span> (std::optional&lt;PseudoProbe&gt; Probe = <a class="code" href="namespacellvm.html#a7b3e8a01dfede6141c79e012a44ec9e4">extractProbe</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Hash = <a class="code" href="SampleProfileProbe_8cpp.html#aba5d19de3041eb7a532c035bbb898d3f">computeCallStackHash</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        ProbeFactors[{Probe-&gt;Id, Hash}] += BBProfileCount(&amp;Block);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// Fix up over-counted probes.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Block : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Block) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">if</span> (std::optional&lt;PseudoProbe&gt; Probe = <a class="code" href="namespacellvm.html#a7b3e8a01dfede6141c79e012a44ec9e4">extractProbe</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Hash = <a class="code" href="SampleProfileProbe_8cpp.html#aba5d19de3041eb7a532c035bbb898d3f">computeCallStackHash</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordtype">float</span> Sum = ProbeFactors[{Probe-&gt;Id, Hash}];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">if</span> (Sum != 0)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          <a class="code" href="namespacellvm.html#a4fb32c986b105bb7a53700e5988aab6e">setProbeDistributionFactor</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BBProfileCount(&amp;Block) / Sum);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;}</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="classllvm_1_1PseudoProbeUpdatePass.html#a1eef7e13ba8f6964ddd2f64c8a85d8b8">  451</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1PseudoProbeUpdatePass.html#a1eef7e13ba8f6964ddd2f64c8a85d8b8">PseudoProbeUpdatePass::run</a>(<a class="code" href="classllvm_1_1Module.html">Module</a> &amp;M,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                             <a class="code" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SampleProfileProbe_8cpp.html#a5cc791e9d426308d91e43ff28a4fac7f">UpdatePseudoProbe</a>) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration())</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> =</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1InnerAnalysisManagerProxy.html">FunctionAnalysisManagerModuleProxy</a>&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>).getManager();</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      runOnFunction(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aInstrumentation_8h_html"><div class="ttname"><a href="Instrumentation_8h.html">Instrumentation.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac5679aef816604c7680e46b137df48fa"><div class="ttname"><a href="namespacellvm.html#ac5679aef816604c7680e46b137df48fa">llvm::PseudoProbeFullDistributionFactor</a></div><div class="ttdeci">constexpr static uint64_t PseudoProbeFullDistributionFactor</div><div class="ttdef"><b>Definition:</b> <a href="PseudoProbe_8h_source.html#l00037">PseudoProbe.h:37</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1NamedMDNode_html"><div class="ttname"><a href="classllvm_1_1NamedMDNode.html">llvm::NamedMDNode</a></div><div class="ttdoc">A tuple of MDNodes.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l01587">Metadata.h:1587</a></div></div>
<div class="ttc" id="astructllvm_1_1PseudoProbeDwarfDiscriminator_html_a6b09a010984cf76a900ab84d3574b8b2"><div class="ttname"><a href="structllvm_1_1PseudoProbeDwarfDiscriminator.html#a6b09a010984cf76a900ab84d3574b8b2">llvm::PseudoProbeDwarfDiscriminator::FullDistributionFactor</a></div><div class="ttdeci">constexpr static uint8_t FullDistributionFactor</div><div class="ttdef"><b>Definition:</b> <a href="PseudoProbe_8h_source.html#l00077">PseudoProbe.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1JamCRC_html_af4c43564c4a47b6d9741736e3962e279"><div class="ttname"><a href="classllvm_1_1JamCRC.html#af4c43564c4a47b6d9741736e3962e279">llvm::JamCRC::update</a></div><div class="ttdeci">void update(ArrayRef&lt; uint8_t &gt; Data)</div><div class="ttdef"><b>Definition:</b> <a href="CRC_8cpp_source.html#l00103">CRC.cpp:103</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aDebugInfoMetadata_8h_html"><div class="ttname"><a href="DebugInfoMetadata_8h.html">DebugInfoMetadata.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b"><div class="ttname"><a href="namespacellvm.html#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">llvm::PseudoProbeReservedId::Last</a></div><div class="ttdeci">@ Last</div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDBuilder_html_a3e951f38f5a4b5cb365959819a60d4d3"><div class="ttname"><a href="classllvm_1_1MDBuilder.html#a3e951f38f5a4b5cb365959819a60d4d3">llvm::MDBuilder::createPseudoProbeDesc</a></div><div class="ttdeci">MDNode * createPseudoProbeDesc(uint64_t GUID, uint64_t Hash, Function *F)</div><div class="ttdoc">Return metadata containing the pseudo probe descriptor for a function.</div><div class="ttdef"><b>Definition:</b> <a href="MDBuilder_8cpp_source.html#l00338">MDBuilder.cpp:338</a></div></div>
<div class="ttc" id="aclassllvm_1_1PseudoProbeManager_html_a4fd58a5254559990a364252fbf4e5577"><div class="ttname"><a href="classllvm_1_1PseudoProbeManager.html#a4fd58a5254559990a364252fbf4e5577">llvm::PseudoProbeManager::profileIsValid</a></div><div class="ttdeci">bool profileIsValid(const Function &amp;F, const FunctionSamples &amp;Samples) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00197">SampleProfileProbe.cpp:197</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_a26708685cc8b94fe3d7092ee080dbb34"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#a26708685cc8b94fe3d7092ee080dbb34">llvm::ilist_node_with_parent::getNextNode</a></div><div class="ttdeci">NodeTy * getNextNode()</div><div class="ttdoc">Get the next node, or nullptr for the list tail.</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00289">ilist_node.h:289</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1Triple_html"><div class="ttname"><a href="classllvm_1_1Triple.html">llvm::Triple</a></div><div class="ttdoc">Triple - Helper class for working with autoconf configuration names.</div><div class="ttdef"><b>Definition:</b> <a href="Triple_8h_source.html#l00044">Triple.h:44</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIScope_html_a4b0548df6ca16114b44faf5986a11f76"><div class="ttname"><a href="classllvm_1_1DIScope.html#a4b0548df6ca16114b44faf5986a11f76">llvm::DIScope::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8cpp_source.html#l00297">DebugInfoMetadata.cpp:297</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocation_html"><div class="ttname"><a href="classllvm_1_1DILocation.html">llvm::DILocation</a></div><div class="ttdoc">Debug location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01605">DebugInfoMetadata.h:1605</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00155">PassManager.h:155</a></div></div>
<div class="ttc" id="anamespacellvm_html_a87783f5762b2359e185e5341a744030a"><div class="ttname"><a href="namespacellvm.html#a87783f5762b2359e185e5341a744030a">llvm::computeEHOnlyBlocks</a></div><div class="ttdeci">static void computeEHOnlyBlocks(FunctionT &amp;F, DenseSet&lt; BlockT * &gt; &amp;EHBlocks)</div><div class="ttdoc">Compute a list of blocks that are only reachable via EH paths.</div><div class="ttdef"><b>Definition:</b> <a href="EHUtils_8h_source.html#l00018">EHUtils.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_ad4d247df65c12507f447383be37d7ccb"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#ad4d247df65c12507f447383be37d7ccb">PIC</a></div><div class="ttdeci">PassInstrumentationCallbacks PIC</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00055">PassBuilderBindings.cpp:55</a></div></div>
<div class="ttc" id="aclassllvm_1_1SampleProfileProber_html"><div class="ttname"><a href="classllvm_1_1SampleProfileProber.html">llvm::SampleProfileProber</a></div><div class="ttdoc">Sample profile pseudo prober.</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8h_source.html#l00099">SampleProfileProbe.h:99</a></div></div>
<div class="ttc" id="aclassllvm_1_1JamCRC_html"><div class="ttname"><a href="classllvm_1_1JamCRC.html">llvm::JamCRC</a></div><div class="ttdef"><b>Definition:</b> <a href="CRC_8h_source.html#l00045">CRC.h:45</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDNode_html_a7d10a7b9b7f40b04d27ed97c38ea1950"><div class="ttname"><a href="classllvm_1_1MDNode.html#a7d10a7b9b7f40b04d27ed97c38ea1950">llvm::MDNode::get</a></div><div class="ttdeci">static MDTuple * get(LLVMContext &amp;Context, ArrayRef&lt; Metadata * &gt; MDs)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l01399">Metadata.h:1399</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="astructllvm_1_1PseudoProbeDwarfDiscriminator_html_a2a433b6e29c3329d34a9bbbb35b00274"><div class="ttname"><a href="structllvm_1_1PseudoProbeDwarfDiscriminator.html#a2a433b6e29c3329d34a9bbbb35b00274">llvm::PseudoProbeDwarfDiscriminator::packProbeData</a></div><div class="ttdeci">static uint32_t packProbeData(uint32_t Index, uint32_t Type, uint32_t Flags, uint32_t Factor)</div><div class="ttdef"><b>Definition:</b> <a href="PseudoProbe_8h_source.html#l00050">PseudoProbe.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0e00fad9c34de40b1e31f3aa6f8e024ca9c73278820c265864adec96a189ba744"><div class="ttname"><a href="namespacellvm.html#a0e00fad9c34de40b1e31f3aa6f8e024ca9c73278820c265864adec96a189ba744">llvm::PseudoProbeType::IndirectCall</a></div><div class="ttdeci">@ IndirectCall</div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html">llvm::BlockFrequencyInfo</a></div><div class="ttdoc">BlockFrequencyInfo pass uses BlockFrequencyInfoImpl implementation to estimate IR basic block frequen...</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00037">BlockFrequencyInfo.h:37</a></div></div>
<div class="ttc" id="aclassllvm_1_1PseudoProbeUpdatePass_html_a1eef7e13ba8f6964ddd2f64c8a85d8b8"><div class="ttname"><a href="classllvm_1_1PseudoProbeUpdatePass.html#a1eef7e13ba8f6964ddd2f64c8a85d8b8">llvm::PseudoProbeUpdatePass::run</a></div><div class="ttdeci">PreservedAnalyses run(Module &amp;M, ModuleAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00451">SampleProfileProbe.cpp:451</a></div></div>
<div class="ttc" id="aTarget_2TargetMachine_8h_html"><div class="ttname"><a href="Target_2TargetMachine_8h.html">TargetMachine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1SCC_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1SCC.html">llvm::LazyCallGraph::SCC</a></div><div class="ttdoc">An SCC of the call graph.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00419">LazyCallGraph.h:419</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="anamespacellvm_html_afe8cddc1b878bbfc7598e672f96cfbf1"><div class="ttname"><a href="namespacellvm.html#afe8cddc1b878bbfc7598e672f96cfbf1">llvm::PseudoProbeDescMetadataName</a></div><div class="ttdeci">constexpr const char * PseudoProbeDescMetadataName</div><div class="ttdef"><b>Definition:</b> <a href="PseudoProbe_8h_source.html#l00025">PseudoProbe.h:25</a></div></div>
<div class="ttc" id="aCRC_8h_html"><div class="ttname"><a href="CRC_8h.html">CRC.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Triple_html_a49a399e1ef632107f1a062a3d22f2118"><div class="ttname"><a href="classllvm_1_1Triple.html#a49a399e1ef632107f1a062a3d22f2118">llvm::Triple::supportsCOMDAT</a></div><div class="ttdeci">bool supportsCOMDAT() const</div><div class="ttdoc">Tests whether the target supports comdat.</div><div class="ttdef"><b>Definition:</b> <a href="Triple_8h_source.html#l00948">Triple.h:948</a></div></div>
<div class="ttc" id="aSampleProf_8h_html"><div class="ttname"><a href="SampleProf_8h.html">SampleProf.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aMDBuilder_8h_html"><div class="ttname"><a href="MDBuilder_8h.html">MDBuilder.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="anamespacellvm_html_a4fb32c986b105bb7a53700e5988aab6e"><div class="ttname"><a href="namespacellvm.html#a4fb32c986b105bb7a53700e5988aab6e">llvm::setProbeDistributionFactor</a></div><div class="ttdeci">void setProbeDistributionFactor(Instruction &amp;Inst, float Factor)</div><div class="ttdef"><b>Definition:</b> <a href="PseudoProbe_8cpp_source.html#l00066">PseudoProbe.cpp:66</a></div></div>
<div class="ttc" id="aLint_8cpp_html_a7fb3c9caadeb0f7fe4828d380158d0f9"><div class="ttname"><a href="Lint_8cpp.html#a7fb3c9caadeb0f7fe4828d380158d0f9">IR</a></div><div class="ttdeci">Statically lint checks LLVM IR</div><div class="ttdef"><b>Definition:</b> <a href="Lint_8cpp_source.html#l00746">Lint.cpp:746</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyAnalysis_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyAnalysis.html">llvm::BlockFrequencyAnalysis</a></div><div class="ttdoc">Analysis pass which computes BlockFrequencyInfo.</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00112">BlockFrequencyInfo.h:112</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PseudoProbeVerifier_html_ac60402c1f75ca79798e4924098bd2066"><div class="ttname"><a href="classllvm_1_1PseudoProbeVerifier.html#ac60402c1f75ca79798e4924098bd2066">llvm::PseudoProbeVerifier::runAfterPass</a></div><div class="ttdeci">void runAfterPass(StringRef PassID, Any IR)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00098">SampleProfileProbe.cpp:98</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aSampleProfileProbe_8cpp_html_abf72653c55323ec0be11bb13c103bf08"><div class="ttname"><a href="SampleProfileProbe_8cpp.html#abf72653c55323ec0be11bb13c103bf08">getCallStackHash</a></div><div class="ttdeci">static uint64_t getCallStackHash(const DILocation *DIL)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00053">SampleProfileProbe.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseSet_html"><div class="ttname"><a href="classllvm_1_1DenseSet.html">llvm::DenseSet&lt; BasicBlock * &gt;</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html">llvm::sampleprof::FunctionSamples</a></div><div class="ttdoc">Representation of the samples collected for a function.</div><div class="ttdef"><b>Definition:</b> <a href="SampleProf_8h_source.html#l00726">SampleProf.h:726</a></div></div>
<div class="ttc" id="aEHUtils_8h_html"><div class="ttname"><a href="EHUtils_8h.html">EHUtils.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_a7ffff5be739dfce8ccdb944c3f485306"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a7ffff5be739dfce8ccdb944c3f485306">llvm::sampleprof::FunctionSamples::getFunctionHash</a></div><div class="ttdeci">uint64_t getFunctionHash() const</div><div class="ttdef"><b>Definition:</b> <a href="SampleProf_8h_source.html#l01032">SampleProf.h:1032</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1TargetMachine_html"><div class="ttname"><a href="classllvm_1_1TargetMachine.html">llvm::TargetMachine</a></div><div class="ttdoc">Primary interface to the complete machine description for the target machine.</div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00078">TargetMachine.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1PseudoProbeDescriptor_html"><div class="ttname"><a href="classllvm_1_1PseudoProbeDescriptor.html">llvm::PseudoProbeDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8h_source.html#l00044">SampleProfileProbe.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aSampleProfileProbe_8h_html"><div class="ttname"><a href="SampleProfileProbe_8h.html">SampleProfileProbe.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1Node_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1Node.html">llvm::LazyCallGraph::Node</a></div><div class="ttdoc">A node in the call graph.</div><div class="ttdef"><b>Definition:</b> <a href="LazyCallGraph_8h_source.html#l00315">LazyCallGraph.h:315</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aclassllvm_1_1SampleProfileProber_html_ab08b01da1545aac97550c1aead3b25b8"><div class="ttname"><a href="classllvm_1_1SampleProfileProber.html#ab08b01da1545aac97550c1aead3b25b8">llvm::SampleProfileProber::SampleProfileProber</a></div><div class="ttdeci">SampleProfileProber(Function &amp;F, const std::string &amp;CurModuleUniqueId)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00214">SampleProfileProbe.cpp:214</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7b3e8a01dfede6141c79e012a44ec9e4"><div class="ttname"><a href="namespacellvm.html#a7b3e8a01dfede6141c79e012a44ec9e4">llvm::extractProbe</a></div><div class="ttdeci">std::optional&lt; PseudoProbe &gt; extractProbe(const Instruction &amp;Inst)</div><div class="ttdef"><b>Definition:</b> <a href="PseudoProbe_8cpp_source.html#l00049">PseudoProbe.cpp:49</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_ad409c2de8502b94c8a0b1193307c63b6"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#ad409c2de8502b94c8a0b1193307c63b6">llvm::detail::DenseSetImpl::contains</a></div><div class="ttdeci">bool contains(const_arg_type_t&lt; ValueT &gt; V) const</div><div class="ttdoc">Check if the set contains the given element.</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00185">DenseSet.h:185</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1PseudoProbeManager_html_a5653bb2cb34bd77183e9d7466d6643fd"><div class="ttname"><a href="classllvm_1_1PseudoProbeManager.html#a5653bb2cb34bd77183e9d7466d6643fd">llvm::PseudoProbeManager::PseudoProbeManager</a></div><div class="ttdeci">PseudoProbeManager(const Module &amp;M)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00173">SampleProfileProbe.cpp:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1SampleProfileProbePass_html_a8c1accd469872b7673c9c8a033e30a0c"><div class="ttname"><a href="classllvm_1_1SampleProfileProbePass.html#a8c1accd469872b7673c9c8a033e30a0c">llvm::SampleProfileProbePass::run</a></div><div class="ttdeci">PreservedAnalyses run(Module &amp;M, ModuleAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00402">SampleProfileProbe.cpp:402</a></div></div>
<div class="ttc" id="aclassllvm_1_1PseudoProbeVerifier_html_a3c0c496c912a11733edef199e5ae5473"><div class="ttname"><a href="classllvm_1_1PseudoProbeVerifier.html#a3c0c496c912a11733edef199e5ae5473">llvm::PseudoProbeVerifier::registerCallbacks</a></div><div class="ttdeci">void registerCallbacks(PassInstrumentationCallbacks &amp;PIC)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00088">SampleProfileProbe.cpp:88</a></div></div>
<div class="ttc" id="anamespacellvm_html_a66f0c57e04037076030c6a6e48f44f2d"><div class="ttname"><a href="namespacellvm.html#a66f0c57e04037076030c6a6e48f44f2d">llvm::format</a></div><div class="ttdeci">format_object&lt; Ts... &gt; format(const char *Fmt, const Ts &amp;... Vals)</div><div class="ttdoc">These are helper functions used to produce formatted output.</div><div class="ttdef"><b>Definition:</b> <a href="Format_8h_source.html#l00124">Format.h:124</a></div></div>
<div class="ttc" id="aBlockFrequencyInfo_8h_html"><div class="ttname"><a href="BlockFrequencyInfo_8h.html">BlockFrequencyInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPUISD_html_a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996"><div class="ttname"><a href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">llvm::AMDGPUISD::BFI</a></div><div class="ttdeci">@ BFI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUISelLowering_8h_source.html#l00441">AMDGPUISelLowering.h:441</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_aefa39f6b622360ce4e947feb9f671b73"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=std::nullopt)</div><div class="ttdoc">Create or insert an LLVM Function declaration for an intrinsic, and return it.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l01502">Function.cpp:1502</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassInstrumentationCallbacks_html_affcb37cf440a3ee656caec2c5333fa9f"><div class="ttname"><a href="classllvm_1_1PassInstrumentationCallbacks.html#affcb37cf440a3ee656caec2c5333fa9f">llvm::PassInstrumentationCallbacks::registerAfterPassCallback</a></div><div class="ttdeci">void registerAfterPassCallback(CallableT C, bool ToFront=false)</div><div class="ttdef"><b>Definition:</b> <a href="PassInstrumentation_8h_source.html#l00111">PassInstrumentation.h:111</a></div></div>
<div class="ttc" id="aclassllvm_1_1Any_html"><div class="ttname"><a href="classllvm_1_1Any.html">llvm::Any</a></div><div class="ttdef"><b>Definition:</b> <a href="Any_8h_source.html#l00028">Any.h:28</a></div></div>
<div class="ttc" id="aclassllvm_1_1JamCRC_html_a90e799935e361788dee83dfb9b2d5099"><div class="ttname"><a href="classllvm_1_1JamCRC.html#a90e799935e361788dee83dfb9b2d5099">llvm::JamCRC::getCRC</a></div><div class="ttdeci">uint32_t getCRC() const</div><div class="ttdef"><b>Definition:</b> <a href="CRC_8h_source.html#l00052">CRC.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a71ee7e63264e4997a3340a781d44832e"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a71ee7e63264e4997a3340a781d44832e">llvm::GlobalValue::getGUID</a></div><div class="ttdeci">GUID getGUID() const</div><div class="ttdoc">Return a 64-bit global unique ID constructed from global value name (i.e.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00591">GlobalValue.h:591</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9176c73c5484c0f85a02eaa609d8a38c"><div class="ttname"><a href="namespacellvm.html#a9176c73c5484c0f85a02eaa609d8a38c">llvm::getOrCreateFunctionComdat</a></div><div class="ttdeci">Comdat * getOrCreateFunctionComdat(Function &amp;F, Triple &amp;T)</div><div class="ttdef"><b>Definition:</b> <a href="Instrumentation_8cpp_source.html#l00076">Instrumentation.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="anamespacellvm_html_a975f223d509a065002374e34b51ee354"><div class="ttname"><a href="namespacellvm.html#a975f223d509a065002374e34b51ee354">llvm::ProbeFactorMap</a></div><div class="ttdeci">std::unordered_map&lt; std::pair&lt; uint64_t, uint64_t &gt;, float, pair_hash&lt; uint64_t, uint64_t &gt; &gt; ProbeFactorMap</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8h_source.html#l00041">SampleProfileProbe.h:41</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6b8599f07b1b0181899c650b7b385b26"><div class="ttname"><a href="namespacellvm.html#a6b8599f07b1b0181899c650b7b385b26">llvm::getUniqueModuleId</a></div><div class="ttdeci">std::string getUniqueModuleId(Module *M)</div><div class="ttdoc">Produce a unique identifier for this module by taking the MD5 sum of the names of the module's strong...</div><div class="ttdef"><b>Definition:</b> <a href="ModuleUtils_8cpp_source.html#l00296">ModuleUtils.cpp:296</a></div></div>
<div class="ttc" id="aPseudoProbe_8h_html"><div class="ttname"><a href="PseudoProbe_8h.html">PseudoProbe.h</a></div></div>
<div class="ttc" id="aSampleProfileProbe_8cpp_html_ae8f2e6a856ee45255fca57f861b0086d"><div class="ttname"><a href="SampleProfileProbe_8cpp.html#ae8f2e6a856ee45255fca57f861b0086d">VerifyPseudoProbeFuncList</a></div><div class="ttdeci">static cl::list&lt; std::string &gt; VerifyPseudoProbeFuncList(&quot;verify-pseudo-probe-funcs&quot;, cl::Hidden, cl::desc(&quot;The option to specify the name of the functions to verify.&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1MDBuilder_html"><div class="ttname"><a href="classllvm_1_1MDBuilder.html">llvm::MDBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="MDBuilder_8h_source.html#l00036">MDBuilder.h:36</a></div></div>
<div class="ttc" id="aSampleProfileProbe_8cpp_html_aba5d19de3041eb7a532c035bbb898d3f"><div class="ttname"><a href="SampleProfileProbe_8cpp.html#aba5d19de3041eb7a532c035bbb898d3f">computeCallStackHash</a></div><div class="ttdeci">static uint64_t computeCallStackHash(const Instruction &amp;Inst)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00070">SampleProfileProbe.cpp:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_aa7122a07ea48e47fc71083e68b829003"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa7122a07ea48e47fc71083e68b829003">llvm::sampleprof::FunctionSamples::getCanonicalFnName</a></div><div class="ttdeci">static StringRef getCanonicalFnName(const Function &amp;F)</div><div class="ttdoc">Return the canonical name for a function, taking into account suffix elision policy attributes.</div><div class="ttdef"><b>Definition:</b> <a href="SampleProf_8h_source.html#l01036">SampleProf.h:1036</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aclassllvm_1_1SampleProfileProber_html_af77769bc44a5fe5006bbc89befd75e4b"><div class="ttname"><a href="classllvm_1_1SampleProfileProber.html#af77769bc44a5fe5006bbc89befd75e4b">llvm::SampleProfileProber::instrumentOneFunc</a></div><div class="ttdeci">void instrumentOneFunc(Function &amp;F, TargetMachine *TM)</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00290">SampleProfileProbe.cpp:290</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassInstrumentationCallbacks_html"><div class="ttname"><a href="classllvm_1_1PassInstrumentationCallbacks.html">llvm::PassInstrumentationCallbacks</a></div><div class="ttdoc">This class manages callbacks registration, as well as provides a way for PassInstrumentation to pass ...</div><div class="ttdef"><b>Definition:</b> <a href="PassInstrumentation_8h_source.html#l00066">PassInstrumentation.h:66</a></div></div>
<div class="ttc" id="aModuleUtils_8h_html"><div class="ttname"><a href="ModuleUtils_8h.html">ModuleUtils.h</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="anamespacellvm_html_a13c1b5a253da5da49ce33d03dc1efc07"><div class="ttname"><a href="namespacellvm.html#a13c1b5a253da5da49ce33d03dc1efc07">llvm::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;Value)</div><div class="ttdef"><b>Definition:</b> <a href="ScopedPrinter_8h_source.html#l00085">ScopedPrinter.h:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1DISubprogram_html"><div class="ttname"><a href="classllvm_1_1DISubprogram.html">llvm::DISubprogram</a></div><div class="ttdoc">Subprogram description.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l01851">DebugInfoMetadata.h:1851</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a223dd14e7d12bc5cea01889b972a98b2"><div class="ttname"><a href="classllvm_1_1StringRef.html#a223dd14e7d12bc5cea01889b972a98b2">llvm::StringRef::str</a></div><div class="ttdeci">std::string str() const</div><div class="ttdoc">str - Get the contents as an std::string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00222">StringRef.h:222</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_ab76052bb166c65901edb603a3e1f03ab"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a></div><div class="ttdeci">const char LLVMTargetMachineRef TM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00047">PassBuilderBindings.cpp:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1InnerAnalysisManagerProxy_html"><div class="ttname"><a href="classllvm_1_1InnerAnalysisManagerProxy.html">llvm::InnerAnalysisManagerProxy</a></div><div class="ttdoc">An analysis over an &quot;outer&quot; IR unit that provides access to an analysis manager over an &quot;inner&quot; IR un...</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00931">PassManager.h:931</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="aSampleProfileProbe_8cpp_html_a5cc791e9d426308d91e43ff28a4fac7f"><div class="ttname"><a href="SampleProfileProbe_8cpp.html#a5cc791e9d426308d91e43ff28a4fac7f">UpdatePseudoProbe</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; UpdatePseudoProbe(&quot;update-pseudo-probe&quot;, cl::init(true), cl::Hidden, cl::desc(&quot;Update pseudo probe distribution factor&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_a2816e84a08c108d18bc4665bc1817e01"><div class="ttname"><a href="namespacellvm.html#a2816e84a08c108d18bc4665bc1817e01">llvm::abs</a></div><div class="ttdeci">APFloat abs(APFloat X)</div><div class="ttdoc">Returns the absolute value of the argument.</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01332">APFloat.h:1332</a></div></div>
<div class="ttc" id="aSampleProfileProbe_8cpp_html_a8fca23a0fb55c1de838effa119f4dc1f"><div class="ttname"><a href="SampleProfileProbe_8cpp.html#a8fca23a0fb55c1de838effa119f4dc1f">VerifyPseudoProbe</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; VerifyPseudoProbe(&quot;verify-pseudo-probe&quot;, cl::init(false), cl::Hidden, cl::desc(&quot;Do pseudo probe verification&quot;))</div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1PseudoProbeManager_html_a99ac6be1e268ff9d411de8fe3e6a420a"><div class="ttname"><a href="classllvm_1_1PseudoProbeManager.html#a99ac6be1e268ff9d411de8fe3e6a420a">llvm::PseudoProbeManager::moduleIsProbed</a></div><div class="ttdeci">bool moduleIsProbed(const Module &amp;M) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfileProbe_8cpp_source.html#l00193">SampleProfileProbe.cpp:193</a></div></div>
<div class="ttc" id="anamespacellvm_html_abcc6aac115764c36b17d83e4bd4cc36e"><div class="ttname"><a href="namespacellvm.html#abcc6aac115764c36b17d83e4bd4cc36e">llvm::MD5Hash</a></div><div class="ttdeci">uint64_t MD5Hash(StringRef Str)</div><div class="ttdoc">Helper to compute and return lower 64 bits of the given string's MD5 hash.</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8h_source.html#l00109">MD5.h:109</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0e00fad9c34de40b1e31f3aa6f8e024caf8d0d4845b0b074d9f2e0f2ace6683da"><div class="ttname"><a href="namespacellvm.html#a0e00fad9c34de40b1e31f3aa6f8e024caf8d0d4845b0b074d9f2e0f2ace6683da">llvm::PseudoProbeType::DirectCall</a></div><div class="ttdeci">@ DirectCall</div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1list_html"><div class="ttname"><a href="classllvm_1_1cl_1_1list.html">llvm::cl::list</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01646">CommandLine.h:1646</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:27:13 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
