<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Scalar/SROA.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_e6e1f1f37d351595fa984b942927b205.html">Scalar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SROA.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SROA_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- SROA.cpp - Scalar Replacement Of Aggregates ------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/// \file</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// This transformation implements the well known scalar replacement of</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// aggregates transformation. It tries to identify promotable elements of an</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/// aggregate alloca, and promote them to registers. It will also try to</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/// convert uses of an element (or set of elements) of an alloca into a vector</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/// or bitfield-style integer scalar if appropriate.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/// It works to do this with minimal slicing of the alloca so that regions</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/// which are merely transferred in and out of external memory remain unchanged</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/// and are not decomposed to scalar code.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/// Because this also performs alloca promotion, it can be thought of as also</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/// serving the purpose of SSA formation. The algorithm iterates on the</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/// function until all opportunities for promotion have been realized.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SROA_8h.html">llvm/Transforms/Scalar/SROA.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="APInt_8h.html">llvm/ADT/APInt.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ArrayRef_8h.html">llvm/ADT/ArrayRef.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PointerIntPair_8h.html">llvm/ADT/PointerIntPair.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallBitVector_8h.html">llvm/ADT/SmallBitVector.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Twine_8h.html">llvm/ADT/Twine.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="iterator_8h.html">llvm/ADT/iterator.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="iterator__range_8h.html">llvm/ADT/iterator_range.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AssumptionCache_8h.html">llvm/Analysis/AssumptionCache.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DomTreeUpdater_8h.html">llvm/Analysis/DomTreeUpdater.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalsModRef_8h.html">llvm/Analysis/GlobalsModRef.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Loads_8h.html">llvm/Analysis/Loads.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PtrUseVisitor_8h.html">llvm/Analysis/PtrUseVisitor.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;llvm/Config/llvm-config.h&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constant_8h.html">llvm/IR/Constant.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConstantFolder_8h.html">llvm/IR/ConstantFolder.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DIBuilder_8h.html">llvm/IR/DIBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2DebugInfo_8h.html">llvm/IR/DebugInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DebugInfoMetadata_8h.html">llvm/IR/DebugInfoMetadata.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GetElementPtrTypeIterator_8h.html">llvm/IR/GetElementPtrTypeIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalAlias_8h.html">llvm/IR/GlobalAlias.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstVisitor_8h.html">llvm/IR/InstVisitor.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Metadata_8h.html">llvm/IR/Metadata.h</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Operator_8h.html">llvm/IR/Operator.h</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PassManager_8h.html">llvm/IR/PassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Use_8h.html">llvm/IR/Use.h</a>&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="User_8h.html">llvm/IR/User.h</a>&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Compiler_8h.html">llvm/Support/Compiler.h</a>&quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PromoteMemToReg_8h.html">llvm/Transforms/Utils/PromoteMemToReg.h</a>&quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">using namespace </span><a class="code" href="SROA_8cpp.html#a6990f15b9f29df6e8497b3e53875ccab">llvm::sroa</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   99</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;sroa&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumAllocasAnalyzed, <span class="stringliteral">&quot;Number of allocas analyzed for replacement&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumAllocaPartitions, <span class="stringliteral">&quot;Number of alloca partitions formed&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(MaxPartitionsPerAlloca, <span class="stringliteral">&quot;Maximum number of partitions per alloca&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumAllocaPartitionUses, <span class="stringliteral">&quot;Number of alloca partition uses rewritten&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(MaxUsesPerAllocaPartition, <span class="stringliteral">&quot;Maximum number of uses of a partition&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumNewAllocas, <span class="stringliteral">&quot;Number of new, smaller allocas introduced&quot;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumPromoted, <span class="stringliteral">&quot;Number of allocas promoted to SSA values&quot;</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumLoadsSpeculated, <span class="stringliteral">&quot;Number of loads speculated to allow promotion&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumLoadsPredicated,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          <span class="stringliteral">&quot;Number of loads rewritten into predicated loads to allow promotion&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    NumStoresPredicated,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="stringliteral">&quot;Number of stores rewritten into predicated loads to allow promotion&quot;</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumDeleted, <span class="stringliteral">&quot;Number of instructions deleted&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumVectorized, <span class="stringliteral">&quot;Number of vectorized aggregates&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/// Hidden option to experiment with completely strict handling of inbounds</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">/// GEPs.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="SROA_8cpp.html#ac6da6bff872f9db9f549ab7dd6086a61">SROAStrictInbounds</a>(<span class="stringliteral">&quot;sroa-strict-inbounds&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                        <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);<span class="comment"></span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/// Disable running mem2reg during SROA in order to test or debug SROA.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="SROA_8cpp.html#ae96de1d4cd86e9e063cf40ee8910f329">SROASkipMem2Reg</a>(<span class="stringliteral">&quot;sroa-skip-mem2reg&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                     <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/// Calculate the fragment of a variable to use when slicing a store</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/// based on the slice dimensions, existing fragment, and base storage</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">/// fragment.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/// Note that a returned value of std::nullopt indicates that there is</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/// no appropriate fragment available (rather than meaning use the whole</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">/// variable, which is a common usage). Because the store is being sliced</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/// we always expect a fragment - there&#39;s never a case where the whole</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">/// variable should be used.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::optional&lt;DIExpression::FragmentInfo&gt;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;calculateFragment(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NewStorageSliceOffsetInBits,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NewStorageSliceSizeInBits,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                  std::optional&lt;DIExpression::FragmentInfo&gt; StorageFragment,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                  std::optional&lt;DIExpression::FragmentInfo&gt; CurrentFragment) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="structllvm_1_1DIExpression_1_1FragmentInfo.html">DIExpression::FragmentInfo</a> <a class="code" href="classllvm_1_1Target.html">Target</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// If the base storage describes part of the variable apply the offset and</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// the size constraint.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">if</span> (StorageFragment) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classllvm_1_1Target.html">Target</a>.SizeInBits =</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(NewStorageSliceSizeInBits, StorageFragment-&gt;SizeInBits);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classllvm_1_1Target.html">Target</a>.OffsetInBits =</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        NewStorageSliceOffsetInBits + StorageFragment-&gt;OffsetInBits;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="classllvm_1_1Target.html">Target</a>.SizeInBits = NewStorageSliceSizeInBits;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classllvm_1_1Target.html">Target</a>.OffsetInBits = NewStorageSliceOffsetInBits;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// No additional work to do if there isn&#39;t a fragment already, or there is</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// but it already exactly describes the new assignment.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">if</span> (!CurrentFragment || *CurrentFragment == <a class="code" href="classllvm_1_1Target.html">Target</a>)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Target.html">Target</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// Reject the target fragment if it doesn&#39;t fit wholly within the current</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// fragment. TODO: We could instead chop up the target to fit in the case of</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// a partial overlap.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Target.html">Target</a>.startInBits() &lt; CurrentFragment-&gt;startInBits() ||</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="classllvm_1_1Target.html">Target</a>.endInBits() &gt; CurrentFragment-&gt;endInBits())</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// Target fits within the current fragment, return it.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1Target.html">Target</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1DebugVariable.html">DebugVariable</a> getAggregateVariable(<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *DVI) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1DebugVariable.html">DebugVariable</a>(DVI-&gt;<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html#ac161deb2a31f78c85f94fbe0f3ba97b4">getVariable</a>(), std::nullopt,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                       DVI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>().<a class="code" href="classllvm_1_1DebugLoc.html#ada0b6f3c53a53b7274e7aeb23eeab5a8">getInlinedAt</a>());</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">/// Find linked dbg.assign and generate a new one with the correct</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">/// FragmentInfo. Link Inst to the new dbg.assign.  If Value is nullptr the</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">/// value component is copied from the old dbg.assign to the new.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">/// \param OldAlloca             Alloca for the variable before splitting.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">/// \param IsSplit               True if the store (not necessarily alloca)</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">///                              is being split.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">/// \param OldAllocaOffsetInBits Offset of the slice taken from OldAlloca.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">/// \param SliceSizeInBits       New number of bits being written to.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">/// \param OldInst               Instruction that is being split.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">/// \param Inst                  New instruction performing this part of the</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">///                              split store.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">/// \param Dest                  Store destination.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/// \param Value                 Stored value.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/// \param DL                    Datalayout.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> migrateDebugInfo(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *OldAlloca, <span class="keywordtype">bool</span> IsSplit,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                             <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> OldAllocaOffsetInBits,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                             <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SliceSizeInBits, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OldInst,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                             <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst, <a class="code" href="classllvm_1_1Value.html">Value</a> *Dest, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classllvm_1_1Value.html">Value</a>,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keyword">auto</span> MarkerRange = <a class="code" href="namespacellvm_1_1at.html#a3c90899e8f022656e511630de42b916c">at::getAssignmentMarkers</a>(OldInst);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// Nothing to do if OldInst has no linked dbg.assign intrinsics.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">if</span> (MarkerRange.empty())</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  migrateDebugInfo\n&quot;</span>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    OldAlloca: &quot;</span> &lt;&lt; *OldAlloca &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    IsSplit: &quot;</span> &lt;&lt; IsSplit &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    OldAllocaOffsetInBits: &quot;</span> &lt;&lt; OldAllocaOffsetInBits</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    SliceSizeInBits: &quot;</span> &lt;&lt; SliceSizeInBits &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    OldInst: &quot;</span> &lt;&lt; *OldInst &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Inst: &quot;</span> &lt;&lt; *Inst &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Dest: &quot;</span> &lt;&lt; *Dest &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a>)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Value: &quot;</span> &lt;&lt; *<a class="code" href="classllvm_1_1Value.html">Value</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">  /// Map of aggregate variables to their fragment associated with OldAlloca.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;DebugVariable, std::optional&lt;DIExpression::FragmentInfo&gt;</a>&gt;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      BaseFragments;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DAI : <a class="code" href="namespacellvm_1_1at.html#a3c90899e8f022656e511630de42b916c">at::getAssignmentMarkers</a>(OldAlloca))</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    BaseFragments[getAggregateVariable(DAI)] =</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        DAI-&gt;getExpression()-&gt;getFragmentInfo();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// The new inst needs a DIAssignID unique metadata tag (if OldInst has</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// one). It shouldn&#39;t already have one: assert this assumption.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae22f493ba8327ce92e87d3b96bce7017">getMetadata</a>(LLVMContext::MD_DIAssignID));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="classllvm_1_1DIAssignID.html">DIAssignID</a> *NewID = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">auto</span> &amp;Ctx = Inst-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="classllvm_1_1DIBuilder.html">DIBuilder</a> DIB(*OldInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>(), <span class="comment">/*AllowUnresolved*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OldAlloca-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a36e31f42170be95fc392dad696d9ba19">isStaticAlloca</a>());</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgAssignIntrinsic.html">DbgAssignIntrinsic</a> *DbgAssign : MarkerRange) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;      existing dbg.assign is: &quot;</span> &lt;&lt; *DbgAssign</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">auto</span> *Expr = DbgAssign-&gt;getExpression();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (IsSplit) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      std::optional&lt;DIExpression::FragmentInfo&gt; BaseFragment = std::nullopt;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = BaseFragments.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(getAggregateVariable(DbgAssign));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (R == BaseFragments.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        BaseFragment = <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>-&gt;second;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      std::optional&lt;DIExpression::FragmentInfo&gt; CurrentFragment =</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;          Expr-&gt;getFragmentInfo();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      std::optional&lt;DIExpression::FragmentInfo&gt; NewFragment =</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          calculateFragment(OldAllocaOffsetInBits, SliceSizeInBits,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                            BaseFragment, CurrentFragment);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">// Note that std::nullopt here means &quot;skip this fragment&quot; rather than</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">// &quot;there is no fragment / use the whole variable&quot;.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">if</span> (!NewFragment)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">if</span> (!(NewFragment == CurrentFragment)) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">if</span> (CurrentFragment) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          <span class="comment">// Rewrite NewFragment to be relative to the existing one (this is</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <span class="comment">// what createFragmentExpression wants).  CalculateFragment has</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <span class="comment">// already resolved the size for us. FIXME: Should it return the</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="comment">// relative fragment too?</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;          NewFragment-&gt;OffsetInBits -= CurrentFragment-&gt;OffsetInBits;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="classllvm_1_1DIExpression.html#ab2fc167f75191e1d22e12e8e382605bb">DIExpression::createFragmentExpression</a>(</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            Expr, NewFragment-&gt;OffsetInBits, NewFragment-&gt;SizeInBits);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> &amp;&amp; <span class="stringliteral">&quot;Failed to create fragment expr!&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        Expr = *<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// If we haven&#39;t created a DIAssignID ID do that now and attach it to Inst.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (!NewID) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      NewID = <a class="code" href="classllvm_1_1DIAssignID.html#a9d9cf0278178d1da39f6797777e683f7">DIAssignID::getDistinct</a>(Ctx);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD_DIAssignID, NewID);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> = <a class="code" href="classllvm_1_1Value.html">Value</a> ? <a class="code" href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">Value</a> : DbgAssign-&gt;getValue();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">auto</span> *NewAssign = DIB.insertDbgAssign(</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        Inst, <a class="code" href="classllvm_1_1Value.html">Value</a>, DbgAssign-&gt;getVariable(), Expr, Dest,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="classllvm_1_1MDNode.html#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(Ctx, std::nullopt), DbgAssign-&gt;getDebugLoc());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// We could use more precision here at the cost of some additional (code)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// complexity - if the original dbg.assign was adjacent to its store, we</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// could position this new dbg.assign adjacent to its store rather than the</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// old dbg.assgn. That would result in interleaved dbg.assigns rather than</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// what we get now:</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">//    split store !1</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">//    split store !2</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">//    dbg.assign !1</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">//    dbg.assign !2</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// This (current behaviour) results results in debug assignments being</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// noted as slightly offset (in code) from the store. In practice this</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// should have little effect on the debugging experience due to the fact</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// that all the split stores should get the same line number.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    NewAssign-&gt;moveBefore(DbgAssign);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    NewAssign-&gt;setDebugLoc(DbgAssign-&gt;getDebugLoc());</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Created new assign intrinsic: &quot;</span> &lt;&lt; *NewAssign</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/// A custom IRBuilder inserter which prefixes all names, but only in</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">/// Assert builds.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span><span class="keyword">class </span>IRBuilderPrefixedInserter final : <span class="keyword">public</span> <a class="code" href="classllvm_1_1IRBuilderDefaultInserter.html">IRBuilderDefaultInserter</a> {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  std::string <a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="classllvm_1_1Twine.html">Twine</a> getNameWithPrefix(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Name)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>.isTriviallyEmpty() ? <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> : <a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a> + <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordtype">void</span> SetNamePrefix(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) { <a class="code" href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a> = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.str(); }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">void</span> InsertHelper(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Name, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> InsertPt)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classllvm_1_1IRBuilderDefaultInserter.html#a274cf38ada86762393bc3c51212899f7">IRBuilderDefaultInserter::InsertHelper</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, getNameWithPrefix(Name), <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                           InsertPt);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;};</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/// Provide a type for IRBuilder that drops names in release builds.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span><span class="keyword">using</span> IRBuilderTy = <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;ConstantFolder, IRBuilderPrefixedInserter&gt;</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/// A used slice of an alloca.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">/// This structure represents a slice of an alloca used by some instruction. It</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">/// stores both the begin and end offsets of this use, a pointer to the use</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">/// itself, and a flag indicating whether we can classify the use as splittable</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/// or not when forming partitions of the alloca.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span><span class="keyword">class </span>Slice {<span class="comment"></span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">  /// The beginning offset of the range.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BeginOffset = 0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">  /// The ending offset, not included in the range.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOffset = 0;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">  /// Storage for both the use of this slice and whether it can be</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">  /// split.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1PointerIntPair.html">PointerIntPair&lt;Use *, 1, bool&gt;</a> UseAndIsSplittable;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  Slice() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  Slice(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BeginOffset, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOffset, <a class="code" href="classllvm_1_1Use.html">Use</a> *U, <span class="keywordtype">bool</span> IsSplittable)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      : BeginOffset(BeginOffset), EndOffset(EndOffset),</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        UseAndIsSplittable(U, IsSplittable) {}</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> beginOffset()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> BeginOffset; }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> endOffset()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> EndOffset; }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordtype">bool</span> isSplittable()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> UseAndIsSplittable.<a class="code" href="classllvm_1_1PointerIntPair.html#a5f4f059462994b43b97b1213651fa969">getInt</a>(); }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">void</span> makeUnsplittable() { UseAndIsSplittable.<a class="code" href="classllvm_1_1PointerIntPair.html#a60c0e4f0ed13c971edabd76dceada467">setInt</a>(<span class="keyword">false</span>); }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="classllvm_1_1Use.html">Use</a> *getUse()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> UseAndIsSplittable.<a class="code" href="classllvm_1_1PointerIntPair.html#ac8b55437ca130fe0c826e94e669e5d99">getPointer</a>(); }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">bool</span> isDead()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> getUse() == <span class="keyword">nullptr</span>; }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordtype">void</span> kill() { UseAndIsSplittable.<a class="code" href="classllvm_1_1PointerIntPair.html#a0ebf24939b41850c8fe52ac40926a121">setPointer</a>(<span class="keyword">nullptr</span>); }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">  /// Support for ordering ranges.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  /// This provides an ordering over ranges such that start offsets are</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">  /// always increasing, and within equal start offsets, the end offsets are</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">  /// decreasing. Thus the spanning range comes first in a cluster with the</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">  /// same start position.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">operator&lt;</a>(<span class="keyword">const</span> Slice &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> (beginOffset() &lt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.beginOffset())</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (beginOffset() &gt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.beginOffset())</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (isSplittable() != <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.isSplittable())</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">return</span> !isSplittable();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (endOffset() &gt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.endOffset())</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  /// Support comparison with a single offset to allow binary searches.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span>  <span class="keyword">friend</span> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a> <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">operator&lt;</a>(<span class="keyword">const</span> Slice &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                              <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> RHSOffset) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.beginOffset() &lt; RHSOffset;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keyword">friend</span> <a class="code" href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a> <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">operator&lt;</a>(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> LHSOffset,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                              <span class="keyword">const</span> Slice &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> LHSOffset &lt; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.beginOffset();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a4d812a2dd18aa186c164447e20e348e7">operator==</a>(<span class="keyword">const</span> Slice &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> isSplittable() == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.isSplittable() &amp;&amp;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;           beginOffset() == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.beginOffset() &amp;&amp; endOffset() == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.endOffset();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm.html#a2f883c895f4d244f4ed56ed8a8c160c1">operator!=</a>(<span class="keyword">const</span> Slice &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code" href="namespacellvm.html#a4d812a2dd18aa186c164447e20e348e7">operator==</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>); }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;};</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">/// Representation of the alloca slices.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">/// This class represents the slices of an alloca which are formed by its</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/// various uses. If a pointer escapes, we can&#39;t fully build a representation</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">/// for the slices used and we reflect that in this structure. The uses are</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">/// stored, sorted by increasing beginning offset and with unsplittable slices</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">/// starting at a particular offset before splittable slices.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html">  396</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html">llvm::sroa::AllocaSlices</a> {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  /// Construct the slices of a particular alloca.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aca741215da3a820dcdc44b32e6e4948b">AllocaSlices</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">  /// Test whether a pointer to the allocation escapes our analysis.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">  /// If this is true, the slices are never fully built and should be</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">  /// ignored.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a10e9dec07ae53048ce77f3675169d5d8">  405</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a10e9dec07ae53048ce77f3675169d5d8">isEscaped</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> PointerEscapingInstr; }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">  /// Support for iterating over the slices.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">  /// @{</span></div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">  409</a></span>&#160;<span class="comment"></span>  <span class="keyword">using</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">iterator</a> = <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Slice&gt;::iterator</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#ad26cc05ceedd31cc6f6b9cf6abe6bc5a">  410</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classllvm_1_1iterator__range.html">range</a> = <a class="code" href="classllvm_1_1iterator__range.html">iterator_range&lt;iterator&gt;</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#aa8d55f500ee8cec1418f4d0016f634f0">  412</a></span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">iterator</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aa8d55f500ee8cec1418f4d0016f634f0">begin</a>() { <span class="keywordflow">return</span> Slices.begin(); }</div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">  413</a></span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">iterator</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">end</a>() { <span class="keywordflow">return</span> Slices.end(); }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">  415</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">const_iterator</a> = <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;Slice&gt;::const_iterator</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a4c1f6b116987333efc2da273fc580d13">  416</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classllvm_1_1iterator__range.html">const_range</a> = <a class="code" href="classllvm_1_1iterator__range.html">iterator_range&lt;const_iterator&gt;</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a9c2de75a45a93abd6afdd41564fba726">  418</a></span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">const_iterator</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a9c2de75a45a93abd6afdd41564fba726">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Slices.begin(); }</div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#aff4542b6bd9f5e44d7a52837f612852e">  419</a></span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">const_iterator</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aff4542b6bd9f5e44d7a52837f612852e">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Slices.end(); }<span class="comment"></span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  /// @}</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">  /// Erase a range of slices.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#ab3e8e781978559bd92b9dce6c03c598b">  423</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ab3e8e781978559bd92b9dce6c03c598b">erase</a>(<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">iterator</a> Start, <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">iterator</a> Stop) { Slices.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a563ffc2ff61c499b3be2e00100cb72fa">erase</a>(Start, Stop); }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">  /// Insert new slices for this alloca.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">  /// This moves the slices into the alloca&#39;s slices collection, and re-sorts</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">  /// everything so that the usual ordering properties of the alloca&#39;s slices</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">  /// hold.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#ad9fd340fc6b63cbabc1f9d96f5494bcc">  430</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ad9fd340fc6b63cbabc1f9d96f5494bcc">insert</a>(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Slice&gt;</a> NewSlices) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">int</span> OldSize = Slices.size();</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    Slices.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(NewSlices.<a class="code" href="classllvm_1_1ArrayRef.html#aab36927882fbfdcbb860d87fd9c30da8">begin</a>(), NewSlices.<a class="code" href="classllvm_1_1ArrayRef.html#a7ca5197533a9c1fb8a2bd30587fcec6b">end</a>());</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keyword">auto</span> SliceI = Slices.begin() + OldSize;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(SliceI, Slices.end());</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    std::inplace_merge(Slices.begin(), SliceI, Slices.end());</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// Forward declare the iterator and range accessor for walking the</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">// partitions.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keyword">class </span>partition_iterator;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="classllvm_1_1iterator__range.html">iterator_range&lt;partition_iterator&gt;</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ab0fa7fd7c0ff766d70d16fcd6cf8d44b">partitions</a>();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">  /// Access the dead users for this alloca.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a7f31092eeb9f5a6166542a6b9b5665d8">  444</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Instruction *&gt;</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a7f31092eeb9f5a6166542a6b9b5665d8">getDeadUsers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> DeadUsers; }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">  /// Access Uses that should be dropped if the alloca is promotable.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a29857cfc1d48f6de8eed646ab1fa87f4">  447</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Use *&gt;</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a29857cfc1d48f6de8eed646ab1fa87f4">getDeadUsesIfPromotable</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">return</span> DeadUseIfPromotable;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">  /// Access the dead operands referring to this alloca.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">  /// These are operands which have cannot actually be used to refer to the</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">  /// alloca as they are outside its range and the user doesn&#39;t correct for</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">  /// that. These mostly consist of PHI node inputs and the like which we just</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  /// need to replace with undef.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#a98973e137d3459280cfe4aa8f4710bd1">  457</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Use *&gt;</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a98973e137d3459280cfe4aa8f4710bd1">getDeadOperands</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> DeadOperands; }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aea43ee5732092522ecfa6bdf2e26088e">print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">const_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Indent = <span class="stringliteral">&quot;  &quot;</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a17fe7e337dc0346719e8978b0a5a400b">printSlice</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">const_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Indent = <span class="stringliteral">&quot;  &quot;</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a97e10a8004f59e6e48be3c56d014c91e">printUse</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">const_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Indent = <span class="stringliteral">&quot;  &quot;</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aea43ee5732092522ecfa6bdf2e26088e">print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a75653059e41c0e3fc2fbb692595333b9">dump</a>(<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">const_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a75653059e41c0e3fc2fbb692595333b9">dump</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DerivedT, <span class="keyword">typename</span> RetT = <span class="keywordtype">void</span>&gt; <span class="keyword">class </span>BuilderBase;</div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSlices.html#aee3b9c3a8070e4c1a419d1aaa396c4a4">  472</a></span>&#160;  <span class="keyword">class </span>SliceBuilder;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classAllocaSlices_1_1SliceBuilder.html">AllocaSlices::SliceBuilder</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">  /// Handle to alloca instruction to simplify method interfaces.</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">  /// The instruction responsible for this alloca not having a known set</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">  /// of slices.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">  /// When an instruction (potentially) escapes the pointer to the alloca, we</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">  /// store a pointer to that here and abort trying to form slices of the</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">  /// alloca. This will be null if the alloca slices are analyzed successfully.</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PointerEscapingInstr;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">  /// The slices of the alloca.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">  /// We store a vector of the slices formed by uses of the alloca here. This</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">  /// vector is sorted by increasing begin offset, and then the unsplittable</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">  /// slices before the splittable ones. See the Slice inner class for more</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">  /// details.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Slice, 8&gt;</a> Slices;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">  /// Instructions which will become dead if we rewrite the alloca.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">  /// Note that these are not separated by slice. This is because we expect an</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">  /// alloca to be completely rewritten or not rewritten at all. If rewritten,</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">  /// all these instructions can simply be removed and replaced with poison as</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">  /// they come from outside of the allocated space.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> DeadUsers;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">  /// Uses which will become dead if can promote the alloca.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Use *, 8&gt;</a> DeadUseIfPromotable;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">  /// Operands which will become dead if we rewrite the alloca.</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">  /// These are operands that in their particular use can be replaced with</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">  /// poison when we rewrite the alloca. These show up in out-of-bounds inputs</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">  /// to PHI nodes and the like. They aren&#39;t entirely dead (there might be</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">  /// a GEP back into the bounds using it elsewhere) and nor is the PHI, but we</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  /// want to swap this particular input for poison to simplify the use lists of</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">  /// the alloca.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Use *, 8&gt;</a> DeadOperands;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;};</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/// A partition of the slices.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">/// An ephemeral representation for a range of slices which can be viewed as</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">/// a partition of the alloca. This range represents a span of the alloca&#39;s</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">/// memory which cannot be split, and provides access to all of the slices</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">/// overlapping some part of the partition.</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">/// Objects of this type are produced by traversing the alloca&#39;s slices, but</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">/// are only ephemeral and not persistent.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html">  528</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classllvm_1_1sroa_1_1Partition.html">llvm::sroa::Partition</a> {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a499150c6fcbe74f910eb3533901d9083">  530</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a7b62c5f050b3232eda724b7b08bb5147">  531</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classAllocaSlices_1_1partition__iterator.html">AllocaSlices::partition_iterator</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keyword">using</span> iterator = <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">AllocaSlices::iterator</a>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">  /// The beginning and ending offsets of the alloca for this</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">  /// partition.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BeginOffset = 0, EndOffset = 0;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  /// The start and end iterators of this partition.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span>  iterator <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, SJ;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">  /// A collection of split slice tails overlapping the partition.</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Slice *, 4&gt;</a> SplitTails;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  /// Raw constructor builds an empty partition starting and ending at</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">  /// the given iterator.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a>(iterator <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) : <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>), SJ(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {}</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">  /// The start offset of this partition.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /// All of the contained slices start at or after this offset.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a00b5d4eccf935529c4ce385032f8a589">  553</a></span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="classllvm_1_1sroa_1_1Partition.html#a00b5d4eccf935529c4ce385032f8a589">beginOffset</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> BeginOffset; }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">  /// The end offset of this partition.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">  /// All of the contained slices end at or before this offset.</span></div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#ac370b0d5601915c0dc762c53b1eb4d89">  558</a></span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="classllvm_1_1sroa_1_1Partition.html#ac370b0d5601915c0dc762c53b1eb4d89">endOffset</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> EndOffset; }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">  /// The size of the partition.</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">  /// Note that this can never be zero.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a2825709e5cf818f9121bfa60f23de7d1">  563</a></span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="classllvm_1_1sroa_1_1Partition.html#a2825709e5cf818f9121bfa60f23de7d1">size</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BeginOffset &lt; EndOffset &amp;&amp; <span class="stringliteral">&quot;Partitions must span some bytes!&quot;</span>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">return</span> EndOffset - BeginOffset;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">  /// Test whether this partition contains no slices, and merely spans</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  /// a region occupied by split slices.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a4db8b577719aea6a098c9329061f2ac0">  570</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1sroa_1_1Partition.html#a4db8b577719aea6a098c9329061f2ac0">empty</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> == SJ; }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">  /// \name Iterate slices that start within the partition.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">  /// These may be splittable or unsplittable. They have a begin offset &gt;= the</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">  /// partition begin offset.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">  /// @{</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span>  <span class="comment">// FIXME: We should probably define a &quot;concat_iterator&quot; helper and use that</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// to stitch together pointee_iterators over the split tails and the</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// contiguous iterators of the partition. That would give a much nicer</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// interface here. We could then additionally expose filtered iterators for</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// split, unsplit, and unsplittable splices based on the usage patterns.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a558e0dfb6385d4ae5572969bcd327869">  581</a></span>&#160;  iterator <a class="code" href="classllvm_1_1sroa_1_1Partition.html#a558e0dfb6385d4ae5572969bcd327869">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>; }</div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a31704d463f766d210085cdc180a0a06f">  582</a></span>&#160;  iterator <a class="code" href="classllvm_1_1sroa_1_1Partition.html#a31704d463f766d210085cdc180a0a06f">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> SJ; }<span class="comment"></span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">  /// @}</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">  /// Get the sequence of split slice tails.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">  /// These tails are of slices which start before this partition but are</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">  /// split and overlap into the partition. We accumulate these while forming</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">  /// partitions.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1Partition.html#a0b447f960e9d79bfca42b03938b86955">  590</a></span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Slice *&gt;</a> <a class="code" href="classllvm_1_1sroa_1_1Partition.html#a0b447f960e9d79bfca42b03938b86955">splitSliceTails</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> SplitTails; }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;};</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">/// An iterator over partitions of the alloca&#39;s slices.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">/// This iterator implements the core algorithm for partitioning the alloca&#39;s</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">/// slices. It is a forward iterator as we don&#39;t support backtracking for</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">/// efficiency reasons, and re-use a single storage area to maintain the</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">/// current set of split slices.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">/// It is templated on the slice iterator type to use so that it can operate</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">/// with either const or non-const slice iterators.</span></div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1partition__iterator.html">  602</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classAllocaSlices_1_1partition__iterator.html">AllocaSlices::partition_iterator</a></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    : <span class="keyword">public</span> <a class="code" href="classllvm_1_1iterator__facade__base.html">iterator_facade_base</a>&lt;partition_iterator, std::forward_iterator_tag,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                  Partition&gt; {</div>
<div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1partition__iterator.html#a499150c6fcbe74f910eb3533901d9083">  605</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">  /// Most of the state for walking the partitions is held in a class</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">  /// with a nice interface for examining them.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">  /// We need to keep the end of the slices to know when to stop.</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">AllocaSlices::iterator</a> SE;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">  /// We also need to keep track of the maximum split end offset seen.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">  /// FIXME: Do we really?</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment"></span>  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MaxSplitSliceEndOffset = 0;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">  /// Sets the partition to be empty at given iterator, and sets the</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">  /// end iterator.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment"></span>  <a class="code" href="classAllocaSlices_1_1partition__iterator.html">partition_iterator</a>(<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">AllocaSlices::iterator</a> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">AllocaSlices::iterator</a> SE)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>), SE(SE) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// If not already at the end, advance our state to form the initial</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// partition.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> != SE)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      advance();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">  /// Advance the iterator to the next partition.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">  /// Requires that the iterator not be at the end of the slices.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> advance() {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI != SE || !<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.empty()) &amp;&amp;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;           <span class="stringliteral">&quot;Cannot advance past the end of the slices!&quot;</span>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">// Clear out any split uses which have ended.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.empty()) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset &gt;= MaxSplitSliceEndOffset) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">// If we&#39;ve finished all splits, this is easy.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.clear();</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        MaxSplitSliceEndOffset = 0;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="comment">// Remove the uses which have ended in the prior partition. This</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="comment">// cannot change the max split slice end because we just checked that</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="comment">// the prior partition ended prior to that max.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails,</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                       [&amp;](Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) { return S-&gt;endOffset() &lt;= P.EndOffset; });</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                            [&amp;](Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                              return S-&gt;endOffset() == MaxSplitSliceEndOffset;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                            }) &amp;&amp;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;               <span class="stringliteral">&quot;Could not find the current max split slice offset!&quot;</span>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                            [&amp;](Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                              return S-&gt;endOffset() &lt;= MaxSplitSliceEndOffset;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                            }) &amp;&amp;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;               <span class="stringliteral">&quot;Max split slice end offset is not actually the max!&quot;</span>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">// If P.SI is already at the end, then we&#39;ve cleared the split tail and</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">// now have an end iterator.</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI == SE) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.empty() &amp;&amp; <span class="stringliteral">&quot;Failed to clear the split slices!&quot;</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// If we had a non-empty partition previously, set up the state for</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// subsequent partitions.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI != <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="comment">// Accumulate all the splittable slices which started in the old</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="comment">// partition into the split list.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">for</span> (Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isSplittable() &amp;&amp; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset() &gt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.push_back(&amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          MaxSplitSliceEndOffset =</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;              <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset(), MaxSplitSliceEndOffset);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="comment">// Start from the end of the previous partition.</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="comment">// If P.SI is now at the end, we at most have a tail of split slices.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI == SE) {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.BeginOffset = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset = MaxSplitSliceEndOffset;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">// If the we have split slices and the next slice is after a gap and is</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="comment">// not splittable immediately form an empty partition for the split</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="comment">// slices up until the next slice begins.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.empty() &amp;&amp; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;beginOffset() != <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset &amp;&amp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          !<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;isSplittable()) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.BeginOffset = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;beginOffset();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// OK, we need to consume new slices. Set the end offset based on the</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// current slice, and step SJ past it. The beginning offset of the</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// partition is the beginning offset of the next slice unless we have</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// pre-existing split slices that are continuing, in which case we begin</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// at the prior end offset.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.BeginOffset = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.empty() ? <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;beginOffset() : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;endOffset();</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    ++<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// There are two strategies to form a partition based on whether the</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// partition starts with an unsplittable slice or a splittable slice.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;isSplittable()) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// When we&#39;re forming an unsplittable region, it must always start at</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="comment">// the first slice and will extend through its end.</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.BeginOffset == <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;beginOffset());</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="comment">// Form a partition including all of the overlapping slices with this</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="comment">// unsplittable slice.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ != SE &amp;&amp; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;beginOffset() &lt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;isSplittable())</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;          <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;endOffset());</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        ++<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="comment">// We have a partition across a set of overlapping unsplittable</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="comment">// partitions.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">// If we&#39;re starting with a splittable slice, then we need to form</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// a synthetic partition spanning it and any other overlapping splittable</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// splices.</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI-&gt;isSplittable() &amp;&amp; <span class="stringliteral">&quot;Forming a splittable partition!&quot;</span>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// Collect all of the overlapping splittable slices.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ != SE &amp;&amp; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;beginOffset() &lt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset &amp;&amp;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;           <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;isSplittable()) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;endOffset());</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      ++<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">// Back upiP.EndOffset if we ended the span early when encountering an</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">// unsplittable slice. This synthesizes the early end offset of</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">// a partition spanning only splittable slices.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ != SE &amp;&amp; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;beginOffset() &lt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;isSplittable());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.EndOffset = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ-&gt;beginOffset();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00751"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1partition__iterator.html#a09094d8b7d9ec638b7c1dab3c9a2060d">  751</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classAllocaSlices_1_1partition__iterator.html#a09094d8b7d9ec638b7c1dab3c9a2060d">operator==</a>(<span class="keyword">const</span> <a class="code" href="classAllocaSlices_1_1partition__iterator.html">partition_iterator</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SE == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.SE &amp;&amp;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;           <span class="stringliteral">&quot;End iterators don&#39;t match between compared partition iterators!&quot;</span>);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// The observed positions of partitions is marked by the P.SI iterator and</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// the emptiness of the split slices. The latter is only relevant when</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// P.SI == SE, as the end iterator will additionally have an empty split</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// slices list, but the prior may have the same P.SI and a tail of split</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">// slices.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SI == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.P.SI &amp;&amp; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.empty() == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.P.SplitTails.empty()) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SJ == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.P.SJ &amp;&amp;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;             <span class="stringliteral">&quot;Same set of slices formed two different sized partitions!&quot;</span>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.SplitTails.size() == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.P.SplitTails.size() &amp;&amp;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;             <span class="stringliteral">&quot;Same slice position with differently sized non-empty split &quot;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;             <span class="stringliteral">&quot;slice tails!&quot;</span>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1partition__iterator.html#a3cedc8d20ff71d84a0a9400a25c1d3a2">  771</a></span>&#160;  <a class="code" href="classAllocaSlices_1_1partition__iterator.html">partition_iterator</a> &amp;<a class="code" href="classAllocaSlices_1_1partition__iterator.html#a3cedc8d20ff71d84a0a9400a25c1d3a2">operator++</a>() {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    advance();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1partition__iterator.html#a64182764501ef8a15b182a843c5bc545">  776</a></span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a> &amp;<a class="code" href="classAllocaSlices_1_1partition__iterator.html#a64182764501ef8a15b182a843c5bc545">operator*</a>() { <span class="keywordflow">return</span> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>; }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;};</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">/// A forward range over the partitions of the alloca&#39;s slices.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">/// This accesses an iterator range over the partitions of the alloca&#39;s</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">/// slices. It computes these partitions on the fly based on the overlapping</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">/// offsets of the slices and the ability to split them. It will visit &quot;empty&quot;</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">/// partitions to cover regions of the alloca only accessed via split</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">/// slices.</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1iterator__range.html">iterator_range&lt;AllocaSlices::partition_iterator&gt;</a> <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ab0fa7fd7c0ff766d70d16fcd6cf8d44b">AllocaSlices::partitions</a>() {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(partition_iterator(<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aa8d55f500ee8cec1418f4d0016f634f0">begin</a>(), <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">end</a>()),</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    partition_iterator(<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">end</a>(), <a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">end</a>()));</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;}</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a849bc9de354f140d265e3ff56999ce19">  791</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#a849bc9de354f140d265e3ff56999ce19">foldSelectInst</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// If the condition being selected on is a constant or the same value is</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="comment">// being selected between, fold the select. Yes this does (rarely) happen</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">// early on.</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *CI = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getCondition()))</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(1 + CI-&gt;isZero());</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(1) == <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(2))</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(1);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;}</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">/// A helper that folds a PHI node or a select.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a23d87925bf94456691d6030c7d6070c4">  804</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#a23d87925bf94456691d6030c7d6070c4">foldPHINodeOrSelectInst</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN = dyn_cast&lt;PHINode&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">// If PN merges together the same value, return that value.</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">return</span> PN-&gt;hasConstantValue();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#a849bc9de354f140d265e3ff56999ce19">foldSelectInst</a>(cast&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">/// Builder for the alloca slices.</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">/// This class builds a set of alloca slices by recursively visiting the uses</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">/// of an alloca and making a slice for each load and store at each offset.</span></div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1SliceBuilder.html">  816</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classAllocaSlices_1_1SliceBuilder.html">AllocaSlices::SliceBuilder</a> : <span class="keyword">public</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html">PtrUseVisitor</a>&lt;SliceBuilder&gt; {</div>
<div class="line"><a name="l00817"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1SliceBuilder.html#ab35732d98347554d3d2ed0460bc1ab26">  817</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classllvm_1_1PtrUseVisitor.html">PtrUseVisitor</a>&lt;<a class="code" href="classAllocaSlices_1_1SliceBuilder.html">SliceBuilder</a>&gt;;</div>
<div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1SliceBuilder.html#abb0399d372fbb120a3e1e0672af49785">  818</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor</a>&lt;<a class="code" href="classAllocaSlices_1_1SliceBuilder.html">SliceBuilder</a>&gt;;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keyword">using</span> <a class="code" href="classllvm_1_1PtrUseVisitor.html">Base</a> = <a class="code" href="classllvm_1_1PtrUseVisitor.html">PtrUseVisitor&lt;SliceBuilder&gt;</a>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keyword">const</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AllocSize;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> &amp;AS;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Instruction *, unsigned&gt;</a> MemTransferSliceMap;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Instruction *, uint64_t&gt;</a> PHIOrSelectSizes;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">  /// Set to de-duplicate dead instructions found in the use walk.</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> VisitedDeadInsts;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="classAllocaSlices_1_1SliceBuilder.html#a8a54eb11a6edc3c5411cbedcf76b2002">  832</a></span>&#160;  <a class="code" href="classAllocaSlices_1_1SliceBuilder.html#a8a54eb11a6edc3c5411cbedcf76b2002">SliceBuilder</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI, <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> &amp;AS)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      : <a class="code" href="classllvm_1_1PtrUseVisitor.html">PtrUseVisitor</a>&lt;<a class="code" href="classAllocaSlices_1_1SliceBuilder.html">SliceBuilder</a>&gt;(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>),</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        AllocSize(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(AI.getAllocatedType()).getFixedValue()),</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        AS(AS) {}</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">void</span> markAsDead(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">if</span> (VisitedDeadInsts.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).second)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      AS.DeadUsers.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordtype">void</span> insertUse(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>,</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                 <span class="keywordtype">bool</span> IsSplittable = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// Completely skip uses which have a zero size or start either before or</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">// past the end of the allocation.</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> == 0 || <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.uge(AllocSize)) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING: Ignoring &quot;</span> &lt;&lt; <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &lt;&lt; <span class="stringliteral">&quot; byte use @&quot;</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        &lt;&lt; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; which has zero size or starts outside of the &quot;</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                        &lt;&lt; AllocSize &lt;&lt; <span class="stringliteral">&quot; byte alloca:\n&quot;</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;    alloca: &quot;</span> &lt;&lt; AS.AI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;       use: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">return</span> markAsDead(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BeginOffset = <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getZExtValue();</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOffset = BeginOffset + <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// Clamp the end offset to the end of the allocation. Note that this is</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// formulated to handle even the case where &quot;BeginOffset + Size&quot; overflows.</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// This may appear superficially to be something we could ignore entirely,</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// but that is not so! There may be widened loads or PHI-node uses where</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// some instructions are dead but not others. We can&#39;t completely ignore</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// them, and so have to record at least the information here.</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AllocSize &gt;= BeginOffset); <span class="comment">// Established above.</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &gt; AllocSize - BeginOffset) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING: Clamping a &quot;</span> &lt;&lt; <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &lt;&lt; <span class="stringliteral">&quot; byte use @&quot;</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        &lt;&lt; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> &lt;&lt; <span class="stringliteral">&quot; to remain within the &quot;</span> &lt;&lt; AllocSize</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; byte alloca:\n&quot;</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;    alloca: &quot;</span> &lt;&lt; AS.AI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;       use: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      EndOffset = AllocSize;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    AS.Slices.push_back(Slice(BeginOffset, EndOffset, U, IsSplittable));</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordtype">void</span> visitBitCastInst(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;BC) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">if</span> (BC.<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">return</span> markAsDead(BC);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">return</span> Base::visitBitCastInst(BC);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordtype">void</span> visitAddrSpaceCastInst(<a class="code" href="classllvm_1_1AddrSpaceCastInst.html">AddrSpaceCastInst</a> &amp;ASC) {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span> (ASC.<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">return</span> markAsDead(ASC);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">return</span> Base::visitAddrSpaceCastInst(ASC);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordtype">void</span> visitGetElementPtrInst(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;GEPI) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">if</span> (GEPI.<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>())</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">return</span> markAsDead(GEPI);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SROA_8cpp.html#ac6da6bff872f9db9f549ab7dd6086a61">SROAStrictInbounds</a> &amp;&amp; GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a01f11934ce1bac24a7c9190d14686844">isInBounds</a>()) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="comment">// FIXME: This is a manually un-factored variant of the basic code inside</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="comment">// of GEPs with checking of the inbounds invariant specified in the</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="comment">// langref in a very strict sense. If we ever want to enable</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="comment">// SROAStrictInbounds, this code should be factored cleanly into</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="comment">// PtrUseVisitor, but it is easier to experiment with SROAStrictInbounds</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="comment">// by writing out the code here where we have the underlying allocation</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="comment">// size readily available.</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> GEPOffset = <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = GEPI.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1generic__gep__type__iterator.html">gep_type_iterator</a> GTI = <a class="code" href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">gep_type_begin</a>(GEPI),</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                             GTE = <a class="code" href="namespacellvm.html#a43c6ebb4fd35ebd815d66a2df4eed0b9">gep_type_end</a>(GEPI);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;           GTI != GTE; ++GTI) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *OpC = dyn_cast&lt;ConstantInt&gt;(GTI.getOperand());</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">if</span> (!OpC)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="comment">// Handle a struct index, which adds its field offset to the pointer.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StructType.html">StructType</a> *STy = GTI.getStructTypeOrNull()) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          <span class="keywordtype">unsigned</span> ElementIdx = OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;          <span class="keyword">const</span> <a class="code" href="classllvm_1_1StructLayout.html">StructLayout</a> *SL = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getStructLayout(STy);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          GEPOffset +=</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;              <a class="code" href="classllvm_1_1APInt.html">APInt</a>(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getBitWidth(), SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a9b53bc4ade993c638837c1344465c1f8">getElementOffset</a>(ElementIdx));</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          <span class="comment">// For array or vector indices, scale the index by the size of the</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          <span class="comment">// type.</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = OpC-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">getValue</a>().<a class="code" href="classllvm_1_1APInt.html#a9b5fc98b47d44d1150d3610bdfab1430">sextOrTrunc</a>(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getBitWidth());</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          GEPOffset +=</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;              <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> *</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;              <a class="code" href="classllvm_1_1APInt.html">APInt</a>(<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getBitWidth(),</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(GTI.getIndexedType()).getFixedValue());</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">// If this index has computed an intermediate pointer which is not</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="comment">// inbounds, then the result of the GEP is a poison value and we can</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="comment">// delete it and all uses.</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">if</span> (GEPOffset.<a class="code" href="classllvm_1_1APInt.html#a46a7cbf3724080a5f4f4c7e7a4551e26">ugt</a>(AllocSize))</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          <span class="keywordflow">return</span> markAsDead(GEPI);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">return</span> Base::visitGetElementPtrInst(GEPI);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordtype">void</span> handleLoadOrStore(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1APInt.html">APInt</a> &amp;<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>,</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                         <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a>) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// We allow splitting of non-volatile loads and stores where the type is an</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">// integer type. These may be used to implement &#39;memcpy&#39; or other &quot;transfer</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// of bits&quot; patterns.</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordtype">bool</span> IsSplittable =</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        Ty-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp; !<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a> &amp;&amp; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.typeSizeEqualsStoreSize(Ty);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    insertUse(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, IsSplittable);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordtype">void</span> visitLoadInst(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;LI) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!LI.<a class="code" href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">isSimple</a>() || LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>()) &amp;&amp;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;           <span class="stringliteral">&quot;All simple FCA loads should have been pre-split&quot;</span>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> (!IsOffsetKnown)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;LI);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>.isScalable())</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;LI);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">return</span> handleLoadOrStore(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), LI, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>.getFixedValue(),</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                             LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>());</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordtype">void</span> visitStoreInst(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *ValOp = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getValueOperand();</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">if</span> (ValOp == *U)</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="keywordflow">return</span> PI.setEscapedAndAborted(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">if</span> (!IsOffsetKnown)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> StoreSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(ValOp-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (StoreSize.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a9188f84e1dd67530330dcab9cae787d7">isScalable</a>())</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = StoreSize.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">getFixedValue</a>();</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">// If this memory access can be shown to *statically* extend outside the</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// bounds of the allocation, it&#39;s behavior is undefined, so simply</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">// ignore it. Note that this is more strict than the generic clamping</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">// behavior of insertUse. We also try to handle cases which might run the</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="comment">// risk of overflow.</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// FIXME: We should instead consider the pointer to have escaped if this</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// function is being instrumented for addressing bugs or race conditions.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &gt; AllocSize || <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.ugt(AllocSize - <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>)) {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING: Ignoring &quot;</span> &lt;&lt; <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &lt;&lt; <span class="stringliteral">&quot; byte store @&quot;</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                        &lt;&lt; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> &lt;&lt; <span class="stringliteral">&quot; which extends past the end of the &quot;</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                        &lt;&lt; AllocSize &lt;&lt; <span class="stringliteral">&quot; byte alloca:\n&quot;</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;    alloca: &quot;</span> &lt;&lt; AS.AI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;       use: &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordflow">return</span> markAsDead(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isSimple() || ValOp-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>()) &amp;&amp;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;           <span class="stringliteral">&quot;All simple FCA stores should have been pre-split&quot;</span>);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    handleLoadOrStore(ValOp-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile());</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordtype">void</span> visitMemSetInst(<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> &amp;II) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>() == *U &amp;&amp; <span class="stringliteral">&quot;Pointer use is not the destination?&quot;</span>);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>());</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> &amp;&amp; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>-&gt;getValue() == 0) ||</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        (IsOffsetKnown &amp;&amp; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.uge(AllocSize)))</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="comment">// Zero-length mem transfer intrinsics can be ignored entirely.</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordflow">return</span> markAsDead(II);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">if</span> (!IsOffsetKnown)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;II);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    insertUse(II, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> ? <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>-&gt;getLimitedValue()</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                 : AllocSize - <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getLimitedValue(),</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;              (<span class="keywordtype">bool</span>)<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordtype">void</span> visitMemTransferInst(<a class="code" href="classllvm_1_1MemTransferInst.html">MemTransferInst</a> &amp;II) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = dyn_cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>());</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> &amp;&amp; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>-&gt;getValue() == 0)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="comment">// Zero-length mem transfer intrinsics can be ignored entirely.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">return</span> markAsDead(II);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// Because we can visit these intrinsics twice, also check to see if the</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// first time marked this instruction as dead. If so, skip it.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">if</span> (VisitedDeadInsts.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(&amp;II))</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span> (!IsOffsetKnown)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;II);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">// This side of the transfer is completely out-of-bounds, and so we can</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">// nuke the entire transfer. However, we also need to nuke the other side</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">// if already added to our partitions.</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">// FIXME: Yet another place we really should bypass this when</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">// instrumenting for ASan.</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.uge(AllocSize)) {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Instruction *, unsigned&gt;::iterator</a> MTPI =</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;          MemTransferSliceMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(&amp;II);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordflow">if</span> (MTPI != MemTransferSliceMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        AS.Slices[MTPI-&gt;second].kill();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">return</span> markAsDead(II);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> RawOffset = <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getLimitedValue();</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> ? <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>-&gt;getLimitedValue() : AllocSize - RawOffset;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// Check for the special case where the same exact value is used for both</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">// source and dest.</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">if</span> (*U == II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>() &amp;&amp; *U == II.<a class="code" href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">getRawSource</a>()) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="comment">// For non-volatile transfers this is a no-op.</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordflow">if</span> (!II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>())</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordflow">return</span> markAsDead(II);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">return</span> insertUse(II, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <span class="comment">/*IsSplittable=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="comment">// If we have seen both source and destination for a mem transfer, then</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="comment">// they both point to the same alloca.</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Instruction *, unsigned&gt;::iterator</a> MTPI;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    std::tie(MTPI, Inserted) =</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        MemTransferSliceMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(std::make_pair(&amp;II, AS.Slices.size()));</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordtype">unsigned</span> PrevIdx = MTPI-&gt;second;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span> (!Inserted) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      Slice &amp;PrevP = AS.Slices[PrevIdx];</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="comment">// Check if the begin offsets match and this is a non-volatile transfer.</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="comment">// In that case, we can completely elide the transfer.</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">if</span> (!II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>() &amp;&amp; PrevP.beginOffset() == RawOffset) {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        PrevP.kill();</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">return</span> markAsDead(II);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="comment">// Otherwise we have an offset transfer within the same alloca. We can&#39;t</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="comment">// split those.</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      PrevP.makeUnsplittable();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="comment">// Insert the use now that we&#39;ve fixed up the splittable nature.</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    insertUse(II, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <span class="comment">/*IsSplittable=*/</span>Inserted &amp;&amp; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// Check that we ended up with a valid index in the map.</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AS.Slices[PrevIdx].getUse()-&gt;getUser() == &amp;II &amp;&amp;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;           <span class="stringliteral">&quot;Map index doesn&#39;t point back to a slice with this user.&quot;</span>);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">// Disable SRoA for any intrinsics except for lifetime invariants and</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">// invariant group.</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// FIXME: What about debug intrinsics? This matches old behavior, but</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="comment">// doesn&#39;t make sense.</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordtype">void</span> visitIntrinsicInst(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1User.html#af6a49991304b167c94f4a9756d3fd48f">isDroppable</a>()) {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      AS.DeadUseIfPromotable.push_back(U);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">if</span> (!IsOffsetKnown)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;II);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1Instruction.html#a185bafe1e8f07def76a3bac154a23e7a">isLifetimeStartOrEnd</a>()) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a> = cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0));</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(AllocSize - <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getLimitedValue(),</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                               <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">Length</a>-&gt;getLimitedValue());</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      insertUse(II, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1Instruction.html#adda9304aaf3716109938d9479b2d2dbc">isLaunderOrStripInvariantGroup</a>()) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      enqueueUsers(II);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    Base::visitIntrinsicInst(II);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *hasUnsafePHIOrSelectUse(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Root, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> &amp;<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>) {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="comment">// We consider any PHI or select that results in a direct load or store of</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">// the same offset to be a viable use for slicing purposes. These uses</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">// are considered unsplittable and the size is the maximum loaded or stored</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">// size.</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> Visited;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;Instruction *, Instruction *&gt;</a>, 4&gt; <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(Root);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.push_back(std::make_pair(cast&lt;Instruction&gt;(*U), Root));</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = Root-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="comment">// If there are no loads or stores, the access is dead. We mark that as</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// a size zero access.</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = 0;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *UsedI;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      std::tie(UsedI, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) = <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.pop_back_val();</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> =</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).getFixedValue());</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> == UsedI)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> =</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>-&gt;getType()).getFixedValue());</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;hasAllZeroIndices())</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!isa&lt;BitCastInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; !isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                 !isa&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; !isa&lt;AddrSpaceCastInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users())</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">if</span> (Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(cast&lt;Instruction&gt;(U)).second)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.push_back(std::make_pair(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, cast&lt;Instruction&gt;(U)));</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    } <span class="keywordflow">while</span> (!<a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.empty());</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordtype">void</span> visitPHINodeOrSelectInst(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.use_empty())</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keywordflow">return</span> markAsDead(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="comment">// If this is a PHI node before a catchswitch, we cannot insert any non-PHI</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">// instructions in this BB, which may be required during rewriting. Bail out</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// on these cases.</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()-&gt;getFirstInsertionPt() == <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()-&gt;end())</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">// TODO: We could use simplifyInstruction here to fold PHINodes and</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">// SelectInsts. However, doing so requires to change the current</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// dead-operand-tracking mechanism. For instance, suppose neither loading</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// from %U nor %other traps. Then &quot;load (select undef, %U, %other)&quot; does not</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">// trap either.  However, if we simply replace %U with undef using the</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// current dead-operand-tracking mechanism, &quot;load (select undef, undef,</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// %other)&quot; may trap because the select may return the first operand</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">// &quot;undef&quot;.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *Result = <a class="code" href="SROA_8cpp.html#a23d87925bf94456691d6030c7d6070c4">foldPHINodeOrSelectInst</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordflow">if</span> (Result == *U)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <span class="comment">// If the result of the constant fold will be the pointer, recurse</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="comment">// through the PHI/select as if we had RAUW&#39;ed it.</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        enqueueUsers(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="comment">// Otherwise the operand to the PHI/select is dead, and we can replace</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="comment">// it with poison.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        AS.DeadOperands.push_back(U);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (!IsOffsetKnown)</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="keywordflow">return</span> PI.setAborted(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">// See if we already have computed info on this node.</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> &amp;<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = PHIOrSelectSizes[&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <span class="comment">// This is a new PHI/Select, check for an unsafe use of it.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UnsafeI = hasUnsafePHIOrSelectUse(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>))</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">return</span> PI.setAborted(UnsafeI);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">// For PHI and select operands outside the alloca, we can&#39;t nuke the entire</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">// phi or select -- the other side might still be relevant, so we special</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">// case them here and use a separate structure to track the operands</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// themselves which should be replaced with poison.</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">// FIXME: This should instead be escaped in the event we&#39;re instrumenting</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">// for address sanitization.</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.uge(AllocSize)) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      AS.DeadOperands.push_back(U);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    insertUse(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="keywordtype">void</span> visitPHINode(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) { visitPHINodeOrSelectInst(PN); }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keywordtype">void</span> visitSelectInst(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) { visitPHINodeOrSelectInst(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>); }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">  /// Disable SROA entirely if there are unhandled users of the alloca.</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> visitInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) { PI.setAborted(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>); }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;};</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aca741215da3a820dcdc44b32e6e4948b">AllocaSlices::AllocaSlices</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    :</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;#<a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a> !defined(<a class="code" href="regutils_8h.html#a8de3ed741dadc9c979a4ff17c0a9116e">NDEBUG</a>) || defined(LLVM_ENABLE_DUMP)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      AI(AI),</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;#<a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#ac54dc4baeff9131a27bde4eb0527e810">endif</a></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      PointerEscapingInstr(nullptr) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <a class="code" href="classAllocaSlices_1_1SliceBuilder.html#a8a54eb11a6edc3c5411cbedcf76b2002">SliceBuilder</a> <a class="code" href="PassBuilderBindings_8cpp.html#afd1501c49c84f3addfd108c2484f5674">PB</a>(<a class="code" href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#ac5b2513c27d0e8fe9a9214eb9fe99a7b">DL</a>, AI, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  SliceBuilder::PtrInfo PtrI = <a class="code" href="PassBuilderBindings_8cpp.html#afd1501c49c84f3addfd108c2484f5674">PB</a>.visitPtr(AI);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordflow">if</span> (PtrI.isEscaped() || PtrI.isAborted()) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// FIXME: We should sink the escape vs. abort info into the caller nicely,</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">// possibly by just storing the PtrInfo in the AllocaSlices.</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    PointerEscapingInstr = PtrI.getEscapingInst() ? PtrI.getEscapingInst()</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                                  : PtrI.getAbortingInst();</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PointerEscapingInstr &amp;&amp; <span class="stringliteral">&quot;Did not track a bad instruction&quot;</span>);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(Slices, [](<span class="keyword">const</span> Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) { <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isDead(); });</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="comment">// Sort the uses. This arranges for the offsets to be in ascending order,</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="comment">// and the sizes to be in descending order.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <a class="code" href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a>(Slices);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;}</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="preprocessor">#if !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">AllocaSlices::print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, const_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                         <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Indent)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  printSlice(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Indent);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  printUse(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Indent);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;}</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="keywordtype">void</span> AllocaSlices::printSlice(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, const_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                              <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Indent)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; Indent &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;beginOffset() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;endOffset() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; slice #&quot;</span> &lt;&lt; (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> - <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>())</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;     &lt;&lt; (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isSplittable() ? <span class="stringliteral">&quot; (splittable)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="keywordtype">void</span> AllocaSlices::printUse(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, const_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                            <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> Indent)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; Indent &lt;&lt; <span class="stringliteral">&quot;  used by: &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getUse()-&gt;getUser() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;}</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">AllocaSlices::print</a>(<a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="keywordflow">if</span> (PointerEscapingInstr) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;Can&#39;t analyze slices for alloca: &quot;</span> &lt;&lt; AI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;  A pointer to this alloca escaped by:\n&quot;</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; *PointerEscapingInstr &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; <span class="stringliteral">&quot;Slices of alloca: &quot;</span> &lt;&lt; AI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">for</span> (const_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <a class="code" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;}</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<a class="code" href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a> <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">AllocaSlices::dump</a>(const_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <a class="code" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;}</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<a class="code" href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a> <span class="keywordtype">void</span> <a class="code" href="namespacellvm.html#a03503773241005f01b090b9862aad304">AllocaSlices::dump</a>()<span class="keyword"> const </span>{ <a class="code" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor">#endif // !defined(NDEBUG) || defined(LLVM_ENABLE_DUMP)</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">/// Walk the range of a partitioning looking for a common type to cover this</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">/// sequence of slices.</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::pair&lt;Type *, IntegerType *&gt;</div>
<div class="line"><a name="l01297"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#ab040eb97b6dfc28714a55b93c66ae560"> 1297</a></span>&#160;<a class="code" href="SROA_8cpp.html#ab040eb97b6dfc28714a55b93c66ae560">findCommonType</a>(AllocaSlices::const_iterator <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>, AllocaSlices::const_iterator <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>,</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;               <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOffset) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordtype">bool</span> TyIsCommon = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *ITy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="comment">// Note that we need to look at *every* alloca slice&#39;s Use to ensure we</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="comment">// always get consistent results regardless of the order of slices.</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">for</span> (AllocaSlices::const_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <a class="code" href="classllvm_1_1Use.html">Use</a> *U = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getUse();</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">if</span> (isa&lt;IntrinsicInst&gt;(*U-&gt;getUser()))</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;beginOffset() != <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>-&gt;beginOffset() || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;endOffset() != EndOffset)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *UserTy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      UserTy = LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      UserTy = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType();</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *UserITy = dyn_cast_or_null&lt;IntegerType&gt;(UserTy)) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="comment">// If the type is larger than the partition, skip it. We only encounter</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="comment">// this for split integer operations where we want to use the type of the</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="comment">// entity causing the split. Also skip if the type is not a byte width</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="comment">// multiple.</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keywordflow">if</span> (UserITy-&gt;getBitWidth() % 8 != 0 ||</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;          UserITy-&gt;getBitWidth() / 8 &gt; (EndOffset - <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>-&gt;beginOffset()))</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="comment">// Track the largest bitwidth integer type used in this way in case there</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="comment">// is no common type.</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordflow">if</span> (!ITy || ITy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() &lt; UserITy-&gt;getBitWidth())</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        ITy = UserITy;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">// To avoid depending on the order of slices, Ty and TyIsCommon must not</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// depend on types skipped above.</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">if</span> (!UserTy || (Ty &amp;&amp; Ty != UserTy))</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      TyIsCommon = <span class="keyword">false</span>; <span class="comment">// Give up on anything but an iN type.</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      Ty = UserTy;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keywordflow">return</span> {TyIsCommon ? Ty : <span class="keyword">nullptr</span>, ITy};</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;}</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">/// PHI instructions that use an alloca and are subsequently loaded can be</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">/// rewritten to load both input pointers in the pred blocks and then PHI the</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">/// results, allowing the load of the alloca to be promoted.</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">/// From this:</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">///   %P2 = phi [i32* %Alloca, i32* %Other]</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">///   %V = load i32* %P2</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">/// to:</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">///   %V1 = load i32* %Alloca      -&gt; will be mem2reg&#39;d</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">///   ...</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">///   %V2 = load i32* %Other</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">///   ...</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">///   %V = phi [i32 %V1, i32 %V2]</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">/// We can do this to a select if its only uses are loads and if the operands</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">/// to the select can be loaded unconditionally.</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">/// FIXME: This should be hoisted into a generic utility, likely in</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">/// Transforms/Util/Local.h</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#aab37469c4748a495736ad163ac54e776"> 1363</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SROA_8cpp.html#aab37469c4748a495736ad163ac54e776">isSafePHIToSpeculate</a>(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = PN.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="comment">// For now, we can only do this promotion if the load is in the same block</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="comment">// as the PHI, and if there are no stores between the phi and load.</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// TODO: Allow recursive phi users.</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="comment">// TODO: Allow stores.</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = PN.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> MaxAlign;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> APWidth = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexTypeSizeInBits(PN.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *LoadType = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : PN.<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(U);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">if</span> (!LI || !LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">isSimple</a>())</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">// For now we only allow loads in the same block as the PHI.  This is</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="comment">// a common case that happens when instcombine merges two loads through</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// a PHI.</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">if</span> (LoadType) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keywordflow">if</span> (LoadType != LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      LoadType = LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">// Ensure that there are no instructions between the PHI and the load that</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">// could store.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> BBI(PN); &amp;*BBI != LI; ++BBI)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="keywordflow">if</span> (BBI-&gt;mayWriteToMemory())</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    MaxAlign = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(MaxAlign, LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>());</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">if</span> (!LoadType)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <a class="code" href="classllvm_1_1APInt.html">APInt</a> LoadSize =</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a>(APWidth, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(LoadType).getFixedValue());</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="comment">// We can only transform this if it is safe to push the loads into the</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="comment">// predecessor blocks. The only thing to watch out for is that we can&#39;t put</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="comment">// a possibly trapping load in the predecessor if it is a critical edge.</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, Num = PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); Idx != Num; ++Idx) {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI = PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(Idx)-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(Idx);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">// If the value is produced by the terminator of the predecessor (an</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">// invoke) or it has side-effects, there is no valid place to put a load</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// in the predecessor.</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span> (TI == InVal || TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">mayHaveSideEffects</a>())</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">// If the predecessor has a single successor, then the edge isn&#39;t</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">// critical.</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">if</span> (TI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>() == 1)</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">// If this pointer is always safe to load, or if we can prove that there</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="comment">// is already a load in the block, then we can move the load to the pred</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="comment">// block.</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#ad2ea0f3a55cc5ac23db1d53c12f656f9">isSafeToLoadUnconditionally</a>(InVal, MaxAlign, LoadSize, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TI))</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;}</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a80f5f1399bc814c650325a6c41e350e2"> 1437</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SROA_8cpp.html#a80f5f1399bc814c650325a6c41e350e2">speculatePHINodeLoads</a>(IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; PN &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *SomeLoad = cast&lt;LoadInst&gt;(PN.<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>());</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *LoadTy = SomeLoad-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  IRB.SetInsertPoint(&amp;PN);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN = IRB.CreatePHI(LoadTy, PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(),</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                 PN.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.speculated&quot;</span>);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="comment">// Get the AA tags and alignment to use from one of the loads. It does not</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="comment">// matter which one we get and if any differ.</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags = SomeLoad-&gt;<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = SomeLoad-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>();</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="comment">// Rewrite all loads of the PN to use the new PHI.</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="keywordflow">while</span> (!PN.<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>()) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = cast&lt;LoadInst&gt;(PN.<a class="code" href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">user_back</a>());</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    LI-&gt;<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewPN);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    LI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="comment">// Inject loads into all of the pred blocks.</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <a class="code" href="classllvm_1_1DenseMap.html">DenseMap&lt;BasicBlock*, Value*&gt;</a> InjectedLoads;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, Num = PN.<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); Idx != Num; ++Idx) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred = PN.<a class="code" href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">getIncomingBlock</a>(Idx);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *InVal = PN.<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(Idx);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="comment">// A PHI node is allowed to have multiple (duplicated) entries for the same</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="comment">// basic block, as long as the value is the same. So if we already injected</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">// a load in the predecessor, then we should reuse the same load for all</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">// duplicated entries.</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a>* V = InjectedLoads.<a class="code" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(Pred)) {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(V, Pred);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TI = Pred-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>();</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    IRB.SetInsertPoint(TI);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = IRB.CreateAlignedLoad(</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        LoadTy, InVal, Alignment,</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        (PN.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.speculate.load.&quot;</span> + Pred-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()));</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    ++NumLoadsSpeculated;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;setAAMetadata(AATags);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, Pred);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    InjectedLoads[Pred] = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          speculated to: &quot;</span> &lt;&lt; *NewPN &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  PN.<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;}</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;sroa::SelectHandSpeculativity &amp;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;sroa::SelectHandSpeculativity::setAsSpeculatable(<span class="keywordtype">bool</span> isTrueVal) {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordflow">if</span> (isTrueVal)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    Bitfield::set&lt;sroa::SelectHandSpeculativity::TrueVal&gt;(Storage, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    Bitfield::set&lt;sroa::SelectHandSpeculativity::FalseVal&gt;(Storage, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;}</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="keywordtype">bool</span> sroa::SelectHandSpeculativity::isSpeculatable(<span class="keywordtype">bool</span> isTrueVal)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">return</span> isTrueVal</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;             ? Bitfield::get&lt;sroa::SelectHandSpeculativity::TrueVal&gt;(Storage)</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;             : <a class="code" href="structllvm_1_1Bitfield.html">Bitfield</a>::<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">get</a>&lt;<a class="code" href="SROA_8cpp.html#a6990f15b9f29df6e8497b3e53875ccab">sroa</a>::SelectHandSpeculativity::<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">FalseVal</a>&gt;(Storage);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;}</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="keywordtype">bool</span> sroa::SelectHandSpeculativity::areAllSpeculatable()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordflow">return</span> isSpeculatable(<span class="comment">/*isTrueVal=*/</span><span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;         isSpeculatable(<span class="comment">/*isTrueVal=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;}</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="keywordtype">bool</span> sroa::SelectHandSpeculativity::areAnySpeculatable()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="keywordflow">return</span> isSpeculatable(<span class="comment">/*isTrueVal=*/</span><span class="keyword">true</span>) ||</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;         isSpeculatable(<span class="comment">/*isTrueVal=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;}</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="keywordtype">bool</span> sroa::SelectHandSpeculativity::areNoneSpeculatable()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordflow">return</span> !areAnySpeculatable();</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;}</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="keyword">static</span> sroa::SelectHandSpeculativity</div>
<div class="line"><a name="l01519"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a7b23a52d25a9f327dadfa52d12a1a7c4"> 1519</a></span>&#160;<a class="code" href="SROA_8cpp.html#a7b23a52d25a9f327dadfa52d12a1a7c4">isSafeLoadOfSelectToSpeculate</a>(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;LI, <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keywordtype">bool</span> PreserveCFG) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">isSimple</a>() &amp;&amp; <span class="stringliteral">&quot;Only for simple loads&quot;</span>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  sroa::SelectHandSpeculativity <a class="code" href="structllvm_1_1Spec.html">Spec</a>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="classllvm_1_1Value.html">Value</a> : {<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getTrueValue(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getFalseValue()})</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#ad2ea0f3a55cc5ac23db1d53c12f656f9">isSafeToLoadUnconditionally</a>(<a class="code" href="classllvm_1_1Value.html">Value</a>, LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), LI.<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                                    &amp;LI))</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <a class="code" href="structllvm_1_1Spec.html">Spec</a>.setAsSpeculatable(<span class="comment">/*isTrueVal=*/</span><a class="code" href="classllvm_1_1Value.html">Value</a> == <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getTrueValue());</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">PreserveCFG</a>)</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1Spec.html">Spec</a>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="structllvm_1_1Spec.html">Spec</a>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;}</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;std::optional&lt;sroa::RewriteableMemOps&gt;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;SROAPass::isSafeSelectToSpeculate(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <span class="keywordtype">bool</span> PreserveCFG) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <a class="code" href="namespacellvm_1_1LLVM__LIBRARY__VISIBILITY.html#a4336b55aee4e59a84195fe0edde8d27e">RewriteableMemOps</a> Ops;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.users()) {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *BC = dyn_cast&lt;BitCastInst&gt;(U); BC &amp;&amp; BC-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>())</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      U = *BC-&gt;<a class="code" href="classllvm_1_1Value.html#a158da2b6d3d938aaa15b6acd00150e2c">user_begin</a>();</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = dyn_cast&lt;StoreInst&gt;(U)) {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="comment">// Note that atomic stores can be transformed; atomic semantics do not</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="comment">// have any meaning for a local alloca. Stores are not speculatable,</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="comment">// however, so if we can&#39;t turn it into a predicated store, we are done.</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;isVolatile() || PreserveCFG)</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="keywordflow">return</span> {}; <span class="comment">// Give up on this `select`.</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      Ops.emplace_back(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(U);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">// Note that atomic loads can be transformed;</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="comment">// atomic semantics do not have any meaning for a local alloca.</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordflow">if</span> (!LI || LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>())</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordflow">return</span> {}; <span class="comment">// Give up on this `select`.</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <a class="code" href="namespacellvm_1_1LLVM__LIBRARY__VISIBILITY.html#a6c24741dd2bfb00d274c8a700d6d0eff">PossiblySpeculatableLoad</a> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>(LI);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">if</span> (!LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">isSimple</a>()) {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="comment">// If the `load` is not simple, we can&#39;t speculatively execute it,</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="comment">// but we could handle this via a CFG modification. But can we?</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <span class="keywordflow">if</span> (PreserveCFG)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <span class="keywordflow">return</span> {}; <span class="comment">// Give up on this `select`.</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      Ops.emplace_back(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    sroa::SelectHandSpeculativity <a class="code" href="structllvm_1_1Spec.html">Spec</a> =</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <a class="code" href="SROA_8cpp.html#a7b23a52d25a9f327dadfa52d12a1a7c4">isSafeLoadOfSelectToSpeculate</a>(*LI, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, PreserveCFG);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordflow">if</span> (PreserveCFG &amp;&amp; !<a class="code" href="structllvm_1_1Spec.html">Spec</a>.areAllSpeculatable())</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordflow">return</span> {}; <span class="comment">// Give up on this `select`.</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>.setInt(<a class="code" href="structllvm_1_1Spec.html">Spec</a>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    Ops.emplace_back(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="keywordflow">return</span> Ops;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;}</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#ace8766b97ac54db2bec8c29e4016f3f6"> 1581</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SROA_8cpp.html#ace8766b97ac54db2bec8c29e4016f3f6">speculateSelectInstLoads</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;LI,</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                     IRBuilderTy &amp;IRB) {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original load: &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TV = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getTrueValue();</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *FV = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getFalseValue();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="comment">// Replace the given load of the select with a select of two loads.</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">isSimple</a>() &amp;&amp; <span class="stringliteral">&quot;We only speculate simple loads&quot;</span>);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  IRB.SetInsertPoint(&amp;LI);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *TypedPtrTy = LI.<a class="code" href="classllvm_1_1LoadInst.html#a396be932e2034b3c3e4a482820a83aab">getPointerOperandType</a>();</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      !TypedPtrTy-&gt;<a class="code" href="classllvm_1_1Type.html#a54155244e7b172a97fe5b3096d84fa97">isOpaquePointerTy</a>() &amp;&amp; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getType() != TypedPtrTy) {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    TV = IRB.CreateBitOrPointerCast(TV, TypedPtrTy, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    FV = IRB.CreateBitOrPointerCast(FV, TypedPtrTy, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *TL =</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      IRB.CreateAlignedLoad(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), TV, LI.<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(),</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                            LI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.speculate.load.true&quot;</span>);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *FL =</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      IRB.CreateAlignedLoad(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), FV, LI.<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(),</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                            LI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.speculate.load.false&quot;</span>);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  NumLoadsSpeculated += 2;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="comment">// Transfer alignment and AA info if present.</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  TL-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2b1268b642e9bf4373b6fb31c482c9ca">setAlignment</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>());</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  FL-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2b1268b642e9bf4373b6fb31c482c9ca">setAlignment</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>());</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> Tags = LI.<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keywordflow">if</span> (Tags) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    TL-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4dd9b6c5bb93e01393c47dbe60f8b23f">setAAMetadata</a>(Tags);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    FL-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4dd9b6c5bb93e01393c47dbe60f8b23f">setAAMetadata</a>(Tags);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = IRB.CreateSelect(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getCondition(), TL, FL,</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                              LI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.speculated&quot;</span>);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          speculated to: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  LI.<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(V);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;}</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l01625"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a350324aa0625cf34f3ae212398215e59"> 1625</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SROA_8cpp.html#a350324aa0625cf34f3ae212398215e59">rewriteMemOpOfSelect</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classT.html">T</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                 sroa::SelectHandSpeculativity <a class="code" href="structllvm_1_1Spec.html">Spec</a>,</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                                 <a class="code" href="classllvm_1_1DomTreeUpdater.html">DomTreeUpdater</a> &amp;DTU) {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((isa&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &amp;&amp; <span class="stringliteral">&quot;Only for load and store!&quot;</span>);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original mem op: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Head = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ThenTerm = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ElseTerm = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1Spec.html">Spec</a>.areNoneSpeculatable())</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <a class="code" href="namespacellvm.html#a47d9d4544f29bfafd32f0d62db009915">SplitBlockAndInsertIfThenElse</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getCondition(), &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, &amp;ThenTerm, &amp;ElseTerm,</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                                  <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getMetadata(LLVMContext::MD_prof), &amp;DTU);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <a class="code" href="namespacellvm.html#ae2aea60aed775d05692317bf4855c291">SplitBlockAndInsertIfThen</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getCondition(), &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="comment">/*Unreachable=*/</span><span class="keyword">false</span>,</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                              <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getMetadata(LLVMContext::MD_prof), &amp;DTU,</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                              <span class="comment">/*LI=*/</span><span class="keyword">nullptr</span>, <span class="comment">/*ThenBlock=*/</span><span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1Spec.html">Spec</a>.isSpeculatable(<span class="comment">/*isTrueVal=*/</span><span class="keyword">true</span>))</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      cast&lt;BranchInst&gt;(Head-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>())-&gt;swapSuccessors();</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keyword">auto</span> *HeadBI = cast&lt;BranchInst&gt;(Head-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="structllvm_1_1Spec.html">Spec</a> = {}; <span class="comment">// Do not use `Spec` beyond this point.</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">Tail</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">Tail</a>-&gt;setName(Head-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.cont&quot;</span>);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PN;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    PN = PHINode::Create(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType(), 2, <span class="stringliteral">&quot;&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *SuccBB : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(Head)) {</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordtype">bool</span> IsThen = SuccBB == HeadBI-&gt;getSuccessor(0);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordtype">int</span> SuccIdx = IsThen ? 0 : 1;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keyword">auto</span> *NewMemOpBB = SuccBB == <a class="code" href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">Tail</a> ? Head : SuccBB;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keywordflow">if</span> (NewMemOpBB != Head) {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      NewMemOpBB-&gt;<a class="code" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(Head-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + (IsThen ? <span class="stringliteral">&quot;.then&quot;</span> : <span class="stringliteral">&quot;.else&quot;</span>));</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        ++NumLoadsPredicated;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        ++NumStoresPredicated;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      ++NumLoadsSpeculated;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keyword">auto</span> &amp;CondMemOp = cast&lt;T&gt;(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.clone());</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    CondMemOp.insertBefore(NewMemOpBB-&gt;getTerminator());</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(1 + SuccIdx);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *PtrTy = <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType();</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        !PtrTy-&gt;isOpaquePointerTy() &amp;&amp;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        PtrTy != CondMemOp.getPointerOperandType())</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = BitCastInst::CreatePointerBitCastOrAddrSpaceCast(</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;          <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, CondMemOp.getPointerOperandType(), <span class="stringliteral">&quot;&quot;</span>, &amp;CondMemOp);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    CondMemOp.setOperand(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getPointerOperandIndex(), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      CondMemOp.setName(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getName() + (IsThen ? <span class="stringliteral">&quot;.then&quot;</span> : <span class="stringliteral">&quot;.else&quot;</span>) + <span class="stringliteral">&quot;.val&quot;</span>);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      PN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(&amp;CondMemOp, NewMemOpBB);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;                 to: &quot;</span> &lt;&lt; CondMemOp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    PN-&gt;<a class="code" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *PN &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.replaceAllUsesWith(PN);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;}</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; </div>
<div class="line"><a name="l01684"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a1eca0fb2b72bb8913983e9a09dc6cf61"> 1684</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="SROA_8cpp.html#a350324aa0625cf34f3ae212398215e59">rewriteMemOpOfSelect</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;SelInst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                                 sroa::SelectHandSpeculativity <a class="code" href="structllvm_1_1Spec.html">Spec</a>,</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                 <a class="code" href="classllvm_1_1DomTreeUpdater.html">DomTreeUpdater</a> &amp;DTU) {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <a class="code" href="SROA_8cpp.html#a350324aa0625cf34f3ae212398215e59">rewriteMemOpOfSelect</a>(SelInst, *LI, <a class="code" href="structllvm_1_1Spec.html">Spec</a>, DTU);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <a class="code" href="SROA_8cpp.html#a350324aa0625cf34f3ae212398215e59">rewriteMemOpOfSelect</a>(SelInst, *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="structllvm_1_1Spec.html">Spec</a>, DTU);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <a class="code" href="namespacellvm.html#a8cb1f2bd469f8a823857a1cf1447a0e3">llvm_unreachable_internal</a>(<span class="stringliteral">&quot;Only for load and store.&quot;</span>);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;}</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#aae20a4fd186a7a392cb3af583c470709"> 1695</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SROA_8cpp.html#aae20a4fd186a7a392cb3af583c470709">rewriteSelectInstMemOps</a>(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1LLVM__LIBRARY__VISIBILITY.html#a4336b55aee4e59a84195fe0edde8d27e">sroa::RewriteableMemOps</a> &amp;Ops,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                                    IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1DomTreeUpdater.html">DomTreeUpdater</a> *DTU) {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keywordtype">bool</span> CFGChanged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original select: &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespacellvm_1_1LLVM__LIBRARY__VISIBILITY.html#ad221b42fd39a2d460d033bbd1f780c56">RewriteableMemOp</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : Ops) {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    sroa::SelectHandSpeculativity <a class="code" href="structllvm_1_1Spec.html">Spec</a>;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<span class="keyword">const</span> *US = std::get_if&lt;UnspeculatableStore&gt;(&amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>)) {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = *US;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="keyword">auto</span> PSL = std::get&lt;PossiblySpeculatableLoad&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = PSL.getPointer();</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <a class="code" href="structllvm_1_1Spec.html">Spec</a> = PSL.getInt();</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structllvm_1_1Spec.html">Spec</a>.areAllSpeculatable()) {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <a class="code" href="SROA_8cpp.html#ace8766b97ac54db2bec8c29e4016f3f6">speculateSelectInstLoads</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, cast&lt;LoadInst&gt;(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), IRB);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DTU &amp;&amp; <span class="stringliteral">&quot;Should not get here when not allowed to modify the CFG!&quot;</span>);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <a class="code" href="SROA_8cpp.html#a350324aa0625cf34f3ae212398215e59">rewriteMemOpOfSelect</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="structllvm_1_1Spec.html">Spec</a>, *DTU);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      CFGChanged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">make_early_inc_range</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.users()))</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    cast&lt;BitCastInst&gt;(U)-&gt;eraseFromParent();</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.eraseFromParent();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="keywordflow">return</span> CFGChanged;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;}</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">/// Compute an adjusted pointer from Ptr by Offset bytes where the</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">/// resulting pointer has PointerTy.</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1"> 1729</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRBuilderTy &amp;IRB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                             <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">PointerTy</a>,</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;NamePrefix) {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType()-&gt;isOpaquePointerTy() &amp;&amp;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;         <span class="stringliteral">&quot;Only opaque pointers supported&quot;</span>);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> != 0)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = IRB.CreateInBoundsGEP(IRB.getInt8Ty(), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, IRB.getInt(<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>),</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                NamePrefix + <span class="stringliteral">&quot;sroa_idx&quot;</span>);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <span class="keywordflow">return</span> IRB.CreatePointerBitCastOrAddrSpaceCast(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">PointerTy</a>,</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                                                 NamePrefix + <span class="stringliteral">&quot;sroa_cast&quot;</span>);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;}</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="comment">/// Compute the adjusted alignment for a load or store from an offset.</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8"> 1742</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="structllvm_1_1Align.html">Align</a> <a class="code" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>) {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(<a class="code" href="namespacellvm.html#a87d85287259123dfc6486631084f94b6">getLoadStoreAlignment</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;}</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">/// Test whether we can convert a value from the old to the new type.</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">/// This predicate should be used to guard calls to convertValue in order to</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">/// ensure that we only try to convert viable values. The strategy is that we</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">/// will peel off single element struct and array wrappings to get to an</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">/// underlying value, and convert that value.</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c"> 1752</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *OldTy, <a class="code" href="classllvm_1_1Type.html">Type</a> *NewTy) {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keywordflow">if</span> (OldTy == NewTy)</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; </div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="comment">// For integer types, we can&#39;t handle any bit-width differences. This would</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="comment">// break both vector conversions with extension and introduce endianness</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <span class="comment">// issues when in conjunction with loads and stores.</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="keywordflow">if</span> (isa&lt;IntegerType&gt;(OldTy) &amp;&amp; isa&lt;IntegerType&gt;(NewTy)) {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;IntegerType&gt;(OldTy)-&gt;<a class="code" href="ValueTracking_8cpp.html#a2cb59ea8f9e8543986d40c48acfd24a3">getBitWidth</a>() !=</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;               cast&lt;IntegerType&gt;(NewTy)-&gt;<a class="code" href="ValueTracking_8cpp.html#a2cb59ea8f9e8543986d40c48acfd24a3">getBitWidth</a>() &amp;&amp;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;           <span class="stringliteral">&quot;We can&#39;t have the same bitwidth for different int types&quot;</span>);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(NewTy).getFixedValue() !=</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(OldTy).getFixedValue())</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <span class="keywordflow">if</span> (!NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>() || !OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>())</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="comment">// We can convert pointers to integers and vice-versa. Same for vectors</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="comment">// of pointers and integers.</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  OldTy = OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>();</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  NewTy = NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>();</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keywordflow">if</span> (NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() || OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) {</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">if</span> (NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp; OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keywordtype">unsigned</span> OldAS = OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      <span class="keywordtype">unsigned</span> NewAS = NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="comment">// Convert pointers if they are pointers from the same address space or</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <span class="comment">// different integral (not non-integral) address spaces with the same</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      <span class="comment">// pointer size.</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keywordflow">return</span> OldAS == NewAS ||</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;             (!<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isNonIntegralAddressSpace(OldAS) &amp;&amp;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;              !<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isNonIntegralAddressSpace(NewAS) &amp;&amp;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;              <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSize(OldAS) == <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSize(NewAS));</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="comment">// We can convert integers to integral pointers, but not to non-integral</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// pointers.</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">if</span> (OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">return</span> !<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isNonIntegralPointerType(NewTy);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="comment">// We can convert integral pointers to integers, but non-integral pointers</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">// need to remain pointers.</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isNonIntegralPointerType(OldTy))</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <span class="keywordflow">return</span> NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>();</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  }</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="keywordflow">if</span> (OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a8536986ed6c44fce15dba30748428d2c">isTargetExtTy</a>() || NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a8536986ed6c44fce15dba30748428d2c">isTargetExtTy</a>())</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;}</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment">/// Generic routine to convert an SSA value to a value of a different</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment">/// type.</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">/// This will try various different casting techniques, such as bitcasts,</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">/// inttoptr, and ptrtoint casts. Use the \c canConvertValue predicate to test</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">/// two types for viability with this routine.</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f"> 1814</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                           <a class="code" href="classllvm_1_1Type.html">Type</a> *NewTy) {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *OldTy = V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, OldTy, NewTy) &amp;&amp; <span class="stringliteral">&quot;Value not convertable to type&quot;</span>);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordflow">if</span> (OldTy == NewTy)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!(isa&lt;IntegerType&gt;(OldTy) &amp;&amp; isa&lt;IntegerType&gt;(NewTy)) &amp;&amp;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;         <span class="stringliteral">&quot;Integer types must be the exact same to convert.&quot;</span>);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="comment">// See if we need inttoptr for this type pair. May require additional bitcast.</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="keywordflow">if</span> (OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">isIntOrIntVectorTy</a>() &amp;&amp; NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab03652069eab17006c51f00c261a6a44">isPtrOrPtrVectorTy</a>()) {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// Expand &lt;2 x i32&gt; to i8* --&gt; &lt;2 x i32&gt; to i64 to i8*</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">// Expand i128 to &lt;2 x i8*&gt; --&gt; i128 to &lt;2 x i64&gt; to &lt;2 x i8*&gt;</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">// Expand &lt;4 x i32&gt; to &lt;2 x i8*&gt; --&gt; &lt;4 x i32&gt; to &lt;2 x i64&gt; to &lt;2 x i8*&gt;</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">// Directly handle i64 to i8*</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">return</span> IRB.CreateIntToPtr(IRB.CreateBitCast(V, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(NewTy)),</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                              NewTy);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  }</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="comment">// See if we need ptrtoint for this type pair. May require additional bitcast.</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordflow">if</span> (OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab03652069eab17006c51f00c261a6a44">isPtrOrPtrVectorTy</a>() &amp;&amp; NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">isIntOrIntVectorTy</a>()) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="comment">// Expand &lt;2 x i8*&gt; to i128 --&gt; &lt;2 x i8*&gt; to &lt;2 x i64&gt; to i128</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="comment">// Expand i8* to &lt;2 x i32&gt; --&gt; i8* to i64 to &lt;2 x i32&gt;</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">// Expand &lt;2 x i8*&gt; to &lt;4 x i32&gt; --&gt; &lt;2 x i8*&gt; to &lt;2 x i64&gt; to &lt;4 x i32&gt;</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">// Expand i8* to i64 --&gt; i8* to i64 to i64</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">return</span> IRB.CreateBitCast(IRB.CreatePtrToInt(V, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(OldTy)),</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                             NewTy);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  }</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordflow">if</span> (OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab03652069eab17006c51f00c261a6a44">isPtrOrPtrVectorTy</a>() &amp;&amp; NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#ab03652069eab17006c51f00c261a6a44">isPtrOrPtrVectorTy</a>()) {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordtype">unsigned</span> OldAS = OldTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordtype">unsigned</span> NewAS = NewTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">// To convert pointers with different address spaces (they are already</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">// checked convertible, i.e. they have the same pointer size), so far we</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// cannot use `bitcast` (which has restrict on the same address space) or</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">// `addrspacecast` (which is not always no-op casting). Instead, use a pair</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">// of no-op `ptrtoint`/`inttoptr` casts through an integer with the same bit</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="comment">// size.</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordflow">if</span> (OldAS != NewAS) {</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSize(OldAS) == <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerSize(NewAS));</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="keywordflow">return</span> IRB.CreateIntToPtr(IRB.CreatePtrToInt(V, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIntPtrType(OldTy)),</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                                NewTy);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  }</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordflow">return</span> IRB.CreateBitCast(V, NewTy);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;}</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">/// Test whether the given slice use can be promoted to a vector.</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">/// This function is called to test each entry in a partition which is slated</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">/// for a single slice.</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#ab4c31035e44c7bda618eb2eb81dcf314"> 1868</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SROA_8cpp.html#ab4c31035e44c7bda618eb2eb81dcf314">isVectorPromotionViableForSlice</a>(<a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <span class="keyword">const</span> Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>,</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                                            <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *Ty,</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                                            <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ElementSize,</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="comment">// First validate the slice offsets.</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BeginOffset =</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset(), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset()) - <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset();</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BeginIndex = BeginOffset / ElementSize;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="keywordflow">if</span> (BeginIndex * ElementSize != BeginOffset ||</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      BeginIndex &gt;= cast&lt;FixedVectorType&gt;(Ty)-&gt;getNumElements())</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOffset =</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset(), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset()) - <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset();</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndIndex = EndOffset / ElementSize;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="keywordflow">if</span> (EndIndex * ElementSize != EndOffset ||</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      EndIndex &gt; cast&lt;FixedVectorType&gt;(Ty)-&gt;getNumElements())</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160; </div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndIndex &gt; BeginIndex &amp;&amp; <span class="stringliteral">&quot;Empty vector!&quot;</span>);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NumElements = EndIndex - BeginIndex;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SliceTy = (NumElements == 1)</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                      ? Ty-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>()</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                      : <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">FixedVectorType::get</a>(Ty-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>(), NumElements);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SplitIntTy =</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      Type::getIntNTy(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), NumElements * ElementSize * 8);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <a class="code" href="classllvm_1_1Use.html">Use</a> *U = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse();</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemIntrinsic.html">MemIntrinsic</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = dyn_cast&lt;MemIntrinsic&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isVolatile())</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isSplittable())</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Skip any unsplittable intrinsics.</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = dyn_cast&lt;IntrinsicInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">if</span> (!II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a185bafe1e8f07def76a3bac154a23e7a">isLifetimeStartOrEnd</a>() &amp;&amp; !II-&gt;<a class="code" href="classllvm_1_1User.html#af6a49991304b167c94f4a9756d3fd48f">isDroppable</a>())</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>())</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *LTy = LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">// Disable vector promotion when there are loads or stores of an FCA.</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">if</span> (LTy-&gt;<a class="code" href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>())</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset() &gt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() || <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset() &lt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset()) {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>());</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      LTy = SplitIntTy;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    }</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SliceTy, LTy))</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isVolatile())</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *STy = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType();</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="comment">// Disable vector promotion when there are loads or stores of an FCA.</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">if</span> (STy-&gt;<a class="code" href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>())</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset() &gt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() || <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset() &lt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset()) {</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(STy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>());</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      STy = SplitIntTy;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, STy, SliceTy))</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;}</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">/// Test whether a vector type is viable for promotion.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">/// This implements the necessary checking for \c isVectorPromotionViable over</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">/// all slices of the alloca for the given VectorType.</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a73ce9bc74349e7599dd4ae32a091ede7"> 1942</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SROA_8cpp.html#a73ce9bc74349e7599dd4ae32a091ede7">checkVectorTypeForPromotion</a>(<a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VTy,</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ElementSize =</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(VTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>()).getFixedValue();</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="comment">// While the definition of LLVM vectors is bitpacked, we don&#39;t support sizes</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="comment">// that aren&#39;t byte sized.</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordflow">if</span> (ElementSize % 8)</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(VTy).getFixedValue() % 8) == 0 &amp;&amp;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;         <span class="stringliteral">&quot;vector size not a multiple of element size?&quot;</span>);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  ElementSize /= 8;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>)</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#ab4c31035e44c7bda618eb2eb81dcf314">isVectorPromotionViableForSlice</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, VTy, ElementSize, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.splitSliceTails())</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#ab4c31035e44c7bda618eb2eb81dcf314">isVectorPromotionViableForSlice</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, VTy, ElementSize, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;}</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment">/// Test whether the given alloca partitioning and range of slices can be</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">/// promoted to a vector.</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">/// This is a quick test to check whether we can rewrite a particular alloca</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">/// partition (and its newly formed alloca) into a vector alloca with only</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">/// whole-vector loads and stores such that it could be promoted to a vector</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">/// SSA value. We only can ensure this for a limited set of operations, and we</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment">/// don&#39;t want to do the rewrites unless we are confident that the result will</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="comment">/// be promotable, so we have an early test here.</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a458f8b1b5c1beb71a2f7b1e1c151741d"> 1975</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *<a class="code" href="SROA_8cpp.html#a458f8b1b5c1beb71a2f7b1e1c151741d">isVectorPromotionViable</a>(<a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="comment">// Collect the candidate types for vector-based promotion. Also track whether</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="comment">// we have different element types.</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;VectorType *, 4&gt;</a> CandidateTys;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CommonEltTy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *CommonVecPtrTy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordtype">bool</span> HaveVecPtrTy = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="keywordtype">bool</span> HaveCommonEltTy = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordtype">bool</span> HaveCommonVecPtrTy = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keyword">auto</span> CheckCandidateType = [&amp;](<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *VTy = dyn_cast&lt;VectorType&gt;(Ty)) {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="comment">// Return if bitcast to vectors is different for total size in bits.</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <span class="keywordflow">if</span> (!CandidateTys.empty()) {</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *V = CandidateTys[0];</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(VTy).getFixedValue() !=</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(V).getFixedValue()) {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;          CandidateTys.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      CandidateTys.push_back(VTy);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *EltTy = VTy-&gt;getElementType();</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keywordflow">if</span> (!CommonEltTy)</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        CommonEltTy = EltTy;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CommonEltTy != EltTy)</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        HaveCommonEltTy = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="keywordflow">if</span> (EltTy-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        HaveVecPtrTy = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="keywordflow">if</span> (!CommonVecPtrTy)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;          CommonVecPtrTy = VTy;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CommonVecPtrTy != VTy)</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;          HaveCommonVecPtrTy = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  };</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="comment">// Consider any loads or stores that are the exact size of the slice.</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() == <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset() &amp;&amp;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset() == <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset()) {</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse()-&gt;getUser()))</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        CheckCandidateType(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse()-&gt;getUser()))</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        CheckCandidateType(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType());</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="comment">// If we didn&#39;t find a vector type, nothing to do here.</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordflow">if</span> (CandidateTys.empty())</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="comment">// Pointer-ness is sticky, if we had a vector-of-pointers candidate type,</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="comment">// then we should choose it, not some other alternative.</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="comment">// But, we can&#39;t perform a no-op pointer address space change via bitcast,</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="comment">// so if we didn&#39;t have a common pointer element type, bail.</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="keywordflow">if</span> (HaveVecPtrTy &amp;&amp; !HaveCommonVecPtrTy)</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="comment">// Try to pick the &quot;best&quot; element type out of the choices.</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="keywordflow">if</span> (!HaveCommonEltTy &amp;&amp; HaveVecPtrTy) {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">// If there was a pointer element type, there&#39;s really only one choice.</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    CandidateTys.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    CandidateTys.push_back(CommonVecPtrTy);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!HaveCommonEltTy &amp;&amp; !HaveVecPtrTy) {</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">// Integer-ify vector types.</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *&amp;VTy : CandidateTys) {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      <span class="keywordflow">if</span> (!VTy-&gt;getElementType()-&gt;isIntegerTy())</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        VTy = cast&lt;VectorType&gt;(VTy-&gt;getWithNewType(IntegerType::getIntNTy(</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            VTy-&gt;getContext(), VTy-&gt;getScalarSizeInBits())));</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    }</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="comment">// Rank the remaining candidate vector types. This is easy because we know</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="comment">// they&#39;re all integer vectors. We sort by ascending number of elements.</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keyword">auto</span> RankVectorTypes = [&amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>](<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *RHSTy, <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *LHSTy) {</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      (void)<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(RHSTy).getFixedValue() ==</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                 <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(LHSTy).getFixedValue() &amp;&amp;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;             <span class="stringliteral">&quot;Cannot have vector types of different sizes!&quot;</span>);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RHSTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;             <span class="stringliteral">&quot;All non-integer types eliminated!&quot;</span>);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LHSTy-&gt;getElementType()-&gt;isIntegerTy() &amp;&amp;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;             <span class="stringliteral">&quot;All non-integer types eliminated!&quot;</span>);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      <span class="keywordflow">return</span> cast&lt;FixedVectorType&gt;(RHSTy)-&gt;getNumElements() &lt;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;             cast&lt;FixedVectorType&gt;(LHSTy)-&gt;getNumElements();</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    };</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(CandidateTys, RankVectorTypes);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    CandidateTys.erase(</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <a class="code" href="namespacellvm.html#a92be87f8a371f277f7260fb99592d5f4">std::unique</a>(CandidateTys.begin(), CandidateTys.end(), RankVectorTypes),</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        CandidateTys.end());</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">// The only way to have the same element type in every vector type is to</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">// have the same vector type. Check that and remove all but one.</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VTy : CandidateTys) {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VTy-&gt;getElementType() == CommonEltTy &amp;&amp;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;             <span class="stringliteral">&quot;Unaccounted for element type!&quot;</span>);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VTy == CandidateTys[0] &amp;&amp;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;             <span class="stringliteral">&quot;Different vector types with the same element type!&quot;</span>);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    }</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    CandidateTys.resize(1);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="comment">// FIXME: hack. Do we have a named constant for this?</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="comment">// SDAG SDNode can&#39;t have more than 65535 operands.</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(CandidateTys, [](<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VTy) {</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keywordflow">return</span> cast&lt;FixedVectorType&gt;(VTy)-&gt;getNumElements() &gt;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;           <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::numeric_limits&lt;unsigned short&gt;::max</a>();</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  });</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VTy : CandidateTys)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SROA_8cpp.html#a73ce9bc74349e7599dd4ae32a091ede7">checkVectorTypeForPromotion</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, VTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;      <span class="keywordflow">return</span> VTy;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;}</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="comment">/// Test whether a slice of an alloca is valid for integer widening.</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment">/// This implements the necessary checking for the \c isIntegerWideningViable</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment">/// test below on a single slice of the alloca.</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a593afa69fb7cfbb4506f605bd785f923"> 2096</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SROA_8cpp.html#a593afa69fb7cfbb4506f605bd785f923">isIntegerWideningViableForSlice</a>(<span class="keyword">const</span> Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>,</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                                            <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AllocBeginOffset,</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                                            <a class="code" href="classllvm_1_1Type.html">Type</a> *AllocaTy,</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                                            <span class="keywordtype">bool</span> &amp;WholeAllocaOp) {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(AllocaTy).getFixedValue();</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> RelBegin = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() - AllocBeginOffset;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> RelEnd = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset() - AllocBeginOffset;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160; </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <a class="code" href="classllvm_1_1Use.html">Use</a> *U = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse();</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="comment">// Lifetime intrinsics operate over the whole alloca whose sizes are usually</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="comment">// larger than other load/store slices (RelEnd &gt; Size). But lifetime are</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="comment">// always promotable and should not impact other slices&#39; promotability of the</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <span class="comment">// partition.</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = dyn_cast&lt;IntrinsicInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">if</span> (II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a185bafe1e8f07def76a3bac154a23e7a">isLifetimeStartOrEnd</a>() || II-&gt;<a class="code" href="classllvm_1_1User.html#af6a49991304b167c94f4a9756d3fd48f">isDroppable</a>())</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="comment">// We can&#39;t reasonably handle cases where the load or store extends past</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="comment">// the end of the alloca&#39;s type and into its padding.</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keywordflow">if</span> (RelEnd &gt; <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>())</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="comment">// We can&#39;t handle loads that extend past the allocated memory.</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).getFixedValue() &gt; <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="comment">// So far, AllocaSliceRewriter does not support widening split slice tails</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">// in rewriteIntegerLoad.</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() &lt; AllocBeginOffset)</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="comment">// Note that we don&#39;t count vector loads or stores as whole-alloca</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="comment">// operations which enable integer widening because we would prefer to use</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="comment">// vector widening instead.</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;VectorType&gt;(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp; RelBegin == 0 &amp;&amp; RelEnd == <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      WholeAllocaOp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *ITy = dyn_cast&lt;IntegerType&gt;(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())) {</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <span class="keywordflow">if</span> (ITy-&gt;getBitWidth() &lt; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSizeInBits(ITy).getFixedValue())</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RelBegin != 0 || RelEnd != <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> ||</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;               !<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, AllocaTy, LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())) {</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <span class="comment">// Non-integer loads need to be convertible from the alloca type so that</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;      <span class="comment">// they are promotable.</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ValueTy = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()-&gt;getType();</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isVolatile())</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="comment">// We can&#39;t handle stores that extend past the allocated memory.</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(ValueTy).getFixedValue() &gt; <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>)</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="comment">// So far, AllocaSliceRewriter does not support widening split slice tails</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="comment">// in rewriteIntegerStore.</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() &lt; AllocBeginOffset)</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">// Note that we don&#39;t count vector loads or stores as whole-alloca</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">// operations which enable integer widening because we would prefer to use</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">// vector widening instead.</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;VectorType&gt;(ValueTy) &amp;&amp; RelBegin == 0 &amp;&amp; RelEnd == <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      WholeAllocaOp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *ITy = dyn_cast&lt;IntegerType&gt;(ValueTy)) {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keywordflow">if</span> (ITy-&gt;getBitWidth() &lt; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSizeInBits(ITy).getFixedValue())</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RelBegin != 0 || RelEnd != <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> ||</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;               !<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ValueTy, AllocaTy)) {</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="comment">// Non-integer stores need to be convertible to the alloca type so that</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="comment">// they are promotable.</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemIntrinsic.html">MemIntrinsic</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = dyn_cast&lt;MemIntrinsic&gt;(U-&gt;getUser())) {</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isVolatile() || !isa&lt;Constant&gt;(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getLength()))</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isSplittable())</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Skip any unsplittable intrinsics.</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  }</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;}</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">/// Test whether the given alloca partition&#39;s integer operations can be</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">/// widened to promotable ones.</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">/// This is a quick test to check whether we can rewrite the integer loads and</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment">/// stores to a particular alloca into wider loads and stores and be able to</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">/// promote the resulting alloca.</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a7fd9ee96f281dd94ed4119c2e45836bf"> 2189</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="SROA_8cpp.html#a7fd9ee96f281dd94ed4119c2e45836bf">isIntegerWideningViable</a>(<a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *AllocaTy,</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SizeInBits = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(AllocaTy).getFixedValue();</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  <span class="comment">// Don&#39;t create integer types larger than the maximum bitwidth.</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="keywordflow">if</span> (SizeInBits &gt; IntegerType::MAX_INT_BITS)</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="comment">// Don&#39;t try to handle allocas with bit-padding.</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="keywordflow">if</span> (SizeInBits != <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSizeInBits(AllocaTy).getFixedValue())</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; </div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="comment">// We need to ensure that an integer type with the appropriate bitwidth can</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="comment">// be converted to the alloca type, whatever that is. We don&#39;t want to force</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="comment">// the alloca itself to have an integer type if there is a more suitable one.</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *IntTy = Type::getIntNTy(AllocaTy-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), SizeInBits);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, AllocaTy, IntTy) ||</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      !<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IntTy, AllocaTy))</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="comment">// While examining uses, we ensure that the alloca has a covering load or</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="comment">// store. We don&#39;t want to widen the integer operations only to fail to</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  <span class="comment">// promote due to some other unsplittable entry (which we may make splittable</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="comment">// later). However, if there are only splittable uses, go ahead and assume</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="comment">// that we cover the alloca.</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="comment">// FIXME: We shouldn&#39;t consider split slices that happen to start in the</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <span class="comment">// partition here...</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="keywordtype">bool</span> WholeAllocaOp = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.empty() &amp;&amp; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isLegalInteger(SizeInBits);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160; </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>)</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#a593afa69fb7cfbb4506f605bd785f923">isIntegerWideningViableForSlice</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset(), AllocaTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                                         WholeAllocaOp))</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.splitSliceTails())</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#a593afa69fb7cfbb4506f605bd785f923">isIntegerWideningViableForSlice</a>(*<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset(), AllocaTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                                         WholeAllocaOp))</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  <span class="keywordflow">return</span> WholeAllocaOp;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;}</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a94e7aca18fb08798727209385f164f7c"> 2230</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#a94e7aca18fb08798727209385f164f7c">extractInteger</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                             <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *Ty, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>,</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;       start: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *IntTy = cast&lt;IntegerType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(Ty).getFixedValue() + <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> &lt;=</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;             <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(IntTy).getFixedValue() &amp;&amp;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;         <span class="stringliteral">&quot;Element extends past full value&quot;</span>);</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ShAmt = 8 * <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isBigEndian())</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    ShAmt = 8 * (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(IntTy).getFixedValue() -</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                 <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(Ty).getFixedValue() - <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="keywordflow">if</span> (ShAmt) {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    V = IRB.CreateLShr(V, ShAmt, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.shift&quot;</span>);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;     shifted: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  }</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() &lt;= IntTy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() &amp;&amp;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;         <span class="stringliteral">&quot;Cannot extract to a larger integer!&quot;</span>);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="keywordflow">if</span> (Ty != IntTy) {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    V = IRB.CreateTrunc(V, Ty, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.trunc&quot;</span>);</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;     trunced: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  }</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;}</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a7febebe786555d6e0d07ca0f86e294c1"> 2255</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#a7febebe786555d6e0d07ca0f86e294c1">insertInteger</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1Value.html">Value</a> *Old,</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                            <a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *IntTy = cast&lt;IntegerType&gt;(Old-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *Ty = cast&lt;IntegerType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() &lt;= IntTy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() &amp;&amp;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;         <span class="stringliteral">&quot;Cannot insert a larger integer!&quot;</span>);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;       start: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  <span class="keywordflow">if</span> (Ty != IntTy) {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    V = IRB.CreateZExt(V, IntTy, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.ext&quot;</span>);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    extended: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(Ty).getFixedValue() + <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> &lt;=</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;             <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(IntTy).getFixedValue() &amp;&amp;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;         <span class="stringliteral">&quot;Element store outside of alloca store&quot;</span>);</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ShAmt = 8 * <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isBigEndian())</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    ShAmt = 8 * (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(IntTy).getFixedValue() -</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                 <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(Ty).getFixedValue() - <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  <span class="keywordflow">if</span> (ShAmt) {</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    V = IRB.CreateShl(V, ShAmt, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.shift&quot;</span>);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;     shifted: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  }</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="keywordflow">if</span> (ShAmt || Ty-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() &lt; IntTy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>()) {</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = ~Ty-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a4afdaec43ad128c62a84c3bf1241e7dd">getMask</a>().<a class="code" href="classllvm_1_1APInt.html#a1dc76cc8bf703e6ada68bededcbb9573">zext</a>(IntTy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>()).<a class="code" href="classllvm_1_1APInt.html#acb9c55b6986369948507ca5241b4e411">shl</a>(ShAmt);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    Old = IRB.CreateAnd(Old, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.mask&quot;</span>);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;      masked: &quot;</span> &lt;&lt; *Old &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    V = IRB.CreateOr(Old, V, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.insert&quot;</span>);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    inserted: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;}</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a06a9071efa992145e210f0b41a52e501"> 2288</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#a06a9071efa992145e210f0b41a52e501">extractVector</a>(IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> BeginIndex,</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                            <span class="keywordtype">unsigned</span> EndIndex, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="keyword">auto</span> *VecTy = cast&lt;FixedVectorType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="keywordtype">unsigned</span> NumElements = EndIndex - BeginIndex;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumElements &lt;= VecTy-&gt;getNumElements() &amp;&amp; <span class="stringliteral">&quot;Too many elements!&quot;</span>);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  <span class="keywordflow">if</span> (NumElements == VecTy-&gt;getNumElements())</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordflow">if</span> (NumElements == 1) {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    V = IRB.CreateExtractElement(V, IRB.getInt32(BeginIndex),</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                                 <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.extract&quot;</span>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;     extract: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  }</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = llvm::to_vector&lt;8&gt;(llvm::seq&lt;int&gt;(BeginIndex, EndIndex));</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  V = IRB.CreateShuffleVector(V, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.extract&quot;</span>);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;     shuffle: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;}</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a42c6a2faff923f431932c6d33cf4092b"> 2310</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="SROA_8cpp.html#a42c6a2faff923f431932c6d33cf4092b">insertVector</a>(IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1Value.html">Value</a> *Old, <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                           <span class="keywordtype">unsigned</span> BeginIndex, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;<a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>) {</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy = cast&lt;VectorType&gt;(Old-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VecTy &amp;&amp; <span class="stringliteral">&quot;Can only insert a vector into a vector&quot;</span>);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *Ty = dyn_cast&lt;VectorType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <span class="keywordflow">if</span> (!Ty) {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="comment">// Single element to insert.</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    V = IRB.CreateInsertElement(Old, V, IRB.getInt32(BeginIndex),</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                                <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.insert&quot;</span>);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;     insert: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; </div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;FixedVectorType&gt;(Ty)-&gt;getNumElements() &lt;=</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;             cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements() &amp;&amp;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;         <span class="stringliteral">&quot;Too many elements!&quot;</span>);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <span class="keywordflow">if</span> (cast&lt;FixedVectorType&gt;(Ty)-&gt;getNumElements() ==</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements()) {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == VecTy &amp;&amp; <span class="stringliteral">&quot;Vector type mismatch&quot;</span>);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  }</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="keywordtype">unsigned</span> EndIndex = BeginIndex + cast&lt;FixedVectorType&gt;(Ty)-&gt;getNumElements();</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <span class="comment">// When inserting a smaller vector into the larger to store, we first</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <span class="comment">// use a shuffle vector to widen it with undef elements, and then</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <span class="comment">// a second shuffle vector to select between the loaded vector and the</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  <span class="comment">// incoming vector.</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;int, 8&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.reserve(cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements());</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements(); ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= BeginIndex &amp;&amp; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; EndIndex)</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.push_back(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - BeginIndex);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>.push_back(-1);</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  V = IRB.CreateShuffleVector(V, <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;.expand&quot;</span>);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    shuffle: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 8&gt;</a> Mask2;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  Mask2.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements());</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements(); ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    Mask2.push_back(IRB.getInt1(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= BeginIndex &amp;&amp; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; EndIndex));</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; </div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  V = IRB.CreateSelect(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantVector::get</a>(Mask2), V, Old, <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> + <span class="stringliteral">&quot;blend&quot;</span>);</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    blend: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;}</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">/// Visitor to rewrite instructions using p particular slice of an alloca</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment">/// to use a new alloca.</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment">/// Also implements the rewriting to vector-based accesses when the partition</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment">/// passes the isVectorPromotionViable predicate. Most of the rewriting logic</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">/// lives here.</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html"> 2365</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html">llvm::sroa::AllocaSliceRewriter</a></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    : <span class="keyword">public</span> <a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor</a>&lt;AllocaSliceRewriter, bool&gt; {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <span class="comment">// Befriend the base class so it can delegate to private visit methods.</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html#a73e5f32465500cf4cbd002f5c1c9a025"> 2368</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor</a>&lt;<a class="code" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html">AllocaSliceRewriter</a>, bool&gt;;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keyword">using</span> <a class="code" href="classllvm_1_1InstVisitor.html">Base</a> = <a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor&lt;AllocaSliceRewriter, bool&gt;</a>;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> &amp;AS;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <a class="code" href="classllvm_1_1SROAPass.html">SROAPass</a> &amp;<a class="code" href="LazyValueInfo_8cpp.html#a739511554e31b02d233401957fd86f44">Pass</a>;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;OldAI, &amp;NewAI;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="keyword">const</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NewAllocaBeginOffset, NewAllocaEndOffset;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *NewAllocaTy;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="comment">// This is a convenience and flag variable that will be null unless the new</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="comment">// alloca&#39;s integer operations should be widened to this integer type due to</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="comment">// passing isIntegerWideningViable above. If it is non-null, the desired</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="comment">// integer type will be stored here for easy access during rewriting.</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *IntTy;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <span class="comment">// If we are rewriting an alloca partition which can be written as pure</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="comment">// vector operations, we stash extra information here. When VecTy is</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="comment">// non-null, we have some strict guarantees about the rewritten alloca:</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  <span class="comment">//   - The new alloca is exactly the size of the vector type here.</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  <span class="comment">//   - The accesses all either map to the entire vector or to a single</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  <span class="comment">//     element.</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="comment">//   - The set of accessing instructions is only one of those handled above</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="comment">//     in isVectorPromotionViable. Generally these are the same access kinds</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="comment">//     which are promotable via mem2reg.</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ElementTy;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ElementSize;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; </div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  <span class="comment">// The original offset of the slice currently being rewritten relative to</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <span class="comment">// the original alloca.</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BeginOffset = 0;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOffset = 0;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="comment">// The new offsets of the slice currently being rewritten relative to the</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;  <span class="comment">// original alloca.</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NewBeginOffset = 0, NewEndOffset = 0;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; </div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SliceSize = 0;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  <span class="keywordtype">bool</span> IsSplittable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  <span class="keywordtype">bool</span> IsSplit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  <a class="code" href="classllvm_1_1Use.html">Use</a> *OldUse = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OldPtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <span class="comment">// Track post-rewrite users which are PHI nodes and Selects.</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;PHINode *, 8&gt;</a> &amp;PHIUsers;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;SelectInst *, 8&gt;</a> &amp;SelectUsers;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <span class="comment">// Utility IR builder, whose name prefix is setup for each visited use, and</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="comment">// the insertion point is set to point to the user.</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  IRBuilderTy IRB;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  <span class="comment">// Return the new alloca, addrspacecasted if required to avoid changing the</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  <span class="comment">// addrspace of a volatile access.</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *getPtrToNewAI(<span class="keywordtype">unsigned</span> AddrSpace, <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a>) {</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">IsVolatile</a> || AddrSpace == NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#ac106bea55dfb26f8b14676aac05bd89f">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>())</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      <span class="keywordflow">return</span> &amp;NewAI;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *AccessTy = NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(AddrSpace);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordflow">return</span> IRB.CreateAddrSpaceCast(&amp;NewAI, AccessTy);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160; </div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l02432"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html#aebacad5fd967f9411dee643dee03c1af"> 2432</a></span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html#aebacad5fd967f9411dee643dee03c1af">AllocaSliceRewriter</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> &amp;AS, <a class="code" href="classllvm_1_1SROAPass.html">SROAPass</a> &amp;<a class="code" href="classllvm_1_1Pass.html">Pass</a>,</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                      <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;OldAI, <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;NewAI,</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NewAllocaBeginOffset,</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NewAllocaEndOffset, <span class="keywordtype">bool</span> IsIntegerPromotable,</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                      <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *PromotableVecTy,</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                      <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;PHINode *, 8&gt;</a> &amp;PHIUsers,</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                      <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;SelectInst *, 8&gt;</a> &amp;SelectUsers)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      : <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), AS(AS), <a class="code" href="classllvm_1_1Pass.html">Pass</a>(<a class="code" href="classllvm_1_1Pass.html">Pass</a>), OldAI(OldAI), NewAI(NewAI),</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        NewAllocaBeginOffset(NewAllocaBeginOffset),</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        NewAllocaEndOffset(NewAllocaEndOffset),</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        NewAllocaTy(NewAI.getAllocatedType()),</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        IntTy(</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;            IsIntegerPromotable</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                ? <a class="code" href="classllvm_1_1Type.html">Type</a>::getIntNTy(NewAI.getContext(),</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                                  <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(NewAI.getAllocatedType())</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                                      .getFixedValue())</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                : nullptr),</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        VecTy(PromotableVecTy),</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        ElementTy(VecTy ? VecTy-&gt;getElementType() : nullptr),</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        ElementSize(VecTy ? <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(ElementTy).getFixedValue() / 8</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                          : 0),</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        PHIUsers(PHIUsers), SelectUsers(SelectUsers),</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        IRB(NewAI.getContext(), <a class="code" href="classllvm_1_1ConstantFolder.html">ConstantFolder</a>()) {</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (VecTy) {</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(ElementTy).getFixedValue() % 8) == 0 &amp;&amp;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;             <span class="stringliteral">&quot;Only multiple-of-8 sized vector elements are viable&quot;</span>);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      ++NumVectorized;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!IntTy &amp;&amp; !VecTy) || (IntTy &amp;&amp; !VecTy) || (!IntTy &amp;&amp; VecTy));</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  }</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html#af7b3a9bc0da17ff9e2a76885f5e4c4ed"> 2463</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html#af7b3a9bc0da17ff9e2a76885f5e4c4ed">visit</a>(<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">AllocaSlices::const_iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="keywordtype">bool</span> CanSROA = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    BeginOffset = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;beginOffset();</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    EndOffset = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;endOffset();</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    IsSplittable = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isSplittable();</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    IsSplit =</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        BeginOffset &lt; NewAllocaBeginOffset || EndOffset &gt; NewAllocaEndOffset;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  rewriting &quot;</span> &lt;&lt; (IsSplit ? <span class="stringliteral">&quot;split &quot;</span> : <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a17fe7e337dc0346719e8978b0a5a400b">printSlice</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">// Compute the intersecting offset range.</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BeginOffset &lt; NewAllocaEndOffset);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndOffset &gt; NewAllocaBeginOffset);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    NewBeginOffset = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(BeginOffset, NewAllocaBeginOffset);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    NewEndOffset = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(EndOffset, NewAllocaEndOffset);</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    SliceSize = NewEndOffset - NewBeginOffset;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;   Begin:(&quot;</span> &lt;&lt; BeginOffset &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; EndOffset</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;) NewBegin:(&quot;</span> &lt;&lt; NewBeginOffset &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                      &lt;&lt; NewEndOffset &lt;&lt; <span class="stringliteral">&quot;) NewAllocaBegin:(&quot;</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                      &lt;&lt; NewAllocaBeginOffset &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; NewAllocaEndOffset</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsSplit || NewBeginOffset == BeginOffset);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    OldUse = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getUse();</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    OldPtr = cast&lt;Instruction&gt;(OldUse-&gt;get());</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OldUserI = cast&lt;Instruction&gt;(OldUse-&gt;getUser());</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    IRB.SetInsertPoint(OldUserI);</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    IRB.SetCurrentDebugLocation(OldUserI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    IRB.getInserter().SetNamePrefix(</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        <a class="code" href="classllvm_1_1Twine.html">Twine</a>(NewAI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()) + <span class="stringliteral">&quot;.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(BeginOffset) + <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160; </div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    CanSROA &amp;= visit(cast&lt;Instruction&gt;(OldUse-&gt;getUser()));</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    <span class="keywordflow">if</span> (VecTy || IntTy)</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CanSROA);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <span class="keywordflow">return</span> CanSROA;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160; </div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <span class="comment">// Make sure the other visit overloads are visible.</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;  <span class="keyword">using</span> Base::visit;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="comment">// Every instruction which can end up as a user must have a rewrite rule.</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="keywordtype">bool</span> visitInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    !!!! Cannot rewrite: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;No rewrite rule for this instruction!&quot;</span>);</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;  }</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160; </div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *getNewAllocaSlicePtr(IRBuilderTy &amp;IRB, <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">PointerTy</a>) {</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="comment">// Note that the offset computation can use BeginOffset or NewBeginOffset</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <span class="comment">// interchangeably for unsplit slices.</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsSplit || BeginOffset == NewBeginOffset);</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = NewBeginOffset - NewAllocaBeginOffset;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160; </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> OldName = OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="comment">// Skip through the last &#39;.sroa.&#39; component of the name.</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordtype">size_t</span> LastSROAPrefix = OldName.<a class="code" href="classllvm_1_1StringRef.html#a97d45ce069c1a09ca84672df63acf096">rfind</a>(<span class="stringliteral">&quot;.sroa.&quot;</span>);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    <span class="keywordflow">if</span> (LastSROAPrefix != StringRef::npos) {</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      OldName = OldName.<a class="code" href="classllvm_1_1StringRef.html#a25f1fd81f2132805676c82ab8ae0c109">substr</a>(LastSROAPrefix + strlen(<span class="stringliteral">&quot;.sroa.&quot;</span>));</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      <span class="comment">// Look for an SROA slice index.</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <span class="keywordtype">size_t</span> IndexEnd = OldName.<a class="code" href="classllvm_1_1StringRef.html#ae851887270f35d2a2670a79b9833d45b">find_first_not_of</a>(<span class="stringliteral">&quot;0123456789&quot;</span>);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      <span class="keywordflow">if</span> (IndexEnd != StringRef::npos &amp;&amp; OldName[IndexEnd] == <span class="charliteral">&#39;.&#39;</span>) {</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        <span class="comment">// Strip the index and look for the offset.</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        OldName = OldName.<a class="code" href="classllvm_1_1StringRef.html#a25f1fd81f2132805676c82ab8ae0c109">substr</a>(IndexEnd + 1);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        <span class="keywordtype">size_t</span> OffsetEnd = OldName.<a class="code" href="classllvm_1_1StringRef.html#ae851887270f35d2a2670a79b9833d45b">find_first_not_of</a>(<span class="stringliteral">&quot;0123456789&quot;</span>);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        <span class="keywordflow">if</span> (OffsetEnd != StringRef::npos &amp;&amp; OldName[OffsetEnd] == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;          <span class="comment">// Strip the offset.</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;          OldName = OldName.<a class="code" href="classllvm_1_1StringRef.html#a25f1fd81f2132805676c82ab8ae0c109">substr</a>(OffsetEnd + 1);</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      }</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="comment">// Strip any SROA suffixes as well.</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    OldName = OldName.<a class="code" href="classllvm_1_1StringRef.html#a25f1fd81f2132805676c82ab8ae0c109">substr</a>(0, OldName.<a class="code" href="classllvm_1_1StringRef.html#aab312a8386488873bac2eddfc67c22be">find</a>(<span class="stringliteral">&quot;.sroa_&quot;</span>));</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160; </div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRB, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, &amp;NewAI,</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                          <a class="code" href="classllvm_1_1APInt.html">APInt</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexTypeSizeInBits(<a class="code" href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">PointerTy</a>), <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>),</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                          <a class="code" href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">PointerTy</a>,</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;#ifndef <a class="code" href="regutils_8h.html#a8de3ed741dadc9c979a4ff17c0a9116e">NDEBUG</a></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;                          <a class="code" href="classllvm_1_1Twine.html">Twine</a>(OldName) + <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                          <a class="code" href="classllvm_1_1Twine.html">Twine</a>()</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;#<a class="code" href="include_2llvm_2Support_2CMakeLists_8txt.html#ac54dc4baeff9131a27bde4eb0527e810">endif</a></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                          );</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="comment">  /// Compute suitable alignment to access this slice of the *new*</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">  /// alloca.</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">  /// You can optionally pass a type to this routine and if that type&#39;s ABI</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment">  /// alignment is itself suitable, this will return zero.</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment"></span>  <a class="code" href="structllvm_1_1Align.html">Align</a> getSliceAlign() {</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(),</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                           NewBeginOffset - NewAllocaBeginOffset);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  }</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  <span class="keywordtype">unsigned</span> getIndex(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>) {</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VecTy &amp;&amp; <span class="stringliteral">&quot;Can only call getIndex when rewriting a vector&quot;</span>);</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> RelOffset = <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> - NewAllocaBeginOffset;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RelOffset / ElementSize &lt; UINT32_MAX &amp;&amp; <span class="stringliteral">&quot;Index out of bounds&quot;</span>);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <a class="code" href="classuint32__t.html">uint32_t</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = RelOffset / ElementSize;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> * ElementSize == RelOffset);</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  }</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160; </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  <span class="keywordtype">void</span> deleteIfTriviallyDead(<a class="code" href="classllvm_1_1Value.html">Value</a> *V) {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(V);</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">isInstructionTriviallyDead</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;  }</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160; </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *rewriteVectorizedLoadInst(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;LI) {</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordtype">unsigned</span> BeginIndex = getIndex(NewBeginOffset);</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="keywordtype">unsigned</span> EndIndex = getIndex(NewEndOffset);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndIndex &gt; BeginIndex &amp;&amp; <span class="stringliteral">&quot;Empty vector!&quot;</span>);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                                           NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;load&quot;</span>);</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160; </div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;copyMetadata(LI, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                            LLVMContext::MD_access_group});</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#a06a9071efa992145e210f0b41a52e501">extractVector</a>(IRB, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, BeginIndex, EndIndex, <span class="stringliteral">&quot;vec&quot;</span>);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  }</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *rewriteIntegerLoad(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;LI) {</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IntTy &amp;&amp; <span class="stringliteral">&quot;We cannot insert an integer to the alloca&quot;</span>);</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>());</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                                     NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;load&quot;</span>);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    V = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, IntTy);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewBeginOffset &gt;= NewAllocaBeginOffset &amp;&amp; <span class="stringliteral">&quot;Out of bounds offset&quot;</span>);</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = NewBeginOffset - NewAllocaBeginOffset;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> &gt; 0 || NewEndOffset &lt; NewAllocaEndOffset) {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *ExtractTy = Type::getIntNTy(LI.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), SliceSize * 8);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a94e7aca18fb08798727209385f164f7c">extractInteger</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, ExtractTy, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="stringliteral">&quot;extract&quot;</span>);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <span class="comment">// It is possible that the extracted type is not the load type. This</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="comment">// happens if there is a load past the end of the alloca, and as</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <span class="comment">// a consequence the slice is narrower but still a candidate for integer</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="comment">// lowering. To handle this case, we just zero extend the extracted</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="comment">// integer.</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(cast&lt;IntegerType&gt;(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getBitWidth() &gt;= SliceSize * 8 &amp;&amp;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;           <span class="stringliteral">&quot;Can only handle an extract for an overly wide load&quot;</span>);</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="keywordflow">if</span> (cast&lt;IntegerType&gt;(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())-&gt;getBitWidth() &gt; SliceSize * 8)</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      V = IRB.CreateZExt(V, LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  }</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="keywordtype">bool</span> visitLoadInst(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;LI) {</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; LI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *OldOp = LI.<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OldOp == OldPtr);</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160; </div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags = LI.<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160; </div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="keywordtype">unsigned</span> AS = LI.<a class="code" href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160; </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *TargetTy = IsSplit ? Type::getIntNTy(LI.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), SliceSize * 8)</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                             : LI.<a class="code" href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a>();</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> IsLoadPastEnd =</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(TargetTy).getFixedValue() &gt; SliceSize;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="keywordtype">bool</span> IsPtrAdjusted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keywordflow">if</span> (VecTy) {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      V = rewriteVectorizedLoadInst(LI);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IntTy &amp;&amp; LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()) {</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;      V = rewriteIntegerLoad(LI);</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NewBeginOffset == NewAllocaBeginOffset &amp;&amp;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;               NewEndOffset == NewAllocaEndOffset &amp;&amp;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;               (<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, NewAllocaTy, TargetTy) ||</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                (IsLoadPastEnd &amp;&amp; NewAllocaTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                 TargetTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()))) {</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NewPtr =</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;          getPtrToNewAI(LI.<a class="code" href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">getPointerAddressSpace</a>(), LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>());</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *NewLI = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), NewPtr,</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                                              NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>(),</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;                                              LI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      <span class="keywordflow">if</span> (LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>())</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        NewLI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a6ae88dc44b078c80ce3a25401fd4b05b">setAtomic</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#a93603fe0d4168b92a901f06015ecb2e7">getOrdering</a>(), LI.<a class="code" href="classllvm_1_1LoadInst.html#aca6c2de6950cb093f509ed2b67e02da2">getSyncScopeID</a>());</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="keywordflow">if</span> (NewLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">isAtomic</a>())</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        NewLI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2b1268b642e9bf4373b6fb31c482c9ca">setAlignment</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>());</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      <span class="comment">// Copy any metadata that is valid for the new load. This may require</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <span class="comment">// conversion to a different kind of metadata, e.g. !nonnull might change</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      <span class="comment">// to !range or vice versa.</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <a class="code" href="namespacellvm.html#a2f8e44f52bb2b2c5d2273eccec70faae">copyMetadataForLoad</a>(*NewLI, LI);</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="comment">// Do this after copyMetadataForLoad() to preserve the TBAA shift.</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        NewLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4dd9b6c5bb93e01393c47dbe60f8b23f">setAAMetadata</a>(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160; </div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <span class="comment">// Try to preserve nonnull metadata</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      V = NewLI;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160; </div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      <span class="comment">// If this is an integer load past the end of the slice (which means the</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <span class="comment">// bytes outside the slice are undef or this load is dead) just forcibly</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;      <span class="comment">// fix the integer size with correct handling of endianness.</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AITy = dyn_cast&lt;IntegerType&gt;(NewAllocaTy))</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *TITy = dyn_cast&lt;IntegerType&gt;(TargetTy))</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;          <span class="keywordflow">if</span> (AITy-&gt;getBitWidth() &lt; TITy-&gt;getBitWidth()) {</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            V = IRB.CreateZExt(V, TITy, <span class="stringliteral">&quot;load.ext&quot;</span>);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isBigEndian())</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;              V = IRB.CreateShl(V, TITy-&gt;getBitWidth() - AITy-&gt;getBitWidth(),</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                                <span class="stringliteral">&quot;endian_shift&quot;</span>);</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;          }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *LTy = TargetTy-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(AS);</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *NewLI =</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;          IRB.CreateAlignedLoad(TargetTy, getNewAllocaSlicePtr(IRB, LTy),</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                                getSliceAlign(), LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>(), LI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;        NewLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4dd9b6c5bb93e01393c47dbe60f8b23f">setAAMetadata</a>(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      <span class="keywordflow">if</span> (LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>())</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        NewLI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a6ae88dc44b078c80ce3a25401fd4b05b">setAtomic</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#a93603fe0d4168b92a901f06015ecb2e7">getOrdering</a>(), LI.<a class="code" href="classllvm_1_1LoadInst.html#aca6c2de6950cb093f509ed2b67e02da2">getSyncScopeID</a>());</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      NewLI-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(LI, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                               LLVMContext::MD_access_group});</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160; </div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      V = NewLI;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      IsPtrAdjusted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    V = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, TargetTy);</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160; </div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="keywordflow">if</span> (IsSplit) {</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>());</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;             <span class="stringliteral">&quot;Only integer type loads and stores are split&quot;</span>);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SliceSize &lt; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).getFixedValue() &amp;&amp;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;             <span class="stringliteral">&quot;Split load isn&#39;t smaller than original load&quot;</span>);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.typeSizeEqualsStoreSize(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;             <span class="stringliteral">&quot;Non-byte-multiple bit width&quot;</span>);</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="comment">// Move the insertion point just past the load so that we can refer to it.</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      IRB.SetInsertPoint(&amp;*std::next(<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a>(&amp;LI)));</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <span class="comment">// Create a placeholder value with the same type as LI to use as the</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <span class="comment">// basis for the new value. This allows us to replace the uses of LI with</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="comment">// the computed value, and then replace the placeholder with LI, leaving</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;      <span class="comment">// LI only used for this computation.</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Placeholder = <span class="keyword">new</span> <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>(</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;          LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">PoisonValue::get</a>(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(AS)), <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;          <span class="keyword">false</span>, <a class="code" href="structllvm_1_1Align.html">Align</a>(1));</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a7febebe786555d6e0d07ca0f86e294c1">insertInteger</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Placeholder, V, NewBeginOffset - BeginOffset,</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                        <span class="stringliteral">&quot;insert&quot;</span>);</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      LI.<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(V);</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      Placeholder-&gt;replaceAllUsesWith(&amp;LI);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      Placeholder-&gt;deleteValue();</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      LI.<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(V);</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    }</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160; </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(&amp;LI);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    deleteIfTriviallyDead(OldOp);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordflow">return</span> !LI.<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>() &amp;&amp; !IsPtrAdjusted;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  }</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; </div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;  <span class="keywordtype">bool</span> rewriteVectorizedStoreInst(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *OldOp,</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                                  <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags) {</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="comment">// Capture V for the purpose of debug-info accounting once it&#39;s converted</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    <span class="comment">// to a vector store.</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *OrigV = V;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != VecTy) {</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <span class="keywordtype">unsigned</span> BeginIndex = getIndex(NewBeginOffset);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      <span class="keywordtype">unsigned</span> EndIndex = getIndex(NewEndOffset);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndIndex &gt; BeginIndex &amp;&amp; <span class="stringliteral">&quot;Empty vector!&quot;</span>);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="keywordtype">unsigned</span> NumElements = EndIndex - BeginIndex;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumElements &lt;= cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements() &amp;&amp;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;             <span class="stringliteral">&quot;Too many elements!&quot;</span>);</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *SliceTy = (NumElements == 1)</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                          ? ElementTy</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                          : <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">FixedVectorType::get</a>(ElementTy, NumElements);</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != SliceTy)</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        V = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, SliceTy);</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160; </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      <span class="comment">// Mix in the existing elements.</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Old = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                                         NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;load&quot;</span>);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a42c6a2faff923f431932c6d33cf4092b">insertVector</a>(IRB, Old, V, BeginIndex, <span class="stringliteral">&quot;vec&quot;</span>);</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = IRB.CreateAlignedStore(V, &amp;NewAI, NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>());</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;copyMetadata(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                             LLVMContext::MD_access_group});</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="comment">// NOTE: Careful to use OrigV rather than V.</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    migrateDebugInfo(&amp;OldAI, IsSplit, NewBeginOffset * 8, SliceSize * 8, &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>,</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                     <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;getPointerOperand(), OrigV, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;  }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;  <span class="keywordtype">bool</span> rewriteIntegerStore(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags) {</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IntTy &amp;&amp; <span class="stringliteral">&quot;We cannot extract an integer from the alloca&quot;</span>);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile());</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).getFixedValue() !=</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        IntTy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>()) {</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Old = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                                         NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;oldload&quot;</span>);</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      Old = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Old, IntTy);</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BeginOffset &gt;= NewAllocaBeginOffset &amp;&amp; <span class="stringliteral">&quot;Out of bounds offset&quot;</span>);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = BeginOffset - NewAllocaBeginOffset;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a7febebe786555d6e0d07ca0f86e294c1">insertInteger</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Old, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getValueOperand(), <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="stringliteral">&quot;insert&quot;</span>);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    }</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    V = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, NewAllocaTy);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = IRB.CreateAlignedStore(V, &amp;NewAI, NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>());</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;copyMetadata(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                             LLVMContext::MD_access_group});</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    migrateDebugInfo(&amp;OldAI, IsSplit, NewBeginOffset * 8, SliceSize * 8, &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>,</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                     <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;getPointerOperand(),</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                     <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;getValueOperand(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; </div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  }</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160; </div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;  <span class="keywordtype">bool</span> visitStoreInst(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *OldOp = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(1);</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OldOp == OldPtr);</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160; </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getAAMetadata();</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getValueOperand();</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="comment">// Strip all inbounds GEPs and pointer casts to try to dig out any root</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    <span class="comment">// alloca that should be re-examined after promoting this alloca.</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI = dyn_cast&lt;AllocaInst&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a3ed745230c0e6c52f4b1ec0dae8c07fb">stripInBoundsOffsets</a>()))</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        <a class="code" href="classllvm_1_1Pass.html">Pass</a>.PostPromotionWorklist.insert(AI);</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160; </div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="keywordflow">if</span> (SliceSize &lt; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).getFixedValue()) {</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile());</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp;</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;             <span class="stringliteral">&quot;Only integer type loads and stores are split&quot;</span>);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.typeSizeEqualsStoreSize(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) &amp;&amp;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;             <span class="stringliteral">&quot;Non-byte-multiple bit width&quot;</span>);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *NarrowTy = Type::getIntNTy(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getContext(), SliceSize * 8);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a94e7aca18fb08798727209385f164f7c">extractInteger</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, NarrowTy, NewBeginOffset - BeginOffset,</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                         <span class="stringliteral">&quot;extract&quot;</span>);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    }</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160; </div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <span class="keywordflow">if</span> (VecTy)</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      <span class="keywordflow">return</span> rewriteVectorizedStoreInst(V, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, OldOp, AATags);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="keywordflow">if</span> (IntTy &amp;&amp; V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      <span class="keywordflow">return</span> rewriteIntegerStore(V, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, AATags);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160; </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> IsStorePastEnd =</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).getFixedValue() &gt; SliceSize;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *NewSI;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    <span class="keywordflow">if</span> (NewBeginOffset == NewAllocaBeginOffset &amp;&amp;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        NewEndOffset == NewAllocaEndOffset &amp;&amp;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        (<a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), NewAllocaTy) ||</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;         (IsStorePastEnd &amp;&amp; NewAllocaTy-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;          V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()))) {</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      <span class="comment">// If this is an integer store past the end of slice (and thus the bytes</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      <span class="comment">// past that point are irrelevant or this is unreachable), truncate the</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <span class="comment">// value prior to storing.</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *VITy = dyn_cast&lt;IntegerType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()))</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AITy = dyn_cast&lt;IntegerType&gt;(NewAllocaTy))</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;          <span class="keywordflow">if</span> (VITy-&gt;getBitWidth() &gt; AITy-&gt;getBitWidth()) {</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isBigEndian())</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;              V = IRB.CreateLShr(V, VITy-&gt;getBitWidth() - AITy-&gt;getBitWidth(),</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                                 <span class="stringliteral">&quot;endian_shift&quot;</span>);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;            V = IRB.CreateTrunc(V, AITy, <span class="stringliteral">&quot;load.trunc&quot;</span>);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;          }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160; </div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, NewAllocaTy);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NewPtr =</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;          getPtrToNewAI(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getPointerAddressSpace(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile());</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160; </div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      NewSI =</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;          IRB.CreateAlignedStore(V, NewPtr, NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile());</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="keywordtype">unsigned</span> AS = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getPointerAddressSpace();</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NewPtr = getNewAllocaSlicePtr(IRB, V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(AS));</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      NewSI =</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;          IRB.CreateAlignedStore(V, NewPtr, getSliceAlign(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile());</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    }</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    NewSI-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                             LLVMContext::MD_access_group});</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      NewSI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4dd9b6c5bb93e01393c47dbe60f8b23f">setAAMetadata</a>(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile())</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      NewSI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#aff28bd42ac76fc3e1c0e4db7f9e06f2d">setAtomic</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOrdering(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getSyncScopeID());</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">if</span> (NewSI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">isAtomic</a>())</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;      NewSI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a55195fa18cf783fe74de0cced1ca6eb3">setAlignment</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getAlign());</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    migrateDebugInfo(&amp;OldAI, IsSplit, NewBeginOffset * 8, SliceSize * 8, &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>,</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                     NewSI, NewSI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>(),</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                     NewSI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">getValueOperand</a>(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160; </div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    deleteIfTriviallyDead(OldOp);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160; </div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *NewSI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    <span class="keywordflow">return</span> NewSI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>() == &amp;NewAI &amp;&amp;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;           NewSI-&gt;<a class="code" href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">getValueOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == NewAllocaTy &amp;&amp;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;           !<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isVolatile();</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment">  /// Compute an integer value from splatting an i8 across the given</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment">  /// number of bytes.</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment">  /// Note that this routine assumes an i8 is a byte. If that isn&#39;t true, don&#39;t</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment">  /// call this routine.</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="comment">  /// FIXME: Heed the advice above.</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="comment">  /// \param V The i8 value to splat.</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment">  /// \param Size The number of bytes in the output (assuming i8 is one byte)</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *getIntegerSplat(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>) {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Expected a positive number of bytes.&quot;</span>);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *VTy = cast&lt;IntegerType&gt;(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VTy-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() == 8 &amp;&amp; <span class="stringliteral">&quot;Expected an i8 value for the byte&quot;</span>);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> == 1)</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *SplatIntTy = Type::getIntNTy(VTy-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> * 8);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    V = IRB.CreateMul(</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        IRB.CreateZExt(V, SplatIntTy, <span class="stringliteral">&quot;zext&quot;</span>),</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        IRB.CreateUDiv(Constant::getAllOnesValue(SplatIntTy),</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                       IRB.CreateZExt(Constant::getAllOnesValue(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()),</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                                      SplatIntTy)),</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="stringliteral">&quot;isplat&quot;</span>);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  }</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="comment">  /// Compute a vector splat for a given element value.</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm.html#a387427d56330771ba6f190e27776a327">getVectorSplat</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> NumElements) {</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    V = IRB.CreateVectorSplat(NumElements, V, <span class="stringliteral">&quot;vsplat&quot;</span>);</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;       splat: &quot;</span> &lt;&lt; *V &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordflow">return</span> V;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  }</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160; </div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  <span class="keywordtype">bool</span> visitMemSetInst(<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> &amp;II) {</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; II &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>() == OldPtr);</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160; </div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags = II.<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <span class="comment">// If the memset has a variable size, it cannot be split, just adjust the</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="comment">// pointer to the new alloca.</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>())) {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!IsSplit);</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewBeginOffset == BeginOffset);</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;      II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a64ab14972c2bd5c0a01eaf7242dee624">setDest</a>(getNewAllocaSlicePtr(IRB, OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()));</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a4ab0f2c30ee83d6377488de9a1f089e9">setDestAlignment</a>(getSliceAlign());</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <span class="comment">// In theory we should call migrateDebugInfo here. However, we do not</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="comment">// emit dbg.assign intrinsics for mem intrinsics storing through non-</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;      <span class="comment">// constant geps, or storing a variable number of bytes.</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1at.html#a3c90899e8f022656e511630de42b916c">at::getAssignmentMarkers</a>(&amp;II).empty() &amp;&amp;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;             <span class="stringliteral">&quot;AT: Unexpected link to non-const GEP&quot;</span>);</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      deleteIfTriviallyDead(OldPtr);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    }</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160; </div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="comment">// Record this instruction for deletion.</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(&amp;II);</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160; </div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *AllocaTy = NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>();</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *ScalarTy = AllocaTy-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>();</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160; </div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> CanContinue = [&amp;]() {</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      <span class="keywordflow">if</span> (VecTy || IntTy)</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      <span class="keywordflow">if</span> (BeginOffset &gt; NewAllocaBeginOffset ||</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;          EndOffset &lt; NewAllocaEndOffset)</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      <span class="comment">// Length must be in range for FixedVectorType.</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = cast&lt;ConstantInt&gt;(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>());</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <span class="keyword">const</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">Len</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getLimitedValue();</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <span class="keywordflow">if</span> (Len &gt; <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::numeric_limits&lt;unsigned&gt;::max</a>())</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keyword">auto</span> *Int8Ty = IntegerType::getInt8Ty(NewAI.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      <span class="keyword">auto</span> *SrcTy = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">FixedVectorType::get</a>(Int8Ty, Len);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SrcTy, AllocaTy) &amp;&amp;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;             <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isLegalInteger(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(ScalarTy).getFixedValue());</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    }();</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160; </div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <span class="comment">// If this doesn&#39;t map cleanly onto the alloca type, and that type isn&#39;t</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="comment">// a single value type, just emit a memset.</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="keywordflow">if</span> (!CanContinue) {</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTy = II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(SizeTy, NewEndOffset - NewBeginOffset);</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <a class="code" href="classllvm_1_1MemIntrinsic.html">MemIntrinsic</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = cast&lt;MemIntrinsic&gt;(IRB.CreateMemSet(</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;          getNewAllocaSlicePtr(IRB, OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), II.<a class="code" href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">getValue</a>(), <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>,</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a>(getSliceAlign()), II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>()));</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;      <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160; </div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      migrateDebugInfo(&amp;OldAI, IsSplit, NewBeginOffset * 8, SliceSize * 8, &amp;II,</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                       New, <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;getRawDest(), <span class="keyword">nullptr</span>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160; </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *New &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    }</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160; </div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    <span class="comment">// If we can represent this as a simple value, we have to build the actual</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    <span class="comment">// value to store, which requires expanding the byte present in memset to</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    <span class="comment">// a sensible representation for the alloca type. This is essentially</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="comment">// splatting the byte to a sufficiently wide integer, splatting it across</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="comment">// any desired vector width, and bitcasting to the final type.</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160; </div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    <span class="keywordflow">if</span> (VecTy) {</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;      <span class="comment">// If this is a memset of a vectorized alloca, insert it.</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ElementTy == ScalarTy);</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160; </div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      <span class="keywordtype">unsigned</span> BeginIndex = getIndex(NewBeginOffset);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      <span class="keywordtype">unsigned</span> EndIndex = getIndex(NewEndOffset);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndIndex &gt; BeginIndex &amp;&amp; <span class="stringliteral">&quot;Empty vector!&quot;</span>);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      <span class="keywordtype">unsigned</span> NumElements = EndIndex - BeginIndex;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumElements &lt;= cast&lt;FixedVectorType&gt;(VecTy)-&gt;getNumElements() &amp;&amp;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;             <span class="stringliteral">&quot;Too many elements!&quot;</span>);</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160; </div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Splat = getIntegerSplat(</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;          II.<a class="code" href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">getValue</a>(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(ElementTy).getFixedValue() / 8);</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      Splat = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Splat, ElementTy);</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      <span class="keywordflow">if</span> (NumElements &gt; 1)</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        Splat = <a class="code" href="namespacellvm.html#a387427d56330771ba6f190e27776a327">getVectorSplat</a>(Splat, NumElements);</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160; </div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Old = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                                         NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;oldload&quot;</span>);</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a42c6a2faff923f431932c6d33cf4092b">insertVector</a>(IRB, Old, Splat, BeginIndex, <span class="stringliteral">&quot;vec&quot;</span>);</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IntTy) {</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      <span class="comment">// If this is a memset on an alloca where we can widen stores, insert the</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="comment">// set integer.</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>());</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160; </div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = NewEndOffset - NewBeginOffset;</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      V = getIntegerSplat(II.<a class="code" href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">getValue</a>(), <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160; </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      <span class="keywordflow">if</span> (IntTy &amp;&amp; (BeginOffset != NewAllocaBeginOffset ||</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                    EndOffset != NewAllocaBeginOffset)) {</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <a class="code" href="classllvm_1_1Value.html">Value</a> *Old = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                                           NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;oldload&quot;</span>);</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        Old = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Old, IntTy);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = NewBeginOffset - NewAllocaBeginOffset;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        V = <a class="code" href="SROA_8cpp.html#a7febebe786555d6e0d07ca0f86e294c1">insertInteger</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Old, V, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="stringliteral">&quot;insert&quot;</span>);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == IntTy &amp;&amp;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;               <span class="stringliteral">&quot;Wrong type for an alloca wide integer!&quot;</span>);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      }</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, AllocaTy);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <span class="comment">// Established these invariants above.</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewBeginOffset == NewAllocaBeginOffset);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewEndOffset == NewAllocaEndOffset);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160; </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      V = getIntegerSplat(II.<a class="code" href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">getValue</a>(),</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                          <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(ScalarTy).getFixedValue() / 8);</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *AllocaVecTy = dyn_cast&lt;VectorType&gt;(AllocaTy))</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        V = <a class="code" href="namespacellvm.html#a387427d56330771ba6f190e27776a327">getVectorSplat</a>(</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            V, cast&lt;FixedVectorType&gt;(AllocaVecTy)-&gt;getNumElements());</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160; </div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      V = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, V, AllocaTy);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160; </div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewPtr = getPtrToNewAI(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ad118358d398f591303b00c2e5462e3a9">getDestAddressSpace</a>(), II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>());</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> =</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        IRB.CreateAlignedStore(V, NewPtr, NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>());</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;copyMetadata(II, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                           LLVMContext::MD_access_group});</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160; </div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    migrateDebugInfo(&amp;OldAI, IsSplit, NewBeginOffset * 8, SliceSize * 8, &amp;II,</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                     New, <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;getPointerOperand(), V, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *New &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    <span class="keywordflow">return</span> !II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>();</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;  }</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160; </div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;  <span class="keywordtype">bool</span> visitMemTransferInst(<a class="code" href="classllvm_1_1MemTransferInst.html">MemTransferInst</a> &amp;II) {</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="comment">// Rewriting of memory transfer instructions can be a bit tricky. We break</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="comment">// them into two categories: split intrinsics and unsplit intrinsics.</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160; </div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; II &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160; </div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags = II.<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>();</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160; </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <span class="keywordtype">bool</span> IsDest = &amp;II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ab4cfdcb84d9daaf485a77caf4e8422b0">getRawDestUse</a>() == OldUse;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IsDest &amp;&amp; II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>() == OldPtr) ||</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;           (!IsDest &amp;&amp; II.<a class="code" href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">getRawSource</a>() == OldPtr));</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> SliceAlign = getSliceAlign();</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <span class="comment">// For unsplit intrinsics, we simply modify the source and destination</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    <span class="comment">// pointers in place. This isn&#39;t just an optimization, it is a matter of</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <span class="comment">// correctness. With unsplit intrinsics we may be dealing with transfers</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="comment">// within a single alloca before SROA ran, or with transfers that have</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="comment">// a variable length. We may also be dealing with memmove instead of</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    <span class="comment">// memcpy, and so simply updating the pointers is the necessary for us to</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="comment">// update both source and dest of a single call.</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <span class="keywordflow">if</span> (!IsSplittable) {</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *AdjustedPtr = getNewAllocaSlicePtr(IRB, OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;      <span class="keywordflow">if</span> (IsDest) {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="comment">// Update the address component of linked dbg.assigns.</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DAI : <a class="code" href="namespacellvm_1_1at.html#a3c90899e8f022656e511630de42b916c">at::getAssignmentMarkers</a>(&amp;II)) {</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(DAI-&gt;location_ops(),</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                     [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> *V) { return V == II.getDest(); }) ||</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;              DAI-&gt;getAddress() == II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>())</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;            DAI-&gt;replaceVariableLocationOp(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>(), AdjustedPtr);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        }</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a64ab14972c2bd5c0a01eaf7242dee624">setDest</a>(AdjustedPtr);</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a4ab0f2c30ee83d6377488de9a1f089e9">setDestAlignment</a>(SliceAlign);</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;        II.<a class="code" href="classllvm_1_1MemTransferBase.html#a5127b9bac226020bc936ecdedcf72e0d">setSource</a>(AdjustedPtr);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        II.<a class="code" href="classllvm_1_1MemTransferBase.html#ab5f836ddc7548470c429fd5daaea2784">setSourceAlignment</a>(SliceAlign);</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      }</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; </div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; II &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      deleteIfTriviallyDead(OldPtr);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    }</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <span class="comment">// For split transfer intrinsics we have an incredibly useful assurance:</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <span class="comment">// the source and destination do not reside within the same alloca, and at</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <span class="comment">// least one of them does not escape. This means that we can replace</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="comment">// memmove with memcpy, and we don&#39;t need to worry about all manner of</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <span class="comment">// downsides to splitting and transforming the operations.</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160; </div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <span class="comment">// If this doesn&#39;t map cleanly onto the alloca type, and that type isn&#39;t</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <span class="comment">// a single value type, just emit a memcpy.</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    <span class="keywordtype">bool</span> EmitMemCpy =</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;        !VecTy &amp;&amp; !IntTy &amp;&amp;</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        (BeginOffset &gt; NewAllocaBeginOffset || EndOffset &lt; NewAllocaEndOffset ||</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;         SliceSize !=</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;             <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>()).getFixedValue() ||</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;         !NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>());</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; </div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="comment">// If we&#39;re just going to emit a memcpy, the alloca hasn&#39;t changed, and the</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="comment">// size hasn&#39;t been shrunk based on analysis of the viable range, this is</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="comment">// a no-op.</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    <span class="keywordflow">if</span> (EmitMemCpy &amp;&amp; &amp;OldAI == &amp;NewAI) {</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;      <span class="comment">// Ensure the start lines up.</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewBeginOffset == BeginOffset);</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; </div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;      <span class="comment">// Rewrite the size as needed.</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      <span class="keywordflow">if</span> (NewEndOffset != EndOffset)</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a3e472e6fd83abb77745a59bccd367688">setLength</a>(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                                      NewEndOffset - NewBeginOffset));</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    }</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <span class="comment">// Record this instruction for deletion.</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(&amp;II);</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="comment">// Strip all inbounds GEPs and pointer casts to try to dig out any root</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <span class="comment">// alloca that should be re-examined after rewriting this instruction.</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *OtherPtr = IsDest ? II.<a class="code" href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">getRawSource</a>() : II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>();</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI =</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            dyn_cast&lt;AllocaInst&gt;(OtherPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a3ed745230c0e6c52f4b1ec0dae8c07fb">stripInBoundsOffsets</a>())) {</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AI != &amp;OldAI &amp;&amp; AI != &amp;NewAI &amp;&amp;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;             <span class="stringliteral">&quot;Splittable transfers cannot reach the same alloca on both ends.&quot;</span>);</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      <a class="code" href="classllvm_1_1Pass.html">Pass</a>.Worklist.insert(AI);</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    }</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160; </div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *OtherPtrTy = OtherPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="keywordtype">unsigned</span> OtherAS = OtherPtrTy-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160; </div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;    <span class="comment">// Compute the relative offset for the other pointer within the transfer.</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    <span class="keywordtype">unsigned</span> OffsetWidth = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(OtherAS);</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> OtherOffset(OffsetWidth, NewBeginOffset - BeginOffset);</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;    <a class="code" href="structllvm_1_1Align.html">Align</a> OtherAlign =</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        (IsDest ? II.<a class="code" href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">getSourceAlign</a>() : II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">getDestAlign</a>()).valueOrOne();</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;    OtherAlign =</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(OtherAlign, OtherOffset.zextOrTrunc(64).getZExtValue());</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;    <span class="keywordflow">if</span> (EmitMemCpy) {</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      <span class="comment">// Compute the other pointer, folding as much as possible to produce</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      <span class="comment">// a single, simple GEP in most cases.</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      OtherPtr = <a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRB, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, OtherPtr, OtherOffset, OtherPtrTy,</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;                                OtherPtr-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160; </div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *OurPtr = getNewAllocaSlicePtr(IRB, OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      <a class="code" href="classllvm_1_1Type.html">Type</a> *SizeTy = II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      <a class="code" href="classllvm_1_1Constant.html">Constant</a> *<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(SizeTy, NewEndOffset - NewBeginOffset);</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160; </div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *DestPtr, *SrcPtr;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> DestAlign, SrcAlign;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;      <span class="comment">// Note: IsDest is true iff we&#39;re copying into the new alloca slice</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      <span class="keywordflow">if</span> (IsDest) {</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        DestPtr = OurPtr;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;        DestAlign = SliceAlign;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;        SrcPtr = OtherPtr;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;        SrcAlign = OtherAlign;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        DestPtr = OtherPtr;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        DestAlign = OtherAlign;</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        SrcPtr = OurPtr;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;        SrcAlign = SliceAlign;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;      }</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = IRB.CreateMemCpy(DestPtr, DestAlign, SrcPtr, SrcAlign,</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                                       <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>());</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160; </div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexTypeSizeInBits(DestPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), 0);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      <span class="keywordflow">if</span> (IsDest) {</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        migrateDebugInfo(&amp;OldAI, IsSplit, NewBeginOffset * 8, SliceSize * 8,</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;                         &amp;II, New, DestPtr, <span class="keyword">nullptr</span>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = dyn_cast&lt;AllocaInst&gt;(</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;                     DestPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a4c539f826d954ab3bd78cdb0882540bd">stripAndAccumulateConstantOffsets</a>(</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;                         <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="comment">/*AllowNonInbounds*/</span> <span class="keyword">true</span>))) {</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;        migrateDebugInfo(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, IsSplit, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>.getZExtValue() * 8,</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                         SliceSize * 8, &amp;II, New, DestPtr, <span class="keyword">nullptr</span>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;      }</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *New &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160; </div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    <span class="keywordtype">bool</span> IsWholeAlloca = NewBeginOffset == NewAllocaBeginOffset &amp;&amp;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                         NewEndOffset == NewAllocaEndOffset;</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = NewEndOffset - NewBeginOffset;</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <span class="keywordtype">unsigned</span> BeginIndex = VecTy ? getIndex(NewBeginOffset) : 0;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    <span class="keywordtype">unsigned</span> EndIndex = VecTy ? getIndex(NewEndOffset) : 0;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <span class="keywordtype">unsigned</span> NumElements = EndIndex - BeginIndex;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *SubIntTy =</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;        IntTy ? Type::getIntNTy(IntTy-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> * 8) : nullptr;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160; </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="comment">// Reset the other pointer type to match the register type we&#39;re going to</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    <span class="comment">// use, but using the address space of the original other pointer.</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *OtherTy;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    <span class="keywordflow">if</span> (VecTy &amp;&amp; !IsWholeAlloca) {</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      <span class="keywordflow">if</span> (NumElements == 1)</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        OtherTy = VecTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>();</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        OtherTy = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">FixedVectorType::get</a>(VecTy-&gt;<a class="code" href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">getElementType</a>(), NumElements);</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IntTy &amp;&amp; !IsWholeAlloca) {</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      OtherTy = SubIntTy;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      OtherTy = NewAllocaTy;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    }</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    OtherPtrTy = OtherTy-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(OtherAS);</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *AdjPtr = <a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRB, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, OtherPtr, OtherOffset, OtherPtrTy,</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;                                   OtherPtr-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> SrcAlign = OtherAlign;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> DstAlign = SliceAlign;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="keywordflow">if</span> (!IsDest)</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcAlign, DstAlign);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160; </div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcPtr;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *DstPtr;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160; </div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    <span class="keywordflow">if</span> (IsDest) {</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      DstPtr = getPtrToNewAI(II.<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ad118358d398f591303b00c2e5462e3a9">getDestAddressSpace</a>(), II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>());</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      SrcPtr = AdjPtr;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;      DstPtr = AdjPtr;</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      SrcPtr = getPtrToNewAI(II.<a class="code" href="classllvm_1_1MemTransferBase.html#aa4905f44616de7dcca8ce3d51685a60b">getSourceAddressSpace</a>(), II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>());</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    }</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160; </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Src;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="keywordflow">if</span> (VecTy &amp;&amp; !IsWholeAlloca &amp;&amp; !IsDest) {</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      Src = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                                  NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;load&quot;</span>);</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      Src = <a class="code" href="SROA_8cpp.html#a06a9071efa992145e210f0b41a52e501">extractVector</a>(IRB, Src, BeginIndex, EndIndex, <span class="stringliteral">&quot;vec&quot;</span>);</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IntTy &amp;&amp; !IsWholeAlloca &amp;&amp; !IsDest) {</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      Src = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                                  NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;load&quot;</span>);</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      Src = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Src, IntTy);</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = NewBeginOffset - NewAllocaBeginOffset;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      Src = <a class="code" href="SROA_8cpp.html#a94e7aca18fb08798727209385f164f7c">extractInteger</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Src, SubIntTy, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="stringliteral">&quot;extract&quot;</span>);</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = IRB.CreateAlignedLoad(OtherTy, SrcPtr, SrcAlign,</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;                                             II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>(), <span class="stringliteral">&quot;copyload&quot;</span>);</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;copyMetadata(II, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;                              LLVMContext::MD_access_group});</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      Src = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    }</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160; </div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    <span class="keywordflow">if</span> (VecTy &amp;&amp; !IsWholeAlloca &amp;&amp; IsDest) {</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Old = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                                         NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;oldload&quot;</span>);</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      Src = <a class="code" href="SROA_8cpp.html#a42c6a2faff923f431932c6d33cf4092b">insertVector</a>(IRB, Old, Src, BeginIndex, <span class="stringliteral">&quot;vec&quot;</span>);</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IntTy &amp;&amp; !IsWholeAlloca &amp;&amp; IsDest) {</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Old = IRB.CreateAlignedLoad(NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(), &amp;NewAI,</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;                                         NewAI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <span class="stringliteral">&quot;oldload&quot;</span>);</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      Old = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Old, IntTy);</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = NewBeginOffset - NewAllocaBeginOffset;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;      Src = <a class="code" href="SROA_8cpp.html#a7febebe786555d6e0d07ca0f86e294c1">insertInteger</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Old, Src, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="stringliteral">&quot;insert&quot;</span>);</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;      Src = <a class="code" href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB, Src, NewAllocaTy);</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    }</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160; </div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = cast&lt;StoreInst&gt;(</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        IRB.CreateAlignedStore(Src, DstPtr, DstAlign, II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>()));</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;copyMetadata(II, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;                             LLVMContext::MD_access_group});</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;    <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(NewBeginOffset - BeginOffset));</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160; </div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;    <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexTypeSizeInBits(DstPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), 0);</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;    <span class="keywordflow">if</span> (IsDest) {</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160; </div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      migrateDebugInfo(&amp;OldAI, IsSplit, NewBeginOffset * 8, SliceSize * 8, &amp;II,</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                       <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>, DstPtr, Src, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = dyn_cast&lt;AllocaInst&gt;(</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                   DstPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a4c539f826d954ab3bd78cdb0882540bd">stripAndAccumulateConstantOffsets</a>(</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;                       <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>, <span class="comment">/*AllowNonInbounds*/</span> <span class="keyword">true</span>))) {</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;      migrateDebugInfo(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, IsSplit, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>.getZExtValue() * 8, SliceSize * 8,</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                       &amp;II, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>, DstPtr, Src, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    }</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160; </div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <span class="keywordflow">return</span> !II.<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>();</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  }</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160; </div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  <span class="keywordtype">bool</span> visitIntrinsicInst(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> &amp;II) {</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((II.<a class="code" href="classllvm_1_1Instruction.html#a185bafe1e8f07def76a3bac154a23e7a">isLifetimeStartOrEnd</a>() || II.<a class="code" href="classllvm_1_1User.html#af6a49991304b167c94f4a9756d3fd48f">isDroppable</a>()) &amp;&amp;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;           <span class="stringliteral">&quot;Unexpected intrinsic!&quot;</span>);</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; II &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160; </div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <span class="comment">// Record this instruction for deletion.</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    <a class="code" href="classllvm_1_1Pass.html">Pass</a>.DeadInsts.push_back(&amp;II);</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160; </div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1User.html#af6a49991304b167c94f4a9756d3fd48f">isDroppable</a>()) {</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::assume &amp;&amp; <span class="stringliteral">&quot;Expected assume&quot;</span>);</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;      <span class="comment">// TODO For now we forget assumed information, this can be improved.</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a731895a3f577718bbaec9b180eb2a6bb">dropDroppableUsesIn</a>(II);</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;    }</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; </div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1) == OldPtr);</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    <span class="comment">// Lifetime intrinsics are only promotable if they cover the whole alloca.</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <span class="comment">// Therefore, we drop lifetime intrinsics which don&#39;t cover the whole</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    <span class="comment">// alloca.</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    <span class="comment">// (In theory, intrinsics which partially cover an alloca could be</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    <span class="comment">// promoted, but PromoteMemToReg doesn&#39;t handle that case.)</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    <span class="comment">// FIXME: Check whether the alloca is promotable before dropping the</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <span class="comment">// lifetime intrinsics?</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    <span class="keywordflow">if</span> (NewBeginOffset != NewAllocaBeginOffset ||</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        NewEndOffset != NewAllocaEndOffset)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160; </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> =</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(cast&lt;IntegerType&gt;(II.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0)-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()),</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                         NewEndOffset - NewBeginOffset);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    <span class="comment">// Lifetime intrinsics always expect an i8* so directly get such a pointer</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    <span class="comment">// for the new alloca slice.</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">PointerTy</a> = IRB.<a class="code" href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">getInt8PtrTy</a>(OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>());</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = getNewAllocaSlicePtr(IRB, <a class="code" href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">PointerTy</a>);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a>;</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <span class="keywordflow">if</span> (II.<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>() == Intrinsic::lifetime_start)</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = IRB.CreateLifetimeStart(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <a class="code" href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">New</a> = IRB.CreateLifetimeEnd(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160; </div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    (void)New;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *New &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; </div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  }</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160; </div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  <span class="keywordtype">void</span> fixLoadStoreAlign(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Root) {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="comment">// This algorithm implements the same visitor loop as</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="comment">// hasUnsafePHIOrSelectUse, and fixes the alignment of each load</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    <span class="comment">// or store found.</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;Instruction *, 4&gt;</a> Visited;</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 4&gt;</a> <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>;</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(&amp;Root);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.push_back(&amp;Root);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.pop_back_val();</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160; </div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2b1268b642e9bf4373b6fb31c482c9ca">setAlignment</a>(<a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(), getSliceAlign()));</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;setAlignment(<a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign(), getSliceAlign()));</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      }</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160; </div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;BitCastInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;AddrSpaceCastInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) ||</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;             isa&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || isa&lt;SelectInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) ||</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;             isa&lt;GetElementPtrInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;users())</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        <span class="keywordflow">if</span> (Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(cast&lt;Instruction&gt;(U)).second)</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;          <a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.push_back(cast&lt;Instruction&gt;(U));</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    } <span class="keywordflow">while</span> (!<a class="code" href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a>.empty());</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;  }</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160; </div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  <span class="keywordtype">bool</span> visitPHINode(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; PN &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BeginOffset &gt;= NewAllocaBeginOffset &amp;&amp; <span class="stringliteral">&quot;PHIs are unsplittable&quot;</span>);</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndOffset &lt;= NewAllocaEndOffset &amp;&amp; <span class="stringliteral">&quot;PHIs are unsplittable&quot;</span>);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160; </div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    <span class="comment">// We would like to compute a new pointer in only one place, but have it be</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="comment">// as local as possible to the PHI. To do that, we re-use the location of</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <span class="comment">// the old pointer, which necessarily must be in the right position to</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    <span class="comment">// dominate the PHI.</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    <a class="code" href="classllvm_1_1IRBuilderBase_1_1InsertPointGuard.html">IRBuilderBase::InsertPointGuard</a> Guard(IRB);</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(OldPtr))</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      IRB.SetInsertPoint(&amp;*OldPtr-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      IRB.SetInsertPoint(OldPtr);</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    IRB.SetCurrentDebugLocation(OldPtr-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160; </div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewPtr = getNewAllocaSlicePtr(IRB, OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    <span class="comment">// Replace the operands which were using the old pointer.</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <a class="code" href="ConstantMerge_8cpp.html#acf172e841018fd16e65771f5ade0b297">std::replace</a>(PN.<a class="code" href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">op_begin</a>(), PN.<a class="code" href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">op_end</a>(), cast&lt;Value&gt;(OldPtr), NewPtr);</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160; </div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; PN &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;    deleteIfTriviallyDead(OldPtr);</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160; </div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    <span class="comment">// Fix the alignment of any loads or stores using this PHI node.</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    fixLoadStoreAlign(PN);</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160; </div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <span class="comment">// PHIs can&#39;t be promoted on their own, but often can be speculated. We</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    <span class="comment">// check the speculation outside of the rewriter so that we see the</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <span class="comment">// fully-rewritten alloca.</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    PHIUsers.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(&amp;PN);</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;  }</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160; </div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  <span class="keywordtype">bool</span> visitSelectInst(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getTrueValue() == OldPtr || <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getFalseValue() == OldPtr) &amp;&amp;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;           <span class="stringliteral">&quot;Pointer isn&#39;t an operand!&quot;</span>);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BeginOffset &gt;= NewAllocaBeginOffset &amp;&amp; <span class="stringliteral">&quot;Selects are unsplittable&quot;</span>);</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EndOffset &lt;= NewAllocaEndOffset &amp;&amp; <span class="stringliteral">&quot;Selects are unsplittable&quot;</span>);</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160; </div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewPtr = getNewAllocaSlicePtr(IRB, OldPtr-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    <span class="comment">// Replace the operands which were using the old pointer.</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(1) == OldPtr)</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.setOperand(1, NewPtr);</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getOperand(2) == OldPtr)</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;      <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.setOperand(2, NewPtr);</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160; </div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    deleteIfTriviallyDead(OldPtr);</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160; </div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;    <span class="comment">// Fix the alignment of any loads or stores using this select.</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    fixLoadStoreAlign(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160; </div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    <span class="comment">// Selects can&#39;t be promoted on their own, but often can be speculated. We</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    <span class="comment">// check the speculation outside of the rewriter so that we see the</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    <span class="comment">// fully-rewritten alloca.</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    SelectUsers.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;  }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;};</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160; </div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="comment">/// Visitor to rewrite aggregate loads and stores as scalar.</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="comment">/// This pass aggressively rewrites all aggregate loads and stores on</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="comment">/// a particular pointer (or any pointer derived from it which we can identify)</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="comment">/// with scalar loads and stores.</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="comment"></span><span class="keyword">class </span>AggLoadStoreRewriter : <span class="keyword">public</span> <a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor</a>&lt;AggLoadStoreRewriter, bool&gt; {</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;  <span class="comment">// Befriend the base class so it can delegate to private visit methods.</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classllvm_1_1InstVisitor.html">InstVisitor</a>&lt;AggLoadStoreRewriter, bool&gt;;</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="comment">  /// Queue of pointer uses to analyze and potentially rewrite.</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Use *, 8&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD.html#a85803b71729d5d098ca2099f23cbf72ea722ad2d05ecf4868b00c5484b82fd808">Queue</a>;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="comment">  /// Set to prevent us from cycling with phi nodes and loops.</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;User *, 8&gt;</a> Visited;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;<span class="comment">  /// The current pointer use being rewritten. This is used to dig up the used</span></div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;<span class="comment">  /// value (as opposed to the user).</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Use.html">Use</a> *U = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="comment">  /// Used to calculate offsets, and hence alignment, of subobjects.</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160; </div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  IRBuilderTy &amp;IRB;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160; </div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;  AggLoadStoreRewriter(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRBuilderTy &amp;IRB)</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      : <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), IRB(IRB) {}</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="comment">  /// Rewrite loads and stores through a pointer and all pointers derived from</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="comment">  /// it.</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="PoisonChecking_8cpp.html#a702ebb77e7ff7f0a10a1b4690d8ecfc8">rewrite</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Rewriting FCA loads and stores...\n&quot;</span>);</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    enqueueUsers(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD.html#a85803b71729d5d098ca2099f23cbf72ea722ad2d05ecf4868b00c5484b82fd808">Queue</a>.empty()) {</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;      U = <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD.html#a85803b71729d5d098ca2099f23cbf72ea722ad2d05ecf4868b00c5484b82fd808">Queue</a>.pop_back_val();</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;      Changed |= visit(cast&lt;Instruction&gt;(U-&gt;getUser()));</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    }</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  }</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160; </div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;<span class="comment">  /// Enqueue all the users of the given instruction for further processing.</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;<span class="comment">  /// This uses a set to de-duplicate users.</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> enqueueUsers(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.uses())</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      <span class="keywordflow">if</span> (Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>()).second)</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;        <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD.html#a85803b71729d5d098ca2099f23cbf72ea722ad2d05ecf4868b00c5484b82fd808">Queue</a>.push_back(&amp;U);</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;  }</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160; </div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  <span class="comment">// Conservative default is to not rewrite anything.</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  <span class="keywordtype">bool</span> visitInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="comment">  /// Generic recursive split emission class.</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="comment"></span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Derived&gt; <span class="keyword">class </span>OpSplitter {</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="comment">    /// The builder used to form new instructions.</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment"></span>    IRBuilderTy &amp;IRB;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">    /// The indices which to be used with insert- or extractvalue to select the</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="comment">    /// appropriate value within the aggregate.</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;unsigned, 4&gt;</a> Indices;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;<span class="comment">    /// The indices to a GEP instruction which will move Ptr to the correct slot</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="comment">    /// within the aggregate.</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> GEPIndices;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="comment">    /// The base pointer of the original op, used as a base for GEPing the</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment">    /// split operations.</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;<span class="comment">    /// The base pointee type being GEPed into.</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="comment"></span>    <a class="code" href="classllvm_1_1Type.html">Type</a> *BaseTy;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="comment">    /// Known alignment of the base pointer.</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;<span class="comment"></span>    <a class="code" href="structllvm_1_1Align.html">Align</a> BaseAlign;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="comment">    /// To calculate offset of each component so we can correctly deduce</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="comment">    /// alignments.</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="comment">    /// Initialize the splitter with an insertion point, Ptr and start with a</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="comment">    /// single zero GEP index.</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="comment"></span>    OpSplitter(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertionPoint, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *BaseTy,</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;               <a class="code" href="structllvm_1_1Align.html">Align</a> BaseAlign, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRBuilderTy &amp;IRB)</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;        : IRB(IRB), GEPIndices(1, IRB.getInt32(0)), <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>), BaseTy(BaseTy),</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;          BaseAlign(BaseAlign), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      IRB.SetInsertPoint(InsertionPoint);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    }</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160; </div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment">    /// Generic recursive split emission routine.</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment">    ///</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="comment">    /// This method recursively splits an aggregate op (load or store) into</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="comment">    /// scalar or vector ops. It splits recursively until it hits a single value</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="comment">    /// and emits that single value operation via the template argument.</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="comment">    ///</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="comment">    /// The logic of this routine relies on GEPs and insertvalue and</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="comment">    /// extractvalue all operating with the same fundamental index list, merely</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="comment">    /// formatted differently (GEPs need actual values).</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">    ///</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">    /// \param Ty  The type being split recursively into smaller ops.</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="comment">    /// \param Agg The aggregate value being built up or stored, depending on</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment">    /// whether this is splitting a load or a store respectively.</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> emitSplitOps(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Agg, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Name) {</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>()) {</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexedOffsetInType(BaseTy, GEPIndices);</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>Derived *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;emitFunc(</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            Ty, Agg, <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(BaseAlign, Offset), <a class="code" href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>);</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;      }</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160; </div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ArrayType.html">ArrayType</a> *ATy = dyn_cast&lt;ArrayType&gt;(Ty)) {</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        <span class="keywordtype">unsigned</span> OldSize = Indices.size();</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        (void)OldSize;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, Size = ATy-&gt;getNumElements(); Idx != <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;             ++Idx) {</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Indices.size() == OldSize &amp;&amp; <span class="stringliteral">&quot;Did not return to the old size&quot;</span>);</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;          Indices.push_back(Idx);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;          GEPIndices.push_back(IRB.getInt32(Idx));</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;          emitSplitOps(ATy-&gt;getElementType(), Agg, Name + <span class="stringliteral">&quot;.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(Idx));</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;          GEPIndices.pop_back();</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;          Indices.pop_back();</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;        }</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;      }</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160; </div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StructType.html">StructType</a> *STy = dyn_cast&lt;StructType&gt;(Ty)) {</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        <span class="keywordtype">unsigned</span> OldSize = Indices.size();</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        (void)OldSize;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0, Size = STy-&gt;getNumElements(); Idx != <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;             ++Idx) {</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Indices.size() == OldSize &amp;&amp; <span class="stringliteral">&quot;Did not return to the old size&quot;</span>);</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;          Indices.push_back(Idx);</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;          GEPIndices.push_back(IRB.getInt32(Idx));</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;          emitSplitOps(STy-&gt;getElementType(Idx), Agg, Name + <span class="stringliteral">&quot;.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(Idx));</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;          GEPIndices.pop_back();</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;          Indices.pop_back();</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        }</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;      }</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160; </div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Only arrays and structs are aggregate loadable types&quot;</span>);</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;  };</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160; </div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;  <span class="keyword">struct </span>LoadOpSplitter : <span class="keyword">public</span> OpSplitter&lt;LoadOpSplitter&gt; {</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160; </div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    LoadOpSplitter(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertionPoint, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *BaseTy,</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                   <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags, <a class="code" href="structllvm_1_1Align.html">Align</a> BaseAlign, <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                   IRBuilderTy &amp;IRB)</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        : OpSplitter&lt;LoadOpSplitter&gt;(InsertionPoint, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, BaseTy, BaseAlign, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;                                     IRB),</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;          AATags(AATags) {}</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="comment">    /// Emit a leaf load of a single value. This is called at the leaves of the</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="comment">    /// recursive emission to actually load values.</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> emitFunc(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Agg, <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Name) {</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>());</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;      <span class="comment">// Load the single value and insert it using the indices.</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> =</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;          IRB.CreateInBoundsGEP(BaseTy, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, GEPIndices, Name + <span class="stringliteral">&quot;.gep&quot;</span>);</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> =</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;          IRB.CreateAlignedLoad(Ty, <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>, Alignment, Name + <span class="stringliteral">&quot;.load&quot;</span>);</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160; </div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>(</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;          <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType()-&gt;getPointerAddressSpace()), 0);</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      <span class="keywordflow">if</span> (AATags &amp;&amp;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;          GEPOperator::accumulateConstantOffset(BaseTy, GEPIndices, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, Offset))</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;        <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.getZExtValue()));</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160; </div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      Agg = IRB.CreateInsertValue(Agg, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, Indices, Name + <span class="stringliteral">&quot;.insert&quot;</span>);</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    }</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  };</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160; </div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;  <span class="keywordtype">bool</span> visitLoadInst(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> &amp;LI) {</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI.<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>() == *U);</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="keywordflow">if</span> (!LI.<a class="code" href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">isSimple</a>() || LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>())</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160; </div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    <span class="comment">// We have an aggregate being loaded, split it apart.</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; LI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    LoadOpSplitter Splitter(&amp;LI, *U, LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), LI.<a class="code" href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">getAAMetadata</a>(),</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                            <a class="code" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a>(&amp;LI, 0), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB);</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">PoisonValue::get</a>(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    Splitter.emitSplitOps(LI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), V, LI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.fca&quot;</span>);</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(&amp;LI);</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    LI.<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(V);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    LI.<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;  }</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160; </div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  <span class="keyword">struct </span>StoreOpSplitter : <span class="keyword">public</span> OpSplitter&lt;StoreOpSplitter&gt; {</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    StoreOpSplitter(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertionPoint, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *BaseTy,</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *AggStore, <a class="code" href="structllvm_1_1Align.html">Align</a> BaseAlign,</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRBuilderTy &amp;IRB)</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;        : OpSplitter&lt;StoreOpSplitter&gt;(InsertionPoint, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, BaseTy, BaseAlign,</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                                      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB),</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;          AATags(AATags), AggStore(AggStore) {}</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    <a class="code" href="structllvm_1_1AAMDNodes.html">AAMDNodes</a> AATags;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *AggStore;<span class="comment"></span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;<span class="comment">    /// Emit a leaf store of a single value. This is called at the leaves of the</span></div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;<span class="comment">    /// recursive emission to actually produce stores.</span></div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> emitFunc(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty, <a class="code" href="classllvm_1_1Value.html">Value</a> *&amp;Agg, <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Twine.html">Twine</a> &amp;Name) {</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>());</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      <span class="comment">// Extract the single value and store it using the indices.</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      <span class="comment">// The gep and extractvalue values are factored out of the CreateStore</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;      <span class="comment">// call to make the output independent of the argument evaluation order.</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *ExtractValue =</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;          IRB.CreateExtractValue(Agg, Indices, Name + <span class="stringliteral">&quot;.extract&quot;</span>);</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *InBoundsGEP =</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;          IRB.CreateInBoundsGEP(BaseTy, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, GEPIndices, Name + <span class="stringliteral">&quot;.gep&quot;</span>);</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> =</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;          IRB.CreateAlignedStore(ExtractValue, InBoundsGEP, Alignment);</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160; </div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      <a class="code" href="classllvm_1_1APInt.html">APInt</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>(</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;          <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType()-&gt;getPointerAddressSpace()), 0);</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      GEPOperator::accumulateConstantOffset(BaseTy, GEPIndices, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, Offset);</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      <span class="keywordflow">if</span> (AATags)</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;        <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;setAAMetadata(AATags.<a class="code" href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">shift</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.getZExtValue()));</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160; </div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;      <span class="comment">// migrateDebugInfo requires the base Alloca. Walk to it from this gep.</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      <span class="comment">// If we cannot (because there&#39;s an intervening non-const or unbounded</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="comment">// gep) then we wouldn&#39;t expect to see dbg.assign intrinsics linked to</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;      <span class="comment">// this instruction.</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = AggStore-&gt;<a class="code" href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">getPointerOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a3ed745230c0e6c52f4b1ec0dae8c07fb">stripInBoundsOffsets</a>();</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *OldAI = dyn_cast&lt;AllocaInst&gt;(Base)) {</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SizeInBits =</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;            <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;getValueOperand()-&gt;getType());</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        migrateDebugInfo(OldAI, <span class="comment">/*IsSplit*/</span> <span class="keyword">true</span>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.getZExtValue() * 8,</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                         SizeInBits, AggStore, <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>,</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                         <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;getPointerOperand(), <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>-&gt;getValueOperand(),</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                         <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1at.html#a3c90899e8f022656e511630de42b916c">at::getAssignmentMarkers</a>(<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>).empty() &amp;&amp;</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;               <span class="stringliteral">&quot;AT: unexpected debug.assign linked to store through &quot;</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;               <span class="stringliteral">&quot;unbounded GEP&quot;</span>);</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      }</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          to: &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    }</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;  };</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160; </div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;  <span class="keywordtype">bool</span> visitStoreInst(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.isSimple() || <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getPointerOperand() != *U)</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *V = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getValueOperand();</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;    <span class="keywordflow">if</span> (V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>())</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160; </div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    <span class="comment">// We have an aggregate being stored, split it apart.</span></div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    original: &quot;</span> &lt;&lt; <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    StoreOpSplitter Splitter(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, *U, V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.getAAMetadata(), &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>,</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                             <a class="code" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a>(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, 0), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB);</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    Splitter.emitSplitOps(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), V, V-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.fca&quot;</span>);</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    <span class="comment">// The stores replacing SI each have markers describing fragments of the</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    <span class="comment">// assignment so delete the assignment markers linked to SI.</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;    <a class="code" href="namespacellvm_1_1at.html#acac0a0a393ce41aadc29e623549b6bfa">at::deleteAssignmentMarkers</a>(&amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>.eraseFromParent();</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;  }</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160; </div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;  <span class="keywordtype">bool</span> visitBitCastInst(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> &amp;BC) {</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    enqueueUsers(BC);</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  }</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160; </div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;  <span class="keywordtype">bool</span> visitAddrSpaceCastInst(<a class="code" href="classllvm_1_1AddrSpaceCastInst.html">AddrSpaceCastInst</a> &amp;ASC) {</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    enqueueUsers(ASC);</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;  }</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160; </div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  <span class="comment">// Fold gep (select cond, ptr1, ptr2) =&gt; select cond, gep(ptr1), gep(ptr2)</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;  <span class="keywordtype">bool</span> foldGEPSelect(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;GEPI) {</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    <span class="keywordflow">if</span> (!GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a47fef2802996b78f0530c9b77abca9ed">hasAllConstantIndices</a>())</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160; </div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *Sel = cast&lt;SelectInst&gt;(GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>());</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160; </div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Rewriting gep(select) -&gt; select(gep):&quot;</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n    original: &quot;</span> &lt;&lt; *Sel</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n              &quot;</span> &lt;&lt; GEPI);</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160; </div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    IRB.SetInsertPoint(&amp;GEPI);</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>(GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a9b8a0a23f493d9796c5887dbbe1905e9">indices</a>());</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    <span class="keywordtype">bool</span> IsInBounds = GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a01f11934ce1bac24a7c9190d14686844">isInBounds</a>();</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160; </div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a565374c44dbf08e54528a87448e10df5">getSourceElementType</a>();</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *True = Sel-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a483700f6bf3ac62445850d768cf188f6">getTrueValue</a>();</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NTrue = IRB.CreateGEP(Ty, True, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, True-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.gep&quot;</span>,</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                                 IsInBounds);</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160; </div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *False = Sel-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a59b0ee738ec17984b97128e7f1594db3">getFalseValue</a>();</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160; </div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NFalse = IRB.CreateGEP(Ty, False, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>,</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                                  False-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.gep&quot;</span>, IsInBounds);</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160; </div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NSel = IRB.CreateSelect(Sel-&gt;<a class="code" href="classllvm_1_1SelectInst.html#a93a29cd4a753518a59c20c1b6ec88c76">getCondition</a>(), NTrue, NFalse,</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;                                   Sel-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.sel&quot;</span>);</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(&amp;GEPI);</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;    GEPI.<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NSel);</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    GEPI.<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NSelI = cast&lt;Instruction&gt;(NSel);</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(NSelI);</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    enqueueUsers(*NSelI);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160; </div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n          to: &quot;</span> &lt;&lt; *NTrue</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n              &quot;</span> &lt;&lt; *NFalse</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n              &quot;</span> &lt;&lt; *NSel &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160; </div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;  }</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160; </div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;  <span class="comment">// Fold gep (phi ptr1, ptr2) =&gt; phi gep(ptr1), gep(ptr2)</span></div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;  <span class="keywordtype">bool</span> foldGEPPhi(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;GEPI) {</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    <span class="keywordflow">if</span> (!GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a47fef2802996b78f0530c9b77abca9ed">hasAllConstantIndices</a>())</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160; </div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = cast&lt;PHINode&gt;(GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>());</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    <span class="keywordflow">if</span> (GEPI.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getParent() ||</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a>(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;incoming_values(), [](<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>)</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;          { Instruction *I = dyn_cast&lt;Instruction&gt;(In);</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;            return !I || isa&lt;GetElementPtrInst&gt;(I) || isa&lt;PHINode&gt;(I) ||</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;                   succ_empty(I-&gt;getParent()) ||</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;                   !I-&gt;getParent()-&gt;isLegalToHoistInto();</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;          }))</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160; </div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Rewriting gep(phi) -&gt; phi(gep):&quot;</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n    original: &quot;</span> &lt;&lt; *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n              &quot;</span> &lt;&lt; GEPI</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;\n          to: &quot;</span>);</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160; </div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Value *, 4&gt;</a> <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>(GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a9b8a0a23f493d9796c5887dbbe1905e9">indices</a>());</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    <span class="keywordtype">bool</span> IsInBounds = GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a01f11934ce1bac24a7c9190d14686844">isInBounds</a>();</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    IRB.SetInsertPoint(GEPI.<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">getFirstNonPHI</a>());</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    <a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *NewPN = IRB.CreatePHI(GEPI.<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(), <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getNumIncomingValues(),</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;                                   <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getName() + <span class="stringliteral">&quot;.sroa.phi&quot;</span>);</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getNumIncomingValues(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> = <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getIncomingBlock(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *NewVal = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      <span class="keywordtype">int</span> Idx = NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#ae9562b96f6f3fa41bd36538c080035ee">getBasicBlockIndex</a>(<a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= 0) {</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;        NewVal = NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(Idx);</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> = cast&lt;Instruction&gt;(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;getIncomingValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160; </div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;        IRB.SetInsertPoint(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>-&gt;getParent(), std::next(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>-&gt;getIterator()));</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty = GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#a565374c44dbf08e54528a87448e10df5">getSourceElementType</a>();</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;        NewVal = IRB.CreateGEP(Ty, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>-&gt;getName() + <span class="stringliteral">&quot;.sroa.gep&quot;</span>,</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;                               IsInBounds);</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;      }</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewVal, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    }</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160; </div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">erase</a>(&amp;GEPI);</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    GEPI.<a class="code" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewPN);</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    GEPI.<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    Visited.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(NewPN);</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    enqueueUsers(*NewPN);</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160; </div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a> : NewPN-&gt;<a class="code" href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">incoming_values</a>())</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;                 <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n              &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">In</a>;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;               <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n              &quot;</span> &lt;&lt; *NewPN &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160; </div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;  }</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160; </div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;  <span class="keywordtype">bool</span> visitGetElementPtrInst(<a class="code" href="classllvm_1_1GetElementPtrInst.html">GetElementPtrInst</a> &amp;GEPI) {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;    <span class="keywordflow">if</span> (isa&lt;SelectInst&gt;(GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>()) &amp;&amp;</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        foldGEPSelect(GEPI))</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160; </div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(GEPI.<a class="code" href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">getPointerOperand</a>()) &amp;&amp;</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        foldGEPPhi(GEPI))</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160; </div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;    enqueueUsers(GEPI);</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;  }</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160; </div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;  <span class="keywordtype">bool</span> visitPHINode(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN) {</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;    enqueueUsers(PN);</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;  }</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160; </div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;  <span class="keywordtype">bool</span> visitSelectInst(<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;    enqueueUsers(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;  }</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;};</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160; </div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment">/// Strip aggregate type wrapping.</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="comment">/// This removes no-op aggregate types wrapping an underlying type. It will</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="comment">/// strip as many layers of types as it can without changing either the type</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;<span class="comment">/// size or the allocated size.</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#ac102ff32dace1cf8e8e6f9c9ec4d159c"> 3813</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="SROA_8cpp.html#ac102ff32dace1cf8e8e6f9c9ec4d159c">stripAggregateTypeWrapping</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;  <span class="keywordflow">if</span> (Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">isSingleValueType</a>())</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    <span class="keywordflow">return</span> Ty;</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160; </div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AllocSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Ty).getFixedValue();</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(Ty).getFixedValue();</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160; </div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *InnerTy;</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1ArrayType.html">ArrayType</a> *ArrTy = dyn_cast&lt;ArrayType&gt;(Ty)) {</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    InnerTy = ArrTy-&gt;getElementType();</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1StructType.html">StructType</a> *STy = dyn_cast&lt;StructType&gt;(Ty)) {</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1StructLayout.html">StructLayout</a> *SL = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getStructLayout(STy);</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#afd6747ed8aad307a0a99f1fdcdadb30c">getElementContainingOffset</a>(0);</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    InnerTy = STy-&gt;getElementType(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    <span class="keywordflow">return</span> Ty;</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;  }</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160; </div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  <span class="keywordflow">if</span> (AllocSize &gt; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(InnerTy).getFixedValue() ||</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;      <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> &gt; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(InnerTy).getFixedValue())</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;    <span class="keywordflow">return</span> Ty;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160; </div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#ac102ff32dace1cf8e8e6f9c9ec4d159c">stripAggregateTypeWrapping</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, InnerTy);</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;}</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="comment">/// Try to find a partition of the aggregate type passed in for a given</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="comment">/// offset and size.</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;<span class="comment">/// This recurses through the aggregate type and tries to compute a subtype</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="comment">/// based on the offset and size. When the offset and size span a sub-section</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;<span class="comment">/// of an array, it will even compute a new array type for that sub-section,</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="comment">/// and the same for structs.</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<span class="comment">/// Note that this routine is very strict and tries to find a partition of the</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;<span class="comment">/// type which produces the *exact* right offset and size. It is not forgiving</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;<span class="comment">/// when the size or offset cause either end of type-based partition to be off.</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;<span class="comment">/// Also, this is a best-effort routine. It is reasonable to give up and not</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;<span class="comment">/// return a type if necessary.</span></div>
<div class="line"><a name="l03851"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#abe75ff888b6a7ee2836aa6c8f33984c1"> 3851</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Type.html">Type</a> *<a class="code" href="SROA_8cpp.html#abe75ff888b6a7ee2836aa6c8f33984c1">getTypePartition</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="classllvm_1_1Type.html">Type</a> *Ty, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Offset,</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;                              <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Size) {</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;  <span class="keywordflow">if</span> (Offset == 0 &amp;&amp; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Ty).getFixedValue() == Size)</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#ac102ff32dace1cf8e8e6f9c9ec4d159c">stripAggregateTypeWrapping</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, Ty);</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  <span class="keywordflow">if</span> (Offset &gt; <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Ty).getFixedValue() ||</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Ty).getFixedValue() - Offset) &lt; Size)</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160; </div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ArrayType&gt;(Ty) || isa&lt;VectorType&gt;(Ty)) {</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;     <a class="code" href="classllvm_1_1Type.html">Type</a> *ElementTy;</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;     <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> TyNumElements;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;     <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AT = dyn_cast&lt;ArrayType&gt;(Ty)) {</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;       ElementTy = AT-&gt;getElementType();</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;       TyNumElements = AT-&gt;getNumElements();</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;       <span class="comment">// FIXME: This isn&#39;t right for vectors with non-byte-sized or</span></div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;       <span class="comment">// non-power-of-two sized elements.</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;       <span class="keyword">auto</span> *VT = cast&lt;FixedVectorType&gt;(Ty);</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;       ElementTy = VT-&gt;getElementType();</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;       TyNumElements = VT-&gt;getNumElements();</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    }</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ElementSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(ElementTy).getFixedValue();</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NumSkippedElements = Offset / ElementSize;</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    <span class="keywordflow">if</span> (NumSkippedElements &gt;= TyNumElements)</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    Offset -= NumSkippedElements * ElementSize;</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160; </div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    <span class="comment">// First check if we need to recurse.</span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    <span class="keywordflow">if</span> (Offset &gt; 0 || Size &lt; ElementSize) {</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;      <span class="comment">// Bail if the partition ends in a different array element.</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;      <span class="keywordflow">if</span> ((Offset + Size) &gt; ElementSize)</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;      <span class="comment">// Recurse through the element type trying to peel off offset bytes.</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#abe75ff888b6a7ee2836aa6c8f33984c1">getTypePartition</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ElementTy, Offset, Size);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;    }</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Offset == 0);</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160; </div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    <span class="keywordflow">if</span> (Size == ElementSize)</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#ac102ff32dace1cf8e8e6f9c9ec4d159c">stripAggregateTypeWrapping</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ElementTy);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Size &gt; ElementSize);</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> NumElements = Size / ElementSize;</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;    <span class="keywordflow">if</span> (NumElements * ElementSize != Size)</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ArrayType::get</a>(ElementTy, NumElements);</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;  }</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160; </div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  <a class="code" href="classllvm_1_1StructType.html">StructType</a> *STy = dyn_cast&lt;StructType&gt;(Ty);</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <span class="keywordflow">if</span> (!STy)</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160; </div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1StructLayout.html">StructLayout</a> *SL = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getStructLayout(STy);</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;  <span class="keywordflow">if</span> (Offset &gt;= SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a9a2e735016ef95989f3e8d26a684e19f">getSizeInBytes</a>())</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> EndOffset = Offset + Size;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;  <span class="keywordflow">if</span> (EndOffset &gt; SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a9a2e735016ef95989f3e8d26a684e19f">getSizeInBytes</a>())</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160; </div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#afd6747ed8aad307a0a99f1fdcdadb30c">getElementContainingOffset</a>(Offset);</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;  Offset -= SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a9b53bc4ade993c638837c1344465c1f8">getElementOffset</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160; </div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ElementTy = STy-&gt;<a class="code" href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">getElementType</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>);</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ElementSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(ElementTy).getFixedValue();</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;  <span class="keywordflow">if</span> (Offset &gt;= ElementSize)</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// The offset points into alignment padding.</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160; </div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;  <span class="comment">// See if any partition must be contained by the element.</span></div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;  <span class="keywordflow">if</span> (Offset &gt; 0 || Size &lt; ElementSize) {</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    <span class="keywordflow">if</span> ((Offset + Size) &gt; ElementSize)</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#abe75ff888b6a7ee2836aa6c8f33984c1">getTypePartition</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ElementTy, Offset, Size);</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;  }</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Offset == 0);</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160; </div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;  <span class="keywordflow">if</span> (Size == ElementSize)</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SROA_8cpp.html#ac102ff32dace1cf8e8e6f9c9ec4d159c">stripAggregateTypeWrapping</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, ElementTy);</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160; </div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;  <a class="code" href="classllvm_1_1StructType.html#aef631c67bbe94f9b5a7b9a1292bf225f">StructType::element_iterator</a> EI = STy-&gt;<a class="code" href="classllvm_1_1StructType.html#a69c7da4aea6df614c83c075aa246261a">element_begin</a>() + <a class="code" href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a>,</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;                               EE = STy-&gt;<a class="code" href="classllvm_1_1StructType.html#a1d854d7ca4568e7840af5520a9012960">element_end</a>();</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;  <span class="keywordflow">if</span> (EndOffset &lt; SL-&gt;<a class="code" href="MemoryOpRemark_8cpp.html#a110206dd9eebb2d47fcee764884d9941">getSizeInBytes</a>()) {</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;    <span class="keywordtype">unsigned</span> EndIndex = SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#afd6747ed8aad307a0a99f1fdcdadb30c">getElementContainingOffset</a>(EndOffset);</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> == EndIndex)</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// Within a single element and its padding.</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160; </div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    <span class="comment">// Don&#39;t try to form &quot;natural&quot; types if the elements don&#39;t line up with the</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;    <span class="comment">// expected size.</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    <span class="comment">// FIXME: We could potentially recurse down through the last element in the</span></div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;    <span class="comment">// sub-struct to find a natural end point.</span></div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;    <span class="keywordflow">if</span> (SL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a9b53bc4ade993c638837c1344465c1f8">getElementOffset</a>(EndIndex) != EndOffset)</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160; </div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> &lt; EndIndex);</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    EE = STy-&gt;<a class="code" href="classllvm_1_1StructType.html#a69c7da4aea6df614c83c075aa246261a">element_begin</a>() + EndIndex;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;  }</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160; </div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;  <span class="comment">// Try to build up a sub-structure.</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;  <a class="code" href="classllvm_1_1StructType.html">StructType</a> *SubTy =</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">StructType::get</a>(STy-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef</a>(EI, EE), STy-&gt;<a class="code" href="classllvm_1_1StructType.html#a84b61ef997688651dd4e06cb7567cfed">isPacked</a>());</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1StructLayout.html">StructLayout</a> *SubSL = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getStructLayout(SubTy);</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;  <span class="keywordflow">if</span> (Size != SubSL-&gt;<a class="code" href="classllvm_1_1StructLayout.html#a9a2e735016ef95989f3e8d26a684e19f">getSizeInBytes</a>())</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// The sub-struct doesn&#39;t have quite the size needed.</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160; </div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  <span class="keywordflow">return</span> SubTy;</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;}</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="comment">/// Pre-split loads and stores to simplify rewriting.</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="comment">/// We want to break up the splittable load+store pairs as much as</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;<span class="comment">/// possible. This is important to do as a preprocessing step, as once we</span></div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;<span class="comment">/// start rewriting the accesses to partitions of the alloca we lose the</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="comment">/// necessary information to correctly split apart paired loads and stores</span></div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="comment">/// which both point into this alloca. The case to consider is something like</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;<span class="comment">/// the following:</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;<span class="comment">///   %a = alloca [12 x i8]</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="comment">///   %gep1 = getelementptr i8, ptr %a, i32 0</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;<span class="comment">///   %gep2 = getelementptr i8, ptr %a, i32 4</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="comment">///   %gep3 = getelementptr i8, ptr %a, i32 8</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;<span class="comment">///   store float 0.0, ptr %gep1</span></div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;<span class="comment">///   store float 1.0, ptr %gep2</span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="comment">///   %v = load i64, ptr %gep1</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="comment">///   store i64 %v, ptr %gep2</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="comment">///   %f1 = load float, ptr %gep2</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="comment">///   %f2 = load float, ptr %gep3</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="comment">/// Here we want to form 3 partitions of the alloca, each 4 bytes large, and</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;<span class="comment">/// promote everything so we recover the 2 SSA values that should have been</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;<span class="comment">/// there all along.</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;<span class="comment">/// \returns true if any changes are made.</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SROAPass::presplitLoadsAndStores(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI, <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> &amp;AS) {</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Pre-splitting loads and stores\n&quot;</span>);</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160; </div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  <span class="comment">// Track the loads and stores which are candidates for pre-splitting here, in</span></div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;  <span class="comment">// the order they first appear during the partition scan. These give stable</span></div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  <span class="comment">// iteration order and a basis for tracking which loads and stores we</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;  <span class="comment">// actually split.</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;LoadInst *, 4&gt;</a> Loads;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;StoreInst *, 4&gt;</a> Stores;</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160; </div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;  <span class="comment">// We need to accumulate the splits required of each load or store where we</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;  <span class="comment">// can find them via a direct lookup. This is important to cross-check loads</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;  <span class="comment">// and stores against each other. We also track the slice so that we can kill</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;  <span class="comment">// all the slices that end up split.</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;  <span class="keyword">struct </span>SplitOffsets {</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>;</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    std::vector&lt;uint64_t&gt; Splits;</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;  };</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;Instruction *, SplitOffsets, 8&gt;</a> SplitOffsetsMap;</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160; </div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;  <span class="comment">// Track loads out of this alloca which cannot, for any reason, be pre-split.</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;  <span class="comment">// This is important as we also cannot pre-split stores of those loads!</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;  <span class="comment">// FIXME: This is all pretty gross. It means that we can be more aggressive</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;  <span class="comment">// in pre-splitting when the load feeding the store happens to come from</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;  <span class="comment">// a separate alloca. Put another way, the effectiveness of SROA would be</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;  <span class="comment">// decreased by a frontend which just concatenated all of its local allocas</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;  <span class="comment">// into one big flat alloca. But defeating such patterns is exactly the job</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  <span class="comment">// SROA is tasked with! Sadly, to not have this discrepancy we would have</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;  <span class="comment">// change store pre-splitting to actually force pre-splitting of the load</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  <span class="comment">// that feeds it *and all stores*. That makes pre-splitting much harder, but</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;  <span class="comment">// maybe it would make it more principled?</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;LoadInst *, 8&gt;</a> UnsplittableLoads;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160; </div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Searching for candidate loads and stores\n&quot;</span>);</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ab0fa7fd7c0ff766d70d16fcd6cf8d44b">partitions</a>()) {</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    <span class="keywordflow">for</span> (Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;Instruction&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse()-&gt;getUser());</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isSplittable() || <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset() &lt;= <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset()) {</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        <span class="comment">// If this is a load we have to track that it can&#39;t participate in any</span></div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        <span class="comment">// pre-splitting. If this is a store of a load we have to track that</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        <span class="comment">// that load also can&#39;t participate in any pre-splitting.</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;          UnsplittableLoads.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(LI);</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand()))</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;            UnsplittableLoads.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(LI);</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;      }</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset() &gt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() &amp;&amp;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;             <span class="stringliteral">&quot;Empty or backwards partition!&quot;</span>);</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160; </div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;      <span class="comment">// Determine if this is a pre-splittable slice.</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">isVolatile</a>() &amp;&amp; <span class="stringliteral">&quot;Cannot split volatile loads!&quot;</span>);</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160; </div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;        <span class="comment">// The load must be used exclusively to store into other pointers for</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;        <span class="comment">// us to be able to arbitrarily pre-split it. The stores must also be</span></div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;        <span class="comment">// simple to avoid changing semantics.</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;        <span class="keyword">auto</span> IsLoadSimplyStored = [](<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI) {</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *LU : LI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;            <span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(LU);</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> || !<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isSimple())</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;          }</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        };</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        <span class="keywordflow">if</span> (!IsLoadSimplyStored(LI)) {</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;          UnsplittableLoads.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(LI);</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;        }</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160; </div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;        Loads.push_back(LI);</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse() != &amp;<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getOperandUse(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperandIndex()))</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;          <span class="comment">// Skip stores *of* pointers. FIXME: This shouldn&#39;t even be possible!</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;        <span class="keyword">auto</span> *StoredLoad = dyn_cast&lt;LoadInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;        <span class="keywordflow">if</span> (!StoredLoad || !StoredLoad-&gt;isSimple())</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isVolatile() &amp;&amp; <span class="stringliteral">&quot;Cannot split volatile stores!&quot;</span>);</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160; </div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;        Stores.push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;        <span class="comment">// Other uses cannot be pre-split.</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;      }</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160; </div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;      <span class="comment">// Record the initial split.</span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Candidate: &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = SplitOffsetsMap[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>];</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.empty() &amp;&amp;</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;             <span class="stringliteral">&quot;Should not have splits the first time we see an instruction!&quot;</span>);</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;      <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S = &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;      <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.push_back(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset() - <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset());</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    }</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160; </div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    <span class="comment">// Now scan the already split slices, and add a split for any of them which</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <span class="comment">// we&#39;re going to pre-split.</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    <span class="keywordflow">for</span> (Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.splitSliceTails()) {</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      <span class="keyword">auto</span> SplitOffsetsMapI =</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;          SplitOffsetsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(cast&lt;Instruction&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;getUse()-&gt;getUser()));</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      <span class="keywordflow">if</span> (SplitOffsetsMapI == SplitOffsetsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = SplitOffsetsMapI-&gt;second;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160; </div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S == <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> &amp;&amp; <span class="stringliteral">&quot;Found a mismatched slice!&quot;</span>);</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.empty() &amp;&amp;</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;             <span class="stringliteral">&quot;Cannot have an empty set of splits on the second partition!&quot;</span>);</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.back() ==</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;                 <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset() - <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;beginOffset() &amp;&amp;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;             <span class="stringliteral">&quot;Previous split does not end where this one begins!&quot;</span>);</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160; </div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;      <span class="comment">// Record each split. The last partition&#39;s end isn&#39;t needed as the size</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;      <span class="comment">// of the slice dictates that.</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>-&gt;endOffset() &gt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset())</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;        <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.push_back(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset() - <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;beginOffset());</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;    }</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;  }</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160; </div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;  <span class="comment">// We may have split loads where some of their stores are split stores. For</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <span class="comment">// such loads and stores, we can only pre-split them if their splits exactly</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  <span class="comment">// match relative to their starting offset. We have to verify this prior to</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;  <span class="comment">// any rewriting.</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;  <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(Stores, [&amp;UnsplittableLoads, &amp;SplitOffsetsMap](<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    <span class="comment">// Lookup the load we are storing in our map of split</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    <span class="comment">// offsets.</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    <span class="keyword">auto</span> *LI = cast&lt;LoadInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    <span class="comment">// If it was completely unsplittable, then we&#39;re done,</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    <span class="comment">// and this store can&#39;t be pre-split.</span></div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    <span class="keywordflow">if</span> (UnsplittableLoads.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(LI))</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160; </div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;    <span class="keyword">auto</span> LoadOffsetsI = SplitOffsetsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(LI);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;    <span class="keywordflow">if</span> (LoadOffsetsI == SplitOffsetsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Unrelated loads are definitely safe.</span></div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;    <span class="keyword">auto</span> &amp;LoadOffsets = LoadOffsetsI-&gt;second;</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160; </div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    <span class="comment">// Now lookup the store&#39;s offsets.</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    <span class="keyword">auto</span> &amp;StoreOffsets = SplitOffsetsMap[<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>];</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160; </div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    <span class="comment">// If the relative offsets of each split in the load and</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    <span class="comment">// store match exactly, then we can split them and we</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    <span class="comment">// don&#39;t need to remove them here.</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    <span class="keywordflow">if</span> (LoadOffsets.Splits == StoreOffsets.Splits)</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160; </div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Mismatched splits for load and store:\n&quot;</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; *LI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;      &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160; </div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    <span class="comment">// We&#39;ve found a store and load that we need to split</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    <span class="comment">// with mismatched relative splits. Just give up on them</span></div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    <span class="comment">// and remove both instructions from our list of</span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    <span class="comment">// candidates.</span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    UnsplittableLoads.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(LI);</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;  });</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;  <span class="comment">// Now we have to go *back* through all the stores, because a later store may</span></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;  <span class="comment">// have caused an earlier store&#39;s load to become unsplittable and if it is</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;  <span class="comment">// unsplittable for the later store, then we can&#39;t rely on it being split in</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;  <span class="comment">// the earlier store either.</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;  <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(Stores, [&amp;UnsplittableLoads](<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;    <span class="keyword">auto</span> *LI = cast&lt;LoadInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    <span class="keywordflow">return</span> UnsplittableLoads.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(LI);</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;  });</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;  <span class="comment">// Once we&#39;ve established all the loads that can&#39;t be split for some reason,</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;  <span class="comment">// filter any that made it into our list out.</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;  <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(Loads, [&amp;UnsplittableLoads](<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI) {</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;    <span class="keywordflow">return</span> UnsplittableLoads.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(LI);</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;  });</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160; </div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;  <span class="comment">// If no loads or stores are left, there is no pre-splitting to be done for</span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;  <span class="comment">// this alloca.</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;  <span class="keywordflow">if</span> (Loads.empty() &amp;&amp; Stores.empty())</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160; </div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  <span class="comment">// From here on, we can&#39;t fail and will be building new accesses, so rig up</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  <span class="comment">// an IR builder.</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;  IRBuilderTy IRB(&amp;AI);</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160; </div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;  <span class="comment">// Collect the new slices which we will merge into the alloca slices.</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Slice, 4&gt;</a> NewSlices;</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160; </div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;  <span class="comment">// Track any allocas we end up splitting loads and stores for so we iterate</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  <span class="comment">// on them.</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;AllocaInst *, 4&gt;</a> ResplitPromotableAllocas;</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160; </div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;  <span class="comment">// At this point, we have collected all of the loads and stores we can</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;  <span class="comment">// pre-split, and the specific splits needed for them. We actually do the</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;  <span class="comment">// splitting in a specific order in order to handle when one of the loads in</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;  <span class="comment">// the value operand to one of the stores.</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;  <span class="comment">// First, we rewrite all of the split loads, and just accumulate each split</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;  <span class="comment">// load in a parallel structure. We also build the slices for them and append</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;  <span class="comment">// them to the alloca slices.</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;LoadInst *, std::vector&lt;LoadInst *&gt;</a>, 1&gt; SplitLoadsMap;</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;  std::vector&lt;LoadInst *&gt; SplitLoads;</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = AI.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI : Loads) {</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;    SplitLoads.clear();</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160; </div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = SplitOffsetsMap[LI];</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    <span class="keywordtype">unsigned</span> SliceSize = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;endOffset() - <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;beginOffset();</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>() % 8 == 0 &amp;&amp;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;           <span class="stringliteral">&quot;Load must have type size equal to store size&quot;</span>);</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>() / 8 &gt;= SliceSize &amp;&amp;</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;           <span class="stringliteral">&quot;Load must be &gt;= slice size&quot;</span>);</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160; </div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BaseOffset = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;beginOffset();</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BaseOffset + SliceSize &gt; BaseOffset &amp;&amp;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;           <span class="stringliteral">&quot;Cannot represent alloca access size using 64-bit integers!&quot;</span>);</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160; </div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a> = cast&lt;Instruction&gt;(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>());</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    IRB.SetInsertPoint(LI);</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160; </div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Splitting load: &quot;</span> &lt;&lt; *LI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160; </div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> PartOffset = 0, PartSize = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.front();</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <span class="keywordtype">int</span> Idx = 0, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.size();</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;      <span class="keyword">auto</span> *PartTy = Type::getIntNTy(LI-&gt;<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>(), PartSize * 8);</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;      <span class="keyword">auto</span> AS = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      <span class="keyword">auto</span> *PartPtrTy = PartTy-&gt;getPointerTo(AS);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *PLoad = IRB.CreateAlignedLoad(</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;          PartTy,</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;          <a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRB, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, BasePtr,</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;                         <a class="code" href="classllvm_1_1APInt.html">APInt</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(AS), PartOffset),</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                         PartPtrTy, <a class="code" href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getName() + <span class="stringliteral">&quot;.&quot;</span>),</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;          <a class="code" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a>(LI, PartOffset),</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;          <span class="comment">/*IsVolatile*/</span> <span class="keyword">false</span>, LI-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;      PLoad-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(*LI, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                                LLVMContext::MD_access_group});</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160; </div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;      <span class="comment">// Append this load onto the list of split loads so we can find it later</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;      <span class="comment">// to rewrite the stores.</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;      SplitLoads.push_back(PLoad);</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160; </div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;      <span class="comment">// Now build a new slice for the alloca.</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;      NewSlices.push_back(</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;          Slice(BaseOffset + PartOffset, BaseOffset + PartOffset + PartSize,</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                &amp;PLoad-&gt;<a class="code" href="classllvm_1_1User.html#a53d4e14158c5056fd1ed8f7b3da82f8a">getOperandUse</a>(PLoad-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a976e49f35fef77df271900abfdc42cd5">getPointerOperandIndex</a>()),</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                <span class="comment">/*IsSplittable*/</span> <span class="keyword">false</span>));</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    new slice [&quot;</span> &lt;&lt; NewSlices.back().beginOffset()</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; NewSlices.back().endOffset()</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; *PLoad &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160; </div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      <span class="comment">// See if we&#39;ve handled all the splits.</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= Size)</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160; </div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;      <span class="comment">// Setup the next partition.</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      PartOffset = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits[Idx];</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;      ++Idx;</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;      PartSize = (Idx &lt; <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> ? <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits[Idx] : SliceSize) - PartOffset;</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;    }</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160; </div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    <span class="comment">// Now that we have the split loads, do the slow walk over all uses of the</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    <span class="comment">// load and rewrite them as split stores, or save the split loads to use</span></div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    <span class="comment">// below if the store is going to be split there anyways.</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;    <span class="keywordtype">bool</span> DeferredStores = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1User.html">User</a> *LU : LI-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>()) {</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;      <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = cast&lt;StoreInst&gt;(LU);</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;      <span class="keywordflow">if</span> (!Stores.empty() &amp;&amp; SplitOffsetsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>)) {</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        DeferredStores = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Deferred splitting of store: &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;      }</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160; </div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StoreBasePtr = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand();</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;      IRB.SetInsertPoint(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160; </div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Splitting store of load: &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160; </div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Idx = 0, Size = SplitLoads.size(); Idx &lt; Size; ++Idx) {</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;        <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *PLoad = SplitLoads[Idx];</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> PartOffset = Idx == 0 ? 0 : <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits[Idx - 1];</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;        <span class="keyword">auto</span> *PartPtrTy =</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;            PLoad-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerAddressSpace());</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160; </div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        <span class="keyword">auto</span> AS = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerAddressSpace();</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *PStore = IRB.CreateAlignedStore(</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;            PLoad,</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;            <a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRB, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, StoreBasePtr,</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;                           <a class="code" href="classllvm_1_1APInt.html">APInt</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(AS), PartOffset),</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;                           PartPtrTy, StoreBasePtr-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.&quot;</span>),</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;            <a class="code" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, PartOffset),</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;            <span class="comment">/*IsVolatile*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;        PStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;                                   LLVMContext::MD_access_group,</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;                                   LLVMContext::MD_DIAssignID});</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;      +&quot;</span> &lt;&lt; PartOffset &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; *PStore &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;      }</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160; </div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;      <span class="comment">// We want to immediately iterate on any allocas impacted by splitting</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      <span class="comment">// this store, and we have to track any promotable alloca (indicated by</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;      <span class="comment">// a direct store) as needing to be resplit because it is no longer</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      <span class="comment">// promotable.</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *OtherAI = dyn_cast&lt;AllocaInst&gt;(StoreBasePtr)) {</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;        ResplitPromotableAllocas.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(OtherAI);</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;        Worklist.insert(OtherAI);</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *OtherAI = dyn_cast&lt;AllocaInst&gt;(</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;                     StoreBasePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a3ed745230c0e6c52f4b1ec0dae8c07fb">stripInBoundsOffsets</a>())) {</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;        Worklist.insert(OtherAI);</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;      }</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160; </div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;      <span class="comment">// Mark the original store as dead.</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;      DeadInsts.push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;    }</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160; </div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    <span class="comment">// Save the split loads if there are deferred stores among the users.</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    <span class="keywordflow">if</span> (DeferredStores)</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;      SplitLoadsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">insert</a>(std::make_pair(LI, <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(SplitLoads)));</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160; </div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    <span class="comment">// Mark the original load as dead and kill the original slice.</span></div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    DeadInsts.push_back(LI);</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;kill();</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;  }</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160; </div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;  <span class="comment">// Second, we rewrite all of the split stores. At this point, we know that</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="comment">// all loads from this alloca have been split already. For stores of such</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;  <span class="comment">// loads, we can simply look up the pre-existing split loads. For stores of</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;  <span class="comment">// other loads, we split those loads first and then write split stores of</span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;  <span class="comment">// them.</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : Stores) {</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    <span class="keyword">auto</span> *LI = cast&lt;LoadInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand());</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    <a class="code" href="classllvm_1_1IntegerType.html">IntegerType</a> *Ty = cast&lt;IntegerType&gt;(LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Ty-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() % 8 == 0);</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> StoreSize = Ty-&gt;<a class="code" href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">getBitWidth</a>() / 8;</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StoreSize &gt; 0 &amp;&amp; <span class="stringliteral">&quot;Cannot have a zero-sized integer store!&quot;</span>);</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160; </div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a> = SplitOffsetsMap[<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>];</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StoreSize == <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;endOffset() - <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;beginOffset() &amp;&amp;</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;           <span class="stringliteral">&quot;Slice size should always match load size exactly!&quot;</span>);</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> BaseOffset = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;beginOffset();</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BaseOffset + StoreSize &gt; BaseOffset &amp;&amp;</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;           <span class="stringliteral">&quot;Cannot represent alloca access size using 64-bit integers!&quot;</span>);</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160; </div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *LoadBasePtr = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>();</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *StoreBasePtr = cast&lt;Instruction&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand());</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160; </div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Splitting store: &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160; </div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    <span class="comment">// Check whether we have an already split load.</span></div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    <span class="keyword">auto</span> SplitLoadsMapI = SplitLoadsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">find</a>(LI);</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    std::vector&lt;LoadInst *&gt; *SplitLoads = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <span class="keywordflow">if</span> (SplitLoadsMapI != SplitLoadsMap.<a class="code" href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) {</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;      SplitLoads = &amp;SplitLoadsMapI-&gt;second;</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SplitLoads-&gt;size() == <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.size() + 1 &amp;&amp;</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;             <span class="stringliteral">&quot;Too few split loads for the number of splits in the store!&quot;</span>);</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;          of load: &quot;</span> &lt;&lt; *LI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    }</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160; </div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> PartOffset = 0, PartSize = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.front();</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <span class="keywordtype">int</span> Idx = 0, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits.size();</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;      <span class="keyword">auto</span> *PartTy = Type::getIntNTy(Ty-&gt;<a class="code" href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">getContext</a>(), PartSize * 8);</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;      <span class="keyword">auto</span> *LoadPartPtrTy = PartTy-&gt;getPointerTo(LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">getPointerAddressSpace</a>());</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      <span class="keyword">auto</span> *StorePartPtrTy = PartTy-&gt;getPointerTo(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerAddressSpace());</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160; </div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;      <span class="comment">// Either lookup a split load or create one.</span></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *PLoad;</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;      <span class="keywordflow">if</span> (SplitLoads) {</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;        PLoad = (*SplitLoads)[Idx];</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;        IRB.SetInsertPoint(LI);</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        <span class="keyword">auto</span> AS = LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;        PLoad = IRB.CreateAlignedLoad(</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;            PartTy,</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;            <a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRB, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, LoadBasePtr,</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;                           <a class="code" href="classllvm_1_1APInt.html">APInt</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(AS), PartOffset),</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;                           LoadPartPtrTy, LoadBasePtr-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.&quot;</span>),</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;            <a class="code" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a>(LI, PartOffset),</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;            <span class="comment">/*IsVolatile*/</span> <span class="keyword">false</span>, LI-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>());</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;        PLoad-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(*LI, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;                                  LLVMContext::MD_access_group});</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;      }</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160; </div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      <span class="comment">// And store this partition.</span></div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      IRB.SetInsertPoint(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <span class="keyword">auto</span> AS = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerAddressSpace();</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;      <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *PStore = IRB.CreateAlignedStore(</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;          PLoad,</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;          <a class="code" href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a>(IRB, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, StoreBasePtr,</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;                         <a class="code" href="classllvm_1_1APInt.html">APInt</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getIndexSizeInBits(AS), PartOffset),</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;                         StorePartPtrTy, StoreBasePtr-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.&quot;</span>),</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;          <a class="code" href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, PartOffset),</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;          <span class="comment">/*IsVolatile*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      PStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, {LLVMContext::MD_mem_parallel_loop_access,</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;                                 LLVMContext::MD_access_group});</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160; </div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;      <span class="comment">// Now build a new slice for the alloca.</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;      NewSlices.push_back(</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;          Slice(BaseOffset + PartOffset, BaseOffset + PartOffset + PartSize,</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;                &amp;PStore-&gt;<a class="code" href="classllvm_1_1User.html#a53d4e14158c5056fd1ed8f7b3da82f8a">getOperandUse</a>(PStore-&gt;<a class="code" href="classllvm_1_1StoreInst.html#add13b402166ae4d70f5b93c3c4cfba99">getPointerOperandIndex</a>()),</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;                <span class="comment">/*IsSplittable*/</span> <span class="keyword">false</span>));</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    new slice [&quot;</span> &lt;&lt; NewSlices.back().beginOffset()</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; NewSlices.back().endOffset()</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; *PStore &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;      <span class="keywordflow">if</span> (!SplitLoads) {</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;      of split load: &quot;</span> &lt;&lt; *PLoad &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;      }</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160; </div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;      <span class="comment">// See if we&#39;ve finished all the splits.</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;      <span class="keywordflow">if</span> (Idx &gt;= Size)</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160; </div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;      <span class="comment">// Setup the next partition.</span></div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;      PartOffset = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits[Idx];</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      ++Idx;</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;      PartSize = (Idx &lt; <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> ? <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.Splits[Idx] : StoreSize) - PartOffset;</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    }</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160; </div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    <span class="comment">// We want to immediately iterate on any allocas impacted by splitting</span></div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    <span class="comment">// this load, which is only relevant if it isn&#39;t a load of this alloca and</span></div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    <span class="comment">// thus we didn&#39;t already split the loads above. We also have to keep track</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="comment">// of any promotable allocas we split loads on as they can no longer be</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    <span class="comment">// promoted.</span></div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    <span class="keywordflow">if</span> (!SplitLoads) {</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *OtherAI = dyn_cast&lt;AllocaInst&gt;(LoadBasePtr)) {</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OtherAI != &amp;AI &amp;&amp; <span class="stringliteral">&quot;We can&#39;t re-split our own alloca!&quot;</span>);</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;        ResplitPromotableAllocas.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(OtherAI);</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;        Worklist.insert(OtherAI);</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *OtherAI = dyn_cast&lt;AllocaInst&gt;(</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;                     LoadBasePtr-&gt;<a class="code" href="classllvm_1_1Value.html#a3ed745230c0e6c52f4b1ec0dae8c07fb">stripInBoundsOffsets</a>())) {</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OtherAI != &amp;AI &amp;&amp; <span class="stringliteral">&quot;We can&#39;t re-split our own alloca!&quot;</span>);</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;        Worklist.insert(OtherAI);</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;      }</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    }</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160; </div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    <span class="comment">// Mark the original store as dead now that we&#39;ve split it up and kill its</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;    <span class="comment">// slice. Note that we leave the original load in place unless this store</span></div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    <span class="comment">// was its only use. It may in turn be split up if it is an alloca load</span></div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;    <span class="comment">// for some other alloca, but it may be a normal load. This may introduce</span></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;    <span class="comment">// redundant loads, but where those can be merged the rest of the optimizer</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;    <span class="comment">// should handle the merging, and this uncovers SSA splits which is more</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    <span class="comment">// important. In practice, the original loads will almost always be fully</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;    <span class="comment">// split and removed eventually, and the splits will be merged by any</span></div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;    <span class="comment">// trivial CSE, including instcombine.</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;    <span class="keywordflow">if</span> (LI-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>()) {</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(*LI-&gt;<a class="code" href="classllvm_1_1Value.html#a158da2b6d3d938aaa15b6acd00150e2c">user_begin</a>() == <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &amp;&amp; <span class="stringliteral">&quot;Single use isn&#39;t this store!&quot;</span>);</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      DeadInsts.push_back(LI);</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    }</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    DeadInsts.push_back(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.S-&gt;kill();</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  }</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160; </div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;  <span class="comment">// Remove the killed slices that have ben pre-split.</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(AS, [](<span class="keyword">const</span> Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) { <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isDead(); });</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160; </div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;  <span class="comment">// Insert our new slices. This will sort and merge them into the sorted</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  <span class="comment">// sequence.</span></div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;  AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#ad9fd340fc6b63cbabc1f9d96f5494bcc">insert</a>(NewSlices);</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160; </div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Pre-split slices:\n&quot;</span>);</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aa8d55f500ee8cec1418f4d0016f634f0">begin</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">end</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aea43ee5732092522ecfa6bdf2e26088e">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="stringliteral">&quot;    &quot;</span>));</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160; </div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;  <span class="comment">// Finally, don&#39;t try to promote any allocas that new require re-splitting.</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;  <span class="comment">// They have already been added to the worklist above.</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;  <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(PromotableAllocas, [&amp;](<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI) {</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    <span class="keywordflow">return</span> ResplitPromotableAllocas.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(AI);</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;  });</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160; </div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;}</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="comment">/// Rewrite an alloca partition&#39;s users.</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;<span class="comment">/// This routine drives both of the rewriting goals of the SROA pass. It tries</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="comment">/// to rewrite uses of an alloca partition to be conducive for SSA value</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="comment">/// promotion. If the partition needs a new, more refined alloca, this will</span></div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;<span class="comment">/// build that new alloca, preserving as much type information as possible, and</span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;<span class="comment">/// rewrite the uses of the old alloca to point at the new one and have the</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;<span class="comment">/// appropriate new offsets. It also evaluates how successful the rewrite was</span></div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;<span class="comment">/// at enabling promotion and if it was successful queues the alloca to be</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="comment">/// promoted.</span></div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *SROAPass::rewritePartition(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI, <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> &amp;AS,</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;                                       <a class="code" href="classllvm_1_1sroa_1_1Partition.html">Partition</a> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;  <span class="comment">// Try to compute a friendly type for this partition of the alloca. This</span></div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;  <span class="comment">// won&#39;t always succeed, in which case we fall back to a legal integer type</span></div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;  <span class="comment">// or an i8 array of an appropriate size.</span></div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *SliceTy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *SliceVecTy = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = AI.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;  std::pair&lt;Type *, IntegerType *&gt; CommonUseTy =</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;      <a class="code" href="SROA_8cpp.html#ab040eb97b6dfc28714a55b93c66ae560">findCommonType</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.begin(), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.end(), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset());</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;  <span class="comment">// Do all uses operate on the same type?</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;  <span class="keywordflow">if</span> (CommonUseTy.first)</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(CommonUseTy.first).getFixedValue() &gt;= <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size()) {</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;      SliceTy = CommonUseTy.first;</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      SliceVecTy = dyn_cast&lt;VectorType&gt;(SliceTy);</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    }</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  <span class="comment">// If not, can we find an appropriate subtype in the original allocated type?</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;  <span class="keywordflow">if</span> (!SliceTy)</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Type.html">Type</a> *TypePartitionTy = <a class="code" href="SROA_8cpp.html#abe75ff888b6a7ee2836aa6c8f33984c1">getTypePartition</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, AI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(),</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;                                                 <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset(), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size()))</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;      SliceTy = TypePartitionTy;</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160; </div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  <span class="comment">// If still not, can we use the largest bitwidth integer type used?</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;  <span class="keywordflow">if</span> (!SliceTy &amp;&amp; CommonUseTy.second)</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(CommonUseTy.second).getFixedValue() &gt;= <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size()) {</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      SliceTy = CommonUseTy.second;</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      SliceVecTy = dyn_cast&lt;VectorType&gt;(SliceTy);</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    }</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  <span class="keywordflow">if</span> ((!SliceTy || (SliceTy-&gt;<a class="code" href="classllvm_1_1Type.html#a2a394517076e7dd2bdcd7dde33dfcb7d">isArrayTy</a>() &amp;&amp;</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;                    SliceTy-&gt;<a class="code" href="classllvm_1_1Type.html#afc079797ba8cb5aa4d9ebfc4d85c4aab">getArrayElementType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())) &amp;&amp;</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isLegalInteger(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size() * 8)) {</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    SliceTy = Type::getIntNTy(*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size() * 8);</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;  }</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160; </div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;  <span class="comment">// If the common use types are not viable for promotion then attempt to find</span></div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;  <span class="comment">// another type that is viable.</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;  <span class="keywordflow">if</span> (SliceVecTy &amp;&amp; !<a class="code" href="SROA_8cpp.html#a73ce9bc74349e7599dd4ae32a091ede7">checkVectorTypeForPromotion</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, SliceVecTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Type.html">Type</a> *TypePartitionTy = <a class="code" href="SROA_8cpp.html#abe75ff888b6a7ee2836aa6c8f33984c1">getTypePartition</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, AI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>(),</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;                                                 <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset(), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size())) {</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *TypePartitionVecTy = dyn_cast&lt;VectorType&gt;(TypePartitionTy);</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;      <span class="keywordflow">if</span> (TypePartitionVecTy &amp;&amp;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;          <a class="code" href="SROA_8cpp.html#a73ce9bc74349e7599dd4ae32a091ede7">checkVectorTypeForPromotion</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, TypePartitionVecTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;        SliceTy = TypePartitionTy;</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;    }</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160; </div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;  <span class="keywordflow">if</span> (!SliceTy)</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;    SliceTy = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ArrayType::get</a>(Type::getInt8Ty(*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size());</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(SliceTy).getFixedValue() &gt;= <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size());</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160; </div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;  <span class="keywordtype">bool</span> IsIntegerPromotable = <a class="code" href="SROA_8cpp.html#a7fd9ee96f281dd94ed4119c2e45836bf">isIntegerWideningViable</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, SliceTy, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160; </div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;  <a class="code" href="classllvm_1_1VectorType.html">VectorType</a> *VecTy =</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;      IsIntegerPromotable ? nullptr : <a class="code" href="SROA_8cpp.html#a458f8b1b5c1beb71a2f7b1e1c151741d">isVectorPromotionViable</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;  <span class="keywordflow">if</span> (VecTy)</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;    SliceTy = VecTy;</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160; </div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;  <span class="comment">// Check for the case where we&#39;re going to rewrite to a new alloca of the</span></div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;  <span class="comment">// exact same type as the original, and with the same access offsets. In that</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;  <span class="comment">// case, re-use the existing alloca, but still run through the rewriter to</span></div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;  <span class="comment">// perform phi and select speculation.</span></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;  <span class="comment">// P.beginOffset() can be non-zero even with the same type in a case with</span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;  <span class="comment">// out-of-bounds access (e.g. @PR35657 function in SROA/basictest.ll).</span></div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *NewAI;</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;  <span class="keywordflow">if</span> (SliceTy == AI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>() &amp;&amp; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset() == 0) {</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;    NewAI = &amp;AI;</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;    <span class="comment">// FIXME: We should be able to bail at this point with &quot;nothing changed&quot;.</span></div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;    <span class="comment">// FIXME: We might want to defer PHI speculation until after here.</span></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    <span class="comment">// FIXME: return nullptr;</span></div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;    <span class="comment">// Make sure the alignment is compatible with P.beginOffset().</span></div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;    <span class="keyword">const</span> <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(AI.<a class="code" href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">getAlign</a>(), <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset());</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    <span class="comment">// If we will get at least this much alignment from the type alone, leave</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;    <span class="comment">// the alloca&#39;s alignment unconstrained.</span></div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> IsUnconstrained = Alignment &lt;= <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getABITypeAlign(SliceTy);</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;    NewAI = <span class="keyword">new</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a>(</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;        SliceTy, AI.<a class="code" href="classllvm_1_1AllocaInst.html#ad2fb148dfac3182fce33be95fc4e9159">getAddressSpace</a>(), <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;        IsUnconstrained ? <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPrefTypeAlign(SliceTy) : Alignment,</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;        AI.<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + <span class="stringliteral">&quot;.sroa.&quot;</span> + <a class="code" href="classllvm_1_1Twine.html">Twine</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.begin() - AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aa8d55f500ee8cec1418f4d0016f634f0">begin</a>()), &amp;AI);</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    <span class="comment">// Copy the old AI debug location over to the new one.</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    NewAI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(AI.<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    ++NumNewAllocas;</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;  }</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160; </div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Rewriting alloca partition &quot;</span></div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset()</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;) to: &quot;</span> &lt;&lt; *NewAI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160; </div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;  <span class="comment">// Track the high watermark on the worklist as it is only relevant for</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;  <span class="comment">// promoted allocas. We will reset it to this point if the alloca is not in</span></div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;  <span class="comment">// fact scheduled for promotion.</span></div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;  <span class="keywordtype">unsigned</span> PPWOldSize = PostPromotionWorklist.size();</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;  <span class="keywordtype">unsigned</span> NumUses = 0;</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;PHINode *, 8&gt;</a> PHIUsers;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;  <a class="code" href="classllvm_1_1SmallSetVector.html">SmallSetVector&lt;SelectInst *, 8&gt;</a> SelectUsers;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160; </div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html">AllocaSliceRewriter</a> <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, AS, *<span class="keyword">this</span>, AI, *NewAI, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset(),</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;                               <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.endOffset(), IsIntegerPromotable, VecTy,</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                               PHIUsers, SelectUsers);</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  <span class="keywordtype">bool</span> Promotable = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  <span class="keywordflow">for</span> (Slice *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.splitSliceTails()) {</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;    Promotable &amp;= <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.visit(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>);</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;    ++NumUses;</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;  }</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;  <span class="keywordflow">for</span> (Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    Promotable &amp;= <a class="code" href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.visit(&amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>);</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;    ++NumUses;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;  }</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160; </div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;  NumAllocaPartitionUses += NumUses;</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;  MaxUsesPerAllocaPartition.updateMax(NumUses);</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160; </div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;  <span class="comment">// Now that we&#39;ve processed all the slices in the new partition, check if any</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;  <span class="comment">// PHIs or Selects would block promotion.</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : PHIUsers)</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SROA_8cpp.html#aab37469c4748a495736ad163ac54e776">isSafePHIToSpeculate</a>(*<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>)) {</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;      Promotable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;      PHIUsers.clear();</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      SelectUsers.<a class="code" href="classllvm_1_1SetVector.html#a96bda22e654a59fec0620767b56dd53f">clear</a>();</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;    }</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160; </div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;std::pair&lt;SelectInst *, RewriteableMemOps&gt;</a>, 2&gt;</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;      NewSelectsToRewrite;</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;  NewSelectsToRewrite.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(SelectUsers.<a class="code" href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">size</a>());</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> *Sel : SelectUsers) {</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    std::optional&lt;RewriteableMemOps&gt; Ops =</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;        isSafeSelectToSpeculate(*Sel, PreserveCFG);</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <span class="keywordflow">if</span> (!Ops) {</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;      Promotable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;      PHIUsers.clear();</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;      SelectUsers.clear();</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;      NewSelectsToRewrite.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;    }</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;    NewSelectsToRewrite.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(std::make_pair(Sel, *Ops));</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;  }</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160; </div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;  <span class="keywordflow">if</span> (Promotable) {</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> *U : AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a29857cfc1d48f6de8eed646ab1fa87f4">getDeadUsesIfPromotable</a>()) {</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;      <span class="keyword">auto</span> *OldInst = dyn_cast&lt;Instruction&gt;(U-&gt;get());</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;      Value::dropDroppableUse(*U);</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;      <span class="keywordflow">if</span> (OldInst)</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">isInstructionTriviallyDead</a>(OldInst))</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;          DeadInsts.push_back(OldInst);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;    }</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;    <span class="keywordflow">if</span> (PHIUsers.empty() &amp;&amp; SelectUsers.empty()) {</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;      <span class="comment">// Promote the alloca.</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;      PromotableAllocas.push_back(NewAI);</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;      <span class="comment">// If we have either PHIs or Selects to speculate, add them to those</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;      <span class="comment">// worklists and re-queue the new alloca so that we promote in on the</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      <span class="comment">// next iteration.</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PHIUser : PHIUsers)</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;        SpeculatablePHIs.insert(PHIUser);</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;      SelectsToRewrite.reserve(SelectsToRewrite.size() +</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;                               NewSelectsToRewrite.size());</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;KV : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a>(</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;               std::make_move_iterator(NewSelectsToRewrite.begin()),</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;               std::make_move_iterator(NewSelectsToRewrite.end())))</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;        SelectsToRewrite.insert(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">std::move</a>(KV));</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;      Worklist.insert(NewAI);</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;    }</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;    <span class="comment">// Drop any post-promotion work items if promotion didn&#39;t happen.</span></div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;    <span class="keywordflow">while</span> (PostPromotionWorklist.size() &gt; PPWOldSize)</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;      PostPromotionWorklist.pop_back();</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160; </div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;    <span class="comment">// We couldn&#39;t promote and we didn&#39;t create a new partition, nothing</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;    <span class="comment">// happened.</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;    <span class="keywordflow">if</span> (NewAI == &amp;AI)</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160; </div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;    <span class="comment">// If we can&#39;t promote the alloca, iterate on it to check for new</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;    <span class="comment">// refinements exposed by splitting the current alloca. Don&#39;t iterate on an</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;    <span class="comment">// alloca which didn&#39;t actually change and didn&#39;t get promoted.</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;    Worklist.insert(NewAI);</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;  }</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160; </div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;  <span class="keywordflow">return</span> NewAI;</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;}</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;<span class="comment">/// Walks the slices of an alloca and form partitions based on them,</span></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;<span class="comment">/// rewriting each of their uses.</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SROAPass::splitAlloca(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI, <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> &amp;AS) {</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;  <span class="keywordflow">if</span> (AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#aa8d55f500ee8cec1418f4d0016f634f0">begin</a>() == AS.<a class="code" href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">end</a>())</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160; </div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;  <span class="keywordtype">unsigned</span> NumPartitions = 0;</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = AI.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160; </div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;  <span class="comment">// First try to pre-split loads and stores.</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;  Changed |= presplitLoadsAndStores(AI, AS);</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160; </div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;  <span class="comment">// Now that we have identified any pre-splitting opportunities,</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;  <span class="comment">// mark loads and stores unsplittable except for the following case.</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;  <span class="comment">// We leave a slice splittable if all other slices are disjoint or fully</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;  <span class="comment">// included in the slice, such as whole-alloca loads and stores.</span></div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;  <span class="comment">// If we fail to split these during pre-splitting, we want to force them</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;  <span class="comment">// to be rewritten into a partition.</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;  <span class="keywordtype">bool</span> IsSorted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160; </div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AllocaSize =</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(AI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>()).getFixedValue();</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="keyword">const</span> <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MaxBitVectorSize = 1024;</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;  <span class="keywordflow">if</span> (AllocaSize &lt;= MaxBitVectorSize) {</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;    <span class="comment">// If a byte boundary is included in any load or store, a slice starting or</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;    <span class="comment">// ending at the boundary is not splittable.</span></div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;    <a class="code" href="classllvm_1_1SmallBitVector.html">SmallBitVector</a> SplittableOffset(AllocaSize + 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;    <span class="keywordflow">for</span> (Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : AS)</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a> = <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() + 1;</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;           <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a> &lt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset() &amp;&amp; <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a> &lt; AllocaSize; <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>++)</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;        SplittableOffset.reset(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>);</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160; </div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;    <span class="keywordflow">for</span> (Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : AS) {</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isSplittable())</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160; </div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() &gt; AllocaSize || SplittableOffset[<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset()]) &amp;&amp;</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;          (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset() &gt; AllocaSize || SplittableOffset[<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset()]))</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160; </div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;      <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse()-&gt;getUser()) ||</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;          isa&lt;StoreInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse()-&gt;getUser())) {</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.makeUnsplittable();</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;        IsSorted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;      }</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    }</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;  }</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    <span class="comment">// We only allow whole-alloca splittable loads and stores</span></div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;    <span class="comment">// for a large alloca to avoid creating too large BitVector.</span></div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    <span class="keywordflow">for</span> (Slice &amp;<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a> : AS) {</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.isSplittable())</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160; </div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.beginOffset() == 0 &amp;&amp; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.endOffset() &gt;= AllocaSize)</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160; </div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;      <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse()-&gt;getUser()) ||</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;          isa&lt;StoreInst&gt;(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.getUse()-&gt;getUser())) {</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;        <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>.makeUnsplittable();</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;        IsSorted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      }</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    }</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;  }</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160; </div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;  <span class="keywordflow">if</span> (!IsSorted)</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;    <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(AS);</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;<span class="comment">  /// Describes the allocas introduced by rewritePartition in order to migrate</span></div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;<span class="comment">  /// the debug info.</span></div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;<span class="comment"></span>  <span class="keyword">struct </span>Fragment {</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;    <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *Alloca;</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>;</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;    Fragment(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>)</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      : Alloca(AI), <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>(<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>), <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>(<a class="code" href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a>) {}</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;  };</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Fragment, 4&gt;</a> Fragments;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160; </div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;  <span class="comment">// Rewrite each partition.</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> : AS.partitions()) {</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *NewAI = rewritePartition(AI, AS, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>)) {</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;      <span class="keywordflow">if</span> (NewAI != &amp;AI) {</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> SizeOfByte = 8;</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AllocaSize =</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;            <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(NewAI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>()).getFixedValue();</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;        <span class="comment">// Don&#39;t include any padding.</span></div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(AllocaSize, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.size() * SizeOfByte);</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;        Fragments.push_back(Fragment(NewAI, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>.beginOffset() * SizeOfByte, Size));</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;      }</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;    }</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    ++NumPartitions;</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;  }</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160; </div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;  NumAllocaPartitions += NumPartitions;</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;  MaxPartitionsPerAlloca.updateMax(NumPartitions);</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160; </div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;  <span class="comment">// Migrate debug information from the old alloca to the new alloca(s)</span></div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;  <span class="comment">// and the individual partitions.</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;  <a class="code" href="classllvm_1_1TinyPtrVector.html">TinyPtrVector&lt;DbgVariableIntrinsic *&gt;</a> DbgDeclares = <a class="code" href="namespacellvm.html#a81ba15e1d6d05dde87983ab4f4f6aec1">FindDbgAddrUses</a>(&amp;AI);</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *DbgAssign : <a class="code" href="namespacellvm_1_1at.html#a3c90899e8f022656e511630de42b916c">at::getAssignmentMarkers</a>(&amp;AI))</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    DbgDeclares.<a class="code" href="classllvm_1_1TinyPtrVector.html#a1437e12220a4cd03b10656dcb607c642">push_back</a>(DbgAssign);</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *DbgDeclare : DbgDeclares) {</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;    <span class="keyword">auto</span> *Expr = DbgDeclare-&gt;getExpression();</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;    <a class="code" href="classllvm_1_1DIBuilder.html">DIBuilder</a> DIB(*AI.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>(), <span class="comment">/*AllowUnresolved*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AllocaSize =</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;        <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeSizeInBits(AI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>()).getFixedValue();</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> Fragment : Fragments) {</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;      <span class="comment">// Create a fragment expression describing the new partition or reuse AI&#39;s</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;      <span class="comment">// expression if there is only one partition.</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;      <span class="keyword">auto</span> *FragmentExpr = Expr;</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;      <span class="keywordflow">if</span> (Fragment.Size &lt; AllocaSize || Expr-&gt;isFragment()) {</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;        <span class="comment">// If this alloca is already a scalar replacement of a larger aggregate,</span></div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;        <span class="comment">// Fragment.Offset describes the offset inside the scalar.</span></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;        <span class="keyword">auto</span> ExprFragment = Expr-&gt;getFragmentInfo();</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = ExprFragment ? ExprFragment-&gt;OffsetInBits : 0;</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Start = <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> + Fragment.Offset;</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;        <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Fragment.Size;</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;        <span class="keywordflow">if</span> (ExprFragment) {</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;          <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AbsEnd =</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;              ExprFragment-&gt;OffsetInBits + ExprFragment-&gt;SizeInBits;</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;          <span class="keywordflow">if</span> (Start &gt;= AbsEnd) {</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;            <span class="comment">// No need to describe a SROAed padding.</span></div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;          }</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;          <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(Size, AbsEnd - Start);</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;        }</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;        <span class="comment">// The new, smaller fragment is stenciled out from the old fragment.</span></div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> OrigFragment = FragmentExpr-&gt;getFragmentInfo()) {</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;          <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Start &gt;= OrigFragment-&gt;OffsetInBits &amp;&amp;</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;                 <span class="stringliteral">&quot;new fragment is outside of original fragment&quot;</span>);</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;          Start -= OrigFragment-&gt;OffsetInBits;</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;        }</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160; </div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;        <span class="comment">// The alloca may be larger than the variable.</span></div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;        <span class="keyword">auto</span> VarSize = DbgDeclare-&gt;getVariable()-&gt;getSizeInBits();</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;        <span class="keywordflow">if</span> (VarSize) {</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;          <span class="keywordflow">if</span> (Size &gt; *VarSize)</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;            <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = *VarSize;</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;          <span class="keywordflow">if</span> (Size == 0 || Start + Size &gt; *VarSize)</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;        }</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160; </div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;        <span class="comment">// Avoid creating a fragment expression that covers the entire variable.</span></div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;        <span class="keywordflow">if</span> (!VarSize || *VarSize != Size) {</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;          <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> =</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;                  DIExpression::createFragmentExpression(Expr, Start, Size))</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;            FragmentExpr = *<a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;        }</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;      }</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160; </div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      <span class="comment">// Remove any existing intrinsics on the new alloca describing</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;      <span class="comment">// the variable fragment.</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *OldDII : <a class="code" href="namespacellvm.html#a81ba15e1d6d05dde87983ab4f4f6aec1">FindDbgAddrUses</a>(Fragment.Alloca)) {</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;        <span class="keyword">auto</span> SameVariableFragment = [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) {</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;getVariable() == <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;getVariable() &amp;&amp;</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                 <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;getDebugLoc()-&gt;getInlinedAt() ==</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                     <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;getDebugLoc()-&gt;getInlinedAt();</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;        };</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;        <span class="keywordflow">if</span> (SameVariableFragment(OldDII, DbgDeclare))</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;          OldDII-&gt;eraseFromParent();</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;      }</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160; </div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *DbgAssign = dyn_cast&lt;DbgAssignIntrinsic&gt;(DbgDeclare)) {</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;        <span class="keywordflow">if</span> (!Fragment.Alloca-&gt;hasMetadata(LLVMContext::MD_DIAssignID)) {</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;          Fragment.Alloca-&gt;<a class="code" href="classllvm_1_1Value.html#a338590123630c357df6340c38d066572">setMetadata</a>(</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;              LLVMContext::MD_DIAssignID,</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;              DIAssignID::getDistinct(AI.<a class="code" href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>()));</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;        }</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;        <span class="keyword">auto</span> *NewAssign = DIB.insertDbgAssign(</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;            Fragment.Alloca, DbgAssign-&gt;getValue(), DbgAssign-&gt;getVariable(),</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;            FragmentExpr, Fragment.Alloca, DbgAssign-&gt;getAddressExpression(),</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;            DbgAssign-&gt;getDebugLoc());</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;        NewAssign-&gt;setDebugLoc(DbgAssign-&gt;getDebugLoc());</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Created new assign intrinsic: &quot;</span> &lt;&lt; *NewAssign</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;        DIB.insertDeclare(Fragment.Alloca, DbgDeclare-&gt;getVariable(),</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;                          FragmentExpr, DbgDeclare-&gt;getDebugLoc(), &amp;AI);</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      }</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    }</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;  }</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;}</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;<span class="comment">/// Clobber a use with poison, deleting the used value if it becomes dead.</span></div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> SROAPass::clobberUse(<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) {</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *OldV = U;</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;  <span class="comment">// Replace the use with an poison value.</span></div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;  U = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">PoisonValue::get</a>(OldV-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160; </div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;  <span class="comment">// Check for this making an instruction dead. We have to garbage collect</span></div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;  <span class="comment">// all the dead instructions to ensure the uses of any alloca end up being</span></div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;  <span class="comment">// minimal.</span></div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *OldI = dyn_cast&lt;Instruction&gt;(OldV))</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">isInstructionTriviallyDead</a>(OldI)) {</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;      DeadInsts.push_back(OldI);</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;    }</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;}</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;<span class="comment">/// Analyze an alloca for SROA.</span></div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;<span class="comment">/// This analyzes the alloca to ensure we can reason about it, builds</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="comment">/// the slices of the alloca, and then hands it off to be split and</span></div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;<span class="comment">/// rewritten as needed.</span></div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;<span class="comment"></span>std::pair&lt;<span class="keywordtype">bool</span> <span class="comment">/*Changed*/</span>, <span class="keywordtype">bool</span> <span class="comment">/*CFGChanged*/</span>&gt;</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;SROAPass::runOnAlloca(<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> &amp;AI) {</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;  <span class="keywordtype">bool</span> CFGChanged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160; </div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SROA alloca: &quot;</span> &lt;&lt; AI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;  ++NumAllocasAnalyzed;</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160; </div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;  <span class="comment">// Special case dead allocas, as they&#39;re trivial.</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;  <span class="keywordflow">if</span> (AI.<a class="code" href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">use_empty</a>()) {</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;    AI.<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;    <span class="keywordflow">return</span> {Changed, CFGChanged};</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;  }</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = AI.<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160; </div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;  <span class="comment">// Skip alloca forms that this analysis can&#39;t handle.</span></div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;  <span class="keyword">auto</span> *AT = AI.<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>();</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(AT);</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;  <span class="keywordflow">if</span> (AI.<a class="code" href="classllvm_1_1AllocaInst.html#aea74164514e7164813ab30bcc4b7c557">isArrayAllocation</a>() || !AT-&gt;isSized() || <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>.isScalable() ||</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;      <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>.getFixedValue() == 0)</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;    <span class="keywordflow">return</span> {Changed, CFGChanged};</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160; </div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;  <span class="comment">// First, split any FCA loads and stores touching this alloca to promote</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;  <span class="comment">// better splitting and promotion opportunities.</span></div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;  IRBuilderTy IRB(&amp;AI);</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;  AggLoadStoreRewriter AggRewriter(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, IRB);</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;  Changed |= AggRewriter.rewrite(AI);</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160; </div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;  <span class="comment">// Build the slices using a recursive instruction-visiting builder.</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;  <a class="code" href="namespaceAllocaSlices.html">AllocaSlices</a> AS(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, AI);</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(AS.print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;  <span class="keywordflow">if</span> (AS.isEscaped())</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;    <span class="keywordflow">return</span> {Changed, CFGChanged};</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160; </div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;  <span class="comment">// Delete all the dead users of this alloca before splitting and rewriting it.</span></div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *DeadUser : AS.getDeadUsers()) {</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;    <span class="comment">// Free up everything used by this instruction.</span></div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;DeadOp : DeadUser-&gt;operands())</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;      clobberUse(DeadOp);</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160; </div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;    <span class="comment">// Now replace the uses of this instruction.</span></div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    DeadUser-&gt;replaceAllUsesWith(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">PoisonValue::get</a>(DeadUser-&gt;getType()));</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160; </div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;    <span class="comment">// And mark it for deletion.</span></div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;    DeadInsts.push_back(DeadUser);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;  }</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> *DeadOp : AS.getDeadOperands()) {</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;    clobberUse(*DeadOp);</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;  }</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160; </div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;  <span class="comment">// No slices to split. Leave the dead alloca for a later pass to clean up.</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;  <span class="keywordflow">if</span> (AS.begin() == AS.end())</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    <span class="keywordflow">return</span> {Changed, CFGChanged};</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160; </div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;  Changed |= splitAlloca(AI, AS);</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160; </div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Speculating PHIs\n&quot;</span>);</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;  <span class="keywordflow">while</span> (!SpeculatablePHIs.empty())</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;    <a class="code" href="SROA_8cpp.html#a80f5f1399bc814c650325a6c41e350e2">speculatePHINodeLoads</a>(IRB, *SpeculatablePHIs.pop_back_val());</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160; </div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Rewriting Selects\n&quot;</span>);</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;  <span class="keyword">auto</span> RemainingSelectsToRewrite = SelectsToRewrite.takeVector();</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;  <span class="keywordflow">while</span> (!RemainingSelectsToRewrite.empty()) {</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> [K, V] = RemainingSelectsToRewrite.pop_back_val();</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;    CFGChanged |=</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;        <a class="code" href="SROA_8cpp.html#aae20a4fd186a7a392cb3af583c470709">rewriteSelectInstMemOps</a>(*K, V, IRB, PreserveCFG ? <span class="keyword">nullptr</span> : DTU);</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;  }</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160; </div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;  <span class="keywordflow">return</span> {Changed, CFGChanged};</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;}</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;<span class="comment">/// Delete the dead instructions accumulated in this run.</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;<span class="comment">/// Recursively deletes the dead instructions we&#39;ve accumulated. This is done</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;<span class="comment">/// at the very end to maximize locality of the recursive delete and to</span></div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;<span class="comment">/// minimize the problems of invalidated instruction pointers as such pointers</span></div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;<span class="comment">/// are used heavily in the intermediate stages of the algorithm.</span></div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;<span class="comment">/// We also record the alloca instructions deleted here so that they aren&#39;t</span></div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;<span class="comment">/// subsequently handed to mem2reg to promote.</span></div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SROAPass::deleteDeadInstructions(</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;AllocaInst *&gt;</a> &amp;DeletedAllocas) {</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;  <span class="keywordflow">while</span> (!DeadInsts.empty()) {</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast_or_null&lt;Instruction&gt;(DeadInsts.pop_back_val());</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Deleting dead instruction: &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160; </div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;    <span class="comment">// If the instruction is an alloca, find the possible dbg.declare connected</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;    <span class="comment">// to it, and remove it too. We must do this before calling RAUW or we will</span></div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;    <span class="comment">// not be able to find it.</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI = dyn_cast&lt;AllocaInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;      DeletedAllocas.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(AI);</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1DbgVariableIntrinsic.html">DbgVariableIntrinsic</a> *OldDII : <a class="code" href="namespacellvm.html#a81ba15e1d6d05dde87983ab4f4f6aec1">FindDbgAddrUses</a>(AI))</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;        OldDII-&gt;eraseFromParent();</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;    }</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160; </div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;    <a class="code" href="namespacellvm_1_1at.html#acac0a0a393ce41aadc29e623549b6bfa">at::deleteAssignmentMarkers</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;replaceAllUsesWith(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">UndefValue::get</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType()));</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160; </div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;Operand : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;operands())</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *U = dyn_cast&lt;Instruction&gt;(Operand)) {</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;        <span class="comment">// Zero out the operand and see if it becomes trivially dead.</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;        Operand = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">isInstructionTriviallyDead</a>(U))</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;          DeadInsts.push_back(U);</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      }</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160; </div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;    ++NumDeleted;</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;    Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;  }</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;}</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;<span class="comment">/// Promote the allocas, using the best available technique.</span></div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;<span class="comment">/// This attempts to promote whatever allocas have been identified as viable in</span></div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;<span class="comment">/// the PromotableAllocas list. If that list is empty, there is nothing to do.</span></div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;<span class="comment">/// This function returns whether any promotion occurred.</span></div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> SROAPass::promoteAllocas(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  <span class="keywordflow">if</span> (PromotableAllocas.empty())</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160; </div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;  NumPromoted += PromotableAllocas.size();</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160; </div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SROA_8cpp.html#ae96de1d4cd86e9e063cf40ee8910f329">SROASkipMem2Reg</a>) {</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Not promoting allocas with mem2reg!\n&quot;</span>);</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Promoting allocas with mem2reg...\n&quot;</span>);</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;    <a class="code" href="namespacellvm.html#a1a4cac84457299517e69ff9764fed2db">PromoteMemToReg</a>(PromotableAllocas, DTU-&gt;getDomTree(), AC);</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;  }</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160; </div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;  PromotableAllocas.clear();</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;}</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160; </div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="ExpandLargeDivRem_8cpp.html#ae64f9cd0977a8b47570154312540d7d2">SROAPass::runImpl</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1DomTreeUpdater.html">DomTreeUpdater</a> &amp;RunDTU,</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;                                    <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;RunAC) {</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SROA function: &quot;</span> &lt;&lt; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;  <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;  DTU = &amp;RunDTU;</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;  AC = &amp;RunAC;</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160; </div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent()-&gt;getDataLayout();</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;EntryBB = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock();</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = EntryBB.<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = std::prev(EntryBB.<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;       <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI = dyn_cast&lt;AllocaInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(AI-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">getAllocatedType</a>()).isScalable() &amp;&amp;</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;          <a class="code" href="namespacellvm.html#a5023b360abc7a5d1612061fba30003a6">isAllocaPromotable</a>(AI))</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;        PromotableAllocas.push_back(AI);</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;        Worklist.insert(AI);</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;    }</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;  }</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160; </div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;  <span class="keywordtype">bool</span> CFGChanged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;  <span class="comment">// A set of deleted alloca instruction pointers which should be removed from</span></div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;  <span class="comment">// the list of promotable allocas.</span></div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;AllocaInst *, 4&gt;</a> DeletedAllocas;</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160; </div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;    <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;      <span class="keyword">auto</span> [IterationChanged, IterationCFGChanged] =</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;          runOnAlloca(*Worklist.pop_back_val());</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;      Changed |= IterationChanged;</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;      CFGChanged |= IterationCFGChanged;</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160; </div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;      Changed |= deleteDeadInstructions(DeletedAllocas);</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160; </div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      <span class="comment">// Remove the deleted allocas from various lists so that we don&#39;t try to</span></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      <span class="comment">// continue processing them.</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      <span class="keywordflow">if</span> (!DeletedAllocas.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">empty</a>()) {</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;        <span class="keyword">auto</span> IsInSet = [&amp;](<a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AI) { <span class="keywordflow">return</span> DeletedAllocas.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(AI); };</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;        Worklist.remove_if(IsInSet);</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;        PostPromotionWorklist.remove_if(IsInSet);</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;        <a class="code" href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a>(PromotableAllocas, IsInSet);</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;        DeletedAllocas.<a class="code" href="classllvm_1_1SmallPtrSetImplBase.html#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      }</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;    }</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160; </div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;    Changed |= promoteAllocas(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160; </div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;    Worklist = PostPromotionWorklist;</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;    PostPromotionWorklist.clear();</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;  } <span class="keywordflow">while</span> (!Worklist.empty());</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160; </div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!CFGChanged || Changed) &amp;&amp; <span class="stringliteral">&quot;Can not only modify the CFG.&quot;</span>);</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!CFGChanged || !PreserveCFG) &amp;&amp;</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;         <span class="stringliteral">&quot;Should not have modified the CFG when told to preserve it.&quot;</span>);</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160; </div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;  <span class="keywordflow">if</span> (!Changed)</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1LegalityPredicates.html#ad7ac7032baa62cc00002886633b9f281">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160; </div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;  <a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> PA;</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;  <span class="keywordflow">if</span> (!CFGChanged)</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#a937c42f77e161349ce0f999e448c7027">preserveSet</a>&lt;<a class="code" href="classllvm_1_1CFGAnalyses.html">CFGAnalyses</a>&gt;();</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">preserve</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeAnalysis.html">DominatorTreeAnalysis</a>&gt;();</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;  <span class="keywordflow">return</span> PA;</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;}</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160; </div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="ExpandLargeDivRem_8cpp.html#ae64f9cd0977a8b47570154312540d7d2">SROAPass::runImpl</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;RunDT,</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;                                    <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;RunAC) {</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;  <a class="code" href="classllvm_1_1DomTreeUpdater.html">DomTreeUpdater</a> DTU(RunDT, DomTreeUpdater::UpdateStrategy::Lazy);</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ExpandLargeDivRem_8cpp.html#ae64f9cd0977a8b47570154312540d7d2">runImpl</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, DTU, RunAC);</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;}</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160; </div>
<div class="line"><a name="l05064"></a><span class="lineno"><a class="line" href="classllvm_1_1SROAPass.html#a6cca3e145c2eb9050c6b4b94e2f760a0"> 5064</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">SROAPass::run</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ExpandLargeDivRem_8cpp.html#ae64f9cd0977a8b47570154312540d7d2">runImpl</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeAnalysis.html">DominatorTreeAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>),</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;                 AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1AssumptionAnalysis.html">AssumptionAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;}</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160; </div>
<div class="line"><a name="l05069"></a><span class="lineno"><a class="line" href="classllvm_1_1SROAPass.html#a83580fd53eefd840860e0b048e9f6d43"> 5069</a></span>&#160;<span class="keywordtype">void</span> SROAPass::printPipeline(</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;    <a class="code" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;<a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, <a class="code" href="classllvm_1_1function__ref.html">function_ref</a>&lt;<a class="code" href="classllvm_1_1StringRef.html">StringRef</a>(<a class="code" href="classllvm_1_1StringRef.html">StringRef</a>)&gt; MapClassName2PassName) {</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;  <span class="keyword">static_cast&lt;</span><a class="code" href="structllvm_1_1PassInfoMixin.html">PassInfoMixin&lt;SROAPass&gt;</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;printPipeline(</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;      <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a>, MapClassName2PassName);</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;  <a class="code" href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a> &lt;&lt; (<a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">PreserveCFG</a> ? <span class="stringliteral">&quot;&lt;preserve-cfg&gt;&quot;</span> : <span class="stringliteral">&quot;&lt;modify-cfg&gt;&quot;</span>);</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;}</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160; </div>
<div class="line"><a name="l05076"></a><span class="lineno"><a class="line" href="classllvm_1_1SROAPass.html#ad7c554d0057ca7a875a0a8fef3d50ffa"> 5076</a></span>&#160;SROAPass::SROAPass(<a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139">SROAOptions</a> PreserveCFG_)</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;    : <a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">PreserveCFG</a>(PreserveCFG_ == <a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139">SROAOptions</a>::<a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">PreserveCFG</a>) {}</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;<span class="comment">/// A legacy pass for the legacy pass manager that wraps the \c SROA pass.</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;<span class="comment">/// This is in the llvm namespace purely to allow it to be a friend of the \c</span></div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;<span class="comment">/// SROA pass.</span></div>
<div class="line"><a name="l05083"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1SROALegacyPass.html"> 5083</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html">llvm::sroa::SROALegacyPass</a> : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {<span class="comment"></span></div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;<span class="comment">  /// The SROA implementation.</span></div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SROAPass.html">SROAPass</a> Impl;</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160; </div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l05088"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1SROALegacyPass.html#a93c951bbe78e616e8ec13cae68290529"> 5088</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html#a93c951bbe78e616e8ec13cae68290529">ID</a>;</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160; </div>
<div class="line"><a name="l05090"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1SROALegacyPass.html#ac8a7db4d24792763a166057fb427aec1"> 5090</a></span>&#160;  <a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html#ac8a7db4d24792763a166057fb427aec1">SROALegacyPass</a>(<a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139">SROAOptions</a> PreserveCFG = <a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">SROAOptions::PreserveCFG</a>)</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;      : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>), Impl(<a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">PreserveCFG</a>) {</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;    <a class="code" href="namespacellvm.html#aa9565471d05a6d7bacd8d55354f973ce">initializeSROALegacyPassPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;  }</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160; </div>
<div class="line"><a name="l05095"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1SROALegacyPass.html#ab0b465c644ab203105e098847ce1e52f"> 5095</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html#ab0b465c644ab203105e098847ce1e52f">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1FunctionPass.html#af9f5f511d75e16f09a5520cb9444cfa8">skipFunction</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160; </div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;    <span class="keyword">auto</span> PA = Impl.runImpl(</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;        <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, getAnalysis&lt;DominatorTreeWrapperPass&gt;().getDomTree(),</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;        getAnalysis&lt;AssumptionCacheTracker&gt;().getAssumptionCache(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;    <span class="keywordflow">return</span> !PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#a0eb77e2d868c69bebc48c07b49675748">areAllPreserved</a>();</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;  }</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160; </div>
<div class="line"><a name="l05105"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1SROALegacyPass.html#a32e829b338cbceb7d3acf550220ca391"> 5105</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html#a32e829b338cbceb7d3acf550220ca391">getAnalysisUsage</a>(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1AssumptionCacheTracker.html">AssumptionCacheTracker</a>&gt;();</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>&gt;();</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1GlobalsAAWrapperPass.html">GlobalsAAWrapperPass</a>&gt;();</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>&gt;();</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;  }</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160; </div>
<div class="line"><a name="l05112"></a><span class="lineno"><a class="line" href="classllvm_1_1sroa_1_1SROALegacyPass.html#a749754fd1af8fe11f0ec6d180222b443"> 5112</a></span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html#a749754fd1af8fe11f0ec6d180222b443">getPassName</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;SROA&quot;</span>; }</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;};</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160; </div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">SROALegacyPass::ID</a> = 0;</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160; </div>
<div class="line"><a name="l05117"></a><span class="lineno"><a class="line" href="namespacellvm.html#ae7e42c560dd36ec85086cc1c43b61f56"> 5117</a></span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html#ae7e42c560dd36ec85086cc1c43b61f56">llvm::createSROAPass</a>(<span class="keywordtype">bool</span> PreserveCFG) {</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html">SROALegacyPass</a>(<a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">PreserveCFG</a> ? <a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">SROAOptions::PreserveCFG</a></div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                                        : <a class="code" href="namespacellvm.html#af4e437674a39417056e3028415053139acaaa9d6e801d3edf358e569e31d9f59c">SROAOptions::ModifyCFG</a>);</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;}</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160; </div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;<a class="code" href="SROA_8cpp.html#a786d5a99befacdb30b3d3b5c3b07bd30">INITIALIZE_PASS_BEGIN</a>(<a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html">SROALegacyPass</a>, <span class="stringliteral">&quot;sroa&quot;</span>,</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                      <span class="stringliteral">&quot;Scalar Replacement Of Aggregates&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1AssumptionCacheTracker.html">AssumptionCacheTracker</a>)</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>)</div>
<div class="line"><a name="l05126"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#a6990f15b9f29df6e8497b3e53875ccab"> 5126</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(<a class="code" href="classllvm_1_1sroa_1_1SROALegacyPass.html">SROALegacyPass</a>, &quot;<a class="code" href="SROA_8cpp.html#a6990f15b9f29df6e8497b3e53875ccab">sroa</a>&quot;, &quot;Scalar Replacement Of <a class="code" href="SROA_8cpp.html#a5b3f8e5f6c512fe6a5059dd0c51aec95">Aggregates</a>&quot;,</div>
<div class="line"><a name="l05127"></a><span class="lineno"><a class="line" href="SROA_8cpp.html#acc7a95cb9fb444faf77cd626f1b8128b"> 5127</a></span>&#160;                    <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1Check_html_a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396"><div class="ttname"><a href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">llvm::Check::Size</a></div><div class="ttdeci">@ Size</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8h_source.html#l00077">FileCheck.h:77</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aPtrUseVisitor_8h_html"><div class="ttname"><a href="PtrUseVisitor_8h.html">PtrUseVisitor.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_aa8d55f500ee8cec1418f4d0016f634f0"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#aa8d55f500ee8cec1418f4d0016f634f0">llvm::sroa::AllocaSlices::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00412">SROA.cpp:412</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1PtrUseVisitorBase_html_ac5b2513c27d0e8fe9a9214eb9fe99a7b"><div class="ttname"><a href="classllvm_1_1detail_1_1PtrUseVisitorBase.html#ac5b2513c27d0e8fe9a9214eb9fe99a7b">llvm::detail::PtrUseVisitorBase::DL</a></div><div class="ttdeci">const DataLayout &amp; DL</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00110">PtrUseVisitor.h:110</a></div></div>
<div class="ttc" id="aAssumptionCache_8h_html"><div class="ttname"><a href="AssumptionCache_8h.html">AssumptionCache.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIExpression_html_ab2fc167f75191e1d22e12e8e382605bb"><div class="ttname"><a href="classllvm_1_1DIExpression.html#ab2fc167f75191e1d22e12e8e382605bb">llvm::DIExpression::createFragmentExpression</a></div><div class="ttdeci">static std::optional&lt; DIExpression * &gt; createFragmentExpression(const DIExpression *Expr, unsigned OffsetInBits, unsigned SizeInBits)</div><div class="ttdoc">Create a DIExpression to describe one part of an aggregate variable that is fragmented across multipl...</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8cpp_source.html#l01798">DebugInfoMetadata.cpp:1798</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a3287172f2d13af086e6d66364e8c6de3"><div class="ttname"><a href="classllvm_1_1Instruction.html#a3287172f2d13af086e6d66364e8c6de3">llvm::Instruction::getNumSuccessors</a></div><div class="ttdeci">unsigned getNumSuccessors() const LLVM_READONLY</div><div class="ttdoc">Return the number of successors that this instruction has.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00823">Instruction.cpp:823</a></div></div>
<div class="ttc" id="aIRTranslator_8cpp_html_abe44dfdea65b4f7e11e0a608ab708b76"><div class="ttname"><a href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div><div class="ttdeci">IRTranslator LLVM IR MI</div><div class="ttdef"><b>Definition:</b> <a href="IRTranslator_8cpp_source.html#l00109">IRTranslator.cpp:109</a></div></div>
<div class="ttc" id="aCompiler_8h_html_aa863693eef567397d9c292da5bf22d34"><div class="ttname"><a href="Compiler_8h.html#aa863693eef567397d9c292da5bf22d34">LLVM_DUMP_METHOD</a></div><div class="ttdeci">#define LLVM_DUMP_METHOD</div><div class="ttdoc">Mark debug helper function definitions like dump() that should not be stripped from debug builds.</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00492">Compiler.h:492</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a47ceb9aa6bcf5eb4e8696b93712f50a3"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a47ceb9aa6bcf5eb4e8696b93712f50a3">llvm::sroa::AllocaSlices::iterator</a></div><div class="ttdeci">SmallVectorImpl&lt; Slice &gt;::iterator iterator</div><div class="ttdoc">Support for iterating over the slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00409">SROA.cpp:409</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a563ffc2ff61c499b3be2e00100cb72fa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a563ffc2ff61c499b3be2e00100cb72fa">llvm::SmallVectorImpl::erase</a></div><div class="ttdeci">iterator erase(const_iterator CI)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00741">SmallVector.h:741</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="aLazyValueInfo_8cpp_html_a739511554e31b02d233401957fd86f44"><div class="ttname"><a href="LazyValueInfo_8cpp.html#a739511554e31b02d233401957fd86f44">Pass</a></div><div class="ttdeci">print lazy value Lazy Value Info Printer Pass</div><div class="ttdef"><b>Definition:</b> <a href="LazyValueInfo_8cpp_source.html#l02067">LazyValueInfo.cpp:2067</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a11045c7973ab24a8d6315b61fa337d4e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a11045c7973ab24a8d6315b61fa337d4e">llvm::SmallPtrSetImpl::erase</a></div><div class="ttdeci">bool erase(PtrType Ptr)</div><div class="ttdoc">erase - If the set contains the specified pointer, remove it and return true, otherwise return false.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00379">SmallPtrSet.h:379</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_ac102ff32dace1cf8e8e6f9c9ec4d159c"><div class="ttname"><a href="SROA_8cpp.html#ac102ff32dace1cf8e8e6f9c9ec4d159c">stripAggregateTypeWrapping</a></div><div class="ttdeci">static Type * stripAggregateTypeWrapping(const DataLayout &amp;DL, Type *Ty)</div><div class="ttdoc">Strip aggregate type wrapping.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l03813">SROA.cpp:3813</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a1f0ff79b64a40d383b891f1baba89c6b"><div class="ttname"><a href="classllvm_1_1PHINode.html#a1f0ff79b64a40d383b891f1baba89c6b">llvm::PHINode::incoming_values</a></div><div class="ttdeci">op_range incoming_values()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02784">Instructions.h:2784</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1generic__gep__type__iterator_html"><div class="ttname"><a href="classllvm_1_1generic__gep__type__iterator.html">llvm::generic_gep_type_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00031">GetElementPtrTypeIterator.h:31</a></div></div>
<div class="ttc" id="aArchiveWriter_8cpp_html_aa9f638c7ae7fdd206a6c60e26bef9751"><div class="ttname"><a href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a></div><div class="ttdeci">static void print(raw_ostream &amp;Out, object::Archive::Kind Kind, T Val)</div><div class="ttdef"><b>Definition:</b> <a href="ArchiveWriter_8cpp_source.html#l00189">ArchiveWriter.cpp:189</a></div></div>
<div class="ttc" id="aMetadata_8h_html"><div class="ttname"><a href="Metadata_8h.html">Metadata.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a97d45ce069c1a09ca84672df63acf096"><div class="ttname"><a href="classllvm_1_1StringRef.html#a97d45ce069c1a09ca84672df63acf096">llvm::StringRef::rfind</a></div><div class="ttdeci">size_t rfind(char C, size_t From=npos) const</div><div class="ttdoc">Search for the last character C in the string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00345">StringRef.h:345</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a7fe9ccd4893f4e2caa826126c09545ea"><div class="ttname"><a href="classllvm_1_1Type.html#a7fe9ccd4893f4e2caa826126c09545ea">llvm::Type::getInt8PtrTy</a></div><div class="ttdeci">static PointerType * getInt8PtrTy(LLVMContext &amp;C, unsigned AS=0)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00293">Type.cpp:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerIntPair_html_a60c0e4f0ed13c971edabd76dceada467"><div class="ttname"><a href="classllvm_1_1PointerIntPair.html#a60c0e4f0ed13c971edabd76dceada467">llvm::PointerIntPair::setInt</a></div><div class="ttdeci">void setInt(IntType IntVal) &amp;</div><div class="ttdef"><b>Definition:</b> <a href="PointerIntPair_8h_source.html#l00068">PointerIntPair.h:68</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aAMDGPURewriteUndefForPHI_8cpp_html_a2e83cb1bc3f5e8986cbd14575755a134"><div class="ttname"><a href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a></div><div class="ttdeci">Rewrite undef for PHI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPURewriteUndefForPHI_8cpp_source.html#l00101">AMDGPURewriteUndefForPHI.cpp:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_a42438d0a43720a6571c9138224481754"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a42438d0a43720a6571c9138224481754">llvm::AllocaInst::getAlign</a></div><div class="ttdeci">Align getAlign() const</div><div class="ttdoc">Return the alignment of the memory that is being allocated by the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00125">Instructions.h:125</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a3b996fbf8458aafffc86cb98a68d0a47"><div class="ttname"><a href="classllvm_1_1Type.html#a3b996fbf8458aafffc86cb98a68d0a47">llvm::Type::isPointerTy</a></div><div class="ttdeci">bool isPointerTy() const</div><div class="ttdoc">True if this is an instance of PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00249">Type.h:249</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIBuilder_html"><div class="ttname"><a href="classllvm_1_1DIBuilder.html">llvm::DIBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="DIBuilder_8h_source.html#l00042">DIBuilder.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html_a31704d463f766d210085cdc180a0a06f"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html#a31704d463f766d210085cdc180a0a06f">llvm::sroa::Partition::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00582">SROA.cpp:582</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_ac03b57021568dcc4d9a685c40011ff09"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">llvm::MemIntrinsicBase::getDestAlign</a></div><div class="ttdeci">MaybeAlign getDestAlign() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00847">IntrinsicInst.h:847</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aDebugInfoMetadata_8h_html"><div class="ttname"><a href="DebugInfoMetadata_8h.html">DebugInfoMetadata.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5"><div class="ttname"><a href="namespacellvm_1_1cl.html#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">llvm::cl::Prefix</a></div><div class="ttdeci">@ Prefix</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00159">CommandLine.h:159</a></div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="astructllvm_1_1PassInfoMixin_html"><div class="ttname"><a href="structllvm_1_1PassInfoMixin.html">llvm::PassInfoMixin&lt; SROAPass &gt;</a></div></div>
<div class="ttc" id="aLoads_8h_html"><div class="ttname"><a href="Loads_8h.html">Loads.h</a></div></div>
<div class="ttc" id="aclassT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferInst_html"><div class="ttname"><a href="classllvm_1_1MemTransferInst.html">llvm::MemTransferInst</a></div><div class="ttdoc">This class wraps the llvm.memcpy/memmove intrinsics.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01113">IntrinsicInst.h:1113</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0b2ca98dc28c61793ff5c90d23e5f14e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::lookup</a></div><div class="ttdeci">ValueT lookup(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">lookup - Return the entry for the specified key, or a default constructed value if no such entry exis...</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00197">DenseMap.h:197</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a6990f15b9f29df6e8497b3e53875ccab"><div class="ttname"><a href="SROA_8cpp.html#a6990f15b9f29df6e8497b3e53875ccab">sroa</a></div><div class="ttdeci">sroa</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05126">SROA.cpp:5126</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html_a7ff64b3625b6f9020556ed05a5f72af4"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">llvm::IntrinsicInst::getIntrinsicID</a></div><div class="ttdeci">Intrinsic::ID getIntrinsicID() const</div><div class="ttdoc">Return the intrinsic ID of this intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00054">IntrinsicInst.h:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_a9188f84e1dd67530330dcab9cae787d7"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a9188f84e1dd67530330dcab9cae787d7">llvm::details::FixedOrScalableQuantity::isScalable</a></div><div class="ttdeci">constexpr bool isScalable() const</div><div class="ttdoc">Returns whether the quantity is scaled by a runtime quantity (vscale).</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00166">TypeSize.h:166</a></div></div>
<div class="ttc" id="anamespacellvm_1_1at_html_acac0a0a393ce41aadc29e623549b6bfa"><div class="ttname"><a href="namespacellvm_1_1at.html#acac0a0a393ce41aadc29e623549b6bfa">llvm::at::deleteAssignmentMarkers</a></div><div class="ttdeci">void deleteAssignmentMarkers(const Instruction *Inst)</div><div class="ttdoc">Delete the llvm.dbg.assign intrinsics linked to Inst.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l01768">DebugInfo.cpp:1768</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_aef631c67bbe94f9b5a7b9a1292bf225f"><div class="ttname"><a href="classllvm_1_1StructType.html#aef631c67bbe94f9b5a7b9a1292bf225f">llvm::StructType::element_iterator</a></div><div class="ttdeci">Type::subtype_iterator element_iterator</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00315">DerivedTypes.h:315</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a18b9d328d2490f447589ba60345eba6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a18b9d328d2490f447589ba60345eba6e">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdoc">Determine the number of elements in the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00077">SetVector.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05258">Instructions.h:5258</a></div></div>
<div class="ttc" id="aGetElementPtrTypeIterator_8h_html"><div class="ttname"><a href="GetElementPtrTypeIterator_8h.html">GetElementPtrTypeIterator.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Target_html"><div class="ttname"><a href="classllvm_1_1Target.html">llvm::Target</a></div><div class="ttdoc">Target - Wrapper for Target specific information.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegistry_8h_source.html#l00149">TargetRegistry.h:149</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a4abb39a66573f61fda80469faa5d861d"><div class="ttname"><a href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">llvm::Type::getScalarType</a></div><div class="ttdeci">Type * getScalarType() const</div><div class="ttdoc">If this is a vector type, return the element type, otherwise return 'this'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00341">Type.h:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a4b001d9b458035fbbfc154d52d354ee9"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a4b001d9b458035fbbfc154d52d354ee9">llvm::ConstantInt::getValue</a></div><div class="ttdeci">const APInt &amp; getValue() const</div><div class="ttdoc">Return the constant as an APInt value reference.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00132">Constants.h:132</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26e2a938b431eaa6eca2beaa96410c9d"><div class="ttname"><a href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a></div><div class="ttdeci">auto successors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01265">MachineBasicBlock.h:1265</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_ac106bea55dfb26f8b14676aac05bd89f"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#ac106bea55dfb26f8b14676aac05bd89f">llvm::AllocaInst::getType</a></div><div class="ttdeci">PointerType * getType() const</div><div class="ttdoc">Overload to return most specific pointer type.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00100">Instructions.h:100</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8cb1f2bd469f8a823857a1cf1447a0e3"><div class="ttname"><a href="namespacellvm.html#a8cb1f2bd469f8a823857a1cf1447a0e3">llvm::llvm_unreachable_internal</a></div><div class="ttdeci">void llvm_unreachable_internal(const char *msg=nullptr, const char *file=nullptr, unsigned line=0)</div><div class="ttdoc">This function calls abort(), and prints the optional message to stderr.</div><div class="ttdef"><b>Definition:</b> <a href="ErrorHandling_8cpp_source.html#l00201">ErrorHandling.cpp:201</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_ad118358d398f591303b00c2e5462e3a9"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#ad118358d398f591303b00c2e5462e3a9">llvm::MemIntrinsicBase::getDestAddressSpace</a></div><div class="ttdeci">unsigned getDestAddressSpace() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00835">IntrinsicInst.h:835</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt; Slice, 8 &gt;</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html_a00b5d4eccf935529c4ce385032f8a589"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html#a00b5d4eccf935529c4ce385032f8a589">llvm::sroa::Partition::beginOffset</a></div><div class="ttdeci">uint64_t beginOffset() const</div><div class="ttdoc">The start offset of this partition.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00553">SROA.cpp:553</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html_af9f5f511d75e16f09a5520cb9444cfa8"><div class="ttname"><a href="classllvm_1_1FunctionPass.html#af9f5f511d75e16f09a5520cb9444cfa8">llvm::FunctionPass::skipFunction</a></div><div class="ttdeci">bool skipFunction(const Function &amp;F) const</div><div class="ttdoc">Optional passes call this function to check whether the pass should be skipped.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00174">Pass.cpp:174</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html"><div class="ttname"><a href="Support_2ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a42c6a2faff923f431932c6d33cf4092b"><div class="ttname"><a href="SROA_8cpp.html#a42c6a2faff923f431932c6d33cf4092b">insertVector</a></div><div class="ttdeci">static Value * insertVector(IRBuilderTy &amp;IRB, Value *Old, Value *V, unsigned BeginIndex, const Twine &amp;Name)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02310">SROA.cpp:2310</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder</a></div><div class="ttdoc">This provides a uniform API for creating instructions and inserting them into a basic block: either a...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l02550">IRBuilder.h:2550</a></div></div>
<div class="ttc" id="aDomTreeUpdater_8h_html"><div class="ttname"><a href="DomTreeUpdater_8h.html">DomTreeUpdater.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac9a7de5a04920954ac964059cfc428ad"><div class="ttname"><a href="namespacellvm.html#ac9a7de5a04920954ac964059cfc428ad">llvm::erase_if</a></div><div class="ttdeci">void erase_if(Container &amp;C, UnaryPredicate P)</div><div class="ttdoc">Provide a container algorithm similar to C++ Library Fundamentals v2's erase_if which is equivalent t...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01998">STLExtras.h:1998</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap&lt; Instruction *, unsigned &gt;</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aGlobalsModRef_8h_html"><div class="ttname"><a href="GlobalsModRef_8h.html">GlobalsModRef.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSliceRewriter_html_aebacad5fd967f9411dee643dee03c1af"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html#aebacad5fd967f9411dee643dee03c1af">llvm::sroa::AllocaSliceRewriter::AllocaSliceRewriter</a></div><div class="ttdeci">AllocaSliceRewriter(const DataLayout &amp;DL, AllocaSlices &amp;AS, SROAPass &amp;Pass, AllocaInst &amp;OldAI, AllocaInst &amp;NewAI, uint64_t NewAllocaBeginOffset, uint64_t NewAllocaEndOffset, bool IsIntegerPromotable, VectorType *PromotableVecTy, SmallSetVector&lt; PHINode *, 8 &gt; &amp;PHIUsers, SmallSetVector&lt; SelectInst *, 8 &gt; &amp;SelectUsers)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02432">SROA.cpp:2432</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a396be932e2034b3c3e4a482820a83aab"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a396be932e2034b3c3e4a482820a83aab">llvm::LoadInst::getPointerOperandType</a></div><div class="ttdeci">Type * getPointerOperandType() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00267">Instructions.h:267</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a73ce9bc74349e7599dd4ae32a091ede7"><div class="ttname"><a href="SROA_8cpp.html#a73ce9bc74349e7599dd4ae32a091ede7">checkVectorTypeForPromotion</a></div><div class="ttdeci">static bool checkVectorTypeForPromotion(Partition &amp;P, VectorType *VTy, const DataLayout &amp;DL)</div><div class="ttdoc">Test whether a vector type is viable for promotion.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01942">SROA.cpp:1942</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aAPInt_8h_html"><div class="ttname"><a href="APInt_8h.html">APInt.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1SROALegacyPass_html"><div class="ttname"><a href="classllvm_1_1sroa_1_1SROALegacyPass.html">llvm::sroa::SROALegacyPass</a></div><div class="ttdoc">A legacy pass for the legacy pass manager that wraps the SROA pass.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05083">SROA.cpp:5083</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html">llvm::AAMDNodes</a></div><div class="ttdoc">A collection of metadata nodes that might be associated with a memory access used by the alias-analys...</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00651">Metadata.h:651</a></div></div>
<div class="ttc" id="aclassAllocaSlices_1_1SliceBuilder_html_a8a54eb11a6edc3c5411cbedcf76b2002"><div class="ttname"><a href="classAllocaSlices_1_1SliceBuilder.html#a8a54eb11a6edc3c5411cbedcf76b2002">AllocaSlices::SliceBuilder::SliceBuilder</a></div><div class="ttdeci">SliceBuilder(const DataLayout &amp;DL, AllocaInst &amp;AI, AllocaSlices &amp;AS)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00832">SROA.cpp:832</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aDenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html_ada0b6f3c53a53b7274e7aeb23eeab5a8"><div class="ttname"><a href="classllvm_1_1DebugLoc.html#ada0b6f3c53a53b7274e7aeb23eeab5a8">llvm::DebugLoc::getInlinedAt</a></div><div class="ttdeci">DILocation * getInlinedAt() const</div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8cpp_source.html#l00039">DebugLoc.cpp:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a214ec2f04ffd92636ed4bd2717607a1d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">llvm::sys::path::end</a></div><div class="ttdeci">const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00235">Path.cpp:235</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a976e49f35fef77df271900abfdc42cd5"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a976e49f35fef77df271900abfdc42cd5">llvm::LoadInst::getPointerOperandIndex</a></div><div class="ttdeci">static unsigned getPointerOperandIndex()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00266">Instructions.h:266</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a00a76a729b319dc47beffbe07325565f"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path, Style style=Style::native)</div><div class="ttdoc">Get begin iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00226">Path.cpp:226</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_a55195fa18cf783fe74de0cced1ca6eb3"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a55195fa18cf783fe74de0cced1ca6eb3">llvm::StoreInst::setAlignment</a></div><div class="ttdeci">void setAlignment(Align Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00349">Instructions.h:349</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2f883c895f4d244f4ed56ed8a8c160c1"><div class="ttname"><a href="namespacellvm.html#a2f883c895f4d244f4ed56ed8a8c160c1">llvm::operator!=</a></div><div class="ttdeci">bool operator!=(uint64_t V1, const APInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l02040">APInt.h:2040</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html_ac161deb2a31f78c85f94fbe0f3ba97b4"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html#ac161deb2a31f78c85f94fbe0f3ba97b4">llvm::DbgVariableIntrinsic::getVariable</a></div><div class="ttdeci">DILocalVariable * getVariable() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00288">IntrinsicInst.h:288</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a46a7cbf3724080a5f4f4c7e7a4551e26"><div class="ttname"><a href="classllvm_1_1APInt.html#a46a7cbf3724080a5f4f4c7e7a4551e26">llvm::APInt::ugt</a></div><div class="ttdeci">bool ugt(const APInt &amp;RHS) const</div><div class="ttdoc">Unsigned greater than comparison.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01160">APInt.h:1160</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsic_html"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html">llvm::MemIntrinsic</a></div><div class="ttdoc">This is the common base class for memset/memcpy/memmove.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01048">IntrinsicInst.h:1048</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a53408c95a7bfb5443b43fb2134c3eb23"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">llvm::DenseMapBase&lt; SmallDenseMap&lt; KeyT, ValueT, 4, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::count</a></div><div class="ttdeci">size_type count(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">Return 1 if the specified key is in the map, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00145">DenseMap.h:145</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a7b23a52d25a9f327dadfa52d12a1a7c4"><div class="ttname"><a href="SROA_8cpp.html#a7b23a52d25a9f327dadfa52d12a1a7c4">isSafeLoadOfSelectToSpeculate</a></div><div class="ttdeci">static sroa::SelectHandSpeculativity isSafeLoadOfSelectToSpeculate(LoadInst &amp;LI, SelectInst &amp;SI, bool PreserveCFG)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01519">SROA.cpp:1519</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a4c539f826d954ab3bd78cdb0882540bd"><div class="ttname"><a href="classllvm_1_1Value.html#a4c539f826d954ab3bd78cdb0882540bd">llvm::Value::stripAndAccumulateConstantOffsets</a></div><div class="ttdeci">const Value * stripAndAccumulateConstantOffsets(const DataLayout &amp;DL, APInt &amp;Offset, bool AllowNonInbounds, bool AllowInvariantGroup=false, function_ref&lt; bool(Value &amp;Value, APInt &amp;Offset)&gt; ExternalAnalysis=nullptr) const</div><div class="ttdoc">Accumulate the constant offset this value has compared to a base pointer.</div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a250e66aa31a03567cc345ca1bc463b8c"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a></div><div class="ttdeci">uint64_t Offset</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00080">ELFObjHandler.cpp:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet&lt; Instruction *, 4 &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_a4ab0f2c30ee83d6377488de9a1f089e9"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#a4ab0f2c30ee83d6377488de9a1f089e9">llvm::MemIntrinsicBase::setDestAlignment</a></div><div class="ttdeci">void setDestAlignment(MaybeAlign Alignment)</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00856">IntrinsicInst.h:856</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aeb5a2908109c763377832cbb4726b6d4">llvm::tgtok::FalseVal</a></div><div class="ttdeci">@ FalseVal</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00062">TGLexer.h:62</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1a4cac84457299517e69ff9764fed2db"><div class="ttname"><a href="namespacellvm.html#a1a4cac84457299517e69ff9764fed2db">llvm::PromoteMemToReg</a></div><div class="ttdeci">void PromoteMemToReg(ArrayRef&lt; AllocaInst * &gt; Allocas, DominatorTree &amp;DT, AssumptionCache *AC=nullptr)</div><div class="ttdoc">Promote the specified list of alloca instructions into scalar registers, inserting PHI nodes as appro...</div><div class="ttdef"><b>Definition:</b> <a href="PromoteMemoryToRegister_8cpp_source.html#l01102">PromoteMemoryToRegister.cpp:1102</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html_a59b0ee738ec17984b97128e7f1594db3"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a59b0ee738ec17984b97128e7f1594db3">llvm::SelectInst::getFalseValue</a></div><div class="ttdeci">const Value * getFalseValue() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01795">Instructions.h:1795</a></div></div>
<div class="ttc" id="anamespacellvm_html_a81ba15e1d6d05dde87983ab4f4f6aec1"><div class="ttname"><a href="namespacellvm.html#a81ba15e1d6d05dde87983ab4f4f6aec1">llvm::FindDbgAddrUses</a></div><div class="ttdeci">TinyPtrVector&lt; DbgVariableIntrinsic * &gt; FindDbgAddrUses(Value *V)</div><div class="ttdoc">Finds all intrinsics declaring local variables as living in the memory that 'V' points to.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l00049">DebugInfo.cpp:49</a></div></div>
<div class="ttc" id="aOperator_8h_html"><div class="ttname"><a href="Operator_8h.html">Operator.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html_a12e23c3d619db313388fe11dc76eb23f"><div class="ttname"><a href="classllvm_1_1VectorType.html#a12e23c3d619db313388fe11dc76eb23f">llvm::VectorType::getElementType</a></div><div class="ttdeci">Type * getElementType() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00422">DerivedTypes.h:422</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a158da2b6d3d938aaa15b6acd00150e2c"><div class="ttname"><a href="classllvm_1_1Value.html#a158da2b6d3d938aaa15b6acd00150e2c">llvm::Value::user_begin</a></div><div class="ttdeci">user_iterator user_begin()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00397">Value.h:397</a></div></div>
<div class="ttc" id="aValueTracking_8cpp_html_a2cb59ea8f9e8543986d40c48acfd24a3"><div class="ttname"><a href="ValueTracking_8cpp.html#a2cb59ea8f9e8543986d40c48acfd24a3">getBitWidth</a></div><div class="ttdeci">static unsigned getBitWidth(Type *Ty, const DataLayout &amp;DL)</div><div class="ttdoc">Returns the bitwidth of the given scalar or pointer type.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l00089">ValueTracking.cpp:89</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_aec6eaa1e49f48c178e0ab9c030b5971e"><div class="ttname"><a href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">llvm::Instruction::copyMetadata</a></div><div class="ttdeci">void copyMetadata(const Instruction &amp;SrcInst, ArrayRef&lt; unsigned &gt; WL=ArrayRef&lt; unsigned &gt;())</div><div class="ttdoc">Copy metadata from SrcInst to this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00882">Instruction.cpp:882</a></div></div>
<div class="ttc" id="anamespacellvm_html_a03503773241005f01b090b9862aad304"><div class="ttname"><a href="namespacellvm.html#a03503773241005f01b090b9862aad304">llvm::dump</a></div><div class="ttdeci">void dump(const SparseBitVector&lt; ElementSize &gt; &amp;LHS, raw_ostream &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="SparseBitVector_8h_source.html#l00877">SparseBitVector.h:877</a></div></div>
<div class="ttc" id="aSTLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayType_html"><div class="ttname"><a href="classllvm_1_1ArrayType.html">llvm::ArrayType</a></div><div class="ttdoc">Class to represent array types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00357">DerivedTypes.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderDefaultInserter_html"><div class="ttname"><a href="classllvm_1_1IRBuilderDefaultInserter.html">llvm::IRBuilderDefaultInserter</a></div><div class="ttdoc">This provides the default implementation of the IRBuilder 'InsertHelper' method that is called whenev...</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00061">IRBuilder.h:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00264">Instructions.h:264</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac828b9b52935f87659a4adf237f820a3"><div class="ttname"><a href="namespacellvm.html#ac828b9b52935f87659a4adf237f820a3">llvm::gep_type_begin</a></div><div class="ttdeci">gep_type_iterator gep_type_begin(const User *GEP)</div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00123">GetElementPtrTypeIterator.h:123</a></div></div>
<div class="ttc" id="aCompiler_8h_html_acc1c483f4b4ee2f17bb6643a3b353609"><div class="ttname"><a href="Compiler_8h.html#acc1c483f4b4ee2f17bb6643a3b353609">LLVM_ATTRIBUTE_UNUSED</a></div><div class="ttdeci">#define LLVM_ATTRIBUTE_UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="Compiler_8h_source.html#l00172">Compiler.h:172</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_ad2fb148dfac3182fce33be95fc4e9159"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#ad2fb148dfac3182fce33be95fc4e9159">llvm::AllocaInst::getAddressSpace</a></div><div class="ttdeci">unsigned getAddressSpace() const</div><div class="ttdoc">Return the address space for the allocation.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00105">Instructions.h:105</a></div></div>
<div class="ttc" id="aConstantMerge_8cpp_html_acf172e841018fd16e65771f5ade0b297"><div class="ttname"><a href="ConstantMerge_8cpp.html#acf172e841018fd16e65771f5ade0b297">replace</a></div><div class="ttdeci">static void replace(Module &amp;M, GlobalVariable *Old, GlobalVariable *New)</div><div class="ttdef"><b>Definition:</b> <a href="ConstantMerge_8cpp_source.html#l00116">ConstantMerge.cpp:116</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdeci">@ Load</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_af51c113a039c82f6870df5dc9666b5e3"><div class="ttname"><a href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">llvm::LoadInst::getAlign</a></div><div class="ttdeci">Align getAlign() const</div><div class="ttdoc">Return the alignment of the access that is being performed.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00220">Instructions.h:220</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html">llvm::sroa::AllocaSlices</a></div><div class="ttdoc">Representation of the alloca slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00396">SROA.cpp:396</a></div></div>
<div class="ttc" id="aUse_8h_html"><div class="ttname"><a href="Use_8h.html">Use.h</a></div></div>
<div class="ttc" id="ainclude_2llvm_2Support_2CMakeLists_8txt_html_ac54dc4baeff9131a27bde4eb0527e810"><div class="ttname"><a href="include_2llvm_2Support_2CMakeLists_8txt.html#ac54dc4baeff9131a27bde4eb0527e810">endif</a></div><div class="ttdeci">__FakeVCSRevision h endif() endif() set(generated_files &quot;$</div><div class="ttdef"><b>Definition:</b> <a href="include_2llvm_2Support_2CMakeLists_8txt_source.html#l00016">CMakeLists.txt:16</a></div></div>
<div class="ttc" id="astructllvm_1_1Bitfield_html"><div class="ttname"><a href="structllvm_1_1Bitfield.html">llvm::Bitfield</a></div><div class="ttdoc">Holds functions to get, set or test bitfields.</div><div class="ttdef"><b>Definition:</b> <a href="Bitfields_8h_source.html#l00212">Bitfields.h:212</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_aff28bd42ac76fc3e1c0e4db7f9e06f2d"><div class="ttname"><a href="classllvm_1_1StoreInst.html#aff28bd42ac76fc3e1c0e4db7f9e06f2d">llvm::StoreInst::setAtomic</a></div><div class="ttdeci">void setAtomic(AtomicOrdering Ordering, SyncScope::ID SSID=SyncScope::System)</div><div class="ttdoc">Sets the ordering constraint and the synchronization scope ID of this store instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00376">Instructions.h:376</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_html_a85803b71729d5d098ca2099f23cbf72ea722ad2d05ecf4868b00c5484b82fd808"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD.html#a85803b71729d5d098ca2099f23cbf72ea722ad2d05ecf4868b00c5484b82fd808">llvm::AMDGPU::HSAMD::ValueKind::Queue</a></div><div class="ttdeci">@ Queue</div></div>
<div class="ttc" id="anamespacellvm_1_1at_html_a3c90899e8f022656e511630de42b916c"><div class="ttname"><a href="namespacellvm_1_1at.html#a3c90899e8f022656e511630de42b916c">llvm::at::getAssignmentMarkers</a></div><div class="ttdeci">AssignmentMarkerRange getAssignmentMarkers(DIAssignID *ID)</div><div class="ttdoc">Return a range of dbg.assign intrinsics which use \ID as an operand.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l01754">DebugInfo.cpp:1754</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDNode_html_a7d10a7b9b7f40b04d27ed97c38ea1950"><div class="ttname"><a href="classllvm_1_1MDNode.html#a7d10a7b9b7f40b04d27ed97c38ea1950">llvm::MDNode::get</a></div><div class="ttdeci">static MDTuple * get(LLVMContext &amp;Context, ArrayRef&lt; Metadata * &gt; MDs)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l01399">Metadata.h:1399</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd6aa057934751aaac54e5c18bcc18eb"><div class="ttname"><a href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">llvm::commonAlignment</a></div><div class="ttdeci">Align commonAlignment(Align A, uint64_t Offset)</div><div class="ttdoc">Returns the alignment that satisfies both alignments.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00212">Alignment.h:212</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a565374c44dbf08e54528a87448e10df5"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a565374c44dbf08e54528a87448e10df5">llvm::GetElementPtrInst::getSourceElementType</a></div><div class="ttdeci">Type * getSourceElementType() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01015">Instructions.h:1015</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemSetBase_html_a1f2497dcafee1cce332763e4015e23c0"><div class="ttname"><a href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">llvm::MemSetBase::getValue</a></div><div class="ttdeci">Value * getValue() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00940">IntrinsicInst.h:940</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9247a212ea89acc9573fa7e7f557eaba"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">llvm::Instruction::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdoc">Set the metadata of the specified kind to the specified node.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01455">Metadata.cpp:1455</a></div></div>
<div class="ttc" id="aARMLowOverheadLoops_8cpp_html_a0a0971d62011c35b29ff4a2325d45e93"><div class="ttname"><a href="ARMLowOverheadLoops_8cpp.html#a0a0971d62011c35b29ff4a2325d45e93">Uses</a></div><div class="ttdeci">SmallPtrSet&lt; MachineInstr *, 2 &gt; Uses</div><div class="ttdef"><b>Definition:</b> <a href="ARMLowOverheadLoops_8cpp_source.html#l00590">ARMLowOverheadLoops.cpp:590</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a593afa69fb7cfbb4506f605bd785f923"><div class="ttname"><a href="SROA_8cpp.html#a593afa69fb7cfbb4506f605bd785f923">isIntegerWideningViableForSlice</a></div><div class="ttdeci">static bool isIntegerWideningViableForSlice(const Slice &amp;S, uint64_t AllocBeginOffset, Type *AllocaTy, const DataLayout &amp;DL, bool &amp;WholeAllocaOp)</div><div class="ttdoc">Test whether a slice of an alloca is valid for integer widening.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02096">SROA.cpp:2096</a></div></div>
<div class="ttc" id="anamespacellvm_html_a387427d56330771ba6f190e27776a327"><div class="ttname"><a href="namespacellvm.html#a387427d56330771ba6f190e27776a327">llvm::getVectorSplat</a></div><div class="ttdeci">std::optional&lt; RegOrConstant &gt; getVectorSplat(const MachineInstr &amp;MI, const MachineRegisterInfo &amp;MRI)</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l01142">Utils.cpp:1142</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_a43c6ebb4fd35ebd815d66a2df4eed0b9"><div class="ttname"><a href="namespacellvm.html#a43c6ebb4fd35ebd815d66a2df4eed0b9">llvm::gep_type_end</a></div><div class="ttdeci">gep_type_iterator gep_type_end(const User *GEP)</div><div class="ttdef"><b>Definition:</b> <a href="GetElementPtrTypeIterator_8h_source.html#l00130">GetElementPtrTypeIterator.h:130</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntegerType_html_a4afdaec43ad128c62a84c3bf1241e7dd"><div class="ttname"><a href="classllvm_1_1IntegerType.html#a4afdaec43ad128c62a84c3bf1241e7dd">llvm::IntegerType::getMask</a></div><div class="ttdeci">APInt getMask() const</div><div class="ttdoc">For example, this is 0xFF for an 8 bit integer, 0xFFFF for i16, etc.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00337">Type.cpp:337</a></div></div>
<div class="ttc" id="aPointerIntPair_8h_html"><div class="ttname"><a href="PointerIntPair_8h.html">PointerIntPair.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_html_af4e437674a39417056e3028415053139"><div class="ttname"><a href="namespacellvm.html#af4e437674a39417056e3028415053139">llvm::SROAOptions</a></div><div class="ttdeci">SROAOptions</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8h_source.html#l00075">SROA.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallBitVector_html"><div class="ttname"><a href="classllvm_1_1SmallBitVector.html">llvm::SmallBitVector</a></div><div class="ttdoc">This is a 'bitvector' (really, a variable-sized bit array), optimized for the case when the array is ...</div><div class="ttdef"><b>Definition:</b> <a href="SmallBitVector_8h_source.html#l00035">SmallBitVector.h:35</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a01f11934ce1bac24a7c9190d14686844"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a01f11934ce1bac24a7c9190d14686844">llvm::GetElementPtrInst::isInBounds</a></div><div class="ttdeci">bool isInBounds() const</div><div class="ttdoc">Determine whether the GEP has the inbounds flag.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01942">Instructions.cpp:1942</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a53d4e14158c5056fd1ed8f7b3da82f8a"><div class="ttname"><a href="classllvm_1_1User.html#a53d4e14158c5056fd1ed8f7b3da82f8a">llvm::User::getOperandUse</a></div><div class="ttdeci">const Use &amp; getOperandUse(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00182">User.h:182</a></div></div>
<div class="ttc" id="anamespacellvm_1_1BitmaskEnumDetail_html_a91efa71de05b0c2d00730a0279f58658"><div class="ttname"><a href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">llvm::BitmaskEnumDetail::Mask</a></div><div class="ttdeci">constexpr std::underlying_type_t&lt; E &gt; Mask()</div><div class="ttdoc">Get a bitmask with 1s in all places up to the high-order bit of E's largest value.</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00080">BitmaskEnum.h:80</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a7febebe786555d6e0d07ca0f86e294c1"><div class="ttname"><a href="SROA_8cpp.html#a7febebe786555d6e0d07ca0f86e294c1">insertInteger</a></div><div class="ttdeci">static Value * insertInteger(const DataLayout &amp;DL, IRBuilderTy &amp;IRB, Value *Old, Value *V, uint64_t Offset, const Twine &amp;Name)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02255">SROA.cpp:2255</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a06a9071efa992145e210f0b41a52e501"><div class="ttname"><a href="SROA_8cpp.html#a06a9071efa992145e210f0b41a52e501">extractVector</a></div><div class="ttdeci">static Value * extractVector(IRBuilderTy &amp;IRB, Value *V, unsigned BeginIndex, unsigned EndIndex, const Twine &amp;Name)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02288">SROA.cpp:2288</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_a36e31f42170be95fc392dad696d9ba19"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a36e31f42170be95fc392dad696d9ba19">llvm::AllocaInst::isStaticAlloca</a></div><div class="ttdeci">bool isStaticAlloca() const</div><div class="ttdoc">Return true if this alloca is in the entry block of the function and is a constant size.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01517">Instructions.cpp:1517</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a2a394517076e7dd2bdcd7dde33dfcb7d"><div class="ttname"><a href="classllvm_1_1Type.html#a2a394517076e7dd2bdcd7dde33dfcb7d">llvm::Type::isArrayTy</a></div><div class="ttdeci">bool isArrayTy() const</div><div class="ttdoc">True if this is an instance of ArrayType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00246">Type.h:246</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5f6edc5246188225b3f49bd5c974c759"><div class="ttname"><a href="classllvm_1_1Type.html#a5f6edc5246188225b3f49bd5c974c759">llvm::Type::isSingleValueType</a></div><div class="ttdeci">bool isSingleValueType() const</div><div class="ttdoc">Return true if the type is a valid type for a register in codegen.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00280">Type.h:280</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFolder_html"><div class="ttname"><a href="classllvm_1_1ConstantFolder.html">llvm::ConstantFolder</a></div><div class="ttdoc">ConstantFolder - Create constants with minimum, target independent, folding.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantFolder_8h_source.html#l00030">ConstantFolder.h:30</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a23d87925bf94456691d6030c7d6070c4"><div class="ttname"><a href="SROA_8cpp.html#a23d87925bf94456691d6030c7d6070c4">foldPHINodeOrSelectInst</a></div><div class="ttdeci">static Value * foldPHINodeOrSelectInst(Instruction &amp;I)</div><div class="ttdoc">A helper that folds a PHI node or a select.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00804">SROA.cpp:804</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_aa4905f44616de7dcca8ce3d51685a60b"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#aa4905f44616de7dcca8ce3d51685a60b">llvm::MemTransferBase::getSourceAddressSpace</a></div><div class="ttdeci">unsigned getSourceAddressSpace() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00896">IntrinsicInst.h:896</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_a14298313bdf734e2db5a921cc6e861a0"><div class="ttname"><a href="classllvm_1_1StoreInst.html#a14298313bdf734e2db5a921cc6e861a0">llvm::StoreInst::getValueOperand</a></div><div class="ttdeci">Value * getValueOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00390">Instructions.h:390</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a185bafe1e8f07def76a3bac154a23e7a"><div class="ttname"><a href="classllvm_1_1Instruction.html#a185bafe1e8f07def76a3bac154a23e7a">llvm::Instruction::isLifetimeStartOrEnd</a></div><div class="ttdeci">bool isLifetimeStartOrEnd() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction is a llvm.lifetime.start or llvm.lifetime.end marker.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00764">Instruction.cpp:764</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html_a93a29cd4a753518a59c20c1b6ec88c76"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a93a29cd4a753518a59c20c1b6ec88c76">llvm::SelectInst::getCondition</a></div><div class="ttdeci">const Value * getCondition() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01793">Instructions.h:1793</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a786d5a99befacdb30b3d3b5c3b07bd30"><div class="ttname"><a href="SROA_8cpp.html#a786d5a99befacdb30b3d3b5c3b07bd30">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(SROALegacyPass, &quot;sroa&quot;, &quot;Scalar Replacement Of Aggregates&quot;, false, false) INITIALIZE_PASS_END(SROALegacyPass</div></div>
<div class="ttc" id="aclassllvm_1_1AddrSpaceCastInst_html"><div class="ttname"><a href="classllvm_1_1AddrSpaceCastInst.html">llvm::AddrSpaceCastInst</a></div><div class="ttdoc">This class represents a conversion between pointers from one address space to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05298">Instructions.h:5298</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="aVirtRegMap_8cpp_html_a1ad52109a2ff430460c8776286b97b2e"><div class="ttname"><a href="VirtRegMap_8cpp.html#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a></div><div class="ttdeci">Virtual Register Rewriter</div><div class="ttdef"><b>Definition:</b> <a href="VirtRegMap_8cpp_source.html#l00237">VirtRegMap.cpp:237</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a16c39eb6e60b42a40c399d8d65347bb6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const</div><div class="ttdoc">Return incoming value number x.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02794">Instructions.h:2794</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_aca741215da3a820dcdc44b32e6e4948b"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#aca741215da3a820dcdc44b32e6e4948b">llvm::sroa::AllocaSlices::AllocaSlices</a></div><div class="ttdeci">AllocaSlices(const DataLayout &amp;DL, AllocaInst &amp;AI)</div><div class="ttdoc">Construct the slices of a particular alloca.</div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_a074617b3e2f9f98ee3a2ac208e8e7210"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#a074617b3e2f9f98ee3a2ac208e8e7210">llvm::AllocaInst::getAllocatedType</a></div><div class="ttdeci">Type * getAllocatedType() const</div><div class="ttdoc">Return the type that is being allocated by the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00118">Instructions.h:118</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a84b61ef997688651dd4e06cb7567cfed"><div class="ttname"><a href="classllvm_1_1StructType.html#a84b61ef997688651dd4e06cb7567cfed">llvm::StructType::isPacked</a></div><div class="ttdeci">bool isPacked() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00273">DerivedTypes.h:273</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSliceRewriter_html"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html">llvm::sroa::AllocaSliceRewriter</a></div><div class="ttdoc">Visitor to rewrite instructions using p particular slice of an alloca to use a new alloca.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02365">SROA.cpp:2365</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html_ac370b0d5601915c0dc762c53b1eb4d89"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html#ac370b0d5601915c0dc762c53b1eb4d89">llvm::sroa::Partition::endOffset</a></div><div class="ttdeci">uint64_t endOffset() const</div><div class="ttdoc">The end offset of this partition.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00558">SROA.cpp:558</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a57efb022f2ee2e19e4cdf582f4d27f2d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a57efb022f2ee2e19e4cdf582f4d27f2d">llvm::Instruction::isAtomic</a></div><div class="ttdeci">bool isAtomic() const LLVM_READONLY</div><div class="ttdoc">Return true if this instruction has an AtomicOrdering of unordered or higher.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00666">Instruction.cpp:666</a></div></div>
<div class="ttc" id="aTwine_8h_html"><div class="ttname"><a href="Twine_8h.html">Twine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Instruction iterator methods.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00314">BasicBlock.h:314</a></div></div>
<div class="ttc" id="aConstantFolder_8h_html"><div class="ttname"><a href="ConstantFolder_8h.html">ConstantFolder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a75653059e41c0e3fc2fbb692595333b9"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a75653059e41c0e3fc2fbb692595333b9">llvm::sroa::AllocaSlices::dump</a></div><div class="ttdeci">void dump() const</div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1TinyPtrVector_html_a1437e12220a4cd03b10656dcb607c642"><div class="ttname"><a href="classllvm_1_1TinyPtrVector.html#a1437e12220a4cd03b10656dcb607c642">llvm::TinyPtrVector::push_back</a></div><div class="ttdeci">void push_back(EltTy NewVal)</div><div class="ttdef"><b>Definition:</b> <a href="TinyPtrVector_8h_source.html#l00243">TinyPtrVector.h:243</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_a539fc1724ed6975d722dc414c79adbfd"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">llvm::MemTransferBase::getRawSource</a></div><div class="ttdeci">Value * getRawSource() const</div><div class="ttdoc">Return the arguments to the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00883">IntrinsicInst.h:883</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_aab37469c4748a495736ad163ac54e776"><div class="ttname"><a href="SROA_8cpp.html#aab37469c4748a495736ad163ac54e776">isSafePHIToSpeculate</a></div><div class="ttdeci">static bool isSafePHIToSpeculate(PHINode &amp;PN)</div><div class="ttdoc">PHI instructions that use an alloca and are subsequently loaded can be rewritten to load both input p...</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01363">SROA.cpp:1363</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_a25f1fd81f2132805676c82ab8ae0c109"><div class="ttname"><a href="classllvm_1_1StringRef.html#a25f1fd81f2132805676c82ab8ae0c109">llvm::StringRef::substr</a></div><div class="ttdeci">constexpr StringRef substr(size_t Start, size_t N=npos) const</div><div class="ttdoc">Return a reference to the substring from [Start, Start + N).</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00559">StringRef.h:559</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a8536986ed6c44fce15dba30748428d2c"><div class="ttname"><a href="classllvm_1_1Type.html#a8536986ed6c44fce15dba30748428d2c">llvm::Type::isTargetExtTy</a></div><div class="ttdeci">bool isTargetExtTy() const</div><div class="ttdoc">Return true if this is a target extension type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00207">Type.h:207</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a7f31092eeb9f5a6166542a6b9b5665d8"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a7f31092eeb9f5a6166542a6b9b5665d8">llvm::sroa::AllocaSlices::getDeadUsers</a></div><div class="ttdeci">ArrayRef&lt; Instruction * &gt; getDeadUsers() const</div><div class="ttdoc">Access the dead users for this alloca.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00444">SROA.cpp:444</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdeci">@ Store</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00033">SparcInstrInfo.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00245">BasicBlock.cpp:245</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00141">StackSlotColoring.cpp:141</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="astructllvm_1_1MaybeAlign_html"><div class="ttname"><a href="structllvm_1_1MaybeAlign.html">llvm::MaybeAlign</a></div><div class="ttdoc">This struct is a compact representation of a valid (power of two) or undefined (0) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00117">Alignment.h:117</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1IntegerType_html"><div class="ttname"><a href="classllvm_1_1IntegerType.html">llvm::IntegerType</a></div><div class="ttdoc">Class to represent integer types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00040">DerivedTypes.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassAllocaSlices_1_1partition__iterator_html_a3cedc8d20ff71d84a0a9400a25c1d3a2"><div class="ttname"><a href="classAllocaSlices_1_1partition__iterator.html#a3cedc8d20ff71d84a0a9400a25c1d3a2">AllocaSlices::partition_iterator::operator++</a></div><div class="ttdeci">partition_iterator &amp; operator++()</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00771">SROA.cpp:771</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a0c1779029e78ee6d643c3319b39e3ea8"><div class="ttname"><a href="SROA_8cpp.html#a0c1779029e78ee6d643c3319b39e3ea8">getAdjustedAlignment</a></div><div class="ttdeci">static Align getAdjustedAlignment(Instruction *I, uint64_t Offset)</div><div class="ttdoc">Compute the adjusted alignment for a load or store from an offset.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01742">SROA.cpp:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeWrapperPass_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeWrapperPass.html">llvm::DominatorTreeWrapperPass</a></div><div class="ttdoc">Legacy analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00314">Dominators.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition:</b> <a href="raw__ostream_8h_source.html#l00052">raw_ostream.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a35ee267850af7c235474a8c46c7ac5af"><div class="ttname"><a href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">llvm::Value::setName</a></div><div class="ttdeci">void setName(const Twine &amp;Name)</div><div class="ttdoc">Change the name of the value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00375">Value.cpp:375</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d"><div class="ttname"><a href="namespacellvm_1_1codeview.html#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">llvm::codeview::EncodedFramePtrReg::BasePtr</a></div><div class="ttdeci">@ BasePtr</div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeUpdater_html"><div class="ttname"><a href="classllvm_1_1DomTreeUpdater.html">llvm::DomTreeUpdater</a></div><div class="ttdef"><b>Definition:</b> <a href="DomTreeUpdater_8h_source.html#l00028">DomTreeUpdater.h:28</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html_a4db8b577719aea6a098c9329061f2ac0"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html#a4db8b577719aea6a098c9329061f2ac0">llvm::sroa::Partition::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">Test whether this partition contains no slices, and merely spans a region occupied by split slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00570">SROA.cpp:570</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a50a2e57da274f8d69b9f932977379cdf"><div class="ttname"><a href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">llvm::Use::getUser</a></div><div class="ttdeci">User * getUser() const</div><div class="ttdoc">Returns the User that contains this Use.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00072">Use.h:72</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_ab3e8e781978559bd92b9dce6c03c598b"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#ab3e8e781978559bd92b9dce6c03c598b">llvm::sroa::AllocaSlices::erase</a></div><div class="ttdeci">void erase(iterator Start, iterator Stop)</div><div class="ttdoc">Erase a range of slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00423">SROA.cpp:423</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1SROALegacyPass_html_ab0b465c644ab203105e098847ce1e52f"><div class="ttname"><a href="classllvm_1_1sroa_1_1SROALegacyPass.html#ab0b465c644ab203105e098847ce1e52f">llvm::sroa::SROALegacyPass::runOnFunction</a></div><div class="ttdeci">bool runOnFunction(Function &amp;F) override</div><div class="ttdoc">runOnFunction - Virtual method overriden by subclasses to do the per-function processing of the pass.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05095">SROA.cpp:5095</a></div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_aade703948f2fdabdc65868bdf42d3141"><div class="ttname"><a href="classllvm_1_1Instruction.html#aade703948f2fdabdc65868bdf42d3141">llvm::Instruction::getAAMetadata</a></div><div class="ttdeci">AAMDNodes getAAMetadata() const</div><div class="ttdoc">Returns the AA metadata for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01499">Metadata.cpp:1499</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_ab5f836ddc7548470c429fd5daaea2784"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#ab5f836ddc7548470c429fd5daaea2784">llvm::MemTransferBase::setSourceAlignment</a></div><div class="ttdeci">void setSourceAlignment(MaybeAlign Alignment)</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00919">IntrinsicInst.h:919</a></div></div>
<div class="ttc" id="anamespacellvm_html_a47d9d4544f29bfafd32f0d62db009915"><div class="ttname"><a href="namespacellvm.html#a47d9d4544f29bfafd32f0d62db009915">llvm::SplitBlockAndInsertIfThenElse</a></div><div class="ttdeci">void SplitBlockAndInsertIfThenElse(Value *Cond, Instruction *SplitBefore, Instruction **ThenTerm, Instruction **ElseTerm, MDNode *BranchWeights=nullptr, DomTreeUpdater *DTU=nullptr)</div><div class="ttdoc">SplitBlockAndInsertIfThenElse is similar to SplitBlockAndInsertIfThen, but also creates the ElseBlock...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l01563">BasicBlockUtils.cpp:1563</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a7efd1f0c1206d95e4fe01a9b49a57b82"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a7efd1f0c1206d95e4fe01a9b49a57b82">llvm::SmallVectorImpl::append</a></div><div class="ttdeci">void append(ItTy in_start, ItTy in_end)</div><div class="ttdoc">Add the specified range to the end of the SmallVector.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00687">SmallVector.h:687</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a46ef6115027606b67adcf4d28f3dac17"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a46ef6115027606b67adcf4d28f3dac17">llvm::BasicBlock::getFirstNonPHI</a></div><div class="ttdeci">const Instruction * getFirstNonPHI() const</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00208">BasicBlock.cpp:208</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_aa512958c35cfdd696c21623a964fc2d9"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">llvm::MemTransferBase::getSourceAlign</a></div><div class="ttdeci">MaybeAlign getSourceAlign() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00909">IntrinsicInst.h:909</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_aef51af4b490af6b3bf2dfbc8737a8f9f"><div class="ttname"><a href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const</div><div class="ttdoc">Return the number of incoming edges.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02790">Instructions.h:2790</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_aca6c2de6950cb093f509ed2b67e02da2"><div class="ttname"><a href="classllvm_1_1LoadInst.html#aca6c2de6950cb093f509ed2b67e02da2">llvm::LoadInst::getSyncScopeID</a></div><div class="ttdeci">SyncScope::ID getSyncScopeID() const</div><div class="ttdoc">Returns the synchronization scope ID of this load instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00239">Instructions.h:239</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a13e877ef779ba7a0688081079f4f9b03"><div class="ttname"><a href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">llvm::Type::getIntegerBitWidth</a></div><div class="ttdeci">unsigned getIntegerBitWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00097">DerivedTypes.h:97</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a9d7de807ebdfe1819df3ff6cb0f16158"><div class="ttname"><a href="classllvm_1_1Value.html#a9d7de807ebdfe1819df3ff6cb0f16158">llvm::Value::use_empty</a></div><div class="ttdeci">bool use_empty() const</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00344">Value.h:344</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d"><div class="ttname"><a href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0ae88b4464fe326a51e6e6dfae28dd536d">llvm::omp::RTLDependInfoFields::Len</a></div><div class="ttdeci">@ Len</div></div>
<div class="ttc" id="aSROA_8cpp_html_a458f8b1b5c1beb71a2f7b1e1c151741d"><div class="ttname"><a href="SROA_8cpp.html#a458f8b1b5c1beb71a2f7b1e1c151741d">isVectorPromotionViable</a></div><div class="ttdeci">static VectorType * isVectorPromotionViable(Partition &amp;P, const DataLayout &amp;DL)</div><div class="ttdoc">Test whether the given alloca partitioning and range of slices can be promoted to a vector.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01975">SROA.cpp:1975</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemSetInst_html"><div class="ttname"><a href="classllvm_1_1MemSetInst.html">llvm::MemSetInst</a></div><div class="ttdoc">This class wraps the llvm.memset and llvm.memset.inline intrinsics.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01080">IntrinsicInst.h:1080</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae22f493ba8327ce92e87d3b96bce7017"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae22f493ba8327ce92e87d3b96bce7017">llvm::Instruction::getMetadata</a></div><div class="ttdeci">MDNode * getMetadata(unsigned KindID) const</div><div class="ttdoc">Get the metadata of given kind attached to this Instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00275">Instruction.h:275</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00059">PassSupport.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1SROALegacyPass_html_a32e829b338cbceb7d3acf550220ca391"><div class="ttname"><a href="classllvm_1_1sroa_1_1SROALegacyPass.html#a32e829b338cbceb7d3acf550220ca391">llvm::sroa::SROALegacyPass::getAnalysisUsage</a></div><div class="ttdeci">void getAnalysisUsage(AnalysisUsage &amp;AU) const override</div><div class="ttdoc">getAnalysisUsage - This function should be overriden by passes that need analysis information to do t...</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05105">SROA.cpp:5105</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_ae29b37351db200d89f52368b5c6cbdda"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#ae29b37351db200d89f52368b5c6cbdda">llvm::sroa::AllocaSlices::const_iterator</a></div><div class="ttdeci">SmallVectorImpl&lt; Slice &gt;::const_iterator const_iterator</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00415">SROA.cpp:415</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dxil_1_1PointerTypeAnalysis_html_ae574a4c1d84b9e67bc94489f356805b4"><div class="ttname"><a href="namespacellvm_1_1dxil_1_1PointerTypeAnalysis.html#ae574a4c1d84b9e67bc94489f356805b4">llvm::dxil::PointerTypeAnalysis::run</a></div><div class="ttdeci">PointerTypeMap run(const Module &amp;M)</div><div class="ttdoc">Compute the PointerTypeMap for the module M.</div><div class="ttdef"><b>Definition:</b> <a href="PointerTypeAnalysis_8cpp_source.html#l00189">PointerTypeAnalysis.cpp:189</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a10e9dec07ae53048ce77f3675169d5d8"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a10e9dec07ae53048ce77f3675169d5d8">llvm::sroa::AllocaSlices::isEscaped</a></div><div class="ttdeci">bool isEscaped() const</div><div class="ttdoc">Test whether a pointer to the allocation escapes our analysis.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00405">SROA.cpp:405</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a731895a3f577718bbaec9b180eb2a6bb"><div class="ttname"><a href="classllvm_1_1Value.html#a731895a3f577718bbaec9b180eb2a6bb">llvm::Value::dropDroppableUsesIn</a></div><div class="ttdeci">void dropDroppableUsesIn(User &amp;Usr)</div><div class="ttdoc">Remove every use of this value in User that can safely be removed.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00208">Value.cpp:208</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a97e10a8004f59e6e48be3c56d014c91e"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a97e10a8004f59e6e48be3c56d014c91e">llvm::sroa::AllocaSlices::printUse</a></div><div class="ttdeci">void printUse(raw_ostream &amp;OS, const_iterator I, StringRef Indent=&quot;  &quot;) const</div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a47fef2802996b78f0530c9b77abca9ed"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a47fef2802996b78f0530c9b77abca9ed">llvm::GetElementPtrInst::hasAllConstantIndices</a></div><div class="ttdeci">bool hasAllConstantIndices() const</div><div class="ttdoc">Return true if all of the indices of this GEP are constant integers.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01930">Instructions.cpp:1930</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ac6d28a9b11139182134a9618028a0d07"><div class="ttname"><a href="classllvm_1_1Type.html#ac6d28a9b11139182134a9618028a0d07">llvm::Type::isIntegerTy</a></div><div class="ttdeci">bool isIntegerTy() const</div><div class="ttdoc">True if this is an instance of IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00222">Type.h:222</a></div></div>
<div class="ttc" id="anamespacellvm_html_a74cdbd1e4f731e7d7cd83461b8b1de0b"><div class="ttname"><a href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a></div><div class="ttdeci">void sort(IteratorTy Start, IteratorTy End)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01683">STLExtras.h:1683</a></div></div>
<div class="ttc" id="aSROA_8h_html"><div class="ttname"><a href="SROA_8h.html">SROA.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1function__ref_html"><div class="ttname"><a href="classllvm_1_1function__ref.html">llvm::function_ref</a></div><div class="ttdoc">An efficient, type-erasing, non-owning reference to a callable.</div><div class="ttdef"><b>Definition:</b> <a href="STLFunctionalExtras_8h_source.html#l00036">STLFunctionalExtras.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerIntPair_html_ac8b55437ca130fe0c826e94e669e5d99"><div class="ttname"><a href="classllvm_1_1PointerIntPair.html#ac8b55437ca130fe0c826e94e669e5d99">llvm::PointerIntPair::getPointer</a></div><div class="ttdeci">PointerTy getPointer() const</div><div class="ttdef"><b>Definition:</b> <a href="PointerIntPair_8h_source.html#l00060">PointerIntPair.h:60</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_af8a50544090e81ac83601aff8f4b0142"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#af8a50544090e81ac83601aff8f4b0142">llvm::SmallPtrSetImplBase::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00092">SmallPtrSet.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html"><div class="ttname"><a href="classllvm_1_1VectorType.html">llvm::VectorType</a></div><div class="ttdoc">Base class of all SIMD vector types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00389">DerivedTypes.h:389</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a5fa7b4069ef3bd1ceb9f2caa315cf5ac">llvm::tgtok::In</a></div><div class="ttdeci">@ In</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00051">TGLexer.h:51</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_afc079797ba8cb5aa4d9ebfc4d85c4aab"><div class="ttname"><a href="classllvm_1_1Type.html#afc079797ba8cb5aa4d9ebfc4d85c4aab">llvm::Type::getArrayElementType</a></div><div class="ttdeci">Type * getArrayElementType() const</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00397">Type.h:397</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2f8e44f52bb2b2c5d2273eccec70faae"><div class="ttname"><a href="namespacellvm.html#a2f8e44f52bb2b2c5d2273eccec70faae">llvm::copyMetadataForLoad</a></div><div class="ttdeci">void copyMetadataForLoad(LoadInst &amp;Dest, const LoadInst &amp;Source)</div><div class="ttdoc">Copy the metadata from the source instruction to the destination (the replacement for the source inst...</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02753">Local.cpp:2753</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1DbgVariableIntrinsic_html"><div class="ttname"><a href="classllvm_1_1DbgVariableIntrinsic.html">llvm::DbgVariableIntrinsic</a></div><div class="ttdoc">This is the common base class for debug info intrinsics for variables.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00181">IntrinsicInst.h:181</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a161c2db145827f4e181e7fe662b53a81"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a161c2db145827f4e181e7fe662b53a81">llvm::LoadInst::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Returns the address space of the pointer operand.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00270">Instructions.h:270</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a7fd9ee96f281dd94ed4119c2e45836bf"><div class="ttname"><a href="SROA_8cpp.html#a7fd9ee96f281dd94ed4119c2e45836bf">isIntegerWideningViable</a></div><div class="ttdeci">static bool isIntegerWideningViable(Partition &amp;P, Type *AllocaTy, const DataLayout &amp;DL)</div><div class="ttdoc">Test whether the given alloca partition's integer operations can be widened to promotable ones.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02189">SROA.cpp:2189</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">llvm::RISCVFenceField::O</a></div><div class="ttdeci">@ O</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00277">RISCVBaseInfo.h:277</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00082">Instruction.cpp:82</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a80f5f1399bc814c650325a6c41e350e2"><div class="ttname"><a href="SROA_8cpp.html#a80f5f1399bc814c650325a6c41e350e2">speculatePHINodeLoads</a></div><div class="ttdeci">static void speculatePHINodeLoads(IRBuilderTy &amp;IRB, PHINode &amp;PN)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01437">SROA.cpp:1437</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6110fc30bc7311a6cf99814530362e21"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">llvm::AMDGPU::Hwreg::Offset</a></div><div class="ttdeci">Offset</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00432">SIDefines.h:432</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_aef61945034b9431b804748fc317c5548"><div class="ttname"><a href="ELFObjHandler_8cpp.html#aef61945034b9431b804748fc317c5548">Index</a></div><div class="ttdeci">uint32_t Index</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00083">ELFObjHandler.cpp:83</a></div></div>
<div class="ttc" id="astructllvm_1_1AAMDNodes_html_a5f73e1d64fc604ae208d9eee356dd2ab"><div class="ttname"><a href="structllvm_1_1AAMDNodes.html#a5f73e1d64fc604ae208d9eee356dd2ab">llvm::AAMDNodes::shift</a></div><div class="ttdeci">AAMDNodes shift(size_t Offset) const</div><div class="ttdoc">Create a new AAMDNode that describes this AAMDNode after applying a constant offset to the start of t...</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8h_source.html#l00705">Metadata.h:705</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructLayout_html"><div class="ttname"><a href="classllvm_1_1StructLayout.html">llvm::StructLayout</a></div><div class="ttdoc">Used to lazily calculate structure layout information for a target machine, based on the DataLayout s...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00618">DataLayout.h:618</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_aff4542b6bd9f5e44d7a52837f612852e"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#aff4542b6bd9f5e44d7a52837f612852e">llvm::sroa::AllocaSlices::end</a></div><div class="ttdeci">const_iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00419">SROA.cpp:419</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad2ea0f3a55cc5ac23db1d53c12f656f9"><div class="ttname"><a href="namespacellvm.html#ad2ea0f3a55cc5ac23db1d53c12f656f9">llvm::isSafeToLoadUnconditionally</a></div><div class="ttdeci">bool isSafeToLoadUnconditionally(Value *V, Align Alignment, APInt &amp;Size, const DataLayout &amp;DL, Instruction *ScanFrom=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if we know that executing a load from this value cannot trap.</div><div class="ttdef"><b>Definition:</b> <a href="Loads_8cpp_source.html#l00325">Loads.cpp:325</a></div></div>
<div class="ttc" id="aMemoryOpRemark_8cpp_html_a110206dd9eebb2d47fcee764884d9941"><div class="ttname"><a href="MemoryOpRemark_8cpp.html#a110206dd9eebb2d47fcee764884d9941">getSizeInBytes</a></div><div class="ttdeci">static std::optional&lt; uint64_t &gt; getSizeInBytes(std::optional&lt; uint64_t &gt; SizeInBits)</div><div class="ttdef"><b>Definition:</b> <a href="MemoryOpRemark_8cpp_source.html#l00149">MemoryOpRemark.cpp:149</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_aae20a4fd186a7a392cb3af583c470709"><div class="ttname"><a href="SROA_8cpp.html#aae20a4fd186a7a392cb3af583c470709">rewriteSelectInstMemOps</a></div><div class="ttdeci">static bool rewriteSelectInstMemOps(SelectInst &amp;SI, const sroa::RewriteableMemOps &amp;Ops, IRBuilderTy &amp;IRB, DomTreeUpdater *DTU)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01695">SROA.cpp:1695</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a2fd1d2dc14e22227cfa8238778ab87b8"><div class="ttname"><a href="classllvm_1_1Instruction.html#a2fd1d2dc14e22227cfa8238778ab87b8">llvm::Instruction::user_back</a></div><div class="ttdeci">Instruction * user_back()</div><div class="ttdoc">Specialize the methods defined in Value, as we know that an instruction can only be used by other ins...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00087">Instruction.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionAnalysis_html"><div class="ttname"><a href="classllvm_1_1AssumptionAnalysis.html">llvm::AssumptionAnalysis</a></div><div class="ttdoc">A function analysis which provides an AssumptionCache.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00173">AssumptionCache.h:173</a></div></div>
<div class="ttc" id="aSVEIntrinsicOpts_8cpp_html_a2bb87eb1bcbc74783a83ae945eb8fa36"><div class="ttname"><a href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(DominatorTreeWrapperPass)</div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_ad966bea18aa62ffb9e040509adc7c99f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">llvm::PreservedAnalyses::preserve</a></div><div class="ttdeci">void preserve()</div><div class="ttdoc">Mark an analysis as preserved.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00173">PassManager.h:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_a5127b9bac226020bc936ecdedcf72e0d"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#a5127b9bac226020bc936ecdedcf72e0d">llvm::MemTransferBase::setSource</a></div><div class="ttdeci">void setSource(Value *Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00913">IntrinsicInst.h:913</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae7e42c560dd36ec85086cc1c43b61f56"><div class="ttname"><a href="namespacellvm.html#ae7e42c560dd36ec85086cc1c43b61f56">llvm::createSROAPass</a></div><div class="ttdeci">FunctionPass * createSROAPass(bool PreserveCFG=true)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05117">SROA.cpp:5117</a></div></div>
<div class="ttc" id="anamespacellvm_1_1LegalityPredicates_html_ad7ac7032baa62cc00002886633b9f281"><div class="ttname"><a href="namespacellvm_1_1LegalityPredicates.html#ad7ac7032baa62cc00002886633b9f281">llvm::LegalityPredicates::all</a></div><div class="ttdeci">Predicate all(Predicate P0, Predicate P1)</div><div class="ttdoc">True iff P0 and P1 are true.</div><div class="ttdef"><b>Definition:</b> <a href="LegalizerInfo_8h_source.html#l00228">LegalizerInfo.h:228</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a849bc9de354f140d265e3ff56999ce19"><div class="ttname"><a href="SROA_8cpp.html#a849bc9de354f140d265e3ff56999ce19">foldSelectInst</a></div><div class="ttdeci">static Value * foldSelectInst(SelectInst &amp;SI)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00791">SROA.cpp:791</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a089cccb6f231efee72abc76d0f9c695f"><div class="ttname"><a href="classllvm_1_1PHINode.html#a089cccb6f231efee72abc76d0f9c695f">llvm::PHINode::addIncoming</a></div><div class="ttdeci">void addIncoming(Value *V, BasicBlock *BB)</div><div class="ttdoc">Add an incoming value to the end of the PHI list.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02854">Instructions.h:2854</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ad3a99906764c35b2694ae90fa57744a5"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ad3a99906764c35b2694ae90fa57744a5">move</a></div><div class="ttdeci">compiles ldr LCPI1_0 ldr ldr mov lsr tst moveq r1 ldr LCPI1_1 and r0 bx lr It would be better to do something like to fold the shift into the conditional move</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00546">README.txt:546</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html_a2825709e5cf818f9121bfa60f23de7d1"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html#a2825709e5cf818f9121bfa60f23de7d1">llvm::sroa::Partition::size</a></div><div class="ttdeci">uint64_t size() const</div><div class="ttdoc">The size of the partition.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00563">SROA.cpp:563</a></div></div>
<div class="ttc" id="aPromoteMemToReg_8h_html"><div class="ttname"><a href="PromoteMemToReg_8h.html">PromoteMemToReg.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMap_html"><div class="ttname"><a href="classllvm_1_1DenseMap.html">llvm::DenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00714">DenseMap.h:714</a></div></div>
<div class="ttc" id="anamespacellvm_html_a061b224a1a3c3486fd854e5009a858c9"><div class="ttname"><a href="namespacellvm.html#a061b224a1a3c3486fd854e5009a858c9">llvm::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(int64_t V1, const APSInt &amp;V2)</div><div class="ttdef"><b>Definition:</b> <a href="APSInt_8h_source.html#l00361">APSInt.h:361</a></div></div>
<div class="ttc" id="aIR_2DebugInfo_8h_html"><div class="ttname"><a href="IR_2DebugInfo_8h.html">DebugInfo.h</a></div></div>
<div class="ttc" id="aiterator_8h_html"><div class="ttname"><a href="iterator_8h.html">iterator.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerIntPair_html_a5f4f059462994b43b97b1213651fa969"><div class="ttname"><a href="classllvm_1_1PointerIntPair.html#a5f4f059462994b43b97b1213651fa969">llvm::PointerIntPair::getInt</a></div><div class="ttdeci">IntType getInt() const</div><div class="ttdef"><b>Definition:</b> <a href="PointerIntPair_8h_source.html#l00062">PointerIntPair.h:62</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_ace8766b97ac54db2bec8c29e4016f3f6"><div class="ttname"><a href="SROA_8cpp.html#ace8766b97ac54db2bec8c29e4016f3f6">speculateSelectInstLoads</a></div><div class="ttdeci">static void speculateSelectInstLoads(SelectInst &amp;SI, LoadInst &amp;LI, IRBuilderTy &amp;IRB)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01581">SROA.cpp:1581</a></div></div>
<div class="ttc" id="aclassllvm_1_1iterator__facade__base_html"><div class="ttname"><a href="classllvm_1_1iterator__facade__base.html">llvm::iterator_facade_base</a></div><div class="ttdoc">CRTP base class which implements the entire standard iterator facade in terms of a minimal subset of ...</div><div class="ttdef"><b>Definition:</b> <a href="iterator_8h_source.html#l00080">iterator.h:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html">llvm::GetElementPtrInst</a></div><div class="ttdoc">an instruction for type-safe pointer arithmetic to access elements of arrays and structs</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00940">Instructions.h:940</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a2b1268b642e9bf4373b6fb31c482c9ca"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a2b1268b642e9bf4373b6fb31c482c9ca">llvm::LoadInst::setAlignment</a></div><div class="ttdeci">void setAlignment(Align Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00224">Instructions.h:224</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8154638df88e4eaa568b67b23d463dac"><div class="ttname"><a href="namespacellvm.html#a8154638df88e4eaa568b67b23d463dac">llvm::make_early_inc_range</a></div><div class="ttdeci">iterator_range&lt; early_inc_iterator_impl&lt; detail::IterOfRange&lt; RangeT &gt; &gt; &gt; make_early_inc_range(RangeT &amp;&amp;Range)</div><div class="ttdoc">Make a range that does early increment to allow mutation of the underlying range without disrupting i...</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00721">STLExtras.h:721</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_ae96de1d4cd86e9e063cf40ee8910f329"><div class="ttname"><a href="SROA_8cpp.html#ae96de1d4cd86e9e063cf40ee8910f329">SROASkipMem2Reg</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; SROASkipMem2Reg(&quot;sroa-skip-mem2reg&quot;, cl::init(false), cl::Hidden)</div><div class="ttdoc">Disable running mem2reg during SROA in order to test or debug SROA.</div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_ae9562b96f6f3fa41bd36538c080035ee"><div class="ttname"><a href="classllvm_1_1PHINode.html#ae9562b96f6f3fa41bd36538c080035ee">llvm::PHINode::getBasicBlockIndex</a></div><div class="ttdeci">int getBasicBlockIndex(const BasicBlock *BB) const</div><div class="ttdoc">Return the first index of the specified basic block in the value list for this PHI.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02882">Instructions.h:2882</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html_a483700f6bf3ac62445850d768cf188f6"><div class="ttname"><a href="classllvm_1_1SelectInst.html#a483700f6bf3ac62445850d768cf188f6">llvm::SelectInst::getTrueValue</a></div><div class="ttdeci">const Value * getTrueValue() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01794">Instructions.h:1794</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugVariable_html"><div class="ttname"><a href="classllvm_1_1DebugVariable.html">llvm::DebugVariable</a></div><div class="ttdoc">Identifies a unique instance of a variable.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l03733">DebugInfoMetadata.h:3733</a></div></div>
<div class="ttc" id="aDIBuilder_8h_html"><div class="ttname"><a href="DIBuilder_8h.html">DIBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructLayout_html_afd6747ed8aad307a0a99f1fdcdadb30c"><div class="ttname"><a href="classllvm_1_1StructLayout.html#afd6747ed8aad307a0a99f1fdcdadb30c">llvm::StructLayout::getElementContainingOffset</a></div><div class="ttdeci">unsigned getElementContainingOffset(uint64_t Offset) const</div><div class="ttdoc">Given a valid byte offset into the structure, returns the structure index that contains it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00083">DataLayout.cpp:83</a></div></div>
<div class="ttc" id="aArrayRef_8h_html"><div class="ttname"><a href="ArrayRef_8h.html">ArrayRef.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="anamespacellvm_1_1LLVM__LIBRARY__VISIBILITY_html_a6c24741dd2bfb00d274c8a700d6d0eff"><div class="ttname"><a href="namespacellvm_1_1LLVM__LIBRARY__VISIBILITY.html#a6c24741dd2bfb00d274c8a700d6d0eff">llvm::LLVM_LIBRARY_VISIBILITY::PossiblySpeculatableLoad</a></div><div class="ttdeci">PointerIntPair&lt; LoadInst *, 2, sroa::SelectHandSpeculativity &gt; PossiblySpeculatableLoad</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8h_source.html#l00067">SROA.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_a33880aaca0ad05e5f1557f079305bde5"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">llvm::details::FixedOrScalableQuantity::getFixedValue</a></div><div class="ttdeci">constexpr ScalarTy getFixedValue() const</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00182">TypeSize.h:182</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0c047f127ed4380a6f383d70bec4eb94"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0c047f127ed4380a6f383d70bec4eb94">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::find</a></div><div class="ttdeci">iterator find(const_arg_type_t&lt; KeyT &gt; Val)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00150">DenseMap.h:150</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_a64ab14972c2bd5c0a01eaf7242dee624"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#a64ab14972c2bd5c0a01eaf7242dee624">llvm::MemIntrinsicBase::setDest</a></div><div class="ttdeci">void setDest(Value *Ptr)</div><div class="ttdoc">Set the specified arguments of the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00850">IntrinsicInst.h:850</a></div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="aiterator__range_8h_html"><div class="ttname"><a href="iterator__range_8h.html">iterator_range.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_ae851887270f35d2a2670a79b9833d45b"><div class="ttname"><a href="classllvm_1_1StringRef.html#ae851887270f35d2a2670a79b9833d45b">llvm::StringRef::find_first_not_of</a></div><div class="ttdeci">size_t find_first_not_of(char C, size_t From=0) const</div><div class="ttdoc">Find the first character in the string that is not C or npos if not found.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8cpp_source.html#l00251">StringRef.cpp:251</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878af6d9f1c7b49b7601fae6a545002a6763">llvm::Length</a></div><div class="ttdeci">@ Length</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSliceRewriter_html_af7b3a9bc0da17ff9e2a76885f5e4c4ed"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSliceRewriter.html#af7b3a9bc0da17ff9e2a76885f5e4c4ed">llvm::sroa::AllocaSliceRewriter::visit</a></div><div class="ttdeci">bool visit(AllocaSlices::const_iterator I)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02463">SROA.cpp:2463</a></div></div>
<div class="ttc" id="aregutils_8h_html_a8de3ed741dadc9c979a4ff17c0a9116e"><div class="ttname"><a href="regutils_8h.html#a8de3ed741dadc9c979a4ff17c0a9116e">NDEBUG</a></div><div class="ttdeci">#define NDEBUG</div><div class="ttdef"><b>Definition:</b> <a href="regutils_8h_source.html#l00048">regutils.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_a3e472e6fd83abb77745a59bccd367688"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#a3e472e6fd83abb77745a59bccd367688">llvm::MemIntrinsicBase::setLength</a></div><div class="ttdeci">void setLength(Value *L)</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00868">IntrinsicInst.h:868</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a1f475b0df44ebd7169e720fa1bf9169e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a1f475b0df44ebd7169e720fa1bf9169e">llvm::SmallPtrSetImpl::count</a></div><div class="ttdeci">size_type count(ConstPtrType Ptr) const</div><div class="ttdoc">count - Return 1 if the specified pointer is in the set, 0 otherwise.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00383">SmallPtrSet.h:383</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_af6a49991304b167c94f4a9756d3fd48f"><div class="ttname"><a href="classllvm_1_1User.html#af6a49991304b167c94f4a9756d3fd48f">llvm::User::isDroppable</a></div><div class="ttdeci">bool isDroppable() const</div><div class="ttdoc">A droppable user is a user for which uses can be dropped without affecting correctness and should be ...</div><div class="ttdef"><b>Definition:</b> <a href="User_8cpp_source.html#l00115">User.cpp:115</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4d812a2dd18aa186c164447e20e348e7"><div class="ttname"><a href="namespacellvm.html#a4d812a2dd18aa186c164447e20e348e7">llvm::operator==</a></div><div class="ttdeci">bool operator==(const AddressRangeValuePair &amp;LHS, const AddressRangeValuePair &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00153">AddressRanges.h:153</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="aM68kELFObjectWriter_8cpp_html_ae4a8bc3879d2282eefd72b16b12c2a37"><div class="ttname"><a href="M68kELFObjectWriter_8cpp.html#ae4a8bc3879d2282eefd72b16b12c2a37">getType</a></div><div class="ttdeci">static M68kRelType getType(unsigned Kind, MCSymbolRefExpr::VariantKind &amp;Modifier, bool &amp;IsPCRel)</div><div class="ttdef"><b>Definition:</b> <a href="M68kELFObjectWriter_8cpp_source.html#l00048">M68kELFObjectWriter.cpp:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1SROALegacyPass_html_a749754fd1af8fe11f0ec6d180222b443"><div class="ttname"><a href="classllvm_1_1sroa_1_1SROALegacyPass.html#a749754fd1af8fe11f0ec6d180222b443">llvm::sroa::SROALegacyPass::getPassName</a></div><div class="ttdeci">StringRef getPassName() const override</div><div class="ttdoc">getPassName - Return a nice clean name for a pass.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05112">SROA.cpp:5112</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImplBase_html_a16413f1a88d8baca228d0a1b4cc0bfc6"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImplBase.html#a16413f1a88d8baca228d0a1b4cc0bfc6">llvm::SmallPtrSetImplBase::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00095">SmallPtrSet.h:95</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_afa96fcb672bc190afac38ab7cc0e42b2"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">llvm::MemIntrinsicBase::getDest</a></div><div class="ttdeci">Value * getDest() const</div><div class="ttdoc">This is just like getRawDest, but it strips off any cast instructions (including addrspacecast) that ...</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00833">IntrinsicInst.h:833</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCacheTracker_html"><div class="ttname"><a href="classllvm_1_1AssumptionCacheTracker.html">llvm::AssumptionCacheTracker</a></div><div class="ttdoc">An immutable pass that tracks lazily created AssumptionCache objects.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00202">AssumptionCache.h:202</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_html_a627b2f86ac433d829482d5a5a0f50668"><div class="ttname"><a href="namespacellvm.html#a627b2f86ac433d829482d5a5a0f50668">llvm::isInstructionTriviallyDead</a></div><div class="ttdeci">bool isInstructionTriviallyDead(Instruction *I, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Return true if the result produced by the instruction is not used, and the instruction will return.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l00398">Local.cpp:398</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html"><div class="ttname"><a href="classllvm_1_1StructType.html">llvm::StructType</a></div><div class="ttdoc">Class to represent struct types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00213">DerivedTypes.h:213</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aInstVisitor_8h_html"><div class="ttname"><a href="InstVisitor_8h.html">InstVisitor.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructLayout_html_a9a2e735016ef95989f3e8d26a684e19f"><div class="ttname"><a href="classllvm_1_1StructLayout.html#a9a2e735016ef95989f3e8d26a684e19f">llvm::StructLayout::getSizeInBytes</a></div><div class="ttdeci">uint64_t getSizeInBytes() const</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00625">DataLayout.h:625</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_aeb534c1a0391ce24551c226a582099a7"><div class="ttname"><a href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">llvm::LoadInst::isSimple</a></div><div class="ttdeci">bool isSimple() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00256">Instructions.h:256</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCache_html"><div class="ttname"><a href="classllvm_1_1AssumptionCache.html">llvm::AssumptionCache</a></div><div class="ttdoc">A cache of @llvm.assume calls within a function.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00042">AssumptionCache.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_aea43ee5732092522ecfa6bdf2e26088e"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#aea43ee5732092522ecfa6bdf2e26088e">llvm::sroa::AllocaSlices::print</a></div><div class="ttdeci">void print(raw_ostream &amp;OS, const_iterator I, StringRef Indent=&quot;  &quot;) const</div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a0eb77e2d868c69bebc48c07b49675748"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a0eb77e2d868c69bebc48c07b49675748">llvm::PreservedAnalyses::areAllPreserved</a></div><div class="ttdeci">bool areAllPreserved() const</div><div class="ttdoc">Test whether all analyses are preserved (and none are abandoned).</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00327">PassManager.h:327</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2d5a7634b0ed15979c2cd15c62d6d4b5"><div class="ttname"><a href="namespacellvm.html#a2d5a7634b0ed15979c2cd15c62d6d4b5">llvm::PointerTy</a></div><div class="ttdeci">void * PointerTy</div><div class="ttdef"><b>Definition:</b> <a href="GenericValue_8h_source.html#l00021">GenericValue.h:21</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">llvm::Offset</a></div><div class="ttdeci">@ Offset</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a69c7da4aea6df614c83c075aa246261a"><div class="ttname"><a href="classllvm_1_1StructType.html#a69c7da4aea6df614c83c075aa246261a">llvm::StructType::element_begin</a></div><div class="ttdeci">element_iterator element_begin() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00317">DerivedTypes.h:317</a></div></div>
<div class="ttc" id="aclassllvm_1_1CFGAnalyses_html"><div class="ttname"><a href="classllvm_1_1CFGAnalyses.html">llvm::CFGAnalyses</a></div><div class="ttdoc">Represents analyses that only rely on functions' control flow.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00113">PassManager.h:113</a></div></div>
<div class="ttc" id="ainclude_2llvm_2Support_2CMakeLists_8txt_html_aef9367eb0b7430eaf70b1f2725488f2a"><div class="ttname"><a href="include_2llvm_2Support_2CMakeLists_8txt.html#aef9367eb0b7430eaf70b1f2725488f2a">if</a></div><div class="ttdeci">if(llvm_vc STREQUAL &quot;&quot;) set(fake_version_inc &quot;$</div><div class="ttdef"><b>Definition:</b> <a href="include_2llvm_2Support_2CMakeLists_8txt_source.html#l00014">CMakeLists.txt:14</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a94e7aca18fb08798727209385f164f7c"><div class="ttname"><a href="SROA_8cpp.html#a94e7aca18fb08798727209385f164f7c">extractInteger</a></div><div class="ttdeci">static Value * extractInteger(const DataLayout &amp;DL, IRBuilderTy &amp;IRB, Value *V, IntegerType *Ty, uint64_t Offset, const Twine &amp;Name)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l02230">SROA.cpp:2230</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1SROALegacyPass_html_a93c951bbe78e616e8ec13cae68290529"><div class="ttname"><a href="classllvm_1_1sroa_1_1SROALegacyPass.html#a93c951bbe78e616e8ec13cae68290529">llvm::sroa::SROALegacyPass::ID</a></div><div class="ttdeci">static char ID</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05088">SROA.cpp:5088</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdoc">Add the specified Pass class to the set of analyses preserved by this pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00098">PassAnalysisSupport.h:98</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00532">Value.cpp:532</a></div></div>
<div class="ttc" id="aclassllvm_1_1PtrUseVisitor_html"><div class="ttname"><a href="classllvm_1_1PtrUseVisitor.html">llvm::PtrUseVisitor</a></div><div class="ttdoc">A base class for visitors over the uses of a pointer value.</div><div class="ttdef"><b>Definition:</b> <a href="PtrUseVisitor_8h_source.html#l00198">PtrUseVisitor.h:198</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ms__demangle_html_a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e"><div class="ttname"><a href="namespacellvm_1_1ms__demangle.html#a851a17f7dc73f9988807242926dcc645a03c2e7e41ffc181a4e84080b4710e81e">llvm::ms_demangle::IntrinsicFunctionKind::New</a></div><div class="ttdeci">@ New</div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aCompiler_8h_html"><div class="ttname"><a href="Compiler_8h.html">Compiler.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab3fc0225d8aaf8434026c3573f961f2c"><div class="ttname"><a href="classllvm_1_1Value.html#ab3fc0225d8aaf8434026c3573f961f2c">llvm::Value::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">All values hold a context through their type.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00994">Value.cpp:994</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderBase_1_1InsertPointGuard_html"><div class="ttname"><a href="classllvm_1_1IRBuilderBase_1_1InsertPointGuard.html">llvm::IRBuilderBase::InsertPointGuard</a></div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00361">IRBuilder.h:361</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerIntPair_html_a0ebf24939b41850c8fe52ac40926a121"><div class="ttname"><a href="classllvm_1_1PointerIntPair.html#a0ebf24939b41850c8fe52ac40926a121">llvm::PointerIntPair::setPointer</a></div><div class="ttdeci">void setPointer(PointerTy PtrVal) &amp;</div><div class="ttdef"><b>Definition:</b> <a href="PointerIntPair_8h_source.html#l00064">PointerIntPair.h:64</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_aea74164514e7164813ab30bcc4b7c557"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#aea74164514e7164813ab30bcc4b7c557">llvm::AllocaInst::isArrayAllocation</a></div><div class="ttdeci">bool isArrayAllocation() const</div><div class="ttdoc">Return true if there is an allocation size parameter to the allocation instruction that is not 1.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l01508">Instructions.cpp:1508</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_ab0fa7fd7c0ff766d70d16fcd6cf8d44b"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#ab0fa7fd7c0ff766d70d16fcd6cf8d44b">llvm::sroa::AllocaSlices::partitions</a></div><div class="ttdeci">iterator_range&lt; partition_iterator &gt; partitions()</div></div>
<div class="ttc" id="aclassllvm_1_1DbgAssignIntrinsic_html"><div class="ttname"><a href="classllvm_1_1DbgAssignIntrinsic.html">llvm::DbgAssignIntrinsic</a></div><div class="ttdoc">This represents the llvm.dbg.assign instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00412">IntrinsicInst.h:412</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a17fe7e337dc0346719e8978b0a5a400b"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a17fe7e337dc0346719e8978b0a5a400b">llvm::sroa::AllocaSlices::printSlice</a></div><div class="ttdeci">void printSlice(raw_ostream &amp;OS, const_iterator I, StringRef Indent=&quot;  &quot;) const</div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_a1b45f45820a60c09244a87eb59824aec"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#a1b45f45820a60c09244a87eb59824aec">S</a></div><div class="ttdeci">add sub stmia L5 ldr r0 bl L_printf $stub Instead of a and a wouldn t it be better to do three moves *Return an aggregate type is even return S</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00210">README.txt:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstVisitor_html"><div class="ttname"><a href="classllvm_1_1InstVisitor.html">llvm::InstVisitor</a></div><div class="ttdoc">Base class for instruction visitors.</div><div class="ttdef"><b>Definition:</b> <a href="InstVisitor_8h_source.html#l00078">InstVisitor.h:78</a></div></div>
<div class="ttc" id="anamespacellvm_html_a92be87f8a371f277f7260fb99592d5f4"><div class="ttname"><a href="namespacellvm.html#a92be87f8a371f277f7260fb99592d5f4">llvm::unique</a></div><div class="ttdeci">auto unique(Range &amp;&amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00056">GenericUniformityImpl.h:56</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_ab4c31035e44c7bda618eb2eb81dcf314"><div class="ttname"><a href="SROA_8cpp.html#ab4c31035e44c7bda618eb2eb81dcf314">isVectorPromotionViableForSlice</a></div><div class="ttdeci">static bool isVectorPromotionViableForSlice(Partition &amp;P, const Slice &amp;S, VectorType *Ty, uint64_t ElementSize, const DataLayout &amp;DL)</div><div class="ttdoc">Test whether the given slice use can be promoted to a vector.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01868">SROA.cpp:1868</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ab03652069eab17006c51f00c261a6a44"><div class="ttname"><a href="classllvm_1_1Type.html#ab03652069eab17006c51f00c261a6a44">llvm::Type::isPtrOrPtrVectorTy</a></div><div class="ttdeci">bool isPtrOrPtrVectorTy() const</div><div class="ttdoc">Return true if this is a pointer type or a vector of pointer types.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00255">Type.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a6ae88dc44b078c80ce3a25401fd4b05b"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a6ae88dc44b078c80ce3a25401fd4b05b">llvm::LoadInst::setAtomic</a></div><div class="ttdeci">void setAtomic(AtomicOrdering Ordering, SyncScope::ID SSID=SyncScope::System)</div><div class="ttdoc">Sets the ordering constraint and the synchronization scope ID of this load instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00250">Instructions.h:250</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key_html_a4eea8fbc268a347761cbbc80e3660544"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Arg_1_1Key.html#a4eea8fbc268a347761cbbc80e3660544">llvm::AMDGPU::HSAMD::Kernel::Arg::Key::IsVolatile</a></div><div class="ttdeci">constexpr char IsVolatile[]</div><div class="ttdoc">Key for Kernel::Arg::Metadata::mIsVolatile.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00199">AMDGPUMetadata.h:199</a></div></div>
<div class="ttc" id="anamespacellvm_html_af4e437674a39417056e3028415053139acaaa9d6e801d3edf358e569e31d9f59c"><div class="ttname"><a href="namespacellvm.html#af4e437674a39417056e3028415053139acaaa9d6e801d3edf358e569e31d9f59c">llvm::SROAOptions::ModifyCFG</a></div><div class="ttdeci">@ ModifyCFG</div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a93603fe0d4168b92a901f06015ecb2e7"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a93603fe0d4168b92a901f06015ecb2e7">llvm::LoadInst::getOrdering</a></div><div class="ttdeci">AtomicOrdering getOrdering() const</div><div class="ttdoc">Returns the ordering constraint of this load instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00229">Instructions.h:229</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a5b3f8e5f6c512fe6a5059dd0c51aec95"><div class="ttname"><a href="SROA_8cpp.html#a5b3f8e5f6c512fe6a5059dd0c51aec95">Aggregates</a></div><div class="ttdeci">Scalar Replacement Of Aggregates</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05126">SROA.cpp:5126</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a338590123630c357df6340c38d066572"><div class="ttname"><a href="classllvm_1_1Value.html#a338590123630c357df6340c38d066572">llvm::Value::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdoc">Set a particular kind of metadata attachment.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01325">Metadata.cpp:1325</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a0566221f10834bfcea70965379745a20"><div class="ttname"><a href="classllvm_1_1Type.html#a0566221f10834bfcea70965379745a20">llvm::Type::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">Return the LLVMContext in which this type was uniqued.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00129">Type.h:129</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a99f811d53704275b4158c62a2dd138d9"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a99f811d53704275b4158c62a2dd138d9">llvm::DenseMapBase::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00207">DenseMap.h:207</a></div></div>
<div class="ttc" id="aSampleProfWriter_8cpp_html_ac5f3689931c7238da06ba00cf1002c62"><div class="ttname"><a href="SampleProfWriter_8cpp.html#ac5f3689931c7238da06ba00cf1002c62">OS</a></div><div class="ttdeci">raw_pwrite_stream &amp; OS</div><div class="ttdef"><b>Definition:</b> <a href="SampleProfWriter_8cpp_source.html#l00053">SampleProfWriter.cpp:53</a></div></div>
<div class="ttc" id="aclassAllocaSlices_1_1partition__iterator_html_a09094d8b7d9ec638b7c1dab3c9a2060d"><div class="ttname"><a href="classAllocaSlices_1_1partition__iterator.html#a09094d8b7d9ec638b7c1dab3c9a2060d">AllocaSlices::partition_iterator::operator==</a></div><div class="ttdeci">bool operator==(const partition_iterator &amp;RHS) const</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00751">SROA.cpp:751</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ed745230c0e6c52f4b1ec0dae8c07fb"><div class="ttname"><a href="classllvm_1_1Value.html#a3ed745230c0e6c52f4b1ec0dae8c07fb">llvm::Value::stripInBoundsOffsets</a></div><div class="ttdeci">const Value * stripInBoundsOffsets(function_ref&lt; void(const Value *)&gt; Func=[](const Value *) {}) const</div><div class="ttdoc">Strip off pointer casts and inbounds GEPs.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00777">Value.cpp:777</a></div></div>
<div class="ttc" id="aPoisonChecking_8cpp_html_a702ebb77e7ff7f0a10a1b4690d8ecfc8"><div class="ttname"><a href="PoisonChecking_8cpp.html#a702ebb77e7ff7f0a10a1b4690d8ecfc8">rewrite</a></div><div class="ttdeci">static bool rewrite(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="PoisonChecking_8cpp_source.html#l00255">PoisonChecking.cpp:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ac09a21c371a9c535cbc13e8f82503aec"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit unsigned integer value after it has been zero extended as appropriate...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00141">Constants.h:141</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a1dc76cc8bf703e6ada68bededcbb9573"><div class="ttname"><a href="classllvm_1_1APInt.html#a1dc76cc8bf703e6ada68bededcbb9573">llvm::APInt::zext</a></div><div class="ttdeci">APInt zext(unsigned width) const</div><div class="ttdoc">Zero extend to a new width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l00973">APInt.cpp:973</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a6ea260be710ac7b61309534308da3147"><div class="ttname"><a href="classllvm_1_1Instruction.html#a6ea260be710ac7b61309534308da3147">llvm::Instruction::mayHaveSideEffects</a></div><div class="ttdeci">bool mayHaveSideEffects() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction may have side effects.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00745">Instruction.cpp:745</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a96bda22e654a59fec0620767b56dd53f"><div class="ttname"><a href="classllvm_1_1SetVector.html#a96bda22e654a59fec0620767b56dd53f">llvm::SetVector&lt; T, SmallVector&lt; T, N &gt;, SmallDenseSet&lt; T, N &gt; &gt;::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Completely clear the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00213">SetVector.h:213</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_adda9304aaf3716109938d9479b2d2dbc"><div class="ttname"><a href="classllvm_1_1Instruction.html#adda9304aaf3716109938d9479b2d2dbc">llvm::Instruction::isLaunderOrStripInvariantGroup</a></div><div class="ttdeci">bool isLaunderOrStripInvariantGroup() const LLVM_READONLY</div><div class="ttdoc">Return true if the instruction is a llvm.launder.invariant.group or llvm.strip.invariant....</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00772">Instruction.cpp:772</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_ad9fd340fc6b63cbabc1f9d96f5494bcc"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#ad9fd340fc6b63cbabc1f9d96f5494bcc">llvm::sroa::AllocaSlices::insert</a></div><div class="ttdeci">void insert(ArrayRef&lt; Slice &gt; NewSlices)</div><div class="ttdoc">Insert new slices for this alloca.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00430">SROA.cpp:430</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_abe75ff888b6a7ee2836aa6c8f33984c1"><div class="ttname"><a href="SROA_8cpp.html#abe75ff888b6a7ee2836aa6c8f33984c1">getTypePartition</a></div><div class="ttdeci">static Type * getTypePartition(const DataLayout &amp;DL, Type *Ty, uint64_t Offset, uint64_t Size)</div><div class="ttdoc">Try to find a partition of the aggregate type passed in for a given offset and size.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l03851">SROA.cpp:3851</a></div></div>
<div class="ttc" id="aConstant_8h_html"><div class="ttname"><a href="Constant_8h.html">Constant.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdoc">Twine - A lightweight data structure for efficiently representing the concatenation of temporary valu...</div><div class="ttdef"><b>Definition:</b> <a href="Twine_8h_source.html#l00081">Twine.h:81</a></div></div>
<div class="ttc" id="aclassAllocaSlices_1_1partition__iterator_html"><div class="ttname"><a href="classAllocaSlices_1_1partition__iterator.html">AllocaSlices::partition_iterator</a></div><div class="ttdoc">An iterator over partitions of the alloca's slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00602">SROA.cpp:602</a></div></div>
<div class="ttc" id="anamespacellvm_html_a076f93c387f454f0db13d4bc7d4e7f9c"><div class="ttname"><a href="namespacellvm.html#a076f93c387f454f0db13d4bc7d4e7f9c">llvm::stable_sort</a></div><div class="ttdeci">void stable_sort(R &amp;&amp;Range)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01948">STLExtras.h:1948</a></div></div>
<div class="ttc" id="anamespacellvm_1_1GraphProgram_html_a0ad4685976f8c4d4a697a53fbe05d10b"><div class="ttname"><a href="namespacellvm_1_1GraphProgram.html#a0ad4685976f8c4d4a697a53fbe05d10b">llvm::GraphProgram::Name</a></div><div class="ttdeci">Name</div><div class="ttdef"><b>Definition:</b> <a href="GraphWriter_8h_source.html#l00050">GraphWriter.h:50</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a7d6146d9a22768498097b2c53cd2234f"><div class="ttname"><a href="SROA_8cpp.html#a7d6146d9a22768498097b2c53cd2234f">convertValue</a></div><div class="ttdeci">static Value * convertValue(const DataLayout &amp;DL, IRBuilderTy &amp;IRB, Value *V, Type *NewTy)</div><div class="ttdoc">Generic routine to convert an SSA value to a value of a different type.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01814">SROA.cpp:1814</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_abcb1eb8c51771752c4fee2d539fa25cc"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">llvm::MemIntrinsicBase::getLength</a></div><div class="ttdeci">Value * getLength() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00824">IntrinsicInst.h:824</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html_a0b447f960e9d79bfca42b03938b86955"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html#a0b447f960e9d79bfca42b03938b86955">llvm::sroa::Partition::splitSliceTails</a></div><div class="ttdeci">ArrayRef&lt; Slice * &gt; splitSliceTails() const</div><div class="ttdoc">Get the sequence of split slice tails.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00590">SROA.cpp:590</a></div></div>
<div class="ttc" id="alib_2Target_2PowerPC_2README_8txt_html_aa91241c8c54738377749dc47ee489e0d"><div class="ttname"><a href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">get</a></div><div class="ttdeci">Should compile to something r4 addze r3 instead we get</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2PowerPC_2README_8txt_source.html#l00024">README.txt:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a65520b9c67759099e313d0f4e7b5ff9e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a65520b9c67759099e313d0f4e7b5ff9e">llvm::DenseMapBase&lt; DenseMap&lt; KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;, KeyT, ValueT, DenseMapInfo&lt; KeyT &gt;, llvm::detail::DenseMapPair&lt; KeyT, ValueT &gt; &gt;::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00084">DenseMap.h:84</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructLayout_html_a9b53bc4ade993c638837c1344465c1f8"><div class="ttname"><a href="classllvm_1_1StructLayout.html#a9b53bc4ade993c638837c1344465c1f8">llvm::StructLayout::getElementOffset</a></div><div class="ttdeci">uint64_t getElementOffset(unsigned Idx) const</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00648">DataLayout.h:648</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_aab36927882fbfdcbb860d87fd9c30da8"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#aab36927882fbfdcbb860d87fd9c30da8">llvm::ArrayRef::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00151">ArrayRef.h:151</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a350324aa0625cf34f3ae212398215e59"><div class="ttname"><a href="SROA_8cpp.html#a350324aa0625cf34f3ae212398215e59">rewriteMemOpOfSelect</a></div><div class="ttdeci">static void rewriteMemOpOfSelect(SelectInst &amp;SI, T &amp;I, sroa::SelectHandSpeculativity Spec, DomTreeUpdater &amp;DTU)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01625">SROA.cpp:1625</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa9565471d05a6d7bacd8d55354f973ce"><div class="ttname"><a href="namespacellvm.html#aa9565471d05a6d7bacd8d55354f973ce">llvm::initializeSROALegacyPassPass</a></div><div class="ttdeci">void initializeSROALegacyPassPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a34ee40bb2f4f5ece47ef19e5f1f57e3c"><div class="ttname"><a href="classllvm_1_1Type.html#a34ee40bb2f4f5ece47ef19e5f1f57e3c">llvm::Type::isIntOrIntVectorTy</a></div><div class="ttdeci">bool isIntOrIntVectorTy() const</div><div class="ttdoc">Return true if this is an integer type or a vector of integer types.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00228">Type.h:228</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_ab040eb97b6dfc28714a55b93c66ae560"><div class="ttname"><a href="SROA_8cpp.html#ab040eb97b6dfc28714a55b93c66ae560">findCommonType</a></div><div class="ttdeci">static std::pair&lt; Type *, IntegerType * &gt; findCommonType(AllocaSlices::const_iterator B, AllocaSlices::const_iterator E, uint64_t EndOffset)</div><div class="ttdoc">Walk the range of a partitioning looking for a common type to cover this sequence of slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01297">SROA.cpp:1297</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a9b5fc98b47d44d1150d3610bdfab1430"><div class="ttname"><a href="classllvm_1_1APInt.html#a9b5fc98b47d44d1150d3610bdfab1430">llvm::APInt::sextOrTrunc</a></div><div class="ttdeci">APInt sextOrTrunc(unsigned width) const</div><div class="ttdoc">Sign extend or truncate to width.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8cpp_source.html#l01002">APInt.cpp:1002</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html"><div class="ttname"><a href="classllvm_1_1TypeSize.html">llvm::TypeSize</a></div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00314">TypeSize.h:314</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4dd9b6c5bb93e01393c47dbe60f8b23f"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4dd9b6c5bb93e01393c47dbe60f8b23f">llvm::Instruction::setAAMetadata</a></div><div class="ttdeci">void setAAMetadata(const AAMDNodes &amp;N)</div><div class="ttdoc">Sets the AA metadata on this instruction from the AAMDNodes structure.</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01513">Metadata.cpp:1513</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1TargetStackID_html_a71392100eb15ba746b1f898986f5d8a5"><div class="ttname"><a href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">llvm::TargetStackID::Value</a></div><div class="ttdeci">Value</div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00027">TargetFrameLowering.h:27</a></div></div>
<div class="ttc" id="aPassManager_8h_html"><div class="ttname"><a href="PassManager_8h.html">PassManager.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a1d854d7ca4568e7840af5520a9012960"><div class="ttname"><a href="classllvm_1_1StructType.html#a1d854d7ca4568e7840af5520a9012960">llvm::StructType::element_end</a></div><div class="ttdeci">element_iterator element_end() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00318">DerivedTypes.h:318</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_adc01a7457de85fc52a3bb860d7e1c6a4"><div class="ttname"><a href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0) const</div><div class="ttdoc">Return a pointer to the current type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00776">Type.cpp:776</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIAssignID_html_a9d9cf0278178d1da39f6797777e683f7"><div class="ttname"><a href="classllvm_1_1DIAssignID.html#a9d9cf0278178d1da39f6797777e683f7">llvm::DIAssignID::getDistinct</a></div><div class="ttdeci">static DIAssignID * getDistinct(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00320">DebugInfoMetadata.h:320</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_ad623c5de7cef19ac3e16d041973aead1"><div class="ttname"><a href="SROA_8cpp.html#ad623c5de7cef19ac3e16d041973aead1">getAdjustedPtr</a></div><div class="ttdeci">static Value * getAdjustedPtr(IRBuilderTy &amp;IRB, const DataLayout &amp;DL, Value *Ptr, APInt Offset, Type *PointerTy, const Twine &amp;NamePrefix)</div><div class="ttdoc">Compute an adjusted pointer from Ptr by Offset bytes where the resulting pointer has PointerTy.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01729">SROA.cpp:1729</a></div></div>
<div class="ttc" id="astructllvm_1_1Spec_html"><div class="ttname"><a href="structllvm_1_1Spec.html">llvm::Spec</a></div><div class="ttdef"><b>Definition:</b> <a href="FunctionSpecialization_8h_source.html#l00087">FunctionSpecialization.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a29857cfc1d48f6de8eed646ab1fa87f4"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a29857cfc1d48f6de8eed646ab1fa87f4">llvm::sroa::AllocaSlices::getDeadUsesIfPromotable</a></div><div class="ttdeci">ArrayRef&lt; Use * &gt; getDeadUsesIfPromotable() const</div><div class="ttdoc">Access Uses that should be dropped if the alloca is promotable.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00447">SROA.cpp:447</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00614">SmallVector.h:614</a></div></div>
<div class="ttc" id="aExpandLargeDivRem_8cpp_html_ae64f9cd0977a8b47570154312540d7d2"><div class="ttname"><a href="ExpandLargeDivRem_8cpp.html#ae64f9cd0977a8b47570154312540d7d2">runImpl</a></div><div class="ttdeci">static bool runImpl(Function &amp;F, const TargetLowering &amp;TLI)</div><div class="ttdef"><b>Definition:</b> <a href="ExpandLargeDivRem_8cpp_source.html#l00056">ExpandLargeDivRem.cpp:56</a></div></div>
<div class="ttc" id="aclassllvm_1_1SROAPass_html"><div class="ttname"><a href="classllvm_1_1SROAPass.html">llvm::SROAPass</a></div><div class="ttdoc">An optimization pass providing Scalar Replacement of Aggregates.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8h_source.html#l00095">SROA.h:95</a></div></div>
<div class="ttc" id="aclassAllocaSlices_1_1partition__iterator_html_a64182764501ef8a15b182a843c5bc545"><div class="ttname"><a href="classAllocaSlices_1_1partition__iterator.html#a64182764501ef8a15b182a843c5bc545">AllocaSlices::partition_iterator::operator*</a></div><div class="ttdeci">Partition &amp; operator*()</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00776">SROA.cpp:776</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">llvm::logicalview::LVAttributeKind::Inserted</a></div><div class="ttdeci">@ Inserted</div></div>
<div class="ttc" id="aGlobalAlias_8h_html"><div class="ttname"><a href="GlobalAlias_8h.html">GlobalAlias.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1LLVM__LIBRARY__VISIBILITY_html_a4336b55aee4e59a84195fe0edde8d27e"><div class="ttname"><a href="namespacellvm_1_1LLVM__LIBRARY__VISIBILITY.html#a4336b55aee4e59a84195fe0edde8d27e">llvm::LLVM_LIBRARY_VISIBILITY::RewriteableMemOps</a></div><div class="ttdeci">SmallVector&lt; RewriteableMemOp, 2 &gt; RewriteableMemOps</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8h_source.html#l00071">SROA.h:71</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a8af3766b5bd3b1e331107abd3f04fcbd"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a8af3766b5bd3b1e331107abd3f04fcbd">llvm::sroa::AllocaSlices::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00413">SROA.cpp:413</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="astructllvm_1_1DIExpression_1_1FragmentInfo_html"><div class="ttname"><a href="structllvm_1_1DIExpression_1_1FragmentInfo.html">llvm::DIExpression::FragmentInfo</a></div><div class="ttdoc">Holds the characteristics of one fragment of a larger variable.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l02776">DebugInfoMetadata.h:2776</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_a9b8a0a23f493d9796c5887dbbe1905e9"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#a9b8a0a23f493d9796c5887dbbe1905e9">llvm::GetElementPtrInst::indices</a></div><div class="ttdeci">iterator_range&lt; op_iterator &gt; indices()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01055">Instructions.h:1055</a></div></div>
<div class="ttc" id="anamespaceAllocaSlices_html"><div class="ttname"><a href="namespaceAllocaSlices.html">AllocaSlices</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeAnalysis_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeAnalysis.html">llvm::DominatorTreeAnalysis</a></div><div class="ttdoc">Analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00279">Dominators.h:279</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a54155244e7b172a97fe5b3096d84fa97"><div class="ttname"><a href="classllvm_1_1Type.html#a54155244e7b172a97fe5b3096d84fa97">llvm::Type::isOpaquePointerTy</a></div><div class="ttdeci">bool isOpaquePointerTy() const</div><div class="ttdoc">True if this is an instance of an opaque PointerType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00060">Type.cpp:60</a></div></div>
<div class="ttc" id="aclassllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdoc">Pass interface - Implemented by all 'passes'.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00091">Pass.h:91</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a937c42f77e161349ce0f999e448c7027"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a937c42f77e161349ce0f999e448c7027">llvm::PreservedAnalyses::preserveSet</a></div><div class="ttdeci">void preserveSet()</div><div class="ttdoc">Mark an analysis set as preserved.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00188">PassManager.h:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_ab4cfdcb84d9daaf485a77caf4e8422b0"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#ab4cfdcb84d9daaf485a77caf4e8422b0">llvm::MemIntrinsicBase::getRawDestUse</a></div><div class="ttdeci">const Use &amp; getRawDestUse() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00821">IntrinsicInst.h:821</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html">llvm::sroa::Partition</a></div><div class="ttdoc">A partition of the slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00528">SROA.cpp:528</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a81eef9d7336f7ee43be79630d8e8ec86"><div class="ttname"><a href="classllvm_1_1Type.html#a81eef9d7336f7ee43be79630d8e8ec86">llvm::Type::isStructTy</a></div><div class="ttdeci">bool isStructTy() const</div><div class="ttdoc">True if this is an instance of StructType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00243">Type.h:243</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerIntPair_html"><div class="ttname"><a href="classllvm_1_1PointerIntPair.html">llvm::PointerIntPair&lt; Use *, 1, bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_a2eccc19f9061eeb7ad1e30e21f76034d"><div class="ttname"><a href="classllvm_1_1LoadInst.html#a2eccc19f9061eeb7ad1e30e21f76034d">llvm::LoadInst::isVolatile</a></div><div class="ttdeci">bool isVolatile() const</div><div class="ttdoc">Return true if this is a load from a volatile memory location.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00214">Instructions.h:214</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsic_html_ada78af22b202d8b7d9fe772c2c9476ce"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">llvm::MemIntrinsic::isVolatile</a></div><div class="ttdeci">bool isVolatile() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01057">IntrinsicInst.h:1057</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a98973e137d3459280cfe4aa8f4710bd1"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a98973e137d3459280cfe4aa8f4710bd1">llvm::sroa::AllocaSlices::getDeadOperands</a></div><div class="ttdeci">ArrayRef&lt; Use * &gt; getDeadOperands() const</div><div class="ttdoc">Access the dead operands referring to this alloca.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00457">SROA.cpp:457</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aUser_8h_html"><div class="ttname"><a href="User_8h.html">User.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_ac03c1c093059ea000216af8dd6f2dbf4"><div class="ttname"><a href="classllvm_1_1StoreInst.html#ac03c1c093059ea000216af8dd6f2dbf4">llvm::StoreInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00393">Instructions.h:393</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a2eeb1c7ed1cfe403f2ae0470e36c07e2"><div class="ttname"><a href="classllvm_1_1User.html#a2eeb1c7ed1cfe403f2ae0470e36c07e2">llvm::User::op_begin</a></div><div class="ttdeci">op_iterator op_begin()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00234">User.h:234</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DIAssignID_html"><div class="ttname"><a href="classllvm_1_1DIAssignID.html">llvm::DIAssignID</a></div><div class="ttdoc">Assignment ID.</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfoMetadata_8h_source.html#l00302">DebugInfoMetadata.h:302</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_a2fb1c078833c17e4c9529b0cf924385c"><div class="ttname"><a href="SROA_8cpp.html#a2fb1c078833c17e4c9529b0cf924385c">canConvertValue</a></div><div class="ttdeci">static bool canConvertValue(const DataLayout &amp;DL, Type *OldTy, Type *NewTy)</div><div class="ttdoc">Test whether we can convert a value from the old to the new type.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l01752">SROA.cpp:1752</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aSmallBitVector_8h_html"><div class="ttname"><a href="SmallBitVector_8h.html">SmallBitVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassAllocaSlices_1_1SliceBuilder_html"><div class="ttname"><a href="classAllocaSlices_1_1SliceBuilder.html">AllocaSlices::SliceBuilder</a></div><div class="ttdoc">Builder for the alloca slices.</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00816">SROA.cpp:816</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalsAAWrapperPass_html"><div class="ttname"><a href="classllvm_1_1GlobalsAAWrapperPass.html">llvm::GlobalsAAWrapperPass</a></div><div class="ttdoc">Legacy wrapper pass to provide the GlobalsAAResult object.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalsModRef_8h_source.html#l00142">GlobalsModRef.h:142</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a8ce0c4746a1ec805e66409d20ae93922"><div class="ttname"><a href="classllvm_1_1PHINode.html#a8ce0c4746a1ec805e66409d20ae93922">llvm::PHINode::getIncomingBlock</a></div><div class="ttdeci">BasicBlock * getIncomingBlock(unsigned i) const</div><div class="ttdoc">Return incoming basic block number i.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02814">Instructions.h:2814</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntegerType_html_a90b790ccb1af4ea5ccd69db4b8cd2d81"><div class="ttname"><a href="classllvm_1_1IntegerType.html#a90b790ccb1af4ea5ccd69db4b8cd2d81">llvm::IntegerType::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const</div><div class="ttdoc">Get the number of bits in this IntegerType.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00072">DerivedTypes.h:72</a></div></div>
<div class="ttc" id="aclassllvm_1_1iterator__range_html"><div class="ttname"><a href="classllvm_1_1iterator__range.html">llvm::iterator_range</a></div><div class="ttdoc">A range adaptor for a pair of iterators.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00030">iterator_range.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilderDefaultInserter_html_a274cf38ada86762393bc3c51212899f7"><div class="ttname"><a href="classllvm_1_1IRBuilderDefaultInserter.html#a274cf38ada86762393bc3c51212899f7">llvm::IRBuilderDefaultInserter::InsertHelper</a></div><div class="ttdeci">virtual void InsertHelper(Instruction *I, const Twine &amp;Name, BasicBlock *BB, BasicBlock::iterator InsertPt) const</div><div class="ttdef"><b>Definition:</b> <a href="IRBuilder_8h_source.html#l00065">IRBuilder.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02708">Instructions.h:2708</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_a97b21472e892da8be5c2f22d6ec21300"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">llvm::MemIntrinsicBase::getRawDest</a></div><div class="ttdeci">Value * getRawDest() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00818">IntrinsicInst.h:818</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl</a></div><div class="ttdoc">This class consists of common code factored out of the SmallVector class to reduce code duplication b...</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l00042">APFloat.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html_a6cb66137274f95e4bf6b324b8af9ab56"><div class="ttname"><a href="classllvm_1_1StructType.html#a6cb66137274f95e4bf6b324b8af9ab56">llvm::StructType::getElementType</a></div><div class="ttdeci">Type * getElementType(unsigned N) const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00328">DerivedTypes.h:328</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a6d883605206368bc536cc9ded97209b8"><div class="ttname"><a href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">llvm::Module::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Get the data layout for the module's target platform.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00398">Module.cpp:398</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html">llvm::SmallPtrSetImpl</a></div><div class="ttdoc">A templated base class for SmallPtrSet which provides the typesafe interface that is common across al...</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00344">SmallPtrSet.h:344</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallSetVector_html"><div class="ttname"><a href="classllvm_1_1SmallSetVector.html">llvm::SmallSetVector</a></div><div class="ttdoc">A SetVector that performs no allocations if smaller than a certain size.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00300">SetVector.h:300</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html_aab312a8386488873bac2eddfc67c22be"><div class="ttname"><a href="classllvm_1_1StringRef.html#aab312a8386488873bac2eddfc67c22be">llvm::StringRef::find</a></div><div class="ttdeci">size_t find(char C, size_t From=0) const</div><div class="ttdoc">Search for the first character C in the string.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00295">StringRef.h:295</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00308">Pass.h:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a5b166ae228ebbfdb96736d6022f3feedad6e9c0ff694f0fca0222e79e772b647e">llvm::CallingConv::Tail</a></div><div class="ttdeci">@ Tail</div><div class="ttdoc">Attemps to make calls as fast as possible while guaranteeing that tail call optimization can always b...</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00076">CallingConv.h:76</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_afd1501c49c84f3addfd108c2484f5674"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#afd1501c49c84f3addfd108c2484f5674">PB</a></div><div class="ttdeci">PassBuilder PB(Machine, PassOpts-&gt;PTO, std::nullopt, &amp;PIC)</div></div>
<div class="ttc" id="anamespacellvm_html_af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7"><div class="ttname"><a href="namespacellvm.html#af4e437674a39417056e3028415053139a83b74c73aa3a3ef410382d9d1b4298a7">llvm::SROAOptions::PreserveCFG</a></div><div class="ttdeci">@ PreserveCFG</div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">InlinePriorityMode::Size</a></div><div class="ttdeci">@ Size</div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdoc">Transfer the name from V to this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00381">Value.cpp:381</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae2aea60aed775d05692317bf4855c291"><div class="ttname"><a href="namespacellvm.html#ae2aea60aed775d05692317bf4855c291">llvm::SplitBlockAndInsertIfThen</a></div><div class="ttdeci">Instruction * SplitBlockAndInsertIfThen(Value *Cond, Instruction *SplitBefore, bool Unreachable, MDNode *BranchWeights, DominatorTree *DT, LoopInfo *LI=nullptr, BasicBlock *ThenBlock=nullptr)</div><div class="ttdoc">Split the containing block at the specified instruction - everything before SplitBefore stays in the ...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l01542">BasicBlockUtils.cpp:1542</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1Partition_html_a558e0dfb6385d4ae5572969bcd327869"><div class="ttname"><a href="classllvm_1_1sroa_1_1Partition.html#a558e0dfb6385d4ae5572969bcd327869">llvm::sroa::Partition::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00581">SROA.cpp:581</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdoc">an instruction to allocate memory on the stack</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00058">Instructions.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_acb9c55b6986369948507ca5241b4e411"><div class="ttname"><a href="classllvm_1_1APInt.html#acb9c55b6986369948507ca5241b4e411">llvm::APInt::shl</a></div><div class="ttdeci">APInt shl(unsigned shiftAmt) const</div><div class="ttdoc">Left-shift function.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00861">APInt.h:861</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="anamespacellvm_1_1LLVM__LIBRARY__VISIBILITY_html_ad221b42fd39a2d460d033bbd1f780c56"><div class="ttname"><a href="namespacellvm_1_1LLVM__LIBRARY__VISIBILITY.html#ad221b42fd39a2d460d033bbd1f780c56">llvm::LLVM_LIBRARY_VISIBILITY::RewriteableMemOp</a></div><div class="ttdeci">std::variant&lt; PossiblySpeculatableLoad, UnspeculatableStore &gt; RewriteableMemOp</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8h_source.html#l00070">SROA.h:70</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SI_1_1KernelInputOffsets_html_a58b4eae4b0a45d478c7c0f3959b04612"><div class="ttname"><a href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">llvm::SI::KernelInputOffsets::Offsets</a></div><div class="ttdeci">Offsets</div><div class="ttdoc">Offsets in bytes from the start of the input buffer.</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8h_source.html#l01335">SIInstrInfo.h:1335</a></div></div>
<div class="ttc" id="aclassllvm_1_1TinyPtrVector_html"><div class="ttname"><a href="classllvm_1_1TinyPtrVector.html">llvm::TinyPtrVector</a></div><div class="ttdoc">TinyPtrVector - This class is specialized for cases where there are normally 0 or 1 element in a vect...</div><div class="ttdef"><b>Definition:</b> <a href="TinyPtrVector_8h_source.html#l00029">TinyPtrVector.h:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html_add13b402166ae4d70f5b93c3c4cfba99"><div class="ttname"><a href="classllvm_1_1StoreInst.html#add13b402166ae4d70f5b93c3c4cfba99">llvm::StoreInst::getPointerOperandIndex</a></div><div class="ttdeci">static unsigned getPointerOperandIndex()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00395">Instructions.h:395</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a499ea32ca1b8d16cedfe01d1e5b08f29"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a499ea32ca1b8d16cedfe01d1e5b08f29">llvm::SmallVectorImpl::reserve</a></div><div class="ttdeci">void reserve(size_type N)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00667">SmallVector.h:667</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1GetElementPtrInst_html_ad200825f26189cd43f3b80728649c4a9"><div class="ttname"><a href="classllvm_1_1GetElementPtrInst.html#ad200825f26189cd43f3b80728649c4a9">llvm::GetElementPtrInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01063">Instructions.h:1063</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1AllocaSlices_html_a9c2de75a45a93abd6afdd41564fba726"><div class="ttname"><a href="classllvm_1_1sroa_1_1AllocaSlices.html#a9c2de75a45a93abd6afdd41564fba726">llvm::sroa::AllocaSlices::begin</a></div><div class="ttdeci">const_iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l00418">SROA.cpp:418</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a7ca5197533a9c1fb8a2bd30587fcec6b"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a7ca5197533a9c1fb8a2bd30587fcec6b">llvm::ArrayRef::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00152">ArrayRef.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1sroa_1_1SROALegacyPass_html_ac8a7db4d24792763a166057fb427aec1"><div class="ttname"><a href="classllvm_1_1sroa_1_1SROALegacyPass.html#ac8a7db4d24792763a166057fb427aec1">llvm::sroa::SROALegacyPass::SROALegacyPass</a></div><div class="ttdeci">SROALegacyPass(SROAOptions PreserveCFG=SROAOptions::PreserveCFG)</div><div class="ttdef"><b>Definition:</b> <a href="SROA_8cpp_source.html#l05090">SROA.cpp:5090</a></div></div>
<div class="ttc" id="anamespacellvm_html_a87d85287259123dfc6486631084f94b6"><div class="ttname"><a href="namespacellvm.html#a87d85287259123dfc6486631084f94b6">llvm::getLoadStoreAlignment</a></div><div class="ttdeci">Align getLoadStoreAlignment(Value *I)</div><div class="ttdoc">A helper function that returns the alignment of load or store instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05389">Instructions.h:5389</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5023b360abc7a5d1612061fba30003a6"><div class="ttname"><a href="namespacellvm.html#a5023b360abc7a5d1612061fba30003a6">llvm::isAllocaPromotable</a></div><div class="ttdeci">bool isAllocaPromotable(const AllocaInst *AI)</div><div class="ttdoc">Return true if this alloca is legal for promotion.</div><div class="ttdef"><b>Definition:</b> <a href="PromoteMemoryToRegister_8cpp_source.html#l00063">PromoteMemoryToRegister.cpp:63</a></div></div>
<div class="ttc" id="aSROA_8cpp_html_ac6da6bff872f9db9f549ab7dd6086a61"><div class="ttname"><a href="SROA_8cpp.html#ac6da6bff872f9db9f549ab7dd6086a61">SROAStrictInbounds</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; SROAStrictInbounds(&quot;sroa-strict-inbounds&quot;, cl::init(false), cl::Hidden)</div><div class="ttdoc">Hidden option to experiment with completely strict handling of inbounds GEPs.</div></div>
<div class="ttc" id="aSetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_af41f58e730804d10b91fcff39b035f74"><div class="ttname"><a href="classllvm_1_1User.html#af41f58e730804d10b91fcff39b035f74">llvm::User::op_end</a></div><div class="ttdeci">op_iterator op_end()</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00236">User.h:236</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:35:01 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
