<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Scalar/MemCpyOptimizer.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_e6e1f1f37d351595fa984b942927b205.html">Scalar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MemCpyOptimizer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="MemCpyOptimizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- MemCpyOptimizer.cpp - Optimize use of memcpy and friends -----------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This pass performs various transformations related to eliminating memcpy</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// calls, or transforming sets of stores into memset&#39;s.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemCpyOptimizer_8h.html">llvm/Transforms/Scalar/MemCpyOptimizer.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DenseSet_8h.html">llvm/ADT/DenseSet.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="STLExtras_8h.html">llvm/ADT/STLExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="iterator__range_8h.html">llvm/ADT/iterator_range.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AssumptionCache_8h.html">llvm/Analysis/AssumptionCache.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CaptureTracking_8h.html">llvm/Analysis/CaptureTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalsModRef_8h.html">llvm/Analysis/GlobalsModRef.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Loads_8h.html">llvm/Analysis/Loads.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemoryLocation_8h.html">llvm/Analysis/MemoryLocation.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemorySSA_8h.html">llvm/Analysis/MemorySSA.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MemorySSAUpdater_8h.html">llvm/Analysis/MemorySSAUpdater.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTracking_8h.html">llvm/Analysis/ValueTracking.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GlobalVariable_8h.html">llvm/IR/GlobalVariable.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Intrinsics_8h.html">llvm/IR/Intrinsics.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PassManager_8h.html">llvm/IR/PassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="User_8h.html">llvm/IR/User.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MathExtras_8h.html">llvm/Support/MathExtras.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   64</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;memcpyopt&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="MemCpyOptimizer_8cpp.html#a0636446566d0b4f7775c9a1658cfce7b">EnableMemCpyOptWithoutLibcalls</a>(</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="stringliteral">&quot;enable-memcpyopt-without-libcalls&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Enable memcpyopt even when libcalls are disabled&quot;</span>));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumMemCpyInstr, <span class="stringliteral">&quot;Number of memcpy instructions deleted&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumMemSetInfer, <span class="stringliteral">&quot;Number of memsets inferred&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumMoveToCpy,   <span class="stringliteral">&quot;Number of memmoves converted to memcpy&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumCpyToSet,    <span class="stringliteral">&quot;Number of memcpys converted to memset&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumCallSlot,    <span class="stringliteral">&quot;Number of call slot optimizations performed&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">/// Represents a range of memset&#39;d bytes with the ByteVal value.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">/// This allows us to analyze stores like:</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">///   store 0 -&gt; P+1</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">///   store 0 -&gt; P+0</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">///   store 0 -&gt; P+3</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">///   store 0 -&gt; P+2</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">/// which sometimes happens with stores to arrays of structs etc.  When we see</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/// the first store, we make a range [1, 2).  The second store extends the range</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/// to [0, 2).  The third makes a new range [2, 3).  The fourth store joins the</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/// two ranges into [0, 3) which is memset&#39;able.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span><span class="keyword">struct </span>MemsetRange {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// Start/End - A semi range that describes the span that this range covers.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// The range is closed at the start and open at the end: [Start, End).</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  int64_t Start, End;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">  /// StartPtr - The getelementptr instruction that points to the start of the</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">  /// range.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Value.html">Value</a> *StartPtr;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">  /// Alignment - The known alignment of the first store.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span>  <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> Alignment;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">  /// TheStores - The actual stores that make up this range.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction*, 16&gt;</a> TheStores;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">bool</span> isProfitableToUseMemset(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;};</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordtype">bool</span> MemsetRange::isProfitableToUseMemset(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// If we found more than 4 stores to merge or 16 bytes, use memset.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (TheStores.size() &gt;= 4 || End-Start &gt;= 16) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// If there is nothing to merge, don&#39;t do anything.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (TheStores.size() &lt; 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// If any of the stores are a memset, then it is always good to extend the</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// memset.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : TheStores)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;StoreInst&gt;(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>))</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// Assume that the code generator is capable of merging pairs of stores</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// together if it wants to.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (TheStores.size() == 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// If we have fewer than 8 stores, it can still be worthwhile to do this.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// For example, merging 4 i8 stores into an i32 store is useful almost always.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// However, merging 2 32-bit stores isn&#39;t useful on a 32-bit architecture (the</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// memset will be split into 2 32-bit stores anyway) and doing so can</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// pessimize the llvm optimizer.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Since we don&#39;t have perfect knowledge here, make some assumptions: assume</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// the maximum GPR width is the same size as the largest legal integer</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// size. If so, check to see whether we will end up actually reducing the</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// number of stores used.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">unsigned</span> Bytes = <a class="code" href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a>(End-Start);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordtype">unsigned</span> MaxIntSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getLargestLegalIntTypeSizeInBits() / 8;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span> (MaxIntSize == 0)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    MaxIntSize = 1;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordtype">unsigned</span> NumPointerStores = Bytes / MaxIntSize;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// Assume the remaining bytes if any are done a byte at a time.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">unsigned</span> NumByteStores = Bytes % MaxIntSize;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// If we will reduce the # stores (according to this heuristic), do the</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// transformation.  This encourages merging 4 x i8 -&gt; i32 and 2 x i16 -&gt; i32</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// etc.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> TheStores.<a class="code" href="classllvm_1_1MachineBasicBlock.html#adbff55f335d303816547f35eb6edb948">size</a>() &gt; NumPointerStores+NumByteStores;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keyword">class </span>MemsetRanges {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keyword">using</span> range_iterator = <a class="code" href="classllvm_1_1SmallVectorImpl.html#ac5b936169badf0b703567eb960278648">SmallVectorImpl&lt;MemsetRange&gt;::iterator</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">  /// A sorted list of the memset ranges.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MemsetRange, 8&gt;</a> <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  MemsetRanges(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) : <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">using</span> const_iterator = <a class="code" href="classllvm_1_1SmallVectorImpl.html#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;MemsetRange&gt;::const_iterator</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">begin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.begin(); }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  const_iterator <a class="code" href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">end</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.end(); }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">bool</span> empty()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.empty(); }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordtype">void</span> addInst(int64_t OffsetFromFirst, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(Inst))</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      addStore(OffsetFromFirst, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      addMemSet(OffsetFromFirst, cast&lt;MemSetInst&gt;(Inst));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">void</span> addStore(int64_t OffsetFromFirst, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> StoreSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getOperand(0)-&gt;getType());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!StoreSize.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a9188f84e1dd67530330dcab9cae787d7">isScalable</a>() &amp;&amp; <span class="stringliteral">&quot;Can&#39;t track scalable-typed stores&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="Metadata_8cpp.html#a538047e21679cd2bf4cfd1e73fe022aa">addRange</a>(OffsetFromFirst, StoreSize.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">getFixedValue</a>(),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;             <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">void</span> addMemSet(int64_t OffsetFromFirst, <a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MSI) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    int64_t <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = cast&lt;ConstantInt&gt;(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>())-&gt;getZExtValue();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="Metadata_8cpp.html#a538047e21679cd2bf4cfd1e73fe022aa">addRange</a>(OffsetFromFirst, Size, MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>(), MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">getDestAlign</a>(), MSI);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="Metadata_8cpp.html#a538047e21679cd2bf4cfd1e73fe022aa">addRange</a>(int64_t Start, int64_t Size, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> Alignment,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;};</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/// Add a new store to the MemsetRanges data structure.  This adds a</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/// new range for the specified store at the specified offset, merging into</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">/// existing ranges as appropriate.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="Metadata_8cpp.html#a538047e21679cd2bf4cfd1e73fe022aa">MemsetRanges::addRange</a>(int64_t Start, int64_t Size, <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                            <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> Alignment, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  int64_t End = Start+<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  range_iterator <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code" href="namespacellvm.html#a327a399b9f6ef414a29ddeffba934d26">partition_point</a>(</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      Ranges, [=](<span class="keyword">const</span> MemsetRange &amp;<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>) { <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">O</a>.End &lt; Start; });</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// We now know that I == E, in which case we didn&#39;t find anything to merge</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// with, or that Start &lt;= I-&gt;End.  If End &lt; I-&gt;Start or I == E, then we need</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// to insert a new range.  Handle this now.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.end() || End &lt; I-&gt;Start) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    MemsetRange &amp;<a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = *<a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.insert(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, MemsetRange());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Start        = Start;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.End          = End;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.StartPtr     = <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.Alignment    = Alignment;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.TheStores.push_back(Inst);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// This store overlaps with I, add it.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;TheStores.push_back(Inst);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// At this point, we may have an interval that completely contains our store.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// If so, just add it to the interval and return.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;Start &lt;= Start &amp;&amp; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;End &gt;= End)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Now we know that Start &lt;= I-&gt;End and End &gt;= I-&gt;Start so the range overlaps</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// but is not entirely contained within the range.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// See if the range extends the start of the range.  In this case, it couldn&#39;t</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// possibly cause it to join the prior range, because otherwise we would have</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// stopped on *it*.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">if</span> (Start &lt; I-&gt;Start) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;Start = Start;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;StartPtr = <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;Alignment = Alignment;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// Now we know that Start &lt;= I-&gt;End and Start &gt;= I-&gt;Start (so the startpoint</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// is in or right at the end of I), and that End &gt;= I-&gt;Start.  Extend I out to</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// End.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (End &gt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;End) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;End = End;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    range_iterator NextI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">while</span> (++NextI != <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.end() &amp;&amp; End &gt;= NextI-&gt;Start) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// Merge the range in.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;TheStores.append(NextI-&gt;TheStores.begin(), NextI-&gt;TheStores.end());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">if</span> (NextI-&gt;End &gt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;End)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;End = NextI-&gt;End;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.erase(NextI);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      NextI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">//                         MemCpyOptLegacyPass Pass</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword">class </span>MemCpyOptLegacyPass : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="classllvm_1_1MemCpyOptPass.html">MemCpyOptPass</a> Impl;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; <span class="comment">// Pass identification, replacement for typeid</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  MemCpyOptLegacyPass() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="namespacellvm.html#a13d660d6d9741c69a809add210d22e8c">initializeMemCpyOptLegacyPassPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// This transformation requires dominator postdominator info</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1AssumptionCacheTracker.html">AssumptionCacheTracker</a>&gt;();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1GlobalsAAWrapperPass.html">GlobalsAAWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1AAResultsWrapperPass.html">AAResultsWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1AAResultsWrapperPass.html">AAResultsWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1MemorySSAWrapperPass.html">MemorySSAWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">addPreserved</a>&lt;<a class="code" href="classllvm_1_1MemorySSAWrapperPass.html">MemorySSAWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;};</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">MemCpyOptLegacyPass::ID</a> = 0;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">/// The public interface to this file...</span></div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="namespacellvm.html#a493e8685b388eb24064e2eb6c90e88d6">  293</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html#a493e8685b388eb24064e2eb6c90e88d6">llvm::createMemCpyOptPass</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> MemCpyOptLegacyPass(); }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<a class="code" href="MemCpyOptimizer_8cpp.html#a8c600d31172b5d0d0c7b510b535f03c3">INITIALIZE_PASS_BEGIN</a>(MemCpyOptLegacyPass, <span class="stringliteral">&quot;memcpyopt&quot;</span>, <span class="stringliteral">&quot;MemCpy Optimization&quot;</span>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                      <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1AssumptionCacheTracker.html">AssumptionCacheTracker</a>)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1AAResultsWrapperPass.html">AAResultsWrapperPass</a>)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1GlobalsAAWrapperPass.html">GlobalsAAWrapperPass</a>)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1MemorySSAWrapperPass.html">MemorySSAWrapperPass</a>)</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a4c36a0753cd006d97b1aee018fe423bc">  303</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(MemCpyOptLegacyPass, &quot;<a class="code" href="MemCpyOptimizer_8cpp.html#a7530261f1f6c8e08347b485f8ffe90b4">memcpyopt</a>&quot;, &quot;MemCpy <a class="code" href="MemCpyOptimizer_8cpp.html#a4c36a0753cd006d97b1aee018fe423bc">Optimization</a>&quot;,</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a40e09c8c543c66f1b9a5d30d28da2086">  304</a></span>&#160;                    <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">// Check that V is either not accessible by the caller, or unwinding cannot</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">// occur between Start and End.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a684dc4713d6cd9e5383eda83ec3e620f">  308</a></span>&#160;static <span class="keywordtype">bool</span> <a class="code" href="MemCpyOptimizer_8cpp.html#a684dc4713d6cd9e5383eda83ec3e620f">mayBeVisibleThroughUnwinding</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> *V, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Start,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                         <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *End) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Start-&gt;getParent() == End-&gt;getParent() &amp;&amp; <span class="stringliteral">&quot;Must be in same block&quot;</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// Function can&#39;t unwind, so it also can&#39;t be visible through unwinding.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">if</span> (Start-&gt;getFunction()-&gt;doesNotThrow())</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// Object is not visible on unwind.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// TODO: Support RequiresNoCaptureBeforeUnwind case.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">bool</span> RequiresNoCaptureBeforeUnwind;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a894b02a1122caccc0ed5eb9b321d22bb">isNotVisibleOnUnwind</a>(<a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(V),</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                           RequiresNoCaptureBeforeUnwind) &amp;&amp;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      !RequiresNoCaptureBeforeUnwind)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// Check whether there are any unwinding instructions in the range.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(Start-&gt;getIterator(), End-&gt;getIterator()),</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                [](<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) { return I.mayThrow(); });</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keywordtype">void</span> MemCpyOptPass::eraseInstruction(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#abcf78af37d56a9b72a49c65428210758">removeMemoryAccess</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">// Check for mod or ref of Loc between Start and End, excluding both boundaries.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">// Start and End must be in the same block.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">// If SkippedLifetimeStart is provided, skip over one clobbering lifetime.start</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">// intrinsic and store it inside SkippedLifetimeStart.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a732b03e0a47de172531cbae6e0ae0193">  337</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MemCpyOptimizer_8cpp.html#a732b03e0a47de172531cbae6e0ae0193">accessedBetween</a>(<a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> &amp;AA, <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> Loc,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *Start,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *End,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                            <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> **SkippedLifetimeStart = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Start-&gt;getBlock() == End-&gt;getBlock() &amp;&amp; <span class="stringliteral">&quot;Only local supported&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> &amp;MA :</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;       <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(++Start-&gt;getIterator(), End-&gt;getIterator())) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = cast&lt;MemoryUseOrDef&gt;(MA).getMemoryInst();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA.<a class="code" href="classllvm_1_1BatchAAResults.html#adfa0be41805b25d9577d6f15d148a0d7">getModRefInfo</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Loc))) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">if</span> (II &amp;&amp; II-&gt;getIntrinsicID() == Intrinsic::lifetime_start &amp;&amp;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          SkippedLifetimeStart &amp;&amp; !*SkippedLifetimeStart) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        *SkippedLifetimeStart = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">// Check for mod of Loc between Start and End, excluding both boundaries.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">// Start and End can be in different blocks.</span></div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#ab06d3147949b764919b5ad90014afdfd">  361</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MemCpyOptimizer_8cpp.html#ab06d3147949b764919b5ad90014afdfd">writtenBetween</a>(<a class="code" href="classllvm_1_1MemorySSA.html">MemorySSA</a> *MSSA, <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> &amp;AA,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                           <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> Loc, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *Start,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *End) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">if</span> (isa&lt;MemoryUse&gt;(End)) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// For MemoryUses, getClobberingMemoryAccess may skip non-clobbering writes.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// Manually check read accesses between Start and End, if they are in the</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// same block, for clobbers. Otherwise assume Loc is clobbered.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> Start-&gt;getBlock() != End-&gt;getBlock() ||</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;           <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;               <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(std::next(Start-&gt;getIterator()), End-&gt;getIterator()),</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;               [&amp;AA, Loc](<span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> &amp;Acc) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                 if (isa&lt;MemoryUse&gt;(&amp;Acc))</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                   return false;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                 Instruction *AccInst =</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                     cast&lt;MemoryUseOrDef&gt;(&amp;Acc)-&gt;getMemoryInst();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                 return isModSet(AA.getModRefInfo(AccInst, Loc));</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;               });</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">// TODO: Only walk until we hit Start.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *Clobber = MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a949151a1ebd664cb397323294cec0e53">getWalker</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSAWalker.html#a95d0e423957d029a78e5868f539e9cce">getClobberingMemoryAccess</a>(</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      End-&gt;getDefiningAccess(), Loc, AA);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">return</span> !MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a56004f54560e9950f6eb148cb5dfa0a3">dominates</a>(Clobber, Start);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/// When scanning forward over instructions, we look for some other patterns to</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">/// fold away. In particular, this looks for stores to neighboring locations of</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">/// memory. If it sees enough consecutive ones, it attempts to merge them</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">/// together into a memcpy/memset.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *MemCpyOptPass::tryMergingIntoMemset(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *StartInst,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                                 <a class="code" href="classllvm_1_1Value.html">Value</a> *StartPtr,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                                 <a class="code" href="classllvm_1_1Value.html">Value</a> *ByteVal) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = StartInst-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// We can&#39;t track scalable types</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(StartInst))</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getOperand(0)-&gt;getType()).isScalable())</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// Okay, so we now have a single store that can be splatable.  Scan to find</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// all subsequent stores of the same value to offset from the same pointer.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// Join these together into ranges, so we can decide whether contiguous blocks</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// are stored.</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  MemsetRanges <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> BI(StartInst);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// Keeps track of the last memory use or def before the insertion point for</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// the new memset. The new MemoryDef for the inserted memsets will be inserted</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// after MemInsertPoint. It points to either LastMemDef or to the last user</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// before the insertion point of the memset, if there are any such users.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *MemInsertPoint = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// Keeps track of the last MemoryDef between StartInst and the insertion point</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// for the new memset. This will become the defining access of the inserted</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// memsets.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="classllvm_1_1MemoryDef.html">MemoryDef</a> *LastMemDef = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">for</span> (++BI; !BI-&gt;isTerminator(); ++BI) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">auto</span> *CurrentAcc = cast_or_null&lt;MemoryUseOrDef&gt;(</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(&amp;*BI));</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (CurrentAcc) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      MemInsertPoint = CurrentAcc;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CurrentDef = dyn_cast&lt;MemoryDef&gt;(CurrentAcc))</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        LastMemDef = CurrentDef;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Calls that only access inaccessible memory do not block merging</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// accessible stores.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(BI)) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> (CB-&gt;onlyAccessesInaccessibleMemory())</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;StoreInst&gt;(BI) &amp;&amp; !isa&lt;MemSetInst&gt;(BI)) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="comment">// If the instruction is readnone, ignore it, otherwise bail out.  We</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="comment">// don&#39;t even allow readonly here because we don&#39;t want something like:</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="comment">// A[1] = 2; strlen(A); A[2] = 2; -&gt; memcpy(A, ...); strlen(A).</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span> (BI-&gt;mayWriteToMemory() || BI-&gt;mayReadFromMemory())</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *NextStore = dyn_cast&lt;StoreInst&gt;(BI)) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="comment">// If this is a store, see if we can merge it in.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">if</span> (!NextStore-&gt;isSimple()) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StoredVal = NextStore-&gt;getValueOperand();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="comment">// Don&#39;t convert stores of non-integral pointer types to memsets (which</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="comment">// stores integers).</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isNonIntegralPointerType(StoredVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>()))</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="comment">// We can&#39;t track ranges involving scalable types.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(StoredVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()).isScalable())</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="comment">// Check to see if this stored value is of the same byte-splattable value.</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *StoredByte = <a class="code" href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">isBytewiseValue</a>(StoredVal, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">if</span> (isa&lt;UndefValue&gt;(ByteVal) &amp;&amp; StoredByte)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        ByteVal = StoredByte;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">if</span> (ByteVal != StoredByte)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">// Check to see if this store is to a constant offset from the start ptr.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      std::optional&lt;int64_t&gt; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> =</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          <a class="code" href="namespacellvm.html#ad81c9e5bd992252c9e82205b52b5e911">isPointerOffset</a>(StartPtr, NextStore-&gt;getPointerOperand(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.addStore(*<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, NextStore);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keyword">auto</span> *MSI = cast&lt;MemSetInst&gt;(BI);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">if</span> (MSI-&gt;isVolatile() || ByteVal != MSI-&gt;getValue() ||</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          !isa&lt;ConstantInt&gt;(MSI-&gt;getLength()))</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">// Check to see if this store is to a constant offset from the start ptr.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      std::optional&lt;int64_t&gt; <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> =</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          <a class="code" href="namespacellvm.html#ad81c9e5bd992252c9e82205b52b5e911">isPointerOffset</a>(StartPtr, MSI-&gt;getDest(), <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.addMemSet(*<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, MSI);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// If we have no ranges, then we just had a single store with nothing that</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// could be merged in.  This is a very common case of course.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.empty())</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="comment">// If we had at least one store that could be merged in, add the starting</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// store as well.  We try to avoid this unless there is at least something</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// interesting as a small compile-time optimization.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <a class="code" href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">Ranges</a>.addInst(0, StartInst);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// If we create any memsets, we put it right before the first instruction that</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// isn&#39;t part of the memset block.  This ensure that the memset is dominated</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// by any addressing instruction needed by the start of the block.</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(&amp;*BI);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// Now that we have full information about ranges, loop over the ranges and</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// emit memset&#39;s for anything big enough to be worthwhile.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *AMemSet = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> MemsetRange &amp;Range : Ranges) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.TheStores.size() == 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// If it is profitable to lower this range to memset, do so now.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.isProfitableToUseMemset(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// Otherwise, we do want to transform this!  Create a new memset.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// Get the starting pointer of the block.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    StartPtr = <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.StartPtr;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    AMemSet = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemSet(StartPtr, ByteVal, <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.End - <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.Start,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                   <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.Alignment);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    AMemSet-&gt;<a class="code" href="classllvm_1_1Instruction.html#a2711d3bc7c6c769a8f34c7fc3937169d">mergeDIAssignID</a>(<a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.TheStores);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Replace stores:\n&quot;</span>; <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                                   : <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.TheStores) <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                              &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;               <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;With: &quot;</span> &lt;&lt; *AMemSet &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.TheStores.empty())</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      AMemSet-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.TheStores[0]-&gt;getDebugLoc());</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LastMemDef &amp;&amp; MemInsertPoint &amp;&amp;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;           <span class="stringliteral">&quot;Both LastMemDef and MemInsertPoint need to be set&quot;</span>);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keyword">auto</span> *NewDef =</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        cast&lt;MemoryDef&gt;(MemInsertPoint-&gt;<a class="code" href="classllvm_1_1MemoryUseOrDef.html#a1111232011a32357ce2f84d3a633597c">getMemoryInst</a>() == &amp;*BI</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                            ? MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a1c21c2f4d41d5c6f6807992d60347bbd">createMemoryAccessBefore</a>(</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                  AMemSet, LastMemDef, MemInsertPoint)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                            : MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#acf9a0bb25aae89d274ee9ae7dd0cf9b2">createMemoryAccessAfter</a>(</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                  AMemSet, LastMemDef, MemInsertPoint));</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">insertDef</a>(NewDef, <span class="comment">/*RenameUses=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    LastMemDef = NewDef;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    MemInsertPoint = NewDef;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// Zap all the stores.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> : <a class="code" href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">Range</a>.TheStores)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      eraseInstruction(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    ++NumMemSetInfer;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">return</span> AMemSet;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">// This method try to lift a store instruction before position P.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">// It will lift the store and its argument + that anything that</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">// may alias with these.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">// The method returns true if it was successful.</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordtype">bool</span> MemCpyOptPass::moveUp(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// If the store alias this position, early bail out.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> StoreLoc = <a class="code" href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">MemoryLocation::get</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, StoreLoc)))</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// Keep track of the arguments of all instruction we plan to lift</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// so we can make sure to lift them as well if appropriate.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;Instruction*&gt;</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keyword">auto</span> AddArg = [&amp;](<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(<a class="code" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &amp;&amp; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent() == <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent()) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">// Cannot hoist user of P above P</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.insert(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  };</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (!AddArg(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand()))</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// Instruction to lift before P.</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> ToLift{<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>};</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// Memory locations of lifted instructions.</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MemoryLocation, 8&gt;</a> MemLocs{StoreLoc};</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">// Lifted calls.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;const CallBase *, 8&gt;</a> Calls;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> LoadLoc = <a class="code" href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">MemoryLocation::get</a>(LI);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = --<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getIterator(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>-&gt;getIterator(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; --<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = &amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">// Make sure hoisting does not perform a store that was not guaranteed to</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">// happen.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#abff5a423c1f45e23958dde8ee695c9a9">isGuaranteedToTransferExecutionToSuccessor</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>))</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">bool</span> MayAlias = <a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, std::nullopt));</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">bool</span> NeedLift = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.erase(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>))</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      NeedLift = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MayAlias) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      NeedLift = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a>(MemLocs, [<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <span class="keyword">this</span>](<span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> &amp;ML) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, ML));</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      });</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">if</span> (!NeedLift)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        NeedLift = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a>(Calls, [<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <span class="keyword">this</span>](<span class="keyword">const</span> <a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *Call) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, Call));</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        });</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (!NeedLift)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (MayAlias) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="comment">// Since LI is implicitly moved downwards past the lifted instructions,</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">// none of them may modify its source.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">isModSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, LoadLoc)))</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *Call = dyn_cast&lt;CallBase&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="comment">// If we can&#39;t lift this before P, it&#39;s game over.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, Call)))</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        Calls.push_back(Call);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;LoadInst&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) || isa&lt;StoreInst&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) || isa&lt;VAArgInst&gt;(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">// If we can&#39;t lift this before P, it&#39;s game over.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keyword">auto</span> <a class="code" href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3ad01fd9b01e9dde8bd3dc247afbfb7218">ML</a> = <a class="code" href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">MemoryLocation::get</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, ML)))</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        MemLocs.push_back(ML);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">// We don&#39;t know how to lift this instruction.</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    ToLift.push_back(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> : <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;operands())</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordflow">if</span> (!AddArg(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>))</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// Find MSSA insertion point. Normally P will always have a corresponding</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// memory access before which we can insert. However, with non-standard AA</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">// pipelines, there may be a mismatch between AA and MSSA, in which case we</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// will scan for a memory access before P. In either case, we know for sure</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// that at least the load will have a memory access.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">// TODO: Simplify this once P will be determined by MSSA, in which case the</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">// discrepancy can no longer occur.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *MemInsertPoint = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *MA = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>)) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    MemInsertPoint = cast&lt;MemoryUseOrDef&gt;(--MA-&gt;getIterator());</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *ConstP = <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(++ConstP-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#ad4bb544993573a6677d97cf5413110c7">getReverseIterator</a>(),</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                           ++LI-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#ad4bb544993573a6677d97cf5413110c7">getReverseIterator</a>())) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *MA = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        MemInsertPoint = MA;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">// We made it, we need to lift.</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#a6b0ac1fa4f05de76413c5e0ca6334035">llvm::reverse</a>(ToLift)) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Lifting &quot;</span> &lt;&lt; *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt;&lt; <span class="stringliteral">&quot; before &quot;</span> &lt;&lt; *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;moveBefore(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MemInsertPoint &amp;&amp; <span class="stringliteral">&quot;Must have found insert point&quot;</span>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *MA = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a2d537a2dd5afbd1eba9a402cda94e067">moveAfter</a>(MA, MemInsertPoint);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      MemInsertPoint = MA;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">bool</span> MemCpyOptPass::processStoreOfLoad(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *LI,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                       <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> &amp;BBI) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span> (!LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">isSimple</a>() || !LI-&gt;<a class="code" href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>() ||</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      LI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>() != <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getParent())</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="classT.html">T</a> = LI-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="comment">// Don&#39;t introduce calls to memcpy/memmove intrinsics out of thin air if</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="comment">// the corresponding libcalls are not available.</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="comment">// TODO: We should really distinguish between libcall availability and</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// our ability to introduce intrinsics.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classT.html">T</a>-&gt;isAggregateType() &amp;&amp;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      (<a class="code" href="MemCpyOptimizer_8cpp.html#a0636446566d0b4f7775c9a1658cfce7b">EnableMemCpyOptWithoutLibcalls</a> ||</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;       (TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">has</a>(LibFunc_memcpy) &amp;&amp; TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">has</a>(LibFunc_memmove)))) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> LoadLoc = <a class="code" href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">MemoryLocation::get</a>(LI);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// We use alias analysis to check if an instruction may store to</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// the memory we load from in between the load and the store. If</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// such an instruction is found, we try to promote there instead</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// of at the store position.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">// TODO: Can use MSSA for this.</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(++LI-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getIterator())) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">isModSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, LoadLoc))) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">// We found an instruction that may write to the loaded memory.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// We can try to promote at this position instead of the store</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// position if nothing aliases the store memory after this and the store</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// destination is not in the range.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> &amp;&amp; <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> != <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="keywordflow">if</span> (!moveUp(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, LI))</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// If a valid insertion position is found, then we can promote</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">// the load/store pair to a memcpy.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="comment">// If we load from memory that may alias the memory we store to,</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="comment">// memmove must be used to preserve semantic. If not, memcpy can</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">// be used. Also, if we load from constant memory, memcpy can be used</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="comment">// as the constant memory won&#39;t be modified.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordtype">bool</span> UseMemMove = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">isModSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, LoadLoc)))</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        UseMemMove = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(<a class="code" href="classT.html">T</a>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordflow">if</span> (UseMemMove)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemMove(</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign(),</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>(), LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(), Size);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemCpy(</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand(), <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign(),</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>(), LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(), Size);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;copyMetadata(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, LLVMContext::MD_DIAssignID);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Promoting &quot;</span> &lt;&lt; *LI &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                        &lt;&lt; *M &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keyword">auto</span> *LastDef =</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          cast&lt;MemoryDef&gt;(MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>));</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keyword">auto</span> *NewAccess = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#acf9a0bb25aae89d274ee9ae7dd0cf9b2">createMemoryAccessAfter</a>(M, LastDef, LastDef);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">insertDef</a>(cast&lt;MemoryDef&gt;(NewAccess), <span class="comment">/*RenameUses=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      eraseInstruction(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      eraseInstruction(LI);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      ++NumMemCpyInstr;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// Make sure we do not invalidate the iterator.</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      BBI = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getIterator();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="comment">// Detect cases where we&#39;re performing call slot forwarding, but</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="comment">// happen to be using a load-store pair to implement it, rather than</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="comment">// a memcpy.</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> BAA(*AA);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keyword">auto</span> GetCall = [&amp;]() -&gt; <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> * {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// We defer this expensive clobber walk until the cheap checks</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// have been done on the source inside performCallSlotOptzn.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LoadClobber = dyn_cast&lt;MemoryUseOrDef&gt;(</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a949151a1ebd664cb397323294cec0e53">getWalker</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSAWalker.html#a95d0e423957d029a78e5868f539e9cce">getClobberingMemoryAccess</a>(LI, BAA)))</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">return</span> dyn_cast_or_null&lt;CallInst&gt;(LoadClobber-&gt;getMemoryInst());</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  };</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordtype">bool</span> Changed = performCallSlotOptzn(</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      LI, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand()-&gt;stripPointerCasts(),</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">getPointerOperand</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>(),</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getOperand(0)-&gt;getType()),</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <a class="code" href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">std::min</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign(), LI-&gt;<a class="code" href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>()), BAA, GetCall);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">if</span> (Changed) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    eraseInstruction(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    eraseInstruction(LI);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    ++NumMemCpyInstr;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;}</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="keywordtype">bool</span> MemCpyOptPass::processStore(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> &amp;BBI) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isSimple()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="comment">// Avoid merging nontemporal stores since the resulting</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// memcpy/memset would not be able to preserve the nontemporal hint.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// In theory we could teach how to propagate the !nontemporal metadata to</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="comment">// memset calls. However, that change would force the backend to</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">// conservatively expand !nontemporal memset calls back to sequences of</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="comment">// store instructions (effectively undoing the merging).</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getMetadata(LLVMContext::MD_nontemporal))</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StoredVal = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getValueOperand();</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// Not all the transforms below are correct for non-integral pointers, bail</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">// until we&#39;ve audited the individual pieces.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.isNonIntegralPointerType(StoredVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>()))</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">// Load to store forwarding can be interpreted as memcpy.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *LI = dyn_cast&lt;LoadInst&gt;(StoredVal))</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">return</span> processStoreOfLoad(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, LI, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, BBI);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="comment">// The following code creates memset intrinsics out of thin air. Don&#39;t do</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">// this if the corresponding libfunc is not available.</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">// TODO: We should really distinguish between libcall availability and</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// our ability to introduce intrinsics.</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">if</span> (!(TLI-&gt;<a class="code" href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">has</a>(LibFunc_memset) || <a class="code" href="MemCpyOptimizer_8cpp.html#a0636446566d0b4f7775c9a1658cfce7b">EnableMemCpyOptWithoutLibcalls</a>))</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">// There are two cases that are interesting for this code to handle: memcpy</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">// and memset.  Right now we only handle memset.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">// Ensure that the value being stored is something that can be memset&#39;able a</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">// byte at a time like &quot;0&quot; or &quot;-1&quot; or any width, as well as things like</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">// 0xA0A0A0A0 and 0.0.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keyword">auto</span> *V = <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *ByteVal = <a class="code" href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">isBytewiseValue</a>(V, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>)) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = tryMergingIntoMemset(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand(),</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                              ByteVal)) {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      BBI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIterator(); <span class="comment">// Don&#39;t invalidate iterator.</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// If we have an aggregate, we try to promote it to memset regardless</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// of opportunity for merging as it can expose optimization opportunities</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// in subsequent passes.</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="classT.html">T</a> = V-&gt;getType();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classT.html">T</a>-&gt;isAggregateType()) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(<a class="code" href="classT.html">T</a>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemSet(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getPointerOperand(), ByteVal, Size,</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                     <a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getAlign());</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;copyMetadata(*<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, LLVMContext::MD_DIAssignID);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Promoting &quot;</span> &lt;&lt; *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; *M &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="comment">// The newly inserted memset is immediately overwritten by the original</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">// store, so we do not need to rename uses.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keyword">auto</span> *StoreDef = cast&lt;MemoryDef&gt;(MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>));</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keyword">auto</span> *NewAccess = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a1c21c2f4d41d5c6f6807992d60347bbd">createMemoryAccessBefore</a>(</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          M, StoreDef-&gt;getDefiningAccess(), StoreDef);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">insertDef</a>(cast&lt;MemoryDef&gt;(NewAccess), <span class="comment">/*RenameUses=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      eraseInstruction(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      NumMemSetInfer++;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="comment">// Make sure we do not invalidate the iterator.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      BBI = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getIterator();</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordtype">bool</span> MemCpyOptPass::processMemSet(<a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MSI, <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> &amp;BBI) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">// See if there is another memset or store neighboring this memset which</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">// allows us to widen out the memset to do a single larger store.</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keywordflow">if</span> (isa&lt;ConstantInt&gt;(MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>()) &amp;&amp; !MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>())</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = tryMergingIntoMemset(MSI, MSI-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>(),</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                              MSI-&gt;<a class="code" href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">getValue</a>())) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      BBI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIterator(); <span class="comment">// Don&#39;t invalidate iterator.</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;}</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">/// Takes a memcpy and a call that it depends on,</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">/// and checks for the possibility of a call slot optimization by having</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">/// the call write its result directly into the destination of the memcpy.</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::performCallSlotOptzn(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *cpyLoad,</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                         <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *cpyStore, <a class="code" href="classllvm_1_1Value.html">Value</a> *cpyDest,</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                         <a class="code" href="classllvm_1_1Value.html">Value</a> *cpySrc, <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> cpySize,</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                         <a class="code" href="structllvm_1_1Align.html">Align</a> cpyDestAlign, <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> &amp;BAA,</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                         <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *()&gt; GetC) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">// The general transformation to keep in mind is</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">//   call @func(..., src, ...)</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">//   memcpy(dest, src, ...)</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">// -&gt;</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">//   memcpy(dest, src, ...)</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">//   call @func(..., dest, ...)</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// Since moving the memcpy is technically awkward, we additionally check that</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// src only holds uninitialized values at the moment of the call, meaning that</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// the memcpy can be discarded rather than moved.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// We can&#39;t optimize scalable types.</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">if</span> (cpySize.<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a9188f84e1dd67530330dcab9cae787d7">isScalable</a>())</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">// Require that src be an alloca.  This simplifies the reasoning considerably.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keyword">auto</span> *srcAlloca = dyn_cast&lt;AllocaInst&gt;(cpySrc);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">if</span> (!srcAlloca)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *srcArraySize = dyn_cast&lt;ConstantInt&gt;(srcAlloca-&gt;getArraySize());</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">if</span> (!srcArraySize)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = cpyLoad-&gt;<a class="code" href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> srcSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(srcAlloca-&gt;getAllocatedType()) *</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                     srcArraySize-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">if</span> (cpySize &lt; srcSize)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = GetC();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="comment">// Lifetime marks shouldn&#39;t be operated on.</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getCalledFunction())</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;isIntrinsic() &amp;&amp; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getIntrinsicID() == Intrinsic::lifetime_start)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getParent() != cpyStore-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Call Slot: block local restriction\n&quot;</span>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> DestLoc = isa&lt;StoreInst&gt;(cpyStore) ?</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">MemoryLocation::get</a>(cpyStore) :</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a>::getForDest(<a class="code" href="namespacellvm.html#ac4fc845f5ed92de63cd4474f128f5fc5">cast</a>&lt;<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a>&gt;(cpyStore));</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">// Check that nothing touches the dest of the copy between</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">// the call and the store/memcpy.</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *SkippedLifetimeStart = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#a732b03e0a47de172531cbae6e0ae0193">accessedBetween</a>(BAA, DestLoc, MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>),</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                      MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(cpyStore), &amp;SkippedLifetimeStart)) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Call Slot: Dest pointer modified after call\n&quot;</span>);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// If we need to move a lifetime.start above the call, make sure that we can</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">// actually do so. If the argument is bitcasted for example, we would have to</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">// move the bitcast as well, which we don&#39;t handle.</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordflow">if</span> (SkippedLifetimeStart) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keyword">auto</span> *LifetimeArg =</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        dyn_cast&lt;Instruction&gt;(SkippedLifetimeStart-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1));</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (LifetimeArg &amp;&amp; LifetimeArg-&gt;getParent() == <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getParent() &amp;&amp;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;comesBefore(LifetimeArg))</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">// Check that accessing the first srcSize bytes of dest will not cause a</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="comment">// trap.  Otherwise the transform is invalid since it might cause a trap</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="comment">// to occur earlier than it otherwise would.</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a2da012cb3e5534bbee33563d309bc354">isDereferenceableAndAlignedPointer</a>(cpyDest, <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1), <a class="code" href="classllvm_1_1APInt.html">APInt</a>(64, cpySize),</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                          <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, AC, DT)) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Call Slot: Dest pointer not dereferenceable\n&quot;</span>);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">// Make sure that nothing can observe cpyDest being written early. There are</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">// a number of cases to consider:</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="comment">//  1. cpyDest cannot be accessed between C and cpyStore as a precondition of</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="comment">//     the transform.</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="comment">//  2. C itself may not access cpyDest (prior to the transform). This is</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="comment">//     checked further below.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">//  3. If cpyDest is accessible to the caller of this function (potentially</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">//     captured and not based on an alloca), we need to ensure that we cannot</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">//     unwind between C and cpyStore. This is checked here.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="comment">//  4. If cpyDest is potentially captured, there may be accesses to it from</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">//     another thread. In this case, we need to check that cpyStore is</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">//     guaranteed to be executed if C is. As it is a non-atomic access, it</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">//     renders accesses from other threads undefined.</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="comment">//     TODO: This is currently not checked.</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#a684dc4713d6cd9e5383eda83ec3e620f">mayBeVisibleThroughUnwinding</a>(cpyDest, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, cpyStore)) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Call Slot: Dest may be visible through unwinding\n&quot;</span>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="comment">// Check that dest points to memory that is at least as aligned as src.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> srcAlign = srcAlloca-&gt;getAlign();</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keywordtype">bool</span> isDestSufficientlyAligned = srcAlign &lt;= cpyDestAlign;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="comment">// If dest is not aligned enough and we can&#39;t increase its alignment then</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="comment">// bail out.</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (!isDestSufficientlyAligned &amp;&amp; !isa&lt;AllocaInst&gt;(cpyDest)) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Call Slot: Dest not sufficiently aligned\n&quot;</span>);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="comment">// Check that src is not accessed except via the call and the memcpy.  This</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">// guarantees that it holds only undefined values when passed in (so the final</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">// memcpy can be dropped), that it is not read or written between the call and</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// the memcpy, and that writing beyond the end of it is undefined.</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;User *, 8&gt;</a> srcUseList(srcAlloca-&gt;users());</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordflow">while</span> (!srcUseList.empty()) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a> *U = srcUseList.pop_back_val();</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">if</span> (isa&lt;BitCastInst&gt;(U) || isa&lt;AddrSpaceCastInst&gt;(U)) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">append_range</a>(srcUseList, U-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>());</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a> = dyn_cast&lt;GetElementPtrInst&gt;(U)) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a>-&gt;hasAllZeroIndices())</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <a class="code" href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">append_range</a>(srcUseList, U-&gt;<a class="code" href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">users</a>());</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code" href="ARMSubtarget_8cpp.html#a6a14930b01ccb1cf446cd96395284102">IT</a> = dyn_cast&lt;IntrinsicInst&gt;(U))</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ARMSubtarget_8cpp.html#a6a14930b01ccb1cf446cd96395284102">IT</a>-&gt;isLifetimeStartOrEnd())</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (U != <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &amp;&amp; U != cpyLoad)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="comment">// Check whether src is captured by the called function, in which case there</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">// may be further indirect uses of src.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordtype">bool</span> SrcIsCaptured = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;args(), [&amp;](<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    return U-&gt;stripPointerCasts() == cpySrc &amp;&amp;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;           !C-&gt;doesNotCapture(C-&gt;getArgOperandNo(&amp;U));</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  });</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// If src is captured, then check whether there are any potential uses of</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// src through the captured pointer before the lifetime of src ends, either</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// due to a lifetime.end or a return from the function.</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">if</span> (SrcIsCaptured) {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">// Check that dest is not captured before/at the call. We have already</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">// checked that src is not captured before it. If either had been captured,</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">// then the call might be comparing the argument against the captured dest</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">// or src pointer.</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *DestObj = <a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(cpyDest);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#abe71bc4610a9dc7aa3a6c6e0e28fc14a">isIdentifiedFunctionLocal</a>(DestObj) ||</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <a class="code" href="namespacellvm.html#a3693cec8e936224ad3e5748debe73b75">PointerMayBeCapturedBefore</a>(DestObj, <span class="comment">/* ReturnCaptures */</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                   <span class="comment">/* StoreCaptures */</span> <span class="keyword">true</span>, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, DT,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                   <span class="comment">/* IncludeI */</span> <span class="keyword">true</span>))</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> SrcLoc =</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a>(srcAlloca, <a class="code" href="classllvm_1_1LocationSize.html#a131715ceeb92fb803a329d6b76d14e0d">LocationSize::precise</a>(srcSize));</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> :</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;         <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(++<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getIterator(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getParent()-&gt;end())) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="comment">// Lifetime of srcAlloca ends at lifetime.end.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">if</span> (II-&gt;getIntrinsicID() == Intrinsic::lifetime_end &amp;&amp;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            II-&gt;getArgOperand(1)-&gt;stripPointerCasts() == srcAlloca &amp;&amp;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            cast&lt;ConstantInt&gt;(II-&gt;getArgOperand(0))-&gt;uge(srcSize))</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="comment">// Lifetime of srcAlloca ends at return.</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">if</span> (isa&lt;ReturnInst&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="comment">// Ignore the direct read of src in the load.</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">if</span> (&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == cpyLoad)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="comment">// Check whether this instruction may mod/ref src through the captured</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="comment">// pointer (we have already any direct mod/refs in the loop above).</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="comment">// Also bail if we hit a terminator, as we don&#39;t want to scan into other</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="comment">// blocks.</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(BAA.<a class="code" href="classllvm_1_1BatchAAResults.html#adfa0be41805b25d9577d6f15d148a0d7">getModRefInfo</a>(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, SrcLoc)) || <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isTerminator())</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="comment">// Since we&#39;re changing the parameter to the callsite, we need to make sure</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="comment">// that what would be the new parameter dominates the callsite.</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordflow">if</span> (!DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(cpyDest, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>)) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">// Support moving a constant index GEP before the call.</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keyword">auto</span> *<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> = dyn_cast&lt;GetElementPtrInst&gt;(cpyDest);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a> &amp;&amp; <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;hasAllConstantIndices() &amp;&amp;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(<a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;getPointerOperand(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>))</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <a class="code" href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a>-&gt;moveBefore(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="comment">// In addition to knowing that the call does not access src in some</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">// unexpected manner, for example via a global, which we deduce from</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">// the use analysis, we also need to know that it does not sneakily</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// access dest.  We rely on AA to figure this out for us.</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> DestWithSrcSize(cpyDest, <a class="code" href="classllvm_1_1LocationSize.html#a131715ceeb92fb803a329d6b76d14e0d">LocationSize::precise</a>(srcSize));</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <a class="code" href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2e">ModRefInfo</a> MR = BAA.<a class="code" href="classllvm_1_1BatchAAResults.html#adfa0be41805b25d9577d6f15d148a0d7">getModRefInfo</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, DestWithSrcSize);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">// If necessary, perform additional analysis.</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(MR))</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    MR = BAA.<a class="code" href="classllvm_1_1BatchAAResults.html#afa44555b5242035c9df7941911186c44">callCapturesBefore</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, DestWithSrcSize, DT);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">isModOrRefSet</a>(MR))</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">// We can&#39;t create address space casts here because we don&#39;t know if they&#39;re</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// safe for the target.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordflow">if</span> (cpySrc-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>() !=</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      cpyDest-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>())</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ArgI = 0; ArgI &lt; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;arg_size(); ++ArgI)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getArgOperand(ArgI)-&gt;stripPointerCasts() == cpySrc &amp;&amp;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        cpySrc-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>() !=</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getArgOperand(ArgI)-&gt;getType()-&gt;getPointerAddressSpace())</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="comment">// All the checks have passed, so do the transformation.</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordtype">bool</span> changedArgument = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ArgI = 0; ArgI &lt; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;arg_size(); ++ArgI)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getArgOperand(ArgI)-&gt;stripPointerCasts() == cpySrc) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Dest = cpySrc-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() == cpyDest-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() ?  cpyDest</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        : <a class="code" href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">CastInst::CreatePointerCast</a>(cpyDest, cpySrc-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                                      cpyDest-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      changedArgument = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getArgOperand(ArgI)-&gt;getType() == Dest-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>())</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;setArgOperand(ArgI, Dest);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;setArgOperand(ArgI, <a class="code" href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">CastInst::CreatePointerCast</a>(</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                   Dest, <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;getArgOperand(ArgI)-&gt;getType(),</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                   Dest-&gt;<a class="code" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>(), <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>));</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">if</span> (!changedArgument)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="comment">// If the destination wasn&#39;t sufficiently aligned then increase its alignment.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="keywordflow">if</span> (!isDestSufficientlyAligned) {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;AllocaInst&gt;(cpyDest) &amp;&amp; <span class="stringliteral">&quot;Can only increase alloca alignment!&quot;</span>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    cast&lt;AllocaInst&gt;(cpyDest)-&gt;setAlignment(srcAlign);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keywordflow">if</span> (SkippedLifetimeStart) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    SkippedLifetimeStart-&gt;<a class="code" href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#af58e16a1d7ebc8f202ae2f8037b42df6">moveBefore</a>(MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(SkippedLifetimeStart),</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                      MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>));</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <span class="comment">// Update AA metadata</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="comment">// FIXME: MD_tbaa_struct and MD_mem_parallel_loop_access should also be</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="comment">// handled here, but combineMetadata doesn&#39;t support them yet</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordtype">unsigned</span> KnownIDs[] = {LLVMContext::MD_tbaa, LLVMContext::MD_alias_scope,</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                         LLVMContext::MD_noalias,</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                         LLVMContext::MD_invariant_group,</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                         LLVMContext::MD_access_group};</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="namespacellvm.html#a929b458d1b5080256b6f6c8141bbdfea">combineMetadata</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, cpyLoad, KnownIDs, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">if</span> (cpyLoad != cpyStore)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="namespacellvm.html#a929b458d1b5080256b6f6c8141bbdfea">combineMetadata</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, cpyStore, KnownIDs, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  ++NumCallSlot;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;}</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">/// We&#39;ve found that the (upward scanning) memory dependence of memcpy &#39;M&#39; is</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">/// the memcpy &#39;MDep&#39;. Try to simplify M to copy from MDep&#39;s input if we can.</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::processMemCpyMemCpyDependence(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *M,</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                                  <a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MDep,</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                                  <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> &amp;BAA) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="comment">// We can only transforms memcpy&#39;s where the dest of one is the source of the</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">// other.</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getSource() != MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>() || MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>())</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="comment">// If dep instruction is reading from our current input, then it is a noop</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="comment">// transfer and substituting the input won&#39;t change this instruction.  Just</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="comment">// ignore the input and let someone else zap MDep.  This handles cases like:</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">//    memcpy(a &lt;- a)</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="comment">//    memcpy(b &lt;- a)</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getSource() == MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>())</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">// Second, the length of the memcpy&#39;s must be the same, or the preceding one</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="comment">// must be larger than the following one.</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">if</span> (MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>() != <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength()) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keyword">auto</span> *MDepLen = dyn_cast&lt;ConstantInt&gt;(MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>());</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keyword">auto</span> *MLen = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength());</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span> (!MDepLen || !MLen || MDepLen-&gt;getZExtValue() &lt; MLen-&gt;getZExtValue())</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="comment">// Verify that the copied-from memory doesn&#39;t change in between the two</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="comment">// transfers.  For example, in:</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">//    memcpy(a &lt;- b)</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="comment">//    *b = 42;</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="comment">//    memcpy(c &lt;- a)</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">// It would be invalid to transform the second memcpy into memcpy(c &lt;- b).</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">// TODO: If the code between M and MDep is transparent to the destination &quot;c&quot;,</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="comment">// then we could still perform the xform by moving M up to the first memcpy.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="comment">// TODO: It would be sufficient to check the MDep source up to the memcpy</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="comment">// size of M, rather than MDep.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#ab06d3147949b764919b5ad90014afdfd">writtenBetween</a>(MSSA, BAA, <a class="code" href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">MemoryLocation::getForSource</a>(MDep),</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                     MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MDep), MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(M)))</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="comment">// If the dest of the second might alias the source of the first, then the</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// source and dest might overlap. In addition, if the source of the first</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="comment">// points to constant memory, they won&#39;t overlap by definition. Otherwise, we</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">// still want to eliminate the intermediate value, but we have to generate a</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="comment">// memmove instead of memcpy.</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="keywordtype">bool</span> UseMemMove = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">isModSet</a>(BAA.<a class="code" href="classllvm_1_1BatchAAResults.html#adfa0be41805b25d9577d6f15d148a0d7">getModRefInfo</a>(M, <a class="code" href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">MemoryLocation::getForSource</a>(MDep))))</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    UseMemMove = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">// If all checks passed, then we can transform M.</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;MemCpyOptPass: Forwarding memcpy-&gt;memcpy src:\n&quot;</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                    &lt;&lt; *MDep &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; *M &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">// TODO: Is this worth it if we&#39;re creating a less aligned memcpy? For</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// example we could be moving from movaps -&gt; movq on x86.</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(M);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewM;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">if</span> (UseMemMove)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    NewM = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemMove(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getRawDest(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDestAlign(),</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                 MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">getRawSource</a>(), MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">getSourceAlign</a>(),</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                 <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;isVolatile());</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;MemCpyInlineInst&gt;(M)) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">// llvm.memcpy may be promoted to llvm.memcpy.inline, but the converse is</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">// never allowed since that would allow the latter to be lowered as a call</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">// to an external function.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    NewM = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemCpyInline(</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getRawDest(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDestAlign(), MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">getRawSource</a>(),</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">getSourceAlign</a>(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;isVolatile());</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    NewM = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemCpy(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getRawDest(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDestAlign(),</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">getRawSource</a>(), MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">getSourceAlign</a>(),</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;isVolatile());</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  NewM-&gt;<a class="code" href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">copyMetadata</a>(*M, LLVMContext::MD_DIAssignID);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;MemoryDef&gt;(MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(M)));</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keyword">auto</span> *LastDef = cast&lt;MemoryDef&gt;(MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(M));</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keyword">auto</span> *NewAccess = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#acf9a0bb25aae89d274ee9ae7dd0cf9b2">createMemoryAccessAfter</a>(NewM, LastDef, LastDef);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">insertDef</a>(cast&lt;MemoryDef&gt;(NewAccess), <span class="comment">/*RenameUses=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">// Remove the instruction we&#39;re replacing.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  eraseInstruction(M);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  ++NumMemCpyInstr;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;}</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">/// We&#39;ve found that the (upward scanning) memory dependence of \p MemCpy is</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">/// \p MemSet.  Try to simplify \p MemSet to only set the trailing bytes that</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">/// weren&#39;t copied over by \p MemCpy.</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">/// In other words, transform:</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">///   memset(dst, c, dst_size);</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">///   memcpy(dst, src, src_size);</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">/// into:</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">///   memcpy(dst, src, src_size);</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">///   memset(dst + src_size, c, dst_size &lt;= src_size ? 0 : dst_size - src_size);</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::processMemSetMemCpyDependence(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MemCpy,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                                                  <a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MemSet,</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                                  <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> &amp;BAA) {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="comment">// We can only transform memset/memcpy with the same destination.</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="keywordflow">if</span> (!BAA.<a class="code" href="classllvm_1_1BatchAAResults.html#ab9ba3a606a0299b684755f56b1d2f1c7">isMustAlias</a>(MemSet-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>(), MemCpy-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>()))</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// Check that src and dst of the memcpy aren&#39;t the same. While memcpy</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="comment">// operands cannot partially overlap, exact equality is allowed.</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">isModSet</a>(BAA.<a class="code" href="classllvm_1_1BatchAAResults.html#adfa0be41805b25d9577d6f15d148a0d7">getModRefInfo</a>(MemCpy, <a class="code" href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">MemoryLocation::getForSource</a>(MemCpy))))</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="comment">// We know that dst up to src_size is not written. We now need to make sure</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">// that dst up to dst_size is not accessed. (If we did not move the memset,</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">// checking for reads would be sufficient.)</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#a732b03e0a47de172531cbae6e0ae0193">accessedBetween</a>(BAA, <a class="code" href="classllvm_1_1MemoryLocation.html#ac8f8983c6b76d0e30f22fff86b281f16">MemoryLocation::getForDest</a>(MemSet),</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                      MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MemSet),</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                      MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MemCpy)))</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="comment">// Use the same i8* dest as the memcpy, killing the memset dest if different.</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Dest = MemCpy-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>();</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *DestSize = MemSet-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>();</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SrcSize = MemCpy-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>();</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#a684dc4713d6cd9e5383eda83ec3e620f">mayBeVisibleThroughUnwinding</a>(Dest, MemSet, MemCpy))</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="comment">// If the sizes are the same, simply drop the memset instead of generating</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">// a replacement with zero size.</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="keywordflow">if</span> (DestSize == SrcSize) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    eraseInstruction(MemSet);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">// By default, create an unaligned memset.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = <a class="code" href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a>(1);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">// If Dest is aligned, and SrcSize is constant, use the minimum alignment</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="comment">// of the sum.</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keyword">const</span> <a class="code" href="structllvm_1_1Align.html">Align</a> DestAlign = <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::max</a>(MemSet-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">getDestAlign</a>().<a class="code" href="structllvm_1_1MaybeAlign.html#a06846474be3ab85f8d30c388faf3b116">valueOrOne</a>(),</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                   MemCpy-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">getDestAlign</a>().<a class="code" href="structllvm_1_1MaybeAlign.html#a06846474be3ab85f8d30c388faf3b116">valueOrOne</a>());</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">if</span> (DestAlign &gt; 1)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *SrcSizeC = dyn_cast&lt;ConstantInt&gt;(SrcSize))</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      Alignment = <a class="code" href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">commonAlignment</a>(DestAlign, SrcSizeC-&gt;getZExtValue());</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(MemCpy);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="comment">// If the sizes have different types, zext the smaller one.</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">if</span> (DestSize-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != SrcSize-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">if</span> (DestSize-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>() &gt;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        SrcSize-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>())</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      SrcSize = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(SrcSize, DestSize-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      DestSize = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateZExt(DestSize, SrcSize-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Ule = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateICmpULE(DestSize, SrcSize);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *SizeDiff = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSub(DestSize, SrcSize);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *MemsetLen = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateSelect(</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      Ule, <a class="code" href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(DestSize-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()), SizeDiff);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keywordtype">unsigned</span> DestAS = Dest-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewMemSet = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemSet(</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateGEP(</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8Ty(),</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreatePointerCast(Dest, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy(DestAS)),</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;          SrcSize),</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      MemSet-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1), MemsetLen, Alignment);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isa&lt;MemoryDef&gt;(MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MemCpy)) &amp;&amp;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;         <span class="stringliteral">&quot;MemCpy must be a MemoryDef&quot;</span>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">// The new memset is inserted after the memcpy, but it is known that its</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="comment">// defining access is the memset about to be removed which immediately</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="comment">// precedes the memcpy.</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keyword">auto</span> *LastDef =</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      cast&lt;MemoryDef&gt;(MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MemCpy));</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="keyword">auto</span> *NewAccess = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a1c21c2f4d41d5c6f6807992d60347bbd">createMemoryAccessBefore</a>(</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      NewMemSet, LastDef-&gt;getDefiningAccess(), LastDef);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">insertDef</a>(cast&lt;MemoryDef&gt;(NewAccess), <span class="comment">/*RenameUses=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  eraseInstruction(MemSet);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;}</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">/// Determine whether the instruction has undefined content for the given Size,</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">/// either because it was freshly alloca&#39;d or started its lifetime.</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"><a class="line" href="MemCpyOptimizer_8cpp.html#a781cb075ecf323c9670d5695db656718"> 1341</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="MemCpyOptimizer_8cpp.html#a781cb075ecf323c9670d5695db656718">hasUndefContents</a>(<a class="code" href="classllvm_1_1MemorySSA.html">MemorySSA</a> *MSSA, <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> &amp;AA, <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                             <a class="code" href="classllvm_1_1MemoryDef.html">MemoryDef</a> *<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>, <a class="code" href="classllvm_1_1Value.html">Value</a> *Size) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">if</span> (MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#ae3b89ffde42778289bcbd8a187199420">isLiveOnEntryDef</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>))</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordflow">return</span> isa&lt;AllocaInst&gt;(<a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(V));</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *II = dyn_cast_or_null&lt;IntrinsicInst&gt;(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">Def</a>-&gt;getMemoryInst())) {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">if</span> (II-&gt;getIntrinsicID() == Intrinsic::lifetime_start) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keyword">auto</span> *LTSize = cast&lt;ConstantInt&gt;(II-&gt;getArgOperand(0));</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CSize = dyn_cast&lt;ConstantInt&gt;(Size)) {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <span class="keywordflow">if</span> (AA.<a class="code" href="classllvm_1_1BatchAAResults.html#ab9ba3a606a0299b684755f56b1d2f1c7">isMustAlias</a>(V, II-&gt;getArgOperand(1)) &amp;&amp;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            LTSize-&gt;getZExtValue() &gt;= CSize-&gt;getZExtValue())</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="comment">// If the lifetime.start covers a whole alloca (as it almost always</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="comment">// does) and we&#39;re querying a pointer based on that alloca, then we know</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="comment">// the memory is definitely undef, regardless of how exactly we alias.</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="comment">// The size also doesn&#39;t matter, as an out-of-bounds access would be UB.</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Alloca = dyn_cast&lt;AllocaInst&gt;(<a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(V))) {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">getUnderlyingObject</a>(II-&gt;getArgOperand(1)) == Alloca) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;          <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = Alloca-&gt;getModule()-&gt;getDataLayout();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;          <span class="keywordflow">if</span> (std::optional&lt;TypeSize&gt; AllocaSize =</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                  Alloca-&gt;getAllocationSize(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>))</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            <span class="keywordflow">if</span> (*AllocaSize == LTSize-&gt;getValue())</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;}</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">/// Transform memcpy to memset when its source was just memset.</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">/// In other words, turn:</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">///   memset(dst1, c, dst1_size);</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">///   memcpy(dst2, dst1, dst2_size);</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">/// into:</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">/// \code</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">///   memset(dst1, c, dst1_size);</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">///   memset(dst2, c, dst2_size);</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">/// \endcode</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">/// When dst2_size &lt;= dst1_size.</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::performMemCpyToMemSetOptzn(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MemCpy,</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                                               <a class="code" href="classllvm_1_1MemSetInst.html">MemSetInst</a> *MemSet,</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                               <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> &amp;BAA) {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="comment">// Make sure that memcpy(..., memset(...), ...), that is we are memsetting and</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="comment">// memcpying from the same address. Otherwise it is hard to reason about.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">if</span> (!BAA.<a class="code" href="classllvm_1_1BatchAAResults.html#ab9ba3a606a0299b684755f56b1d2f1c7">isMustAlias</a>(MemSet-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>(), MemCpy-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">getRawSource</a>()))</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *MemSetSize = MemSet-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>();</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *CopySize = MemCpy-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>();</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordflow">if</span> (MemSetSize != CopySize) {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">// Make sure the memcpy doesn&#39;t read any more than what the memset wrote.</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">// Don&#39;t worry about sizes larger than i64.</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">// A known memset size is required.</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keyword">auto</span> *CMemSetSize = dyn_cast&lt;ConstantInt&gt;(MemSetSize);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordflow">if</span> (!CMemSetSize)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// A known memcpy size is also required.</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keyword">auto</span>  *CCopySize = dyn_cast&lt;ConstantInt&gt;(CopySize);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">if</span> (!CCopySize)</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span> (CCopySize-&gt;getZExtValue() &gt; CMemSetSize-&gt;getZExtValue()) {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="comment">// If the memcpy is larger than the memset, but the memory was undef prior</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="comment">// to the memset, we can just ignore the tail. Technically we&#39;re only</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="comment">// interested in the bytes from MemSetSize..CopySize here, but as we can&#39;t</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="comment">// easily represent this location, we use the full 0..CopySize range.</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> MemCpyLoc = <a class="code" href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">MemoryLocation::getForSource</a>(MemCpy);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keywordtype">bool</span> CanReduceSize = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *MemSetAccess = MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MemSet);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *Clobber = MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a949151a1ebd664cb397323294cec0e53">getWalker</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSAWalker.html#a95d0e423957d029a78e5868f539e9cce">getClobberingMemoryAccess</a>(</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          MemSetAccess-&gt;<a class="code" href="classllvm_1_1MemoryUseOrDef.html#abc4e1b6cc483cfd57ca75c4ab92bd360">getDefiningAccess</a>(), MemCpyLoc, BAA);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MD = dyn_cast&lt;MemoryDef&gt;(Clobber))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#a781cb075ecf323c9670d5695db656718">hasUndefContents</a>(MSSA, BAA, MemCpy-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>(), MD, CopySize))</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          CanReduceSize = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">if</span> (!CanReduceSize)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      CopySize = MemSetSize;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(MemCpy);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewM =</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemSet(MemCpy-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">getRawDest</a>(), MemSet-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1),</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                           CopySize, MemCpy-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">getDestAlign</a>());</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keyword">auto</span> *LastDef =</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      cast&lt;MemoryDef&gt;(MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MemCpy));</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="keyword">auto</span> *NewAccess = MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#acf9a0bb25aae89d274ee9ae7dd0cf9b2">createMemoryAccessAfter</a>(NewM, LastDef, LastDef);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">insertDef</a>(cast&lt;MemoryDef&gt;(NewAccess), <span class="comment">/*RenameUses=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;}</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">/// Perform simplification of memcpy&#39;s.  If we have memcpy A</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">/// which copies X to Y, and memcpy B which copies Y to Z, then we can rewrite</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">/// B to be a memcpy from X to Z (or potentially a memmove, depending on</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">/// circumstances). This allows later passes to remove the first memcpy</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">/// altogether.</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::processMemCpy(<a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *M, <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> &amp;BBI) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="comment">// We can only optimize non-volatile memcpy&#39;s.</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;isVolatile()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="comment">// If the source and destination of the memcpy are the same, then zap it.</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getSource() == <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDest()) {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    ++BBI;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    eraseInstruction(M);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="comment">// If copying from a constant, try to turn the memcpy into a memset.</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *GV = dyn_cast&lt;GlobalVariable&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getSource()))</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">if</span> (GV-&gt;isConstant() &amp;&amp; GV-&gt;hasDefinitiveInitializer())</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Value.html">Value</a> *ByteVal = <a class="code" href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">isBytewiseValue</a>(GV-&gt;getInitializer(),</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                           <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getModule()-&gt;getDataLayout())) {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(M);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *NewM = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateMemSet(</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getRawDest(), ByteVal, <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDestAlign(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keyword">auto</span> *LastDef =</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            cast&lt;MemoryDef&gt;(MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">getMemorySSA</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(M));</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keyword">auto</span> *NewAccess =</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#acf9a0bb25aae89d274ee9ae7dd0cf9b2">createMemoryAccessAfter</a>(NewM, LastDef, LastDef);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        MSSAU-&gt;<a class="code" href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">insertDef</a>(cast&lt;MemoryDef&gt;(NewAccess), <span class="comment">/*RenameUses=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        eraseInstruction(M);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        ++NumCpyToSet;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> BAA(*AA);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *MA = MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(M);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">// FIXME: Not using getClobberingMemoryAccess() here due to PR54682.</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *AnyClobber = MA-&gt;<a class="code" href="classllvm_1_1MemoryUseOrDef.html#abc4e1b6cc483cfd57ca75c4ab92bd360">getDefiningAccess</a>();</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> DestLoc = <a class="code" href="classllvm_1_1MemoryLocation.html#ac8f8983c6b76d0e30f22fff86b281f16">MemoryLocation::getForDest</a>(M);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *DestClobber =</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a949151a1ebd664cb397323294cec0e53">getWalker</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSAWalker.html#a95d0e423957d029a78e5868f539e9cce">getClobberingMemoryAccess</a>(AnyClobber, DestLoc, BAA);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// Try to turn a partially redundant memset + memcpy into</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="comment">// memcpy + smaller memset.  We don&#39;t need the memcpy size for this.</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="comment">// The memcpy most post-dom the memset, so limit this to the same basic</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="comment">// block. A non-local generalization is likely not worthwhile.</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MD = dyn_cast&lt;MemoryDef&gt;(DestClobber))</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MDep = dyn_cast_or_null&lt;MemSetInst&gt;(MD-&gt;getMemoryInst()))</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">if</span> (DestClobber-&gt;<a class="code" href="classllvm_1_1MemoryAccess.html#aa468ad3fa68bdf6703c391deaec97706">getBlock</a>() == <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getParent())</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">if</span> (processMemSetMemCpyDependence(M, MDep, BAA))</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *SrcClobber = MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a949151a1ebd664cb397323294cec0e53">getWalker</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSAWalker.html#a95d0e423957d029a78e5868f539e9cce">getClobberingMemoryAccess</a>(</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      AnyClobber, <a class="code" href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">MemoryLocation::getForSource</a>(M), BAA);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">// There are four possible optimizations we can do for memcpy:</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="comment">//   a) memcpy-memcpy xform which exposes redundance for DSE.</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">//   b) call-memcpy xform for return slot optimization.</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">//   c) memcpy from freshly alloca&#39;d space or space that has just started</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">//      its lifetime copies undefined data, and we can therefore eliminate</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="comment">//      the memcpy in favor of the data that was already at the destination.</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="comment">//   d) memcpy from a just-memset&#39;d source can be turned into memset.</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MD = dyn_cast&lt;MemoryDef&gt;(SrcClobber)) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = MD-&gt;getMemoryInst()) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CopySize = dyn_cast&lt;ConstantInt&gt;(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength())) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = dyn_cast&lt;CallInst&gt;(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;          <span class="keywordflow">if</span> (performCallSlotOptzn(M, M, <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDest(), <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getSource(),</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                                   <a class="code" href="classllvm_1_1TypeSize.html#a003b4369b4130e669dc9139798e0193c">TypeSize::getFixed</a>(CopySize-&gt;getZExtValue()),</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                                   <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDestAlign().valueOrOne(), BAA,</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                                   [<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>]() -&gt; <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> * { return C; })) {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Performed call slot optimization:\n&quot;</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;    call: &quot;</span> &lt;&lt; *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                              &lt;&lt; <span class="stringliteral">&quot;    memcpy: &quot;</span> &lt;&lt; *M &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            eraseInstruction(M);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            ++NumMemCpyInstr;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      }</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MDep = dyn_cast&lt;MemCpyInst&gt;(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">return</span> processMemCpyMemCpyDependence(M, MDep, BAA);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MDep = dyn_cast&lt;MemSetInst&gt;(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">if</span> (performMemCpyToMemSetOptzn(M, MDep, BAA)) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Converted memcpy to memset\n&quot;</span>);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;          eraseInstruction(M);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;          ++NumCpyToSet;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#a781cb075ecf323c9670d5695db656718">hasUndefContents</a>(MSSA, BAA, <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getSource(), MD, <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength())) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Removed memcpy from undef\n&quot;</span>);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      eraseInstruction(M);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      ++NumMemCpyInstr;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  }</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;}</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">/// Transforms memmove calls to memcpy calls when the src/dst are guaranteed</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">/// not to alias.</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::processMemMove(<a class="code" href="classllvm_1_1MemMoveInst.html">MemMoveInst</a> *M) {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="comment">// See if the source could be modified by this memmove potentially.</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">isModSet</a>(AA-&gt;<a class="code" href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">getModRefInfo</a>(M, <a class="code" href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">MemoryLocation::getForSource</a>(M))))</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;MemCpyOptPass: Optimizing memmove -&gt; memcpy: &quot;</span> &lt;&lt; *M</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="comment">// If not, then we know we can transform this.</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ArgTys[3] = { <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getRawDest()-&gt;getType(),</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                      <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getRawSource()-&gt;getType(),</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                      <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getLength()-&gt;getType() };</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;setCalledFunction(<a class="code" href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">Intrinsic::getDeclaration</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getModule(),</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                                 <a class="code" href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">Intrinsic::memcpy</a>, ArgTys));</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">// For MemorySSA nothing really changes (except that memcpy may imply stricter</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="comment">// aliasing guarantees).</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  ++NumMoveToCpy;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;}</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">/// This is called on every byval argument in call sites.</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::processByValArgument(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB, <span class="keywordtype">unsigned</span> ArgNo) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = CB.<a class="code" href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">getCaller</a>()-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">getParent</a>()-&gt;<a class="code" href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">getDataLayout</a>();</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">// Find out what feeds this byval argument.</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *ByValArg = CB.<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(ArgNo);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *ByValTy = CB.<a class="code" href="classllvm_1_1CallBase.html#ad58305d5392be750e7bfae4d114d4db7">getParamByValType</a>(ArgNo);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> ByValSize = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(ByValTy);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <a class="code" href="classllvm_1_1MemoryLocation.html">MemoryLocation</a> Loc(ByValArg, <a class="code" href="classllvm_1_1LocationSize.html#a131715ceeb92fb803a329d6b76d14e0d">LocationSize::precise</a>(ByValSize));</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <a class="code" href="classllvm_1_1MemoryUseOrDef.html">MemoryUseOrDef</a> *CallAccess = MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(&amp;CB);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">if</span> (!CallAccess)</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <a class="code" href="classllvm_1_1MemCpyInst.html">MemCpyInst</a> *MDep = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <a class="code" href="classllvm_1_1BatchAAResults.html">BatchAAResults</a> BAA(*AA);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <a class="code" href="classllvm_1_1MemoryAccess.html">MemoryAccess</a> *Clobber = MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a949151a1ebd664cb397323294cec0e53">getWalker</a>()-&gt;<a class="code" href="classllvm_1_1MemorySSAWalker.html#a95d0e423957d029a78e5868f539e9cce">getClobberingMemoryAccess</a>(</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      CallAccess-&gt;<a class="code" href="classllvm_1_1MemoryUseOrDef.html#abc4e1b6cc483cfd57ca75c4ab92bd360">getDefiningAccess</a>(), Loc, BAA);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *MD = dyn_cast&lt;MemoryDef&gt;(Clobber))</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    MDep = dyn_cast_or_null&lt;MemCpyInst&gt;(MD-&gt;getMemoryInst());</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">// If the byval argument isn&#39;t fed by a memcpy, ignore it.  If it is fed by</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="comment">// a memcpy, see if we can byval from the source of the memcpy instead of the</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="comment">// result.</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="keywordflow">if</span> (!MDep || MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">isVolatile</a>() ||</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>() != MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">getDest</a>())</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="comment">// The length of the memcpy must be larger or equal to the size of the byval.</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> = dyn_cast&lt;ConstantInt&gt;(MDep-&gt;<a class="code" href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">getLength</a>());</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a> || !<a class="code" href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#afb486f9022a26e1cc53ff189710dbde5">TypeSize::isKnownGE</a>(</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                 <a class="code" href="classllvm_1_1TypeSize.html#a003b4369b4130e669dc9139798e0193c">TypeSize::getFixed</a>(<a class="code" href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a>-&gt;getValue().getZExtValue()), ByValSize))</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="comment">// Get the alignment of the byval.  If the call doesn&#39;t specify the alignment,</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="comment">// then it is some target specific value that we can&#39;t know.</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> ByValAlign = CB.<a class="code" href="classllvm_1_1CallBase.html#a7713a45c8983df00c3975444b94e69ae">getParamAlign</a>(ArgNo);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordflow">if</span> (!ByValAlign) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="comment">// If it is greater than the memcpy, then we check to see if we can force the</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="comment">// source of the memcpy to the alignment we need.  If we fail, we bail out.</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <a class="code" href="structllvm_1_1MaybeAlign.html">MaybeAlign</a> MemDepAlign = MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">getSourceAlign</a>();</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keywordflow">if</span> ((!MemDepAlign || *MemDepAlign &lt; *ByValAlign) &amp;&amp;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <a class="code" href="namespacellvm.html#a6e7b79b3933def717c2a0f2fc6fa38e0">getOrEnforceKnownAlignment</a>(MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>(), ByValAlign, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, &amp;CB, AC,</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                 DT) &lt; *ByValAlign)</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="comment">// The address space of the memcpy source must match the byval argument</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="keywordflow">if</span> (MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>() !=</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>())</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="comment">// Verify that the copied-from memory doesn&#39;t change in between the memcpy and</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">// the byval call.</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="comment">//    memcpy(a &lt;- b)</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="comment">//    *b = 42;</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="comment">//    foo(*a)</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="comment">// It would be invalid to transform the second memcpy into foo(*b).</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MemCpyOptimizer_8cpp.html#ab06d3147949b764919b5ad90014afdfd">writtenBetween</a>(MSSA, BAA, <a class="code" href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">MemoryLocation::getForSource</a>(MDep),</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                     MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(MDep), MSSA-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">getMemoryAccess</a>(&amp;CB)))</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TmpCast = MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>();</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="keywordflow">if</span> (MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>()-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>() != ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()) {</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *TmpBitCast = <span class="keyword">new</span> <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a>(MDep-&gt;<a class="code" href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">getSource</a>(), ByValArg-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>(),</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                                              <span class="stringliteral">&quot;tmpcast&quot;</span>, &amp;CB);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// Set the tmpcast&#39;s DebugLoc to MDep&#39;s</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    TmpBitCast-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(MDep-&gt;<a class="code" href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">getDebugLoc</a>());</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    TmpCast = TmpBitCast;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;MemCpyOptPass: Forwarding memcpy to byval:\n&quot;</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; *MDep &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; CB &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="comment">// Otherwise we&#39;re good!  Update the byval argument.</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  CB.<a class="code" href="classllvm_1_1CallBase.html#abc10b887caad109288ffceb230493a85">setArgOperand</a>(ArgNo, TmpCast);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  ++NumMemCpyInstr;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;}</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">/// Executes one iteration of MemCpyOptPass.</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> MemCpyOptPass::iterateOnFunction(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">// Walk all instruction in the function.</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">// Skip unreachable blocks. For example processStore assumes that an</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="comment">// instruction in a BB can&#39;t be dominated by a later instruction in the</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="comment">// same BB (which is a scenario that can happen for an unreachable BB that</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">// has itself as a predecessor).</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">if</span> (!DT-&gt;<a class="code" href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">isReachableFromEntry</a>(&amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>))</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> BI = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.begin(), BE = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.end(); BI != BE;) {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="comment">// Avoid invalidating the iterator.</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = &amp;*BI++;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <span class="keywordtype">bool</span> RepeatInstruction = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        MadeChange |= processStore(<a class="code" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, BI);</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *M = dyn_cast&lt;MemSetInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        RepeatInstruction = processMemSet(M, BI);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *M = dyn_cast&lt;MemCpyInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        RepeatInstruction = processMemCpy(M, BI);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *M = dyn_cast&lt;MemMoveInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        RepeatInstruction = processMemMove(M);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = dyn_cast&lt;CallBase&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">arg_size</a>(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;          <span class="keywordflow">if</span> (CB-&gt;<a class="code" href="classllvm_1_1CallBase.html#a610f151afe638890b21bea434a26821d">isByValArgument</a>(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            MadeChange |= processByValArgument(*CB, <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160; </div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <span class="comment">// Reprocess the instruction if desired.</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="keywordflow">if</span> (RepeatInstruction) {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="keywordflow">if</span> (BI != <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>.begin())</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          --BI;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;}</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"><a class="line" href="classllvm_1_1MemCpyOptPass.html#a07c3f5129a977e2f949212878c3042ae"> 1693</a></span>&#160;<a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code" href="classllvm_1_1MemCpyOptPass.html#a07c3f5129a977e2f949212878c3042ae">MemCpyOptPass::run</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keyword">auto</span> &amp;TLI = AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1TargetLibraryAnalysis.html">TargetLibraryAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keyword">auto</span> *AA = &amp;AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1AAManager.html">AAManager</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keyword">auto</span> *AC = &amp;AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1AssumptionAnalysis.html">AssumptionAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keyword">auto</span> *DT = &amp;AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeAnalysis.html">DominatorTreeAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keyword">auto</span> *MSSA = &amp;AM.<a class="code" href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">getResult</a>&lt;<a class="code" href="classllvm_1_1MemorySSAAnalysis.html">MemorySSAAnalysis</a>&gt;(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <a class="code" href="classllvm_1_1MemCpyOptPass.html#ad966ed260d2a1a972cdecff925a14dde">runImpl</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &amp;TLI, AA, AC, DT, &amp;MSSA-&gt;getMSSA());</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keywordflow">if</span> (!MadeChange)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <a class="code" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> PA;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#a937c42f77e161349ce0f999e448c7027">preserveSet</a>&lt;<a class="code" href="classllvm_1_1CFGAnalyses.html">CFGAnalyses</a>&gt;();</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  PA.<a class="code" href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">preserve</a>&lt;<a class="code" href="classllvm_1_1MemorySSAAnalysis.html">MemorySSAAnalysis</a>&gt;();</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordflow">return</span> PA;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;}</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"><a class="line" href="classllvm_1_1MemCpyOptPass.html#ad966ed260d2a1a972cdecff925a14dde"> 1710</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classllvm_1_1MemCpyOptPass.html#ad966ed260d2a1a972cdecff925a14dde">MemCpyOptPass::runImpl</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI_,</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                            <a class="code" href="classllvm_1_1AAResults.html">AliasAnalysis</a> *AA_, <a class="code" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> *AC_,</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                            <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT_, <a class="code" href="classllvm_1_1MemorySSA.html">MemorySSA</a> *MSSA_) {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="keywordtype">bool</span> MadeChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  TLI = TLI_;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  AA = AA_;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  AC = AC_;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  DT = DT_;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  MSSA = MSSA_;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <a class="code" href="classllvm_1_1MemorySSAUpdater.html">MemorySSAUpdater</a> MSSAU_(MSSA_);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  MSSAU = &amp;MSSAU_;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">if</span> (!iterateOnFunction(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    MadeChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#aa29fe161c408879ada30c90ebbf55dcf">VerifyMemorySSA</a>)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    MSSA_-&gt;<a class="code" href="classllvm_1_1MemorySSA.html#a88b10d37f671e58cf138ac84a8257c17">verifyMemorySSA</a>();</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordflow">return</span> MadeChange;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;}</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment">/// This is the main transformation entry point for a function.</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">MemCpyOptLegacyPass::runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">if</span> (skipFunction(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="keyword">auto</span> *TLI = &amp;getAnalysis&lt;TargetLibraryInfoWrapperPass&gt;().getTLI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="keyword">auto</span> *AA = &amp;getAnalysis&lt;AAResultsWrapperPass&gt;().getAAResults();</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keyword">auto</span> *AC = &amp;getAnalysis&lt;AssumptionCacheTracker&gt;().getAssumptionCache(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <span class="keyword">auto</span> *DT = &amp;getAnalysis&lt;DominatorTreeWrapperPass&gt;().getDomTree();</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="keyword">auto</span> *MSSA = &amp;getAnalysis&lt;MemorySSAWrapperPass&gt;().getMSSA();</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">return</span> Impl.<a class="code" href="classllvm_1_1MemCpyOptPass.html#ad966ed260d2a1a972cdecff925a14dde">runImpl</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, TLI, AA, AC, DT, MSSA);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1Check_html_a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396"><div class="ttname"><a href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">llvm::Check::Size</a></div><div class="ttdeci">@ Size</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8h_source.html#l00077">FileCheck.h:77</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1BatchAAResults_html"><div class="ttname"><a href="classllvm_1_1BatchAAResults.html">llvm::BatchAAResults</a></div><div class="ttdoc">This class is a wrapper over an AAResults, and it is intended to be used only when there are no IR ch...</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00612">AliasAnalysis.h:612</a></div></div>
<div class="ttc" id="aAssumptionCache_8h_html"><div class="ttname"><a href="AssumptionCache_8h.html">AssumptionCache.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAManager_html"><div class="ttname"><a href="classllvm_1_1AAManager.html">llvm::AAManager</a></div><div class="ttdoc">A manager for alias analyses.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00885">AliasAnalysis.h:885</a></div></div>
<div class="ttc" id="aIRTranslator_8cpp_html_abe44dfdea65b4f7e11e0a608ab708b76"><div class="ttname"><a href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div><div class="ttdeci">IRTranslator LLVM IR MI</div><div class="ttdef"><b>Definition:</b> <a href="IRTranslator_8cpp_source.html#l00109">IRTranslator.cpp:109</a></div></div>
<div class="ttc" id="aMathExtras_8h_html"><div class="ttname"><a href="MathExtras_8h.html">MathExtras.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryLocation_html_a18e5a3f1d71ba10a624f2a8e5121cf1f"><div class="ttname"><a href="classllvm_1_1MemoryLocation.html#a18e5a3f1d71ba10a624f2a8e5121cf1f">llvm::MemoryLocation::get</a></div><div class="ttdeci">static MemoryLocation get(const LoadInst *LI)</div><div class="ttdoc">Return a location with information about the memory reference by the given instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8cpp_source.html#l00036">MemoryLocation.cpp:36</a></div></div>
<div class="ttc" id="anamespacellvm_html_a929b458d1b5080256b6f6c8141bbdfea"><div class="ttname"><a href="namespacellvm.html#a929b458d1b5080256b6f6c8141bbdfea">llvm::combineMetadata</a></div><div class="ttdeci">void combineMetadata(Instruction *K, const Instruction *J, ArrayRef&lt; unsigned &gt; KnownIDs, bool DoesKMove)</div><div class="ttdoc">Combine the metadata of two instructions so that K can replace J.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02651">Local.cpp:2651</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5aceb138f68fe183995736614928e3394a">llvm::tgtok::Def</a></div><div class="ttdeci">@ Def</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00050">TGLexer.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html_a88b10d37f671e58cf138ac84a8257c17"><div class="ttname"><a href="classllvm_1_1MemorySSA.html#a88b10d37f671e58cf138ac84a8257c17">llvm::MemorySSA::verifyMemorySSA</a></div><div class="ttdeci">void verifyMemorySSA(VerificationLevel=VerificationLevel::Fast) const</div><div class="ttdoc">Verify that MemorySSA is self consistent (IE definitions dominate all uses, uses appear in the right ...</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8cpp_source.html#l01863">MemorySSA.cpp:1863</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4ba3a5be6c0e9b9e8a525de055836733"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4ba3a5be6c0e9b9e8a525de055836733">llvm::Instruction::getModule</a></div><div class="ttdeci">const Module * getModule() const</div><div class="ttdoc">Return the module owning the function this instruction belongs to or nullptr it the function does not...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00070">Instruction.cpp:70</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3a402430a1bbe70a9282dcb0e0b6a2cd"><div class="ttname"><a href="classllvm_1_1Value.html#a3a402430a1bbe70a9282dcb0e0b6a2cd">llvm::Value::hasOneUse</a></div><div class="ttdeci">bool hasOneUse() const</div><div class="ttdoc">Return true if there is exactly one use of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00434">Value.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html_a1c21c2f4d41d5c6f6807992d60347bbd"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html#a1c21c2f4d41d5c6f6807992d60347bbd">llvm::MemorySSAUpdater::createMemoryAccessBefore</a></div><div class="ttdeci">MemoryUseOrDef * createMemoryAccessBefore(Instruction *I, MemoryAccess *Definition, MemoryUseOrDef *InsertPt)</div><div class="ttdoc">Create a MemoryAccess in MemorySSA before or after an existing MemoryAccess.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8cpp_source.html#l01437">MemorySSAUpdater.cpp:1437</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_ac03b57021568dcc4d9a685c40011ff09"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#ac03b57021568dcc4d9a685c40011ff09">llvm::MemIntrinsicBase::getDestAlign</a></div><div class="ttdeci">MaybeAlign getDestAlign() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00847">IntrinsicInst.h:847</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_ab9d3d5412c20747fd0110a046604f09a"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#ab9d3d5412c20747fd0110a046604f09a">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00774">PassManager.h:774</a></div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_a781cb075ecf323c9670d5695db656718"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a781cb075ecf323c9670d5695db656718">hasUndefContents</a></div><div class="ttdeci">static bool hasUndefContents(MemorySSA *MSSA, BatchAAResults &amp;AA, Value *V, MemoryDef *Def, Value *Size)</div><div class="ttdoc">Determine whether the instruction has undefined content for the given Size, either because it was fre...</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l01341">MemCpyOptimizer.cpp:1341</a></div></div>
<div class="ttc" id="aLoads_8h_html"><div class="ttname"><a href="Loads_8h.html">Loads.h</a></div></div>
<div class="ttc" id="aclassT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="aMemorySSAUpdater_8h_html"><div class="ttname"><a href="MemorySSAUpdater_8h.html">MemorySSAUpdater.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_a9188f84e1dd67530330dcab9cae787d7"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a9188f84e1dd67530330dcab9cae787d7">llvm::details::FixedOrScalableQuantity::isScalable</a></div><div class="ttdeci">constexpr bool isScalable() const</div><div class="ttdoc">Returns whether the quantity is scaled by a runtime quantity (vscale).</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00166">TypeSize.h:166</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemMoveInst_html"><div class="ttname"><a href="classllvm_1_1MemMoveInst.html">llvm::MemMoveInst</a></div><div class="ttdoc">This class wraps the llvm.memmove intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01145">IntrinsicInst.h:1145</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05258">Instructions.h:5258</a></div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_a2a2df5a25b9c703e74e82b48a75d0c3d"><div class="ttname"><a href="lib_2Target_2README_8txt.html#a2a2df5a25b9c703e74e82b48a75d0c3d">C1</a></div><div class="ttdeci">instcombine should handle this C2 when C1</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00263">README.txt:263</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a4abb39a66573f61fda80469faa5d861d"><div class="ttname"><a href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">llvm::Type::getScalarType</a></div><div class="ttdeci">Type * getScalarType() const</div><div class="ttdoc">If this is a vector type, return the element type, otherwise return 'this'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00341">Type.h:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aCaptureTracking_8h_html"><div class="ttname"><a href="CaptureTracking_8h.html">CaptureTracking.h</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_a7530261f1f6c8e08347b485f8ffe90b4"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a7530261f1f6c8e08347b485f8ffe90b4">memcpyopt</a></div><div class="ttdeci">memcpyopt</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00303">MemCpyOptimizer.cpp:303</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a5ab2d0b0f0b8ceec3b907184e7567197"><div class="ttname"><a href="classllvm_1_1Type.html#a5ab2d0b0f0b8ceec3b907184e7567197">llvm::Type::getPointerAddressSpace</a></div><div class="ttdeci">unsigned getPointerAddressSpace() const</div><div class="ttdoc">Get the address space of this pointer or pointer vector type.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00729">DerivedTypes.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="anamespacellvm_html_a728f79528ca8659e15d00c1e6818b316"><div class="ttname"><a href="namespacellvm.html#a728f79528ca8659e15d00c1e6818b316">llvm::isModSet</a></div><div class="ttdeci">bool isModSet(const ModRefInfo MRI)</div><div class="ttdef"><b>Definition:</b> <a href="ModRef_8h_source.html#l00048">ModRef.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html_a56004f54560e9950f6eb148cb5dfa0a3"><div class="ttname"><a href="classllvm_1_1MemorySSA.html#a56004f54560e9950f6eb148cb5dfa0a3">llvm::MemorySSA::dominates</a></div><div class="ttdeci">bool dominates(const MemoryAccess *A, const MemoryAccess *B) const</div><div class="ttdoc">Given two memory accesses in potentially different blocks, determine whether MemoryAccess A dominates...</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8cpp_source.html#l02116">MemorySSA.cpp:2116</a></div></div>
<div class="ttc" id="aValueTracking_8h_html"><div class="ttname"><a href="ValueTracking_8h.html">ValueTracking.h</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="aGlobalsModRef_8h_html"><div class="ttname"><a href="GlobalsModRef_8h.html">GlobalsModRef.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aARMSubtarget_8cpp_html_a6a14930b01ccb1cf446cd96395284102"><div class="ttname"><a href="ARMSubtarget_8cpp.html#a6a14930b01ccb1cf446cd96395284102">IT</a></div><div class="ttdeci">static cl::opt&lt; ITMode &gt; IT(cl::desc(&quot;IT block support&quot;), cl::Hidden, cl::init(DefaultIT), cl::values(clEnumValN(DefaultIT, &quot;arm-default-it&quot;, &quot;Generate any type of IT block&quot;), clEnumValN(RestrictedIT, &quot;arm-restrict-it&quot;, &quot;Disallow complex IT blocks&quot;)))</div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_a732b03e0a47de172531cbae6e0ae0193"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a732b03e0a47de172531cbae6e0ae0193">accessedBetween</a></div><div class="ttdeci">static bool accessedBetween(BatchAAResults &amp;AA, MemoryLocation Loc, const MemoryUseOrDef *Start, const MemoryUseOrDef *End, Instruction **SkippedLifetimeStart=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00337">MemCpyOptimizer.cpp:337</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_a0636446566d0b4f7775c9a1658cfce7b"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a0636446566d0b4f7775c9a1658cfce7b">EnableMemCpyOptWithoutLibcalls</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableMemCpyOptWithoutLibcalls(&quot;enable-memcpyopt-without-libcalls&quot;, cl::Hidden, cl::desc(&quot;Enable memcpyopt even when libcalls are disabled&quot;))</div></div>
<div class="ttc" id="anamespacellvm_html_a6e7b79b3933def717c2a0f2fc6fa38e0"><div class="ttname"><a href="namespacellvm.html#a6e7b79b3933def717c2a0f2fc6fa38e0">llvm::getOrEnforceKnownAlignment</a></div><div class="ttdeci">Align getOrEnforceKnownAlignment(Value *V, MaybeAlign PrefAlign, const DataLayout &amp;DL, const Instruction *CxtI=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr)</div><div class="ttdoc">Try to ensure that the alignment of V is at least PrefAlign bytes.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l01439">Local.cpp:1439</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_ad4bb544993573a6677d97cf5413110c7"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#ad4bb544993573a6677d97cf5413110c7">llvm::ilist_node_impl::getReverseIterator</a></div><div class="ttdeci">reverse_self_iterator getReverseIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00085">ilist_node.h:85</a></div></div>
<div class="ttc" id="astructllvm_1_1MaybeAlign_html_a06846474be3ab85f8d30c388faf3b116"><div class="ttname"><a href="structllvm_1_1MaybeAlign.html#a06846474be3ab85f8d30c388faf3b116">llvm::MaybeAlign::valueOrOne</a></div><div class="ttdeci">Align valueOrOne() const</div><div class="ttdoc">For convenience, returns a valid alignment or 1 if undefined.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00141">Alignment.h:141</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a214ec2f04ffd92636ed4bd2717607a1d"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a214ec2f04ffd92636ed4bd2717607a1d">llvm::sys::path::end</a></div><div class="ttdeci">const_iterator end(StringRef path)</div><div class="ttdoc">Get end iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00235">Path.cpp:235</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sys_1_1path_html_a00a76a729b319dc47beffbe07325565f"><div class="ttname"><a href="namespacellvm_1_1sys_1_1path.html#a00a76a729b319dc47beffbe07325565f">llvm::sys::path::begin</a></div><div class="ttdeci">const_iterator begin(StringRef path, Style style=Style::native)</div><div class="ttdoc">Get begin iterator over path.</div><div class="ttdef"><b>Definition:</b> <a href="Path_8cpp_source.html#l00226">Path.cpp:226</a></div></div>
<div class="ttc" id="anamespacellvm_html_acab8f775ddc87695d750e4838231b3ba"><div class="ttname"><a href="namespacellvm.html#acab8f775ddc87695d750e4838231b3ba">llvm::isBytewiseValue</a></div><div class="ttdeci">Value * isBytewiseValue(Value *V, const DataLayout &amp;DL)</div><div class="ttdoc">If the specified value can be set by repeating the same byte in memory, return the i8 value that it i...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04001">ValueTracking.cpp:4001</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemCpyOptPass_html_ad966ed260d2a1a972cdecff925a14dde"><div class="ttname"><a href="classllvm_1_1MemCpyOptPass.html#ad966ed260d2a1a972cdecff925a14dde">llvm::MemCpyOptPass::runImpl</a></div><div class="ttdeci">bool runImpl(Function &amp;F, TargetLibraryInfo *TLI, AAResults *AA, AssumptionCache *AC, DominatorTree *DT, MemorySSA *MSSA)</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l01710">MemCpyOptimizer.cpp:1710</a></div></div>
<div class="ttc" id="anamespacellvm_html_a854abfc88bcd24e3878e2c9ab1f70fd3"><div class="ttname"><a href="namespacellvm.html#a854abfc88bcd24e3878e2c9ab1f70fd3">llvm::isModOrRefSet</a></div><div class="ttdeci">bool isModOrRefSet(const ModRefInfo MRI)</div><div class="ttdef"><b>Definition:</b> <a href="ModRef_8h_source.html#l00042">ModRef.h:42</a></div></div>
<div class="ttc" id="anamespacellvm_html_a493e8685b388eb24064e2eb6c90e88d6"><div class="ttname"><a href="namespacellvm.html#a493e8685b388eb24064e2eb6c90e88d6">llvm::createMemCpyOptPass</a></div><div class="ttdeci">FunctionPass * createMemCpyOptPass()</div><div class="ttdoc">The public interface to this file...</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00293">MemCpyOptimizer.cpp:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a610f151afe638890b21bea434a26821d"><div class="ttname"><a href="classllvm_1_1CallBase.html#a610f151afe638890b21bea434a26821d">llvm::CallBase::isByValArgument</a></div><div class="ttdeci">bool isByValArgument(unsigned ArgNo) const</div><div class="ttdoc">Determine whether this argument is passed by value.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01688">InstrTypes.h:1688</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_aec6eaa1e49f48c178e0ab9c030b5971e"><div class="ttname"><a href="classllvm_1_1Instruction.html#aec6eaa1e49f48c178e0ab9c030b5971e">llvm::Instruction::copyMetadata</a></div><div class="ttdeci">void copyMetadata(const Instruction &amp;SrcInst, ArrayRef&lt; unsigned &gt; WL=ArrayRef&lt; unsigned &gt;())</div><div class="ttdoc">Copy metadata from SrcInst to this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00882">Instruction.cpp:882</a></div></div>
<div class="ttc" id="aSTLExtras_8h_html"><div class="ttname"><a href="STLExtras_8h.html">STLExtras.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_ad47eefa1d094f60494b6b927061ca001"><div class="ttname"><a href="classllvm_1_1LoadInst.html#ad47eefa1d094f60494b6b927061ca001">llvm::LoadInst::getPointerOperand</a></div><div class="ttdeci">Value * getPointerOperand()</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00264">Instructions.h:264</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_af51c113a039c82f6870df5dc9666b5e3"><div class="ttname"><a href="classllvm_1_1LoadInst.html#af51c113a039c82f6870df5dc9666b5e3">llvm::LoadInst::getAlign</a></div><div class="ttdeci">Align getAlign() const</div><div class="ttdoc">Return the alignment of the access that is being performed.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00220">Instructions.h:220</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="anamespacellvm_html_acd6aa057934751aaac54e5c18bcc18eb"><div class="ttname"><a href="namespacellvm.html#acd6aa057934751aaac54e5c18bcc18eb">llvm::commonAlignment</a></div><div class="ttdeci">Align commonAlignment(Align A, uint64_t Offset)</div><div class="ttdoc">Returns the alignment that satisfies both alignments.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00212">Alignment.h:212</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">llvm::RISCVFenceField::R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00278">RISCVBaseInfo.h:278</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemSetBase_html_a1f2497dcafee1cce332763e4015e23c0"><div class="ttname"><a href="classllvm_1_1MemSetBase.html#a1f2497dcafee1cce332763e4015e23c0">llvm::MemSetBase::getValue</a></div><div class="ttdeci">Value * getValue() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00940">IntrinsicInst.h:940</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="aAliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_html_abe71bc4610a9dc7aa3a6c6e0e28fc14a"><div class="ttname"><a href="namespacellvm.html#abe71bc4610a9dc7aa3a6c6e0e28fc14a">llvm::isIdentifiedFunctionLocal</a></div><div class="ttdeci">bool isIdentifiedFunctionLocal(const Value *V)</div><div class="ttdoc">Return true if V is umabigously identified at the function-level.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00890">AliasAnalysis.cpp:890</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPULibCalls_8cpp_source.html#l00187">AMDGPULibCalls.cpp:187</a></div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac4fc845f5ed92de63cd4474f128f5fc5"><div class="ttname"><a href="namespacellvm.html#ac4fc845f5ed92de63cd4474f128f5fc5">llvm::cast</a></div><div class="ttdeci">decltype(auto) cast(const From &amp;Val)</div><div class="ttdoc">cast&lt;X&gt; - Return the argument parameter cast to the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="Casting_8h_source.html#l00566">Casting.h:566</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAWrapperPass_html"><div class="ttname"><a href="classllvm_1_1MemorySSAWrapperPass.html">llvm::MemorySSAWrapperPass</a></div><div class="ttdoc">Legacy analysis pass which computes MemorySSA.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00986">MemorySSA.h:986</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResults_html"><div class="ttname"><a href="classllvm_1_1AAResults.html">llvm::AAResults</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00294">AliasAnalysis.h:294</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html_ae3b89ffde42778289bcbd8a187199420"><div class="ttname"><a href="classllvm_1_1MemorySSA.html#ae3b89ffde42778289bcbd8a187199420">llvm::MemorySSA::isLiveOnEntryDef</a></div><div class="ttdeci">bool isLiveOnEntryDef(const MemoryAccess *MA) const</div><div class="ttdoc">Return true if MA represents the live on entry value.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00737">MemorySSA.h:737</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_a8c600d31172b5d0d0c7b510b535f03c3"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a8c600d31172b5d0d0c7b510b535f03c3">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(MemCpyOptLegacyPass, &quot;memcpyopt&quot;, &quot;MemCpy Optimization&quot;, false, false) INITIALIZE_PASS_END(MemCpyOptLegacyPass</div></div>
<div class="ttc" id="aIntrinsics_8h_html"><div class="ttname"><a href="Intrinsics_8h.html">Intrinsics.h</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResults_html_a2205e49ace8bb2fd9934342ff6a25e13"><div class="ttname"><a href="classllvm_1_1AAResults.html#a2205e49ace8bb2fd9934342ff6a25e13">llvm::AAResults::getModRefInfo</a></div><div class="ttdeci">ModRefInfo getModRefInfo(const Instruction *I, const std::optional&lt; MemoryLocation &gt; &amp;OptLoc)</div><div class="ttdoc">Check whether or not an instruction may read or write the optionally specified memory location.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00488">AliasAnalysis.h:488</a></div></div>
<div class="ttc" id="anamespacellvm_html_a13d660d6d9741c69a809add210d22e8c"><div class="ttname"><a href="namespacellvm.html#a13d660d6d9741c69a809add210d22e8c">llvm::initializeMemCpyOptLegacyPassPass</a></div><div class="ttdeci">void initializeMemCpyOptLegacyPassPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8cpp_source.html#l07993">SIInstrInfo.cpp:7993</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryLocation_html_a207e239d68b66b0d5ccad5997a5ef027"><div class="ttname"><a href="classllvm_1_1MemoryLocation.html#a207e239d68b66b0d5ccad5997a5ef027">llvm::MemoryLocation::getForSource</a></div><div class="ttdeci">static MemoryLocation getForSource(const MemTransferInst *MTI)</div><div class="ttdoc">Return a location representing the source of a memory transfer.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8cpp_source.html#l00095">MemoryLocation.cpp:95</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_a539fc1724ed6975d722dc414c79adbfd"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#a539fc1724ed6975d722dc414c79adbfd">llvm::MemTransferBase::getRawSource</a></div><div class="ttdeci">Value * getRawSource() const</div><div class="ttdoc">Return the arguments to the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00883">IntrinsicInst.h:883</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html_a2d537a2dd5afbd1eba9a402cda94e067"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html#a2d537a2dd5afbd1eba9a402cda94e067">llvm::MemorySSAUpdater::moveAfter</a></div><div class="ttdeci">void moveAfter(MemoryUseOrDef *What, MemoryUseOrDef *Where)</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8cpp_source.html#l01196">MemorySSAUpdater.cpp:1196</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="aDenseSet_8h_html"><div class="ttname"><a href="DenseSet_8h.html">DenseSet.h</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00141">StackSlotColoring.cpp:141</a></div></div>
<div class="ttc" id="astructllvm_1_1MaybeAlign_html"><div class="ttname"><a href="structllvm_1_1MaybeAlign.html">llvm::MaybeAlign</a></div><div class="ttdoc">This struct is a compact representation of a valid (power of two) or undefined (0) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00117">Alignment.h:117</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeWrapperPass_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeWrapperPass.html">llvm::DominatorTreeWrapperPass</a></div><div class="ttdoc">Legacy analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00314">Dominators.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aMemCpyOptimizer_8h_html"><div class="ttname"><a href="MemCpyOptimizer_8h.html">MemCpyOptimizer.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LocationSize_html_a131715ceeb92fb803a329d6b76d14e0d"><div class="ttname"><a href="classllvm_1_1LocationSize.html#a131715ceeb92fb803a329d6b76d14e0d">llvm::LocationSize::precise</a></div><div class="ttdeci">static LocationSize precise(uint64_t Value)</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8h_source.html#l00102">MemoryLocation.h:102</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ad58305d5392be750e7bfae4d114d4db7"><div class="ttname"><a href="classllvm_1_1CallBase.html#ad58305d5392be750e7bfae4d114d4db7">llvm::CallBase::getParamByValType</a></div><div class="ttdeci">Type * getParamByValType(unsigned ArgNo) const</div><div class="ttdoc">Extract the byval type for a call or parameter.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01761">InstrTypes.h:1761</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3b1c5788b85ffa254be0e834edf5cf8f"><div class="ttname"><a href="namespacellvm.html#a3b1c5788b85ffa254be0e834edf5cf8f">llvm::getUnderlyingObject</a></div><div class="ttdeci">const Value * getUnderlyingObject(const Value *V, unsigned MaxLookup=6)</div><div class="ttdoc">This method strips off any GEP address adjustments and pointer casts from the specified value,...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l04567">ValueTracking.cpp:4567</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a043cdaf7b89aaeeb127be5d93411637f"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a043cdaf7b89aaeeb127be5d93411637f">Align</a></div><div class="ttdeci">uint64_t Align</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00082">ELFObjHandler.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryUseOrDef_html_a1111232011a32357ce2f84d3a633597c"><div class="ttname"><a href="classllvm_1_1MemoryUseOrDef.html#a1111232011a32357ce2f84d3a633597c">llvm::MemoryUseOrDef::getMemoryInst</a></div><div class="ttdeci">Instruction * getMemoryInst() const</div><div class="ttdoc">Get the instruction that this MemoryUse represents.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00259">MemorySSA.h:259</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad81c9e5bd992252c9e82205b52b5e911"><div class="ttname"><a href="namespacellvm.html#ad81c9e5bd992252c9e82205b52b5e911">llvm::isPointerOffset</a></div><div class="ttdeci">std::optional&lt; int64_t &gt; isPointerOffset(const Value *Ptr1, const Value *Ptr2, const DataLayout &amp;DL)</div><div class="ttdoc">If Ptr1 is provably equal to Ptr2 plus a constant offset, return that offset.</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l07498">ValueTracking.cpp:7498</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_aa512958c35cfdd696c21623a964fc2d9"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#aa512958c35cfdd696c21623a964fc2d9">llvm::MemTransferBase::getSourceAlign</a></div><div class="ttdeci">MaybeAlign getSourceAlign() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00909">IntrinsicInst.h:909</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryAccess_html_aa468ad3fa68bdf6703c391deaec97706"><div class="ttname"><a href="classllvm_1_1MemoryAccess.html#aa468ad3fa68bdf6703c391deaec97706">llvm::MemoryAccess::getBlock</a></div><div class="ttdeci">BasicBlock * getBlock() const</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00164">MemorySSA.h:164</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a13e877ef779ba7a0688081079f4f9b03"><div class="ttname"><a href="classllvm_1_1Type.html#a13e877ef779ba7a0688081079f4f9b03">llvm::Type::getIntegerBitWidth</a></div><div class="ttdeci">unsigned getIntegerBitWidth() const</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00097">DerivedTypes.h:97</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_afac5b39bcbb90d660f83d9b4bd8c6d95"><div class="ttname"><a href="classllvm_1_1CallBase.html#afac5b39bcbb90d660f83d9b4bd8c6d95">llvm::CallBase::getCaller</a></div><div class="ttdeci">Function * getCaller()</div><div class="ttdoc">Helper to get the caller (the parent function).</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l00293">Instructions.cpp:293</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemSetInst_html"><div class="ttname"><a href="classllvm_1_1MemSetInst.html">llvm::MemSetInst</a></div><div class="ttdoc">This class wraps the llvm.memset and llvm.memset.inline intrinsics.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01080">IntrinsicInst.h:1080</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00059">PassSupport.h:59</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_a4c36a0753cd006d97b1aee018fe423bc"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a4c36a0753cd006d97b1aee018fe423bc">Optimization</a></div><div class="ttdeci">MemCpy Optimization</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00303">MemCpyOptimizer.cpp:303</a></div></div>
<div class="ttc" id="aRDFGraph_8cpp_html_af153ca0eadca8bc464492b7aba7feb00"><div class="ttname"><a href="RDFGraph_8cpp.html#af153ca0eadca8bc464492b7aba7feb00">G</a></div><div class="ttdeci">const DataFlowGraph &amp; G</div><div class="ttdef"><b>Definition:</b> <a href="RDFGraph_8cpp_source.html#l00200">RDFGraph.cpp:200</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseSet_html"><div class="ttname"><a href="classllvm_1_1DenseSet.html">llvm::DenseSet&lt; Instruction * &gt;</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa1a33f1d911a725a1f81234a908d03edb">llvm::RISCVFenceField::O</a></div><div class="ttdeci">@ O</div><div class="ttdef"><b>Definition:</b> <a href="RISCVBaseInfo_8h_source.html#l00277">RISCVBaseInfo.h:277</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_a684dc4713d6cd9e5383eda83ec3e620f"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#a684dc4713d6cd9e5383eda83ec3e620f">mayBeVisibleThroughUnwinding</a></div><div class="ttdeci">MemCpy static false bool mayBeVisibleThroughUnwinding(Value *V, Instruction *Start, Instruction *End)</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00308">MemCpyOptimizer.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_aa10ee7493bddf2c751ca6e05451ef410"><div class="ttname"><a href="ADT_2tmp_8txt.html#aa10ee7493bddf2c751ca6e05451ef410">unsigned</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfoWrapperPass.html">llvm::TargetLibraryInfoWrapperPass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00565">TargetLibraryInfo.h:565</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html">llvm::MemorySSAUpdater</a></div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8h_source.html#l00054">MemorySSAUpdater.h:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a9e1fc23a17e97d2d1732e753ae9251ac"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a9e1fc23a17e97d2d1732e753ae9251ac">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00652">GlobalValue.h:652</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html_a4121a20238504099c3466fa62ec877d5"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html#a4121a20238504099c3466fa62ec877d5">llvm::MemorySSAUpdater::getMemorySSA</a></div><div class="ttdeci">MemorySSA * getMemorySSA() const</div><div class="ttdoc">Get handle on MemorySSA.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8h_source.html#l00242">MemorySSAUpdater.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionAnalysis_html"><div class="ttname"><a href="classllvm_1_1AssumptionAnalysis.html">llvm::AssumptionAnalysis</a></div><div class="ttdoc">A function analysis which provides an AssumptionCache.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00173">AssumptionCache.h:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_ad966bea18aa62ffb9e040509adc7c99f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#ad966bea18aa62ffb9e040509adc7c99f">llvm::PreservedAnalyses::preserve</a></div><div class="ttdeci">void preserve()</div><div class="ttdoc">Mark an analysis as preserved.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00173">PassManager.h:173</a></div></div>
<div class="ttc" id="aSVEIntrinsicOpts_8cpp_html_a2bb87eb1bcbc74783a83ae945eb8fa36"><div class="ttname"><a href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(DominatorTreeWrapperPass)</div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html_a003b4369b4130e669dc9139798e0193c"><div class="ttname"><a href="classllvm_1_1TypeSize.html#a003b4369b4130e669dc9139798e0193c">llvm::TypeSize::getFixed</a></div><div class="ttdeci">static constexpr TypeSize getFixed(ScalarTy ExactSize)</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00322">TypeSize.h:322</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aMemoryLocation_8h_html"><div class="ttname"><a href="MemoryLocation_8h.html">MemoryLocation.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html"><div class="ttname"><a href="classllvm_1_1MemorySSA.html">llvm::MemorySSA</a></div><div class="ttdoc">Encapsulates MemorySSA, including all data associated with memory accesses.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00700">MemorySSA.h:700</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html_a4ece07ee1030856099726901d0eef81b"><div class="ttname"><a href="classllvm_1_1MemorySSA.html#a4ece07ee1030856099726901d0eef81b">llvm::MemorySSA::getMemoryAccess</a></div><div class="ttdeci">MemoryUseOrDef * getMemoryAccess(const Instruction *I) const</div><div class="ttdoc">Given a memory Mod/Ref'ing instruction, get the MemorySSA access associated with it.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00717">MemorySSA.h:717</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemCpyOptPass_html_a07c3f5129a977e2f949212878c3042ae"><div class="ttname"><a href="classllvm_1_1MemCpyOptPass.html#a07c3f5129a977e2f949212878c3042ae">llvm::MemCpyOptPass::run</a></div><div class="ttdeci">PreservedAnalyses run(Function &amp;F, FunctionAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l01693">MemCpyOptimizer.cpp:1693</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryDef_html"><div class="ttname"><a href="classllvm_1_1MemoryDef.html">llvm::MemoryDef</a></div><div class="ttdoc">Represents a read-write access to memory, whether it is a must-alias, or a may-alias.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00372">MemorySSA.h:372</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae8f5bf5cc06f696b52c709677df00fbf"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae8f5bf5cc06f696b52c709677df00fbf">llvm::Instruction::setDebugLoc</a></div><div class="ttdeci">void setDebugLoc(DebugLoc Loc)</div><div class="ttdoc">Set the debug location information for this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00355">Instruction.h:355</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_a33880aaca0ad05e5f1557f079305bde5"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#a33880aaca0ad05e5f1557f079305bde5">llvm::details::FixedOrScalableQuantity::getFixedValue</a></div><div class="ttdeci">constexpr ScalarTy getFixedValue() const</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00182">TypeSize.h:182</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9db8c44b250b90e3ab7e4d144e7c9c2e"><div class="ttname"><a href="namespacellvm.html#a9db8c44b250b90e3ab7e4d144e7c9c2e">llvm::ModRefInfo</a></div><div class="ttdeci">ModRefInfo</div><div class="ttdoc">Flags indicating whether a memory access modifies or references memory.</div><div class="ttdef"><b>Definition:</b> <a href="ModRef_8h_source.html#l00027">ModRef.h:27</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a641b0782e0cc309372855bfc19fdfd97"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a641b0782e0cc309372855bfc19fdfd97">llvm::SmallVectorImpl::const_iterator</a></div><div class="ttdeci">typename SuperClass::const_iterator const_iterator</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00582">SmallVector.h:582</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a2711d3bc7c6c769a8f34c7fc3937169d"><div class="ttname"><a href="classllvm_1_1Instruction.html#a2711d3bc7c6c769a8f34c7fc3937169d">llvm::Instruction::mergeDIAssignID</a></div><div class="ttdeci">void mergeDIAssignID(ArrayRef&lt; const Instruction * &gt; SourceInstructions)</div><div class="ttdoc">Merge the DIAssignID metadata from this instruction and those attached to instructions in SourceInstr...</div><div class="ttdef"><b>Definition:</b> <a href="DebugInfo_8cpp_source.html#l00901">DebugInfo.cpp:901</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_adbff55f335d303816547f35eb6edb948"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#adbff55f335d303816547f35eb6edb948">llvm::MachineBasicBlock::size</a></div><div class="ttdeci">unsigned size() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00279">MachineBasicBlock.h:279</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_ae2bb081d94f22e64ca6bc4bd58512a93"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#ae2bb081d94f22e64ca6bc4bd58512a93">memcpy</a></div><div class="ttdeci">&lt;%struct.s * &gt; cast struct s *S to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *agg result to sbyte *&lt; sbyte * &gt; sbyte uint cast struct s *memtmp to sbyte *&lt; sbyte * &gt; sbyte uint ret void llc ends up issuing two memcpy or custom lower memcpy(of small size) to be ldmia/stmia. I think option 2 is better but the current register allocator cannot allocate a chunk of registers at a time. A feasible temporary solution is to use specific physical registers at the lowering time for small(&lt;</div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a1a70f2c359aadd76a72aaaede16aca4a"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a1a70f2c359aadd76a72aaaede16aca4a">llvm::DominatorTree::isReachableFromEntry</a></div><div class="ttdeci">bool isReachableFromEntry(const Use &amp;U) const</div><div class="ttdoc">Provide an overload for a Use.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00335">Dominators.cpp:335</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="aiterator__range_8h_html"><div class="ttname"><a href="iterator__range_8h.html">iterator_range.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html_a54699e3f128acda6003afc11d3027f6c"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html#a54699e3f128acda6003afc11d3027f6c">llvm::TargetLibraryInfo::has</a></div><div class="ttdeci">bool has(LibFunc F) const</div><div class="ttdoc">Tests whether a library function is available.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00340">TargetLibraryInfo.h:340</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aInlineOrder_8cpp_html_a7ee6f0cb51c3b9056199e9a0001fe8c3ad01fd9b01e9dde8bd3dc247afbfb7218"><div class="ttname"><a href="InlineOrder_8cpp.html#a7ee6f0cb51c3b9056199e9a0001fe8c3ad01fd9b01e9dde8bd3dc247afbfb7218">InlinePriorityMode::ML</a></div><div class="ttdeci">@ ML</div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAAnalysis_html"><div class="ttname"><a href="classllvm_1_1MemorySSAAnalysis.html">llvm::MemorySSAAnalysis</a></div><div class="ttdoc">An analysis that produces MemorySSA for a function.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00936">MemorySSA.h:936</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSA_html_a949151a1ebd664cb397323294cec0e53"><div class="ttname"><a href="classllvm_1_1MemorySSA.html#a949151a1ebd664cb397323294cec0e53">llvm::MemorySSA::getWalker</a></div><div class="ttdeci">MemorySSAWalker * getWalker()</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8cpp_source.html#l01558">MemorySSA.cpp:1558</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html"><div class="ttname"><a href="classllvm_1_1APInt.html">llvm::APInt</a></div><div class="ttdoc">Class for arbitrary precision integers.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00075">APInt.h:75</a></div></div>
<div class="ttc" id="aMetadata_8cpp_html_a538047e21679cd2bf4cfd1e73fe022aa"><div class="ttname"><a href="Metadata_8cpp.html#a538047e21679cd2bf4cfd1e73fe022aa">addRange</a></div><div class="ttdeci">static void addRange(SmallVectorImpl&lt; ConstantInt * &gt; &amp;EndPoints, ConstantInt *Low, ConstantInt *High)</div><div class="ttdef"><b>Definition:</b> <a href="Metadata_8cpp_source.html#l01102">Metadata.cpp:1102</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAWalker_html_a95d0e423957d029a78e5868f539e9cce"><div class="ttname"><a href="classllvm_1_1MemorySSAWalker.html#a95d0e423957d029a78e5868f539e9cce">llvm::MemorySSAWalker::getClobberingMemoryAccess</a></div><div class="ttdeci">MemoryAccess * getClobberingMemoryAccess(const Instruction *I, BatchAAResults &amp;AA)</div><div class="ttdoc">Given a memory Mod/Ref/ModRef'ing instruction, calling this will give you the nearest dominating Memo...</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l01046">MemorySSA.h:1046</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html_acf9a0bb25aae89d274ee9ae7dd0cf9b2"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html#acf9a0bb25aae89d274ee9ae7dd0cf9b2">llvm::MemorySSAUpdater::createMemoryAccessAfter</a></div><div class="ttdeci">MemoryUseOrDef * createMemoryAccessAfter(Instruction *I, MemoryAccess *Definition, MemoryAccess *InsertPt)</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8cpp_source.html#l01447">MemorySSAUpdater.cpp:1447</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_afa96fcb672bc190afac38ab7cc0e42b2"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#afa96fcb672bc190afac38ab7cc0e42b2">llvm::MemIntrinsicBase::getDest</a></div><div class="ttdeci">Value * getDest() const</div><div class="ttdoc">This is just like getRawDest, but it strips off any cast instructions (including addrspacecast) that ...</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00833">IntrinsicInst.h:833</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCacheTracker_html"><div class="ttname"><a href="classllvm_1_1AssumptionCacheTracker.html">llvm::AssumptionCacheTracker</a></div><div class="ttdoc">An immutable pass that tracks lazily created AssumptionCache objects.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00202">AssumptionCache.h:202</a></div></div>
<div class="ttc" id="anamespacellvm_html_a57f2ca0e57f4f7b13f56f9aa16af3e0d"><div class="ttname"><a href="namespacellvm.html#a57f2ca0e57f4f7b13f56f9aa16af3e0d">llvm::min</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; min(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00357">FileCheck.cpp:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html_a21fc5eae685ef3e2dce4403a75d5ff2f"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html#a21fc5eae685ef3e2dce4403a75d5ff2f">llvm::MemorySSAUpdater::insertDef</a></div><div class="ttdeci">void insertDef(MemoryDef *Def, bool RenameUses=false)</div><div class="ttdoc">Insert a definition into the MemorySSA IR.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8cpp_source.html#l00307">MemorySSAUpdater.cpp:307</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a7713a45c8983df00c3975444b94e69ae"><div class="ttname"><a href="classllvm_1_1CallBase.html#a7713a45c8983df00c3975444b94e69ae">llvm::CallBase::getParamAlign</a></div><div class="ttdeci">MaybeAlign getParamAlign(unsigned ArgNo) const</div><div class="ttdoc">Extract the alignment for a call or parameter (0=unknown).</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01752">InstrTypes.h:1752</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a9696bc411b0a7022c2cc78bff5173cefa87ba2ecc8b6915e8bd6f5089918229fd">llvm::logicalview::LVAttributeKind::Range</a></div><div class="ttdeci">@ Range</div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdoc">This function should be called by the pass, iff they do not:</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00265">Pass.cpp:265</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html_aeb534c1a0391ce24551c226a582099a7"><div class="ttname"><a href="classllvm_1_1LoadInst.html#aeb534c1a0391ce24551c226a582099a7">llvm::LoadInst::isSimple</a></div><div class="ttdeci">bool isSimple() const</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00256">Instructions.h:256</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCache_html"><div class="ttname"><a href="classllvm_1_1AssumptionCache.html">llvm::AssumptionCache</a></div><div class="ttdoc">A cache of @llvm.assume calls within a function.</div><div class="ttdef"><b>Definition:</b> <a href="AssumptionCache_8h_source.html#l00042">AssumptionCache.h:42</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">llvm::Offset</a></div><div class="ttdeci">@ Offset</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="anamespacellvm_html_a894b02a1122caccc0ed5eb9b321d22bb"><div class="ttname"><a href="namespacellvm.html#a894b02a1122caccc0ed5eb9b321d22bb">llvm::isNotVisibleOnUnwind</a></div><div class="ttdeci">bool isNotVisibleOnUnwind(const Value *Object, bool &amp;RequiresNoCaptureBeforeUnwind)</div><div class="ttdoc">Return true if Object memory is not visible after an unwind, in the sense that program semantics cann...</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8cpp_source.html#l00916">AliasAnalysis.cpp:916</a></div></div>
<div class="ttc" id="aclassllvm_1_1BatchAAResults_html_adfa0be41805b25d9577d6f15d148a0d7"><div class="ttname"><a href="classllvm_1_1BatchAAResults.html#adfa0be41805b25d9577d6f15d148a0d7">llvm::BatchAAResults::getModRefInfo</a></div><div class="ttdeci">ModRefInfo getModRefInfo(const Instruction *I, const std::optional&lt; MemoryLocation &gt; &amp;OptLoc)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00631">AliasAnalysis.h:631</a></div></div>
<div class="ttc" id="aclassllvm_1_1CFGAnalyses_html"><div class="ttname"><a href="classllvm_1_1CFGAnalyses.html">llvm::CFGAnalyses</a></div><div class="ttdoc">Represents analyses that only rely on functions' control flow.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00113">PassManager.h:113</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_a884f90190bca4bd354f2d5c91c264028"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#a884f90190bca4bd354f2d5c91c264028">llvm::AnalysisUsage::addPreserved</a></div><div class="ttdeci">AnalysisUsage &amp; addPreserved()</div><div class="ttdoc">Add the specified Pass class to the set of analyses preserved by this pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00098">PassAnalysisSupport.h:98</a></div></div>
<div class="ttc" id="anamespacellvm_html_a39d3d23a084c4544ee5903203db10e8a"><div class="ttname"><a href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a></div><div class="ttdeci">void append_range(Container &amp;C, Range &amp;&amp;R)</div><div class="ttdoc">Wrapper function to append a range to a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l02014">STLExtras.h:2014</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryAccess_html"><div class="ttname"><a href="classllvm_1_1MemoryAccess.html">llvm::MemoryAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00142">MemorySSA.h:142</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00308">Value.cpp:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_abc10b887caad109288ffceb230493a85"><div class="ttname"><a href="classllvm_1_1CallBase.html#abc10b887caad109288ffceb230493a85">llvm::CallBase::setArgOperand</a></div><div class="ttdeci">void setArgOperand(unsigned i, Value *v)</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01356">InstrTypes.h:1356</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_aefa39f6b622360ce4e947feb9f671b73"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#aefa39f6b622360ce4e947feb9f671b73">llvm::Intrinsic::getDeclaration</a></div><div class="ttdeci">Function * getDeclaration(Module *M, ID id, ArrayRef&lt; Type * &gt; Tys=std::nullopt)</div><div class="ttdoc">Create or insert an LLVM Function declaration for an intrinsic, and return it.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l01502">Function.cpp:1502</a></div></div>
<div class="ttc" id="aMemCpyOptimizer_8cpp_html_ab06d3147949b764919b5ad90014afdfd"><div class="ttname"><a href="MemCpyOptimizer_8cpp.html#ab06d3147949b764919b5ad90014afdfd">writtenBetween</a></div><div class="ttdeci">static bool writtenBetween(MemorySSA *MSSA, BatchAAResults &amp;AA, MemoryLocation Loc, const MemoryUseOrDef *Start, const MemoryUseOrDef *End)</div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8cpp_source.html#l00361">MemCpyOptimizer.cpp:361</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a966eb231e7d4e572874d2cb49b18faea"><div class="ttname"><a href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">llvm::Value::stripPointerCasts</a></div><div class="ttdeci">const Value * stripPointerCasts() const</div><div class="ttdoc">Strip off pointer casts, all-zero GEPs and address space casts.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00685">Value.cpp:685</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ac09a21c371a9c535cbc13e8f82503aec"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit unsigned integer value after it has been zero extended as appropriate...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00141">Constants.h:141</a></div></div>
<div class="ttc" id="aEntryExitInstrumenter_8cpp_html_a3985f1f39349428d17f0d2b81ebc6349"><div class="ttname"><a href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a></div><div class="ttdeci">static bool runOnFunction(Function &amp;F, bool PostInlining)</div><div class="ttdef"><b>Definition:</b> <a href="EntryExitInstrumenter_8cpp_source.html#l00085">EntryExitInstrumenter.cpp:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html_af58e16a1d7ebc8f202ae2f8037b42df6"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html#af58e16a1d7ebc8f202ae2f8037b42df6">llvm::MemorySSAUpdater::moveBefore</a></div><div class="ttdeci">void moveBefore(MemoryUseOrDef *What, MemoryUseOrDef *Where)</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8cpp_source.html#l01191">MemorySSAUpdater.cpp:1191</a></div></div>
<div class="ttc" id="anamespacellvm_html_a327a399b9f6ef414a29ddeffba934d26"><div class="ttname"><a href="namespacellvm.html#a327a399b9f6ef414a29ddeffba934d26">llvm::partition_point</a></div><div class="ttdeci">auto partition_point(R &amp;&amp;Range, Predicate P)</div><div class="ttdoc">Binary search for the first iterator in a range where a predicate is false.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01961">STLExtras.h:1961</a></div></div>
<div class="ttc" id="aclassllvm_1_1BatchAAResults_html_ab9ba3a606a0299b684755f56b1d2f1c7"><div class="ttname"><a href="classllvm_1_1BatchAAResults.html#ab9ba3a606a0299b684755f56b1d2f1c7">llvm::BatchAAResults::isMustAlias</a></div><div class="ttdeci">bool isMustAlias(const MemoryLocation &amp;LocA, const MemoryLocation &amp;LocB)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00644">AliasAnalysis.h:644</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_aa6574d526b3e38a28f688a7bb4325c2c"><div class="ttname"><a href="classllvm_1_1Constant.html#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a></div><div class="ttdeci">static Constant * getNullValue(Type *Ty)</div><div class="ttdoc">Constructor to create a '0' constant of arbitrary type.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00356">Constants.cpp:356</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryUseOrDef_html_abc4e1b6cc483cfd57ca75c4ab92bd360"><div class="ttname"><a href="classllvm_1_1MemoryUseOrDef.html#abc4e1b6cc483cfd57ca75c4ab92bd360">llvm::MemoryUseOrDef::getDefiningAccess</a></div><div class="ttdeci">MemoryAccess * getDefiningAccess() const</div><div class="ttdoc">Get the access that produces the memory state used by this Use.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00262">MemorySSA.h:262</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_abcb1eb8c51771752c4fee2d539fa25cc"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#abcb1eb8c51771752c4fee2d539fa25cc">llvm::MemIntrinsicBase::getLength</a></div><div class="ttdeci">Value * getLength() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00824">IntrinsicInst.h:824</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_adde2ea00dd2613ee41bfe91908e4e68e"><div class="ttname"><a href="classllvm_1_1CallBase.html#adde2ea00dd2613ee41bfe91908e4e68e">llvm::CallBase::arg_size</a></div><div class="ttdeci">unsigned arg_size() const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01349">InstrTypes.h:1349</a></div></div>
<div class="ttc" id="aGlobalVariable_8h_html"><div class="ttname"><a href="GlobalVariable_8h.html">GlobalVariable.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_abff5a423c1f45e23958dde8ee695c9a9"><div class="ttname"><a href="namespacellvm.html#abff5a423c1f45e23958dde8ee695c9a9">llvm::isGuaranteedToTransferExecutionToSuccessor</a></div><div class="ttdeci">bool isGuaranteedToTransferExecutionToSuccessor(const Instruction *I)</div><div class="ttdoc">Return true if this function can prove that the instruction I will always transfer execution to one o...</div><div class="ttdef"><b>Definition:</b> <a href="ValueTracking_8cpp_source.html#l05612">ValueTracking.cpp:5612</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html"><div class="ttname"><a href="classllvm_1_1TypeSize.html">llvm::TypeSize</a></div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00314">TypeSize.h:314</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aPassManager_8h_html"><div class="ttname"><a href="PassManager_8h.html">PassManager.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdoc">Provides information about what library functions are available for the current target.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00234">TargetLibraryInfo.h:234</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryUseOrDef_html"><div class="ttname"><a href="classllvm_1_1MemoryUseOrDef.html">llvm::MemoryUseOrDef</a></div><div class="ttdoc">Class that has the common methods + fields of memory uses/defs.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8h_source.html#l00252">MemorySSA.h:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemCpyOptPass_html"><div class="ttname"><a href="classllvm_1_1MemCpyOptPass.html">llvm::MemCpyOptPass</a></div><div class="ttdef"><b>Definition:</b> <a href="MemCpyOptimizer_8h_source.html#l00040">MemCpyOptimizer.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeAnalysis_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeAnalysis.html">llvm::DominatorTreeAnalysis</a></div><div class="ttdoc">Analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00279">Dominators.h:279</a></div></div>
<div class="ttc" id="aMemorySSA_8h_html"><div class="ttname"><a href="MemorySSA_8h.html">MemorySSA.h</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemCpyInst_html"><div class="ttname"><a href="classllvm_1_1MemCpyInst.html">llvm::MemCpyInst</a></div><div class="ttdoc">This class wraps the llvm.memcpy intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01132">IntrinsicInst.h:1132</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a937c42f77e161349ce0f999e448c7027"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a937c42f77e161349ce0f999e448c7027">llvm::PreservedAnalyses::preserveSet</a></div><div class="ttdeci">void preserveSet()</div><div class="ttdoc">Mark an analysis set as preserved.</div><div class="ttdef"><b>Definition:</b> <a href="PassManager_8h_source.html#l00188">PassManager.h:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsic_html_ada78af22b202d8b7d9fe772c2c9476ce"><div class="ttname"><a href="classllvm_1_1MemIntrinsic.html#ada78af22b202d8b7d9fe772c2c9476ce">llvm::MemIntrinsic::isVolatile</a></div><div class="ttdeci">bool isVolatile() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l01057">IntrinsicInst.h:1057</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4f3bf98b5054831b608852e33427814"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4f3bf98b5054831b608852e33427814">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00358">Instruction.h:358</a></div></div>
<div class="ttc" id="aUser_8h_html"><div class="ttname"><a href="User_8h.html">User.h</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_ac5b936169badf0b703567eb960278648"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#ac5b936169badf0b703567eb960278648">llvm::SmallVectorImpl::iterator</a></div><div class="ttdeci">typename SuperClass::iterator iterator</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00581">SmallVector.h:581</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01351">InstrTypes.h:1351</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResultsWrapperPass_html"><div class="ttname"><a href="classllvm_1_1AAResultsWrapperPass.html">llvm::AAResultsWrapperPass</a></div><div class="ttdoc">A wrapper pass to provide the legacy pass manager access to a suitably prepared AAResults object.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00933">AliasAnalysis.h:933</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00090">Instruction.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalsAAWrapperPass_html"><div class="ttname"><a href="classllvm_1_1GlobalsAAWrapperPass.html">llvm::GlobalsAAWrapperPass</a></div><div class="ttdoc">Legacy wrapper pass to provide the GlobalsAAResult object.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalsModRef_8h_source.html#l00142">GlobalsModRef.h:142</a></div></div>
<div class="ttc" id="aclassllvm_1_1BatchAAResults_html_afa44555b5242035c9df7941911186c44"><div class="ttname"><a href="classllvm_1_1BatchAAResults.html#afa44555b5242035c9df7941911186c44">llvm::BatchAAResults::callCapturesBefore</a></div><div class="ttdeci">ModRefInfo callCapturesBefore(const Instruction *I, const MemoryLocation &amp;MemLoc, DominatorTree *DT)</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00652">AliasAnalysis.h:652</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemIntrinsicBase_html_a97b21472e892da8be5c2f22d6ec21300"><div class="ttname"><a href="classllvm_1_1MemIntrinsicBase.html#a97b21472e892da8be5c2f22d6ec21300">llvm::MemIntrinsicBase::getRawDest</a></div><div class="ttdeci">Value * getRawDest() const</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00818">IntrinsicInst.h:818</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a8d4dd8d1ec9d9328d03bb2b99aa74744a92711ef5b0215a076fef4a3abbfc2258">llvm::logicalview::LVWarningKind::Ranges</a></div><div class="ttdeci">@ Ranges</div></div>
<div class="ttc" id="anamespacellvm_html_a6b0ac1fa4f05de76413c5e0ca6334035"><div class="ttname"><a href="namespacellvm.html#a6b0ac1fa4f05de76413c5e0ca6334035">llvm::reverse</a></div><div class="ttdeci">auto reverse(ContainerTy &amp;&amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00484">STLExtras.h:484</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a6d883605206368bc536cc9ded97209b8"><div class="ttname"><a href="classllvm_1_1Module.html#a6d883605206368bc536cc9ded97209b8">llvm::Module::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Get the data layout for the module's target platform.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8cpp_source.html#l00398">Module.cpp:398</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSimplify_8h_source.html#l00042">InstructionSimplify.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00308">Pass.h:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aHexagonCommonGEP_8cpp_html_ad532e8710e50302e0a376b61c91fa91d"><div class="ttname"><a href="HexagonCommonGEP_8cpp.html#ad532e8710e50302e0a376b61c91fa91d">GEP</a></div><div class="ttdeci">Hexagon Common GEP</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCommonGEP_8cpp_source.html#l00171">HexagonCommonGEP.cpp:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1CastInst_html_acd347d07162a5a80dac61e5bdea9616c"><div class="ttname"><a href="classllvm_1_1CastInst.html#acd347d07162a5a80dac61e5bdea9616c">llvm::CastInst::CreatePointerCast</a></div><div class="ttdeci">static CastInst * CreatePointerCast(Value *S, Type *Ty, const Twine &amp;Name, BasicBlock *InsertAtEnd)</div><div class="ttdoc">Create a BitCast AddrSpaceCast, or a PtrToInt cast instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8cpp_source.html#l03446">Instructions.cpp:3446</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryLocation_html_ac8f8983c6b76d0e30f22fff86b281f16"><div class="ttname"><a href="classllvm_1_1MemoryLocation.html#ac8f8983c6b76d0e30f22fff86b281f16">llvm::MemoryLocation::getForDest</a></div><div class="ttdeci">static MemoryLocation getForDest(const MemIntrinsic *MI)</div><div class="ttdoc">Return a location representing the destination of a memory set or transfer.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8cpp_source.html#l00108">MemoryLocation.cpp:108</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa29fe161c408879ada30c90ebbf55dcf"><div class="ttname"><a href="namespacellvm.html#aa29fe161c408879ada30c90ebbf55dcf">llvm::VerifyMemorySSA</a></div><div class="ttdeci">bool VerifyMemorySSA</div><div class="ttdoc">Enables verification of MemorySSA.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSA_8cpp_source.html#l00089">MemorySSA.cpp:89</a></div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00394">AMDGPUMetadata.h:394</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00411">CommandLine.h:411</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3693cec8e936224ad3e5748debe73b75"><div class="ttname"><a href="namespacellvm.html#a3693cec8e936224ad3e5748debe73b75">llvm::PointerMayBeCapturedBefore</a></div><div class="ttdeci">bool PointerMayBeCapturedBefore(const Value *V, bool ReturnCaptures, bool StoreCaptures, const Instruction *I, const DominatorTree *DT, bool IncludeI=false, unsigned MaxUsesToExplore=0, const LoopInfo *LI=nullptr)</div><div class="ttdoc">PointerMayBeCapturedBefore - Return true if this pointer value may be captured by the enclosing funct...</div><div class="ttdef"><b>Definition:</b> <a href="CaptureTracking_8cpp_source.html#l00254">CaptureTracking.cpp:254</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryAnalysis_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryAnalysis.html">llvm::TargetLibraryAnalysis</a></div><div class="ttdoc">Analysis pass providing the TargetLibraryInfo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00540">TargetLibraryInfo.h:540</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ab4e0512c7e1c7adaa56677e3155685f1"><div class="ttname"><a href="classllvm_1_1Value.html#ab4e0512c7e1c7adaa56677e3155685f1">llvm::Value::users</a></div><div class="ttdeci">iterator_range&lt; user_iterator &gt; users()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00421">Value.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1details_1_1FixedOrScalableQuantity_html_afb486f9022a26e1cc53ff189710dbde5"><div class="ttname"><a href="classllvm_1_1details_1_1FixedOrScalableQuantity.html#afb486f9022a26e1cc53ff189710dbde5">llvm::details::FixedOrScalableQuantity&lt; TypeSize, uint64_t &gt;::isKnownGE</a></div><div class="ttdeci">static constexpr bool isKnownGE(const FixedOrScalableQuantity &amp;LHS, const FixedOrScalableQuantity &amp;RHS)</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00219">TypeSize.h:219</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemoryLocation_html"><div class="ttname"><a href="classllvm_1_1MemoryLocation.html">llvm::MemoryLocation</a></div><div class="ttdoc">Representation for a specific memory location.</div><div class="ttdef"><b>Definition:</b> <a href="MemoryLocation_8h_source.html#l00211">MemoryLocation.h:211</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemorySSAUpdater_html_abcf78af37d56a9b72a49c65428210758"><div class="ttname"><a href="classllvm_1_1MemorySSAUpdater.html#abcf78af37d56a9b72a49c65428210758">llvm::MemorySSAUpdater::removeMemoryAccess</a></div><div class="ttdeci">void removeMemoryAccess(MemoryAccess *, bool OptimizePhis=false)</div><div class="ttdoc">Remove a MemoryAccess from MemorySSA, including updating all definitions and uses.</div><div class="ttdef"><b>Definition:</b> <a href="MemorySSAUpdater_8cpp_source.html#l01305">MemorySSAUpdater.cpp:1305</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_af67d1f3a518964d80a109bb3d9d5cf1e"><div class="ttname"><a href="classllvm_1_1Instruction.html#af67d1f3a518964d80a109bb3d9d5cf1e">llvm::Instruction::moveBefore</a></div><div class="ttdeci">void moveBefore(Instruction *MovePos)</div><div class="ttdoc">Unlink this instruction from its current basic block and insert it into the basic block that MovePos ...</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00108">Instruction.cpp:108</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2da012cb3e5534bbee33563d309bc354"><div class="ttname"><a href="namespacellvm.html#a2da012cb3e5534bbee33563d309bc354">llvm::isDereferenceableAndAlignedPointer</a></div><div class="ttdeci">bool isDereferenceableAndAlignedPointer(const Value *V, Type *Ty, Align Alignment, const DataLayout &amp;DL, const Instruction *CtxI=nullptr, AssumptionCache *AC=nullptr, const DominatorTree *DT=nullptr, const TargetLibraryInfo *TLI=nullptr)</div><div class="ttdoc">Returns true if V is always a dereferenceable pointer with alignment greater or equal than requested.</div><div class="ttdef"><b>Definition:</b> <a href="Loads_8cpp_source.html#l00201">Loads.cpp:201</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1MemTransferBase_html_a308bc73da13a316c472338f9be5562e8"><div class="ttname"><a href="classllvm_1_1MemTransferBase.html#a308bc73da13a316c472338f9be5562e8">llvm::MemTransferBase::getSource</a></div><div class="ttdeci">Value * getSource() const</div><div class="ttdoc">This is just like getRawSource, but it strips off any cast instructions that feed it,...</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00894">IntrinsicInst.h:894</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:34:31 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
