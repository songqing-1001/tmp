<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Target/DirectX/CBufferDataLayout.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_794e483eb1cc7921d35fd149d9cc325b.html">Target</a></li><li class="navelem"><a class="el" href="dir_2c957dfb38624d46c4493f76ab744bd5.html">DirectX</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CBufferDataLayout.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CBufferDataLayout_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- Target/DirectX/CBufferDataLayout.cpp - Cbuffer layout helper -------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Utils to help cbuffer layout.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CBufferDataLayout_8h.html">CBufferDataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">namespace </span>dxil {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// Implement cbuffer layout in</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// https://learn.microsoft.com/en-us/windows/win32/direct3dhlsl/dx-graphics-hlsl-packing-rules</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html">   23</a></span>&#160;<span class="keyword">class </span><a class="code" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html">LegacyCBufferLayout</a> {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keyword">struct </span>LegacyStructLayout {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="classllvm_1_1StructType.html">StructType</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;uint32_t&gt;</a> <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> Size = {0, <span class="keyword">false</span>};</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    std::pair&lt;uint32_t, uint32_t&gt; getElementLegacyOffset(<span class="keywordtype">unsigned</span> Idx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Idx &lt; <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>.size() &amp;&amp; <span class="stringliteral">&quot;Invalid element idx!&quot;</span>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <a class="code" href="classuint32__t.html">uint32_t</a> Offset = <a class="code" href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">Offsets</a>[Idx];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <a class="code" href="classuint32__t.html">uint32_t</a> Ch = Offset &amp; (RowAlign - 1);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">return</span> std::make_pair((Offset - Ch) / RowAlign, Ch);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  };</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html#a96037bf49ee9344e0d27b53fe66a0e05">   37</a></span>&#160;  <a class="code" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html#a96037bf49ee9344e0d27b53fe66a0e05">LegacyCBufferLayout</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;DL) : <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) {}</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> <a class="code" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html#aaa5faa14b659073c9463095ff89c3344">getTypeAllocSizeInBytes</a>(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> applyRowAlign(<a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> Offset, <a class="code" href="classllvm_1_1Type.html">Type</a> *EltTy);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> getTypeAllocSize(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  LegacyStructLayout &amp;getStructLayout(<a class="code" href="classllvm_1_1StructType.html">StructType</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;DL;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classllvm_1_1SmallDenseMap.html">SmallDenseMap&lt;StructType *, LegacyStructLayout&gt;</a> StructLayouts;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// 4 Dwords align.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classuint32__t.html">uint32_t</a> RowAlign = 16;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">static</span> <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> alignTo4Dwords(<a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> Offset) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(Offset, RowAlign);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;};</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html#aaa5faa14b659073c9463095ff89c3344">   53</a></span>&#160;<a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> <a class="code" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html#aaa5faa14b659073c9463095ff89c3344">LegacyCBufferLayout::getTypeAllocSizeInBytes</a>(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">return</span> getTypeAllocSize(Ty);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> LegacyCBufferLayout::applyRowAlign(<a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> Offset, <a class="code" href="classllvm_1_1Type.html">Type</a> *EltTy) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> AlignedOffset = alignTo4Dwords(Offset);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">if</span> (AlignedOffset == Offset)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> Offset;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span> (isa&lt;StructType&gt;(EltTy) || isa&lt;ArrayType&gt;(EltTy))</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">return</span> AlignedOffset;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> Size = DL.<a class="code" href="classllvm_1_1DataLayout.html#acfcd22eb38dbfe1acbf138754297437a">getTypeStoreSize</a>(EltTy);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> ((Offset + Size) &gt; AlignedOffset)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> AlignedOffset;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> Offset;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<a class="code" href="classllvm_1_1TypeSize.html">TypeSize</a> LegacyCBufferLayout::getTypeAllocSize(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> = dyn_cast&lt;StructType&gt;(Ty)) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    LegacyStructLayout &amp;Layout = getStructLayout(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> Layout.Size;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *AT = dyn_cast&lt;ArrayType&gt;(Ty)) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">unsigned</span> NumElts = AT-&gt;getNumElements();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (NumElts == 0)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1TypeSize.html#a003b4369b4130e669dc9139798e0193c">TypeSize::getFixed</a>(0);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    TypeSize EltSize = getTypeAllocSize(AT-&gt;getElementType());</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    TypeSize AlignedEltSize = alignTo4Dwords(EltSize);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// Each new element start 4 dwords aligned.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1TypeSize.html#a003b4369b4130e669dc9139798e0193c">TypeSize::getFixed</a>(AlignedEltSize * (NumElts - 1) + EltSize);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// NOTE: Use type store size, not align to ABI on basic types for legacy</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// layout.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">return</span> DL.<a class="code" href="classllvm_1_1DataLayout.html#acfcd22eb38dbfe1acbf138754297437a">getTypeStoreSize</a>(Ty);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;LegacyCBufferLayout::LegacyStructLayout &amp;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;LegacyCBufferLayout::getStructLayout(StructType *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">auto</span> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> = StructLayouts.find(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a> != StructLayouts.end())</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a>-&gt;second;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  TypeSize <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = <a class="code" href="classllvm_1_1TypeSize.html#a06e32f822cc82701a5652331bccab467">TypeSize::Fixed</a>(0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  LegacyStructLayout Layout;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  Layout.ST = <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">for</span> (Type *EltTy : <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>-&gt;elements()) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    TypeSize EltSize = getTypeAllocSize(EltTy);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (TypeSize ScalarSize = EltTy-&gt;<a class="code" href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">getScalarType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">getPrimitiveSizeInBits</a>())</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(Offset, ScalarSize &gt;&gt; 3);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = applyRowAlign(Offset, EltTy);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    Layout.Offsets.emplace_back(Offset);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a> = <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>.getWithIncrement(EltSize);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  Layout.Size = <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">Offset</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  StructLayouts[<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>] = Layout;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">return</span> StructLayouts[<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classllvm_1_1dxil_1_1CBufferDataLayout.html#a8da2c3a35618dd52be35c04e2042466a">  114</a></span>&#160;<a class="code" href="classllvm_1_1dxil_1_1CBufferDataLayout.html#a8da2c3a35618dd52be35c04e2042466a">CBufferDataLayout::CBufferDataLayout</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <span class="keyword">const</span> <span class="keywordtype">bool</span> IsLegacy)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    : <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>), IsLegacyLayout(IsLegacy),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      LegacyDL(IsLegacy ? <a class="code" href="namespacestd.html">std</a>::make_unique&lt;<a class="code" href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html">LegacyCBufferLayout</a>&gt;(<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>) : nullptr) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<a class="code" href="classllvm_1_1dxil_1_1CBufferDataLayout.html#ad93169925ec1ac57fc5068e79b2ec20b">CBufferDataLayout::~CBufferDataLayout</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classllvm_1_1dxil_1_1CBufferDataLayout.html#afa68be0a8a0346097f8af70b5e8cf34f">  121</a></span>&#160;<a class="code" href="classllvm_1_1TypeSize.html">llvm::TypeSize</a> <a class="code" href="classllvm_1_1dxil_1_1CBufferDataLayout.html#afa68be0a8a0346097f8af70b5e8cf34f">CBufferDataLayout::getTypeAllocSizeInBytes</a>(<a class="code" href="classllvm_1_1Type.html">Type</a> *Ty) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (IsLegacyLayout)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span> LegacyDL-&gt;getTypeAllocSizeInBytes(Ty);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> DL.<a class="code" href="classllvm_1_1DataLayout.html#aa48b3b7e554b44f4e513d5dd8d9f9343">getTypeAllocSize</a>(Ty);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;} <span class="comment">// namespace dxil</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;} <span class="comment">// namespace llvm</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_html_ab102f0f12dd38aeea5906b1d80c792ff"><div class="ttname"><a href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">llvm::alignTo</a></div><div class="ttdeci">uint64_t alignTo(uint64_t Size, Align A)</div><div class="ttdoc">Returns a multiple of A needed to store Size bytes.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00155">Alignment.h:155</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_abb4ce3bc3096a12d4b93460bf78bcf95"><div class="ttname"><a href="README-SSE_8txt.html#abb4ce3bc3096a12d4b93460bf78bcf95">it</a></div><div class="ttdeci">into xmm2 addss xmm2 xmm1 xmm3 addss xmm3 movaps xmm0 unpcklps xmm0 ret seems silly when it could just be one addps Expand libm rounding functions main should enable SSE DAZ mode and other fast SSE modes Think about doing i64 math in SSE regs on x86 This testcase should have no SSE instructions in it</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00081">README-SSE.txt:81</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00110">DataLayout.h:110</a></div></div>
<div class="ttc" id="aclassllvm_1_1dxil_1_1LegacyCBufferLayout_html_aaa5faa14b659073c9463095ff89c3344"><div class="ttname"><a href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html#aaa5faa14b659073c9463095ff89c3344">llvm::dxil::LegacyCBufferLayout::getTypeAllocSizeInBytes</a></div><div class="ttdeci">TypeSize getTypeAllocSizeInBytes(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="CBufferDataLayout_8cpp_source.html#l00053">CBufferDataLayout.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a4abb39a66573f61fda80469faa5d861d"><div class="ttname"><a href="classllvm_1_1Type.html#a4abb39a66573f61fda80469faa5d861d">llvm::Type::getScalarType</a></div><div class="ttdeci">Type * getScalarType() const</div><div class="ttdoc">If this is a vector type, return the element type, otherwise return 'this'.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00341">Type.h:341</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt; uint32_t &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_acfcd22eb38dbfe1acbf138754297437a"><div class="ttname"><a href="classllvm_1_1DataLayout.html#acfcd22eb38dbfe1acbf138754297437a">llvm::DataLayout::getTypeStoreSize</a></div><div class="ttdeci">TypeSize getTypeStoreSize(Type *Ty) const</div><div class="ttdoc">Returns the maximum number of bytes that may be overwritten by storing the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00468">DataLayout.h:468</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallDenseMap_html"><div class="ttname"><a href="classllvm_1_1SmallDenseMap.html">llvm::SmallDenseMap</a></div><div class="ttdef"><b>Definition:</b> <a href="DenseMap_8h_source.html#l00880">DenseMap.h:880</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html_a06e32f822cc82701a5652331bccab467"><div class="ttname"><a href="classllvm_1_1TypeSize.html#a06e32f822cc82701a5652331bccab467">llvm::TypeSize::Fixed</a></div><div class="ttdeci">static constexpr TypeSize Fixed(ScalarTy ExactSize)</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00331">TypeSize.h:331</a></div></div>
<div class="ttc" id="aCBufferDataLayout_8h_html"><div class="ttname"><a href="CBufferDataLayout_8h.html">CBufferDataLayout.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6110fc30bc7311a6cf99814530362e21"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6110fc30bc7311a6cf99814530362e21">llvm::AMDGPU::Hwreg::Offset</a></div><div class="ttdeci">Offset</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00432">SIDefines.h:432</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__MB_html_ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2"><div class="ttname"><a href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">llvm::ARM_MB::ST</a></div><div class="ttdeci">@ ST</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00073">ARMBaseInfo.h:73</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html_a003b4369b4130e669dc9139798e0193c"><div class="ttname"><a href="classllvm_1_1TypeSize.html#a003b4369b4130e669dc9139798e0193c">llvm::TypeSize::getFixed</a></div><div class="ttdeci">static constexpr TypeSize getFixed(ScalarTy ExactSize)</div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00322">TypeSize.h:322</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1StructType_html"><div class="ttname"><a href="classllvm_1_1StructType.html">llvm::StructType</a></div><div class="ttdoc">Class to represent struct types.</div><div class="ttdef"><b>Definition:</b> <a href="DerivedTypes_8h_source.html#l00213">DerivedTypes.h:213</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1dxil_1_1CBufferDataLayout_html_afa68be0a8a0346097f8af70b5e8cf34f"><div class="ttname"><a href="classllvm_1_1dxil_1_1CBufferDataLayout.html#afa68be0a8a0346097f8af70b5e8cf34f">llvm::dxil::CBufferDataLayout::getTypeAllocSizeInBytes</a></div><div class="ttdeci">llvm::TypeSize getTypeAllocSizeInBytes(Type *Ty)</div><div class="ttdef"><b>Definition:</b> <a href="CBufferDataLayout_8cpp_source.html#l00121">CBufferDataLayout.cpp:121</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00851">BitVector.h:851</a></div></div>
<div class="ttc" id="aclassllvm_1_1TypeSize_html"><div class="ttname"><a href="classllvm_1_1TypeSize.html">llvm::TypeSize</a></div><div class="ttdef"><b>Definition:</b> <a href="TypeSize_8h_source.html#l00314">TypeSize.h:314</a></div></div>
<div class="ttc" id="aclassllvm_1_1dxil_1_1CBufferDataLayout_html_ad93169925ec1ac57fc5068e79b2ec20b"><div class="ttname"><a href="classllvm_1_1dxil_1_1CBufferDataLayout.html#ad93169925ec1ac57fc5068e79b2ec20b">llvm::dxil::CBufferDataLayout::~CBufferDataLayout</a></div><div class="ttdeci">~CBufferDataLayout()</div></div>
<div class="ttc" id="aclassllvm_1_1dxil_1_1CBufferDataLayout_html_a8da2c3a35618dd52be35c04e2042466a"><div class="ttname"><a href="classllvm_1_1dxil_1_1CBufferDataLayout.html#a8da2c3a35618dd52be35c04e2042466a">llvm::dxil::CBufferDataLayout::CBufferDataLayout</a></div><div class="ttdeci">CBufferDataLayout(const DataLayout &amp;DL, const bool IsLegacy)</div><div class="ttdef"><b>Definition:</b> <a href="CBufferDataLayout_8cpp_source.html#l00114">CBufferDataLayout.cpp:114</a></div></div>
<div class="ttc" id="aclassllvm_1_1dxil_1_1LegacyCBufferLayout_html"><div class="ttname"><a href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html">llvm::dxil::LegacyCBufferLayout</a></div><div class="ttdef"><b>Definition:</b> <a href="CBufferDataLayout_8cpp_source.html#l00023">CBufferDataLayout.cpp:23</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SI_1_1KernelInputOffsets_html_a58b4eae4b0a45d478c7c0f3959b04612"><div class="ttname"><a href="namespacellvm_1_1SI_1_1KernelInputOffsets.html#a58b4eae4b0a45d478c7c0f3959b04612">llvm::SI::KernelInputOffsets::Offsets</a></div><div class="ttdeci">Offsets</div><div class="ttdoc">Offsets in bytes from the start of the input buffer.</div><div class="ttdef"><b>Definition:</b> <a href="SIInstrInfo_8h_source.html#l01335">SIInstrInfo.h:1335</a></div></div>
<div class="ttc" id="aclassllvm_1_1dxil_1_1LegacyCBufferLayout_html_a96037bf49ee9344e0d27b53fe66a0e05"><div class="ttname"><a href="classllvm_1_1dxil_1_1LegacyCBufferLayout.html#a96037bf49ee9344e0d27b53fe66a0e05">llvm::dxil::LegacyCBufferLayout::LegacyCBufferLayout</a></div><div class="ttdeci">LegacyCBufferLayout(const DataLayout &amp;DL)</div><div class="ttdef"><b>Definition:</b> <a href="CBufferDataLayout_8cpp_source.html#l00037">CBufferDataLayout.cpp:37</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a833daf718a49c5cd637d8c9ddeaebe07"><div class="ttname"><a href="classllvm_1_1Type.html#a833daf718a49c5cd637d8c9ddeaebe07">llvm::Type::getPrimitiveSizeInBits</a></div><div class="ttdeci">TypeSize getPrimitiveSizeInBits() const LLVM_READONLY</div><div class="ttdoc">Return the basic size of this type if it is a primitive type.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00163">Type.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_aa48b3b7e554b44f4e513d5dd8d9f9343"><div class="ttname"><a href="classllvm_1_1DataLayout.html#aa48b3b7e554b44f4e513d5dd8d9f9343">llvm::DataLayout::getTypeAllocSize</a></div><div class="ttdeci">TypeSize getTypeAllocSize(Type *Ty) const</div><div class="ttdoc">Returns the offset in bytes between successive objects of the specified type, including alignment pad...</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00500">DataLayout.h:500</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:11:38 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
