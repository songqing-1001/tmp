<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Target/AArch64/GISel/AArch64InstructionSelector.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_794e483eb1cc7921d35fd149d9cc325b.html">Target</a></li><li class="navelem"><a class="el" href="dir_b69b85499a0be7bec9dbd65569a12909.html">AArch64</a></li><li class="navelem"><a class="el" href="dir_93f1e631d3c6f8dc58629a6a479cd539.html">GISel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AArch64InstructionSelector.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AArch64InstructionSelector_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- AArch64InstructionSelector.cpp ----------------------------*- C++ -*-==//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span><span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/// \file</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// This file implements the targeting of the InstructionSelector class for</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// AArch64.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/// \todo This should be generated by TableGen.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64GlobalISelUtils_8h.html">AArch64GlobalISelUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64InstrInfo_8h.html">AArch64InstrInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64MachineFunctionInfo_8h.html">AArch64MachineFunctionInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64RegisterBankInfo_8h.html">AArch64RegisterBankInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64RegisterInfo_8h.html">AArch64RegisterInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64Subtarget_8h.html">AArch64Subtarget.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64TargetMachine_8h.html">AArch64TargetMachine.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64AddressingModes_8h.html">MCTargetDesc/AArch64AddressingModes.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64MCTargetDesc_8h.html">MCTargetDesc/AArch64MCTargetDesc.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dwarf_8h.html">llvm/BinaryFormat/Dwarf.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GenericMachineInstrs_8h.html">llvm/CodeGen/GlobalISel/GenericMachineInstrs.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstructionSelector_8h.html">llvm/CodeGen/GlobalISel/InstructionSelector.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InstructionSelectorImpl_8h.html">llvm/CodeGen/GlobalISel/InstructionSelectorImpl.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MIPatternMatch_8h.html">llvm/CodeGen/GlobalISel/MIPatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineIRBuilder_8h.html">llvm/CodeGen/GlobalISel/MachineIRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeGen_2GlobalISel_2Utils_8h.html">llvm/CodeGen/GlobalISel/Utils.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineBasicBlock_8h.html">llvm/CodeGen/MachineBasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineConstantPool_8h.html">llvm/CodeGen/MachineConstantPool.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFrameInfo_8h.html">llvm/CodeGen/MachineFrameInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunction_8h.html">llvm/CodeGen/MachineFunction.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstr_8h.html">llvm/CodeGen/MachineInstr.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstrBuilder_8h.html">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineMemOperand_8h.html">llvm/CodeGen/MachineMemOperand.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineOperand_8h.html">llvm/CodeGen/MachineOperand.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineRegisterInfo_8h.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetOpcodes_8h.html">llvm/CodeGen/TargetOpcodes.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;llvm/IR/IntrinsicsAArch64.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   51</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;aarch64-isel&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">using namespace </span>MIPatternMatch;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">using namespace </span>AArch64GISelUtils;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">class </span><a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">class </span><a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a9aa5a7608a0e489065b260a1ec245b82">   64</a></span>&#160;<span class="preprocessor">#define GET_GLOBALISEL_PREDICATE_BITSET</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;AArch64GenGlobalISel.inc&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#undef GET_GLOBALISEL_PREDICATE_BITSET</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">class </span>AArch64InstructionSelector : <span class="keyword">public</span> <a class="code" href="classllvm_1_1InstructionSelector.html">InstructionSelector</a> {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  AArch64InstructionSelector(<span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64TargetMachine.html">AArch64TargetMachine</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a> &amp;STI,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64RegisterBankInfo.html">AArch64RegisterBankInfo</a> &amp;RBI);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="README-SSE_8txt.html#a9fb6cbbc77fb02ab3a51b0660bd09909">select</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ProvenanceAnalysisEvaluator_8cpp.html#a2ee79648e8bce3ddbb26358ff10e3e82">getName</a>() { <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>; }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">void</span> setupMF(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1GISelKnownBits.html">GISelKnownBits</a> *KB,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;               <a class="code" href="classllvm_1_1CodeGenCoverage.html">CodeGenCoverage</a> &amp;CoverageInfo, <a class="code" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;               <a class="code" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classllvm_1_1InstructionSelector.html#a6ed0a63bc189027f8e81235be11886e3">InstructionSelector::setupMF</a>(MF, KB, CoverageInfo, PSI, <a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">BFI</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    MIB.setMF(MF);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// hasFnAttribute() is expensive to call on every BRCOND selection, so</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// cache it here for each run of the selector.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    ProduceNonFlagSettingCondBr =</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        !MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">getFunction</a>().<a class="code" href="classllvm_1_1Function.html#afb28a4deafe2954b0534cc6399ce518b">hasFnAttribute</a>(Attribute::SpeculativeLoadHardening);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    MFReturnAddr = <a class="code" href="classllvm_1_1Register.html">Register</a>();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    processPHIs(MF);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">  /// tblgen-erated &#39;select&#39; implementation, used as the initial selector for</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">  /// the patterns that don&#39;t require complex C++.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1mca.html#a9daeae4f77bbf637d7f5ed46c92ed5c5">selectImpl</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1CodeGenCoverage.html">CodeGenCoverage</a> &amp;CoverageInfo) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// A lowering phase that runs before any selection attempts.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// Returns true if the instruction was modified.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">bool</span> preISelLower(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// An early selection function that runs before the selectImpl() call.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">bool</span> earlySelect(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// Do some preprocessing of G_PHIs before we begin selection.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">void</span> processPHIs(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">bool</span> earlySelectSHL(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">  /// Eliminate same-sized cross-bank copies into stores before selectImpl().</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> contractCrossBankCopyIntoStore(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                      <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">bool</span> convertPtrAddToAdd(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">bool</span> selectVaStartAAPCS(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                          <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">bool</span> selectVaStartDarwin(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                           <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  ///@{</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  /// Helper functions for selectCompareBranch.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> selectCompareBranchFedByFCmp(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;FCmp,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">bool</span> selectCompareBranchFedByICmp(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;ICmp,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">bool</span> tryOptCompareBranchFedByICmp(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;ICmp,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">bool</span> tryOptAndIntoCompareBranch(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;AndInst, <span class="keywordtype">bool</span> Invert,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DstMBB,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">  ///@}</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">bool</span> selectCompareBranch(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                           <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">bool</span> selectVectorAshrLshr(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordtype">bool</span> selectVectorSHL(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// Helper to generate an equivalent of scalar_to_vector into a new register,</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// returned via &#39;Dst&#39;.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitScalarToVector(<span class="keywordtype">unsigned</span> EltSize,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                   <a class="code" href="classllvm_1_1Register.html">Register</a> Scalar,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                   <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">  /// Emit a lane insert into \p DstReg, or a new vector register if</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">  /// std::nullopt is provided.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">  /// The lane inserted into is defined by \p LaneIdx. The vector source</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">  /// register is given by \p SrcReg. The register containing the element is</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">  /// given by \p EltReg.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitLaneInsert(std::optional&lt;Register&gt; DstReg, <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                               <a class="code" href="classllvm_1_1Register.html">Register</a> EltReg, <span class="keywordtype">unsigned</span> LaneIdx,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                               <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">  /// Emit a sequence of instructions representing a constant \p CV for a</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">  /// vector register \p Dst. (E.g. a MOV, or a load from a constant pool.)</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">  /// \returns the last instruction in the sequence on success, and nullptr</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">  /// otherwise.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitConstantVector(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CV,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                   <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                   <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">bool</span> selectInsertElt(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">bool</span> tryOptConstantBuildVec(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                              <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);<span class="comment"></span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">  /// \returns true if a G_BUILD_VECTOR instruction \p MI can be selected as a</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">  /// SUBREG_TO_REG.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> tryOptBuildVecToSubregToReg(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">bool</span> selectBuildVector(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="ARMInstructionSelector_8cpp.html#a0d70a38e8f0622515630e7e8672df270">selectMergeValues</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="ARMInstructionSelector_8cpp.html#a838cd050490773e0349589c0d78618fc">selectUnmergeValues</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">bool</span> selectShuffleVector(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordtype">bool</span> selectExtractElt(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">bool</span> selectConcatVectors(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">bool</span> selectSplitVectorUnmerge(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">  /// Helper function to select vector load intrinsics like</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">  /// @llvm.aarch64.neon.ld2.*, @llvm.aarch64.neon.ld4.*, etc.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">  /// \p Opc is the opcode that the selected instruction should use.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">  /// \p NumVecs is the number of vector destinations for the instruction.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">  /// \p I is the original G_INTRINSIC_W_SIDE_EFFECTS instruction.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> selectVectorLoadIntrinsic(<span class="keywordtype">unsigned</span> Opc, <span class="keywordtype">unsigned</span> NumVecs,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                 <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">bool</span> selectIntrinsicWithSideEffects(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                      <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordtype">bool</span> selectIntrinsic(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">bool</span> selectVectorICmp(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordtype">bool</span> selectIntrinsicTrunc(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">bool</span> selectIntrinsicRound(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">bool</span> selectJumpTable(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">bool</span> selectBrJT(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordtype">bool</span> selectTLSGlobalValue(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">bool</span> selectReduction(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">bool</span> selectMOPS(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">bool</span> selectUSMovFromExtend(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">unsigned</span> emitConstantPoolEntry(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CPVal,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                 <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitLoadFromConstantPool(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CPVal,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                         <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// Emit a vector concat operation.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitVectorConcat(std::optional&lt;Register&gt; Dst, <a class="code" href="classllvm_1_1Register.html">Register</a> Op1,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                 <a class="code" href="classllvm_1_1Register.html">Register</a> Op2,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                 <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// Emit an integer compare between LHS and RHS, which checks for Predicate.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitIntegerCompare(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                   <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                   <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">  /// Emit a floating point comparison between \p LHS and \p RHS.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  /// \p Pred if given is the intended predicate to use.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  emitFPCompare(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                std::optional&lt;CmpInst::Predicate&gt; = std::nullopt) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  emitInstr(<span class="keywordtype">unsigned</span> Opcode, std::initializer_list&lt;llvm::DstOp&gt; DstOps,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            std::initializer_list&lt;llvm::SrcOp&gt; SrcOps,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keyword">const</span> ComplexRendererFns &amp;RenderFns = std::nullopt) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  /// Helper function to emit an add or sub instruction.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">  /// \p AddrModeAndSizeToOpcode must contain each of the opcode variants above</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">  /// in a specific order.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">  /// Below is an example of the expected input to \p AddrModeAndSizeToOpcode.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">  /// \code</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">  ///   const std::array&lt;std::array&lt;unsigned, 2&gt;, 4&gt; Table {</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">  ///    {{AArch64::ADDXri, AArch64::ADDWri},</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  ///     {AArch64::ADDXrs, AArch64::ADDWrs},</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">  ///     {AArch64::ADDXrr, AArch64::ADDWrr},</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">  ///     {AArch64::SUBXri, AArch64::SUBWri},</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">  ///     {AArch64::ADDXrx, AArch64::ADDWrx}}};</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">  /// \endcode</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  /// Each row in the table corresponds to a different addressing mode. Each</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">  /// column corresponds to a different register size.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">  /// \attention Rows must be structured as follows:</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">  ///   - Row 0: The ri opcode variants</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">  ///   - Row 1: The rs opcode variants</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  ///   - Row 2: The rr opcode variants</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">  ///   - Row 3: The ri opcode variants for negative immediates</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">  ///   - Row 4: The rx opcode variants</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /// \attention Columns must be structured as follows:</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  ///   - Column 0: The 64-bit opcode variants</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">  ///   - Column 1: The 32-bit opcode variants</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">  /// \p Dst is the destination register of the binop to emit.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">  /// \p LHS is the left-hand operand of the binop to emit.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">  /// \p RHS is the right-hand operand of the binop to emit.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitAddSub(</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keyword">const</span> std::array&lt;std::array&lt;unsigned, 2&gt;, 5&gt; &amp;AddrModeAndSizeToOpcode,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitADD(<a class="code" href="classllvm_1_1Register.html">Register</a> DefReg, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                        <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitADDS(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                         <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitSUBS(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                         <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitCMN(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                        <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitTST(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                        <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitSelect(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                           <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                           <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitExtractVectorElt(std::optional&lt;Register&gt; DstReg,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB, <a class="code" href="classllvm_1_1LLT.html">LLT</a> ScalarTy,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                     <a class="code" href="classllvm_1_1Register.html">Register</a> VecReg, <span class="keywordtype">unsigned</span> LaneIdx,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                     <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitCSINC(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1Register.html">Register</a> Src1, <a class="code" href="classllvm_1_1Register.html">Register</a> Src2,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                          <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> Pred,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                          <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;<span class="comment"></span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">  /// Emit a CSet for a FP compare.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">  /// \p Dst is expected to be a 32-bit scalar register.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitCSetForFCmp(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">  /// Emit the overflow op for \p Opcode.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">  /// \p Opcode is expected to be an overflow op&#39;s opcode, e.g. G_UADDO,</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">  /// G_USUBO, etc.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span>  std::pair&lt;MachineInstr *, AArch64CC::CondCode&gt;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  emitOverflowOp(<span class="keywordtype">unsigned</span> Opcode, <a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                 <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">  /// Emit expression as a conjunction (a series of CCMP/CFCMP ops).</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">  /// In some cases this is even possible with OR operations in the expression.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ISelLowering_8cpp.html#af25c3ad8dd30f33b93e7540b8fbd27df">emitConjunction</a>(<a class="code" href="classllvm_1_1Register.html">Register</a> Val, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;OutCC,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ISelLowering_8cpp.html#a02f6de82e3085eef9b1ad0ebe9b2d500">emitConditionalComparison</a>(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                          <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                          <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                          <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> OutCC,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                          <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ISelLowering_8cpp.html#a588e5dcf7ccf9ec2b6922f24c012a08a">emitConjunctionRec</a>(<a class="code" href="classllvm_1_1Register.html">Register</a> Val, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;OutCC,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                   <span class="keywordtype">bool</span> Negate, <a class="code" href="classllvm_1_1Register.html">Register</a> CCOp,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                   <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                   <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">  /// Emit a TB(N)Z instruction which tests \p Bit in \p TestReg.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">  /// \p IsNegative is true if the test should be &quot;not zero&quot;.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">  /// This will also optimize the test bit instruction when possible.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitTestBit(<a class="code" href="classllvm_1_1Register.html">Register</a> TestReg, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, <span class="keywordtype">bool</span> IsNegative,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                            <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DstMBB,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                            <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">  /// Emit a CB(N)Z instruction which branches to \p DestMBB.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *emitCBZ(<a class="code" href="classllvm_1_1Register.html">Register</a> CompareReg, <span class="keywordtype">bool</span> IsNegative,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                        <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DestMBB,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// Equivalent to the i32shift_a and friends from AArch64InstrInfo.td.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// We use these manually instead of using the importer since it doesn&#39;t</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// support SDNodeXForm.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  ComplexRendererFns selectShiftA_32(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  ComplexRendererFns selectShiftB_32(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  ComplexRendererFns selectShiftA_64(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  ComplexRendererFns selectShiftB_64(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  ComplexRendererFns select12BitValueWithLeftShift(<a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Immed) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  ComplexRendererFns selectArithImmed(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  ComplexRendererFns selectNegArithImmed(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  ComplexRendererFns selectAddrModeUnscaled(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                            <span class="keywordtype">unsigned</span> Size) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  ComplexRendererFns selectAddrModeUnscaled8(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">return</span> selectAddrModeUnscaled(Root, 1);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  ComplexRendererFns selectAddrModeUnscaled16(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> selectAddrModeUnscaled(Root, 2);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  ComplexRendererFns selectAddrModeUnscaled32(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">return</span> selectAddrModeUnscaled(Root, 4);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  ComplexRendererFns selectAddrModeUnscaled64(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> selectAddrModeUnscaled(Root, 8);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  ComplexRendererFns selectAddrModeUnscaled128(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> selectAddrModeUnscaled(Root, 16);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">  /// Helper to try to fold in a GISEL_ADD_LOW into an immediate, to be used</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">  /// from complex pattern matchers like selectAddrModeIndexed().</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span>  ComplexRendererFns tryFoldAddLowIntoImm(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;RootDef, <span class="keywordtype">unsigned</span> Size,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                          <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  ComplexRendererFns selectAddrModeIndexed(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                           <span class="keywordtype">unsigned</span> Size) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> W<span class="keywordtype">id</span>th&gt;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  ComplexRendererFns selectAddrModeIndexed(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> selectAddrModeIndexed(Root, <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> / 8);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordtype">bool</span> isWorthFoldingIntoExtendedReg(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  ComplexRendererFns</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  selectAddrModeShiftedExtendXReg(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                  <span class="keywordtype">unsigned</span> SizeInBytes) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">  /// Returns a \p ComplexRendererFns which contains a base, offset, and whether</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">  /// or not a shift + extend should be folded into an addressing mode. Returns</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  /// None when this is not profitable or possible.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span>  ComplexRendererFns</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  selectExtendedSHL(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Offset, <span class="keywordtype">unsigned</span> SizeInBytes,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordtype">bool</span> WantsExt) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  ComplexRendererFns selectAddrModeRegisterOffset(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  ComplexRendererFns selectAddrModeXRO(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                       <span class="keywordtype">unsigned</span> SizeInBytes) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> W<span class="keywordtype">id</span>th&gt;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  ComplexRendererFns selectAddrModeXRO(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">return</span> selectAddrModeXRO(Root, <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> / 8);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  ComplexRendererFns selectAddrModeWRO(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                       <span class="keywordtype">unsigned</span> SizeInBytes) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> W<span class="keywordtype">id</span>th&gt;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  ComplexRendererFns selectAddrModeWRO(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span> selectAddrModeWRO(Root, <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> / 8);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  ComplexRendererFns selectShiftedRegister(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                           <span class="keywordtype">bool</span> AllowROR = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  ComplexRendererFns selectArithShiftedRegister(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> selectShiftedRegister(Root);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  ComplexRendererFns selectLogicalShiftedRegister(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">return</span> selectShiftedRegister(Root, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">  /// Given an extend instruction, determine the correct shift-extend type for</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">  /// that instruction.</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">  /// If the instruction is going to be used in a load or store, pass</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">  /// \p IsLoadStore = true.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span>  <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">AArch64_AM::ShiftExtendType</a></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  getExtendTypeForInst(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                       <span class="keywordtype">bool</span> IsLoadStore = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">  /// Move \p Reg to \p RC if \p Reg is not already on \p RC.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">  /// \returns Either \p Reg if no change was necessary, or the new register</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  /// created by moving \p Reg.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">  ///</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">  /// Note: This uses emitCopy right now.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span>  <a class="code" href="classllvm_1_1Register.html">Register</a> moveScalarRegClass(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> &amp;RC,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                              <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  ComplexRendererFns selectArithExtendedRegister(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordtype">void</span> renderTruncImm(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                      <span class="keywordtype">int</span> OpIdx = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordtype">void</span> renderLogicalImm32(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                          <span class="keywordtype">int</span> OpIdx = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">void</span> renderLogicalImm64(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                          <span class="keywordtype">int</span> OpIdx = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">void</span> renderFPImm16(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                     <span class="keywordtype">int</span> OpIdx = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordtype">void</span> renderFPImm32(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                     <span class="keywordtype">int</span> OpIdx = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordtype">void</span> renderFPImm64(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                     <span class="keywordtype">int</span> OpIdx = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">void</span> renderFPImm32SIMDModImmType4(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                    <span class="keywordtype">int</span> OpIdx = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// Materialize a GlobalValue or BlockAddress using a movz+movk sequence.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">void</span> materializeLargeCMVal(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> OpFlags);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">// Optimization methods.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordtype">bool</span> tryOptSelect(<a class="code" href="classllvm_1_1GSelect.html">GSelect</a> &amp;Sel);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">bool</span> tryOptSelectConjunction(<a class="code" href="classllvm_1_1GSelect.html">GSelect</a> &amp;Sel, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;CondMI);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *tryFoldIntegerCompare(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                      <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">  /// Return true if \p MI is a load or store of \p NumBytes bytes.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isLoadStoreOfNumBytes(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <span class="keywordtype">unsigned</span> NumBytes) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">  /// Returns true if \p MI is guaranteed to have the high-half of a 64-bit</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">  /// register zeroed out. In other words, the result of MI has been explicitly</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">  /// zero extended.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> isDef32(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64TargetMachine.html">AArch64TargetMachine</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a> &amp;STI;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64InstrInfo.html">AArch64InstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64RegisterInfo.html">AArch64RegisterInfo</a> &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64RegisterBankInfo.html">AArch64RegisterBankInfo</a> &amp;RBI;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordtype">bool</span> ProduceNonFlagSettingCondBr = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Some cached values used during selection.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// We use LR as a live-in register, and we keep track of it here as it can be</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// clobbered by calls.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> MFReturnAddr;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIB;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a2e198bb37135fbb2ecffb49ce588dfaa">  477</a></span>&#160;<span class="preprocessor">#define GET_GLOBALISEL_PREDICATES_DECL</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#include &quot;AArch64GenGlobalISel.inc&quot;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#undef GET_GLOBALISEL_PREDICATES_DECL</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">// We declare the temporaries used by selectImpl() in the class to minimize the</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">// cost of constructing placeholder values.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a7ae8a4d3c9110554465fec97831b1dfd">  483</a></span>&#160;<span class="preprocessor">#define GET_GLOBALISEL_TEMPORARIES_DECL</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#include &quot;AArch64GenGlobalISel.inc&quot;</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">#undef GET_GLOBALISEL_TEMPORARIES_DECL</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;};</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#ae706a3af700f8ed432e93918d7601d5a">  490</a></span>&#160;<span class="preprocessor">#define GET_GLOBALISEL_IMPL</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#include &quot;AArch64GenGlobalISel.inc&quot;</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">#undef GET_GLOBALISEL_IMPL</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;AArch64InstructionSelector::AArch64InstructionSelector(</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64TargetMachine.html">AArch64TargetMachine</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a> &amp;STI,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64RegisterBankInfo.html">AArch64RegisterBankInfo</a> &amp;RBI)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    : <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>(<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>), STI(STI), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>(*STI.getInstrInfo()), <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>(*STI.getRegisterInfo()),</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      RBI(RBI),</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;#define <a class="code" href="AArch64InstructionSelector_8cpp.html#a1ab538c256c3204b950075744d5b2b16">GET_GLOBALISEL_PREDICATES_INIT</a></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;#<a class="code" href="lib_2XRay_2CMakeLists_8txt.html#aafdfebe14a06b834fe5fb0d10309d43c">include</a> <span class="stringliteral">&quot;AArch64GenGlobalISel.inc&quot;</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;#undef <a class="code" href="AArch64InstructionSelector_8cpp.html#a1ab538c256c3204b950075744d5b2b16">GET_GLOBALISEL_PREDICATES_INIT</a></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;#define <a class="code" href="AArch64InstructionSelector_8cpp.html#a1cd36a579f079f7f4506d9d097b2f0a8">GET_GLOBALISEL_TEMPORARIES_INIT</a></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;#<a class="code" href="lib_2XRay_2CMakeLists_8txt.html#aafdfebe14a06b834fe5fb0d10309d43c">include</a> <span class="stringliteral">&quot;AArch64GenGlobalISel.inc&quot;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;#undef <a class="code" href="AArch64InstructionSelector_8cpp.html#a1cd36a579f079f7f4506d9d097b2f0a8">GET_GLOBALISEL_TEMPORARIES_INIT</a></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">// FIXME: This should be target-independent, inferred from the types declared</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">// for each class in the bank.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">/// Given a register bank, and a type, return the smallest register class that</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">/// can represent that combination.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;getRegClassForTypeOnBank(<a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty, <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB,</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                         <span class="keywordtype">bool</span> GetAllRegSet = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &lt;= 32)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordflow">return</span> GetAllRegSet ? &amp;AArch64::GPR32allRegClass</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                          : &amp;AArch64::GPR32RegClass;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 64)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">return</span> GetAllRegSet ? &amp;AArch64::GPR64allRegClass</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                          : &amp;AArch64::GPR64RegClass;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 128)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::XSeqPairsClassRegClass;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">switch</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR8RegClass;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR16RegClass;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR32RegClass;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR64RegClass;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR128RegClass;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">/// Given a register bank, and size in bits, return the smallest register class</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">/// that can represent that combination.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *</div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">  550</a></span>&#160;<a class="code" href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">getMinClassForRegBank</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB, <span class="keywordtype">unsigned</span> SizeInBits,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                      <span class="keywordtype">bool</span> GetAllRegSet = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">unsigned</span> RegBankID = RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordflow">if</span> (RegBankID == AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (SizeInBits &lt;= 32)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordflow">return</span> GetAllRegSet ? &amp;AArch64::GPR32allRegClass</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                          : &amp;AArch64::GPR32RegClass;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (SizeInBits == 64)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">return</span> GetAllRegSet ? &amp;AArch64::GPR64allRegClass</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                          : &amp;AArch64::GPR64RegClass;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">if</span> (SizeInBits == 128)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::XSeqPairsClassRegClass;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">if</span> (RegBankID == AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">switch</span> (SizeInBits) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR8RegClass;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR16RegClass;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR32RegClass;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR64RegClass;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keywordflow">return</span> &amp;AArch64::FPR128RegClass;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/// Returns the correct subregister to use for a given register class.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">  586</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC,</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <span class="keywordtype">unsigned</span> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a251557179fe64bb09bd7e327c60c6b24">getRegSizeInBits</a>(*RC)) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = AArch64::bsub;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = AArch64::hsub;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">if</span> (RC != &amp;AArch64::FPR32RegClass)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = AArch64::sub_32;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = AArch64::ssub;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = AArch64::dsub;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t find appropriate subregister for register class.&quot;</span>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">/// Returns the minimum size the given register bank can hold.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a496c2822a80bc1f575e662e247f61d77">  614</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a496c2822a80bc1f575e662e247f61d77">getMinSizeForRegBank</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">switch</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>()) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">case</span> AArch64::GPRRegBankID:</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">return</span> 32;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">case</span> AArch64::FPRRegBankID:</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">return</span> 8;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Tried to get minimum size for unknown register bank.&quot;</span>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">/// Create a REG_SEQUENCE instruction using the registers in \p Regs.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">/// Helper function for functions like createDTuple and createQTuple.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">/// \p RegClassIDs - The list of register class IDs available for some tuple of</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">/// a scalar class. E.g. QQRegClassID, QQQRegClassID, QQQQRegClassID. This is</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">/// expected to contain between 2 and 4 tuple classes.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">/// \p SubRegs - The list of subregister classes associated with each register</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">/// class ID in \p RegClassIDs. E.g., QQRegClassID should use the qsub0</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">/// subregister class. The index of each subregister class is expected to</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">/// correspond with the index of each register class.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">/// \returns Either the destination register of REG_SEQUENCE instruction that</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">/// was created, or the 0th element of \p Regs if \p Regs contains a single</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">/// element.</span></div>
<div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#afb7df659747f14484e642788c2fe6788">  640</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="AArch64InstructionSelector_8cpp.html#afb7df659747f14484e642788c2fe6788">createTuple</a>(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Register&gt;</a> Regs,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> RegClassIDs[],</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> SubRegs[], <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordtype">unsigned</span> NumRegs = Regs.<a class="code" href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">if</span> (NumRegs == 1)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">return</span> Regs[0];</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumRegs &gt;= 2 &amp;&amp; NumRegs &lt;= 4 &amp;&amp;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;         <span class="stringliteral">&quot;Only support between two and 4 registers in a tuple!&quot;</span>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">getMF</a>().<a class="code" href="classllvm_1_1MachineFunction.html#a325f6b611ef9ec06798d3b4eb9572093">getSubtarget</a>().<a class="code" href="classllvm_1_1TargetSubtargetInfo.html#a87849514193302b75f50a8092f94b98a">getRegisterInfo</a>();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keyword">auto</span> *DesiredClass = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a55ad07e4cbe29bea4cb69b78472b690e">getRegClass</a>(RegClassIDs[NumRegs - 2]);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023aabce0250d60b95b97ff41ff41ba030d6">RegSequence</a> =</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::REG_SEQUENCE, {DesiredClass}, {});</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = Regs.<a class="code" href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023aabce0250d60b95b97ff41ff41ba030d6">RegSequence</a>.addUse(Regs[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023aabce0250d60b95b97ff41ff41ba030d6">RegSequence</a>.addImm(SubRegs[<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023aabce0250d60b95b97ff41ff41ba030d6">RegSequence</a>.getReg(0);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">/// Create a tuple of D-registers using the registers in \p Regs.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#aafa6584a25c261a3300bcadca8073518">  660</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="AArch64InstructionSelector_8cpp.html#aafa6584a25c261a3300bcadca8073518">createDTuple</a>(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Register&gt;</a> Regs, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> RegClassIDs[] = {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      AArch64::DDRegClassID, AArch64::DDDRegClassID, AArch64::DDDDRegClassID};</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> SubRegs[] = {AArch64::dsub0, AArch64::dsub1,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                     AArch64::dsub2, AArch64::dsub3};</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#afb7df659747f14484e642788c2fe6788">createTuple</a>(Regs, RegClassIDs, SubRegs, MIB);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">/// Create a tuple of Q-registers using the registers in \p Regs.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#af01e8bd1c1aba89ed27081450bb0d9e8">  669</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="AArch64InstructionSelector_8cpp.html#af01e8bd1c1aba89ed27081450bb0d9e8">createQTuple</a>(<a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;Register&gt;</a> Regs, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> RegClassIDs[] = {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      AArch64::QQRegClassID, AArch64::QQQRegClassID, AArch64::QQQQRegClassID};</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> SubRegs[] = {AArch64::qsub0, AArch64::qsub1,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                     AArch64::qsub2, AArch64::qsub3};</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#afb7df659747f14484e642788c2fe6788">createTuple</a>(Regs, RegClassIDs, SubRegs, MIB);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">  677</a></span>&#160;<span class="keyword">static</span> std::optional&lt;uint64_t&gt; <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keyword">auto</span> &amp;MF = *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MF.getRegInfo();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Immed;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">if</span> (Root.<a class="code" href="classllvm_1_1MachineOperand.html#a76f61c6784df6dc8402a8b9011041926">isImm</a>())</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    Immed = Root.<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Root.<a class="code" href="classllvm_1_1MachineOperand.html#a32ea768fbb182d6bbe3ff85ae1eb7031">isCImm</a>())</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    Immed = Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0af83aa690c458c5b3a8dc36ad3c3f9">getCImm</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>()) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keyword">auto</span> ValAndVReg =</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">if</span> (!ValAndVReg)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    Immed = ValAndVReg-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">return</span> Immed;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">/// Check whether \p I is a currently unsupported binary operation:</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">/// - it has an unsized type</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">/// - an operand is not a vreg</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">/// - all operands are not in the same bank</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">/// These are checks that should someday live in the verifier, but right now,</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">/// these are mostly limitations of the aarch64 selector.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#ac3419b7821dce4fc2e3a6f4a96b7dbaa">  704</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#ac3419b7821dce4fc2e3a6f4a96b7dbaa">unsupportedBinOp</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64RegisterBankInfo.html">AArch64RegisterBankInfo</a> &amp;RBI,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64RegisterInfo.html">AArch64RegisterInfo</a> &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">if</span> (!Ty.<a class="code" href="classllvm_1_1LLT.html#a69fb30748f1b3e8a0affd486a9f59f6d">isValid</a>()) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Generic binop register should be typed\n&quot;</span>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> *PrevOpBank = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;MO : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands()) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// FIXME: Support non-register operands.</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span> (!MO.isReg()) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Generic inst non-reg operands are unsupported\n&quot;</span>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// FIXME: Can generic operations have physical registers operands? If</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">// so, this will need to be taught about that, and we&#39;ll need to get the</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// bank out of the minimal class for the register.</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// Either way, this needs to be documented (and possibly verified).</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">if</span> (!MO.getReg().isVirtual()) {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Generic inst has physical register operand\n&quot;</span>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> *OpBank = RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a53a37d4bce0298f3ec4099611c75d7ac">getRegBank</a>(MO.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span> (!OpBank) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Generic register has no bank or class\n&quot;</span>);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (PrevOpBank &amp;&amp; OpBank != PrevOpBank) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Generic inst operands have different banks\n&quot;</span>);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    PrevOpBank = OpBank;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;}</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">/// Select the AArch64 opcode for the basic binary operation \p GenericOpc</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">/// (such as G_OR or G_SDIV), appropriate for the register bank \p RegBankID</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">/// and of size \p OpSize.</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">/// \returns \p GenericOpc if the combination is unsupported.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a8e3929f9a80e9ff6d48e35bba3e2d600">  750</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a8e3929f9a80e9ff6d48e35bba3e2d600">selectBinaryOp</a>(<span class="keywordtype">unsigned</span> GenericOpc, <span class="keywordtype">unsigned</span> RegBankID,</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                               <span class="keywordtype">unsigned</span> OpSize) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">switch</span> (RegBankID) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">case</span> AArch64::GPRRegBankID:</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span> (OpSize == 32) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_SHL:</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">return</span> AArch64::LSLVWr;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_LSHR:</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">return</span> AArch64::LSRVWr;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_ASHR:</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">return</span> AArch64::ASRVWr;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (OpSize == 64) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_PTR_ADD:</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">return</span> AArch64::ADDXrr;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_SHL:</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keywordflow">return</span> AArch64::LSLVXr;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_LSHR:</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">return</span> AArch64::LSRVXr;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_ASHR:</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">return</span> AArch64::ASRVXr;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">case</span> AArch64::FPRRegBankID:</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">switch</span> (OpSize) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FADD:</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">return</span> AArch64::FADDSrr;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FSUB:</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">return</span> AArch64::FSUBSrr;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FMUL:</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordflow">return</span> AArch64::FMULSrr;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FDIV:</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">return</span> AArch64::FDIVSrr;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FADD:</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">return</span> AArch64::FADDDrr;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FSUB:</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">return</span> AArch64::FSUBDrr;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FMUL:</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">return</span> AArch64::FMULDrr;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FDIV:</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordflow">return</span> AArch64::FDIVDrr;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_OR:</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">return</span> AArch64::ORRv8i8;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">/// Select the AArch64 opcode for the G_LOAD or G_STORE operation \p GenericOpc,</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">/// appropriate for the (value) register bank \p RegBankID and of memory access</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">/// size \p OpSize.  This returns the variant with the base+unsigned-immediate</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">/// addressing mode (e.g., LDRXui).</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">/// \returns \p GenericOpc if the combination is unsupported.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a61d01252826372b1ec3aefc12e0c23d1">  821</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a61d01252826372b1ec3aefc12e0c23d1">selectLoadStoreUIOp</a>(<span class="keywordtype">unsigned</span> GenericOpc, <span class="keywordtype">unsigned</span> RegBankID,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                    <span class="keywordtype">unsigned</span> OpSize) {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> = GenericOpc == TargetOpcode::G_STORE;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordflow">switch</span> (RegBankID) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">case</span> AArch64::GPRRegBankID:</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">switch</span> (OpSize) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRBBui : AArch64::LDRBBui;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRHHui : AArch64::LDRHHui;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRWui : AArch64::LDRWui;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRXui : AArch64::LDRXui;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">case</span> AArch64::FPRRegBankID:</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">switch</span> (OpSize) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRBui : AArch64::LDRBui;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRHui : AArch64::LDRHui;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRSui : AArch64::LDRSui;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRDui : AArch64::LDRDui;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">case</span> 128:</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a> ? AArch64::STRQui : AArch64::LDRQui;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">/// Helper function for selectCopy. Inserts a subregister copy from \p SrcReg</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">/// to \p *To.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">/// E.g &quot;To = COPY SrcReg:SubReg&quot;</span></div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a9acef535219004fa4c89f4f996343b6f">  859</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a9acef535219004fa4c89f4f996343b6f">copySubReg</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBankInfo.html">RegisterBankInfo</a> &amp;RBI, <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg,</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *To, <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SrcReg.<a class="code" href="classllvm_1_1Register.html#a4a6966b99e305bd6f01fb17c645ae3da">isValid</a>() &amp;&amp; <span class="stringliteral">&quot;Expected a valid source register?&quot;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(To &amp;&amp; <span class="stringliteral">&quot;Destination register class cannot be null&quot;</span>);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> &amp;&amp; <span class="stringliteral">&quot;Expected a valid subregister&quot;</span>);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIB(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keyword">auto</span> SubRegCopy =</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {To}, {}).addReg(SrcReg, 0, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;RegOp = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  RegOp.<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(SubRegCopy.getReg(0));</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">// It&#39;s possible that the destination register won&#39;t be constrained. Make</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">// sure that happens.</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg().isPhysical())</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a1cfd8b1df608cb89b0acb94d29d447b3">constrainGenericRegister</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), *To, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;}</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">/// Helper function to get the source and destination register classes for a</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">/// copy. Returns a std::pair containing the source register class for the</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">/// copy, and the destination register class for the copy. If a register class</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">/// cannot be determined, then it will be nullptr.</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::pair&lt;const TargetRegisterClass *, const TargetRegisterClass *&gt;</div>
<div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a2df7b57ad693f7a4fdec514222c5e24e">  885</a></span>&#160;<a class="code" href="AArch64InstructionSelector_8cpp.html#a2df7b57ad693f7a4fdec514222c5e24e">getRegClassesForCopy</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>,</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                     <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>,</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBankInfo.html">RegisterBankInfo</a> &amp;RBI) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRegBank = *RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a53a37d4bce0298f3ec4099611c75d7ac">getRegBank</a>(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;SrcRegBank = *RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a53a37d4bce0298f3ec4099611c75d7ac">getRegBank</a>(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordtype">unsigned</span> DstSize = RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a03400563b62282df90443c4893d1f0e9">getSizeInBits</a>(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordtype">unsigned</span> SrcSize = RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a03400563b62282df90443c4893d1f0e9">getSizeInBits</a>(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// Special casing for cross-bank copies of s1s. We can technically represent</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// a 1-bit value with any size of register. The minimum size for a GPR is 32</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// bits. So, we need to put the FPR on 32 bits as well.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// FIXME: I&#39;m not sure if this case holds true outside of copies. If it does,</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="comment">// then we can pull it into the helpers that get the appropriate class for a</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// register bank. Or make a new helper that carries along some constraint</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">// information.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">if</span> (SrcRegBank != DstRegBank &amp;&amp; (DstSize == 1 &amp;&amp; SrcSize == 1))</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    SrcSize = DstSize = 32;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordflow">return</span> {<a class="code" href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">getMinClassForRegBank</a>(SrcRegBank, SrcSize, <span class="keyword">true</span>),</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          <a class="code" href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">getMinClassForRegBank</a>(DstRegBank, DstSize, <span class="keyword">true</span>)};</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;}</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">// FIXME: We need some sort of API in RBI/TRI to allow generic code to</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">// constrain operands of simple instructions given a TargetRegisterClass</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">// and LLT</span></div>
<div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#ab328c242b91fe2bc4d6d0797761fdea1">  913</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#ab328c242b91fe2bc4d6d0797761fdea1">selectDebugInstr</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBankInfo.html">RegisterBankInfo</a> &amp;RBI) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands()) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> (!MO.isReg())</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = MO.getReg();</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>.isPhysical())</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1PointerUnion.html">RegClassOrRegBank</a> &amp;RegClassOrBank = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a68db11947d61455d62d75b86020362c9">getRegClassOrRegBank</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC =</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        RegClassOrBank.<a class="code" href="classllvm_1_1PointerUnion.html#a9147352f78d98ee246f25d3300e0aaba">dyn_cast</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *&gt;();</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> (!RC) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RegClassOrBank.<a class="code" href="classllvm_1_1PointerUnion.html#a47a37d4a29c6d015b0ec9b0e722110fe">get</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> *&gt;();</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      RC = getRegClassForTypeOnBank(Ty, RB);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <span class="keywordflow">if</span> (!RC) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Warning: DBG_VALUE operand has unexpected size/bank\n&quot;</span>);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a1cfd8b1df608cb89b0acb94d29d447b3">constrainGenericRegister</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, *RC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;}</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">  942</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetInstrInfo.html">TargetInstrInfo</a> &amp;<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>,</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                       <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> &amp;<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>,</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBankInfo.html">RegisterBankInfo</a> &amp;RBI) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRegBank = *RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a53a37d4bce0298f3ec4099611c75d7ac">getRegBank</a>(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;SrcRegBank = *RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a53a37d4bce0298f3ec4099611c75d7ac">getRegBank</a>(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// Find the correct register classes for the source and destination registers.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *SrcRC;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  std::tie(SrcRC, DstRC) = <a class="code" href="AArch64InstructionSelector_8cpp.html#a2df7b57ad693f7a4fdec514222c5e24e">getRegClassesForCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordflow">if</span> (!DstRC) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unexpected dest size &quot;</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                      &lt;&lt; RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a03400563b62282df90443c4893d1f0e9">getSizeInBits</a>(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="comment">// Is this a copy? If so, then we may need to insert a subregister copy.</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isCopy()) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">// Yes. Check if there&#39;s anything to fix up.</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">if</span> (!SrcRC) {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t determine source register class\n&quot;</span>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordtype">unsigned</span> SrcSize = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a251557179fe64bb09bd7e327c60c6b24">getRegSizeInBits</a>(*SrcRC);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordtype">unsigned</span> DstSize = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a251557179fe64bb09bd7e327c60c6b24">getRegSizeInBits</a>(*DstRC);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="comment">// If the source bank doesn&#39;t support a subregister copy small enough,</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// then we first need to copy to the destination bank.</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64InstructionSelector_8cpp.html#a496c2822a80bc1f575e662e247f61d77">getMinSizeForRegBank</a>(SrcRegBank) &gt; DstSize) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstTempRC =</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;          <a class="code" href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">getMinClassForRegBank</a>(DstRegBank, SrcSize, <span class="comment">/* GetAllRegSet */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(DstRC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIB(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keyword">auto</span> Copy = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({DstTempRC}, {SrcReg});</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#a9acef535219004fa4c89f4f996343b6f">copySubReg</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, RBI, Copy.getReg(0), DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SrcSize &gt; DstSize) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="comment">// If the source register is bigger than the destination we need to</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="comment">// perform a subregister copy.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *SubRegRC =</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;          <a class="code" href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">getMinClassForRegBank</a>(SrcRegBank, DstSize, <span class="comment">/* GetAllRegSet */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(SubRegRC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#a9acef535219004fa4c89f4f996343b6f">copySubReg</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, RBI, SrcReg, DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstSize &gt; SrcSize) {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="comment">// If the destination register is bigger than the source we need to do</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="comment">// a promotion using SUBREG_TO_REG.</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *PromotionRC =</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;          <a class="code" href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">getMinClassForRegBank</a>(SrcRegBank, DstSize, <span class="comment">/* GetAllRegSet */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(SrcRC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> PromoteReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(PromotionRC);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(),</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;              <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::SUBREG_TO_REG), PromoteReg)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SrcReg)</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;RegOp = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      RegOp.<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(PromoteReg);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="comment">// If the destination is a physical register, then there&#39;s nothing to</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="comment">// change, so we&#39;re done.</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">if</span> (DstReg.<a class="code" href="classllvm_1_1Register.html#a13bd3dae94013a7bf38afc9391c8fa8f">isPhysical</a>())</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="comment">// No need to constrain SrcReg. It will get constrained when we hit another</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">// of its use or its defs. Copies do not have constraints.</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">if</span> (!RBI.<a class="code" href="classllvm_1_1RegisterBankInfo.html#a1cfd8b1df608cb89b0acb94d29d447b3">constrainGenericRegister</a>(DstReg, *DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to constrain &quot;</span> &lt;&lt; <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.getName(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode())</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; operand\n&quot;</span>);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="comment">// If this a GPR ZEXT that we want to just reduce down into a copy.</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// The sizes will be mismatched with the source &lt; 32b but that&#39;s ok.</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_ZEXT) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::COPY));</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SrcRegBank.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::GPRRegBankID);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::COPY));</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a18c672925e05a23b72838be961003fc7"> 1033</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a18c672925e05a23b72838be961003fc7">selectFPConvOpc</a>(<span class="keywordtype">unsigned</span> GenericOpc, <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy, <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy) {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">if</span> (!DstTy.<a class="code" href="classllvm_1_1LLT.html#a3989251b1a714fc8296685f77eac6e87">isScalar</a>() || !SrcTy.<a class="code" href="classllvm_1_1LLT.html#a3989251b1a714fc8296685f77eac6e87">isScalar</a>())</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> DstSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> SrcSize = SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordflow">switch</span> (DstSize) {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">switch</span> (SrcSize) {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_SITOFP:</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">return</span> AArch64::SCVTFUWSri;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_UITOFP:</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">return</span> AArch64::UCVTFUWSri;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOSI:</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZSUWSr;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOUI:</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZUUWSr;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_SITOFP:</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">return</span> AArch64::SCVTFUXSri;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_UITOFP:</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">return</span> AArch64::UCVTFUXSri;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOSI:</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZSUWDr;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOUI:</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZUUWDr;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">switch</span> (SrcSize) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_SITOFP:</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordflow">return</span> AArch64::SCVTFUWDri;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_UITOFP:</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordflow">return</span> AArch64::UCVTFUWDri;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOSI:</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZSUXSr;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOUI:</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZUUXSr;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">switch</span> (GenericOpc) {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_SITOFP:</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordflow">return</span> AArch64::SCVTFUXDri;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_UITOFP:</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">return</span> AArch64::UCVTFUXDri;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOSI:</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZSUXDr;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="keywordflow">case</span> TargetOpcode::G_FPTOUI:</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">return</span> AArch64::FCVTZUUXDr;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  };</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">return</span> GenericOpc;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;}</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;AArch64InstructionSelector::emitSelect(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1Register.html">Register</a> True,</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                       <a class="code" href="classllvm_1_1Register.html">Register</a> False, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>,</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                       <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RBI.getRegBank(False, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() ==</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;             RBI.getRegBank(True, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() &amp;&amp;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;         <span class="stringliteral">&quot;Expected both select operands to have the same regbank?&quot;</span>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(True);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 32 || <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 64) &amp;&amp;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         <span class="stringliteral">&quot;Expected 32 bit or 64 bit select only?&quot;</span>);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> Is32Bit = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 32;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordflow">if</span> (RBI.getRegBank(True, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() != AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordtype">unsigned</span> Opc = Is32Bit ? AArch64::FCSELSrrr : AArch64::FCSELDrrr;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keyword">auto</span> FCSel = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {Dst}, {True, False}).addImm(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*FCSel, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">return</span> &amp;*FCSel;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">// By default, we&#39;ll try and emit a CSEL.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordtype">unsigned</span> Opc = Is32Bit ? AArch64::CSELWr : AArch64::CSELXr;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1logicalview.html#a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04">Optimized</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="keyword">auto</span> TryFoldBinOpIntoSelect = [&amp;Opc, Is32Bit, &amp;<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>, &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                 &amp;<a class="code" href="namespacellvm_1_1logicalview.html#a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04">Optimized</a>](<a class="code" href="classllvm_1_1Register.html">Register</a> &amp;<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> &amp;OtherReg,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                             <span class="keywordtype">bool</span> Invert) {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordflow">if</span> (Optimized)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">// Attempt to fold:</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">// %sub = G_SUB 0, %x</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">// %select = G_SELECT cc, %reg, %sub</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="comment">// Into:</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="comment">// %select = CSNEG %reg, %x, cc</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> MatchReg;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">mi_match</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a2f20e789b5382825adc3f5fb87310c37">m_Neg</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(MatchReg)))) {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      Opc = Is32Bit ? AArch64::CSNEGWr : AArch64::CSNEGXr;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = MatchReg;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <span class="keywordflow">if</span> (Invert) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, OtherReg);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">// Attempt to fold:</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// %xor = G_XOR %x, -1</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="comment">// %select = G_SELECT cc, %reg, %xor</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">// Into:</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">// %select = CSINV %reg, %x, cc</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">mi_match</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="namespacellvm_1_1MIPatternMatch.html#abeed97c145aefd8b8974bb1947a19439">m_Not</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(MatchReg)))) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      Opc = Is32Bit ? AArch64::CSINVWr : AArch64::CSINVXr;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = MatchReg;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keywordflow">if</span> (Invert) {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, OtherReg);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">// Attempt to fold:</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// %add = G_ADD %x, 1</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// %select = G_SELECT cc, %reg, %add</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// Into:</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// %select = CSINC %reg, %x, cc</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">mi_match</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                 <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a6a9178212966aea2cd69dfb4c66411db">m_any_of</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a084265f50ae31dd0e36c2d0206c474f6">m_GAdd</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(MatchReg), <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a27f29a27e5d3b0d6222ade8ab95e2be5">m_SpecificICst</a>(1)),</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                          <a class="code" href="namespacellvm_1_1MIPatternMatch.html#abef0dedc73ed9227d3b97209d619ee72">m_GPtrAdd</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(MatchReg), <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a27f29a27e5d3b0d6222ade8ab95e2be5">m_SpecificICst</a>(1))))) {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      Opc = Is32Bit ? AArch64::CSINCWr : AArch64::CSINCXr;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = MatchReg;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">if</span> (Invert) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, OtherReg);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  };</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="comment">// Helper lambda which tries to use CSINC/CSINV for the instruction when its</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="comment">// true/false values are constants.</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="comment">// FIXME: All of these patterns already exist in tablegen. We should be</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">// able to import these.</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="keyword">auto</span> TryOptSelectCst = [&amp;Opc, &amp;True, &amp;False, &amp;<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>, Is32Bit, &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                          &amp;<a class="code" href="namespacellvm_1_1logicalview.html#a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04">Optimized</a>]() {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">if</span> (Optimized)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keyword">auto</span> TrueCst = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(True, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keyword">auto</span> FalseCst = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(False, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">if</span> (!TrueCst &amp;&amp; !FalseCst)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> ZReg = Is32Bit ? AArch64::WZR : AArch64::XZR;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (TrueCst &amp;&amp; FalseCst) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      int64_t <a class="code" href="classT.html">T</a> = TrueCst-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      int64_t <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = FalseCst-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classT.html">T</a> == 0 &amp;&amp; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> == 1) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="comment">// G_SELECT cc, 0, 1 -&gt; CSINC zreg, zreg, cc</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        Opc = Is32Bit ? AArch64::CSINCWr : AArch64::CSINCXr;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        True = ZReg;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        False = ZReg;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classT.html">T</a> == 0 &amp;&amp; <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> == -1) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="comment">// G_SELECT cc 0, -1 -&gt; CSINV zreg, zreg cc</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        Opc = Is32Bit ? AArch64::CSINVWr : AArch64::CSINVXr;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        True = ZReg;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        False = ZReg;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">if</span> (TrueCst) {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      int64_t <a class="code" href="classT.html">T</a> = TrueCst-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classT.html">T</a> == 1) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="comment">// G_SELECT cc, 1, f -&gt; CSINC f, zreg, inv_cc</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        Opc = Is32Bit ? AArch64::CSINCWr : AArch64::CSINCXr;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        True = False;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        False = ZReg;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classT.html">T</a> == -1) {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="comment">// G_SELECT cc, -1, f -&gt; CSINV f, zreg, inv_cc</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        Opc = Is32Bit ? AArch64::CSINVWr : AArch64::CSINVXr;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        True = False;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        False = ZReg;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">if</span> (FalseCst) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      int64_t <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = FalseCst-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> == 1) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="comment">// G_SELECT cc, t, 1 -&gt; CSINC t, zreg, cc</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        Opc = Is32Bit ? AArch64::CSINCWr : AArch64::CSINCXr;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        False = ZReg;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> == -1) {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="comment">// G_SELECT cc, t, -1 -&gt; CSINC t, zreg, cc</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        Opc = Is32Bit ? AArch64::CSINVWr : AArch64::CSINVXr;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        False = ZReg;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  };</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <a class="code" href="namespacellvm_1_1logicalview.html#a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04">Optimized</a> |= TryFoldBinOpIntoSelect(False, True, <span class="comment">/*Invert = */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <a class="code" href="namespacellvm_1_1logicalview.html#a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04">Optimized</a> |= TryFoldBinOpIntoSelect(True, False, <span class="comment">/*Invert = */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <a class="code" href="namespacellvm_1_1logicalview.html#a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04">Optimized</a> |= TryOptSelectCst();</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="keyword">auto</span> <a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {Dst}, {True, False}).addImm(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">return</span> &amp;*<a class="code" href="classllvm_1_1SelectInst.html">SelectInst</a>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e"> 1280</a></span>&#160;<span class="keyword">static</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e">changeICMPPredToAArch64CC</a>(<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown condition code!&quot;</span>);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_NE:</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a191e89dbc4939ebd0b572cae44aac05f">AArch64CC::NE</a>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_EQ:</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="regexec_8c.html#ac07acfbb082b04f5bea72998c8976b3c">AArch64CC::EQ</a>;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SGT:</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a91a0c1b4eac415607c4ceb0a899c4629">AArch64CC::GT</a>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SGE:</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a2f9f5539ad5eab7c3de9fb21766bc78b">AArch64CC::GE</a>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SLT:</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a">AArch64CC::LT</a>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SLE:</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28aeb67eda6b42e3237bc28fb457347a1cb">AArch64CC::LE</a>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_UGT:</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28aa5506efe3dc67f7b794331f0cbffddaf">AArch64CC::HI</a>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_UGE:</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">AArch64CC::HS</a>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_ULT:</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab620924321db413fcc748afe522c2303">AArch64CC::LO</a>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_ULE:</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c">AArch64CC::LS</a>;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  }</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">/// changeFPCCToORAArch64CC - Convert an IR fp condition code to an AArch64 CC.</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#afef7d46bdebb2335e9947791fa017bb1"> 1308</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#afef7d46bdebb2335e9947791fa017bb1">changeFPCCToORAArch64CC</a>(<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                    <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;<a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a>,</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                    <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;CondCode2) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  CondCode2 = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>) {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown FP condition!&quot;</span>);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_OEQ:</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="regexec_8c.html#ac07acfbb082b04f5bea72998c8976b3c">AArch64CC::EQ</a>;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_OGT:</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a91a0c1b4eac415607c4ceb0a899c4629">AArch64CC::GT</a>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_OGE:</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a2f9f5539ad5eab7c3de9fb21766bc78b">AArch64CC::GE</a>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_OLT:</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">AArch64CC::MI</a>;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_OLE:</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c">AArch64CC::LS</a>;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_ONE:</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">AArch64CC::MI</a>;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    CondCode2 = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a91a0c1b4eac415607c4ceb0a899c4629">AArch64CC::GT</a>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_ORD:</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a0be9a5b045e14f589506ab6372ab6592">AArch64CC::VC</a>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_UNO:</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a9f54e5976c204d779cee3d87cabf0b02">AArch64CC::VS</a>;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_UEQ:</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="regexec_8c.html#ac07acfbb082b04f5bea72998c8976b3c">AArch64CC::EQ</a>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    CondCode2 = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a9f54e5976c204d779cee3d87cabf0b02">AArch64CC::VS</a>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_UGT:</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28aa5506efe3dc67f7b794331f0cbffddaf">AArch64CC::HI</a>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_UGE:</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a5b3c2afaad5594cd0eedd58a78a91baf">AArch64CC::PL</a>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_ULT:</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a">AArch64CC::LT</a>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_ULE:</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28aeb67eda6b42e3237bc28fb457347a1cb">AArch64CC::LE</a>;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_UNE:</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a191e89dbc4939ebd0b572cae44aac05f">AArch64CC::NE</a>;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;}</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">/// Convert an IR fp condition code to an AArch64 CC.</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">/// This differs from changeFPCCToAArch64CC in that it returns cond codes that</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment">/// should be AND&#39;ed instead of OR&#39;ed.</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a35ad100b6df3a31a99a57b0e7ebbac7a"> 1365</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a35ad100b6df3a31a99a57b0e7ebbac7a">changeFPCCToANDAArch64CC</a>(<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>,</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                     <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;<a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a>,</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                     <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;CondCode2) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  CondCode2 = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>) {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <a class="code" href="AArch64InstructionSelector_8cpp.html#afef7d46bdebb2335e9947791fa017bb1">changeFPCCToORAArch64CC</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>, <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a>, CondCode2);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CondCode2 == <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_ONE:</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="comment">// (a one b)</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">// == ((a olt b) || (a ogt b))</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="comment">// == ((a ord b) &amp;&amp; (a une b))</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a0be9a5b045e14f589506ab6372ab6592">AArch64CC::VC</a>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    CondCode2 = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a191e89dbc4939ebd0b572cae44aac05f">AArch64CC::NE</a>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">case</span> CmpInst::FCMP_UEQ:</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">// (a ueq b)</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="comment">// == ((a uno b) || (a oeq b))</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">// == ((a ule b) &amp;&amp; (a uge b))</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a5b3c2afaad5594cd0eedd58a78a91baf">AArch64CC::PL</a>;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    CondCode2 = <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28aeb67eda6b42e3237bc28fb457347a1cb">AArch64CC::LE</a>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  }</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;}</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">/// Return a register which can be used as a bit to test in a TB(N)Z.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a376f5aa1990808e8e65cc77dd462c677"> 1392</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="AArch64InstructionSelector_8cpp.html#a376f5aa1990808e8e65cc77dd462c677">getTestBitReg</a>(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> &amp;<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, <span class="keywordtype">bool</span> &amp;Invert,</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                              <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>.isValid() &amp;&amp; <span class="stringliteral">&quot;Expected valid register!&quot;</span>);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="keywordtype">bool</span> HasZext = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordtype">unsigned</span> Opc = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOpcode();</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(0).isReg() ||</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        !<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(0).getReg()))</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">// (tbz (any_ext x), b) -&gt; (tbz x, b) if we don&#39;t use the extended bits.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">// (tbz (trunc x), b) -&gt; (tbz x, b) is always safe, because the bit number</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">// on the truncated x is the same as the bit number on x.</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">if</span> (Opc == TargetOpcode::G_ANYEXT || Opc == TargetOpcode::G_ZEXT ||</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        Opc == TargetOpcode::G_TRUNC) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordflow">if</span> (Opc == TargetOpcode::G_ZEXT)</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        HasZext = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> NextReg = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).getReg();</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="comment">// Did we find something worth folding?</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordflow">if</span> (!NextReg.<a class="code" href="classllvm_1_1Register.html#a4a6966b99e305bd6f01fb17c645ae3da">isValid</a>() || !<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(NextReg))</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="comment">// NextReg is worth folding. Keep looking.</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = NextReg;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="comment">// Attempt to find a suitable operation with a constant on one side.</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    std::optional&lt;uint64_t&gt; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> TestReg;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_AND:</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_XOR: {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      TestReg = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).getReg();</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> ConstantReg = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(2).getReg();</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keyword">auto</span> VRegAndVal = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(ConstantReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">if</span> (!VRegAndVal) {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="comment">// AND commutes, check the other side for a constant.</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="comment">// FIXME: Can we canonicalize the constant so that it&#39;s always on the</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="comment">// same side at some point earlier?</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(ConstantReg, TestReg);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        VRegAndVal = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(ConstantReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keywordflow">if</span> (VRegAndVal) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <span class="keywordflow">if</span> (HasZext)</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;          <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = VRegAndVal-&gt;Value.getZExtValue();</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;          <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = VRegAndVal-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_ASHR:</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_LSHR:</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_SHL: {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      TestReg = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).getReg();</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="keyword">auto</span> VRegAndVal =</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;          <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(2).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="keywordflow">if</span> (VRegAndVal)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = VRegAndVal-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">// Didn&#39;t find a constant or viable register. Bail out of the loop.</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> || !TestReg.<a class="code" href="classllvm_1_1Register.html#a4a6966b99e305bd6f01fb17c645ae3da">isValid</a>())</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="comment">// We found a suitable instruction with a constant. Check to see if we can</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="comment">// walk through the instruction.</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> NextReg;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordtype">unsigned</span> TestRegSize = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(TestReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_AND:</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="comment">// (tbz (and x, m), b) -&gt; (tbz x, b) when the b-th bit of m is set.</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <span class="keywordflow">if</span> ((*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &gt;&gt; <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>) &amp; 1)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        NextReg = TestReg;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_SHL:</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="comment">// (tbz (shl x, c), b) -&gt; (tbz x, b-c) when b-c is positive and fits in</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="comment">// the type of the register.</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <span class="keywordflow">if</span> (*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &lt;= <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> &amp;&amp; (<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> - *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) &lt; TestRegSize) {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        NextReg = TestReg;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> - *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_ASHR:</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      <span class="comment">// (tbz (ashr x, c), b) -&gt; (tbz x, b+c) or (tbz x, msb) if b+c is &gt; # bits</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="comment">// in x</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      NextReg = TestReg;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> + *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> &gt;= TestRegSize)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = TestRegSize - 1;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_LSHR:</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="comment">// (tbz (lshr x, c), b) -&gt; (tbz x, b+c) when b + c is &lt; # bits in x</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> + *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) &lt; TestRegSize) {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        NextReg = TestReg;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> + *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">case</span> TargetOpcode::G_XOR:</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="comment">// We can walk through a G_XOR by inverting whether we use tbz/tbnz when</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="comment">// appropriate.</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="comment">// e.g. If x&#39; = xor x, c, and the b-th bit is set in c then</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <span class="comment">// tbz x&#39;, b -&gt; tbnz x, b</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="comment">// Because x&#39; only has the b-th bit set if x does not.</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <span class="keywordflow">if</span> ((*<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &gt;&gt; <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>) &amp; 1)</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        Invert = !Invert;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      NextReg = TestReg;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">// Check if we found anything worth folding.</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">if</span> (!NextReg.<a class="code" href="classllvm_1_1Register.html#a4a6966b99e305bd6f01fb17c645ae3da">isValid</a>())</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = NextReg;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;}</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitTestBit(</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> TestReg, <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, <span class="keywordtype">bool</span> IsNegative, <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DstMBB,</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TestReg.<a class="code" href="classllvm_1_1Register.html#a4a6966b99e305bd6f01fb17c645ae3da">isValid</a>());</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ProduceNonFlagSettingCondBr &amp;&amp;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;         <span class="stringliteral">&quot;Cannot emit TB(N)Z with speculation tracking!&quot;</span>);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="comment">// Attempt to optimize the test bit by walking over instructions.</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  TestReg = <a class="code" href="AArch64InstructionSelector_8cpp.html#a376f5aa1990808e8e65cc77dd462c677">getTestBitReg</a>(TestReg, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, IsNegative, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(TestReg);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected a scalar!&quot;</span>);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> &lt; 64 &amp;&amp; <span class="stringliteral">&quot;Bit is too large!&quot;</span>);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="comment">// When the test register is a 64-bit register, we have to narrow to make</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <span class="comment">// TBNZW work.</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordtype">bool</span> UseWReg = <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> &lt; 32;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordtype">unsigned</span> NecessarySize = UseWReg ? 32 : 64;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != NecessarySize)</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    TestReg = moveScalarRegClass(</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        TestReg, UseWReg ? AArch64::GPR32RegClass : AArch64::GPR64RegClass,</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        MIB);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpcTable[2][2] = {{AArch64::TBZX, AArch64::TBNZX},</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                          {AArch64::TBZW, AArch64::TBNZW}};</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="keywordtype">unsigned</span> Opc = OpcTable[UseWReg][IsNegative];</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keyword">auto</span> TestBitMI =</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(TestReg).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#af8571e8dfb010fd8ae76cc4f87aafaac">addMBB</a>(DstMBB);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*TestBitMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">return</span> &amp;*TestBitMI;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;}</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::tryOptAndIntoCompareBranch(</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;AndInst, <span class="keywordtype">bool</span> Invert, <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DstMBB,</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AndInst.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_AND &amp;&amp; <span class="stringliteral">&quot;Expected G_AND only?&quot;</span>);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="comment">// Given something like this:</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="comment">//  %x = ...Something...</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">//  %one = G_CONSTANT i64 1</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="comment">//  %zero = G_CONSTANT i64 0</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="comment">//  %and = G_AND %x, %one</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="comment">//  %cmp = G_ICMP intpred(ne), %and, %zero</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="comment">//  %cmp_trunc = G_TRUNC %cmp</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <span class="comment">//  G_BRCOND %cmp_trunc, %bb.3</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="comment">// We want to try and fold the AND into the G_BRCOND and produce either a</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="comment">// TBNZ (when we have intpred(ne)) or a TBZ (when we have intpred(eq)).</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">// In this case, we&#39;d get</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="comment">// TBNZ %x %bb.3</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="comment">// Check if the AND has a constant on its RHS which we can use as a mask.</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="comment">// If it&#39;s a power of 2, then it&#39;s the same as checking a specific bit.</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <span class="comment">// (e.g, ANDing with 8 == ANDing with 000...100 == testing if bit 3 is set)</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="keyword">auto</span> MaybeBit = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      AndInst.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>());</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordflow">if</span> (!MaybeBit)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  int32_t <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = MaybeBit-&gt;Value.exactLogBase2();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> &lt; 0)</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> TestReg = AndInst.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="comment">// Emit a TB(N)Z.</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  emitTestBit(TestReg, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, Invert, DstMBB, MIB);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitCBZ(<a class="code" href="classllvm_1_1Register.html">Register</a> CompareReg,</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                                                  <span class="keywordtype">bool</span> IsNegative,</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                                                  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DestMBB,</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                                                  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ProduceNonFlagSettingCondBr &amp;&amp; <span class="stringliteral">&quot;CBZ does not set flags!&quot;</span>);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RBI.getRegBank(CompareReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() ==</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;             AArch64::GPRRegBankID &amp;&amp;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;         <span class="stringliteral">&quot;Expected GPRs only?&quot;</span>);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keyword">auto</span> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(CompareReg);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected scalar only?&quot;</span>);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> &lt;= 64 &amp;&amp; <span class="stringliteral">&quot;Expected width to be at most 64?&quot;</span>);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpcTable[2][2] = {{AArch64::CBZW, AArch64::CBZX},</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                          {AArch64::CBNZW, AArch64::CBNZX}};</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keywordtype">unsigned</span> Opc = OpcTable[IsNegative][<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> == 64];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="keyword">auto</span> BranchMI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {}, {CompareReg}).addMBB(DestMBB);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*BranchMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="keywordflow">return</span> &amp;*BranchMI;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;}</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectCompareBranchFedByFCmp(</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;FCmp, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FCmp.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_FCMP);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_BRCOND);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="comment">// Unfortunately, the mapping of LLVM FP CC&#39;s onto AArch64 CC&#39;s isn&#39;t</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="comment">// totally clean.  Some of them require two branches to implement.</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keyword">auto</span> Pred = (<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">CmpInst::Predicate</a>)FCmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#af0d32d967ac31c4e6149c2adb89aa947">getPredicate</a>();</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  emitFPCompare(FCmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), FCmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), MIB,</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                Pred);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> CC1, CC2;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64GISelUtils.html#a6ac70c96c3ec3ca110703f1ebfe5e0ef">changeFCMPPredToAArch64CC</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(Pred), CC1, CC2);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DestMBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getMBB();</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::Bcc, {}, {}).addImm(CC1).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#af8571e8dfb010fd8ae76cc4f87aafaac">addMBB</a>(DestMBB);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordflow">if</span> (CC2 != <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>)</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::Bcc, {}, {}).addImm(CC2).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#af8571e8dfb010fd8ae76cc4f87aafaac">addMBB</a>(DestMBB);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::tryOptCompareBranchFedByICmp(</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;ICmp, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_ICMP);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_BRCOND);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="comment">// Attempt to optimize the G_BRCOND + G_ICMP into a TB(N)Z/CB(N)Z.</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="comment">// Speculation tracking/SLH assumes that optimized TB(N)Z/CB(N)Z</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="comment">// instructions will not be produced, as they are conditional branch</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="comment">// instructions that do not set flags.</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordflow">if</span> (!ProduceNonFlagSettingCondBr)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DestMBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getMBB();</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <span class="keyword">auto</span> Pred =</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#af0d32d967ac31c4e6149c2adb89aa947">getPredicate</a>());</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="comment">// We&#39;re allowed to emit a TB(N)Z/CB(N)Z. Try to do that.</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keyword">auto</span> VRegAndVal = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AndInst = <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_AND, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="comment">// When we can emit a TB(N)Z, prefer that.</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="comment">// Handle non-commutative condition codes first.</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="comment">// Note that we don&#39;t want to do this when we have a G_AND because it can</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="comment">// become a tst. The tst will make the test bit in the TB(N)Z redundant.</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <span class="keywordflow">if</span> (VRegAndVal &amp;&amp; !AndInst) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    int64_t <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = VRegAndVal-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="comment">// When we have a greater-than comparison, we can just test if the msb is</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="comment">// zero.</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> == -1 &amp;&amp; Pred == CmpInst::ICMP_SGT) {</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() - 1;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      emitTestBit(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, <span class="comment">/*IsNegative = */</span> <span class="keyword">false</span>, DestMBB, MIB);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="comment">// When we have a less than comparison, we can just test if the msb is not</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="comment">// zero.</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> == 0 &amp;&amp; Pred == CmpInst::ICMP_SLT) {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() - 1;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      emitTestBit(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, <span class="comment">/*IsNegative = */</span> <span class="keyword">true</span>, DestMBB, MIB);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    }</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="comment">// Inversely, if we have a signed greater-than-or-equal comparison to zero,</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">// we can test if the msb is zero.</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> == 0 &amp;&amp; Pred == CmpInst::ICMP_SGE) {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() - 1;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      emitTestBit(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">Bit</a>, <span class="comment">/*IsNegative = */</span> <span class="keyword">false</span>, DestMBB, MIB);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="comment">// Attempt to handle commutative condition codes. Right now, that&#39;s only</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="comment">// eq/ne.</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keywordflow">if</span> (ICmpInst::isEquality(Pred)) {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">if</span> (!VRegAndVal) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      VRegAndVal = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      AndInst = <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_AND, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordflow">if</span> (VRegAndVal &amp;&amp; VRegAndVal-&gt;Value == 0) {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <span class="comment">// If there&#39;s a G_AND feeding into this branch, try to fold it away by</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="comment">// emitting a TB(N)Z instead.</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <span class="comment">// Note: If we have LT, then it *is* possible to fold, but it wouldn&#39;t be</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="comment">// beneficial. When we have an AND and LT, we need a TST/ANDS, so folding</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="comment">// would be redundant.</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="keywordflow">if</span> (AndInst &amp;&amp;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          tryOptAndIntoCompareBranch(</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;              *AndInst, <span class="comment">/*Invert = */</span> Pred == CmpInst::ICMP_NE, DestMBB, MIB)) {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="comment">// Otherwise, try to emit a CB(N)Z instead.</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      <span class="keyword">auto</span> LHSTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="keywordflow">if</span> (!LHSTy.isVector() &amp;&amp; LHSTy.getSizeInBits() &lt;= 64) {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        emitCBZ(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <span class="comment">/*IsNegative = */</span> Pred == CmpInst::ICMP_NE, DestMBB, MIB);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;}</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectCompareBranchFedByICmp(</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;ICmp, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_ICMP);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_BRCOND);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">if</span> (tryOptCompareBranchFedByICmp(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, ICmp, MIB))</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="comment">// Couldn&#39;t optimize. Emit a compare + a Bcc.</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *DestMBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getMBB();</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keyword">auto</span> PredOp = ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  emitIntegerCompare(ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2), ICmp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(3), PredOp, MIB);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <a class="code" href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e">changeICMPPredToAArch64CC</a>(</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(PredOp.getPredicate()));</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::Bcc, {}, {}).addImm(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#af8571e8dfb010fd8ae76cc4f87aafaac">addMBB</a>(DestMBB);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;}</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectCompareBranch(</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> CondReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *CCMI = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(CondReg);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">// Try to select the G_BRCOND using whatever is feeding the condition if</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <span class="comment">// possible.</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordtype">unsigned</span> CCMIOpc = CCMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="keywordflow">if</span> (CCMIOpc == TargetOpcode::G_FCMP)</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">return</span> selectCompareBranchFedByFCmp(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *CCMI, MIB);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="keywordflow">if</span> (CCMIOpc == TargetOpcode::G_ICMP)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">return</span> selectCompareBranchFedByICmp(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *CCMI, MIB);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="comment">// Speculation tracking/SLH assumes that optimized TB(N)Z/CB(N)Z</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="comment">// instructions will not be produced, as they are conditional branch</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="comment">// instructions that do not set flags.</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keywordflow">if</span> (ProduceNonFlagSettingCondBr) {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    emitTestBit(CondReg, <span class="comment">/*Bit = */</span> 0, <span class="comment">/*IsNegative = */</span> <span class="keyword">true</span>,</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getMBB(), MIB);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="comment">// Can&#39;t emit TB(N)Z/CB(N)Z. Emit a tst + bcc instead.</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="keyword">auto</span> TstMI =</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::ANDSWri, {LLT::scalar(32)}, {CondReg}).addImm(1);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*TstMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keyword">auto</span> Bcc = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::Bcc)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                 .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="regexec_8c.html#ac07acfbb082b04f5bea72998c8976b3c">AArch64CC::EQ</a>)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                 .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#af8571e8dfb010fd8ae76cc4f87aafaac">addMBB</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getMBB());</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Bcc, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;}</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">/// Returns the element immediate value of a vector shift operand if found.</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">/// This needs to detect a splat-like operation, e.g. a G_BUILD_VECTOR.</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a1b622ba13b7a0005c33fd0d392df4e0a"> 1785</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> std::optional&lt;int64_t&gt; <a class="code" href="AArch64InstructionSelector_8cpp.html#a1b622ba13b7a0005c33fd0d392df4e0a">getVectorShiftImm</a>(<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>,</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                                <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>).<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected a *vector* shift operand&quot;</span>);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *OpMI = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64GISelUtils.html#afbd23de302bae474849243a215cb910c">getAArch64VectorSplatScalar</a>(*OpMI, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;}</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">/// Matches and returns the shift immediate value for a SHL instruction given</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">/// a shift operand.</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#aaf99cc107633e8a3758a15b396e290e1"> 1794</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> std::optional&lt;int64_t&gt; <a class="code" href="AArch64InstructionSelector_8cpp.html#aaf99cc107633e8a3758a15b396e290e1">getVectorSHLImm</a>(<a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>,</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                                              <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  std::optional&lt;int64_t&gt; ShiftImm = <a class="code" href="AArch64InstructionSelector_8cpp.html#a1b622ba13b7a0005c33fd0d392df4e0a">getVectorShiftImm</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="keywordflow">if</span> (!ShiftImm)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="comment">// Check the immediate is in range for a SHL.</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  int64_t <a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> = *ShiftImm;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &lt; 0)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordflow">switch</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unhandled element type for vector shift&quot;</span>);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &gt; 7)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &gt; 15)</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &gt; 31)</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> &gt; 63)</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  }</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a>;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;}</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160; </div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectVectorSHL(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                                                 <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_SHL);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src1Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src2Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="keywordflow">if</span> (!Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="comment">// Check if we have a vector of constants on RHS that we can select as the</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="comment">// immediate form.</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  std::optional&lt;int64_t&gt; ImmVal = <a class="code" href="AArch64InstructionSelector_8cpp.html#aaf99cc107633e8a3758a15b396e290e1">getVectorSHLImm</a>(Ty, Src2Reg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, 64)) {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    Opc = ImmVal ? AArch64::SHLv2i64_shift : AArch64::USHLv2i64;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, 32)) {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    Opc = ImmVal ? AArch64::SHLv4i32_shift : AArch64::USHLv4i32;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, 32)) {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    Opc = ImmVal ? AArch64::SHLv2i32_shift : AArch64::USHLv2i32;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, 16)) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    Opc = ImmVal ? AArch64::SHLv4i16_shift : AArch64::USHLv4i16;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, 16)) {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    Opc = ImmVal ? AArch64::SHLv8i16_shift : AArch64::USHLv8i16;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(16, 8)) {</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    Opc = ImmVal ? AArch64::SHLv16i8_shift : AArch64::USHLv16i8;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, 8)) {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    Opc = ImmVal ? AArch64::SHLv8i8_shift : AArch64::USHLv8i8;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unhandled G_SHL type&quot;</span>);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <span class="keyword">auto</span> Shl = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {DstReg}, {Src1Reg});</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <span class="keywordflow">if</span> (ImmVal)</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    Shl.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(*ImmVal);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    Shl.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(Src2Reg);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Shl, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;}</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectVectorAshrLshr(</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_ASHR ||</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_LSHR);</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src1Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src2Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keywordflow">if</span> (!Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="keywordtype">bool</span> IsASHR = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_ASHR;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160; </div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="comment">// We expect the immediate case to be lowered in the PostLegalCombiner to</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="comment">// AArch64ISD::VASHR or AArch64ISD::VLSHR equivalents.</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="comment">// There is not a shift right register instruction, but the shift left</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="comment">// register instruction takes a signed value, where negative numbers specify a</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="comment">// right shift.</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordtype">unsigned</span> NegOpc = 0;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC =</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      getRegClassForTypeOnBank(Ty, RBI.getRegBank(AArch64::FPRRegBankID));</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, 64)) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    Opc = IsASHR ? AArch64::SSHLv2i64 : AArch64::USHLv2i64;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    NegOpc = AArch64::NEGv2i64;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, 32)) {</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    Opc = IsASHR ? AArch64::SSHLv4i32 : AArch64::USHLv4i32;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    NegOpc = AArch64::NEGv4i32;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, 32)) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    Opc = IsASHR ? AArch64::SSHLv2i32 : AArch64::USHLv2i32;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    NegOpc = AArch64::NEGv2i32;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, 16)) {</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    Opc = IsASHR ? AArch64::SSHLv4i16 : AArch64::USHLv4i16;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    NegOpc = AArch64::NEGv4i16;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, 16)) {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    Opc = IsASHR ? AArch64::SSHLv8i16 : AArch64::USHLv8i16;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    NegOpc = AArch64::NEGv8i16;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(16, 8)) {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    Opc = IsASHR ? AArch64::SSHLv16i8 : AArch64::USHLv16i8;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    NegOpc = AArch64::NEGv16i8;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, 8)) {</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    Opc = IsASHR ? AArch64::SSHLv8i8 : AArch64::USHLv8i8;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    NegOpc = AArch64::NEGv8i8;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unhandled G_ASHR type&quot;</span>);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  }</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <span class="keyword">auto</span> Neg = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(NegOpc, {RC}, {Src2Reg});</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Neg, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <span class="keyword">auto</span> SShl = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {DstReg}, {Src1Reg, Neg});</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*SShl, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;}</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectVaStartAAPCS(</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;}</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectVaStartDarwin(</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <a class="code" href="classllvm_1_1AArch64FunctionInfo.html">AArch64FunctionInfo</a> *FuncInfo = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1AArch64FunctionInfo.html">AArch64FunctionInfo</a>&gt;();</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ListReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ArgsAddrReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64RegClass);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; </div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordtype">int</span> FrameIdx = FuncInfo-&gt;<a class="code" href="classllvm_1_1AArch64FunctionInfo.html#a6e56ab8686aecd83b84810e257d84b64">getVarArgsStackIndex</a>();</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">if</span> (MF.<a class="code" href="classllvm_1_1MachineFunction.html#a325f6b611ef9ec06798d3b4eb9572093">getSubtarget</a>&lt;<a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a>&gt;().<a class="code" href="classllvm_1_1AArch64Subtarget.html#a8d38ac8f86a38869b906ed0e2947b9d2">isCallingConvWin64</a>(</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;          MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">getFunction</a>().<a class="code" href="classllvm_1_1Function.html#a5f494edc0a569c7fc9ff4181243be1ed">getCallingConv</a>())) {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    FrameIdx = FuncInfo-&gt;<a class="code" href="classllvm_1_1AArch64FunctionInfo.html#aae1cc37c03dc88bd71db86b6180b9d71">getVarArgsGPRSize</a>() &gt; 0</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                   ? FuncInfo-&gt;<a class="code" href="classllvm_1_1AArch64FunctionInfo.html#a78ef05ed4db7991fa28264d76e8a5fc5">getVarArgsGPRIndex</a>()</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                   : FuncInfo-&gt;<a class="code" href="classllvm_1_1AArch64FunctionInfo.html#a6e56ab8686aecd83b84810e257d84b64">getVarArgsStackIndex</a>();</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keyword">auto</span> MIB =</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::ADDXri))</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(ArgsAddrReg)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a03258ce69ceadb08e189389468f7fd0a">addFrameIndex</a>(FrameIdx)</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*MIB, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  MIB = <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::STRXui))</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(ArgsAddrReg)</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(ListReg)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a47760ffd22a82283df0f5da521feca2a">addMemOperand</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.memoperands_begin());</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*MIB, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;}</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::materializeLargeCMVal(</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> OpFlags) {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keyword">auto</span> MovZ = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::MOVZXi, {&amp;AArch64::GPR64RegClass}, {});</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  MovZ-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a469e271fba3a9b52dad4fa54eaf44e2b">addOperand</a>(MF, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1));</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  MovZ-&gt;getOperand(1).setTargetFlags(OpFlags | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a6d9cfbe4ea54a3ce9d5308efab7200b9">AArch64II::MO_G0</a> |</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                                     <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a>);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  MovZ-&gt;addOperand(MF, MachineOperand::CreateImm(0));</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*MovZ, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160; </div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keyword">auto</span> BuildMovK = [&amp;](<a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>, <span class="keywordtype">unsigned</span> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>,</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                       <a class="code" href="classllvm_1_1Register.html">Register</a> ForceDstReg) {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = ForceDstReg</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                          ? ForceDstReg</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                          : <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64RegClass);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="keyword">auto</span> MovI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::MOVKXi).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(DstReg).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SrcReg);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *GV = dyn_cast&lt;GlobalValue&gt;(V)) {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      MovI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a469e271fba3a9b52dad4fa54eaf44e2b">addOperand</a>(MF, MachineOperand::CreateGA(</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                               GV, MovZ-&gt;getOperand(1).getOffset(), Flags));</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      MovI-&gt;addOperand(</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;          MF, MachineOperand::CreateBA(cast&lt;BlockAddress&gt;(V),</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                                       MovZ-&gt;getOperand(1).getOffset(), Flags));</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    MovI-&gt;addOperand(MF, MachineOperand::CreateImm(<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>));</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*MovI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">return</span> DstReg;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  };</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = BuildMovK(MovZ.getReg(0),</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                              <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a30eefa1143a0a238486ada4ff95bc34b">AArch64II::MO_G1</a> | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a>, 16, 0);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  DstReg = BuildMovK(DstReg, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71ae048a7c85d8a27195ad9ce1e1282bda9">AArch64II::MO_G2</a> | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a>, 32, 0);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  BuildMovK(DstReg, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71af2217d25138eade76a256c4c3dc131bd">AArch64II::MO_G3</a>, 48, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;}</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::preISelLower(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode()) {</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_STORE: {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keywordtype">bool</span> Changed = contractCrossBankCopyIntoStore(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="classllvm_1_1SrcOp.html">SrcOp</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="classllvm_1_1SrcOp.html">SrcOp</a>.<a class="code" href="classllvm_1_1SrcOp.html#ae229785d0c8a8ce25d34be18fe150a54">getReg</a>()).<a class="code" href="classllvm_1_1LLT.html#a9d825f5954d7bd527aea490668c624c6">isPointer</a>()) {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="comment">// Allow matching with imported patterns for stores of pointers. Unlike</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <span class="comment">// G_LOAD/G_PTR_ADD, we may not have selected all users. So, emit a copy</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <span class="comment">// and constrain.</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(LLT::scalar(64), <a class="code" href="classllvm_1_1SrcOp.html">SrcOp</a>);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> NewSrc = <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>.getReg(0);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      <a class="code" href="classllvm_1_1SrcOp.html">SrcOp</a>.setReg(NewSrc);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      RBI.constrainGenericRegister(NewSrc, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_PTR_ADD:</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordflow">return</span> convertPtrAddToAdd(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_LOAD: {</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">// For scalar loads of pointers, we try to convert the dest type from p0</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="comment">// to s64 so that our imported patterns can match. Like with the G_PTR_ADD</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="comment">// conversion, this should be ok because all users should have been</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">// selected already, so the type doesn&#39;t matter for them.</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordflow">if</span> (!DstTy.<a class="code" href="classllvm_1_1LLT.html#a9d825f5954d7bd527aea490668c624c6">isPointer</a>())</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a8d65688eb3408e2f26bf75b83a1b3448">setType</a>(DstReg, LLT::scalar(64));</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="keywordflow">case</span> AArch64::G_DUP: {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="comment">// Convert the type from p0 to s64 to help selection.</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="keywordflow">if</span> (!DstTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a9d825f5954d7bd527aea490668c624c6">isPointer</a>())</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keyword">auto</span> NewSrc = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(LLT::scalar(64), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a8d65688eb3408e2f26bf75b83a1b3448">setType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(),</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                DstTy.<a class="code" href="classllvm_1_1LLT.html#a4f404daab6050b7a8e95bb247d4aefb2">changeElementType</a>(LLT::scalar(64)));</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a965a15cef77a97f0e17f9f26fd5be53e">setRegClass</a>(NewSrc.getReg(0), &amp;AArch64::GPR64RegClass);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).setReg(NewSrc.getReg(0));</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  }</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_UITOFP:</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SITOFP: {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="comment">// If both source and destination regbanks are FPR, then convert the opcode</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">// to G_SITOF so that the importer can select it to an fpr variant.</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="comment">// Otherwise, it ends up matching an fpr/gpr variant and adding a cross-bank</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="comment">// copy.</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">if</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() || SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>())</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">if</span> (RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() == AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_SITOFP)</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::G_SITOF));</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::G_UITOF));</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    }</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;}</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">/// This lowering tries to look for G_PTR_ADD instructions and then converts</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">/// them to a standard G_ADD with a COPY on the source.</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment">/// The motivation behind this is to expose the add semantics to the imported</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment">/// tablegen patterns. We shouldn&#39;t need to check for uses being loads/stores,</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">/// because the selector works bottom up, uses before defs. By the time we</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">/// end up trying to select a G_PTR_ADD, we should have already attempted to</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">/// fold this into addressing modes and were therefore unsuccessful.</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> AArch64InstructionSelector::convertPtrAddToAdd(</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_PTR_ADD &amp;&amp; <span class="stringliteral">&quot;Expected G_PTR_ADD&quot;</span>);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> AddOp1Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> PtrTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="keywordflow">if</span> (PtrTy.<a class="code" href="classllvm_1_1LLT.html#ac33fa4c8cfeb9287f51f95404a459de8">getAddressSpace</a>() != 0)</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> CastPtrTy =</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      PtrTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() ? LLT::fixed_vector(2, 64) : <a class="code" href="classllvm_1_1LLT.html">LLT</a>::scalar(64);</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keyword">auto</span> PtrToInt = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#afd3920e024c9e79df5fd07b03c64d314">buildPtrToInt</a>(CastPtrTy, AddOp1Reg);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="comment">// Set regbanks on the registers.</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="keywordflow">if</span> (PtrTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a81763ced27ec9b0c42f8848f4ebe5bd1">setRegBank</a>(PtrToInt.getReg(0), RBI.getRegBank(AArch64::FPRRegBankID));</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a81763ced27ec9b0c42f8848f4ebe5bd1">setRegBank</a>(PtrToInt.getReg(0), RBI.getRegBank(AArch64::GPRRegBankID));</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; </div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="comment">// Now turn the %dst(p0) = G_PTR_ADD %base, off into:</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="comment">// %dst(intty) = G_ADD %intbase, off</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::G_ADD));</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a8d65688eb3408e2f26bf75b83a1b3448">setType</a>(DstReg, CastPtrTy);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).setReg(PtrToInt.getReg(0));</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="README-SSE_8txt.html#a9fb6cbbc77fb02ab3a51b0660bd09909">select</a>(*PtrToInt)) {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to select G_PTRTOINT in convertPtrAddToAdd&quot;</span>);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="comment">// Also take the opportunity here to try to do some optimization.</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="comment">// Try to convert this into a G_SUB if the offset is a 0-x negate idiom.</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> NegatedReg;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">mi_match</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a2f20e789b5382825adc3f5fb87310c37">m_Neg</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(NegatedReg))))</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).setReg(NegatedReg);</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::G_SUB));</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;}</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::earlySelectSHL(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                                                <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="comment">// We try to match the immediate variant of LSL, which is actually an alias</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <span class="comment">// for a special case of UBFM. Otherwise, we fall back to the imported</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="comment">// selector which will match the register variant.</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_SHL &amp;&amp; <span class="stringliteral">&quot;unexpected op&quot;</span>);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;MO = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="keyword">auto</span> VRegAndVal = <a class="code" href="namespacellvm.html#a19cdd6010b754ac90ebda5990b03cb40">getIConstantVRegVal</a>(MO.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keywordflow">if</span> (!VRegAndVal)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">if</span> (DstTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="keywordtype">bool</span> Is64Bit = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 64;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keyword">auto</span> Imm1Fn = Is64Bit ? selectShiftA_64(MO) : selectShiftA_32(MO);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keyword">auto</span> Imm2Fn = Is64Bit ? selectShiftB_64(MO) : selectShiftB_32(MO);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">if</span> (!Imm1Fn || !Imm2Fn)</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="keyword">auto</span> NewI =</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Is64Bit ? AArch64::UBFMXri : AArch64::UBFMWri,</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                     {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>()}, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>()});</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;RenderFn : *Imm1Fn)</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    RenderFn(NewI);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;RenderFn : *Imm2Fn)</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    RenderFn(NewI);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*NewI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;}</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::contractCrossBankCopyIntoStore(</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_STORE &amp;&amp; <span class="stringliteral">&quot;Expected G_STORE&quot;</span>);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="comment">// If we&#39;re storing a scalar, it doesn&#39;t matter what register bank that</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="comment">// scalar is on. All that matters is the size.</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="comment">// So, if we see something like this (with a 32-bit scalar as an example):</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="comment">// %x:gpr(s32) = ... something ...</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="comment">// %y:fpr(s32) = COPY %x:gpr(s32)</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="comment">// G_STORE %y:fpr(s32)</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="comment">// We can fix this up into something like this:</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="comment">// G_STORE %x:gpr(s32)</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <span class="comment">// And then continue the selection process normally.</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DefDstReg = <a class="code" href="AMDGPURegisterBankInfo_8cpp.html#af74ba83dde21c4eb9ced98ce5c77879f">getSrcRegIgnoringCopies</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <span class="keywordflow">if</span> (!DefDstReg.<a class="code" href="classllvm_1_1Register.html#a4a6966b99e305bd6f01fb17c645ae3da">isValid</a>())</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> DefDstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DefDstReg);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> StoreSrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> StoreSrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(StoreSrcReg);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <span class="comment">// If we get something strange like a physical register, then we shouldn&#39;t</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  <span class="comment">// go any further.</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <span class="keywordflow">if</span> (!DefDstTy.<a class="code" href="classllvm_1_1LLT.html#a69fb30748f1b3e8a0affd486a9f59f6d">isValid</a>())</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <span class="comment">// Are the source and dst types the same size?</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <span class="keywordflow">if</span> (DefDstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != StoreSrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>())</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="keywordflow">if</span> (RBI.getRegBank(StoreSrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) ==</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      RBI.getRegBank(DefDstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>))</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="comment">// We have a cross-bank copy, which is entering a store. Let&#39;s fold it.</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).setReg(DefDstReg);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;}</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::earlySelect(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent() &amp;&amp; <span class="stringliteral">&quot;Instruction should be in a basic block!&quot;</span>);</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()-&gt;getParent() &amp;&amp; <span class="stringliteral">&quot;Instruction should be in a function!&quot;</span>);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160; </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode()) {</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="keywordflow">case</span> AArch64::G_DUP: {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="comment">// Before selecting a DUP instruction, check if it is better selected as a</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="comment">// MOV or load from a constant pool.</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Src = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keyword">auto</span> ValAndVReg = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(Src, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="keywordflow">if</span> (!ValAndVReg)</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Ctx = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">getFunction</a>().<a class="code" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Dst = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keyword">auto</span> *CV = ConstantDataVector::getSplat(</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Dst).<a class="code" href="classllvm_1_1LLT.html#a71181d67d0bf68c3b8a535ec20463f90">getNumElements</a>(),</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(Type::getIntNTy(Ctx, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Src).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()),</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                         ValAndVReg-&gt;Value));</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">if</span> (!emitConstantVector(Dst, CV, MIB, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SEXT:</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="comment">// Check for i64 sext(i32 vector_extract) prior to tablegen to select SMOV</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="comment">// over a normal extend.</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordflow">if</span> (selectUSMovFromExtend(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BR:</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SHL:</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="keywordflow">return</span> earlySelectSHL(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_CONSTANT: {</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordtype">bool</span> IsZero = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).isCImm())</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      IsZero = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getCImm()-&gt;getZExtValue() == 0;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).isImm())</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      IsZero = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getImm() == 0;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">if</span> (!IsZero)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DefReg);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 64) {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).ChangeToRegister(AArch64::XZR, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      RBI.constrainGenericRegister(DefReg, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32) {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).ChangeToRegister(AArch64::WZR, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      RBI.constrainGenericRegister(DefReg, AArch64::GPR32RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::COPY));</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  }</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ADD: {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="comment">// Check if this is being fed by a G_ICMP on either side.</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <span class="comment">// (cmp pred, x, y) + z</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="comment">// In the above case, when the cmp is true, we increment z by 1. So, we can</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="comment">// fold the add into the cset for the cmp by using cinc.</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="comment">// FIXME: This would probably be a lot nicer in PostLegalizerLowering.</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> AddDst = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> AddLHS = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> AddRHS = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="comment">// Only handle scalars.</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(AddLHS);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="comment">// Since G_ICMP is modeled as ADDS/SUBS/ANDS, we can handle 32 bits or 64</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="comment">// bits.</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != 32 &amp;&amp; <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != 64)</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keyword">auto</span> MatchCmp = [&amp;](<a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>) -&gt; <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> * {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>))</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <span class="comment">// If the LHS of the add is 32 bits, then we want to fold a 32-bit</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <span class="comment">// compare.</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 32)</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_ICMP, <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="comment">// We model scalar compares using 32-bit destinations right now.</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="comment">// If it&#39;s a 64-bit compare, it&#39;ll have 64-bit sources.</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> ZExt;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">mi_match</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                    <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a702d2054c0a26eb2faf6375bb5e6d021">m_OneNonDBGUse</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a4270a5b1563f22920b7b0f053aee504f">m_GZExt</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a702d2054c0a26eb2faf6375bb5e6d021">m_OneNonDBGUse</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(ZExt))))))</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_ICMP, ZExt, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      <span class="keywordflow">if</span> (!Cmp ||</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;          <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(2).getReg()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 64)</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    };</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="comment">// Try to match</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="comment">// z + (cmp pred, x, y)</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = MatchCmp(AddRHS);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordflow">if</span> (!Cmp) {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <span class="comment">// (cmp pred, x, y) + z</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(AddLHS, AddRHS);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = MatchCmp(AddRHS);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="keywordflow">if</span> (!Cmp)</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    }</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keyword">auto</span> &amp;PredOp = <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(1);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keyword">auto</span> Pred = <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(PredOp.getPredicate());</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> InvCC =</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <a class="code" href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e">changeICMPPredToAArch64CC</a>(CmpInst::getInversePredicate(Pred));</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ab24db762f0912a99f1e4d9e44eaeaa44">setInstrAndDebugLoc</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    emitIntegerCompare(<span class="comment">/*LHS=*/</span><a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(2),</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                       <span class="comment">/*RHS=*/</span><a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(3), PredOp, MIB);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    emitCSINC(<span class="comment">/*Dst=*/</span>AddDst, <span class="comment">/*Src =*/</span>AddLHS, <span class="comment">/*Src2=*/</span>AddLHS, InvCC, MIB);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  }</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_OR: {</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <span class="comment">// Look for operations that take the lower `Width=Size-ShiftImm` bits of</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="comment">// `ShiftSrc` and insert them into the upper `Width` bits of `MaskSrc` via</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="comment">// shifting and masking that we can replace with a BFI (encoded as a BFM).</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Dst = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Dst);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keywordflow">if</span> (!Ty.<a class="code" href="classllvm_1_1LLT.html#a3989251b1a714fc8296685f77eac6e87">isScalar</a>())</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; </div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != 32 &amp;&amp; <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != 64)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> ShiftSrc;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    int64_t ShiftImm;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> MaskSrc;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    int64_t MaskImm;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">mi_match</a>(</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            Dst, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a59b9fb63d37c3093adb39e83de07c3b7">m_GOr</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a702d2054c0a26eb2faf6375bb5e6d021">m_OneNonDBGUse</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a29f921516cedd7d3fde9f5adb45a46cd">m_GShl</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(ShiftSrc), <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a316dd9aa25d9ec9d6d21b56e4296e824">m_ICst</a>(ShiftImm))),</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                  <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a702d2054c0a26eb2faf6375bb5e6d021">m_OneNonDBGUse</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a517d7405576d9e17b44314a408e92cc0">m_GAnd</a>(<a class="code" href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">m_Reg</a>(MaskSrc), <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a316dd9aa25d9ec9d6d21b56e4296e824">m_ICst</a>(MaskImm))))))</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160; </div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="keywordflow">if</span> (ShiftImm &gt; <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> || ((1ULL &lt;&lt; ShiftImm) - 1ULL) != <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a>(MaskImm))</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; </div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    int64_t Immr = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> - ShiftImm;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    int64_t Imms = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> - ShiftImm - 1;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="keywordtype">unsigned</span> Opc = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 32 ? AArch64::BFMWri : AArch64::BFMXri;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    emitInstr(Opc, {Dst}, {MaskSrc, ShiftSrc, Immr, Imms}, MIB);</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_FENCE: {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getImm() == 0)</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MIMetadata.html">MIMetadata</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a369074e730a24fabb4216cd37e789e35">TargetOpcode::MEMBARRIER</a>));</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MIMetadata.html">MIMetadata</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::DMB))</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getImm() == 4 ? 0x9 : 0xb);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;}</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160; </div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="README-SSE_8txt.html#a9fb6cbbc77fb02ab3a51b0660bd09909">AArch64InstructionSelector::select</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent() &amp;&amp; <span class="stringliteral">&quot;Instruction should be in a basic block!&quot;</span>);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()-&gt;getParent() &amp;&amp; <span class="stringliteral">&quot;Instruction should be in a function!&quot;</span>);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a> *Subtarget = &amp;MF.<a class="code" href="classllvm_1_1MachineFunction.html#a325f6b611ef9ec06798d3b4eb9572093">getSubtarget</a>&lt;<a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a>&gt;();</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="keywordflow">if</span> (Subtarget-&gt;requiresStrictAlign()) {</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="comment">// We don&#39;t support this feature yet.</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;AArch64 GISel does not support strict-align yet\n&quot;</span>);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ab24db762f0912a99f1e4d9e44eaeaa44">setInstrAndDebugLoc</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode();</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="comment">// G_PHI requires same handling as PHI</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isPreISelOpcode() || Opcode == TargetOpcode::G_PHI) {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="comment">// Certain non-generic instructions also need some special handling.</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordflow">if</span> (Opcode ==  TargetOpcode::LOAD_STACK_GUARD)</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="keywordflow">if</span> (Opcode == <a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">TargetOpcode::PHI</a> || Opcode == TargetOpcode::G_PHI) {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DefTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DefReg);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1PointerUnion.html">RegClassOrRegBank</a> &amp;RegClassOrBank =</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a68db11947d61455d62d75b86020362c9">getRegClassOrRegBank</a>(DefReg);</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DefRC</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        = RegClassOrBank.<a class="code" href="classllvm_1_1PointerUnion.html#a9147352f78d98ee246f25d3300e0aaba">dyn_cast</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *&gt;();</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      <span class="keywordflow">if</span> (!DefRC) {</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="keywordflow">if</span> (!DefTy.<a class="code" href="classllvm_1_1LLT.html#a69fb30748f1b3e8a0affd486a9f59f6d">isValid</a>()) {</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;PHI operand has no type, not a gvreg?\n&quot;</span>);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;        }</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RegClassOrBank.<a class="code" href="classllvm_1_1PointerUnion.html#a47a37d4a29c6d015b0ec9b0e722110fe">get</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> *&gt;();</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        DefRC = getRegClassForTypeOnBank(DefTy, RB);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="keywordflow">if</span> (!DefRC) {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;PHI operand has unexpected size/bank\n&quot;</span>);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(<a class="code" href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">TargetOpcode::PHI</a>));</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160; </div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      <span class="keywordflow">return</span> RBI.constrainGenericRegister(DefReg, *DefRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    }</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160; </div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isCopy())</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; </div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isDebugInstr())</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#ab328c242b91fe2bc4d6d0797761fdea1">selectDebugInstr</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, RBI);</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  }</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; </div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; </div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumOperands() != <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumExplicitOperands()) {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Generic instruction has unexpected implicit operands\n&quot;</span>);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  }</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="comment">// Try to do some lowering before we start instruction selecting. These</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="comment">// lowerings are purely transformations on the input G_MIR and so selection</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <span class="comment">// must continue after any modification of the instruction.</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <span class="keywordflow">if</span> (preISelLower(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    Opcode = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode(); <span class="comment">// The opcode may have been modified, refresh it.</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  <span class="comment">// There may be patterns where the importer can&#39;t deal with them optimally,</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">// but does select it to a suboptimal sequence so our custom C++ selection</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">// code later never has a chance to work on it. Therefore, we have an early</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="comment">// selection attempt here to give priority to certain selection routines</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <span class="comment">// over the imported ones.</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <span class="keywordflow">if</span> (earlySelect(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1mca.html#a9daeae4f77bbf637d7f5ed46c92ed5c5">selectImpl</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *CoverageInfo))</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty =</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).isReg() ? <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg()) : <a class="code" href="classllvm_1_1LLT.html">LLT</a>{};</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <span class="keywordflow">switch</span> (Opcode) {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SBFX:</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_UBFX: {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpcTable[2][2] = {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        {AArch64::UBFMWri, AArch64::UBFMXri},</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        {AArch64::SBFMWri, AArch64::SBFMXri}};</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordtype">bool</span> IsSigned = Opcode == TargetOpcode::G_SBFX;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordtype">unsigned</span> Opc = OpcTable[IsSigned][<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 64];</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    <span class="keyword">auto</span> Cst1 =</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Cst1 &amp;&amp; <span class="stringliteral">&quot;Should have gotten a constant for src 1?&quot;</span>);</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="keyword">auto</span> Cst2 =</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Cst2 &amp;&amp; <span class="stringliteral">&quot;Should have gotten a constant for src 2?&quot;</span>);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="keyword">auto</span> LSB = Cst1-&gt;Value.getZExtValue();</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> = Cst2-&gt;Value.getZExtValue();</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="keyword">auto</span> BitfieldInst =</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)}, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1)})</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            .addImm(LSB)</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(LSB + <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> - 1);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*BitfieldInst, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  }</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BRCOND:</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">return</span> selectCompareBranch(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, MF, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BRINDIRECT: {</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">AArch64::BR</a>));</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  }</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160; </div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BRJT:</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <span class="keywordflow">return</span> selectBrJT(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160; </div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <span class="keywordflow">case</span> AArch64::G_ADD_LOW: {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <span class="comment">// This op may have been separated from it&#39;s ADRP companion by the localizer</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <span class="comment">// or some other code motion pass. Given that many CPUs will try to</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="comment">// macro fuse these operations anyway, select this into a MOVaddr pseudo</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="comment">// which will later be expanded into an ADRP+ADD pair after scheduling.</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *BaseMI = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="keywordflow">if</span> (BaseMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() != <a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19aa2e9d9d7c30818fd5ba551f8d3f0af34">AArch64::ADRP</a>) {</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::ADDXri));</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.addOperand(MachineOperand::CreateImm(0));</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>.getCodeModel() == <a class="code" href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfaa2554ef60dc191c6005ba9eecbc9aea0">CodeModel::Small</a> &amp;&amp;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;           <span class="stringliteral">&quot;Expected small code model&quot;</span>);</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="keyword">auto</span> Op1 = BaseMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="keyword">auto</span> Op2 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2);</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="keyword">auto</span> MovAddr = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::MOVaddr, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)}, {})</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                       .addGlobalAddress(Op1.getGlobal(), Op1.getOffset(),</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                                         Op1.getTargetFlags())</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                       .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a3fba722f44bac58d79e82bd232525152">addGlobalAddress</a>(Op2.getGlobal(), Op2.getOffset(),</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                                         Op2.getTargetFlags());</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*MovAddr, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  }</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BSWAP: {</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="comment">// Handle vector types for G_BSWAP directly.</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160; </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="comment">// We should only get vector types here; everything else is handled by the</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="comment">// importer right now.</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="keywordflow">if</span> (!DstTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() || DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; 128) {</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Dst type for G_BSWAP currently unsupported.\n&quot;</span>);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; </div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <span class="comment">// Only handle 4 and 2 element vectors for now.</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="comment">// TODO: 16-bit elements.</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    <span class="keywordtype">unsigned</span> NumElts = DstTy.<a class="code" href="classllvm_1_1LLT.html#a71181d67d0bf68c3b8a535ec20463f90">getNumElements</a>();</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    <span class="keywordflow">if</span> (NumElts != 4 &amp;&amp; NumElts != 2) {</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unsupported number of elements for G_BSWAP.\n&quot;</span>);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="comment">// Choose the correct opcode for the supported types. Right now, that&#39;s</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="comment">// v2s32, v4s32, and v2s64.</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="keywordtype">unsigned</span> EltSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="keywordflow">if</span> (EltSize == 32)</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      Opc = (DstTy.<a class="code" href="classllvm_1_1LLT.html#a71181d67d0bf68c3b8a535ec20463f90">getNumElements</a>() == 2) ? AArch64::REV32v8i8</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                                          : AArch64::REV32v16i8;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EltSize == 64)</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      Opc = AArch64::REV64v16i8;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="comment">// We should always get something by the time we get here...</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Opc != 0 &amp;&amp; <span class="stringliteral">&quot;Didn&#39;t get an opcode for G_BSWAP?&quot;</span>);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160; </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(Opc));</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;  }</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160; </div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_FCONSTANT:</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_CONSTANT: {</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> isFP = Opcode == TargetOpcode::G_FCONSTANT;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160; </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> s8 = LLT::scalar(8);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> s16 = LLT::scalar(16);</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> s32 = LLT::scalar(32);</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> s64 = LLT::scalar(64);</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> s128 = LLT::scalar(128);</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> p0 = <a class="code" href="AMDGPUReplaceLDSUseWithPointer_8cpp.html#a9c3943160b95cc42ca8f6e04e6d4e9b6">LLT::pointer</a>(0, 64);</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160; </div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DefTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DefReg);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> DefSize = DefTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RBI.getRegBank(DefReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160; </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <span class="comment">// FIXME: Redundant check, but even less readable when factored out.</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordflow">if</span> (isFP) {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      <span class="keywordflow">if</span> (Ty != s16 &amp;&amp; Ty != s32 &amp;&amp; Ty != s64 &amp;&amp; Ty != s128) {</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unable to materialize FP &quot;</span> &lt;&lt; Ty</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; constant, expected: &quot;</span> &lt;&lt; s16 &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt; s32</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt; s64 &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt; s128 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      }</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160; </div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() != AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unable to materialize FP &quot;</span> &lt;&lt; Ty</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; constant on bank: &quot;</span> &lt;&lt; RB</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;, expected: FPR\n&quot;</span>);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      }</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160; </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      <span class="comment">// The case when we have 0.0 is covered by tablegen. Reject it here so we</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <span class="comment">// can be sure tablegen works correctly and isn&#39;t rescued by this code.</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <span class="comment">// 0.0 is not covered by tablegen for FP128. So we will handle this</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <span class="comment">// scenario in the code here.</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="keywordflow">if</span> (DefSize != 128 &amp;&amp; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getFPImm()-&gt;isExactlyValue(0.0))</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="comment">// s32 and s64 are covered by tablegen.</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="keywordflow">if</span> (Ty != p0 &amp;&amp; Ty != s8 &amp;&amp; Ty != s16) {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unable to materialize integer &quot;</span> &lt;&lt; Ty</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; constant, expected: &quot;</span> &lt;&lt; s32 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; s64</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;, or &quot;</span> &lt;&lt; p0 &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      }</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() != AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unable to materialize integer &quot;</span> &lt;&lt; Ty</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; constant on bank: &quot;</span> &lt;&lt; RB</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;, expected: GPR\n&quot;</span>);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      }</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; </div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="keywordflow">if</span> (isFP) {</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> &amp;FPRRC = *getRegClassForTypeOnBank(DefTy, RB);</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <span class="comment">// For 16, 64, and 128b values, emit a constant pool load.</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="keywordflow">switch</span> (DefSize) {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected destination size for G_FCONSTANT?&quot;</span>);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        <span class="comment">// For s32, use a cp load if we have optsize/minsize.</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a5bd19c94d27d32e7949345b46171ed20">shouldOptForSize</a>(&amp;MF))</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        [[fallthrough]];</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;      <span class="keywordflow">case</span> 128: {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;        <span class="keyword">auto</span> *FPImm = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getFPImm();</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        <span class="keyword">auto</span> *LoadMI = emitLoadFromConstantPool(FPImm, MIB);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        <span class="keywordflow">if</span> (!LoadMI) {</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to load double constant pool entry\n&quot;</span>);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({DefReg}, {LoadMI-&gt;getOperand(0).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>()});</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <span class="keywordflow">return</span> RBI.constrainGenericRegister(DefReg, FPRRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      }</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      }</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160; </div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      <span class="comment">// Either emit a FMOV, or emit a copy to emit a normal mov.</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DefSize == 32 &amp;&amp;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;             <span class="stringliteral">&quot;Expected constant pool loads for all sizes other than 32!&quot;</span>);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DefGPRReg =</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;          <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR32RegClass);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;RegOp = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0);</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      RegOp.<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(DefGPRReg);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a0df93c0f752428162e14b54f8999172d">setInsertPt</a>(MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a448a4aa9f90dbde0f77fae45b1625d88">getMBB</a>(), std::next(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getIterator()));</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({DefReg}, {DefGPRReg});</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160; </div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <span class="keywordflow">if</span> (!RBI.constrainGenericRegister(DefReg, FPRRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to constrain G_FCONSTANT def operand\n&quot;</span>);</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      }</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160; </div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;ImmOp = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <span class="comment">// FIXME: Is going through int64_t always correct?</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      ImmOp.<a class="code" href="classllvm_1_1MachineOperand.html#a7b39ecfd6793534206dbb095b0d464c7">ChangeToImmediate</a>(</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;          ImmOp.<a class="code" href="classllvm_1_1MachineOperand.html#a878403638ab65500c736343a57678bdb">getFPImm</a>()-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a7faf4e0334b77ab527e4b45e3a1f4d65">getValueAPF</a>().<a class="code" href="classllvm_1_1APFloat.html#a9c5a2112c559ffbe2c7bbf5698b6482f">bitcastToAPInt</a>().<a class="code" href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>());</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).isCImm()) {</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Val = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getCImm()-&gt;getZExtValue();</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).ChangeToImmediate(Val);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).isImm()) {</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Val = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getImm();</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).ChangeToImmediate(Val);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160; </div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> MovOpc =</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        DefSize == 64 ? AArch64::MOVi64imm : AArch64::MOVi32imm;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(MovOpc));</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  }</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_EXTRACT: {</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    (void)DstTy;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keywordtype">unsigned</span> SrcSize = SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160; </div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">if</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; 64) {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="comment">// This should be an extract of an s128, which is like a vector extract.</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      <span class="keywordflow">if</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 128)</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      <span class="comment">// Only support extracting 64 bits from an s128 at the moment.</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      <span class="keywordflow">if</span> (DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 64)</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160; </div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getImm();</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> % 64 != 0)</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      <span class="comment">// Check we have the right regbank always.</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;SrcRB = *RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB = *RBI.getRegBank(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SrcRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == DstRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() &amp;&amp; <span class="stringliteral">&quot;Wrong extract regbank!&quot;</span>);</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="keywordflow">if</span> (SrcRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        <span class="keyword">auto</span> NewI =</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {DstReg}, {})</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                .addUse(SrcReg, 0,</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                        <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> == 0 ? AArch64::sube64 : AArch64::subo64);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        <a class="code" href="namespacellvm.html#a0de00f38864016881b1182ebac4b7b30">constrainOperandRegClass</a>(MF, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, RBI, *NewI,</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                                 AArch64::GPR64RegClass, NewI-&gt;getOperand(0));</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      }</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160; </div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      <span class="comment">// Emit the same code as a vector extract.</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="comment">// Offset must be a multiple of 64.</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <span class="keywordtype">unsigned</span> LaneIdx = <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> / 64;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *Extract = emitExtractVectorElt(</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;          DstReg, DstRB, LLT::scalar(64), SrcReg, LaneIdx, MIB);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <span class="keywordflow">if</span> (!Extract)</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    }</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160; </div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(SrcSize == 64 ? AArch64::UBFMXri : AArch64::UBFMWri));</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a>(MF, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getImm() +</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                                      Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() - 1);</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160; </div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <span class="keywordflow">if</span> (SrcSize &lt; 64) {</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SrcSize == 32 &amp;&amp; DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 16 &amp;&amp;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;             <span class="stringliteral">&quot;unexpected G_EXTRACT types&quot;</span>);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; </div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    DstReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a9694f2906cfe1d6d35bbe6742c67dff0">createGenericVirtualRegister</a>(LLT::scalar(64));</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a0df93c0f752428162e14b54f8999172d">setInsertPt</a>(MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a448a4aa9f90dbde0f77fae45b1625d88">getMBB</a>(), std::next(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getIterator()));</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>()}, {})</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        .addReg(DstReg, 0, AArch64::sub_32);</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    RBI.constrainGenericRegister(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(),</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                                 AArch64::GPR32RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).setReg(DstReg);</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160; </div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;  }</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160; </div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_INSERT: {</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg());</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="keywordtype">unsigned</span> DstSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="comment">// Larger inserts are vectors, same-size ones should be something else by</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="comment">// now (split up or turned into COPYs).</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; 64 || SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; 32)</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160; </div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(DstSize == 64 ? AArch64::BFMXri : AArch64::BFMWri));</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <span class="keywordtype">unsigned</span> LSB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getImm();</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).setImm((DstSize - LSB) % DstSize);</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a>(MF, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> - 1);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160; </div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <span class="keywordflow">if</span> (DstSize &lt; 64) {</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstSize == 32 &amp;&amp; SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 16 &amp;&amp;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;             <span class="stringliteral">&quot;unexpected G_INSERT types&quot;</span>);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    }</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a9694f2906cfe1d6d35bbe6742c67dff0">createGenericVirtualRegister</a>(LLT::scalar(64));</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getIterator(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(),</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::SUBREG_TO_REG))</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(SrcReg)</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg())</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    RBI.constrainGenericRegister(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg(),</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                                 AArch64::GPR32RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).setReg(SrcReg);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160; </div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  }</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_FRAME_INDEX: {</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="comment">// allocas and G_FRAME_INDEX are only supported in addrspace(0).</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="keywordflow">if</span> (Ty != <a class="code" href="AMDGPUReplaceLDSUseWithPointer_8cpp.html#a9c3943160b95cc42ca8f6e04e6d4e9b6">LLT::pointer</a>(0, 64)) {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_FRAME_INDEX pointer has type: &quot;</span> &lt;&lt; Ty</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, expected: &quot;</span> &lt;&lt; <a class="code" href="AMDGPUReplaceLDSUseWithPointer_8cpp.html#a9c3943160b95cc42ca8f6e04e6d4e9b6">LLT::pointer</a>(0, 64) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    }</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::ADDXri));</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160; </div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="comment">// MOs for a #0 shifted immediate.</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.addOperand(MachineOperand::CreateImm(0));</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.addOperand(MachineOperand::CreateImm(0));</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160; </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  }</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_GLOBAL_VALUE: {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    <span class="keyword">auto</span> GV = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getGlobal();</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">if</span> (GV-&gt;isThreadLocal())</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">return</span> selectTLSGlobalValue(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keywordtype">unsigned</span> OpFlags = STI.ClassifyGlobalReference(GV, <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="keywordflow">if</span> (OpFlags &amp; <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a4144c2ee93286fba09bd8f14fb11f27a">AArch64II::MO_GOT</a>) {</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(<a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19adfb5f0cc680a060e5ca88e6e923d7183">AArch64::LOADgot</a>));</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).setTargetFlags(OpFlags);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>.getCodeModel() == <a class="code" href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfa5208f558fccf9f63423fb5385bb3e75c">CodeModel::Large</a>) {</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="comment">// Materialize the global using movz/movk instructions.</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      materializeLargeCMVal(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, GV, OpFlags);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>.getCodeModel() == <a class="code" href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfa686bcdfaefdfe3f49acbfe6f680bc22d">CodeModel::Tiny</a>) {</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(<a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19a8ee06ddad96ab8a83a8513e4b5b49717">AArch64::ADR</a>));</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).setTargetFlags(OpFlags);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::MOVaddr));</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).setTargetFlags(OpFlags | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a7f04634c15a04a59d5f234002e613b5b">AArch64II::MO_PAGE</a>);</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIB(MF, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      MIB.addGlobalAddress(GV, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getOffset(),</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                           OpFlags | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a3a5053185998bdf24f3167c234915785">AArch64II::MO_PAGEOFF</a> | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a>);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    }</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  }</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ZEXTLOAD:</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_LOAD:</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_STORE: {</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <a class="code" href="classllvm_1_1GLoadStore.html">GLoadStore</a> &amp;LdSt = cast&lt;GLoadStore&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="keywordtype">bool</span> IsZExtLoad = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_ZEXTLOAD;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> PtrTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a0a7fb170c5d3165c1a9f3cf5fee5b4ca">getPointerReg</a>());</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160; </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="keywordflow">if</span> (PtrTy != <a class="code" href="AMDGPUReplaceLDSUseWithPointer_8cpp.html#a9c3943160b95cc42ca8f6e04e6d4e9b6">LLT::pointer</a>(0, 64)) {</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Load/Store pointer has type: &quot;</span> &lt;&lt; PtrTy</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, expected: &quot;</span> &lt;&lt; <a class="code" href="AMDGPUReplaceLDSUseWithPointer_8cpp.html#a9c3943160b95cc42ca8f6e04e6d4e9b6">LLT::pointer</a>(0, 64) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    }</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160; </div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> MemSizeInBytes = LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a1833a6824522ac00595a007393c73f61">getMemSize</a>();</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="keywordtype">unsigned</span> MemSizeInBits = LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a7a93f7892da9c7831d18671d864d9404">getMemSizeInBits</a>();</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <a class="code" href="namespacellvm.html#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> Order = LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a2aaf791aa3564d53adefabc2e145234c">getMMO</a>().<a class="code" href="classllvm_1_1MachineMemOperand.html#aaa45abfa63d76025a0e5b9a46e25dd8d">getSuccessOrdering</a>();</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160; </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="comment">// Need special instructions for atomics that affect ordering.</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">if</span> (Order != AtomicOrdering::NotAtomic &amp;&amp;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        Order != <a class="code" href="README__P9_8txt.html#a0afe4617fad145d6ced5a18fd739cf06">AtomicOrdering::Unordered</a> &amp;&amp;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        Order != AtomicOrdering::Monotonic) {</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!isa&lt;GZExtLoad&gt;(LdSt));</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="keywordflow">if</span> (MemSizeInBytes &gt; 64)</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160; </div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      <span class="keywordflow">if</span> (isa&lt;GLoad&gt;(LdSt)) {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> LDAPROpcodes[] = {</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            AArch64::LDAPRB, AArch64::LDAPRH, AArch64::LDAPRW, AArch64::LDAPRX};</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> LDAROpcodes[] = {</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;            AArch64::LDARB, AArch64::LDARH, AArch64::LDARW, AArch64::LDARX};</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;unsigned&gt;</a> Opcodes =</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;            STI.hasRCPC() &amp;&amp; Order != AtomicOrdering::SequentiallyConsistent</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                ? LDAPROpcodes</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                : LDAROpcodes;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(Opcodes[<a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(MemSizeInBytes)]));</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> Opcodes[] = {AArch64::STLRB, AArch64::STLRH,</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                                               AArch64::STLRW, AArch64::STLRX};</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        <a class="code" href="classllvm_1_1Register.html">Register</a> ValReg = LdSt.<a class="code" href="classllvm_1_1GenericMachineInstr.html#a2cdf10ff4f5fb865c6a669331aeb5846">getReg</a>(0);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(ValReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 64 &amp;&amp; MemSizeInBits != 64) {</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;          <span class="comment">// Emit a subreg copy of 32 bits.</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;          <a class="code" href="classllvm_1_1Register.html">Register</a> NewVal = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR32RegClass);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;          MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {NewVal}, {})</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;              .addReg(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), 0, AArch64::sub_32);</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;          <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).setReg(NewVal);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        }</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(Opcodes[<a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(MemSizeInBytes)]));</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    }</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160; </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> PtrReg = LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a0a7fb170c5d3165c1a9f3cf5fee5b4ca">getPointerReg</a>();</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;PtrRB = *RBI.getRegBank(PtrReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="comment">// Check that the pointer register is valid.</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PtrRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::GPRRegBankID &amp;&amp;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;           <span class="stringliteral">&quot;Load/Store pointer operand isn&#39;t a GPR&quot;</span>);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(PtrReg).<a class="code" href="classllvm_1_1LLT.html#a9d825f5954d7bd527aea490668c624c6">isPointer</a>() &amp;&amp;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;           <span class="stringliteral">&quot;Load/Store pointer operand isn&#39;t a pointer&quot;</span>);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160; </div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> ValReg = LdSt.<a class="code" href="classllvm_1_1GenericMachineInstr.html#a2cdf10ff4f5fb865c6a669331aeb5846">getReg</a>(0);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> ValTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(ValReg);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RBI.getRegBank(ValReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160; </div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="comment">// The code below doesn&#39;t support truncating stores, so we need to split it</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="comment">// again.</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="keywordflow">if</span> (isa&lt;GStore&gt;(LdSt) &amp;&amp; ValTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; MemSizeInBits) {</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;      <a class="code" href="classllvm_1_1LLT.html">LLT</a> MemTy = LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a2aaf791aa3564d53adefabc2e145234c">getMMO</a>().<a class="code" href="classllvm_1_1MachineMemOperand.html#a3e9d2a9063bce7f5b3d7dd21fd05c79d">getMemoryType</a>();</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;      <span class="keyword">auto</span> *RC = getRegClassForTypeOnBank(MemTy, RB);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(RC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>))</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160; </div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;      <span class="comment">// Generate a subreg copy.</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {MemTy}, {})</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                      .addReg(ValReg, 0, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>)</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1c5fadb14ff1d77faad0cb58a43252ab">getReg</a>(0);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;      RBI.constrainGenericRegister(Copy, *RC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      LdSt.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(Copy);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isa&lt;GLoad&gt;(LdSt) &amp;&amp; ValTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; MemSizeInBits) {</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;      <span class="comment">// If this is an any-extending load from the FPR bank, split it into a regular</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;      <span class="comment">// load + extend.</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;      <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        <a class="code" href="classllvm_1_1LLT.html">LLT</a> MemTy = LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a2aaf791aa3564d53adefabc2e145234c">getMMO</a>().<a class="code" href="classllvm_1_1MachineMemOperand.html#a3e9d2a9063bce7f5b3d7dd21fd05c79d">getMemoryType</a>();</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;        <span class="keyword">auto</span> *RC = getRegClassForTypeOnBank(MemTy, RB);</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(RC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>))</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        <a class="code" href="classllvm_1_1Register.html">Register</a> OldDst = LdSt.<a class="code" href="classllvm_1_1GenericMachineInstr.html#a2cdf10ff4f5fb865c6a669331aeb5846">getReg</a>(0);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;        <a class="code" href="classllvm_1_1Register.html">Register</a> NewDst =</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;            <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a9694f2906cfe1d6d35bbe6742c67dff0">createGenericVirtualRegister</a>(LdSt.<a class="code" href="classllvm_1_1GLoadStore.html#a2aaf791aa3564d53adefabc2e145234c">getMMO</a>().<a class="code" href="classllvm_1_1MachineMemOperand.html#a3e9d2a9063bce7f5b3d7dd21fd05c79d">getMemoryType</a>());</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        LdSt.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(NewDst);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a81763ced27ec9b0c42f8848f4ebe5bd1">setRegBank</a>(NewDst, RB);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        <span class="comment">// Generate a SUBREG_TO_REG to extend it.</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a0df93c0f752428162e14b54f8999172d">setInsertPt</a>(MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a448a4aa9f90dbde0f77fae45b1625d88">getMBB</a>(), std::next(LdSt.<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>()));</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SUBREG_TO_REG, {OldDst}, {})</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;            .addImm(0)</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(NewDst)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        <span class="keyword">auto</span> SubRegRC = getRegClassForTypeOnBank(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(OldDst), RB);</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        RBI.constrainGenericRegister(OldDst, *SubRegRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a4cac2a17ab11d53dd0a49871b80f5c7a">setInstr</a>(LdSt);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      }</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    }</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160; </div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <span class="comment">// Helper lambda for partially selecting I. Either returns the original</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <span class="comment">// instruction with an updated opcode, or a new instruction.</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    <span class="keyword">auto</span> SelectLoadStoreAddressingMode = [&amp;]() -&gt; <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> * {</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      <span class="keywordtype">bool</span> IsStore = isa&lt;GStore&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NewOpc =</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;          <a class="code" href="AArch64InstructionSelector_8cpp.html#a61d01252826372b1ec3aefc12e0c23d1">selectLoadStoreUIOp</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode(), RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>(), MemSizeInBits);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      <span class="keywordflow">if</span> (NewOpc == <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode())</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      <span class="comment">// Check if we can fold anything into the addressing mode.</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      <span class="keyword">auto</span> AddrModeFns =</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;          selectAddrModeIndexed(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1), MemSizeInBytes);</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <span class="keywordflow">if</span> (!AddrModeFns) {</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        <span class="comment">// Can&#39;t fold anything. Use the original instruction.</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(NewOpc));</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.addOperand(MachineOperand::CreateImm(0));</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="keywordflow">return</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      }</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160; </div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <span class="comment">// Folded something. Create a new instruction and return it.</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      <span class="keyword">auto</span> NewInst = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(NewOpc, {}, {}, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getFlags());</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> CurValReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      IsStore ? NewInst.addUse(CurValReg) : NewInst.addDef(CurValReg);</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      NewInst.cloneMemRefs(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Fn : *AddrModeFns)</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        Fn(NewInst);</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">return</span> &amp;*NewInst;</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    };</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160; </div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a> = SelectLoadStoreAddressingMode();</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>)</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160; </div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <span class="comment">// If we&#39;re storing a 0, use WZR/XZR.</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    <span class="keywordflow">if</span> (Opcode == TargetOpcode::G_STORE) {</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      <span class="keyword">auto</span> CVal = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;          <a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getOperand(0).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      <span class="keywordflow">if</span> (CVal &amp;&amp; CVal-&gt;Value == 0) {</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getOpcode()) {</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        <span class="keywordflow">case</span> AArch64::STRWui:</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <span class="keywordflow">case</span> AArch64::STRHHui:</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;        <span class="keywordflow">case</span> AArch64::STRBBui:</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;          <a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getOperand(0).setReg(AArch64::WZR);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        <span class="keywordflow">case</span> AArch64::STRXui:</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;          <a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getOperand(0).setReg(AArch64::XZR);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;      }</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    }</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160; </div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="keywordflow">if</span> (IsZExtLoad) {</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      <span class="comment">// The zextload from a smaller type to i32 should be handled by the</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      <span class="comment">// importer.</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getOperand(0).getReg()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 64)</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <span class="comment">// If we have a ZEXTLOAD then change the load&#39;s type to be a narrower reg</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      <span class="comment">// and zero_extend with SUBREG_TO_REG.</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> LdReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR32RegClass);</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getOperand(0).getReg();</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      <a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getOperand(0).setReg(LdReg);</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160; </div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a0df93c0f752428162e14b54f8999172d">setInsertPt</a>(MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a448a4aa9f90dbde0f77fae45b1625d88">getMBB</a>(), std::next(<a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>-&gt;getIterator()));</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SUBREG_TO_REG, {DstReg}, {})</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;          .addImm(0)</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(LdReg)</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="keywordflow">return</span> RBI.constrainGenericRegister(DstReg, AArch64::GPR64allRegClass,</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                                          <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">LoadStore</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;  }</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160; </div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SMULH:</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_UMULH: {</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <span class="comment">// Reject the various things we don&#39;t support yet.</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64InstructionSelector_8cpp.html#ac3419b7821dce4fc2e3a6f4a96b7dbaa">unsupportedBinOp</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, RBI, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>))</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160; </div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RBI.getRegBank(DefReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160; </div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() != AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_[SU]MULH on bank: &quot;</span> &lt;&lt; RB &lt;&lt; <span class="stringliteral">&quot;, expected: GPR\n&quot;</span>);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    }</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160; </div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="keywordflow">if</span> (Ty != LLT::scalar(64)) {</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_[SU]MULH has type: &quot;</span> &lt;&lt; Ty</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, expected: &quot;</span> &lt;&lt; LLT::scalar(64) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    }</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; </div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="keywordtype">unsigned</span> NewOpc = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_SMULH ? AArch64::SMULHrr</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                                                             : AArch64::UMULHrr;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(NewOpc));</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160; </div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    <span class="comment">// Now that we selected an opcode, we need to constrain the register</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <span class="comment">// operands to use appropriate classes.</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  }</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_LSHR:</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ASHR:</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg()).<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      <span class="keywordflow">return</span> selectVectorAshrLshr(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    [[fallthrough]];</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SHL:</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="keywordflow">if</span> (Opcode == TargetOpcode::G_SHL &amp;&amp;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg()).<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keywordflow">return</span> selectVectorSHL(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160; </div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <span class="comment">// These shifts were legalized to have 64 bit shift amounts because we</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="comment">// want to take advantage of the selection patterns that assume the</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <span class="comment">// immediates are s64s, however, selectBinaryOp will assume both operands</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="comment">// will have the same bit size.</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    {</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> ShiftReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> ShiftTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(ShiftReg);</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;      <span class="keywordflow">if</span> (!SrcTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32 &amp;&amp;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;          ShiftTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 64) {</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!ShiftTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;unexpected vector shift ty&quot;</span>);</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <span class="comment">// Insert a subregister copy to implement a 64-&gt;32 trunc</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        <span class="keyword">auto</span> Trunc = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {SrcTy}, {})</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;                         .addReg(ShiftReg, 0, AArch64::sub_32);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a81763ced27ec9b0c42f8848f4ebe5bd1">setRegBank</a>(Trunc.getReg(0), RBI.getRegBank(AArch64::GPRRegBankID));</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).setReg(Trunc.getReg(0));</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      }</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    }</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    [[fallthrough]];</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_OR: {</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="comment">// Reject the various things we don&#39;t support yet.</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64InstructionSelector_8cpp.html#ac3419b7821dce4fc2e3a6f4a96b7dbaa">unsupportedBinOp</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, RBI, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>))</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160; </div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpSize = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; </div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RBI.getRegBank(DefReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160; </div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NewOpc = <a class="code" href="AArch64InstructionSelector_8cpp.html#a8e3929f9a80e9ff6d48e35bba3e2d600">selectBinaryOp</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode(), RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>(), OpSize);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">if</span> (NewOpc == <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode())</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(NewOpc));</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    <span class="comment">// FIXME: Should the type be always reset in setDesc?</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160; </div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    <span class="comment">// Now that we selected an opcode, we need to constrain the register</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <span class="comment">// operands to use appropriate classes.</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  }</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_PTR_ADD: {</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    emitADD(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2), MIB);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  }</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SADDO:</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_UADDO:</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SSUBO:</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_USUBO: {</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    <span class="comment">// Emit the operation and get the correct condition code.</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="keyword">auto</span> OpAndCC = emitOverflowOp(Opcode, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(),</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                                  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3), MIB);</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160; </div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    <span class="comment">// Now, put the overflow result in the register given by the first operand</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <span class="comment">// to the overflow op. CSINC increments the result when the predicate is</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    <span class="comment">// false, so to get the increment when it&#39;s true, we need to use the</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="comment">// inverse. In this case, we want to increment when carry is set.</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> ZReg = AArch64::WZR;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    emitCSINC(<span class="comment">/*Dst=*/</span><a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg(), <span class="comment">/*Src1=*/</span>ZReg, <span class="comment">/*Src2=*/</span>ZReg,</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;              <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">getInvertedCondCode</a>(OpAndCC.second), MIB);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  }</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160; </div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_PTRMASK: {</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> MaskReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    std::optional&lt;int64_t&gt; MaskVal = <a class="code" href="namespacellvm.html#a56f5d55460d7e31fc6c3318882f36ac7">getIConstantVRegSExtVal</a>(MaskReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="comment">// TODO: Implement arbitrary cases</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="keywordflow">if</span> (!MaskVal || !<a class="code" href="namespacellvm.html#a582e08755c7a8d1b0bf6c5dcb765aaa8">isShiftedMask_64</a>(*MaskVal))</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160; </div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = *MaskVal;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::ANDXri));</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).ChangeToImmediate(</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        <a class="code" href="namespacellvm_1_1AArch64__AM.html#a832ad315a355f4ddcc32f189f34e28a9">AArch64_AM::encodeLogicalImmediate</a>(<a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>, 64));</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160; </div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_PTRTOINT:</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_TRUNC: {</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160; </div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160; </div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB = *RBI.getRegBank(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;SrcRB = *RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160; </div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    <span class="keywordflow">if</span> (DstRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() != SrcRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>()) {</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;          <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_TRUNC/G_PTRTOINT input/output on different banks\n&quot;</span>);</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;    }</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160; </div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    <span class="keywordflow">if</span> (DstRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC = getRegClassForTypeOnBank(DstTy, DstRB);</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <span class="keywordflow">if</span> (!DstRC)</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160; </div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *SrcRC = getRegClassForTypeOnBank(SrcTy, SrcRB);</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      <span class="keywordflow">if</span> (!SrcRC)</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160; </div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      <span class="keywordflow">if</span> (!RBI.constrainGenericRegister(SrcReg, *SrcRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) ||</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;          !RBI.constrainGenericRegister(DstReg, *DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to constrain G_TRUNC/G_PTRTOINT\n&quot;</span>);</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      }</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160; </div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;      <span class="keywordflow">if</span> (DstRC == SrcRC) {</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        <span class="comment">// Nothing to be done</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Opcode == TargetOpcode::G_TRUNC &amp;&amp; DstTy == LLT::scalar(32) &amp;&amp;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                 SrcTy == LLT::scalar(64)) {</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;TableGen can import this case&quot;</span>);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstRC == &amp;AArch64::GPR32RegClass &amp;&amp;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                 SrcRC == &amp;AArch64::GPR64RegClass) {</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).setSubReg(AArch64::sub_32);</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unhandled mismatched classes in G_TRUNC/G_PTRTOINT\n&quot;</span>);</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      }</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160; </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::COPY));</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstRB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      <span class="keywordflow">if</span> (DstTy == LLT::fixed_vector(4, 16) &amp;&amp;</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;          SrcTy == LLT::fixed_vector(4, 32)) {</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::XTNv4i16));</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160; </div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <span class="keywordflow">if</span> (!SrcTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 128) {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *Extract = emitExtractVectorElt(</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;            DstReg, DstRB, LLT::scalar(DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()), SrcReg, 0, MIB);</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        <span class="keywordflow">if</span> (!Extract)</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      }</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; </div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      <span class="comment">// We might have a vector G_PTRTOINT, in which case just emit a COPY.</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <span class="keywordflow">if</span> (Opcode == TargetOpcode::G_PTRTOINT) {</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected an FPR ptrtoint to be a vector&quot;</span>);</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::COPY));</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      }</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    }</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160; </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160; </div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ANYEXT: {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    <span class="keywordflow">if</span> (selectUSMovFromExtend(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160; </div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160; </div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RBDst = *RBI.getRegBank(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="keywordflow">if</span> (RBDst.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() != AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_ANYEXT on bank: &quot;</span> &lt;&lt; RBDst</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, expected: GPR\n&quot;</span>);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    }</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160; </div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RBSrc = *RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    <span class="keywordflow">if</span> (RBSrc.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() != AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_ANYEXT on bank: &quot;</span> &lt;&lt; RBSrc</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, expected: GPR\n&quot;</span>);</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    }</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160; </div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> DstSize = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160; </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <span class="keywordflow">if</span> (DstSize == 0) {</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_ANYEXT operand has no size, not a gvreg?\n&quot;</span>);</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    }</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160; </div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordflow">if</span> (DstSize != 64 &amp;&amp; DstSize &gt; 32) {</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_ANYEXT to size: &quot;</span> &lt;&lt; DstSize</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, expected: 32 or 64\n&quot;</span>);</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    }</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <span class="comment">// At this point G_ANYEXT is just like a plain COPY, but we need</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    <span class="comment">// to explicitly form the 64-bit value if any.</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <span class="keywordflow">if</span> (DstSize &gt; 32) {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> ExtSrc = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64allRegClass);</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::SUBREG_TO_REG))</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(ExtSrc)</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SrcReg)</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32);</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).setReg(ExtSrc);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    }</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  }</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160; </div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ZEXT:</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SEXT_INREG:</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SEXT: {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;    <span class="keywordflow">if</span> (selectUSMovFromExtend(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160; </div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <span class="keywordtype">unsigned</span> Opcode = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode();</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> IsSigned = Opcode != TargetOpcode::G_ZEXT;</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DefReg);</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    <span class="keywordtype">unsigned</span> DstSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    <span class="keywordtype">unsigned</span> SrcSize = SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160; </div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;    <span class="comment">// SEXT_INREG has the same src reg size as dst, the size of the value to be</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;    <span class="comment">// extended is encoded in the imm.</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;    <span class="keywordflow">if</span> (Opcode == TargetOpcode::G_SEXT_INREG)</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      SrcSize = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getImm();</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160; </div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <span class="keywordflow">if</span> (DstTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Should be handled by imported patterns.</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160; </div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((*RBI.getRegBank(DefReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)).getID() ==</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;               AArch64::GPRRegBankID &amp;&amp;</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;           <span class="stringliteral">&quot;Unexpected ext regbank&quot;</span>);</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160; </div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ExtI;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160; </div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <span class="comment">// First check if we&#39;re extending the result of a load which has a dest type</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <span class="comment">// smaller than 32 bits, then this zext is redundant. GPR32 is the smallest</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    <span class="comment">// GPR register on AArch64 and all loads which are smaller automatically</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="comment">// zero-extend the upper bits. E.g.</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <span class="comment">// %v(s8) = G_LOAD %p, :: (load 1)</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <span class="comment">// %v2(s32) = G_ZEXT %v(s8)</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <span class="keywordflow">if</span> (!IsSigned) {</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keyword">auto</span> *LoadMI = <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_LOAD, SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      <span class="keywordtype">bool</span> IsGPR =</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;          RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() == AArch64::GPRRegBankID;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      <span class="keywordflow">if</span> (LoadMI &amp;&amp; IsGPR) {</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineMemOperand.html">MachineMemOperand</a> *<a class="code" href="structllvm_1_1MemOp.html">MemOp</a> = *LoadMI-&gt;memoperands_begin();</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        <span class="keywordtype">unsigned</span> BytesLoaded = <a class="code" href="structllvm_1_1MemOp.html">MemOp</a>-&gt;getSize();</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <span class="keywordflow">if</span> (BytesLoaded &lt; 4 &amp;&amp; SrcTy.<a class="code" href="classllvm_1_1LLT.html#ae456a811703836ee5d9e32c3e51a15b6">getSizeInBytes</a>() == BytesLoaded)</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      }</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160; </div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;      <span class="comment">// For the 32-bit -&gt; 64-bit case, we can emit a mov (ORRWrs)</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;      <span class="comment">// + SUBREG_TO_REG.</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      <span class="keywordflow">if</span> (IsGPR &amp;&amp; SrcSize == 32 &amp;&amp; DstSize == 64) {</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;        <a class="code" href="classllvm_1_1Register.html">Register</a> SubregToRegSrc =</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;            <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR32RegClass);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> ZReg = AArch64::WZR;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::ORRWrs, {SubregToRegSrc}, {ZReg, SrcReg})</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;            .addImm(0);</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160; </div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SUBREG_TO_REG, {DefReg}, {})</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            .addImm(0)</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SubregToRegSrc)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32);</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160; </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        <span class="keywordflow">if</span> (!RBI.constrainGenericRegister(DefReg, AArch64::GPR64RegClass,</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;                                          <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to constrain G_ZEXT destination\n&quot;</span>);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;        }</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160; </div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        <span class="keywordflow">if</span> (!RBI.constrainGenericRegister(SrcReg, AArch64::GPR32RegClass,</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                                          <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to constrain G_ZEXT source\n&quot;</span>);</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        }</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160; </div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    }</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160; </div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    <span class="keywordflow">if</span> (DstSize == 64) {</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      <span class="keywordflow">if</span> (Opcode != TargetOpcode::G_SEXT_INREG) {</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        <span class="comment">// FIXME: Can we avoid manually doing this?</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        <span class="keywordflow">if</span> (!RBI.constrainGenericRegister(SrcReg, AArch64::GPR32RegClass,</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;                                          <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Failed to constrain &quot;</span> &lt;&lt; <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.getName(Opcode)</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; operand\n&quot;</span>);</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;        }</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        SrcReg = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SUBREG_TO_REG,</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                                {&amp;AArch64::GPR64RegClass}, {})</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                     .addImm(0)</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                     .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SrcReg)</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                     .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32)</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                     .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1c5fadb14ff1d77faad0cb58a43252ab">getReg</a>(0);</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;      }</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160; </div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      ExtI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(IsSigned ? AArch64::SBFMXri : AArch64::UBFMXri,</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                             {DefReg}, {SrcReg})</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                  .addImm(0)</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                  .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(SrcSize - 1);</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstSize &lt;= 32) {</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      ExtI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(IsSigned ? AArch64::SBFMWri : AArch64::UBFMWri,</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                             {DefReg}, {SrcReg})</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                  .addImm(0)</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                  .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(SrcSize - 1);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    }</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*ExtI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  }</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160; </div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SITOFP:</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_UITOFP:</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_FPTOSI:</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_FPTOUI: {</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg()),</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;              SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NewOpc = <a class="code" href="AArch64InstructionSelector_8cpp.html#a18c672925e05a23b72838be961003fc7">selectFPConvOpc</a>(Opcode, DstTy, SrcTy);</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    <span class="keywordflow">if</span> (NewOpc == Opcode)</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160; </div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(NewOpc));</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setFlags(MachineInstr::NoFPExcept);</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160; </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  }</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160; </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_FREEZE:</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160; </div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_INTTOPTR:</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <span class="comment">// The importer is currently unable to import pointer types since they</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <span class="comment">// didn&#39;t exist in SelectionDAG.</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160; </div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BITCAST:</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    <span class="comment">// Imported SelectionDAG rules can handle every bitcast except those that</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    <span class="comment">// bitcast from a type to the same type. Ideally, these shouldn&#39;t occur</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <span class="comment">// but we might not run an optimizer that deletes them. The other exception</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <span class="comment">// is bitcasts involving pointer types, as SelectionDAG has no knowledge</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <span class="comment">// of them.</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160; </div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SELECT: {</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    <span class="keyword">auto</span> &amp;Sel = cast&lt;GSelect&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> CondReg = Sel.getCondReg();</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> TReg = Sel.getTrueReg();</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> FReg = Sel.getFalseReg();</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160; </div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    <span class="keywordflow">if</span> (tryOptSelect(Sel))</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160; </div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    <span class="comment">// Make sure to use an unused vreg instead of wzr, so that the peephole</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;    <span class="comment">// optimizations will be able to optimize these.</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DeadVReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR32RegClass);</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;    <span class="keyword">auto</span> TstMI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::ANDSWri, {DeadVReg}, {CondReg})</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                     .addImm(<a class="code" href="namespacellvm_1_1AArch64__AM.html#a832ad315a355f4ddcc32f189f34e28a9">AArch64_AM::encodeLogicalImmediate</a>(1, 32));</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*TstMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    <span class="keywordflow">if</span> (!emitSelect(Sel.getReg(0), TReg, FReg, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a191e89dbc4939ebd0b572cae44aac05f">AArch64CC::NE</a>, MIB))</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    Sel.eraseFromParent();</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;  }</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ICMP: {</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      <span class="keywordflow">return</span> selectVectorICmp(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160; </div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    <span class="keywordflow">if</span> (Ty != LLT::scalar(32)) {</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;G_ICMP result has type: &quot;</span> &lt;&lt; Ty</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;, expected: &quot;</span> &lt;&lt; LLT::scalar(32) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    }</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160; </div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    <span class="keyword">auto</span> Pred = <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getPredicate());</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> InvCC =</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;        <a class="code" href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e">changeICMPPredToAArch64CC</a>(CmpInst::getInversePredicate(Pred));</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    emitIntegerCompare(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1), MIB);</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    emitCSINC(<span class="comment">/*Dst=*/</span><a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), <span class="comment">/*Src1=*/</span>AArch64::WZR,</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;              <span class="comment">/*Src2=*/</span>AArch64::WZR, InvCC, MIB);</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;  }</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160; </div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_FCMP: {</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred =</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getPredicate());</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <span class="keywordflow">if</span> (!emitFPCompare(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getReg(), MIB,</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                       Pred) ||</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;        !emitCSetForFCmp(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), Pred, MIB))</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;  }</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_VASTART:</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keywordflow">return</span> STI.isTargetDarwin() ? selectVaStartDarwin(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, MF, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                                : selectVaStartAAPCS(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, MF, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_INTRINSIC:</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="keywordflow">return</span> selectIntrinsic(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_INTRINSIC_W_SIDE_EFFECTS:</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    <span class="keywordflow">return</span> selectIntrinsicWithSideEffects(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_IMPLICIT_DEF: {</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::IMPLICIT_DEF));</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB = *RBI.getRegBank(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC = getRegClassForTypeOnBank(DstTy, DstRB);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    RBI.constrainGenericRegister(DstReg, *DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  }</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BLOCK_ADDR: {</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>.getCodeModel() == <a class="code" href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfa5208f558fccf9f63423fb5385bb3e75c">CodeModel::Large</a>) {</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;      materializeLargeCMVal(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getBlockAddress(), 0);</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::MOVaddrBA));</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <span class="keyword">auto</span> MovMI = <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::MOVaddrBA),</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                           <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg())</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                       .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a834e9ac846bd81eaf3d3492ef7ea24da">addBlockAddress</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getBlockAddress(),</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                                        <span class="comment">/* Offset */</span> 0, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a7f04634c15a04a59d5f234002e613b5b">AArch64II::MO_PAGE</a>)</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                       .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a834e9ac846bd81eaf3d3492ef7ea24da">addBlockAddress</a>(</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                           <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getBlockAddress(), <span class="comment">/* Offset */</span> 0,</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                           <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a> | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a3a5053185998bdf24f3167c234915785">AArch64II::MO_PAGEOFF</a>);</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*MovMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    }</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;  }</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;  <span class="keywordflow">case</span> AArch64::G_DUP: {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    <span class="comment">// When the scalar of G_DUP is an s8/s16 gpr, they can&#39;t be selected by</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <span class="comment">// imported patterns. Do it manually here. Avoiding generating s16 gpr is</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    <span class="comment">// difficult because at RBS we may end up pessimizing the fpr case if we</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    <span class="comment">// decided to add an anyextend to fix this. Manual selection is the most</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <span class="comment">// robust solution for now.</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    <span class="keywordflow">if</span> (RBI.getRegBank(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() !=</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        AArch64::GPRRegBankID)</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// We expect the fpr regbank case to be imported.</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> VecTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(8, 8))</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::DUPv8i8gpr));</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(16, 8))</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::DUPv16i8gpr));</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(4, 16))</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::DUPv4i16gpr));</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(8, 16))</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::DUPv8i16gpr));</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;  }</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_INTRINSIC_TRUNC:</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    <span class="keywordflow">return</span> selectIntrinsicTrunc(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_INTRINSIC_ROUND:</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;    <span class="keywordflow">return</span> selectIntrinsicRound(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BUILD_VECTOR:</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <span class="keywordflow">return</span> selectBuildVector(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MERGE_VALUES:</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ARMInstructionSelector_8cpp.html#a0d70a38e8f0622515630e7e8672df270">selectMergeValues</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_UNMERGE_VALUES:</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ARMInstructionSelector_8cpp.html#a838cd050490773e0349589c0d78618fc">selectUnmergeValues</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SHUFFLE_VECTOR:</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    <span class="keywordflow">return</span> selectShuffleVector(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_EXTRACT_VECTOR_ELT:</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;    <span class="keywordflow">return</span> selectExtractElt(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_INSERT_VECTOR_ELT:</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    <span class="keywordflow">return</span> selectInsertElt(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_CONCAT_VECTORS:</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    <span class="keywordflow">return</span> selectConcatVectors(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_JUMP_TABLE:</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;    <span class="keywordflow">return</span> selectJumpTable(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_VECREDUCE_FADD:</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_VECREDUCE_ADD:</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    <span class="keywordflow">return</span> selectReduction(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMCPY:</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMCPY_INLINE:</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMMOVE:</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMSET:</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(STI.hasMOPS() &amp;&amp; <span class="stringliteral">&quot;Shouldn&#39;t get here without +mops feature&quot;</span>);</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;    <span class="keywordflow">return</span> selectMOPS(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;  }</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160; </div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;}</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160; </div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectReduction(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;                                                 <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> VecReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> VecTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(VecReg);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_VECREDUCE_ADD) {</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    <span class="comment">// For &lt;2 x i32&gt; ADDPv2i32 generates an FPR64 value, so we need to emit</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    <span class="comment">// a subregister copy afterwards.</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(2, 32)) {</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      <span class="keyword">auto</span> AddP = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::ADDPv2i32, {&amp;AArch64::FPR64RegClass},</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                                 {VecReg, VecReg});</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {DstReg}, {})</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                      .addReg(AddP.getReg(0), 0, AArch64::ssub)</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1c5fadb14ff1d77faad0cb58a43252ab">getReg</a>(0);</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;      RBI.constrainGenericRegister(Copy, AArch64::FPR32RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*AddP, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    }</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160; </div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(16, 8))</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      Opc = AArch64::ADDVv16i8v;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(8, 16))</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;      Opc = AArch64::ADDVv8i16v;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(4, 32))</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;      Opc = AArch64::ADDVv4i32v;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(2, 64))</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      Opc = AArch64::ADDPv2i64p;</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unhandled type for add reduction&quot;</span>);</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    }</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(Opc));</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;  }</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160; </div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_VECREDUCE_FADD) {</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(2, 32))</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;      Opc = AArch64::FADDPv2i32p;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (VecTy == LLT::fixed_vector(2, 64))</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      Opc = AArch64::FADDPv2i64p;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unhandled type for fadd reduction&quot;</span>);</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    }</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(Opc));</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;  }</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;}</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160; </div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectMOPS(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;GI,</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;                                            <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;  <span class="keywordtype">unsigned</span> Mopcode;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  <span class="keywordflow">switch</span> (GI.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>()) {</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMCPY:</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMCPY_INLINE:</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    Mopcode = AArch64::MOPSMemoryCopyPseudo;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMMOVE:</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    Mopcode = AArch64::MOPSMemoryMovePseudo;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_MEMSET:</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="comment">// For tagged memset see llvm.aarch64.mops.memset.tag</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    Mopcode = AArch64::MOPSMemorySetPseudo;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;  }</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;  <span class="keyword">auto</span> &amp;DstPtr = GI.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0);</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  <span class="keyword">auto</span> &amp;SrcOrVal = GI.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = GI.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2);</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160; </div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;  <span class="comment">// Create copies of the registers that can be clobbered.</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DstPtrCopy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#ac27689339b95eeb89bc9e40aa1e394f9">cloneVirtualRegister</a>(DstPtr.getReg());</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> SrcValCopy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#ac27689339b95eeb89bc9e40aa1e394f9">cloneVirtualRegister</a>(SrcOrVal.getReg());</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> SizeCopy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#ac27689339b95eeb89bc9e40aa1e394f9">cloneVirtualRegister</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>.getReg());</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160; </div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> IsSet = Mopcode == AArch64::MOPSMemorySetPseudo;</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;SrcValRegClass =</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      IsSet ? AArch64::GPR64RegClass : AArch64::GPR64commonRegClass;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160; </div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;  <span class="comment">// Constrain to specific registers</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  RBI.constrainGenericRegister(DstPtrCopy, AArch64::GPR64commonRegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  RBI.constrainGenericRegister(SrcValCopy, SrcValRegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  RBI.constrainGenericRegister(SizeCopy, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160; </div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(DstPtrCopy, DstPtr);</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(SrcValCopy, SrcOrVal);</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(SizeCopy, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>);</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160; </div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  <span class="comment">// New instruction uses the copied registers because it must update them.</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;  <span class="comment">// The defs are not used since they don&#39;t exist in G_MEM*. They are still</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  <span class="comment">// tied.</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  <span class="comment">// Note: order of operands is different from G_MEMSET, G_MEMCPY, G_MEMMOVE</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DefDstPtr = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64commonRegClass);</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DefSize = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64RegClass);</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;  <span class="keywordflow">if</span> (IsSet) {</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Mopcode, {DefDstPtr, DefSize},</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                   {DstPtrCopy, SizeCopy, SrcValCopy});</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DefSrcPtr = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;SrcValRegClass);</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Mopcode, {DefDstPtr, DefSrcPtr, DefSize},</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                   {DstPtrCopy, SrcValCopy, SizeCopy});</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;  }</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160; </div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;  GI.<a class="code" href="classllvm_1_1MachineInstr.html#ac2421adbb9996e1b15f03a8abb6c70a8">eraseFromParent</a>();</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;}</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160; </div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectBrJT(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                                            <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_BRJT &amp;&amp; <span class="stringliteral">&quot;Expected G_BRJT&quot;</span>);</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> JTAddr = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;  <span class="keywordtype">unsigned</span> JTI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getIndex();</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160; </div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> TargetReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64RegClass);</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ScratchReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64spRegClass);</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160; </div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;  MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1AArch64FunctionInfo.html">AArch64FunctionInfo</a>&gt;()-&gt;setJumpTableEntryInfo(JTI, 4, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;  <span class="keyword">auto</span> JumpTableInst = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::JumpTableDest32,</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                                      {TargetReg, ScratchReg}, {JTAddr, <a class="code" href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">Index</a>})</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                           .addJumpTableIndex(JTI);</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;  <span class="comment">// Build the indirect branch.</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(<a class="code" href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">AArch64::BR</a>, {}, {TargetReg});</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*JumpTableInst, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;}</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160; </div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectJumpTable(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                                                 <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_JUMP_TABLE &amp;&amp; <span class="stringliteral">&quot;Expected jump table&quot;</span>);</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).isJTI() &amp;&amp; <span class="stringliteral">&quot;Jump table op should have a JTI!&quot;</span>);</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160; </div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;  <span class="keywordtype">unsigned</span> JTI = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getIndex();</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;  <span class="comment">// We generate a MOVaddrJT which will get expanded to an ADRP + ADD later.</span></div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;  <span class="keyword">auto</span> MovMI =</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::MOVaddrJT, {DstReg}, {})</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;          .addJumpTableIndex(JTI, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a7f04634c15a04a59d5f234002e613b5b">AArch64II::MO_PAGE</a>)</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ac2090a63769fa3e7ba2e0eadbe57309e">addJumpTableIndex</a>(JTI, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a> | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a3a5053185998bdf24f3167c234915785">AArch64II::MO_PAGEOFF</a>);</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*MovMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;}</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160; </div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectTLSGlobalValue(</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;  <span class="keywordflow">if</span> (!STI.isTargetMachO())</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()-&gt;getParent();</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;  MF.<a class="code" href="classllvm_1_1MachineFunction.html#a18fcadd076ad53e6df94e0ca7a80a9ef">getFrameInfo</a>().<a class="code" href="classllvm_1_1MachineFrameInfo.html#a14ca8f1aa1c62b860504b766ad3b15f9">setAdjustsStack</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160; </div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;GlobalOp = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(GlobalOp.getOffset() == 0 &amp;&amp;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;         <span class="stringliteral">&quot;Shouldn&#39;t have an offset on TLS globals!&quot;</span>);</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1GlobalValue.html">GlobalValue</a> &amp;GV = *GlobalOp.getGlobal();</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160; </div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;  <span class="keyword">auto</span> LoadGOT =</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(<a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19adfb5f0cc680a060e5ca88e6e923d7183">AArch64::LOADgot</a>, {&amp;AArch64::GPR64commonRegClass}, {})</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;          .addGlobalAddress(&amp;GV, 0, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71add46ede0892fdd429e940eb97c1e6e55">AArch64II::MO_TLS</a>);</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160; </div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::LDRXui, {&amp;AArch64::GPR64commonRegClass},</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;                             {LoadGOT.getReg(0)})</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;                  .addImm(0);</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160; </div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(<a class="code" href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(AArch64::X0), LoadGOT.getReg(0));</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;  <span class="comment">// TLS calls preserve all registers except those that absolutely must be</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  <span class="comment">// trashed: X0 (it takes an argument), LR (it&#39;s a call) and NZCV (let&#39;s not be</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  <span class="comment">// silly).</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(<a class="code" href="namespacellvm.html#a3a91375dbee36ddeeee15b974e39782c">getBLRCallOpcode</a>(MF), {}, {<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>})</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      .addUse(AArch64::X0, <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da0fec8ba6f4a4dc758b725205985eee99">RegState::Implicit</a>)</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(AArch64::X0, <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da0fec8ba6f4a4dc758b725205985eee99">RegState::Implicit</a>)</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a9ad70dffa73dcf15ca0495024b92a4c3">addRegMask</a>(<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.getTLSCallPreservedMask());</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160; </div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), <a class="code" href="classllvm_1_1Register.html">Register</a>(AArch64::X0));</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;  RBI.constrainGenericRegister(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), AArch64::GPR64RegClass,</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                               <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;}</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160; </div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectIntrinsicTrunc(</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160; </div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;  <span class="comment">// Select the correct opcode.</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;  <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  <span class="keywordflow">if</span> (!SrcTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>()) {</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    <span class="keywordflow">switch</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()) {</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;      Opc = AArch64::FRINTZHr;</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;      Opc = AArch64::FRINTZSr;</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;      Opc = AArch64::FRINTZDr;</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    }</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="keywordtype">unsigned</span> NumElts = SrcTy.<a class="code" href="classllvm_1_1LLT.html#a71181d67d0bf68c3b8a535ec20463f90">getNumElements</a>();</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    <span class="keywordflow">switch</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()) {</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      <span class="keywordflow">if</span> (NumElts == 4)</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        Opc = AArch64::FRINTZv4f16;</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumElts == 8)</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        Opc = AArch64::FRINTZv8f16;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;      <span class="keywordflow">if</span> (NumElts == 2)</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;        Opc = AArch64::FRINTZv2f32;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumElts == 4)</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;        Opc = AArch64::FRINTZv4f32;</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;      <span class="keywordflow">if</span> (NumElts == 2)</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;        Opc = AArch64::FRINTZv2f64;</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    }</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;  }</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160; </div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;  <span class="keywordflow">if</span> (!Opc) {</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="comment">// Didn&#39;t get an opcode above, bail.</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unsupported type for G_INTRINSIC_TRUNC!\n&quot;</span>);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;  }</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160; </div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;  <span class="comment">// Legalization would have set us up perfectly for this; we just need to</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;  <span class="comment">// set the opcode and move on.</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(Opc));</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;}</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160; </div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectIntrinsicRound(</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160; </div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;  <span class="comment">// Select the correct opcode.</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;  <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;  <span class="keywordflow">if</span> (!SrcTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>()) {</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    <span class="keywordflow">switch</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()) {</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      Opc = AArch64::FRINTAHr;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;      Opc = AArch64::FRINTASr;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;      Opc = AArch64::FRINTADr;</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;    }</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;    <span class="keywordtype">unsigned</span> NumElts = SrcTy.<a class="code" href="classllvm_1_1LLT.html#a71181d67d0bf68c3b8a535ec20463f90">getNumElements</a>();</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;    <span class="keywordflow">switch</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()) {</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;      <span class="keywordflow">if</span> (NumElts == 4)</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;        Opc = AArch64::FRINTAv4f16;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumElts == 8)</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;        Opc = AArch64::FRINTAv8f16;</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;      <span class="keywordflow">if</span> (NumElts == 2)</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;        Opc = AArch64::FRINTAv2f32;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NumElts == 4)</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        Opc = AArch64::FRINTAv4f32;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;      <span class="keywordflow">if</span> (NumElts == 2)</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;        Opc = AArch64::FRINTAv2f64;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;    }</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;  }</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160; </div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;  <span class="keywordflow">if</span> (!Opc) {</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    <span class="comment">// Didn&#39;t get an opcode above, bail.</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unsupported type for G_INTRINSIC_ROUND!\n&quot;</span>);</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;  }</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160; </div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;  <span class="comment">// Legalization would have set us up perfectly for this; we just need to</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;  <span class="comment">// set the opcode and move on.</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setDesc(<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(Opc));</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;}</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160; </div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectVectorICmp(</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src2Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getReg();</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160; </div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;  <span class="keywordtype">unsigned</span> SrcEltSize = SrcTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = DstTy.<a class="code" href="classllvm_1_1LLT.html#a71181d67d0bf68c3b8a535ec20463f90">getNumElements</a>();</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160; </div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;  <span class="comment">// First index is element size, 0 == 8b, 1 == 16b, 2 == 32b, 3 == 64b</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  <span class="comment">// Second index is num elts, 0 == v2, 1 == v4, 2 == v8, 3 == v16</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  <span class="comment">// Third index is cc opcode:</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;  <span class="comment">// 0 == eq</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;  <span class="comment">// 1 == ugt</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  <span class="comment">// 2 == uge</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  <span class="comment">// 3 == ult</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  <span class="comment">// 4 == ule</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;  <span class="comment">// 5 == sgt</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;  <span class="comment">// 6 == sge</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;  <span class="comment">// 7 == slt</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;  <span class="comment">// 8 == sle</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  <span class="comment">// ne is done by negating &#39;eq&#39; result.</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160; </div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;  <span class="comment">// This table below assumes that for some comparisons the operands will be</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;  <span class="comment">// commuted.</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;  <span class="comment">// ult op == commute + ugt op</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;  <span class="comment">// ule op == commute + uge op</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;  <span class="comment">// slt op == commute + sgt op</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;  <span class="comment">// sle op == commute + sge op</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;  <span class="keywordtype">unsigned</span> PredIdx = 0;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;  <span class="keywordtype">bool</span> SwapOperands = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = (<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">CmpInst::Predicate</a>)<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getPredicate();</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;  <span class="keywordflow">switch</span> (Pred) {</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_NE:</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_EQ:</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    PredIdx = 0;</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_UGT:</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    PredIdx = 1;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_UGE:</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;    PredIdx = 2;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_ULT:</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;    PredIdx = 3;</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;    SwapOperands = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_ULE:</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;    PredIdx = 4;</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;    SwapOperands = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SGT:</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    PredIdx = 5;</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SGE:</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    PredIdx = 6;</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SLT:</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    PredIdx = 7;</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    SwapOperands = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;  <span class="keywordflow">case</span> CmpInst::ICMP_SLE:</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    PredIdx = 8;</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    SwapOperands = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unhandled icmp predicate&quot;</span>);</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;  }</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160; </div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;  <span class="comment">// This table obviously should be tablegen&#39;d when we have our GISel native</span></div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;  <span class="comment">// tablegen selector.</span></div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160; </div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpcTable[4][4][9] = {</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      {</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;           0 <span class="comment">/* invalid */</span>},</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;           0 <span class="comment">/* invalid */</span>},</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;          {AArch64::CMEQv8i8, AArch64::CMHIv8i8, AArch64::CMHSv8i8,</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;           AArch64::CMHIv8i8, AArch64::CMHSv8i8, AArch64::CMGTv8i8,</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;           AArch64::CMGEv8i8, AArch64::CMGTv8i8, AArch64::CMGEv8i8},</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;          {AArch64::CMEQv16i8, AArch64::CMHIv16i8, AArch64::CMHSv16i8,</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;           AArch64::CMHIv16i8, AArch64::CMHSv16i8, AArch64::CMGTv16i8,</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;           AArch64::CMGEv16i8, AArch64::CMGTv16i8, AArch64::CMGEv16i8}</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      },</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;      {</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;           0 <span class="comment">/* invalid */</span>},</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;          {AArch64::CMEQv4i16, AArch64::CMHIv4i16, AArch64::CMHSv4i16,</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;           AArch64::CMHIv4i16, AArch64::CMHSv4i16, AArch64::CMGTv4i16,</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;           AArch64::CMGEv4i16, AArch64::CMGTv4i16, AArch64::CMGEv4i16},</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;          {AArch64::CMEQv8i16, AArch64::CMHIv8i16, AArch64::CMHSv8i16,</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;           AArch64::CMHIv8i16, AArch64::CMHSv8i16, AArch64::CMGTv8i16,</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;           AArch64::CMGEv8i16, AArch64::CMGTv8i16, AArch64::CMGEv8i16},</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;           0 <span class="comment">/* invalid */</span>}</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      },</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;      {</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;          {AArch64::CMEQv2i32, AArch64::CMHIv2i32, AArch64::CMHSv2i32,</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;           AArch64::CMHIv2i32, AArch64::CMHSv2i32, AArch64::CMGTv2i32,</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;           AArch64::CMGEv2i32, AArch64::CMGTv2i32, AArch64::CMGEv2i32},</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;          {AArch64::CMEQv4i32, AArch64::CMHIv4i32, AArch64::CMHSv4i32,</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;           AArch64::CMHIv4i32, AArch64::CMHSv4i32, AArch64::CMGTv4i32,</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;           AArch64::CMGEv4i32, AArch64::CMGTv4i32, AArch64::CMGEv4i32},</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;           0 <span class="comment">/* invalid */</span>},</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;           0 <span class="comment">/* invalid */</span>}</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;      },</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;      {</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;          {AArch64::CMEQv2i64, AArch64::CMHIv2i64, AArch64::CMHSv2i64,</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;           AArch64::CMHIv2i64, AArch64::CMHSv2i64, AArch64::CMGTv2i64,</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;           AArch64::CMGEv2i64, AArch64::CMGTv2i64, AArch64::CMGEv2i64},</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;           0 <span class="comment">/* invalid */</span>},</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;           0 <span class="comment">/* invalid */</span>},</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;          {0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;           0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>, 0 <span class="comment">/* invalid */</span>,</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;           0 <span class="comment">/* invalid */</span>}</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;      },</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  };</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;  <span class="keywordtype">unsigned</span> EltIdx = <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(SrcEltSize / 8);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  <span class="keywordtype">unsigned</span> NumEltsIdx = <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(NumElts / 2);</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;  <span class="keywordtype">unsigned</span> Opc = OpcTable[EltIdx][NumEltsIdx][PredIdx];</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;  <span class="keywordflow">if</span> (!Opc) {</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not map G_ICMP to cmp opcode&quot;</span>);</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;  }</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160; </div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;VecRB = *RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *SrcRC =</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      getRegClassForTypeOnBank(SrcTy, VecRB, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;  <span class="keywordflow">if</span> (!SrcRC) {</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not determine source register class.\n&quot;</span>);</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;  }</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160; </div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;  <span class="keywordtype">unsigned</span> NotOpc = Pred == ICmpInst::ICMP_NE ? AArch64::NOTv8i8 : 0;</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;  <span class="keywordflow">if</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 128)</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;    NotOpc = NotOpc ? AArch64::NOTv16i8 : 0;</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160; </div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;  <span class="keywordflow">if</span> (SwapOperands)</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcReg, Src2Reg);</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160; </div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {SrcRC}, {SrcReg, Src2Reg});</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Cmp, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160; </div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;  <span class="comment">// Invert if we had a &#39;ne&#39; cc.</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  <span class="keywordflow">if</span> (NotOpc) {</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(NotOpc, {DstReg}, {<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>});</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Cmp, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(DstReg, <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>.getReg(0));</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  }</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;  RBI.constrainGenericRegister(DstReg, *SrcRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;}</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160; </div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitScalarToVector(</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <span class="keywordtype">unsigned</span> EltSize, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>,</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320dab502f975742e9bff6d6dd7b49439b806">Undef</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::IMPLICIT_DEF, {DstRC}, {});</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160; </div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;  <span class="keyword">auto</span> BuildFn = [&amp;](<span class="keywordtype">unsigned</span> SubregIndex) {</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363">Ins</a> =</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;        MIRBuilder</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;            .<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::INSERT_SUBREG, {DstRC}, {<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320dab502f975742e9bff6d6dd7b49439b806">Undef</a>, <a class="code" href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">Scalar</a>})</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;            .addImm(SubregIndex);</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320dab502f975742e9bff6d6dd7b49439b806">Undef</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363">Ins</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    <span class="keywordflow">return</span> &amp;*<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363">Ins</a>;</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;  };</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160; </div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;  <span class="keywordflow">switch</span> (EltSize) {</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;  <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    <span class="keywordflow">return</span> BuildFn(AArch64::bsub);</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;    <span class="keywordflow">return</span> BuildFn(AArch64::hsub);</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="keywordflow">return</span> BuildFn(AArch64::ssub);</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;  <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordflow">return</span> BuildFn(AArch64::dsub);</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;  }</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;}</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160; </div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="ARMInstructionSelector_8cpp.html#a0d70a38e8f0622515630e7e8672df270">AArch64InstructionSelector::selectMergeValues</a>(</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_MERGE_VALUES &amp;&amp; <span class="stringliteral">&quot;unexpected opcode&quot;</span>);</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!DstTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; !SrcTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;invalid merge operation&quot;</span>);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RBI.getRegBank(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160; </div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumOperands() != 3)</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160; </div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;  <span class="comment">// Merging 2 s64s into an s128.</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;  <span class="keywordflow">if</span> (DstTy == LLT::scalar(128)) {</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <span class="keywordflow">if</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 64)</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Src1Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Src2Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    <span class="keyword">auto</span> Tmp = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::IMPLICIT_DEF, {DstTy}, {});</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *InsMI = emitLaneInsert(std::nullopt, Tmp.getReg(0), Src1Reg,</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;                                         <span class="comment">/* LaneIdx */</span> 0, RB, MIB);</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;    <span class="keywordflow">if</span> (!InsMI)</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *Ins2MI = emitLaneInsert(DstReg, InsMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(),</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;                                          Src2Reg, <span class="comment">/* LaneIdx */</span> 1, RB, MIB);</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    <span class="keywordflow">if</span> (!Ins2MI)</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*InsMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Ins2MI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;  }</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160; </div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;  <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() != AArch64::GPRRegBankID)</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160; </div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;  <span class="keywordflow">if</span> (DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 64 || SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 32)</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160; </div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;  <span class="keyword">auto</span> *DstRC = &amp;AArch64::GPR64RegClass;</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SubToRegDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(DstRC);</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;SubRegMI = *<a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(),</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;                                    <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::SUBREG_TO_REG))</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(SubToRegDef)</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg())</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32);</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SubToRegDef2 = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(DstRC);</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;  <span class="comment">// Need to anyext the second scalar before we can use bfm</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;SubRegMI2 = *<a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(),</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;                                    <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::SUBREG_TO_REG))</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(SubToRegDef2)</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg())</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                                .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32);</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eaa257ce6c70a5ceadfc079dfcd101db51">BFM</a> =</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      *<a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(AArch64::BFMXri))</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;           .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">addDef</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg())</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;           .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SubToRegDef)</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;           .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SubToRegDef2)</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;           .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(32)</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;           .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(31);</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(SubRegMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(SubRegMI2, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(<a class="code" href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eaa257ce6c70a5ceadfc079dfcd101db51">BFM</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;}</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160; </div>
<div class="line"><a name="l04087"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#adba6b0f5197cda6e31725e3309fb7cb0"> 4087</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#adba6b0f5197cda6e31725e3309fb7cb0">getLaneCopyOpcode</a>(<span class="keywordtype">unsigned</span> &amp;CopyOpc, <span class="keywordtype">unsigned</span> &amp;ExtractSubReg,</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> EltSize) {</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;  <span class="comment">// Choose a lane copy opcode and subregister based off of the size of the</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  <span class="comment">// vector&#39;s elements.</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;  <span class="keywordflow">switch</span> (EltSize) {</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;  <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    CopyOpc = AArch64::DUPi8;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    ExtractSubReg = AArch64::bsub;</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;  <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;    CopyOpc = AArch64::DUPi16;</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;    ExtractSubReg = AArch64::hsub;</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;    CopyOpc = AArch64::DUPi32;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    ExtractSubReg = AArch64::ssub;</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    CopyOpc = AArch64::DUPi64;</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    ExtractSubReg = AArch64::dsub;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    <span class="comment">// Unknown size, bail out.</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Elt size &#39;&quot;</span> &lt;&lt; EltSize &lt;&lt; <span class="stringliteral">&quot;&#39; unsupported.\n&quot;</span>);</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;  }</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;}</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160; </div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitExtractVectorElt(</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    std::optional&lt;Register&gt; DstReg, <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB, <a class="code" href="classllvm_1_1LLT.html">LLT</a> ScalarTy,</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> VecReg, <span class="keywordtype">unsigned</span> LaneIdx, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;  <span class="keywordtype">unsigned</span> CopyOpc = 0;</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;  <span class="keywordtype">unsigned</span> ExtractSubReg = 0;</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#adba6b0f5197cda6e31725e3309fb7cb0">getLaneCopyOpcode</a>(CopyOpc, ExtractSubReg, ScalarTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>())) {</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;        <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t determine lane copy opcode for instruction.\n&quot;</span>);</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;  }</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160; </div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC =</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;      getRegClassForTypeOnBank(ScalarTy, DstRB, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;  <span class="keywordflow">if</span> (!DstRC) {</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not determine destination register class.\n&quot;</span>);</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;  }</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160; </div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;VecRB = *RBI.getRegBank(VecReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> &amp;VecTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(VecReg);</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *VecRC =</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      getRegClassForTypeOnBank(VecTy, VecRB, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;  <span class="keywordflow">if</span> (!VecRC) {</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not determine source register class.\n&quot;</span>);</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;  }</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160; </div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;  <span class="comment">// The register that we&#39;re going to copy into.</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> InsertReg = VecReg;</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;  <span class="keywordflow">if</span> (!DstReg)</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    DstReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(DstRC);</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;  <span class="comment">// If the lane index is 0, we just use a subregister COPY.</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;  <span class="keywordflow">if</span> (LaneIdx == 0) {</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {*DstReg}, {})</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;                    .addReg(VecReg, 0, ExtractSubReg);</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    RBI.constrainGenericRegister(*DstReg, *DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="keywordflow">return</span> &amp;*<a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>;</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;  }</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160; </div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  <span class="comment">// Lane copies require 128-bit wide registers. If we&#39;re dealing with an</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  <span class="comment">// unpacked vector, then we need to move up to that width. Insert an implicit</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;  <span class="comment">// def and a subregister insert to get us there.</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;  <span class="keywordflow">if</span> (VecTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 128) {</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ScalarToVector = emitScalarToVector(</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;        VecTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>(), &amp;AArch64::FPR128RegClass, VecReg, MIRBuilder);</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    <span class="keywordflow">if</span> (!ScalarToVector)</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;    InsertReg = ScalarToVector-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;  }</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160; </div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *LaneCopyMI =</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(CopyOpc, {*DstReg}, {InsertReg}).addImm(LaneIdx);</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*LaneCopyMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160; </div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;  <span class="comment">// Make sure that we actually constrain the initial copy.</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;  RBI.constrainGenericRegister(*DstReg, *DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;  <span class="keywordflow">return</span> LaneCopyMI;</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;}</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160; </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectExtractElt(</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_EXTRACT_VECTOR_ELT &amp;&amp;</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;         <span class="stringliteral">&quot;unexpected opcode!&quot;</span>);</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> NarrowTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> WideTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;  (void)WideTy;</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(WideTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt;= NarrowTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &amp;&amp;</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;         <span class="stringliteral">&quot;source register size too small!&quot;</span>);</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!NarrowTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;cannot extract vector into vector!&quot;</span>);</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160; </div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;  <span class="comment">// Need the lane index to determine the correct copy opcode.</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;LaneIdxOp = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2);</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LaneIdxOp.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; <span class="stringliteral">&quot;Lane index operand was not a register?&quot;</span>);</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160; </div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;  <span class="keywordflow">if</span> (RBI.getRegBank(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() != AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Cannot extract into GPR.\n&quot;</span>);</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;  }</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160; </div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;  <span class="comment">// Find the index to extract from.</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;  <span class="keyword">auto</span> VRegAndVal = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(LaneIdxOp.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;  <span class="keywordflow">if</span> (!VRegAndVal)</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;  <span class="keywordtype">unsigned</span> LaneIdx = VRegAndVal-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160; </div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160; </div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB = *RBI.getRegBank(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *Extract = emitExtractVectorElt(DstReg, DstRB, NarrowTy, SrcReg,</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                                               LaneIdx, MIB);</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;  <span class="keywordflow">if</span> (!Extract)</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160; </div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;}</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160; </div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectSplitVectorUnmerge(</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumOperands() - 1;</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(NumElts).getReg();</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> NarrowTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> SrcTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160; </div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NarrowTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected an unmerge into vectors&quot;</span>);</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;  <span class="keywordflow">if</span> (SrcTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; 128) {</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unexpected vector type for vec split unmerge&quot;</span>);</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;  }</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160; </div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;  <span class="comment">// We implement a split vector operation by treating the sub-vectors as</span></div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;  <span class="comment">// scalars and extracting them.</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB =</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      *RBI.getRegBank(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> OpIdx = 0; OpIdx &lt; NumElts; ++OpIdx) {</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Dst = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(OpIdx).getReg();</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *Extract =</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        emitExtractVectorElt(Dst, DstRB, NarrowTy, SrcReg, OpIdx, MIB);</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    <span class="keywordflow">if</span> (!Extract)</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;  }</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;}</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160; </div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="ARMInstructionSelector_8cpp.html#a838cd050490773e0349589c0d78618fc">AArch64InstructionSelector::selectUnmergeValues</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;                                                     <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_UNMERGE_VALUES &amp;&amp;</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;         <span class="stringliteral">&quot;unexpected opcode&quot;</span>);</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160; </div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  <span class="comment">// TODO: Handle unmerging into GPRs and from scalars to scalars.</span></div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;  <span class="keywordflow">if</span> (RBI.getRegBank(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() !=</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;          AArch64::FPRRegBankID ||</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;      RBI.getRegBank(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() !=</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;          AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unmerging vector-to-gpr and scalar-to-scalar &quot;</span></div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;                         <span class="stringliteral">&quot;currently unsupported.\n&quot;</span>);</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;  }</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160; </div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  <span class="comment">// The last operand is the vector source register, and every other operand is</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;  <span class="comment">// a register to unpack into.</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;  <span class="keywordtype">unsigned</span> NumElts = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumOperands() - 1;</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(NumElts).getReg();</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> NarrowTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> WideTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg);</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;  (void)WideTy;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((WideTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() || WideTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 128) &amp;&amp;</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;         <span class="stringliteral">&quot;can only unmerge from vector or s128 types!&quot;</span>);</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(WideTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt; NarrowTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &amp;&amp;</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;         <span class="stringliteral">&quot;source register size too small!&quot;</span>);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160; </div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;  <span class="keywordflow">if</span> (!NarrowTy.<a class="code" href="classllvm_1_1LLT.html#a3989251b1a714fc8296685f77eac6e87">isScalar</a>())</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;    <span class="keywordflow">return</span> selectSplitVectorUnmerge(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160; </div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;  <span class="comment">// Choose a lane copy opcode and subregister based off of the size of the</span></div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;  <span class="comment">// vector&#39;s elements.</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  <span class="keywordtype">unsigned</span> CopyOpc = 0;</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;  <span class="keywordtype">unsigned</span> ExtractSubReg = 0;</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#adba6b0f5197cda6e31725e3309fb7cb0">getLaneCopyOpcode</a>(CopyOpc, ExtractSubReg, NarrowTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()))</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160; </div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;  <span class="comment">// Set up for the lane copies.</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160; </div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;  <span class="comment">// Stores the registers we&#39;ll be copying from.</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Register, 4&gt;</a> InsertRegs;</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160; </div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;  <span class="comment">// We&#39;ll use the first register twice, so we only need NumElts-1 registers.</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;  <span class="keywordtype">unsigned</span> NumInsertRegs = NumElts - 1;</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160; </div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;  <span class="comment">// If our elements fit into exactly 128 bits, then we can copy from the source</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;  <span class="comment">// directly. Otherwise, we need to do a bit of setup with some subregister</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;  <span class="comment">// inserts.</span></div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;  <span class="keywordflow">if</span> (NarrowTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() * NumElts == 128) {</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    InsertRegs = <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Register, 4&gt;</a>(NumInsertRegs, SrcReg);</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <span class="comment">// No. We have to perform subregister inserts. For each insert, create an</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    <span class="comment">// implicit def and a subregister insert, and save the register we create.</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC = getRegClassForTypeOnBank(</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;        LLT::fixed_vector(NumElts, WideTy.<a class="code" href="classllvm_1_1LLT.html#a32472b5afd0ae6edb4a233a25056a6aa">getScalarSizeInBits</a>()),</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;        *RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>));</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = 0;</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    <span class="keywordtype">bool</span> Found = <a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(RC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    (void)Found;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Found &amp;&amp; <span class="stringliteral">&quot;expected to find last operand&#39;s subeg idx&quot;</span>);</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0; Idx &lt; NumInsertRegs; ++Idx) {</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> ImpDefReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::FPR128RegClass);</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;ImpDefMI =</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;          *<a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::IMPLICIT_DEF),</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                   ImpDefReg);</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160; </div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;      <span class="comment">// Now, create the subregister insert from SrcReg.</span></div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> InsertReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::FPR128RegClass);</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;InsMI =</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;          *<a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(),</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                   <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(TargetOpcode::INSERT_SUBREG), InsertReg)</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;               .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(ImpDefReg)</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;               .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(SrcReg)</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;               .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160; </div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;      <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(ImpDefMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(InsMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160; </div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      <span class="comment">// Save the register so that we can copy from it after.</span></div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;      InsertRegs.push_back(InsertReg);</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    }</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;  }</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160; </div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;  <span class="comment">// Now that we&#39;ve created any necessary subregister inserts, we can</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;  <span class="comment">// create the copies.</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  <span class="comment">// Perform the first copy separately as a subregister copy.</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> CopyTo = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  <span class="keyword">auto</span> FirstCopy = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {CopyTo}, {})</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;                       .addReg(InsertRegs[0], 0, ExtractSubReg);</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*FirstCopy, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160; </div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  <span class="comment">// Now, perform the remaining copies as vector lane copies.</span></div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  <span class="keywordtype">unsigned</span> LaneIdx = 1;</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Register.html">Register</a> InsReg : InsertRegs) {</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> CopyTo = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(LaneIdx).getReg();</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;CopyInst =</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;        *<a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>.get(CopyOpc), CopyTo)</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;             .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(InsReg)</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;             .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(LaneIdx);</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(CopyInst, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    ++LaneIdx;</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;  }</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160; </div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;  <span class="comment">// Separately constrain the first copy&#39;s destination. Because of the</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;  <span class="comment">// limitation in constrainOperandRegClass, we can&#39;t guarantee that this will</span></div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  <span class="comment">// actually be constrained. So, do it ourselves using the second operand.</span></div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC =</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a3699f85cc3382ffc17d597837412b27d">getRegClassOrNull</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;  <span class="keywordflow">if</span> (!RC) {</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t constrain copy destination.\n&quot;</span>);</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;  }</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160; </div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;  RBI.constrainGenericRegister(CopyTo, *RC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;}</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160; </div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectConcatVectors(</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)  {</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_CONCAT_VECTORS &amp;&amp;</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;         <span class="stringliteral">&quot;Unexpected opcode&quot;</span>);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Dst = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Op1 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Op2 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ConcatMI = emitVectorConcat(Dst, Op1, Op2, MIB);</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;  <span class="keywordflow">if</span> (!ConcatMI)</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;}</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160; </div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;<span class="keywordtype">unsigned</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;AArch64InstructionSelector::emitConstantPoolEntry(<span class="keyword">const</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CPVal,</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;                                                  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *CPTy = CPVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>();</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;  <a class="code" href="structllvm_1_1Align.html">Align</a> Alignment = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a82dd10b626a629b9bb7d32d53a8e0884">getDataLayout</a>().<a class="code" href="classllvm_1_1DataLayout.html#af9185c7e96873c6d2c13e1f1b6322cf6">getPrefTypeAlign</a>(CPTy);</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160; </div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;  <a class="code" href="classllvm_1_1MachineConstantPool.html">MachineConstantPool</a> *MCP = MF.<a class="code" href="classllvm_1_1MachineFunction.html#aa460158a4019a4043faf6ea76344cbd5">getConstantPool</a>();</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  <span class="keywordflow">return</span> MCP-&gt;<a class="code" href="classllvm_1_1MachineConstantPool.html#afd6691ddb5d4adf50d744297e18a1c6d">getConstantPoolIndex</a>(CPVal, Alignment);</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;}</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160; </div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitLoadFromConstantPool(</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CPVal, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC;</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;  <span class="keywordtype">unsigned</span> Opc;</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;  <span class="keywordtype">bool</span> IsTiny = <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>.getCodeModel() == <a class="code" href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfa686bcdfaefdfe3f49acbfe6f680bc22d">CodeModel::Tiny</a>;</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a6be291efcc6345779494105f57f85aac">getDataLayout</a>().<a class="code" href="classllvm_1_1DataLayout.html#acfcd22eb38dbfe1acbf138754297437a">getTypeStoreSize</a>(CPVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>) {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;  <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    RC = &amp;AArch64::FPR128RegClass;</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    Opc = IsTiny ? AArch64::LDRQl : AArch64::LDRQui;</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;  <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    RC = &amp;AArch64::FPR64RegClass;</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;    Opc = IsTiny ? AArch64::LDRDl : AArch64::LDRDui;</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;  <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    RC = &amp;AArch64::FPR32RegClass;</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    Opc = IsTiny ? AArch64::LDRSl : AArch64::LDRSui;</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;  <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    RC = &amp;AArch64::FPR16RegClass;</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;    Opc = AArch64::LDRHui;</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not load from constant pool of type &quot;</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;                      &lt;&lt; *CPVal-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>());</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;  }</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160; </div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *LoadMI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;  <span class="keyword">auto</span> &amp;MF = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">getMF</a>();</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  <span class="keywordtype">unsigned</span> CPIdx = emitConstantPoolEntry(CPVal, MF);</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;  <span class="keywordflow">if</span> (IsTiny &amp;&amp; (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 16 || <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 8 || <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 4)) {</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;    <span class="comment">// Use load(literal) for tiny code model.</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    LoadMI = &amp;*MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {RC}, {}).addConstantPoolIndex(CPIdx);</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    <span class="keyword">auto</span> Adrp =</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;        MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(<a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19aa2e9d9d7c30818fd5ba551f8d3f0af34">AArch64::ADRP</a>, {&amp;AArch64::GPR64RegClass}, {})</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;            .addConstantPoolIndex(CPIdx, 0, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a7f04634c15a04a59d5f234002e613b5b">AArch64II::MO_PAGE</a>);</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160; </div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    LoadMI = &amp;*MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {RC}, {Adrp})</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;                   .addConstantPoolIndex(</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;                       CPIdx, 0, <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a3a5053185998bdf24f3167c234915785">AArch64II::MO_PAGEOFF</a> | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a>);</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160; </div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Adrp, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  }</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160; </div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  <a class="code" href="structllvm_1_1MachinePointerInfo.html">MachinePointerInfo</a> PtrInfo = MachinePointerInfo::getConstantPool(MF);</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  LoadMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#afc4107c92fd8d37e8d0cb596f2a25d98">addMemOperand</a>(MF, MF.<a class="code" href="classllvm_1_1MachineFunction.html#a0d496cc15e312863869a384532968143">getMachineMemOperand</a>(PtrInfo,</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                                                    MachineMemOperand::MOLoad,</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;                                                    <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>, <a class="code" href="structllvm_1_1Align.html">Align</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>)));</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*LoadMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;  <span class="keywordflow">return</span> LoadMI;</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;}</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;<span class="comment">/// Return an &lt;Opcode, SubregIndex&gt; pair to do an vector elt insert of a given</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;<span class="comment">/// size and RB.</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;<span class="comment"></span><span class="keyword">static</span> std::pair&lt;unsigned, unsigned&gt;</div>
<div class="line"><a name="l04445"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#a03ac2c8c129b06df3ea6bc3bd65e871d"> 4445</a></span>&#160;<a class="code" href="AArch64InstructionSelector_8cpp.html#a03ac2c8c129b06df3ea6bc3bd65e871d">getInsertVecEltOpInfo</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB, <span class="keywordtype">unsigned</span> EltSize) {</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;  <span class="keywordtype">unsigned</span> Opc, SubregIdx;</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::GPRRegBankID) {</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    <span class="keywordflow">if</span> (EltSize == 16) {</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;      Opc = AArch64::INSvi16gpr;</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;      SubregIdx = AArch64::ssub;</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EltSize == 32) {</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      Opc = AArch64::INSvi32gpr;</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;      SubregIdx = AArch64::ssub;</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EltSize == 64) {</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      Opc = AArch64::INSvi64gpr;</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;      SubregIdx = AArch64::dsub;</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;invalid elt size!&quot;</span>);</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    }</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;    <span class="keywordflow">if</span> (EltSize == 8) {</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;      Opc = AArch64::INSvi8lane;</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      SubregIdx = AArch64::bsub;</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EltSize == 16) {</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;      Opc = AArch64::INSvi16lane;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      SubregIdx = AArch64::hsub;</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EltSize == 32) {</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;      Opc = AArch64::INSvi32lane;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;      SubregIdx = AArch64::ssub;</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EltSize == 64) {</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;      Opc = AArch64::INSvi64lane;</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;      SubregIdx = AArch64::dsub;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;invalid elt size!&quot;</span>);</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    }</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  }</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;  <span class="keywordflow">return</span> std::make_pair(Opc, SubregIdx);</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;}</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160; </div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitInstr(</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    <span class="keywordtype">unsigned</span> Opcode, std::initializer_list&lt;llvm::DstOp&gt; DstOps,</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;    std::initializer_list&lt;llvm::SrcOp&gt; SrcOps, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder,</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    <span class="keyword">const</span> ComplexRendererFns &amp;RenderFns)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Opcode &amp;&amp; <span class="stringliteral">&quot;Expected an opcode?&quot;</span>);</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="namespacellvm.html#a2cdb63ce3baf9ea9a1f86aed27f40fe8">isPreISelGenericOpcode</a>(Opcode) &amp;&amp;</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;         <span class="stringliteral">&quot;Function should only be used to produce selected instructions!&quot;</span>);</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;  <span class="keyword">auto</span> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opcode, DstOps, SrcOps);</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  <span class="keywordflow">if</span> (RenderFns)</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Fn : *RenderFns)</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;      Fn(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;  <span class="keywordflow">return</span> &amp;*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>;</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;}</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160; </div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitAddSub(</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;    <span class="keyword">const</span> std::array&lt;std::array&lt;unsigned, 2&gt;, 5&gt; &amp;AddrModeAndSizeToOpcode,</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">getMF</a>().<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.isReg() &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.isReg() &amp;&amp; <span class="stringliteral">&quot;Expected register operands?&quot;</span>);</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;  <span class="keyword">auto</span> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg());</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected a scalar or pointer?&quot;</span>);</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 32 || <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 64) &amp;&amp; <span class="stringliteral">&quot;Expected a 32-bit or 64-bit type only&quot;</span>);</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;  <span class="keywordtype">bool</span> Is32Bit = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 32;</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160; </div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;  <span class="comment">// INSTRri form with positive arithmetic immediate.</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Fns = selectArithImmed(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;    <span class="keywordflow">return</span> emitInstr(AddrModeAndSizeToOpcode[0][Is32Bit], {Dst}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>},</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;                     MIRBuilder, Fns);</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160; </div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;  <span class="comment">// INSTRri form with negative arithmetic immediate.</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Fns = selectNegArithImmed(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;    <span class="keywordflow">return</span> emitInstr(AddrModeAndSizeToOpcode[3][Is32Bit], {Dst}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>},</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                     MIRBuilder, Fns);</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160; </div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;  <span class="comment">// INSTRrx form.</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Fns = selectArithExtendedRegister(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;    <span class="keywordflow">return</span> emitInstr(AddrModeAndSizeToOpcode[4][Is32Bit], {Dst}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>},</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;                     MIRBuilder, Fns);</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160; </div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;  <span class="comment">// INSTRrs form.</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Fns = selectShiftedRegister(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;    <span class="keywordflow">return</span> emitInstr(AddrModeAndSizeToOpcode[1][Is32Bit], {Dst}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>},</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;                     MIRBuilder, Fns);</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;  <span class="keywordflow">return</span> emitInstr(AddrModeAndSizeToOpcode[2][Is32Bit], {Dst}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>},</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;                   MIRBuilder);</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;}</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160; </div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;AArch64InstructionSelector::emitADD(<a class="code" href="classllvm_1_1Register.html">Register</a> DefReg, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;                                    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;                                    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;  <span class="keyword">const</span> std::array&lt;std::array&lt;unsigned, 2&gt;, 5&gt; OpcTable{</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      {{AArch64::ADDXri, AArch64::ADDWri},</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;       {AArch64::ADDXrs, AArch64::ADDWrs},</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;       {AArch64::ADDXrr, AArch64::ADDWrr},</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;       {AArch64::SUBXri, AArch64::SUBWri},</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;       {AArch64::ADDXrx, AArch64::ADDWrx}}};</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;  <span class="keywordflow">return</span> emitAddSub(OpcTable, DefReg, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder);</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;}</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160; </div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;AArch64InstructionSelector::emitADDS(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;                                     <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;                                     <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;  <span class="keyword">const</span> std::array&lt;std::array&lt;unsigned, 2&gt;, 5&gt; OpcTable{</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;      {{AArch64::ADDSXri, AArch64::ADDSWri},</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;       {AArch64::ADDSXrs, AArch64::ADDSWrs},</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;       {AArch64::ADDSXrr, AArch64::ADDSWrr},</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;       {AArch64::SUBSXri, AArch64::SUBSWri},</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;       {AArch64::ADDSXrx, AArch64::ADDSWrx}}};</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;  <span class="keywordflow">return</span> emitAddSub(OpcTable, Dst, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder);</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;}</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160; </div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;AArch64InstructionSelector::emitSUBS(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;                                     <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                                     <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;  <span class="keyword">const</span> std::array&lt;std::array&lt;unsigned, 2&gt;, 5&gt; OpcTable{</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;      {{AArch64::SUBSXri, AArch64::SUBSWri},</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;       {AArch64::SUBSXrs, AArch64::SUBSWrs},</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;       {AArch64::SUBSXrr, AArch64::SUBSWrr},</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;       {AArch64::ADDSXri, AArch64::ADDSWri},</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;       {AArch64::SUBSXrx, AArch64::SUBSWrx}}};</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;  <span class="keywordflow">return</span> emitAddSub(OpcTable, Dst, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder);</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;}</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160; </div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;AArch64InstructionSelector::emitCMN(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                                    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">getMF</a>().<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;  <span class="keywordtype">bool</span> Is32Bit = (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32);</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;  <span class="keyword">auto</span> RC = Is32Bit ? &amp;AArch64::GPR32RegClass : &amp;AArch64::GPR64RegClass;</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;  <span class="keywordflow">return</span> emitADDS(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(RC), <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder);</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;}</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160; </div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;AArch64InstructionSelector::emitTST(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;                                    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.isReg() &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.isReg() &amp;&amp; <span class="stringliteral">&quot;Expected register operands?&quot;</span>);</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">getMF</a>().<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg());</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="AArch64MIPeepholeOpt_8cpp.html#a9c374320ed4e895f9afa199987182bd2">RegSize</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;  <span class="keywordtype">bool</span> Is32Bit = (<a class="code" href="AArch64MIPeepholeOpt_8cpp.html#a9c374320ed4e895f9afa199987182bd2">RegSize</a> == 32);</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpcTable[3][2] = {{AArch64::ANDSXri, AArch64::ANDSWri},</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                                   {AArch64::ANDSXrs, AArch64::ANDSWrs},</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;                                   {AArch64::ANDSXrr, AArch64::ANDSWrr}};</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;  <span class="comment">// ANDS needs a logical immediate for its immediate form. Check if we can</span></div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;  <span class="comment">// fold one in.</span></div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ValAndVReg = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;    int64_t <a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a> = ValAndVReg-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160; </div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AArch64__AM.html#a262431cccd14e6063eacc180130a5882">AArch64_AM::isLogicalImmediate</a>(<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a>, <a class="code" href="AArch64MIPeepholeOpt_8cpp.html#a9c374320ed4e895f9afa199987182bd2">RegSize</a>)) {</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;      <span class="keyword">auto</span> TstMI = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(OpcTable[0][Is32Bit], {Ty}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>});</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;      TstMI.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="namespacellvm_1_1AArch64__AM.html#a832ad315a355f4ddcc32f189f34e28a9">AArch64_AM::encodeLogicalImmediate</a>(<a class="code" href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">Imm</a>, <a class="code" href="AArch64MIPeepholeOpt_8cpp.html#a9c374320ed4e895f9afa199987182bd2">RegSize</a>));</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*TstMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;      <span class="keywordflow">return</span> &amp;*TstMI;</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;    }</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;  }</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160; </div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Fns = selectLogicalShiftedRegister(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;    <span class="keywordflow">return</span> emitInstr(OpcTable[1][Is32Bit], {Ty}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>}, MIRBuilder, Fns);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;  <span class="keywordflow">return</span> emitInstr(OpcTable[2][Is32Bit], {Ty}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>}, MIRBuilder);</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;}</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160; </div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitIntegerCompare(</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>,</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.isReg() &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.isReg() &amp;&amp; <span class="stringliteral">&quot;Expected LHS and RHS to be registers!&quot;</span>);</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>.isPredicate() &amp;&amp; <span class="stringliteral">&quot;Expected predicate?&quot;</span>);</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">getMF</a>().<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> CmpTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg());</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!CmpTy.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected scalar or pointer&quot;</span>);</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = CmpTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;  (void)<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 32 || <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 64) &amp;&amp; <span class="stringliteral">&quot;Expected a 32-bit or 64-bit LHS/RHS?&quot;</span>);</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;  <span class="comment">// Fold the compare into a cmn or tst if possible.</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> FoldCmp = tryFoldIntegerCompare(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>, MIRBuilder))</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;    <span class="keywordflow">return</span> FoldCmp;</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;  <span class="keyword">auto</span> Dst = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#ac27689339b95eeb89bc9e40aa1e394f9">cloneVirtualRegister</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg());</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;  <span class="keywordflow">return</span> emitSUBS(Dst, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder);</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;}</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160; </div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitCSetForFCmp(</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Dst);</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32 &amp;&amp;</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;         <span class="stringliteral">&quot;Expected a 32-bit scalar register?&quot;</span>);</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> ZReg = AArch64::WZR;</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> CC1, CC2;</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64GISelUtils.html#a6ac70c96c3ec3ca110703f1ebfe5e0ef">changeFCMPPredToAArch64CC</a>(Pred, CC1, CC2);</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;  <span class="keyword">auto</span> InvCC1 = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(CC1);</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;  <span class="keywordflow">if</span> (CC2 == <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>)</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;    <span class="keywordflow">return</span> emitCSINC(<span class="comment">/*Dst=*/</span>Dst, <span class="comment">/*Src1=*/</span>ZReg, <span class="comment">/*Src2=*/</span>ZReg, InvCC1,</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;                     MIRBuilder);</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC = &amp;AArch64::GPR32RegClass;</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Def1Reg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(RC);</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Def2Reg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(RC);</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;  <span class="keyword">auto</span> InvCC2 = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(CC2);</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;  emitCSINC(<span class="comment">/*Dst=*/</span>Def1Reg, <span class="comment">/*Src1=*/</span>ZReg, <span class="comment">/*Src2=*/</span>ZReg, InvCC1, MIRBuilder);</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;  emitCSINC(<span class="comment">/*Dst=*/</span>Def2Reg, <span class="comment">/*Src1=*/</span>ZReg, <span class="comment">/*Src2=*/</span>ZReg, InvCC2, MIRBuilder);</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;  <span class="keyword">auto</span> OrMI = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::ORRWrr, {Dst}, {Def1Reg, Def2Reg});</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*OrMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;  <span class="keywordflow">return</span> &amp;*OrMI;</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;}</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160; </div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitFPCompare(</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder,</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;    std::optional&lt;CmpInst::Predicate&gt; Pred)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;  <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>())</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;  <span class="keywordtype">unsigned</span> OpSize = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;  <span class="keywordflow">if</span> (OpSize != 32 &amp;&amp; OpSize != 64)</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160; </div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;  <span class="comment">// If this is a compare against +0.0, then we don&#39;t have</span></div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;  <span class="comment">// to explicitly materialize a constant.</span></div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *FPImm = <a class="code" href="namespacellvm.html#a1175ca529ece1df77d922f75a8726f56">getConstantFPVRegVal</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;  <span class="keywordtype">bool</span> ShouldUseImm = FPImm &amp;&amp; (FPImm-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#ae46c23ed39de6de6cf9ec6e57755e4c5">isZero</a>() &amp;&amp; !FPImm-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a684130a8a53c04cbd92881243d6a5ae1">isNegative</a>());</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160; </div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;  <span class="keyword">auto</span> IsEqualityPred = [](<a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) {</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> == CmpInst::FCMP_OEQ || <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> == CmpInst::FCMP_ONE ||</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;           <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> == CmpInst::FCMP_UEQ || <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> == CmpInst::FCMP_UNE;</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;  };</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;  <span class="keywordflow">if</span> (!ShouldUseImm &amp;&amp; Pred &amp;&amp; IsEqualityPred(*Pred)) {</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;    <span class="comment">// Try commutating the operands.</span></div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *LHSImm = <a class="code" href="namespacellvm.html#a1175ca529ece1df77d922f75a8726f56">getConstantFPVRegVal</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;    <span class="keywordflow">if</span> (LHSImm &amp;&amp; (LHSImm-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#ae46c23ed39de6de6cf9ec6e57755e4c5">isZero</a>() &amp;&amp; !LHSImm-&gt;<a class="code" href="classllvm_1_1ConstantFP.html#a684130a8a53c04cbd92881243d6a5ae1">isNegative</a>())) {</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      ShouldUseImm = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;    }</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;  }</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;  <span class="keywordtype">unsigned</span> CmpOpcTbl[2][2] = {{AArch64::FCMPSrr, AArch64::FCMPDrr},</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                              {AArch64::FCMPSri, AArch64::FCMPDri}};</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;  <span class="keywordtype">unsigned</span> CmpOpc = CmpOpcTbl[ShouldUseImm][OpSize == 64];</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160; </div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;  <span class="comment">// Partially build the compare. Decide if we need to add a use for the</span></div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;  <span class="comment">// third operand based off whether or not we&#39;re comparing against 0.0.</span></div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;  <span class="keyword">auto</span> CmpMI = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(CmpOpc).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;  CmpMI.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">setMIFlags</a>(MachineInstr::NoFPExcept);</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;  <span class="keywordflow">if</span> (!ShouldUseImm)</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;    CmpMI.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*CmpMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;  <span class="keywordflow">return</span> &amp;*CmpMI;</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;}</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160; </div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitVectorConcat(</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    std::optional&lt;Register&gt; Dst, <a class="code" href="classllvm_1_1Register.html">Register</a> Op1, <a class="code" href="classllvm_1_1Register.html">Register</a> Op2,</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;  <span class="comment">// We implement a vector concat by:</span></div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;  <span class="comment">// 1. Use scalar_to_vector to insert the lower vector into the larger dest</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;  <span class="comment">// 2. Insert the upper vector into the destination&#39;s upper element</span></div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;  <span class="comment">// TODO: some of this code is common with G_BUILD_VECTOR handling.</span></div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">getMF</a>().<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160; </div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> Op1Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Op1);</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> Op2Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Op2);</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160; </div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;  <span class="keywordflow">if</span> (Op1Ty != Op2Ty) {</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not do vector concat of differing vector tys&quot;</span>);</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;  }</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Op1Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected a vector for vector concat&quot;</span>);</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160; </div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;  <span class="keywordflow">if</span> (Op1Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt;= 128) {</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Vector concat not supported for full size vectors&quot;</span>);</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;  }</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160; </div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;  <span class="comment">// At the moment we just support 64 bit vector concats.</span></div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;  <span class="keywordflow">if</span> (Op1Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 64) {</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Vector concat supported for 64b vectors&quot;</span>);</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;  }</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160; </div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> ScalarTy = LLT::scalar(Op1Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>());</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;FPRBank = *RBI.getRegBank(Op1, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC =</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;      getRegClassForTypeOnBank(Op1Ty.<a class="code" href="classllvm_1_1LLT.html#a52cd802a268f6ed25d878c96d8b16247">multiplyElements</a>(2), FPRBank);</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160; </div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *WidenedOp1 =</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;      emitScalarToVector(ScalarTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>(), DstRC, Op1, MIRBuilder);</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *WidenedOp2 =</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      emitScalarToVector(ScalarTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>(), DstRC, Op2, MIRBuilder);</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;  <span class="keywordflow">if</span> (!WidenedOp1 || !WidenedOp2) {</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not emit a vector from scalar value&quot;</span>);</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;  }</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160; </div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;  <span class="comment">// Now do the insert of the upper element.</span></div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;  <span class="keywordtype">unsigned</span> InsertOpc, InsSubRegIdx;</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;  std::tie(InsertOpc, InsSubRegIdx) =</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#a03ac2c8c129b06df3ea6bc3bd65e871d">getInsertVecEltOpInfo</a>(FPRBank, ScalarTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>());</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160; </div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;  <span class="keywordflow">if</span> (!Dst)</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;    Dst = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(DstRC);</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;  <span class="keyword">auto</span> InsElt =</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      MIRBuilder</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;          .<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(InsertOpc, {*Dst}, {WidenedOp1-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>()})</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;          .addImm(1) <span class="comment">/* Lane index */</span></div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(WidenedOp2-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>())</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;          .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0);</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*InsElt, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;  <span class="keywordflow">return</span> &amp;*InsElt;</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;}</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160; </div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;AArch64InstructionSelector::emitCSINC(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1Register.html">Register</a> Src1,</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;                                      <a class="code" href="classllvm_1_1Register.html">Register</a> Src2, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> Pred,</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                                      <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1PointerUnion.html">RegClassOrRegBank</a> &amp;RegClassOrBank = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a68db11947d61455d62d75b86020362c9">getRegClassOrRegBank</a>(Dst);</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;  <span class="comment">// If we used a register class, then this won&#39;t necessarily have an LLT.</span></div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;  <span class="comment">// Compute the size based off whether or not we have a class or bank.</span></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *RC = RegClassOrBank.<a class="code" href="classllvm_1_1PointerUnion.html#a9147352f78d98ee246f25d3300e0aaba">dyn_cast</a>&lt;<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *&gt;())</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;    <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a251557179fe64bb09bd7e327c60c6b24">getRegSizeInBits</a>(*RC);</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Dst).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;  <span class="comment">// Some opcodes use s1.</span></div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> &lt;= 64 &amp;&amp; <span class="stringliteral">&quot;Expected 64 bits or less only!&quot;</span>);</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> OpcTable[2] = {AArch64::CSINCWr, AArch64::CSINCXr};</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;  <span class="keywordtype">unsigned</span> Opc = OpcTable[<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 64];</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19a4a963d58bfd84cd339df4a7c57f8764e">CSINC</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {Dst}, {Src1, Src2}).addImm(Pred);</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19a4a963d58bfd84cd339df4a7c57f8764e">CSINC</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;  <span class="keywordflow">return</span> &amp;*<a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19a4a963d58bfd84cd339df4a7c57f8764e">CSINC</a>;</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;}</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160; </div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;std::pair&lt;MachineInstr *, AArch64CC::CondCode&gt;</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;AArch64InstructionSelector::emitOverflowOp(<span class="keywordtype">unsigned</span> Opcode, <a class="code" href="classllvm_1_1Register.html">Register</a> Dst,</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;                                           <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;                                           <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;                                           <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;  <span class="keywordflow">switch</span> (Opcode) {</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected opcode!&quot;</span>);</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SADDO:</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;    <span class="keywordflow">return</span> std::make_pair(emitADDS(Dst, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder), <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a9f54e5976c204d779cee3d87cabf0b02">AArch64CC::VS</a>);</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_UADDO:</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;    <span class="keywordflow">return</span> std::make_pair(emitADDS(Dst, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder), <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">AArch64CC::HS</a>);</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SSUBO:</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;    <span class="keywordflow">return</span> std::make_pair(emitSUBS(Dst, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder), <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a9f54e5976c204d779cee3d87cabf0b02">AArch64CC::VS</a>);</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_USUBO:</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;    <span class="keywordflow">return</span> std::make_pair(emitSUBS(Dst, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder), <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab620924321db413fcc748afe522c2303">AArch64CC::LO</a>);</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;  }</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;}</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="comment">/// Returns true if @p Val is a tree of AND/OR/CMP operations that can be</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="comment">/// expressed as a conjunction.</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="comment">/// \param CanNegate    Set to true if we can negate the whole sub-tree just by</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;<span class="comment">///                     changing the conditions on the CMP tests.</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="comment">///                     (this means we can call emitConjunctionRec() with</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="comment">///                      Negate==true on this sub-tree)</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="comment">/// \param MustBeFirst  Set to true if this subtree needs to be negated and we</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="comment">///                     cannot do the negation naturally. We are required to</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;<span class="comment">///                     emit the subtree first in this case.</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;<span class="comment">/// \param WillNegate   Is true if are called when the result of this</span></div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;<span class="comment">///                     subexpression must be negated. This happens when the</span></div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;<span class="comment">///                     outer expression is an OR. We can use this fact to know</span></div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="comment">///                     that we have a double negation (or (or ...) ...) that</span></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="comment">///                     can be implemented for free.</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb"> 4808</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb">canEmitConjunction</a>(<a class="code" href="classllvm_1_1Register.html">Register</a> Val, <span class="keywordtype">bool</span> &amp;CanNegate, <span class="keywordtype">bool</span> &amp;MustBeFirst,</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                               <span class="keywordtype">bool</span> WillNegate, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                               <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> = 0) {</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(Val))</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ValDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(Val);</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = ValDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;  <span class="keywordflow">if</span> (isa&lt;GAnyCmp&gt;(ValDef)) {</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;    CanNegate = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;    MustBeFirst = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;  }</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;  <span class="comment">// Protect against exponential runtime and stack overflow.</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> &gt; 6)</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;  <span class="keywordflow">if</span> (Opcode == TargetOpcode::G_AND || Opcode == TargetOpcode::G_OR) {</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;    <span class="keywordtype">bool</span> IsOR = Opcode == TargetOpcode::G_OR;</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> O0 = ValDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> O1 = ValDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;    <span class="keywordtype">bool</span> CanNegateL;</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;    <span class="keywordtype">bool</span> MustBeFirstL;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb">canEmitConjunction</a>(O0, CanNegateL, MustBeFirstL, IsOR, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> + 1))</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;    <span class="keywordtype">bool</span> CanNegateR;</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;    <span class="keywordtype">bool</span> MustBeFirstR;</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb">canEmitConjunction</a>(O1, CanNegateR, MustBeFirstR, IsOR, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> + 1))</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160; </div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;    <span class="keywordflow">if</span> (MustBeFirstL &amp;&amp; MustBeFirstR)</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160; </div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;    <span class="keywordflow">if</span> (IsOR) {</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;      <span class="comment">// For an OR expression we need to be able to naturally negate at least</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;      <span class="comment">// one side or we cannot do the transformation at all.</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;      <span class="keywordflow">if</span> (!CanNegateL &amp;&amp; !CanNegateR)</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;      <span class="comment">// If we the result of the OR will be negated and we can naturally negate</span></div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;      <span class="comment">// the leaves, then this sub-tree as a whole negates naturally.</span></div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      CanNegate = WillNegate &amp;&amp; CanNegateL &amp;&amp; CanNegateR;</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <span class="comment">// If we cannot naturally negate the whole sub-tree, then this must be</span></div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      <span class="comment">// emitted first.</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      MustBeFirst = !CanNegate;</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Opcode == TargetOpcode::G_AND &amp;&amp; <span class="stringliteral">&quot;Must be G_AND&quot;</span>);</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      <span class="comment">// We cannot naturally negate an AND operation.</span></div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      CanNegate = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      MustBeFirst = MustBeFirstL || MustBeFirstR;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;    }</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;  }</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;}</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160; </div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ISelLowering_8cpp.html#a02f6de82e3085eef9b1ad0ebe9b2d500">AArch64InstructionSelector::emitConditionalComparison</a>(</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>,</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;    <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> OutCC,</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;  <span class="comment">// TODO: emit CMN as an optimization.</span></div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> OpTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OpTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32 || OpTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 64);</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;  <span class="keywordtype">unsigned</span> CCmpOpc;</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;  std::optional&lt;ValueAndVReg&gt; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;  <span class="keywordflow">if</span> (CmpInst::isIntPredicate(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>)) {</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;    <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> &amp;&amp; <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;Value.ult(32))</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;      CCmpOpc = OpTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32 ? AArch64::CCMPWi : AArch64::CCMPXi;</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      CCmpOpc = OpTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32 ? AArch64::CCMPWr : AArch64::CCMPXr;</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;    <span class="keywordflow">switch</span> (OpTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>()) {</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;      CCmpOpc = AArch64::FCCMPHrr;</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;      CCmpOpc = AArch64::FCCMPSrr;</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;    <span class="keywordflow">case</span> 64:</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;      CCmpOpc = AArch64::FCCMPDrr;</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;    }</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;  }</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> InvOutCC = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(OutCC);</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;  <span class="keywordtype">unsigned</span> NZCV = <a class="code" href="namespacellvm_1_1AArch64CC.html#affed553a12fdb2f42041ea371820e01f">AArch64CC::getNZCVToSatisfyCondCode</a>(InvOutCC);</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;  <span class="keyword">auto</span> CCmp =</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(CCmpOpc, {}, {<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>});</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;  <span class="keywordflow">if</span> (CCmpOpc == AArch64::CCMPWi || CCmpOpc == AArch64::CCMPXi)</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;    CCmp.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>-&gt;Value.getZExtValue());</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;    CCmp.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;  CCmp.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(NZCV).<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>);</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*CCmp, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;  <span class="keywordflow">return</span> &amp;*CCmp;</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;}</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160; </div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ISelLowering_8cpp.html#a588e5dcf7ccf9ec2b6922f24c012a08a">AArch64InstructionSelector::emitConjunctionRec</a>(</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Val, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;OutCC, <span class="keywordtype">bool</span> Negate, <a class="code" href="classllvm_1_1Register.html">Register</a> CCOp,</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;    <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;  <span class="comment">// We&#39;re at a tree leaf, produce a conditional comparison operation.</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ValDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(Val);</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;  <span class="keywordtype">unsigned</span> Opcode = ValDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Cmp = dyn_cast&lt;GAnyCmp&gt;(ValDef)) {</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getLHSReg();</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getRHSReg();</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;    <a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getCond();</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;    <span class="keywordflow">if</span> (Negate)</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;      <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a> = CmpInst::getInversePredicate(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;    <span class="keywordflow">if</span> (isa&lt;GICmp&gt;(Cmp)) {</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;      OutCC = <a class="code" href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e">changeICMPPredToAArch64CC</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;      <span class="comment">// Handle special FP cases.</span></div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;      <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> ExtraCC;</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#a35ad100b6df3a31a99a57b0e7ebbac7a">changeFPCCToANDAArch64CC</a>(<a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>, OutCC, ExtraCC);</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;      <span class="comment">// Some floating point conditions can&#39;t be tested with a single condition</span></div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;      <span class="comment">// code. Construct an additional comparison in this case.</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;      <span class="keywordflow">if</span> (ExtraCC != <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>) {</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;        <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ExtraCmp;</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;        <span class="keywordflow">if</span> (!CCOp)</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;          ExtraCmp = emitFPCompare(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIB, <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>);</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;          ExtraCmp =</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;              <a class="code" href="AArch64ISelLowering_8cpp.html#a02f6de82e3085eef9b1ad0ebe9b2d500">emitConditionalComparison</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>, <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>, ExtraCC, MIB);</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;        CCOp = ExtraCmp-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;        <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a> = ExtraCC;</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;      }</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;    }</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160; </div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;    <span class="comment">// Produce a normal comparison if we are first in the chain</span></div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;    <span class="keywordflow">if</span> (!CCOp) {</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;      <span class="keyword">auto</span> Dst = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#ac27689339b95eeb89bc9e40aa1e394f9">cloneVirtualRegister</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;      <span class="keywordflow">if</span> (isa&lt;GICmp&gt;(Cmp))</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;        <span class="keywordflow">return</span> emitSUBS(Dst, <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(2), <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(3), MIB);</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;      <span class="keywordflow">return</span> emitFPCompare(<a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(2).getReg(),</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;                           <a class="code" href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;getOperand(3).getReg(), MIB);</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;    }</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;    <span class="comment">// Otherwise produce a ccmp.</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="AArch64ISelLowering_8cpp.html#a02f6de82e3085eef9b1ad0ebe9b2d500">emitConditionalComparison</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a>, <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>, OutCC, MIB);</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;  }</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(Val) &amp;&amp; <span class="stringliteral">&quot;Valid conjunction/disjunction tree&quot;</span>);</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160; </div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;  <span class="keywordtype">bool</span> IsOR = Opcode == TargetOpcode::G_OR;</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160; </div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = ValDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;  <span class="keywordtype">bool</span> CanNegateL;</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;  <span class="keywordtype">bool</span> MustBeFirstL;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;  <span class="keywordtype">bool</span> ValidL = <a class="code" href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb">canEmitConjunction</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, CanNegateL, MustBeFirstL, IsOR, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ValidL &amp;&amp; <span class="stringliteral">&quot;Valid conjunction/disjunction tree&quot;</span>);</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;  (void)ValidL;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160; </div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = ValDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;  <span class="keywordtype">bool</span> CanNegateR;</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;  <span class="keywordtype">bool</span> MustBeFirstR;</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;  <span class="keywordtype">bool</span> ValidR = <a class="code" href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb">canEmitConjunction</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, CanNegateR, MustBeFirstR, IsOR, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ValidR &amp;&amp; <span class="stringliteral">&quot;Valid conjunction/disjunction tree&quot;</span>);</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;  (void)ValidR;</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160; </div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;  <span class="comment">// Swap sub-tree that must come first to the right side.</span></div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;  <span class="keywordflow">if</span> (MustBeFirstL) {</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!MustBeFirstR &amp;&amp; <span class="stringliteral">&quot;Valid conjunction/disjunction tree&quot;</span>);</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(CanNegateL, CanNegateR);</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(MustBeFirstL, MustBeFirstR);</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;  }</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160; </div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;  <span class="keywordtype">bool</span> NegateR;</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  <span class="keywordtype">bool</span> NegateAfterR;</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;  <span class="keywordtype">bool</span> NegateL;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;  <span class="keywordtype">bool</span> NegateAfterAll;</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;  <span class="keywordflow">if</span> (Opcode == TargetOpcode::G_OR) {</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;    <span class="comment">// Swap the sub-tree that we can negate naturally to the left.</span></div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;    <span class="keywordflow">if</span> (!CanNegateL) {</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CanNegateR &amp;&amp; <span class="stringliteral">&quot;at least one side must be negatable&quot;</span>);</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!MustBeFirstR &amp;&amp; <span class="stringliteral">&quot;invalid conjunction/disjunction tree&quot;</span>);</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Negate);</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;      <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;      NegateR = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;      NegateAfterR = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;      <span class="comment">// Negate the left sub-tree if possible, otherwise negate the result.</span></div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;      NegateR = CanNegateR;</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;      NegateAfterR = !CanNegateR;</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;    }</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;    NegateL = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    NegateAfterAll = !Negate;</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Opcode == TargetOpcode::G_AND &amp;&amp;</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;           <span class="stringliteral">&quot;Valid conjunction/disjunction tree&quot;</span>);</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Negate &amp;&amp; <span class="stringliteral">&quot;Valid conjunction/disjunction tree&quot;</span>);</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160; </div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;    NegateL = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    NegateR = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;    NegateAfterR = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;    NegateAfterAll = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;  }</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160; </div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;  <span class="comment">// Emit sub-trees.</span></div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> RHSCC;</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *CmpR =</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;      <a class="code" href="AArch64ISelLowering_8cpp.html#a588e5dcf7ccf9ec2b6922f24c012a08a">emitConjunctionRec</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, RHSCC, NegateR, CCOp, <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>, MIB);</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;  <span class="keywordflow">if</span> (NegateAfterR)</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;    RHSCC = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(RHSCC);</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *CmpL = <a class="code" href="AArch64ISelLowering_8cpp.html#a588e5dcf7ccf9ec2b6922f24c012a08a">emitConjunctionRec</a>(</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, OutCC, NegateL, CmpR-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), RHSCC, MIB);</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;  <span class="keywordflow">if</span> (NegateAfterAll)</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;    OutCC = <a class="code" href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">AArch64CC::getInvertedCondCode</a>(OutCC);</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;  <span class="keywordflow">return</span> CmpL;</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;}</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160; </div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="AArch64ISelLowering_8cpp.html#af25c3ad8dd30f33b93e7540b8fbd27df">AArch64InstructionSelector::emitConjunction</a>(</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Val, <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> &amp;OutCC, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;  <span class="keywordtype">bool</span> DummyCanNegate;</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;  <span class="keywordtype">bool</span> DummyMustBeFirst;</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb">canEmitConjunction</a>(Val, DummyCanNegate, DummyMustBeFirst, <span class="keyword">false</span>,</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;                          *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>()))</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="AArch64ISelLowering_8cpp.html#a588e5dcf7ccf9ec2b6922f24c012a08a">emitConjunctionRec</a>(Val, OutCC, <span class="keyword">false</span>, <a class="code" href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(), <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>, MIB);</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;}</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160; </div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::tryOptSelectConjunction(<a class="code" href="classllvm_1_1GSelect.html">GSelect</a> &amp;SelI,</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;                                                         <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;CondMI) {</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> AArch64CC;</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ConjMI = <a class="code" href="AArch64ISelLowering_8cpp.html#af25c3ad8dd30f33b93e7540b8fbd27df">emitConjunction</a>(SelI.<a class="code" href="classllvm_1_1GSelect.html#a6ef78494a917cd68f35d479588ec82dc">getCondReg</a>(), AArch64CC, MIB);</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;  <span class="keywordflow">if</span> (!ConjMI)</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160; </div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;  emitSelect(SelI.<a class="code" href="classllvm_1_1GenericMachineInstr.html#a2cdf10ff4f5fb865c6a669331aeb5846">getReg</a>(0), SelI.<a class="code" href="classllvm_1_1GSelect.html#aeda560c01a804707f60e96f3d9a9404a">getTrueReg</a>(), SelI.<a class="code" href="classllvm_1_1GSelect.html#ac53d2f333a28421f2f18a7867d3053dc">getFalseReg</a>(), AArch64CC, MIB);</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;  SelI.<a class="code" href="classllvm_1_1MachineInstr.html#ac2421adbb9996e1b15f03a8abb6c70a8">eraseFromParent</a>();</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;}</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160; </div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::tryOptSelect(<a class="code" href="classllvm_1_1GSelect.html">GSelect</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;  <span class="comment">// We want to recognize this pattern:</span></div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;  <span class="comment">// $z = G_FCMP pred, $x, $y</span></div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;  <span class="comment">// ...</span></div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;  <span class="comment">// $w = G_SELECT $z, $a, $b</span></div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;  <span class="comment">// Where the value of $z is *only* ever used by the G_SELECT (possibly with</span></div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;  <span class="comment">// some copies/truncs in between.)</span></div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;  <span class="comment">// If we see this, then we can emit something like this:</span></div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;  <span class="comment">// fcmp $x, $y</span></div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;  <span class="comment">// fcsel $w, $a, $b, pred</span></div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;  <span class="comment">// Rather than emitting both of the rather long sequences in the standard</span></div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;  <span class="comment">// G_FCMP/G_SELECT select methods.</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160; </div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;  <span class="comment">// First, check if the condition is defined by a compare.</span></div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *CondDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160; </div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;  <span class="comment">// We can only fold if all of the defs have one use.</span></div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> CondDefReg = CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(CondDefReg)) {</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;    <span class="comment">// Unless it&#39;s another select.</span></div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;UI : <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a7e0683c1bfad27f51e8d6c3a8cbdbfdc">use_nodbg_instructions</a>(CondDefReg)) {</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      <span class="keywordflow">if</span> (CondDef == &amp;UI)</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      <span class="keywordflow">if</span> (UI.getOpcode() != TargetOpcode::G_SELECT)</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;    }</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;  }</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160; </div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;  <span class="comment">// Is the condition defined by a compare?</span></div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;  <span class="keywordtype">unsigned</span> CondOpc = CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;  <span class="keywordflow">if</span> (CondOpc != TargetOpcode::G_ICMP &amp;&amp; CondOpc != TargetOpcode::G_FCMP) {</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;    <span class="keywordflow">if</span> (tryOptSelectConjunction(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, *CondDef))</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;  }</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160; </div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a>;</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;  <span class="keywordflow">if</span> (CondOpc == TargetOpcode::G_ICMP) {</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;    <span class="keyword">auto</span> Pred =</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#af0d32d967ac31c4e6149c2adb89aa947">getPredicate</a>());</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;    <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a> = <a class="code" href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e">changeICMPPredToAArch64CC</a>(Pred);</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;    emitIntegerCompare(CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2), CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(3),</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;                       CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1), MIB);</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;    <span class="comment">// Get the condition code for the select.</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;    <span class="keyword">auto</span> Pred =</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#af0d32d967ac31c4e6149c2adb89aa947">getPredicate</a>());</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;    <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">AArch64CC::CondCode</a> CondCode2;</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;    <a class="code" href="namespacellvm_1_1AArch64GISelUtils.html#a6ac70c96c3ec3ca110703f1ebfe5e0ef">changeFCMPPredToAArch64CC</a>(Pred, <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a>, CondCode2);</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160; </div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;    <span class="comment">// changeFCMPPredToAArch64CC sets CondCode2 to AL when we require two</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    <span class="comment">// instructions to emit the comparison.</span></div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;    <span class="comment">// TODO: Handle FCMP_UEQ and FCMP_ONE. After that, this check will be</span></div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;    <span class="comment">// unnecessary.</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;    <span class="keywordflow">if</span> (CondCode2 != <a class="code" href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">AArch64CC::AL</a>)</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160; </div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;    <span class="keywordflow">if</span> (!emitFPCompare(CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(),</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;                       CondDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(3).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), MIB)) {</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t emit compare for select!\n&quot;</span>);</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    }</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;  }</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160; </div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;  <span class="comment">// Emit the select.</span></div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;  emitSelect(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg(),</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;             <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getReg(), <a class="code" href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">CondCode</a>, MIB);</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;}</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160; </div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::tryFoldIntegerCompare(</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>,</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.isReg() &amp;&amp; <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.isReg() &amp;&amp; <a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>.isPredicate() &amp;&amp;</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;         <span class="stringliteral">&quot;Unexpected MachineOperand&quot;</span>);</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;  <span class="comment">// We want to find this sort of thing:</span></div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;  <span class="comment">// x = G_SUB 0, y</span></div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;  <span class="comment">// G_ICMP z, x</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;  <span class="comment">// In this case, we can fold the G_SUB into the G_ICMP using a CMN instead.</span></div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;  <span class="comment">// e.g:</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;  <span class="comment">// cmn z, y</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160; </div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;  <span class="comment">// Check if the RHS or LHS of the G_ICMP is defined by a SUB</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *LHSDef = <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *RHSDef = <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;  <span class="keyword">auto</span> <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a><span class="keyword">&gt;</span>(<a class="code" href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">Predicate</a>.getPredicate());</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;  <span class="comment">// Given this:</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;  <span class="comment">// x = G_SUB 0, y</span></div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;  <span class="comment">// G_ICMP x, z</span></div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;  <span class="comment">// Produce this:</span></div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;  <span class="comment">// cmn y, z</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64ISelLowering_8cpp.html#ade26f57722dfb847f2313d9674fa0cba">isCMN</a>(LHSDef, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;    <span class="keywordflow">return</span> emitCMN(LHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2), <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, MIRBuilder);</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160; </div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;  <span class="comment">// Same idea here, but with the RHS of the compare instead:</span></div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;  <span class="comment">// Given this:</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  <span class="comment">// x = G_SUB 0, y</span></div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;  <span class="comment">// G_ICMP z, x</span></div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;  <span class="comment">// Produce this:</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;  <span class="comment">// cmn z, y</span></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64ISelLowering_8cpp.html#ade26f57722dfb847f2313d9674fa0cba">isCMN</a>(RHSDef, <a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;    <span class="keywordflow">return</span> emitCMN(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, RHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2), MIRBuilder);</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160; </div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;  <span class="comment">// Given this:</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;  <span class="comment">// z = G_AND x, y</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;  <span class="comment">// G_ICMP z, 0</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;  <span class="comment">// Produce this if the compare is signed:</span></div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;  <span class="comment">// tst x, y</span></div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;  <span class="keywordflow">if</span> (!CmpInst::isUnsigned(<a class="code" href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a>) &amp;&amp; LHSDef &amp;&amp;</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;      LHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_AND) {</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;    <span class="comment">// Make sure that the RHS is 0.</span></div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;    <span class="keyword">auto</span> ValAndVReg = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;    <span class="keywordflow">if</span> (!ValAndVReg || ValAndVReg-&gt;Value != 0)</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160; </div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;    <span class="keywordflow">return</span> emitTST(LHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1),</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                   LHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2), MIRBuilder);</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;  }</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160; </div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;}</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160; </div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectShuffleVector(</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src1Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> Src1Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Src1Reg);</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src2Reg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> Src2Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Src2Reg);</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;  <a class="code" href="classllvm_1_1ArrayRef.html">ArrayRef&lt;int&gt;</a> <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getShuffleMask();</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160; </div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent();</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Ctx = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">getFunction</a>().<a class="code" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160; </div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;  <span class="comment">// G_SHUFFLE_VECTOR is weird in that the source operands can be scalars, if</span></div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;  <span class="comment">// it&#39;s originated from a &lt;1 x T&gt; type. Those should have been lowered into</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;  <span class="comment">// G_BUILD_VECTOR earlier.</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;  <span class="keywordflow">if</span> (!Src1Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() || !Src2Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>()) {</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not select a \&quot;scalar\&quot; G_SHUFFLE_VECTOR\n&quot;</span>);</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;  }</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160; </div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;  <span class="keywordtype">unsigned</span> BytesPerElt = DstTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() / 8;</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160; </div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 64&gt;</a> CstIdxs;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Val : <a class="code" href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">Mask</a>) {</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;    <span class="comment">// For now, any undef indexes we&#39;ll just assume to be 0. This should be</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    <span class="comment">// optimized in future, e.g. to select DUP etc.</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    Val = Val &lt; 0 ? 0 : Val;</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Byte = 0; <a class="code" href="namespacellvm_1_1codeview.html#a9cf141c9194799e2fa2d92de4c6e8ff0aa245c3230debe5c956484ecc6fa93877">Byte</a> &lt; BytesPerElt; ++<a class="code" href="namespacellvm_1_1codeview.html#a9cf141c9194799e2fa2d92de4c6e8ff0aa245c3230debe5c956484ecc6fa93877">Byte</a>) {</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = <a class="code" href="namespacellvm_1_1codeview.html#a9cf141c9194799e2fa2d92de4c6e8ff0aa245c3230debe5c956484ecc6fa93877">Byte</a> + Val * BytesPerElt;</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;      CstIdxs.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(<a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantInt::get</a>(Type::getInt8Ty(Ctx), <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>));</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;    }</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;  }</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160; </div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;  <span class="comment">// Use a constant pool to load the index vector for TBL.</span></div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CPVal = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantVector::get</a>(CstIdxs);</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *IndexLoad = emitLoadFromConstantPool(CPVal, MIB);</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;  <span class="keywordflow">if</span> (!IndexLoad) {</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not load from a constant pool&quot;</span>);</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;  }</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160; </div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;  <span class="keywordflow">if</span> (DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 128) {</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 64 &amp;&amp; <span class="stringliteral">&quot;Unexpected shuffle result ty&quot;</span>);</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;    <span class="comment">// This case can be done with TBL1.</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="X86InterleavedAccess_8cpp.html#a76c9562101f54d25482f88ae29ed6131">Concat</a> =</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;        emitVectorConcat(std::nullopt, Src1Reg, Src2Reg, MIB);</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="X86InterleavedAccess_8cpp.html#a76c9562101f54d25482f88ae29ed6131">Concat</a>) {</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not do vector concat for tbl1&quot;</span>);</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;    }</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160; </div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;    <span class="comment">// The constant pool load will be 64 bits, so need to convert to FPR128 reg.</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;    IndexLoad = emitScalarToVector(64, &amp;AArch64::FPR128RegClass,</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;                                   IndexLoad-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), MIB);</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160; </div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;    <span class="keyword">auto</span> TBL1 = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;        AArch64::TBLv16i8One, {&amp;AArch64::FPR128RegClass},</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;        {<a class="code" href="X86InterleavedAccess_8cpp.html#a76c9562101f54d25482f88ae29ed6131">Concat</a>-&gt;getOperand(0).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>(), IndexLoad-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()});</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*TBL1, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160; </div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> =</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>()}, {})</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;            .addReg(TBL1.getReg(0), 0, AArch64::dsub);</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;    RBI.constrainGenericRegister(<a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>.getReg(0), AArch64::FPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;  }</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160; </div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;  <span class="comment">// For TBL2 we need to emit a REG_SEQUENCE to tie together two consecutive</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;  <span class="comment">// Q registers for regalloc.</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Register, 2&gt;</a> Regs = {Src1Reg, Src2Reg};</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;  <span class="keyword">auto</span> RegSeq = <a class="code" href="AArch64InstructionSelector_8cpp.html#af01e8bd1c1aba89ed27081450bb0d9e8">createQTuple</a>(Regs, MIB);</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;  <span class="keyword">auto</span> TBL2 = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::TBLv16i8Two, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)},</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;                             {RegSeq, IndexLoad-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0)});</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*TBL2, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;}</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160; </div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *AArch64InstructionSelector::emitLaneInsert(</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;    std::optional&lt;Register&gt; DstReg, <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg, <a class="code" href="classllvm_1_1Register.html">Register</a> EltReg,</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;    <span class="keywordtype">unsigned</span> LaneIdx, <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB,</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *InsElt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC = &amp;AArch64::FPR128RegClass;</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160; </div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;  <span class="comment">// Create a register to define with the insert if one wasn&#39;t passed in.</span></div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;  <span class="keywordflow">if</span> (!DstReg)</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    DstReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(DstRC);</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160; </div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;  <span class="keywordtype">unsigned</span> EltSize = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(EltReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;  <span class="keywordtype">unsigned</span> Opc = <a class="code" href="AArch64InstructionSelector_8cpp.html#a03ac2c8c129b06df3ea6bc3bd65e871d">getInsertVecEltOpInfo</a>(RB, EltSize).first;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160; </div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;  <span class="keywordflow">if</span> (RB.<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;    <span class="keyword">auto</span> InsSub = emitScalarToVector(EltSize, DstRC, EltReg, MIRBuilder);</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;    InsElt = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {*DstReg}, {SrcReg})</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;                 .addImm(LaneIdx)</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;                 .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(InsSub-&gt;getOperand(0).getReg())</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;                 .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0);</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;    InsElt = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {*DstReg}, {SrcReg})</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;                 .addImm(LaneIdx)</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;                 .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(EltReg);</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;  }</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160; </div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*InsElt, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;  <span class="keywordflow">return</span> InsElt;</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;}</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160; </div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectUSMovFromExtend(</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() != TargetOpcode::G_SEXT &amp;&amp;</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() != TargetOpcode::G_ZEXT &amp;&amp;</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() != TargetOpcode::G_ANYEXT)</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;  <span class="keywordtype">bool</span> IsSigned = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_SEXT;</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DefReg);</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;  <span class="keywordtype">unsigned</span> DstSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160; </div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;  <span class="keywordflow">if</span> (DstSize != 32 &amp;&amp; DstSize != 64)</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160; </div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *Extract = <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_EXTRACT_VECTOR_ELT,</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;                                       <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;  int64_t Lane;</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;  <span class="keywordflow">if</span> (!Extract || !<a class="code" href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">mi_match</a>(Extract-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="namespacellvm_1_1MIPatternMatch.html#a316dd9aa25d9ec9d6d21b56e4296e824">m_ICst</a>(Lane)))</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Src0 = Extract-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160; </div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> &amp;VecTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Src0);</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160; </div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;  <span class="keywordflow">if</span> (VecTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 128) {</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ScalarToVector = emitScalarToVector(</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;        VecTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>(), &amp;AArch64::FPR128RegClass, Src0, MIB);</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ScalarToVector &amp;&amp; <span class="stringliteral">&quot;Didn&#39;t expect emitScalarToVector to fail!&quot;</span>);</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;    Src0 = ScalarToVector-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;  }</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160; </div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;  <span class="keywordtype">unsigned</span> Opcode;</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;  <span class="keywordflow">if</span> (DstSize == 64 &amp;&amp; VecTy.<a class="code" href="classllvm_1_1LLT.html#a32472b5afd0ae6edb4a233a25056a6aa">getScalarSizeInBits</a>() == 32)</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;    Opcode = IsSigned ? AArch64::SMOVvi32to64 : AArch64::UMOVvi32;</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstSize == 64 &amp;&amp; VecTy.<a class="code" href="classllvm_1_1LLT.html#a32472b5afd0ae6edb4a233a25056a6aa">getScalarSizeInBits</a>() == 16)</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;    Opcode = IsSigned ? AArch64::SMOVvi16to64 : AArch64::UMOVvi16;</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstSize == 64 &amp;&amp; VecTy.<a class="code" href="classllvm_1_1LLT.html#a32472b5afd0ae6edb4a233a25056a6aa">getScalarSizeInBits</a>() == 8)</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;    Opcode = IsSigned ? AArch64::SMOVvi8to64 : AArch64::UMOVvi8;</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstSize == 32 &amp;&amp; VecTy.<a class="code" href="classllvm_1_1LLT.html#a32472b5afd0ae6edb4a233a25056a6aa">getScalarSizeInBits</a>() == 16)</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;    Opcode = IsSigned ? AArch64::SMOVvi16to32 : AArch64::UMOVvi16;</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DstSize == 32 &amp;&amp; VecTy.<a class="code" href="classllvm_1_1LLT.html#a32472b5afd0ae6edb4a233a25056a6aa">getScalarSizeInBits</a>() == 8)</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;    Opcode = IsSigned ? AArch64::SMOVvi8to32 : AArch64::UMOVvi8;</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected type combo for S/UMov!&quot;</span>);</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160; </div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;  <span class="comment">// We may need to generate one of these, depending on the type and sign of the</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;  <span class="comment">// input:</span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;  <span class="comment">//  DstReg = SMOV Src0, Lane;</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;  <span class="comment">//  NewReg = UMOV Src0, Lane; DstReg = SUBREG_TO_REG NewReg, sub_32;</span></div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ExtI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;  <span class="keywordflow">if</span> (DstSize == 64 &amp;&amp; !IsSigned) {</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> NewReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR32RegClass);</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opcode, {NewReg}, {Src0}).addImm(Lane);</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;    ExtI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SUBREG_TO_REG, {DefReg}, {})</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;               .addImm(0)</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;               .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(NewReg)</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;               .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AArch64::sub_32);</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;    RBI.constrainGenericRegister(DefReg, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;    ExtI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opcode, {DefReg}, {Src0}).addImm(Lane);</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160; </div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*ExtI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;  <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.eraseFromParent();</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;}</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160; </div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectInsertElt(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;                                                 <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_INSERT_VECTOR_ELT);</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160; </div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;  <span class="comment">// Get information on the destination.</span></div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg);</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1ARMII.html#a7d414894ef8cdc39b147eb7e0d7e4305a479711d0ab662307550fc709665589ea">VecSize</a> = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160; </div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;  <span class="comment">// Get information on the element we want to insert into the destination.</span></div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> EltReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> EltTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(EltReg);</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;  <span class="keywordtype">unsigned</span> EltSize = EltTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;  <span class="keywordflow">if</span> (EltSize &lt; 16 || EltSize &gt; 64)</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Don&#39;t support all element types yet.</span></div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160; </div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;  <span class="comment">// Find the definition of the index. Bail out if it&#39;s not defined by a</span></div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;  <span class="comment">// G_CONSTANT.</span></div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> IdxReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getReg();</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;  <span class="keyword">auto</span> VRegAndVal = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(IdxReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;  <span class="keywordflow">if</span> (!VRegAndVal)</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;  <span class="keywordtype">unsigned</span> LaneIdx = VRegAndVal-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160; </div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;  <span class="comment">// Perform the lane insert.</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;EltRB = *RBI.getRegBank(EltReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160; </div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ARMII.html#a7d414894ef8cdc39b147eb7e0d7e4305a479711d0ab662307550fc709665589ea">VecSize</a> &lt; 128) {</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;    <span class="comment">// If the vector we&#39;re inserting into is smaller than 128 bits, widen it</span></div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;    <span class="comment">// to 128 to do the insert.</span></div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ScalarToVec =</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;        emitScalarToVector(<a class="code" href="namespacellvm_1_1ARMII.html#a7d414894ef8cdc39b147eb7e0d7e4305a479711d0ab662307550fc709665589ea">VecSize</a>, &amp;AArch64::FPR128RegClass, SrcReg, MIB);</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;    <span class="keywordflow">if</span> (!ScalarToVec)</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;    SrcReg = ScalarToVec-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;  }</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160; </div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;  <span class="comment">// Create an insert into a new FPR128 register.</span></div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;  <span class="comment">// Note that if our vector is already 128 bits, we end up emitting an extra</span></div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;  <span class="comment">// register.</span></div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *InsMI =</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;      emitLaneInsert(std::nullopt, SrcReg, EltReg, LaneIdx, EltRB, MIB);</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160; </div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ARMII.html#a7d414894ef8cdc39b147eb7e0d7e4305a479711d0ab662307550fc709665589ea">VecSize</a> &lt; 128) {</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;    <span class="comment">// If we had to widen to perform the insert, then we have to demote back to</span></div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;    <span class="comment">// the original size to get the result we want.</span></div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DemoteVec = InsMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC =</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;        getRegClassForTypeOnBank(DstTy, *RBI.getRegBank(DemoteVec, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>));</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    <span class="keywordflow">if</span> (RC != &amp;AArch64::FPR32RegClass &amp;&amp; RC != &amp;AArch64::FPR64RegClass) {</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unsupported register class!\n&quot;</span>);</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;    }</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = 0;</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(RC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>))</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> != AArch64::ssub &amp;&amp; <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> != AArch64::dsub) {</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unsupported destination size! (&quot;</span> &lt;&lt; <a class="code" href="namespacellvm_1_1ARMII.html#a7d414894ef8cdc39b147eb7e0d7e4305a479711d0ab662307550fc709665589ea">VecSize</a></div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;    }</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {DstReg}, {})</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;        .addReg(DemoteVec, 0, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;    RBI.constrainGenericRegister(DstReg, *RC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;    <span class="comment">// No widening needed.</span></div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;    InsMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(DstReg);</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*InsMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;  }</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160; </div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;}</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160; </div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;AArch64InstructionSelector::emitConstantVector(<a class="code" href="classllvm_1_1Register.html">Register</a> Dst, <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CV,</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;                                               <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIRBuilder,</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;                                               <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Dst);</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;  <span class="keywordtype">unsigned</span> DstSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;  <span class="keywordflow">if</span> (CV-&gt;<a class="code" href="classllvm_1_1Constant.html#ae4b6abe77abf42fb02081a6cc41a0132">isNullValue</a>()) {</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;    <span class="keywordflow">if</span> (DstSize == 128) {</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;      <span class="keyword">auto</span> Mov =</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;          MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::MOVIv2d_ns, {Dst}, {}).addImm(0);</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;      <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Mov, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;      <span class="keywordflow">return</span> &amp;*Mov;</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;    }</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160; </div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;    <span class="keywordflow">if</span> (DstSize == 64) {</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;      <span class="keyword">auto</span> Mov =</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;          MIRBuilder</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;              .<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::MOVIv2d_ns, {&amp;AArch64::FPR128RegClass}, {})</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;              .addImm(0);</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {Dst}, {})</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;                      .addReg(Mov.getReg(0), 0, AArch64::dsub);</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;      RBI.constrainGenericRegister(Dst, AArch64::FPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;      <span class="keywordflow">return</span> &amp;*<a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>;</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;    }</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;  }</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160; </div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;  <span class="keyword">auto</span> *CPLoad = emitLoadFromConstantPool(CV, MIRBuilder);</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;  <span class="keywordflow">if</span> (!CPLoad) {</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Could not generate cp load for constant vector!&quot;</span>);</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;  }</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160; </div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = MIRBuilder.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(Dst, CPLoad-&gt;getOperand(0));</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;  RBI.constrainGenericRegister(</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;      Dst, *<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">getRegClass</a>(CPLoad-&gt;getOperand(0).getReg()), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;  <span class="keywordflow">return</span> &amp;*<a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>;</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;}</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160; </div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::tryOptConstantBuildVec(</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_BUILD_VECTOR);</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;  <span class="keywordtype">unsigned</span> DstSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstSize &lt;= 128 &amp;&amp; <span class="stringliteral">&quot;Unexpected build_vec type!&quot;</span>);</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;  <span class="keywordflow">if</span> (DstSize &lt; 32)</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;  <span class="comment">// Check if we&#39;re building a constant vector, in which case we want to</span></div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;  <span class="comment">// generate a constant pool load instead of a vector insert sequence.</span></div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Constant *, 16&gt;</a> Csts;</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 1; Idx &lt; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumOperands(); ++Idx) {</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;    <span class="comment">// Try to find G_CONSTANT or G_FCONSTANT</span></div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;    <span class="keyword">auto</span> *OpMI =</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;        <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_CONSTANT, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(Idx).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;    <span class="keywordflow">if</span> (OpMI)</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;      Csts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;          <span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<span class="keyword">&gt;</span>(OpMI-&gt;getOperand(1).getCImm()));</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((OpMI = <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_FCONSTANT,</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;                                  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(Idx).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)))</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;      Csts.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;          <span class="keyword">const_cast&lt;</span><a class="code" href="classllvm_1_1ConstantFP.html">ConstantFP</a> *<span class="keyword">&gt;</span>(OpMI-&gt;getOperand(1).getFPImm()));</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;  }</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;  <a class="code" href="classllvm_1_1Constant.html">Constant</a> *CV = <a class="code" href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">ConstantVector::get</a>(Csts);</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;  <span class="keywordflow">if</span> (!emitConstantVector(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(), CV, MIB, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;}</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160; </div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::tryOptBuildVecToSubregToReg(</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  <span class="comment">// Given:</span></div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;  <span class="comment">//  %vec = G_BUILD_VECTOR %elt, %undef, %undef, ... %undef</span></div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;  <span class="comment">// Select the G_BUILD_VECTOR as a SUBREG_TO_REG from %elt.</span></div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> Dst = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> EltReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> EltTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(EltReg);</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;  <span class="comment">// If the index isn&#39;t on the same bank as its elements, then this can&#39;t be a</span></div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;  <span class="comment">// SUBREG_TO_REG.</span></div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;EltRB = *RBI.getRegBank(EltReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;DstRB = *RBI.getRegBank(Dst, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;  <span class="keywordflow">if</span> (EltRB != DstRB)</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands_begin() + 2, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands_end()),</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;             [&amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>](<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>) {</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;               return !getOpcodeDef(TargetOpcode::G_IMPLICIT_DEF, Op.getReg(),</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;                                    MRI);</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;             }))</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>;</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *EltRC = getRegClassForTypeOnBank(EltTy, EltRB);</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  <span class="keywordflow">if</span> (!EltRC)</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC =</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;      getRegClassForTypeOnBank(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Dst), DstRB);</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;  <span class="keywordflow">if</span> (!DstRC)</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(EltRC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>))</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;  <span class="keyword">auto</span> SubregToReg = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SUBREG_TO_REG, {Dst}, {})</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;                         .addImm(0)</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;                         .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(EltReg)</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;                         .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*SubregToReg, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;  <span class="keywordflow">return</span> RBI.constrainGenericRegister(Dst, *DstRC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;}</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160; </div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectBuildVector(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;                                                   <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_BUILD_VECTOR);</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  <span class="comment">// Until we port more of the optimized selections, for now just use a vector</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;  <span class="comment">// insert sequence.</span></div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> DstTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> EltTy = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg());</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;  <span class="keywordtype">unsigned</span> EltSize = EltTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160; </div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;  <span class="keywordflow">if</span> (tryOptConstantBuildVec(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, DstTy, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;  <span class="keywordflow">if</span> (tryOptBuildVecToSubregToReg(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160; </div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;  <span class="keywordflow">if</span> (EltSize != 8 &amp;&amp; EltSize != 16 &amp;&amp; EltSize != 32 &amp;&amp; EltSize != 64)</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Don&#39;t support all element types yet.</span></div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> &amp;RB = *RBI.getRegBank(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160; </div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *DstRC = &amp;AArch64::FPR128RegClass;</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ScalarToVec =</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;      emitScalarToVector(DstTy.<a class="code" href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">getElementType</a>().<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>(), DstRC,</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;                         <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg(), MIB);</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;  <span class="keywordflow">if</span> (!ScalarToVec)</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160; </div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstVec = ScalarToVec-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;  <span class="keywordtype">unsigned</span> DstSize = DstTy.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160; </div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;  <span class="comment">// Keep track of the last MI we inserted. Later on, we might be able to save</span></div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;  <span class="comment">// a copy using it.</span></div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *PrevMI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 2, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = DstSize / EltSize + 1; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;    <span class="comment">// Note that if we don&#39;t do a subregister copy, we can end up making an</span></div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;    <span class="comment">// extra register.</span></div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;    PrevMI = &amp;*emitLaneInsert(std::nullopt, DstVec, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).getReg(),</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;                              <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1, RB, MIB);</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;    DstVec = PrevMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;  }</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160; </div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;  <span class="comment">// If DstTy&#39;s size in bits is less than 128, then emit a subregister copy</span></div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;  <span class="comment">// from DstVec to the last register we&#39;ve defined.</span></div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;  <span class="keywordflow">if</span> (DstSize &lt; 128) {</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;    <span class="comment">// Force this to be FPR using the destination vector.</span></div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *RC =</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;        getRegClassForTypeOnBank(DstTy, *RBI.getRegBank(DstVec, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>));</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;    <span class="keywordflow">if</span> (!RC)</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;    <span class="keywordflow">if</span> (RC != &amp;AArch64::FPR32RegClass &amp;&amp; RC != &amp;AArch64::FPR64RegClass) {</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unsupported register class!\n&quot;</span>);</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;    }</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160; </div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = 0;</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a>(RC, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>))</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> != AArch64::ssub &amp;&amp; <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> != AArch64::dsub) {</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Unsupported destination size! (&quot;</span> &lt;&lt; DstSize</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;    }</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160; </div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(RC);</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160; </div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {DstReg}, {}).addReg(DstVec, 0, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;RegOp = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1);</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;    RegOp.<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;    RBI.constrainGenericRegister(DstReg, *RC, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;    <span class="comment">// We don&#39;t need a subregister copy. Save a copy by re-using the</span></div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;    <span class="comment">// destination register on the final insert.</span></div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PrevMI &amp;&amp; <span class="stringliteral">&quot;PrevMI was null?&quot;</span>);</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;    PrevMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*PrevMI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;  }</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160; </div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;}</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160; </div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectVectorLoadIntrinsic(<span class="keywordtype">unsigned</span> Opc,</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;                                                           <span class="keywordtype">unsigned</span> NumVecs,</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;                                                           <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_INTRINSIC_W_SIDE_EFFECTS);</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Opc &amp;&amp; <span class="stringliteral">&quot;Expected an opcode?&quot;</span>);</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumVecs &gt; 1 &amp;&amp; NumVecs &lt; 5 &amp;&amp; <span class="stringliteral">&quot;Only support 2, 3, or 4 vectors&quot;</span>);</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;  <span class="keyword">auto</span> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;  <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 64 || <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 128) &amp;&amp;</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;         <span class="stringliteral">&quot;Destination must be 64 bits or 128 bits?&quot;</span>);</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> == 64 ? AArch64::dsub0 : AArch64::qsub0;</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;  <span class="keyword">auto</span> <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getNumOperands() - 1).getReg();</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>).<a class="code" href="classllvm_1_1LLT.html#a9d825f5954d7bd527aea490668c624c6">isPointer</a>() &amp;&amp; <span class="stringliteral">&quot;Expected a pointer type?&quot;</span>);</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {Ty}, {<a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>});</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;  <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>.cloneMemRefs(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;  <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> SelectedLoadDst = <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">Load</a>-&gt;getOperand(0).getReg();</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Idx = 0; Idx &lt; NumVecs; ++Idx) {</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;    <span class="keyword">auto</span> Vec = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(TargetOpcode::COPY, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(Idx)}, {})</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;                   .addReg(SelectedLoadDst, 0, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> + Idx);</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    <span class="comment">// Emit the subreg copies and immediately select them.</span></div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;    <span class="comment">// FIXME: We should refactor our copy code into an emitCopy helper and</span></div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;    <span class="comment">// clean up uses of this pattern elsewhere in the selector.</span></div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;    <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(*Vec, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;  }</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;}</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160; </div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectIntrinsicWithSideEffects(</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;  <span class="comment">// Find the intrinsic ID.</span></div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;  <span class="keywordtype">unsigned</span> IntrinID = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getIntrinsicID();</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160; </div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> S8 = LLT::scalar(8);</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> S16 = LLT::scalar(16);</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> S32 = LLT::scalar(32);</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> S64 = LLT::scalar(64);</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> P0 = <a class="code" href="AMDGPUReplaceLDSUseWithPointer_8cpp.html#a9c3943160b95cc42ca8f6e04e6d4e9b6">LLT::pointer</a>(0, 64);</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;  <span class="comment">// Select the instruction.</span></div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;  <span class="keywordflow">switch</span> (IntrinID) {</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;  <span class="keywordflow">case</span> Intrinsic::aarch64_ldxp:</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;  <span class="keywordflow">case</span> Intrinsic::aarch64_ldaxp: {</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;    <span class="keyword">auto</span> NewI = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;        IntrinID == Intrinsic::aarch64_ldxp ? AArch64::LDXPX : AArch64::LDAXPX,</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;        {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg()},</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;        {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3)});</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;    NewI.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#afb84ad0ad64ed2a34f473bbacc268501">cloneMemRefs</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*NewI, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;  }</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;  <span class="keywordflow">case</span> Intrinsic::trap:</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::BRK, {}, {}).addImm(1);</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;  <span class="keywordflow">case</span> Intrinsic::debugtrap:</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::BRK, {}, {}).addImm(0xF000);</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;  <span class="keywordflow">case</span> Intrinsic::ubsantrap:</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::BRK, {}, {})</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;        .addImm(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getImm() | (<span class="charliteral">&#39;U&#39;</span> &lt;&lt; 8));</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;  <span class="keywordflow">case</span> Intrinsic::aarch64_neon_ld2: {</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;    <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;    <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, S8))</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;      Opc = AArch64::LD2Twov8b;</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(16, S8))</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;      Opc = AArch64::LD2Twov16b;</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, S16))</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;      Opc = AArch64::LD2Twov4h;</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, S16))</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;      Opc = AArch64::LD2Twov8h;</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, S32))</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;      Opc = AArch64::LD2Twov2s;</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, S32))</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;      Opc = AArch64::LD2Twov4s;</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, S64) || Ty == LLT::fixed_vector(2, P0))</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;      Opc = AArch64::LD2Twov2d;</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == S64 || Ty == P0)</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;      Opc = AArch64::LD1Twov1d;</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected type for ld2!&quot;</span>);</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;    selectVectorLoadIntrinsic(Opc, 2, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;  }</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;  <span class="keywordflow">case</span> Intrinsic::aarch64_neon_ld4: {</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg());</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;    <span class="keywordtype">unsigned</span> Opc = 0;</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;    <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, S8))</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;      Opc = AArch64::LD4Fourv8b;</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(16, S8))</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;      Opc = AArch64::LD4Fourv16b;</div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, S16))</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;      Opc = AArch64::LD4Fourv4h;</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, S16))</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;      Opc = AArch64::LD4Fourv8h;</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, S32))</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;      Opc = AArch64::LD4Fourv2s;</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, S32))</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;      Opc = AArch64::LD4Fourv4s;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, S64) || Ty == LLT::fixed_vector(2, P0))</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;      Opc = AArch64::LD4Fourv2d;</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == S64 || Ty == P0)</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;      Opc = AArch64::LD1Fourv1d;</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected type for ld4!&quot;</span>);</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;    selectVectorLoadIntrinsic(Opc, 4, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;  }</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;  <span class="keywordflow">case</span> Intrinsic::aarch64_neon_st2: {</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Src1 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getReg();</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Src2 = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getReg();</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;    <a class="code" href="classllvm_1_1LLT.html">LLT</a> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Src1);</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;    <span class="keywordtype">unsigned</span> Opc;</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;    <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, S8))</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;      Opc = AArch64::ST2Twov8b;</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(16, S8))</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;      Opc = AArch64::ST2Twov16b;</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, S16))</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;      Opc = AArch64::ST2Twov4h;</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(8, S16))</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;      Opc = AArch64::ST2Twov8h;</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, S32))</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;      Opc = AArch64::ST2Twov2s;</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(4, S32))</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;      Opc = AArch64::ST2Twov4s;</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == LLT::fixed_vector(2, S64) || Ty == LLT::fixed_vector(2, P0))</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;      Opc = AArch64::ST2Twov2d;</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Ty == S64 || Ty == P0)</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;      Opc = AArch64::ST1Twov1d;</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unexpected type for st2!&quot;</span>);</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Register, 2&gt;</a> Regs = {Src1, Src2};</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> Tuple = Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 128 ? <a class="code" href="AArch64InstructionSelector_8cpp.html#af01e8bd1c1aba89ed27081450bb0d9e8">createQTuple</a>(Regs, MIB)</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;                                               : <a class="code" href="AArch64InstructionSelector_8cpp.html#aafa6584a25c261a3300bcadca8073518">createDTuple</a>(Regs, MIB);</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opc, {}, {Tuple, <a class="code" href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>});</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;    <a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>.cloneMemRefs(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*<a class="code" href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">Store</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;  }</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;  <span class="keywordflow">case</span> Intrinsic::aarch64_mops_memset_tag: {</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;    <span class="comment">// Transform</span></div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;    <span class="comment">//    %dst:gpr(p0) = \</span></div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;<span class="comment">    //      G_INTRINSIC_W_SIDE_EFFECTS intrinsic(@llvm.aarch64.mops.memset.tag),</span></div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;    <span class="comment">//      \ %dst:gpr(p0), %val:gpr(s64), %n:gpr(s64)</span></div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;    <span class="comment">// where %dst is updated, into</span></div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;    <span class="comment">//    %Rd:GPR64common, %Rn:GPR64) = \</span></div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;<span class="comment">    //      MOPSMemorySetTaggingPseudo \</span></div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;<span class="comment">    //      %Rd:GPR64common, %Rn:GPR64, %Rm:GPR64</span></div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;    <span class="comment">// where Rd and Rn are tied.</span></div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;    <span class="comment">// It is expected that %val has been extended to s64 in legalization.</span></div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;    <span class="comment">// Note that the order of the size/value operands are swapped.</span></div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160; </div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstDef = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;    <span class="comment">// I.getOperand(1) is the intrinsic function</span></div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstUse = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> ValUse = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getReg();</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SizeUse = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(4).getReg();</div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160; </div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;    <span class="comment">// MOPSMemorySetTaggingPseudo has two defs; the intrinsic call has only one.</span></div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;    <span class="comment">// Therefore an additional virtual register is requried for the updated size</span></div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;    <span class="comment">// operand. This value is not accessible via the semantics of the intrinsic.</span></div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SizeDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a9694f2906cfe1d6d35bbe6742c67dff0">createGenericVirtualRegister</a>(LLT::scalar(64));</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160; </div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;    <span class="keyword">auto</span> Memset = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::MOPSMemorySetTaggingPseudo,</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;                                 {DstDef, SizeDef}, {DstUse, SizeUse, ValUse});</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;    Memset.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#afb84ad0ad64ed2a34f473bbacc268501">cloneMemRefs</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Memset, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;  }</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;  }</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160; </div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;}</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160; </div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::selectIntrinsic(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;                                                 <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) {</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;  <span class="keywordtype">unsigned</span> IntrinID = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getIntrinsicID();</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160; </div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;  <span class="keywordflow">switch</span> (IntrinID) {</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;  <span class="keywordflow">case</span> Intrinsic::aarch64_crypto_sha1h: {</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> SrcReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160; </div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;    <span class="comment">// FIXME: Should this be an assert?</span></div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(DstReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 32 ||</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;        <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(SrcReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 32)</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160; </div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;    <span class="comment">// The operation has to happen on FPRs. Set up some new FPR registers for</span></div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;    <span class="comment">// the source and destination if they are on GPRs.</span></div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;    <span class="keywordflow">if</span> (RBI.getRegBank(SrcReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() != AArch64::FPRRegBankID) {</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;      SrcReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::FPR32RegClass);</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({SrcReg}, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2)});</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160; </div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;      <span class="comment">// Make sure the copy ends up getting constrained properly.</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;      RBI.constrainGenericRegister(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg(),</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;                                   AArch64::GPR32RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;    }</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160; </div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;    <span class="keywordflow">if</span> (RBI.getRegBank(DstReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)-&gt;getID() != AArch64::FPRRegBankID)</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;      DstReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::FPR32RegClass);</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160; </div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;    <span class="comment">// Actually insert the instruction.</span></div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;    <span class="keyword">auto</span> SHA1Inst = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SHA1Hrr, {DstReg}, {SrcReg});</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*SHA1Inst, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160; </div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;    <span class="comment">// Did we create a new register for the destination?</span></div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;    <span class="keywordflow">if</span> (DstReg != <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg()) {</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;      <span class="comment">// Yep. Copy the result of the instruction back into the original</span></div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;      <span class="comment">// destination.</span></div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0)}, {DstReg});</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;      RBI.constrainGenericRegister(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg(),</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;                                   AArch64::GPR32RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;    }</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160; </div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;  }</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;  <span class="keywordflow">case</span> Intrinsic::ptrauth_sign: {</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> ValReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getImm();</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DiscReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(4).getReg();</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;    <span class="keyword">auto</span> DiscVal = <a class="code" href="namespacellvm.html#a19cdd6010b754ac90ebda5990b03cb40">getIConstantVRegVal</a>(DiscReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;    <span class="keywordtype">bool</span> IsDiscZero = DiscVal &amp;&amp; DiscVal-&gt;isNullValue();</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160; </div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> &gt; <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a759ecca259756790f64e470254a4e886">AArch64PACKey::LAST</a>)</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160; </div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;    <span class="keywordtype">unsigned</span> Opcodes[][4] = {</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;        {AArch64::PACIA, AArch64::PACIB, AArch64::PACDA, AArch64::PACDB},</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;        {AArch64::PACIZA, AArch64::PACIZB, AArch64::PACDZA, AArch64::PACDZB}};</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;    <span class="keywordtype">unsigned</span> Opcode = Opcodes[IsDiscZero][<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>];</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160; </div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;    <span class="keyword">auto</span> PAC = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opcode, {DstReg}, {ValReg});</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160; </div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;    <span class="keywordflow">if</span> (!IsDiscZero) {</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;      PAC.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">addUse</a>(DiscReg);</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;      RBI.constrainGenericRegister(DiscReg, AArch64::GPR64spRegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;    }</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160; </div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;    RBI.constrainGenericRegister(DstReg, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;  }</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;  <span class="keywordflow">case</span> Intrinsic::ptrauth_strip: {</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> ValReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getReg();</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> <a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(3).getImm();</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160; </div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a> &gt; <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a759ecca259756790f64e470254a4e886">AArch64PACKey::LAST</a>)</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;    <span class="keywordtype">unsigned</span> Opcode = <a class="code" href="namespacellvm.html#a2c635acfc68033798540dea72a03fced">getXPACOpcodeForKey</a>((<a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">AArch64PACKey::ID</a>)<a class="code" href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">Key</a>);</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160; </div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(Opcode, {DstReg}, {ValReg});</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160; </div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;    RBI.constrainGenericRegister(DstReg, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;    RBI.constrainGenericRegister(ValReg, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;  }</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;  <span class="keywordflow">case</span> Intrinsic::frameaddress:</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;  <span class="keywordflow">case</span> Intrinsic::returnaddress: {</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;    <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getParent()-&gt;getParent();</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;    <a class="code" href="classllvm_1_1MachineFrameInfo.html">MachineFrameInfo</a> &amp;MFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a18fcadd076ad53e6df94e0ca7a80a9ef">getFrameInfo</a>();</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160; </div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(2).getImm();</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;    RBI.constrainGenericRegister(DstReg, AArch64::GPR64RegClass, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160; </div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> == 0 &amp;&amp; IntrinID == Intrinsic::returnaddress) {</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;      <span class="keywordflow">if</span> (!MFReturnAddr) {</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;        <span class="comment">// Insert the copy from LR/X30 into the entry block, before it can be</span></div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;        <span class="comment">// clobbered by anything.</span></div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;        MFI.<a class="code" href="classllvm_1_1MachineFrameInfo.html#a81b01652144140bfb79c6ffdaff923f9">setReturnAddressIsTaken</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;        MFReturnAddr = <a class="code" href="namespacellvm.html#a02134e88cd18139c71d9274c7d287ac3">getFunctionLiveInPhysReg</a>(</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;            MF, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, AArch64::LR, AArch64::GPR64RegClass, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc());</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;      }</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160; </div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;      <span class="keywordflow">if</span> (STI.hasPAuth()) {</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::XPACI, {DstReg}, {MFReturnAddr});</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({<a class="code" href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(AArch64::LR)}, {MFReturnAddr});</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::XPACLRI);</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({DstReg}, {<a class="code" href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(AArch64::LR)});</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;      }</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160; </div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;      <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;    }</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160; </div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;    MFI.<a class="code" href="classllvm_1_1MachineFrameInfo.html#a4b9a38005d95189db3246e0e4ec6088d">setFrameAddressIsTaken</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> FrameAddr(AArch64::FP);</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>--) {</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> NextFrame = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64spRegClass);</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;      <span class="keyword">auto</span> Ldr =</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;          MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::LDRXui, {NextFrame}, {FrameAddr}).addImm(0);</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;      <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Ldr, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;      FrameAddr = NextFrame;</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;    }</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160; </div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;    <span class="keywordflow">if</span> (IntrinID == Intrinsic::frameaddress)</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({DstReg}, {FrameAddr});</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;      MFI.<a class="code" href="classllvm_1_1MachineFrameInfo.html#a81b01652144140bfb79c6ffdaff923f9">setReturnAddressIsTaken</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160; </div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;      <span class="keywordflow">if</span> (STI.hasPAuth()) {</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;        <a class="code" href="classllvm_1_1Register.html">Register</a> TmpReg = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">createVirtualRegister</a>(&amp;AArch64::GPR64RegClass);</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::LDRXui, {TmpReg}, {FrameAddr}).addImm(1);</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::XPACI, {DstReg}, {TmpReg});</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::LDRXui, {<a class="code" href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(AArch64::LR)}, {FrameAddr})</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;            .addImm(1);</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::XPACLRI);</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;        MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({DstReg}, {<a class="code" href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(AArch64::LR)});</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;      }</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;    }</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160; </div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;  }</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;  <span class="keywordflow">case</span> Intrinsic::swift_async_context_addr:</div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;    <span class="keyword">auto</span> Sub = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">buildInstr</a>(AArch64::SUBXri, {<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(0).getReg()},</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;                              {<a class="code" href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(AArch64::FP)})</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;                   .addImm(8)</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;                   .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0);</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;    <a class="code" href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">constrainSelectedInstRegOperands</a>(*Sub, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160; </div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;    MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#a18fcadd076ad53e6df94e0ca7a80a9ef">getFrameInfo</a>().<a class="code" href="classllvm_1_1MachineFrameInfo.html#a4b9a38005d95189db3246e0e4ec6088d">setFrameAddressIsTaken</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;    MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">getInfo</a>&lt;<a class="code" href="classllvm_1_1AArch64FunctionInfo.html">AArch64FunctionInfo</a>&gt;()-&gt;setHasSwiftAsyncContext(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;    <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.eraseFromParent();</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;  }</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;}</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160; </div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;<a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;AArch64InstructionSelector::selectShiftA_32(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;  <span class="keyword">auto</span> MaybeImmed = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(Root);</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;  <span class="keywordflow">if</span> (MaybeImmed == std::nullopt || *MaybeImmed &gt; 31)</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Enc = (32 - *MaybeImmed) &amp; 0x1f;</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(Enc); }}};</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;}</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160; </div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;<a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;AArch64InstructionSelector::selectShiftB_32(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;  <span class="keyword">auto</span> MaybeImmed = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(Root);</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;  <span class="keywordflow">if</span> (MaybeImmed == std::nullopt || *MaybeImmed &gt; 31)</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Enc = 31 - *MaybeImmed;</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(Enc); }}};</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;}</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160; </div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;<a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;AArch64InstructionSelector::selectShiftA_64(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;  <span class="keyword">auto</span> MaybeImmed = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(Root);</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;  <span class="keywordflow">if</span> (MaybeImmed == std::nullopt || *MaybeImmed &gt; 63)</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Enc = (64 - *MaybeImmed) &amp; 0x3f;</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(Enc); }}};</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;}</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160; </div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;<a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;AArch64InstructionSelector::selectShiftB_64(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;  <span class="keyword">auto</span> MaybeImmed = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(Root);</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;  <span class="keywordflow">if</span> (MaybeImmed == std::nullopt || *MaybeImmed &gt; 63)</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Enc = 63 - *MaybeImmed;</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(Enc); }}};</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;}</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;<span class="comment">/// Helper to select an immediate value that can be represented as a 12-bit</span></div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;<span class="comment">/// value shifted left by either 0 or 12. If it is possible to do so, return</span></div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;<span class="comment">/// the immediate and shift value. If not, return std::nullopt.</span></div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;<span class="comment">/// Used by selectArithImmed and selectNegArithImmed.</span></div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;AArch64InstructionSelector::select12BitValueWithLeftShift(</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;    <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Immed)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;  <span class="keywordtype">unsigned</span> ShiftAmt;</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;  <span class="keywordflow">if</span> (Immed &gt;&gt; 12 == 0) {</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;    ShiftAmt = 0;</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((Immed &amp; 0xfff) == 0 &amp;&amp; Immed &gt;&gt; 24 == 0) {</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;    ShiftAmt = 12;</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;    Immed = Immed &gt;&gt; 12;</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160; </div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;  <span class="keywordtype">unsigned</span> ShVal = <a class="code" href="namespacellvm_1_1AArch64__AM.html#aeae88f12b667477f90db9b726556b337">AArch64_AM::getShifterImm</a>(<a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a1d97e13eb9923037fe733eda83b7f938">AArch64_AM::LSL</a>, ShiftAmt);</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;  <span class="keywordflow">return</span> {{</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;      [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(Immed); },</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;      [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(ShVal); },</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;  }};</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;}</div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;<span class="comment">/// SelectArithImmed - Select an immediate value that can be represented as</span></div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;<span class="comment">/// a 12-bit value shifted left by either 0 or 12.  If so, return true with</span></div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;<span class="comment">/// Val set to the 12-bit value and Shift set to the shifter operand.</span></div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;AArch64InstructionSelector::selectArithImmed(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;  <span class="comment">// This function is called from the addsub_shifted_imm ComplexPattern,</span></div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;  <span class="comment">// which lists [imm] as the list of opcode it&#39;s interested in, however</span></div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;  <span class="comment">// we still need to check whether the operand is actually an immediate</span></div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;  <span class="comment">// here because the ComplexPattern opcode list is only used in</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;  <span class="comment">// root-level opcode matching.</span></div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;  <span class="keyword">auto</span> MaybeImmed = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(Root);</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;  <span class="keywordflow">if</span> (MaybeImmed == std::nullopt)</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;  <span class="keywordflow">return</span> select12BitValueWithLeftShift(*MaybeImmed);</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;}</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;<span class="comment">/// SelectNegArithImmed - As above, but negates the value before trying to</span></div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;<span class="comment">/// select it.</span></div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;AArch64InstructionSelector::selectNegArithImmed(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;  <span class="comment">// We need a register here, because we need to know if we have a 64 or 32</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;  <span class="comment">// bit immediate.</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;  <span class="keywordflow">if</span> (!Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;  <span class="keyword">auto</span> MaybeImmed = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(Root);</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;  <span class="keywordflow">if</span> (MaybeImmed == std::nullopt)</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Immed = *MaybeImmed;</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160; </div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;  <span class="comment">// This negation is almost always valid, but &quot;cmp wN, #0&quot; and &quot;cmn wN, #0&quot;</span></div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;  <span class="comment">// have the opposite effect on the C flag, so this pattern mustn&#39;t match under</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;  <span class="comment">// those circumstances.</span></div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;  <span class="keywordflow">if</span> (Immed == 0)</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160; </div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;  <span class="comment">// Check if we&#39;re dealing with a 32-bit type on the root or a 64-bit type on</span></div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;  <span class="comment">// the root.</span></div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">getMF</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32)</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;    Immed = ~((<a class="code" href="classuint32__t.html">uint32_t</a>)Immed) + 1;</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;    Immed = ~Immed + 1ULL;</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160; </div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;  <span class="keywordflow">if</span> (Immed &amp; 0xFFFFFFFFFF000000ULL)</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160; </div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;  Immed &amp;= 0xFFFFFFULL;</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;  <span class="keywordflow">return</span> select12BitValueWithLeftShift(Immed);</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;}</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;<span class="comment">/// Return true if it is worth folding MI into an extended register. That is,</span></div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;<span class="comment">/// if it&#39;s safe to pull it into the addressing mode of a load or store as a</span></div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;<span class="comment">/// shift.</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;<span class="comment"></span><span class="keywordtype">bool</span> AArch64InstructionSelector::isWorthFoldingIntoExtendedReg(</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;  <span class="comment">// Always fold if there is one use, or if we&#39;re optimizing for size.</span></div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DefReg = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(DefReg) ||</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;getParent()-&gt;getFunction().hasOptSize())</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160; </div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;  <span class="comment">// It&#39;s better to avoid folding and recomputing shifts when we don&#39;t have a</span></div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;  <span class="comment">// fastpath.</span></div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;  <span class="keywordflow">if</span> (!STI.hasLSLFast())</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160; </div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;  <span class="comment">// We have a fastpath, so folding a shift in and potentially computing it</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;  <span class="comment">// many times may be beneficial. Check if this is only used in memory ops.</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;  <span class="comment">// If it is, then we should fold.</span></div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a7e0683c1bfad27f51e8d6c3a8cbdbfdc">use_nodbg_instructions</a>(DefReg),</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;                [](<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="classllvm_1_1Use.html">Use</a>) { return Use.mayLoadOrStore(); });</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;}</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160; </div>
<div class="line"><a name="l06099"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#abfe88c5c35b927527bbf2475bbf28416"> 6099</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#abfe88c5c35b927527bbf2475bbf28416">isSignExtendShiftType</a>(<a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">AArch64_AM::ShiftExtendType</a> <a class="code" href="classllvm_1_1Type.html">Type</a>) {</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="classllvm_1_1Type.html">Type</a>) {</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1ac3bdf1b8c8fd1f36afa7af40bb1a1a59">AArch64_AM::SXTB</a>:</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1ae52597f63d00aac32d655ca8d67a689b">AArch64_AM::SXTH</a>:</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a13ed9069b0840f7eb3a47fce0878a5ad">AArch64_AM::SXTW</a>:</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;  }</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;}</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160; </div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;<a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;AArch64InstructionSelector::selectExtendedSHL(</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>,</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;    <span class="keywordtype">unsigned</span> SizeInBytes, <span class="keywordtype">bool</span> WantsExt)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.isReg() &amp;&amp; <span class="stringliteral">&quot;Expected base to be a register operand&quot;</span>);</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>.isReg() &amp;&amp; <span class="stringliteral">&quot;Expected offset to be a register operand&quot;</span>);</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160; </div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">getMF</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *OffsetInst = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>.getReg());</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160; </div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;  <span class="keywordtype">unsigned</span> OffsetOpc = OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;  <span class="keywordtype">bool</span> LookedThroughZExt = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;  <span class="keywordflow">if</span> (OffsetOpc != TargetOpcode::G_SHL &amp;&amp; OffsetOpc != TargetOpcode::G_MUL) {</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;    <span class="comment">// Try to look through a ZEXT.</span></div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;    <span class="keywordflow">if</span> (OffsetOpc != TargetOpcode::G_ZEXT || !WantsExt)</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160; </div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;    OffsetInst = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;    OffsetOpc = OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;    LookedThroughZExt = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160; </div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;    <span class="keywordflow">if</span> (OffsetOpc != TargetOpcode::G_SHL &amp;&amp; OffsetOpc != TargetOpcode::G_MUL)</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;  }</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;  <span class="comment">// Make sure that the memory op is a valid size.</span></div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;  int64_t LegalShiftVal = <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(SizeInBytes);</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;  <span class="keywordflow">if</span> (LegalShiftVal == 0)</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;  <span class="keywordflow">if</span> (!isWorthFoldingIntoExtendedReg(*OffsetInst, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160; </div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;  <span class="comment">// Now, try to find the specific G_CONSTANT. Start by assuming that the</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;  <span class="comment">// register we will offset is the LHS, and the register containing the</span></div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;  <span class="comment">// constant is the RHS.</span></div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> OffsetReg = OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ConstantReg = OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;  <span class="keyword">auto</span> ValAndVReg = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(ConstantReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;  <span class="keywordflow">if</span> (!ValAndVReg) {</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;    <span class="comment">// We didn&#39;t get a constant on the RHS. If the opcode is a shift, then</span></div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;    <span class="comment">// we&#39;re done.</span></div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;    <span class="keywordflow">if</span> (OffsetOpc == TargetOpcode::G_SHL)</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160; </div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;    <span class="comment">// If we have a G_MUL, we can use either register. Try looking at the RHS.</span></div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;    <a class="code" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(OffsetReg, ConstantReg);</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;    ValAndVReg = <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(ConstantReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;    <span class="keywordflow">if</span> (!ValAndVReg)</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;  }</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160; </div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;  <span class="comment">// The value must fit into 3 bits, and must be positive. Make sure that is</span></div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;  <span class="comment">// true.</span></div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;  int64_t ImmVal = ValAndVReg-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160; </div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;  <span class="comment">// Since we&#39;re going to pull this into a shift, the constant value must be</span></div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;  <span class="comment">// a power of 2. If we got a multiply, then we need to check this.</span></div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;  <span class="keywordflow">if</span> (OffsetOpc == TargetOpcode::G_MUL) {</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;    <span class="keywordflow">if</span> (!llvm::has_single_bit&lt;uint32_t&gt;(ImmVal))</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160; </div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;    <span class="comment">// Got a power of 2. So, the amount we&#39;ll shift is the log base-2 of that.</span></div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;    ImmVal = <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(ImmVal);</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;  }</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160; </div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;  <span class="keywordflow">if</span> ((ImmVal &amp; 0x7) != ImmVal)</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160; </div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;  <span class="comment">// We are only allowed to shift by LegalShiftVal. This shift value is built</span></div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;  <span class="comment">// into the instruction, so we can&#39;t just use whatever we want.</span></div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;  <span class="keywordflow">if</span> (ImmVal != LegalShiftVal)</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160; </div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;  <span class="keywordtype">unsigned</span> SignExtend = 0;</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;  <span class="keywordflow">if</span> (WantsExt) {</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;    <span class="comment">// Check if the offset is defined by an extend, unless we looked through a</span></div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;    <span class="comment">// G_ZEXT earlier.</span></div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;    <span class="keywordflow">if</span> (!LookedThroughZExt) {</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ExtInst = <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(OffsetReg, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;      <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> = getExtendTypeForInst(*ExtInst, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>)</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160; </div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;      SignExtend = <a class="code" href="AArch64InstructionSelector_8cpp.html#abfe88c5c35b927527bbf2475bbf28416">isSignExtendShiftType</a>(<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a>) ? 1 : 0;</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;      <span class="comment">// We only support SXTW for signed extension here.</span></div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;      <span class="keywordflow">if</span> (SignExtend &amp;&amp; <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> != <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a13ed9069b0840f7eb3a47fce0878a5ad">AArch64_AM::SXTW</a>)</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;      OffsetReg = ExtInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;    }</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160; </div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;    <span class="comment">// Need a 32-bit wide register here.</span></div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;    <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIB(*<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()));</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;    OffsetReg = moveScalarRegClass(OffsetReg, AArch64::GPR32RegClass, MIB);</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;  }</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160; </div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;  <span class="comment">// We can use the LHS of the GEP as the base, and the LHS of the shift as an</span></div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;  <span class="comment">// offset. Signify that we are shifting by setting the shift flag to 1.</span></div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addUse(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getReg()); },</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addUse(OffsetReg); },</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;             <span class="comment">// Need to add both immediates here to make sure that they are both</span></div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;             <span class="comment">// added to the instruction.</span></div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;             MIB.addImm(SignExtend);</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;             MIB.addImm(1);</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;           }}};</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;}</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;<span class="comment">/// This is used for computing addresses like this:</span></div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;<span class="comment">/// ldr x1, [x2, x3, lsl #3]</span></div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;<span class="comment">/// Where x2 is the base register, and x3 is an offset register. The shift-left</span></div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;<span class="comment">/// is a constant value specific to this load instruction. That is, we&#39;ll never</span></div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;<span class="comment">/// see anything other than a 3 here (which corresponds to the size of the</span></div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;<span class="comment">/// element being loaded.)</span></div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;AArch64InstructionSelector::selectAddrModeShiftedExtendXReg(</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root, <span class="keywordtype">unsigned</span> SizeInBytes)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;  <span class="keywordflow">if</span> (!Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">getMF</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160; </div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;  <span class="comment">// We want to find something like this:</span></div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;  <span class="comment">// val = G_CONSTANT LegalShiftVal</span></div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;  <span class="comment">// shift = G_SHL off_reg val</span></div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;  <span class="comment">// ptr = G_PTR_ADD base_reg shift</span></div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;  <span class="comment">// x = G_LOAD ptr</span></div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;  <span class="comment">// And fold it into this addressing mode:</span></div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;  <span class="comment">// ldr x, [base_reg, off_reg, lsl #LegalShiftVal]</span></div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160; </div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;  <span class="comment">// Check if we can find the G_PTR_ADD.</span></div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *PtrAdd =</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;      <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_PTR_ADD, Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;  <span class="keywordflow">if</span> (!PtrAdd || !isWorthFoldingIntoExtendedReg(*PtrAdd, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160; </div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;  <span class="comment">// Now, try to match an opcode which will match our specific offset.</span></div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;  <span class="comment">// We want a G_SHL or a G_MUL.</span></div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *OffsetInst =</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;      <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(PtrAdd-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;  <span class="keywordflow">return</span> selectExtendedSHL(Root, PtrAdd-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1),</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;                           OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0), SizeInBytes,</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;                           <span class="comment">/*WantsExt=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;}</div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;<span class="comment">/// This is used for computing addresses like this:</span></div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;<span class="comment">/// ldr x1, [x2, x3]</span></div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;<span class="comment">/// Where x2 is the base register, and x3 is an offset register.</span></div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;<span class="comment">/// When possible (or profitable) to fold a G_PTR_ADD into the address</span></div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;<span class="comment">/// calculation, this will do so. Otherwise, it will return std::nullopt.</span></div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;AArch64InstructionSelector::selectAddrModeRegisterOffset(</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">getMF</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160; </div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;  <span class="comment">// We need a GEP.</span></div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *Gep = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;  <span class="keywordflow">if</span> (Gep-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() != TargetOpcode::G_PTR_ADD)</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160; </div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;  <span class="comment">// If this is used more than once, let&#39;s not bother folding.</span></div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;  <span class="comment">// TODO: Check if they are memory ops. If they are, then we can still fold</span></div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;  <span class="comment">// without having to recompute anything.</span></div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">hasOneNonDBGUse</a>(Gep-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()))</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160; </div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;  <span class="comment">// Base is the GEP&#39;s LHS, offset is its RHS.</span></div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;             MIB.addUse(Gep-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;           },</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;             MIB.addUse(Gep-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;           },</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;             <span class="comment">// Need to add both immediates here to make sure that they are both</span></div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;             <span class="comment">// added to the instruction.</span></div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;             MIB.addImm(0);</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;             MIB.addImm(0);</div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;           }}};</div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;}</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;<span class="comment">/// This is intended to be equivalent to selectAddrModeXRO in</span></div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;<span class="comment">/// AArch64ISelDAGtoDAG. It&#39;s used for selecting X register offset loads.</span></div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;AArch64InstructionSelector::selectAddrModeXRO(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;                                              <span class="keywordtype">unsigned</span> SizeInBytes)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">getMF</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;  <span class="keywordflow">if</span> (!Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *PtrAdd =</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;      <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_PTR_ADD, Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;  <span class="keywordflow">if</span> (!PtrAdd)</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160; </div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;  <span class="comment">// Check for an immediates which cannot be encoded in the [base + imm]</span></div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;  <span class="comment">// addressing mode, and can&#39;t be encoded in an add/sub. If this happens, we&#39;ll</span></div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;  <span class="comment">// end up with code like:</span></div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;  <span class="comment">// mov x0, wide</span></div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;  <span class="comment">// add x1 base, x0</span></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;  <span class="comment">// ldr x2, [x1, x0]</span></div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;  <span class="comment">// In this situation, we can use the [base, xreg] addressing mode to save an</span></div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;  <span class="comment">// add/sub:</span></div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;  <span class="comment">// mov x0, wide</span></div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;  <span class="comment">// ldr x2, [base, x0]</span></div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;  <span class="keyword">auto</span> ValAndVReg =</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;      <a class="code" href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">getIConstantVRegValWithLookThrough</a>(PtrAdd-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;  <span class="keywordflow">if</span> (ValAndVReg) {</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;    <span class="keywordtype">unsigned</span> Scale = <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(SizeInBytes);</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;    int64_t ImmOff = ValAndVReg-&gt;Value.getSExtValue();</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160; </div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;    <span class="comment">// Skip immediates that can be selected in the load/store addresing</span></div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;    <span class="comment">// mode.</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;    <span class="keywordflow">if</span> (ImmOff % SizeInBytes == 0 &amp;&amp; ImmOff &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;        ImmOff &lt; (0x1000 &lt;&lt; Scale))</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160; </div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;    <span class="comment">// Helper lambda to decide whether or not it is preferable to emit an add.</span></div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;    <span class="keyword">auto</span> <a class="code" href="AArch64ISelDAGToDAG_8cpp.html#a8e2f5645552aa4df45a3046ed8a660ae">isPreferredADD</a> = [](int64_t ImmOff) {</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;      <span class="comment">// Constants in [0x0, 0xfff] can be encoded in an add.</span></div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;      <span class="keywordflow">if</span> ((ImmOff &amp; 0xfffffffffffff000LL) == 0x0LL)</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160; </div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;      <span class="comment">// Can it be encoded in an add lsl #12?</span></div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;      <span class="keywordflow">if</span> ((ImmOff &amp; 0xffffffffff000fffLL) != 0x0LL)</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160; </div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;      <span class="comment">// It can be encoded in an add lsl #12, but we may not want to. If it is</span></div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;      <span class="comment">// possible to select this as a single movz, then prefer that. A single</span></div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;      <span class="comment">// movz is faster than an add with a shift.</span></div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;      <span class="keywordflow">return</span> (ImmOff &amp; 0xffffffffff00ffffLL) != 0x0LL &amp;&amp;</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;             (ImmOff &amp; 0xffffffffffff0fffLL) != 0x0LL;</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;    };</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160; </div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;    <span class="comment">// If the immediate can be encoded in a single add/sub, then bail out.</span></div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64ISelDAGToDAG_8cpp.html#a8e2f5645552aa4df45a3046ed8a660ae">isPreferredADD</a>(ImmOff) || <a class="code" href="AArch64ISelDAGToDAG_8cpp.html#a8e2f5645552aa4df45a3046ed8a660ae">isPreferredADD</a>(-ImmOff))</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;  }</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160; </div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;  <span class="comment">// Try to fold shifts into the addressing mode.</span></div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;  <span class="keyword">auto</span> AddrModeFns = selectAddrModeShiftedExtendXReg(Root, SizeInBytes);</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;  <span class="keywordflow">if</span> (AddrModeFns)</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;    <span class="keywordflow">return</span> AddrModeFns;</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160; </div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;  <span class="comment">// If that doesn&#39;t work, see if it&#39;s possible to fold in registers from</span></div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;  <span class="comment">// a GEP.</span></div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;  <span class="keywordflow">return</span> selectAddrModeRegisterOffset(Root);</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;}</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;<span class="comment">/// This is used for computing addresses like this:</span></div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;<span class="comment">/// ldr x0, [xBase, wOffset, sxtw #LegalShiftVal]</span></div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;<span class="comment">/// Where we have a 64-bit base register, a 32-bit offset register, and an</span></div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;<span class="comment">/// extend (which may or may not be signed).</span></div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;AArch64InstructionSelector::selectAddrModeWRO(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;                                              <span class="keywordtype">unsigned</span> SizeInBytes)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">getMF</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160; </div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *PtrAdd =</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;      <a class="code" href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">getOpcodeDef</a>(TargetOpcode::G_PTR_ADD, Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;  <span class="keywordflow">if</span> (!PtrAdd || !isWorthFoldingIntoExtendedReg(*PtrAdd, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160; </div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = PtrAdd-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = PtrAdd-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2);</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *OffsetInst = <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160; </div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;  <span class="comment">// The first case is the same as selectAddrModeXRO, except we need an extend.</span></div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;  <span class="comment">// In this case, we try to find a shift and extend, and fold them into the</span></div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;  <span class="comment">// addressing mode.</span></div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;  <span class="comment">// E.g.</span></div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;  <span class="comment">// off_reg = G_Z/S/ANYEXT ext_reg</span></div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;  <span class="comment">// val = G_CONSTANT LegalShiftVal</span></div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;  <span class="comment">// shift = G_SHL off_reg val</span></div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;  <span class="comment">// ptr = G_PTR_ADD base_reg shift</span></div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;  <span class="comment">// x = G_LOAD ptr</span></div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;  <span class="comment">// In this case we can get a load like this:</span></div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;  <span class="comment">// ldr x0, [base_reg, ext_reg, sxtw #LegalShiftVal]</span></div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;  <span class="keyword">auto</span> ExtendedShl = selectExtendedSHL(Root, <a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0),</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;                                       SizeInBytes, <span class="comment">/*WantsExt=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;  <span class="keywordflow">if</span> (ExtendedShl)</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;    <span class="keywordflow">return</span> ExtendedShl;</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160; </div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;  <span class="comment">// There was no shift. We can try and fold a G_Z/S/ANYEXT in alone though.</span></div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;  <span class="comment">// e.g.</span></div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;  <span class="comment">// ldr something, [base_reg, ext_reg, sxtw]</span></div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;  <span class="keywordflow">if</span> (!isWorthFoldingIntoExtendedReg(*OffsetInst, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160; </div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;  <span class="comment">// Check if this is an extend. We&#39;ll get an extend type if it is.</span></div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">AArch64_AM::ShiftExtendType</a> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> =</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;      getExtendTypeForInst(*OffsetInst, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <span class="comment">/*IsLoadStore=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>)</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160; </div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;  <span class="comment">// Need a 32-bit wide register.</span></div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIB(*PtrAdd);</div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ExtReg = moveScalarRegClass(OffsetInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(),</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;                                       AArch64::GPR32RegClass, MIB);</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;  <span class="keywordtype">unsigned</span> SignExtend = <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a13ed9069b0840f7eb3a47fce0878a5ad">AArch64_AM::SXTW</a>;</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160; </div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;  <span class="comment">// Base is LHS, offset is ExtReg.</span></div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addUse(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg()); },</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addUse(ExtReg); },</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;             MIB.addImm(SignExtend);</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;             MIB.addImm(0);</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;           }}};</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;}</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;<span class="comment">/// Select a &quot;register plus unscaled signed 9-bit immediate&quot; address.  This</span></div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;<span class="comment">/// should only match when there is an offset that is not valid for a scaled</span></div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;<span class="comment">/// immediate addressing mode.  The &quot;Size&quot; argument is the size in bytes of the</span></div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;<span class="comment">/// memory reference, which is needed here to know what is valid for a scaled</span></div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;<span class="comment">/// immediate.</span></div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;AArch64InstructionSelector::selectAddrModeUnscaled(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;                                                   <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> =</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;      Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160; </div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;  <span class="keywordflow">if</span> (!Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160; </div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;  <span class="keywordflow">if</span> (!isBaseWithConstantOffset(Root, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160; </div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *RootDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160; </div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;OffImm = RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2);</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;  <span class="keywordflow">if</span> (!OffImm.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(OffImm.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;getOpcode() != TargetOpcode::G_CONSTANT)</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;  int64_t RHSC;</div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;RHSOp1 = <a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;getOperand(1);</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;  <span class="keywordflow">if</span> (!RHSOp1.<a class="code" href="classllvm_1_1MachineOperand.html#a32ea768fbb182d6bbe3ff85ae1eb7031">isCImm</a>() || RHSOp1.<a class="code" href="classllvm_1_1MachineOperand.html#ac0af83aa690c458c5b3a8dc36ad3c3f9">getCImm</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ab240d0d30dfa9b392ef9d813f3f9e4be">getBitWidth</a>() &gt; 64)</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;  RHSC = RHSOp1.<a class="code" href="classllvm_1_1MachineOperand.html#ac0af83aa690c458c5b3a8dc36ad3c3f9">getCImm</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>();</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160; </div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;  <span class="comment">// If the offset is valid as a scaled immediate, don&#39;t match here.</span></div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;  <span class="keywordflow">if</span> ((RHSC &amp; (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> - 1)) == 0 &amp;&amp; RHSC &gt;= 0 &amp;&amp; RHSC &lt; (0x1000 &lt;&lt; <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>)))</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;  <span class="keywordflow">if</span> (RHSC &gt;= -256 &amp;&amp; RHSC &lt; 256) {</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;    <span class="keywordflow">return</span> {{</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;        [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.add(<a class="code" href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>); },</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;        [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(RHSC); },</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;    }};</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;  }</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;}</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160; </div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;<a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;AArch64InstructionSelector::tryFoldAddLowIntoImm(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;RootDef,</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;                                                 <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>,</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;                                                 <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;  <span class="keywordflow">if</span> (RootDef.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() != AArch64::G_ADD_LOW)</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;Adrp = *<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(RootDef.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;  <span class="keywordflow">if</span> (Adrp.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() != <a class="code" href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19aa2e9d9d7c30818fd5ba551f8d3f0af34">AArch64::ADRP</a>)</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160; </div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;  <span class="comment">// TODO: add heuristics like isWorthFoldingADDlow() from SelectionDAG.</span></div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;  <span class="keyword">auto</span> <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> = Adrp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#af624ff47eaa512dbe23866accb3837c1">getOffset</a>();</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a> % <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != 0)</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160; </div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;  <span class="keyword">auto</span> GV = Adrp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac8718f1c761727d429180f0ce340f7f0">getGlobal</a>();</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;  <span class="keywordflow">if</span> (GV-&gt;<a class="code" href="classllvm_1_1GlobalValue.html#a239427c2c3a01e23bd15b29633696536">isThreadLocal</a>())</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160; </div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;  <span class="keyword">auto</span> &amp;MF = *RootDef.<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;  <span class="keywordflow">if</span> (GV-&gt;<a class="code" href="classllvm_1_1Value.html#a47f5c74e1b14ba4a61db057400644acc">getPointerAlignment</a>(MF.<a class="code" href="classllvm_1_1MachineFunction.html#a82dd10b626a629b9bb7d32d53a8e0884">getDataLayout</a>()) &lt; <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>)</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160; </div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;  <span class="keywordtype">unsigned</span> OpFlags = STI.ClassifyGlobalReference(GV, MF.<a class="code" href="classllvm_1_1MachineFunction.html#ae68d159179d37dc7969439d842e2644f">getTarget</a>());</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIRBuilder(RootDef);</div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> AdrpReg = Adrp.<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(0).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addUse(AdrpReg); },</div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;             MIB.addGlobalAddress(GV, <a class="code" href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a>,</div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;                                  OpFlags | <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a3a5053185998bdf24f3167c234915785">AArch64II::MO_PAGEOFF</a> |</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;                                      <a class="code" href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">AArch64II::MO_NC</a>);</div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;           }}};</div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;}</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;<span class="comment">/// Select a &quot;register plus scaled unsigned 12-bit immediate&quot; address.  The</span></div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;<span class="comment">/// &quot;Size&quot; argument is the size in bytes of the memory reference, which</span></div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;<span class="comment">/// determines the scale.</span></div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;AArch64InstructionSelector::selectAddrModeIndexed(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                                                  <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160; </div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;  <span class="keywordflow">if</span> (!Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160; </div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *RootDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;  <span class="keywordflow">if</span> (RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_FRAME_INDEX) {</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;    <span class="keywordflow">return</span> {{</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;        [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.add(RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1)); },</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;        [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(0); },</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;    }};</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;  }</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160; </div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;  <a class="code" href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8df">CodeModel::Model</a> CM = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ae68d159179d37dc7969439d842e2644f">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#ae106f6c6362377b3016f0d174227e193">getCodeModel</a>();</div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;  <span class="comment">// Check if we can fold in the ADD of small code model ADRP + ADD address.</span></div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;  <span class="keywordflow">if</span> (CM == <a class="code" href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfaa2554ef60dc191c6005ba9eecbc9aea0">CodeModel::Small</a>) {</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;    <span class="keyword">auto</span> OpFns = tryFoldAddLowIntoImm(*RootDef, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;    <span class="keywordflow">if</span> (OpFns)</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;      <span class="keywordflow">return</span> OpFns;</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;  }</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160; </div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;  <span class="keywordflow">if</span> (isBaseWithConstantOffset(Root, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>)) {</div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2);</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *LHSDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg());</div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *RHSDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.getReg());</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160; </div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;    int64_t RHSC = (int64_t)RHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0af83aa690c458c5b3a8dc36ad3c3f9">getCImm</a>()-&gt;<a class="code" href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>();</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;    <span class="keywordtype">unsigned</span> Scale = <a class="code" href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">Log2_32</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>);</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;    <span class="keywordflow">if</span> ((RHSC &amp; (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> - 1)) == 0 &amp;&amp; RHSC &gt;= 0 &amp;&amp; RHSC &lt; (0x1000 &lt;&lt; Scale)) {</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;      <span class="keywordflow">if</span> (LHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_FRAME_INDEX)</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;        <span class="keywordflow">return</span> {{</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;            [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.add(LHSDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1)); },</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;            [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(RHSC &gt;&gt; Scale); },</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;        }};</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160; </div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;      <span class="keywordflow">return</span> {{</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;          [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.add(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>); },</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;          [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(RHSC &gt;&gt; Scale); },</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;      }};</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;    }</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;  }</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160; </div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;  <span class="comment">// Before falling back to our general case, check if the unscaled</span></div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;  <span class="comment">// instructions can handle this. If so, that&#39;s preferable.</span></div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;  <span class="keywordflow">if</span> (selectAddrModeUnscaled(Root, <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>))</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160; </div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;  <span class="keywordflow">return</span> {{</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;      [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.add(Root); },</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;      [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(0); },</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;  }};</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;}</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;<span class="comment">/// Given a shift instruction, return the correct shift type for that</span></div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;<span class="comment">/// instruction.</span></div>
<div class="line"><a name="l06575"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#ac27317e513ca940053ef5778f920269f"> 6575</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">AArch64_AM::ShiftExtendType</a> <a class="code" href="AArch64InstructionSelector_8cpp.html#ac27317e513ca940053ef5778f920269f">getShiftTypeForInst</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode()) {</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_SHL:</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a1d97e13eb9923037fe733eda83b7f938">AArch64_AM::LSL</a>;</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_LSHR:</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a7e1384a3b7d612a03b54d9c8f2071a04">AArch64_AM::LSR</a>;</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ASHR:</div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a2f11475361161d9ce95a2f7be74de342">AArch64_AM::ASR</a>;</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_ROTR:</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1abb1fa5a6016bfee1580a7b989a454c9a">AArch64_AM::ROR</a>;</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;  }</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;}</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;<span class="comment">/// Select a &quot;shifted register&quot; operand. If the value is not shifted, set the</span></div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;<span class="comment">/// shift operand to a default value of &quot;lsl 0&quot;.</span></div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;AArch64InstructionSelector::selectShiftedRegister(<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root,</div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;                                                  <span class="keywordtype">bool</span> AllowROR)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;  <span class="keywordflow">if</span> (!Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> =</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;      Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160; </div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;  <span class="comment">// Check if the operand is defined by an instruction which corresponds to</span></div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;  <span class="comment">// a ShiftExtendType. E.g. a G_SHL, G_LSHR, etc.</span></div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ShiftInst = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">AArch64_AM::ShiftExtendType</a> ShType = <a class="code" href="AArch64InstructionSelector_8cpp.html#ac27317e513ca940053ef5778f920269f">getShiftTypeForInst</a>(*ShiftInst);</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;  <span class="keywordflow">if</span> (ShType == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>)</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;  <span class="keywordflow">if</span> (ShType == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1abb1fa5a6016bfee1580a7b989a454c9a">AArch64_AM::ROR</a> &amp;&amp; !AllowROR)</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;  <span class="keywordflow">if</span> (!isWorthFoldingIntoExtendedReg(*ShiftInst, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160; </div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;  <span class="comment">// Need an immediate on the RHS.</span></div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;ShiftRHS = ShiftInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2);</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;  <span class="keyword">auto</span> Immed = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(ShiftRHS);</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;  <span class="keywordflow">if</span> (!Immed)</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160; </div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;  <span class="comment">// We have something that we can fold. Fold in the shift&#39;s LHS and RHS into</span></div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;  <span class="comment">// the instruction.</span></div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;ShiftLHS = ShiftInst-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ShiftReg = ShiftLHS.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160; </div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;  <span class="keywordtype">unsigned</span> NumBits = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(ShiftReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;  <span class="keywordtype">unsigned</span> Val = *Immed &amp; (NumBits - 1);</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;  <span class="keywordtype">unsigned</span> ShiftVal = <a class="code" href="namespacellvm_1_1AArch64__AM.html#aeae88f12b667477f90db9b726556b337">AArch64_AM::getShifterImm</a>(ShType, Val);</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160; </div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addUse(ShiftReg); },</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addImm(ShiftVal); }}};</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;}</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160; </div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;<a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">AArch64_AM::ShiftExtendType</a> AArch64InstructionSelector::getExtendTypeForInst(</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <span class="keywordtype">bool</span> IsLoadStore)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;  <span class="keywordtype">unsigned</span> Opc = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode();</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160; </div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;  <span class="comment">// Handle explicit extend instructions first.</span></div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;  <span class="keywordflow">if</span> (Opc == TargetOpcode::G_SEXT || Opc == TargetOpcode::G_SEXT_INREG) {</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>;</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;    <span class="keywordflow">if</span> (Opc == TargetOpcode::G_SEXT)</div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;      <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getReg()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;      <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(2).getImm();</div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != 64 &amp;&amp; <span class="stringliteral">&quot;Extend from 64 bits?&quot;</span>);</div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>) {</div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;      <span class="keywordflow">return</span> IsLoadStore ? <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a> : <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1ac3bdf1b8c8fd1f36afa7af40bb1a1a59">AArch64_AM::SXTB</a>;</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;      <span class="keywordflow">return</span> IsLoadStore ? <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a> : <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1ae52597f63d00aac32d655ca8d67a689b">AArch64_AM::SXTH</a>;</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a13ed9069b0840f7eb3a47fce0878a5ad">AArch64_AM::SXTW</a>;</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;    }</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;  }</div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160; </div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;  <span class="keywordflow">if</span> (Opc == TargetOpcode::G_ZEXT || Opc == TargetOpcode::G_ANYEXT) {</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getReg()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>();</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a> != 64 &amp;&amp; <span class="stringliteral">&quot;Extend from 64 bits?&quot;</span>);</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">Size</a>) {</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;      <span class="keywordflow">return</span> IsLoadStore ? <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a> : <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a59dcdcd32661c3deea19d0b4c00aeb09">AArch64_AM::UXTB</a>;</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;      <span class="keywordflow">return</span> IsLoadStore ? <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a> : <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a822b65b0f419881e5f0352e2f4f33d29">AArch64_AM::UXTH</a>;</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;    <span class="keywordflow">case</span> 32:</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a2620d8167a503c9942cc4afded7f830d">AArch64_AM::UXTW</a>;</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;    }</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;  }</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160; </div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;  <span class="comment">// Don&#39;t have an explicit extend. Try to handle a G_AND with a constant mask</span></div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;  <span class="comment">// on the RHS.</span></div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;  <span class="keywordflow">if</span> (Opc != TargetOpcode::G_AND)</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160; </div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;  std::optional&lt;uint64_t&gt; MaybeAndMask = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(2));</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;  <span class="keywordflow">if</span> (!MaybeAndMask)</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> AndMask = *MaybeAndMask;</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;  <span class="keywordflow">switch</span> (AndMask) {</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;  <span class="keywordflow">case</span> 0xFF:</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;    <span class="keywordflow">return</span> !IsLoadStore ? <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a59dcdcd32661c3deea19d0b4c00aeb09">AArch64_AM::UXTB</a> : <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;  <span class="keywordflow">case</span> 0xFFFF:</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;    <span class="keywordflow">return</span> !IsLoadStore ? <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a822b65b0f419881e5f0352e2f4f33d29">AArch64_AM::UXTH</a> : <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>;</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;  <span class="keywordflow">case</span> 0xFFFFFFFF:</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a2620d8167a503c9942cc4afded7f830d">AArch64_AM::UXTW</a>;</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;  }</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;}</div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160; </div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;<a class="code" href="classllvm_1_1Register.html">Register</a> AArch64InstructionSelector::moveScalarRegClass(</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> &amp;RC, <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> &amp;MIB)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = *MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">getMRI</a>();</div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;  <span class="keyword">auto</span> Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Ty.<a class="code" href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">isVector</a>() &amp;&amp; <span class="stringliteral">&quot;Expected scalars only!&quot;</span>);</div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;  <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a251557179fe64bb09bd7e327c60c6b24">getRegSizeInBits</a>(RC))</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>;</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160; </div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;  <span class="comment">// Create a copy and immediately select it.</span></div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;  <span class="comment">// FIXME: We should have an emitCopy function?</span></div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;  <span class="keyword">auto</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>({&amp;RC}, {<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>});</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;  <a class="code" href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a>(*Copy, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RBI);</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>.getReg(0);</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;}</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;<span class="comment">/// Select an &quot;extended register&quot; operand. This operand folds in an extend</span></div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="comment">/// followed by an optional left shift.</span></div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">InstructionSelector::ComplexRendererFns</a></div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;AArch64InstructionSelector::selectArithExtendedRegister(</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;Root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;  <span class="keywordflow">if</span> (!Root.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>())</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> =</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;      Root.<a class="code" href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160; </div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> ShiftVal = 0;</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> ExtReg;</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;  <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">AArch64_AM::ShiftExtendType</a> <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a>;</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *RootDef = <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(Root.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;  <span class="keywordflow">if</span> (!RootDef)</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160; </div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;  <span class="keywordflow">if</span> (!isWorthFoldingIntoExtendedReg(*RootDef, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160; </div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;  <span class="comment">// Check if we can fold a shift and an extend.</span></div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;  <span class="keywordflow">if</span> (RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::G_SHL) {</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;    <span class="comment">// Look for a constant on the RHS of the shift.</span></div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2);</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;    std::optional&lt;uint64_t&gt; MaybeShiftVal = <a class="code" href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a>(<a class="code" href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;    <span class="keywordflow">if</span> (!MaybeShiftVal)</div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;    ShiftVal = *MaybeShiftVal;</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;    <span class="keywordflow">if</span> (ShiftVal &gt; 4)</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;    <span class="comment">// Look for a valid extend instruction on the LHS of the shift.</span></div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1);</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ExtDef = <a class="code" href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">getDefIgnoringCopies</a>(<a class="code" href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;    <span class="keywordflow">if</span> (!ExtDef)</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> = getExtendTypeForInst(*ExtDef, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>)</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;    ExtReg = ExtDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;    <span class="comment">// Didn&#39;t get a shift. Try just folding an extend.</span></div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;    <a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> = getExtendTypeForInst(*RootDef, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">AArch64_AM::InvalidShiftExtend</a>)</div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;    ExtReg = RootDef-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(1).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160; </div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;    <span class="comment">// If we have a 32 bit instruction which zeroes out the high half of a</span></div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;    <span class="comment">// register, we get an implicit zero extend for free. Check if we have one.</span></div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;    <span class="comment">// FIXME: We actually emit the extend right now even though we don&#39;t have</span></div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;    <span class="comment">// to.</span></div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a> == <a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a2620d8167a503c9942cc4afded7f830d">AArch64_AM::UXTW</a> &amp;&amp; <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(ExtReg).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() == 32) {</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;      <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *ExtInst = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(ExtReg);</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;      <span class="keywordflow">if</span> (isDef32(*ExtInst))</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;    }</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;  }</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160; </div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;  <span class="comment">// We require a GPR32 here. Narrow the ExtReg if needed using a subregister</span></div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;  <span class="comment">// copy.</span></div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIB(*RootDef);</div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;  ExtReg = moveScalarRegClass(ExtReg, AArch64::GPR32RegClass, MIB);</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160; </div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;  <span class="keywordflow">return</span> {{[=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) { MIB.addUse(ExtReg); },</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;           [=](<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB) {</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;             MIB.addImm(<a class="code" href="namespacellvm_1_1AArch64__AM.html#a35905b769bf1afa2cc7e2a223191e57e">getArithExtendImm</a>(<a class="code" href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">Ext</a>, ShiftVal));</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;           }}};</div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;}</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160; </div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::renderTruncImm(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB,</div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;                                                <span class="keywordtype">int</span> OpIdx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;getParent()-&gt;getRegInfo();</div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_CONSTANT &amp;&amp; OpIdx == -1 &amp;&amp;</div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;         <span class="stringliteral">&quot;Expected G_CONSTANT&quot;</span>);</div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;  std::optional&lt;int64_t&gt; CstVal =</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;      <a class="code" href="namespacellvm.html#a56f5d55460d7e31fc6c3318882f36ac7">getIConstantVRegSExtVal</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg(), <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>);</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CstVal &amp;&amp; <span class="stringliteral">&quot;Expected constant value&quot;</span>);</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(*CstVal);</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;}</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160; </div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::renderLogicalImm32(</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">int</span> OpIdx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_CONSTANT &amp;&amp; OpIdx == -1 &amp;&amp;</div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;         <span class="stringliteral">&quot;Expected G_CONSTANT&quot;</span>);</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> CstVal = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getCImm()-&gt;getZExtValue();</div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Enc = <a class="code" href="namespacellvm_1_1AArch64__AM.html#a832ad315a355f4ddcc32f189f34e28a9">AArch64_AM::encodeLogicalImmediate</a>(CstVal, 32);</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(Enc);</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;}</div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160; </div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::renderLogicalImm64(</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">int</span> OpIdx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOpcode() == TargetOpcode::G_CONSTANT &amp;&amp; OpIdx == -1 &amp;&amp;</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;         <span class="stringliteral">&quot;Expected G_CONSTANT&quot;</span>);</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> CstVal = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getOperand(1).getCImm()-&gt;getZExtValue();</div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;  <a class="code" href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a> Enc = <a class="code" href="namespacellvm_1_1AArch64__AM.html#a832ad315a355f4ddcc32f189f34e28a9">AArch64_AM::encodeLogicalImmediate</a>(CstVal, 64);</div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(Enc);</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;}</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160; </div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::renderFPImm16(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB,</div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;                                               <span class="keywordtype">int</span> OpIdx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_FCONSTANT &amp;&amp; OpIdx == -1 &amp;&amp;</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;         <span class="stringliteral">&quot;Expected G_FCONSTANT&quot;</span>);</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;      <a class="code" href="namespacellvm_1_1AArch64__AM.html#ab23f031bf813c9284ac27776b414a867">AArch64_AM::getFP16Imm</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getFPImm()-&gt;getValueAPF()));</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;}</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160; </div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::renderFPImm32(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB,</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;                                               <span class="keywordtype">int</span> OpIdx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_FCONSTANT &amp;&amp; OpIdx == -1 &amp;&amp;</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;         <span class="stringliteral">&quot;Expected G_FCONSTANT&quot;</span>);</div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(</div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;      <a class="code" href="namespacellvm_1_1AArch64__AM.html#a5d1d3c98268fd4f6017b99e4bd9415ed">AArch64_AM::getFP32Imm</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getFPImm()-&gt;getValueAPF()));</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;}</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160; </div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::renderFPImm64(<a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB,</div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;                                               <span class="keywordtype">int</span> OpIdx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_FCONSTANT &amp;&amp; OpIdx == -1 &amp;&amp;</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;         <span class="stringliteral">&quot;Expected G_FCONSTANT&quot;</span>);</div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(</div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;      <a class="code" href="namespacellvm_1_1AArch64__AM.html#aa3b818e0d89b7804a311b48c18080a4f">AArch64_AM::getFP64Imm</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getFPImm()-&gt;getValueAPF()));</div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;}</div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160; </div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::renderFPImm32SIMDModImmType4(</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> &amp;MIB, <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <span class="keywordtype">int</span> OpIdx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_FCONSTANT &amp;&amp; OpIdx == -1 &amp;&amp;</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;         <span class="stringliteral">&quot;Expected G_FCONSTANT&quot;</span>);</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="namespacellvm_1_1AArch64__AM.html#ae37687fd3e4b8a746f795bfcd64a70e7">AArch64_AM::encodeAdvSIMDModImmType4</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1)</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;                                                      .getFPImm()</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;                                                      -&gt;getValueAPF()</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;                                                      .bitcastToAPInt()</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;                                                      .getZExtValue()));</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;}</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160; </div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::isLoadStoreOfNumBytes(</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <span class="keywordtype">unsigned</span> NumBytes)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.mayLoadOrStore())</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.hasOneMemOperand() &amp;&amp;</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;         <span class="stringliteral">&quot;Expected load/store to have only one mem op!&quot;</span>);</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;  <span class="keywordflow">return</span> (*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.memoperands_begin())-&gt;getSize() == NumBytes;</div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;}</div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160; </div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;<span class="keywordtype">bool</span> AArch64InstructionSelector::isDef32(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;getParent()-&gt;getRegInfo();</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg()).<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() != 32)</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160; </div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;  <span class="comment">// Only return true if we know the operation will zero-out the high half of</span></div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;  <span class="comment">// the 64-bit register. Truncates can be subregister copies, which don&#39;t</span></div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;  <span class="comment">// zero out the high bits. Copies and other copy-like instructions can be</span></div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;  <span class="comment">// fed by truncates, or could be lowered as subregister copies.</span></div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode()) {</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::COPY:</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_BITCAST:</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_TRUNC:</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;  <span class="keywordflow">case</span> TargetOpcode::G_PHI:</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;  }</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;}</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160; </div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160; </div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;<span class="comment">// Perform fixups on the given PHI instruction&#39;s operands to force them all</span></div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;<span class="comment">// to be the same as the destination regbank.</span></div>
<div class="line"><a name="l06873"></a><span class="lineno"><a class="line" href="AArch64InstructionSelector_8cpp.html#aafb37937e5f21c12443bd5278264d08b"> 6873</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="AArch64InstructionSelector_8cpp.html#aafb37937e5f21c12443bd5278264d08b">fixupPHIOpBanks</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64RegisterBankInfo.html">AArch64RegisterBankInfo</a> &amp;RBI) {</div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_PHI &amp;&amp; <span class="stringliteral">&quot;Expected a G_PHI&quot;</span>);</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> DstReg = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg();</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> *DstRB = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a0436abbe31ee5c71b5f06ce5d2ea1a4a">getRegBankOrNull</a>(DstReg);</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstRB &amp;&amp; <span class="stringliteral">&quot;Expected PHI dst to have regbank assigned&quot;</span>);</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;  <a class="code" href="classllvm_1_1MachineIRBuilder.html">MachineIRBuilder</a> MIB(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160; </div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;  <span class="comment">// Go through each operand and ensure it has the same regbank.</span></div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands())) {</div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;    <span class="keywordflow">if</span> (!MO.isReg())</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> OpReg = MO.getReg();</div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> *RB = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a0436abbe31ee5c71b5f06ce5d2ea1a4a">getRegBankOrNull</a>(OpReg);</div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;    <span class="keywordflow">if</span> (RB != DstRB) {</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;      <span class="comment">// Insert a cross-bank copy.</span></div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;      <span class="keyword">auto</span> *OpDef = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">getVRegDef</a>(OpReg);</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> &amp;Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(OpReg);</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;      <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;OpDefBB = *OpDef-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160; </div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;      <span class="comment">// Any instruction we insert must appear after all PHIs in the block</span></div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;      <span class="comment">// for the block to be valid MIR.</span></div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;      <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> InsertPt = std::next(OpDef-&gt;getIterator());</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;      <span class="keywordflow">if</span> (InsertPt != OpDefBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>() &amp;&amp; InsertPt-&gt;isPHI())</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;        InsertPt = OpDefBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#aa7dc7faaab4856b8f0014b8283e26c7b">getFirstNonPHI</a>();</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;      MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#a0df93c0f752428162e14b54f8999172d">setInsertPt</a>(*OpDef-&gt;getParent(), InsertPt);</div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;      <span class="keyword">auto</span> Copy = MIB.<a class="code" href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">buildCopy</a>(Ty, OpReg);</div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;      <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a81763ced27ec9b0c42f8848f4ebe5bd1">setRegBank</a>(Copy.getReg(0), *DstRB);</div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;      MO.setReg(Copy.getReg(0));</div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;    }</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;  }</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;}</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160; </div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;<span class="keywordtype">void</span> AArch64InstructionSelector::processPHIs(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF) {</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;  <span class="comment">// We&#39;re looking for PHIs, build a list so we don&#39;t invalidate iterators.</span></div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;  <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;<a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineInstr *, 32&gt;</a> Phis;</div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : MF) {</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == TargetOpcode::G_PHI)</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;        Phis.<a class="code" href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">emplace_back</a>(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;    }</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;  }</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160; </div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : Phis) {</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;    <span class="comment">// We need to do some work here if the operand types are &lt; 16 bit and they</span></div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;    <span class="comment">// are split across fpr/gpr banks. Since all types &lt;32b on gpr</span></div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;    <span class="comment">// end up being assigned gpr32 regclasses, we can end up with PHIs here</span></div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;    <span class="comment">// which try to select between a gpr32 and an fpr16. Ideally RBS shouldn&#39;t</span></div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;    <span class="comment">// be selecting heterogenous regbanks for operands if possible, but we</span></div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;    <span class="comment">// still need to be able to deal with it here.</span></div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;    <span class="comment">// To fix this, if we have a gpr-bank operand &lt; 32b in size and at least</span></div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;    <span class="comment">// one other operand is on the fpr bank, then we add cross-bank copies</span></div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;    <span class="comment">// to homogenize the operand banks. For simplicity the bank that we choose</span></div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;    <span class="comment">// to settle on is whatever bank the def operand has. For example:</span></div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;    <span class="comment">// %endbb:</span></div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;    <span class="comment">//   %dst:gpr(s16) = G_PHI %in1:gpr(s16), %bb1, %in2:fpr(s16), %bb2</span></div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;    <span class="comment">//  =&gt;</span></div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;    <span class="comment">// %bb2:</span></div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;    <span class="comment">//   ...</span></div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;    <span class="comment">//   %in2_copy:gpr(s16) = COPY %in2:fpr(s16)</span></div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;    <span class="comment">//   ...</span></div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;    <span class="comment">// %endbb:</span></div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;    <span class="comment">//   %dst:gpr(s16) = G_PHI %in1:gpr(s16), %bb1, %in2_copy:gpr(s16), %bb2</span></div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;    <span class="keywordtype">bool</span> HasGPROp = <span class="keyword">false</span>, HasFPROp = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MO : <a class="code" href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;operands())) {</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;      <span class="keywordflow">if</span> (!MO.isReg())</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1LLT.html">LLT</a> &amp;Ty = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">getType</a>(MO.getReg());</div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;      <span class="keywordflow">if</span> (!Ty.<a class="code" href="classllvm_1_1LLT.html#a69fb30748f1b3e8a0affd486a9f59f6d">isValid</a>() || !Ty.<a class="code" href="classllvm_1_1LLT.html#a3989251b1a714fc8296685f77eac6e87">isScalar</a>())</div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;      <span class="keywordflow">if</span> (Ty.<a class="code" href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">getSizeInBits</a>() &gt;= 32)</div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;      <span class="keyword">const</span> <a class="code" href="classllvm_1_1RegisterBank.html">RegisterBank</a> *RB = <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a0436abbe31ee5c71b5f06ce5d2ea1a4a">getRegBankOrNull</a>(MO.getReg());</div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;      <span class="comment">// If for some reason we don&#39;t have a regbank yet. Don&#39;t try anything.</span></div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;      <span class="keywordflow">if</span> (!RB)</div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160; </div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;      <span class="keywordflow">if</span> (RB-&gt;<a class="code" href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">getID</a>() == AArch64::GPRRegBankID)</div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;        HasGPROp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;        HasFPROp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;    }</div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;    <span class="comment">// We have heterogenous regbanks, need to fixup.</span></div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;    <span class="keywordflow">if</span> (HasGPROp &amp;&amp; HasFPROp)</div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;      <a class="code" href="AArch64InstructionSelector_8cpp.html#aafb37937e5f21c12443bd5278264d08b">fixupPHIOpBanks</a>(*<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>, RBI);</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;  }</div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;}</div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160; </div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacellvm.html">llvm</a> {</div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;<a class="code" href="classllvm_1_1InstructionSelector.html">InstructionSelector</a> *</div>
<div class="line"><a name="l06966"></a><span class="lineno"><a class="line" href="namespacellvm.html#aaea263c7a3c058db83a4d5a74562610e"> 6966</a></span>&#160;<a class="code" href="namespacellvm.html#aaea263c7a3c058db83a4d5a74562610e">createAArch64InstructionSelector</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64TargetMachine.html">AArch64TargetMachine</a> &amp;<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>,</div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;                                 <a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a> &amp;Subtarget,</div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;                                 <a class="code" href="classllvm_1_1AArch64RegisterBankInfo.html">AArch64RegisterBankInfo</a> &amp;RBI) {</div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> AArch64InstructionSelector(<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>, Subtarget, RBI);</div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;}</div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_1_1Check_html_a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396"><div class="ttname"><a href="namespacellvm_1_1Check.html#a067ee17412e800f03802fa9517685732a3450a9712780ac26b071f9da4288a396">llvm::Check::Size</a></div><div class="ttdeci">@ Size</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8h_source.html#l00077">FileCheck.h:77</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a9cf141c9194799e2fa2d92de4c6e8ff0aa245c3230debe5c956484ecc6fa93877"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a9cf141c9194799e2fa2d92de4c6e8ff0aa245c3230debe5c956484ecc6fa93877">llvm::codeview::SimpleTypeKind::Byte</a></div><div class="ttdeci">@ Byte</div></div>
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RegState_html_aef4cc0c855dc833e2a9d58a50703320dab502f975742e9bff6d6dd7b49439b806"><div class="ttname"><a href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320dab502f975742e9bff6d6dd7b49439b806">llvm::RegState::Undef</a></div><div class="ttdeci">@ Undef</div><div class="ttdoc">Value of the register doesn't matter.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00052">MachineInstrBuilder.h:52</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_aafb37937e5f21c12443bd5278264d08b"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#aafb37937e5f21c12443bd5278264d08b">fixupPHIOpBanks</a></div><div class="ttdeci">static void fixupPHIOpBanks(MachineInstr &amp;MI, MachineRegisterInfo &amp;MRI, const AArch64RegisterBankInfo &amp;RBI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l06873">AArch64InstructionSelector.cpp:6873</a></div></div>
<div class="ttc" id="aMIPatternMatch_8h_html"><div class="ttname"><a href="MIPatternMatch_8h.html">MIPatternMatch.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71af2217d25138eade76a256c4c3dc131bd"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71af2217d25138eade76a256c4c3dc131bd">llvm::AArch64II::MO_G3</a></div><div class="ttdeci">@ MO_G3</div><div class="ttdoc">MO_G3 - A symbol operand with this flag (granule 3) represents the high 16-bits of a 64-bit address,...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00715">AArch64BaseInfo.h:715</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64ISD_html_a35ad1b8db0dfad0b69c9185c5fe24e19adfb5f0cc680a060e5ca88e6e923d7183"><div class="ttname"><a href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19adfb5f0cc680a060e5ca88e6e923d7183">llvm::AArch64ISD::LOADgot</a></div><div class="ttdeci">@ LOADgot</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00078">AArch64ISelLowering.h:78</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64RegisterBankInfo_html"><div class="ttname"><a href="classllvm_1_1AArch64RegisterBankInfo.html">llvm::AArch64RegisterBankInfo</a></div><div class="ttdoc">This class provides the information for the target register banks.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64RegisterBankInfo_8h_source.html#l00104">AArch64RegisterBankInfo.h:104</a></div></div>
<div class="ttc" id="aAArch64RegisterInfo_8h_html"><div class="ttname"><a href="AArch64RegisterInfo_8h.html">AArch64RegisterInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28ab620924321db413fcc748afe522c2303"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab620924321db413fcc748afe522c2303">llvm::AArch64CC::LO</a></div><div class="ttdeci">@ LO</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00258">AArch64BaseInfo.h:258</a></div></div>
<div class="ttc" id="aProvenanceAnalysisEvaluator_8cpp_html_a2ee79648e8bce3ddbb26358ff10e3e82"><div class="ttname"><a href="ProvenanceAnalysisEvaluator_8cpp.html#a2ee79648e8bce3ddbb26358ff10e3e82">getName</a></div><div class="ttdeci">static StringRef getName(Value *V)</div><div class="ttdef"><b>Definition:</b> <a href="ProvenanceAnalysisEvaluator_8cpp_source.html#l00020">ProvenanceAnalysisEvaluator.cpp:20</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4b2430ab5e686b82f8cd6fd588d6de6f"><div class="ttname"><a href="namespacellvm.html#a4b2430ab5e686b82f8cd6fd588d6de6f">llvm::getDefIgnoringCopies</a></div><div class="ttdeci">MachineInstr * getDefIgnoringCopies(Register Reg, const MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">Find the def instruction for Reg, folding away any trivial copies.</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00461">Utils.cpp:461</a></div></div>
<div class="ttc" id="aIRTranslator_8cpp_html_abe44dfdea65b4f7e11e0a608ab708b76"><div class="ttname"><a href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div><div class="ttdeci">IRTranslator LLVM IR MI</div><div class="ttdef"><b>Definition:</b> <a href="IRTranslator_8cpp_source.html#l00109">IRTranslator.cpp:109</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28aa5506efe3dc67f7b794331f0cbffddaf"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28aa5506efe3dc67f7b794331f0cbffddaf">llvm::AArch64CC::HI</a></div><div class="ttdeci">@ HI</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00263">AArch64BaseInfo.h:263</a></div></div>
<div class="ttc" id="aMachineInstr_8h_html"><div class="ttname"><a href="MachineInstr_8h.html">MachineInstr.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a4f1ceb770fe3446bfb2b3fa26858098f"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">llvm::MachineInstrBuilder::addImm</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addImm(int64_t Val) const</div><div class="ttdoc">Add a new immediate operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00131">MachineInstrBuilder.h:131</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineConstantPool_html_afd6691ddb5d4adf50d744297e18a1c6d"><div class="ttname"><a href="classllvm_1_1MachineConstantPool.html#afd6691ddb5d4adf50d744297e18a1c6d">llvm::MachineConstantPool::getConstantPoolIndex</a></div><div class="ttdeci">unsigned getConstantPoolIndex(const Constant *C, Align Alignment)</div><div class="ttdoc">getConstantPoolIndex - Create a new entry in the constant pool or return an existing one.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l01441">MachineFunction.cpp:1441</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aAArch64MachineFunctionInfo_8h_html"><div class="ttname"><a href="AArch64MachineFunctionInfo_8h.html">AArch64MachineFunctionInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28ab89adee997fb2a645a2d26e1f1bdaadf">llvm::AArch64CC::AL</a></div><div class="ttdeci">@ AL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00269">AArch64BaseInfo.h:269</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a61d01252826372b1ec3aefc12e0c23d1"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a61d01252826372b1ec3aefc12e0c23d1">selectLoadStoreUIOp</a></div><div class="ttdeci">static unsigned selectLoadStoreUIOp(unsigned GenericOpc, unsigned RegBankID, unsigned OpSize)</div><div class="ttdoc">Select the AArch64 opcode for the G_LOAD or G_STORE operation GenericOpc, appropriate for the (value)...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00821">AArch64InstructionSelector.cpp:821</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a47f5c74e1b14ba4a61db057400644acc"><div class="ttname"><a href="classllvm_1_1Value.html#a47f5c74e1b14ba4a61db057400644acc">llvm::Value::getPointerAlignment</a></div><div class="ttdeci">Align getPointerAlignment(const DataLayout &amp;DL) const</div><div class="ttdoc">Returns an alignment of the pointer value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8cpp_source.html#l00918">Value.cpp:918</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="anamespacellvm_html_a02981de53fb6ffd384d39addc4d25f37"><div class="ttname"><a href="namespacellvm.html#a02981de53fb6ffd384d39addc4d25f37">llvm::drop_begin</a></div><div class="ttdeci">auto drop_begin(T &amp;&amp;RangeOrContainer, size_t N=1)</div><div class="ttdoc">Return a range covering RangeOrContainer with the first N elements excluded.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l00386">STLExtras.h:386</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a191e89dbc4939ebd0b572cae44aac05f"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a191e89dbc4939ebd0b572cae44aac05f">llvm::AArch64CC::NE</a></div><div class="ttdeci">@ NE</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00256">AArch64BaseInfo.h:256</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a1ab538c256c3204b950075744d5b2b16"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a1ab538c256c3204b950075744d5b2b16">GET_GLOBALISEL_PREDICATES_INIT</a></div><div class="ttdeci">#define GET_GLOBALISEL_PREDICATES_INIT</div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a1d97e13eb9923037fe733eda83b7f938"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a1d97e13eb9923037fe733eda83b7f938">llvm::AArch64_AM::LSL</a></div><div class="ttdeci">@ LSL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00035">AArch64AddressingModes.h:35</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a5c77792a06583e0fe7a0379ad94a2809"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a5c77792a06583e0fe7a0379ad94a2809">llvm::MachineRegisterInfo::createVirtualRegister</a></div><div class="ttdeci">Register createVirtualRegister(const TargetRegisterClass *RegClass, StringRef Name=&quot;&quot;)</div><div class="ttdoc">createVirtualRegister - Create and return a new virtual register in the function with the specified r...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00157">MachineRegisterInfo.cpp:157</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78b"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78b">llvm::CmpInst::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdoc">This enumeration lists the possible predicates for CmpInst subclasses.</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l00718">InstrTypes.h:718</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFrameInfo_html_a81b01652144140bfb79c6ffdaff923f9"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a81b01652144140bfb79c6ffdaff923f9">llvm::MachineFrameInfo::setReturnAddressIsTaken</a></div><div class="ttdeci">void setReturnAddressIsTaken(bool s)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00378">MachineFrameInfo.h:378</a></div></div>
<div class="ttc" id="aAMDGPURewriteUndefForPHI_8cpp_html_a2e83cb1bc3f5e8986cbd14575755a134"><div class="ttname"><a href="AMDGPURewriteUndefForPHI_8cpp.html#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a></div><div class="ttdeci">Rewrite undef for PHI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPURewriteUndefForPHI_8cpp_source.html#l00101">AMDGPURewriteUndefForPHI.cpp:101</a></div></div>
<div class="ttc" id="aARMInstructionSelector_8cpp_html_a838cd050490773e0349589c0d78618fc"><div class="ttname"><a href="ARMInstructionSelector_8cpp.html#a838cd050490773e0349589c0d78618fc">selectUnmergeValues</a></div><div class="ttdeci">static bool selectUnmergeValues(MachineInstrBuilder &amp;MIB, const ARMBaseInstrInfo &amp;TII, MachineRegisterInfo &amp;MRI, const TargetRegisterInfo &amp;TRI, const RegisterBankInfo &amp;RBI)</div><div class="ttdef"><b>Definition:</b> <a href="ARMInstructionSelector_8cpp_source.html#l00262">ARMInstructionSelector.cpp:262</a></div></div>
<div class="ttc" id="aAArch64RegisterBankInfo_8h_html"><div class="ttname"><a href="AArch64RegisterBankInfo_8h.html">AArch64RegisterBankInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_affed553a12fdb2f42041ea371820e01f"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#affed553a12fdb2f42041ea371820e01f">llvm::AArch64CC::getNZCVToSatisfyCondCode</a></div><div class="ttdeci">static unsigned getNZCVToSatisfyCondCode(CondCode Code)</div><div class="ttdoc">Given a condition code, return NZCV flags that would satisfy that condition.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00313">AArch64BaseInfo.h:313</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71a30eefa1143a0a238486ada4ff95bc34b"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a30eefa1143a0a238486ada4ff95bc34b">llvm::AArch64II::MO_G1</a></div><div class="ttdeci">@ MO_G1</div><div class="ttdoc">MO_G1 - A symbol operand with this flag (granule 1) represents the bits 16-31 of a 64-bit address,...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00723">AArch64BaseInfo.h:723</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a00b04b7613c62a52917e1d2467faeab0"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a00b04b7613c62a52917e1d2467faeab0">llvm::MIPatternMatch::m_Reg</a></div><div class="ttdeci">operand_type_match m_Reg()</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00270">MIPatternMatch.h:270</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ab240d0d30dfa9b392ef9d813f3f9e4be"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ab240d0d30dfa9b392ef9d813f3f9e4be">llvm::ConstantInt::getBitWidth</a></div><div class="ttdeci">unsigned getBitWidth() const</div><div class="ttdoc">getBitWidth - Return the bitwidth of this constant.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00135">Constants.h:135</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a517d7405576d9e17b44314a408e92cc0"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a517d7405576d9e17b44314a408e92cc0">llvm::MIPatternMatch::m_GAnd</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, TargetOpcode::G_AND, true &gt; m_GAnd(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00506">MIPatternMatch.h:506</a></div></div>
<div class="ttc" id="aclassllvm_1_1GISelKnownBits_html"><div class="ttname"><a href="classllvm_1_1GISelKnownBits.html">llvm::GISelKnownBits</a></div><div class="ttdef"><b>Definition:</b> <a href="GISelKnownBits_8h_source.html#l00029">GISelKnownBits.h:29</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a29f921516cedd7d3fde9f5adb45a46cd"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a29f921516cedd7d3fde9f5adb45a46cd">llvm::MIPatternMatch::m_GShl</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, TargetOpcode::G_SHL, false &gt; m_GShl(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00524">MIPatternMatch.h:524</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_ac8718f1c761727d429180f0ce340f7f0"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ac8718f1c761727d429180f0ce340f7f0">llvm::MachineOperand::getGlobal</a></div><div class="ttdeci">const GlobalValue * getGlobal() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00582">MachineOperand.h:582</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html">llvm::MachineRegisterInfo</a></div><div class="ttdoc">MachineRegisterInfo - Keep track of information for virtual and physical registers,...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00051">MachineRegisterInfo.h:51</a></div></div>
<div class="ttc" id="aclassT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="aAArch64MIPeepholeOpt_8cpp_html_a9c374320ed4e895f9afa199987182bd2"><div class="ttname"><a href="AArch64MIPeepholeOpt_8cpp.html#a9c374320ed4e895f9afa199987182bd2">RegSize</a></div><div class="ttdeci">unsigned RegSize</div><div class="ttdef"><b>Definition:</b> <a href="AArch64MIPeepholeOpt_8cpp_source.html#l00123">AArch64MIPeepholeOpt.cpp:123</a></div></div>
<div class="ttc" id="aAMDGPUReplaceLDSUseWithPointer_8cpp_html_a9c3943160b95cc42ca8f6e04e6d4e9b6"><div class="ttname"><a href="AMDGPUReplaceLDSUseWithPointer_8cpp.html#a9c3943160b95cc42ca8f6e04e6d4e9b6">pointer</a></div><div class="ttdeci">Replace within non kernel function use of LDS with pointer</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUReplaceLDSUseWithPointer_8cpp_source.html#l00631">AMDGPUReplaceLDSUseWithPointer.cpp:631</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a63d206a063eefcdf8c318ded97b65020"><div class="ttname"><a href="README-SSE_8txt.html#a63d206a063eefcdf8c318ded97b65020">P</a></div><div class="ttdeci">This currently compiles esp xmm0 movsd esp eax eax esp ret We should use not the dag combiner This is because dagcombine2 needs to be able to see through the X86ISD::Wrapper which DAGCombine can t really do The code for turning x load into a single vector load is target independent and should be moved to the dag combiner The code for turning x load into a vector load can only handle a direct load from a global or a direct load from the stack It should be generalized to handle any load from P</div><div class="ttdef"><b>Definition:</b> <a href="README-SSE_8txt_source.html#l00411">README-SSE.txt:411</a></div></div>
<div class="ttc" id="anamespacellvm_1_1NVPTX_html_ae1895e876155cbfcaf03955b78ff4a0e"><div class="ttname"><a href="namespacellvm_1_1NVPTX.html#ae1895e876155cbfcaf03955b78ff4a0e">llvm::NVPTX::LoadStore</a></div><div class="ttdeci">LoadStore</div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00100">NVPTX.h:100</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aAArch64ISelLowering_8cpp_html_af25c3ad8dd30f33b93e7540b8fbd27df"><div class="ttname"><a href="AArch64ISelLowering_8cpp.html#af25c3ad8dd30f33b93e7540b8fbd27df">emitConjunction</a></div><div class="ttdeci">static SDValue emitConjunction(SelectionDAG &amp;DAG, SDValue Val, AArch64CC::CondCode &amp;OutCC)</div><div class="ttdoc">Emit expression as a conjunction (a series of CCMP/CFCMP ops).</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8cpp_source.html#l03405">AArch64ISelLowering.cpp:3405</a></div></div>
<div class="ttc" id="aclassllvm_1_1GSelect_html"><div class="ttname"><a href="classllvm_1_1GSelect.html">llvm::GSelect</a></div><div class="ttdoc">Represents a G_SELECT.</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00219">GenericMachineInstrs.h:219</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_ab23f031bf813c9284ac27776b414a867"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#ab23f031bf813c9284ac27776b414a867">llvm::AArch64_AM::getFP16Imm</a></div><div class="ttdeci">static int getFP16Imm(const APInt &amp;Imm)</div><div class="ttdoc">getFP16Imm - Return an 8-bit floating-point version of the 16-bit floating-point value.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00368">AArch64AddressingModes.h:368</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0edf31d256ecb3ac003bf2d81a576c9e"><div class="ttname"><a href="namespacellvm.html#a0edf31d256ecb3ac003bf2d81a576c9e">llvm::getOpcodeDef</a></div><div class="ttdeci">MachineInstr * getOpcodeDef(unsigned Opcode, Register Reg, const MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">See if Reg is defined by an single def instruction that is Opcode.</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00475">Utils.cpp:475</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a376f5aa1990808e8e65cc77dd462c677"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a376f5aa1990808e8e65cc77dd462c677">getTestBitReg</a></div><div class="ttdeci">static Register getTestBitReg(Register Reg, uint64_t &amp;Bit, bool &amp;Invert, MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">Return a register which can be used as a bit to test in a TB(N)Z.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l01392">AArch64InstructionSelector.cpp:1392</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_aea93a9315aeba603531c6d3d3a07776e"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#aea93a9315aeba603531c6d3d3a07776e">llvm::MachineIRBuilder::getMRI</a></div><div class="ttdeci">MachineRegisterInfo * getMRI()</div><div class="ttdoc">Getter for MRI.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00291">MachineIRBuilder.h:291</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac76eb82370e997f967454f441effbbff"><div class="ttname"><a href="namespacellvm.html#ac76eb82370e997f967454f441effbbff">llvm::getIConstantVRegValWithLookThrough</a></div><div class="ttdeci">std::optional&lt; ValueAndVReg &gt; getIConstantVRegValWithLookThrough(Register VReg, const MachineRegisterInfo &amp;MRI, bool LookThroughInstrs=true)</div><div class="ttdoc">If VReg is defined by a statically evaluable chain of instructions rooted on a G_CONSTANT returns its...</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00409">Utils.cpp:409</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2cdb63ce3baf9ea9a1f86aed27f40fe8"><div class="ttname"><a href="namespacellvm.html#a2cdb63ce3baf9ea9a1f86aed27f40fe8">llvm::isPreISelGenericOpcode</a></div><div class="ttdeci">bool isPreISelGenericOpcode(unsigned Opcode)</div><div class="ttdoc">Check whether the given Opcode is a generic opcode that is not supposed to appear after ISel.</div><div class="ttdef"><b>Definition:</b> <a href="TargetOpcodes_8h_source.html#l00030">TargetOpcodes.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a0d496cc15e312863869a384532968143"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a0d496cc15e312863869a384532968143">llvm::MachineFunction::getMachineMemOperand</a></div><div class="ttdeci">MachineMemOperand * getMachineMemOperand(MachinePointerInfo PtrInfo, MachineMemOperand::Flags f, uint64_t s, Align base_alignment, const AAMDNodes &amp;AAInfo=AAMDNodes(), const MDNode *Ranges=nullptr, SyncScope::ID SSID=SyncScope::System, AtomicOrdering Ordering=AtomicOrdering::NotAtomic, AtomicOrdering FailureOrdering=AtomicOrdering::NotAtomic)</div><div class="ttdoc">getMachineMemOperand - Allocate a new MachineMemOperand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l00469">MachineFunction.cpp:469</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_acfcd22eb38dbfe1acbf138754297437a"><div class="ttname"><a href="classllvm_1_1DataLayout.html#acfcd22eb38dbfe1acbf138754297437a">llvm::DataLayout::getTypeStoreSize</a></div><div class="ttdeci">TypeSize getTypeStoreSize(Type *Ty) const</div><div class="ttdoc">Returns the maximum number of bytes that may be overwritten by storing the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00468">DataLayout.h:468</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a702d2054c0a26eb2faf6375bb5e6d021"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a702d2054c0a26eb2faf6375bb5e6d021">llvm::MIPatternMatch::m_OneNonDBGUse</a></div><div class="ttdeci">OneNonDBGUse_match&lt; SubPat &gt; m_OneNonDBGUse(const SubPat &amp;SP)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00061">MIPatternMatch.h:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegisterBankInfo_html_a53a37d4bce0298f3ec4099611c75d7ac"><div class="ttname"><a href="classllvm_1_1RegisterBankInfo.html#a53a37d4bce0298f3ec4099611c75d7ac">llvm::RegisterBankInfo::getRegBank</a></div><div class="ttdeci">RegisterBank &amp; getRegBank(unsigned ID)</div><div class="ttdoc">Get the register bank identified by ID.</div><div class="ttdef"><b>Definition:</b> <a href="RegisterBankInfo_8h_source.html#l00431">RegisterBankInfo.h:431</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3a91375dbee36ddeeee15b974e39782c"><div class="ttname"><a href="namespacellvm.html#a3a91375dbee36ddeeee15b974e39782c">llvm::getBLRCallOpcode</a></div><div class="ttdeci">unsigned getBLRCallOpcode(const MachineFunction &amp;MF)</div><div class="ttdoc">Return opcode to be used for indirect calls.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8cpp_source.html#l08305">AArch64InstrInfo.cpp:8305</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64GISelUtils_html_a6ac70c96c3ec3ca110703f1ebfe5e0ef"><div class="ttname"><a href="namespacellvm_1_1AArch64GISelUtils.html#a6ac70c96c3ec3ca110703f1ebfe5e0ef">llvm::AArch64GISelUtils::changeFCMPPredToAArch64CC</a></div><div class="ttdeci">void changeFCMPPredToAArch64CC(const CmpInst::Predicate P, AArch64CC::CondCode &amp;CondCode, AArch64CC::CondCode &amp;CondCode2)</div><div class="ttdoc">Find the AArch64 condition codes necessary to represent P for a scalar floating point comparison.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64GlobalISelUtils_8cpp_source.html#l00099">AArch64GlobalISelUtils.cpp:99</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86Disassembler_html_a1e59b79e1d09149912cad9c0ef2809ad"><div class="ttname"><a href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">llvm::X86Disassembler::Reg</a></div><div class="ttdeci">Reg</div><div class="ttdoc">All possible values of the reg field in the ModR/M byte.</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00462">X86DisassemblerDecoder.h:462</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a9acef535219004fa4c89f4f996343b6f"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a9acef535219004fa4c89f4f996343b6f">copySubReg</a></div><div class="ttdeci">static bool copySubReg(MachineInstr &amp;I, MachineRegisterInfo &amp;MRI, const RegisterBankInfo &amp;RBI, Register SrcReg, const TargetRegisterClass *To, unsigned SubReg)</div><div class="ttdoc">Helper function for selectCopy.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00859">AArch64InstructionSelector.cpp:859</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a933b079df28c77f3850ed1edf94c6ed8"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a933b079df28c77f3850ed1edf94c6ed8">selectCopy</a></div><div class="ttdeci">static bool selectCopy(MachineInstr &amp;I, const TargetInstrInfo &amp;TII, MachineRegisterInfo &amp;MRI, const TargetRegisterInfo &amp;TRI, const RegisterBankInfo &amp;RBI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00942">AArch64InstructionSelector.cpp:942</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionSelector_html_a6ed0a63bc189027f8e81235be11886e3"><div class="ttname"><a href="classllvm_1_1InstructionSelector.html#a6ed0a63bc189027f8e81235be11886e3">llvm::InstructionSelector::setupMF</a></div><div class="ttdeci">virtual void setupMF(MachineFunction &amp;mf, GISelKnownBits *KB, CodeGenCoverage &amp;covinfo, ProfileSummaryInfo *psi, BlockFrequencyInfo *bfi)</div><div class="ttdoc">Setup per-MF selector state.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSelector_8h_source.html#l00463">InstructionSelector.h:463</a></div></div>
<div class="ttc" id="aMachineBasicBlock_8h_html"><div class="ttname"><a href="MachineBasicBlock_8h.html">MachineBasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetSubtargetInfo_html_a87849514193302b75f50a8092f94b98a"><div class="ttname"><a href="classllvm_1_1TargetSubtargetInfo.html#a87849514193302b75f50a8092f94b98a">llvm::TargetSubtargetInfo::getRegisterInfo</a></div><div class="ttdeci">virtual const TargetRegisterInfo * getRegisterInfo() const</div><div class="ttdoc">getRegisterInfo - If register information is available, return it.</div><div class="ttdef"><b>Definition:</b> <a href="TargetSubtargetInfo_8h_source.html#l00127">TargetSubtargetInfo.h:127</a></div></div>
<div class="ttc" id="astructllvm_1_1MemOp_html"><div class="ttname"><a href="structllvm_1_1MemOp.html">llvm::MemOp</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLowering_8h_source.html#l00112">TargetLowering.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a7e0683c1bfad27f51e8d6c3a8cbdbfdc"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a7e0683c1bfad27f51e8d6c3a8cbdbfdc">llvm::MachineRegisterInfo::use_nodbg_instructions</a></div><div class="ttdeci">iterator_range&lt; use_instr_nodbg_iterator &gt; use_nodbg_instructions(Register Reg) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00565">MachineRegisterInfo.h:565</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html">llvm::TargetRegisterInfo</a></div><div class="ttdoc">TargetRegisterInfo base class - We assume that the target defines a static array of TargetRegisterDes...</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00236">TargetRegisterInfo.h:236</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639"><div class="ttname"><a href="namespacellvm.html#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">llvm::Depth</a></div><div class="ttdeci">@ Depth</div><div class="ttdef"><b>Definition:</b> <a href="SIMachineScheduler_8h_source.html#l00036">SIMachineScheduler.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a9fffac2512fe651f0d5e37e27f5bd51c"><div class="ttname"><a href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">llvm::Function::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">getContext - Return a reference to the LLVMContext associated with this function.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00315">Function.cpp:315</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFP_html_ae46c23ed39de6de6cf9ec6e57755e4c5"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#ae46c23ed39de6de6cf9ec6e57755e4c5">llvm::ConstantFP::isZero</a></div><div class="ttdeci">bool isZero() const</div><div class="ttdoc">Return true if the value is positive or negative zero.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00301">Constants.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5bd19c94d27d32e7949345b46171ed20"><div class="ttname"><a href="namespacellvm.html#a5bd19c94d27d32e7949345b46171ed20">llvm::shouldOptForSize</a></div><div class="ttdeci">bool shouldOptForSize(const MachineBasicBlock &amp;MBB, ProfileSummaryInfo *PSI, BlockFrequencyInfo *BFI)</div><div class="ttdoc">Returns true if the given block should be optimized for size.</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l01326">Utils.cpp:1326</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARMII_html_a7d414894ef8cdc39b147eb7e0d7e4305a479711d0ab662307550fc709665589ea"><div class="ttname"><a href="namespacellvm_1_1ARMII.html#a7d414894ef8cdc39b147eb7e0d7e4305a479711d0ab662307550fc709665589ea">llvm::ARMII::VecSize</a></div><div class="ttdeci">@ VecSize</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00421">ARMBaseInfo.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1GLoadStore_html_a7a93f7892da9c7831d18671d864d9404"><div class="ttname"><a href="classllvm_1_1GLoadStore.html#a7a93f7892da9c7831d18671d864d9404">llvm::GLoadStore::getMemSizeInBits</a></div><div class="ttdeci">uint64_t getMemSizeInBits() const</div><div class="ttdoc">Returns the size in bits of the memory access.</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00063">GenericMachineInstrs.h:63</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineMemOperand_html"><div class="ttname"><a href="classllvm_1_1MachineMemOperand.html">llvm::MachineMemOperand</a></div><div class="ttdoc">A description of a memory reference used in the backend.</div><div class="ttdef"><b>Definition:</b> <a href="MachineMemOperand_8h_source.html#l00127">MachineMemOperand.h:127</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_afef7d46bdebb2335e9947791fa017bb1"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#afef7d46bdebb2335e9947791fa017bb1">changeFPCCToORAArch64CC</a></div><div class="ttdeci">static void changeFPCCToORAArch64CC(CmpInst::Predicate CC, AArch64CC::CondCode &amp;CondCode, AArch64CC::CondCode &amp;CondCode2)</div><div class="ttdoc">changeFPCCToORAArch64CC - Convert an IR fp condition code to an AArch64 CC.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l01308">AArch64InstructionSelector.cpp:1308</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a32ea768fbb182d6bbe3ff85ae1eb7031"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a32ea768fbb182d6bbe3ff85ae1eb7031">llvm::MachineOperand::isCImm</a></div><div class="ttdeci">bool isCImm() const</div><div class="ttdoc">isCImm - Test if this is a MO_CImmediate operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00333">MachineOperand.h:333</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_ab05719438bdf4b46871e5ecd9730caeb"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">llvm::MachineInstr::getMF</a></div><div class="ttdeci">const MachineFunction * getMF() const</div><div class="ttdoc">Return the function that contains the basic block that this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00691">MachineInstr.cpp:691</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFP_html_a7faf4e0334b77ab527e4b45e3a1f4d65"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a7faf4e0334b77ab527e4b45e3a1f4d65">llvm::ConstantFP::getValueAPF</a></div><div class="ttdeci">const APFloat &amp; getValueAPF() const</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00297">Constants.h:297</a></div></div>
<div class="ttc" id="aGenericMachineInstrs_8h_html"><div class="ttname"><a href="GenericMachineInstrs_8h.html">GenericMachineInstrs.h</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_a250e66aa31a03567cc345ca1bc463b8c"><div class="ttname"><a href="ELFObjHandler_8cpp.html#a250e66aa31a03567cc345ca1bc463b8c">Offset</a></div><div class="ttdeci">uint64_t Offset</div><div class="ttdef"><b>Definition:</b> <a href="ELFObjHandler_8cpp_source.html#l00080">ELFObjHandler.cpp:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFrameInfo_html_a14ca8f1aa1c62b860504b766ad3b15f9"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a14ca8f1aa1c62b860504b766ad3b15f9">llvm::MachineFrameInfo::setAdjustsStack</a></div><div class="ttdeci">void setAdjustsStack(bool V)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00610">MachineFrameInfo.h:610</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_a4cac2a17ab11d53dd0a49871b80f5c7a"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#a4cac2a17ab11d53dd0a49871b80f5c7a">llvm::MachineIRBuilder::setInstr</a></div><div class="ttdeci">void setInstr(MachineInstr &amp;MI)</div><div class="ttdoc">Set the insertion point to before MI.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00344">MachineIRBuilder.h:344</a></div></div>
<div class="ttc" id="aMachineIRBuilder_8h_html"><div class="ttname"><a href="MachineIRBuilder_8h.html">MachineIRBuilder.h</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a87b8bfbbe9d8f7146d7f20a5fb42efd0"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a></div><div class="ttdeci">Value * RHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00076">X86PartialReduction.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a7da5cc6e8aadd4d5fb6dd68f8ec12b7e"><div class="ttname"><a href="classllvm_1_1LLT.html#a7da5cc6e8aadd4d5fb6dd68f8ec12b7e">llvm::LLT::isVector</a></div><div class="ttdeci">constexpr bool isVector() const</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00129">LowLevelTypeImpl.h:129</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_aa24450f600cabd7212bd264a6dbc190c"><div class="ttname"><a href="classllvm_1_1LLT.html#aa24450f600cabd7212bd264a6dbc190c">llvm::LLT::getElementType</a></div><div class="ttdeci">constexpr LLT getElementType() const</div><div class="ttdoc">Returns the vector's element type. Only valid for vector types.</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00257">LowLevelTypeImpl.h:257</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdeci">@ Load</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_af624ff47eaa512dbe23866accb3837c1"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#af624ff47eaa512dbe23866accb3837c1">llvm::MachineOperand::getOffset</a></div><div class="ttdeci">int64_t getOffset() const</div><div class="ttdoc">Return the offset from the symbol in this operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00629">MachineOperand.h:629</a></div></div>
<div class="ttc" id="aMachineSink_8cpp_html_a0f36ed1bc17fc1aa97fe291c439a0698"><div class="ttname"><a href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a></div><div class="ttdeci">unsigned const TargetRegisterInfo * TRI</div><div class="ttdef"><b>Definition:</b> <a href="MachineSink_8cpp_source.html#l01628">MachineSink.cpp:1628</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerUnion_html_a47a37d4a29c6d015b0ec9b0e722110fe"><div class="ttname"><a href="classllvm_1_1PointerUnion.html#a47a37d4a29c6d015b0ec9b0e722110fe">llvm::PointerUnion::get</a></div><div class="ttdeci">T get() const</div><div class="ttdoc">Returns the value of the specified pointer type.</div><div class="ttdef"><b>Definition:</b> <a href="PointerUnion_8h_source.html#l00155">PointerUnion.h:155</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_abef0dedc73ed9227d3b97209d619ee72"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#abef0dedc73ed9227d3b97209d619ee72">llvm::MIPatternMatch::m_GPtrAdd</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, TargetOpcode::G_PTR_ADD, false &gt; m_GPtrAdd(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00470">MIPatternMatch.h:470</a></div></div>
<div class="ttc" id="anamespacellvm_html_a56f5d55460d7e31fc6c3318882f36ac7"><div class="ttname"><a href="namespacellvm.html#a56f5d55460d7e31fc6c3318882f36ac7">llvm::getIConstantVRegSExtVal</a></div><div class="ttdeci">std::optional&lt; int64_t &gt; getIConstantVRegSExtVal(Register VReg, const MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">If VReg is defined by a G_CONSTANT fits in int64_t returns it.</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00300">Utils.cpp:300</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2a0be879cebaa17d623212f729b1d4b1"><div class="ttname"><a href="namespacellvm.html#a2a0be879cebaa17d623212f729b1d4b1">llvm::constrainSelectedInstRegOperands</a></div><div class="ttdeci">bool constrainSelectedInstRegOperands(MachineInstr &amp;I, const TargetInstrInfo &amp;TII, const TargetRegisterInfo &amp;TRI, const RegisterBankInfo &amp;RBI)</div><div class="ttdoc">Mutate the newly-selected instruction I to constrain its (possibly generic) virtual register operands...</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00152">Utils.cpp:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_afc4107c92fd8d37e8d0cb596f2a25d98"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#afc4107c92fd8d37e8d0cb596f2a25d98">llvm::MachineInstr::addMemOperand</a></div><div class="ttdeci">void addMemOperand(MachineFunction &amp;MF, MachineMemOperand *MO)</div><div class="ttdoc">Add a MachineMemOperand to the machine instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00363">MachineInstr.cpp:363</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71add46ede0892fdd429e940eb97c1e6e55"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71add46ede0892fdd429e940eb97c1e6e55">llvm::AArch64II::MO_TLS</a></div><div class="ttdeci">@ MO_TLS</div><div class="ttdoc">MO_TLS - Indicates that the operand being accessed is some kind of thread-local symbol.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00753">AArch64BaseInfo.h:753</a></div></div>
<div class="ttc" id="aMachineRegisterInfo_8h_html"><div class="ttname"><a href="MachineRegisterInfo_8h.html">MachineRegisterInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a968f33165430f95099556df970a6336a">llvm::AArch64CC::LT</a></div><div class="ttdeci">@ LT</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00266">AArch64BaseInfo.h:266</a></div></div>
<div class="ttc" id="aclassllvm_1_1GSelect_html_a6ef78494a917cd68f35d479588ec82dc"><div class="ttname"><a href="classllvm_1_1GSelect.html#a6ef78494a917cd68f35d479588ec82dc">llvm::GSelect::getCondReg</a></div><div class="ttdeci">Register getCondReg() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00221">GenericMachineInstrs.h:221</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_html_a02134e88cd18139c71d9274c7d287ac3"><div class="ttname"><a href="namespacellvm.html#a02134e88cd18139c71d9274c7d287ac3">llvm::getFunctionLiveInPhysReg</a></div><div class="ttdeci">Register getFunctionLiveInPhysReg(MachineFunction &amp;MF, const TargetInstrInfo &amp;TII, MCRegister PhysReg, const TargetRegisterClass &amp;RC, const DebugLoc &amp;DL, LLT RegTy=LLT())</div><div class="ttdoc">Return a virtual register corresponding to the incoming argument register PhysReg.</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00729">Utils.cpp:729</a></div></div>
<div class="ttc" id="anamespacellvm_1_1BitmaskEnumDetail_html_a91efa71de05b0c2d00730a0279f58658"><div class="ttname"><a href="namespacellvm_1_1BitmaskEnumDetail.html#a91efa71de05b0c2d00730a0279f58658">llvm::BitmaskEnumDetail::Mask</a></div><div class="ttdeci">constexpr std::underlying_type_t&lt; E &gt; Mask()</div><div class="ttdoc">Get a bitmask with 1s in all places up to the high-order bit of E's largest value.</div><div class="ttdef"><b>Definition:</b> <a href="BitmaskEnum_8h_source.html#l00080">BitmaskEnum.h:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a85eb6ee9f537a283b2ba9964c54ab2f2"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a85eb6ee9f537a283b2ba9964c54ab2f2">llvm::MachineInstrBuilder::addDef</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addDef(Register RegNo, unsigned Flags=0, unsigned SubReg=0) const</div><div class="ttdoc">Add a virtual register definition operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00116">MachineInstrBuilder.h:116</a></div></div>
<div class="ttc" id="aclassllvm_1_1Register_html_a13bd3dae94013a7bf38afc9391c8fa8f"><div class="ttname"><a href="classllvm_1_1Register.html#a13bd3dae94013a7bf38afc9391c8fa8f">llvm::Register::isPhysical</a></div><div class="ttdeci">bool isPhysical() const</div><div class="ttdoc">Return true if the specified register number is in the physical register namespace.</div><div class="ttdef"><b>Definition:</b> <a href="Register_8h_source.html#l00097">Register.h:97</a></div></div>
<div class="ttc" id="aX86PartialReduction_8cpp_html_a9e1483f7215664a2315c53c3558d9a8d"><div class="ttname"><a href="X86PartialReduction_8cpp.html#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></div><div class="ttdeci">Value * LHS</div><div class="ttdef"><b>Definition:</b> <a href="X86PartialReduction_8cpp_source.html#l00075">X86PartialReduction.cpp:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00078">Constants.h:78</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2c635acfc68033798540dea72a03fced"><div class="ttname"><a href="namespacellvm.html#a2c635acfc68033798540dea72a03fced">llvm::getXPACOpcodeForKey</a></div><div class="ttdeci">static unsigned getXPACOpcodeForKey(AArch64PACKey::ID K)</div><div class="ttdoc">Return XPAC opcode to be used for a ptrauth strip using the given key.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8h_source.html#l00509">AArch64InstrInfo.h:509</a></div></div>
<div class="ttc" id="aclassllvm_1_1BlockFrequencyInfo_html"><div class="ttname"><a href="classllvm_1_1BlockFrequencyInfo.html">llvm::BlockFrequencyInfo</a></div><div class="ttdoc">BlockFrequencyInfo pass uses BlockFrequencyInfoImpl implementation to estimate IR basic block frequen...</div><div class="ttdef"><b>Definition:</b> <a href="BlockFrequencyInfo_8h_source.html#l00037">BlockFrequencyInfo.h:37</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_ab4a6ca428289b667dd691a00e9f7e334"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">llvm::MachineFunction::getRegInfo</a></div><div class="ttdeci">MachineRegisterInfo &amp; getRegInfo()</div><div class="ttdoc">getRegInfo - Return information about the registers currently in use.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00682">MachineFunction.h:682</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71a6d9cfbe4ea54a3ce9d5308efab7200b9"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a6d9cfbe4ea54a3ce9d5308efab7200b9">llvm::AArch64II::MO_G0</a></div><div class="ttdeci">@ MO_G0</div><div class="ttdoc">MO_G0 - A symbol operand with this flag (granule 0) represents the bits 0-15 of a 64-bit address,...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00727">AArch64BaseInfo.h:727</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetInstrInfo_html"><div class="ttname"><a href="classllvm_1_1TargetInstrInfo.html">llvm::TargetInstrInfo</a></div><div class="ttdoc">TargetInstrInfo - Interface to description of machine instruction set.</div><div class="ttdef"><b>Definition:</b> <a href="TargetInstrInfo_8h_source.html#l00098">TargetInstrInfo.h:98</a></div></div>
<div class="ttc" id="aAArch64TargetMachine_8h_html"><div class="ttname"><a href="AArch64TargetMachine_8h.html">AArch64TargetMachine.h</a></div></div>
<div class="ttc" id="aAArch64InstrInfo_8h_html"><div class="ttname"><a href="AArch64InstrInfo_8h.html">AArch64InstrInfo.h</a></div></div>
<div class="ttc" id="aREADME-SSE_8txt_html_a9fb6cbbc77fb02ab3a51b0660bd09909"><div class="ttname"><a href="README-SSE_8txt.html#a9fb6cbbc77fb02ab3a51b0660bd09909">select</a></div><div class="ttdeci">into xmm2 addss xmm2 xmm1 xmm3 addss xmm3 movaps xmm0 unpcklps xmm0 ret seems silly when it could just be one addps Expand libm rounding functions main should enable SSE DAZ mode and other fast SSE modes Think about doing i64 math in SSE regs on x86 This testcase should have no SSE instructions in and only one load from a constant double ret double C the select is being which prevents the dag combiner from turning select(load CPI1)</div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_af8571e8dfb010fd8ae76cc4f87aafaac"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#af8571e8dfb010fd8ae76cc4f87aafaac">llvm::MachineInstrBuilder::addMBB</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addMBB(MachineBasicBlock *MBB, unsigned TargetFlags=0) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00146">MachineInstrBuilder.h:146</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a0be9a5b045e14f589506ab6372ab6592"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a0be9a5b045e14f589506ab6372ab6592">llvm::AArch64CC::VC</a></div><div class="ttdeci">@ VC</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00262">AArch64BaseInfo.h:262</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegisterBank_html"><div class="ttname"><a href="classllvm_1_1RegisterBank.html">llvm::RegisterBank</a></div><div class="ttdoc">This class implements the register bank concept.</div><div class="ttdef"><b>Definition:</b> <a href="RegisterBank_8h_source.html#l00028">RegisterBank.h:28</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a4270a5b1563f22920b7b0f053aee504f"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a4270a5b1563f22920b7b0f053aee504f">llvm::MIPatternMatch::m_GZExt</a></div><div class="ttdeci">UnaryOp_match&lt; SrcTy, TargetOpcode::G_ZEXT &gt; m_GZExt(const SrcTy &amp;Src)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00581">MIPatternMatch.h:581</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a8d65688eb3408e2f26bf75b83a1b3448"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a8d65688eb3408e2f26bf75b83a1b3448">llvm::MachineRegisterInfo::setType</a></div><div class="ttdeci">void setType(Register VReg, LLT Ty)</div><div class="ttdoc">Set the low-level type of VReg to Ty.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00179">MachineRegisterInfo.cpp:179</a></div></div>
<div class="ttc" id="aMipsDisassembler_8cpp_html_a15b5b86944f6df97d2c3659d77f51f91"><div class="ttname"><a href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a></div><div class="ttdeci">static unsigned getReg(const MCDisassembler *D, unsigned RC, unsigned RegNo)</div><div class="ttdef"><b>Definition:</b> <a href="MipsDisassembler_8cpp_source.html#l00521">MipsDisassembler.cpp:521</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html_ae4b6abe77abf42fb02081a6cc41a0132"><div class="ttname"><a href="classllvm_1_1Constant.html#ae4b6abe77abf42fb02081a6cc41a0132">llvm::Constant::isNullValue</a></div><div class="ttdeci">bool isNullValue() const</div><div class="ttdoc">Return true if this is the value that would be returned by getNullValue.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8cpp_source.html#l00076">Constants.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64InstrInfo_html"><div class="ttname"><a href="classllvm_1_1AArch64InstrInfo.html">llvm::AArch64InstrInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8h_source.html#l00035">AArch64InstrInfo.h:35</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a262431cccd14e6063eacc180130a5882"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a262431cccd14e6063eacc180130a5882">llvm::AArch64_AM::isLogicalImmediate</a></div><div class="ttdeci">static bool isLogicalImmediate(uint64_t imm, unsigned regSize)</div><div class="ttdoc">isLogicalImmediate - Return true if the immediate is valid for a logical immediate instruction of the...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00276">AArch64AddressingModes.h:276</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a38b28a85f818b49d8806c150b8a5b4f7"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">llvm::MachineOperand::getImm</a></div><div class="ttdeci">int64_t getImm() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00556">MachineOperand.h:556</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a1cd36a579f079f7f4506d9d097b2f0a8"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a1cd36a579f079f7f4506d9d097b2f0a8">GET_GLOBALISEL_TEMPORARIES_INIT</a></div><div class="ttdeci">#define GET_GLOBALISEL_TEMPORARIES_INIT</div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_ac2dc0fa143c9f2127f0501734577a0a0"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ac2dc0fa143c9f2127f0501734577a0a0">llvm::MachineFunction::getInfo</a></div><div class="ttdeci">Ty * getInfo()</div><div class="ttdoc">getInfo - Keep track of various per-function pieces of information for backends that would like to do...</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00770">MachineFunction.h:770</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a3f7a45f6e10668a5f702e26bca80d18e"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">llvm::MachineInstr::getOperand</a></div><div class="ttdeci">const MachineOperand &amp; getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00526">MachineInstr.h:526</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_afd3920e024c9e79df5fd07b03c64d314"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#afd3920e024c9e79df5fd07b03c64d314">llvm::MachineIRBuilder::buildPtrToInt</a></div><div class="ttdeci">MachineInstrBuilder buildPtrToInt(const DstOp &amp;Dst, const SrcOp &amp;Src)</div><div class="ttdoc">Build and insert a G_PTRTOINT instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00680">MachineIRBuilder.h:680</a></div></div>
<div class="ttc" id="anamespacellvm_html_a582e08755c7a8d1b0bf6c5dcb765aaa8"><div class="ttname"><a href="namespacellvm.html#a582e08755c7a8d1b0bf6c5dcb765aaa8">llvm::isShiftedMask_64</a></div><div class="ttdeci">constexpr bool isShiftedMask_64(uint64_t Value)</div><div class="ttdoc">Return true if the argument contains a non-empty sequence of ones with the remainder zero (64 bit ver...</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00286">MathExtras.h:286</a></div></div>
<div class="ttc" id="aregexec_8c_html_ac07acfbb082b04f5bea72998c8976b3c"><div class="ttname"><a href="regexec_8c.html#ac07acfbb082b04f5bea72998c8976b3c">EQ</a></div><div class="ttdeci">#define EQ(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="regexec_8c_source.html#l00112">regexec.c:112</a></div></div>
<div class="ttc" id="aAArch64ISelLowering_8cpp_html_a02f6de82e3085eef9b1ad0ebe9b2d500"><div class="ttname"><a href="AArch64ISelLowering_8cpp.html#a02f6de82e3085eef9b1ad0ebe9b2d500">emitConditionalComparison</a></div><div class="ttdeci">static SDValue emitConditionalComparison(SDValue LHS, SDValue RHS, ISD::CondCode CC, SDValue CCOp, AArch64CC::CondCode Predicate, AArch64CC::CondCode OutCC, const SDLoc &amp;DL, SelectionDAG &amp;DAG)</div><div class="ttdoc">can be transformed to: not (and (not (and (setCC (cmp C)) (setCD (cmp D)))) (and (not (setCA (cmp A))...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8cpp_source.html#l03184">AArch64ISelLowering.cpp:3184</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterClass_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterClass.html">llvm::TargetRegisterClass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00045">TargetRegisterInfo.h:45</a></div></div>
<div class="ttc" id="aCodeGen_2GlobalISel_2Utils_8h_html"><div class="ttname"><a href="CodeGen_2GlobalISel_2Utils_8h.html">Utils.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1PALMD_html_af892c75285b0f64d58ca76cb73059adf"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1PALMD.html#af892c75285b0f64d58ca76cb73059adf">llvm::AMDGPU::PALMD::Key</a></div><div class="ttdeci">Key</div><div class="ttdoc">PAL metadata keys.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00486">AMDGPUMetadata.h:486</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a1c7202c6054fef862bbed45957747cdfa36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdeci">@ Store</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00033">SparcInstrInfo.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46a759ecca259756790f64e470254a4e886"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46a759ecca259756790f64e470254a4e886">llvm::AArch64PACKey::LAST</a></div><div class="ttdeci">@ LAST</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00795">AArch64BaseInfo.h:795</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a7d0223b39a4cf6354c08b3d7fcc35630">llvm::AArch64CC::HS</a></div><div class="ttdeci">@ HS</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00257">AArch64BaseInfo.h:257</a></div></div>
<div class="ttc" id="aTargetOpcodes_8h_html"><div class="ttname"><a href="TargetOpcodes_8h.html">TargetOpcodes.h</a></div></div>
<div class="ttc" id="aHexagonCopyToCombine_8cpp_html_a1d40004718218dbdf06b496766299101"><div class="ttname"><a href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a></div><div class="ttdeci">const HexagonInstrInfo * TII</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCopyToCombine_8cpp_source.html#l00125">HexagonCopyToCombine.cpp:125</a></div></div>
<div class="ttc" id="anamespacellvm_1_1dwarf_html_a5d3c920b66ea797d6adb243862fdf47a"><div class="ttname"><a href="namespacellvm_1_1dwarf.html#a5d3c920b66ea797d6adb243862fdf47a">llvm::dwarf::Index</a></div><div class="ttdeci">Index</div><div class="ttdef"><b>Definition:</b> <a href="Dwarf_8h_source.html#l00550">Dwarf.h:550</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a7b39ecfd6793534206dbb095b0d464c7"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a7b39ecfd6793534206dbb095b0d464c7">llvm::MachineOperand::ChangeToImmediate</a></div><div class="ttdeci">void ChangeToImmediate(int64_t ImmVal, unsigned TargetFlags=0)</div><div class="ttdoc">ChangeToImmediate - Replace this operand with a new immediate operand of the specified value.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8cpp_source.html#l00162">MachineOperand.cpp:162</a></div></div>
<div class="ttc" id="anamespacellvm_html_a646986783f35e0fef8988f0f28d2589f"><div class="ttname"><a href="namespacellvm.html#a646986783f35e0fef8988f0f28d2589f">llvm::Log2_32</a></div><div class="ttdeci">unsigned Log2_32(uint32_t Value)</div><div class="ttdoc">Return the floor log base 2 of the specified value, -1 if the value is zero.</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00382">MathExtras.h:382</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_a6be291efcc6345779494105f57f85aac"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#a6be291efcc6345779494105f57f85aac">llvm::MachineIRBuilder::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00283">MachineIRBuilder.h:283</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html"><div class="ttname"><a href="classllvm_1_1MachineOperand.html">llvm::MachineOperand</a></div><div class="ttdoc">MachineOperand class - Representation of each machine instruction operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00048">MachineOperand.h:48</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CodeModel_html_afc59396a9e5809fc92938e203d91a8dfaa2554ef60dc191c6005ba9eecbc9aea0"><div class="ttname"><a href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfaa2554ef60dc191c6005ba9eecbc9aea0">llvm::CodeModel::Small</a></div><div class="ttdeci">@ Small</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_8h_source.html#l00031">CodeGen.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a52cd802a268f6ed25d878c96d8b16247"><div class="ttname"><a href="classllvm_1_1LLT.html#a52cd802a268f6ed25d878c96d8b16247">llvm::LLT::multiplyElements</a></div><div class="ttdeci">constexpr LLT multiplyElements(int Factor) const</div><div class="ttdoc">Produce a vector type that is Factor times bigger, preserving the element type.</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00220">LowLevelTypeImpl.h:220</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_aafa6584a25c261a3300bcadca8073518"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#aafa6584a25c261a3300bcadca8073518">createDTuple</a></div><div class="ttdeci">static Register createDTuple(ArrayRef&lt; Register &gt; Regs, MachineIRBuilder &amp;MIB)</div><div class="ttdoc">Create a tuple of D-registers using the registers in Regs.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00660">AArch64InstructionSelector.cpp:660</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1ac3bdf1b8c8fd1f36afa7af40bb1a1a59"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1ac3bdf1b8c8fd1f36afa7af40bb1a1a59">llvm::AArch64_AM::SXTB</a></div><div class="ttdeci">@ SXTB</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00046">AArch64AddressingModes.h:46</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a7e1384a3b7d612a03b54d9c8f2071a04"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a7e1384a3b7d612a03b54d9c8f2071a04">llvm::AArch64_AM::LSR</a></div><div class="ttdeci">@ LSR</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00036">AArch64AddressingModes.h:36</a></div></div>
<div class="ttc" id="aX86InterleavedAccess_8cpp_html_a76c9562101f54d25482f88ae29ed6131"><div class="ttname"><a href="X86InterleavedAccess_8cpp.html#a76c9562101f54d25482f88ae29ed6131">Concat</a></div><div class="ttdeci">static constexpr int Concat[]</div><div class="ttdef"><b>Definition:</b> <a href="X86InterleavedAccess_8cpp_source.html#l00239">X86InterleavedAccess.cpp:239</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_aeae88f12b667477f90db9b726556b337"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#aeae88f12b667477f90db9b726556b337">llvm::AArch64_AM::getShifterImm</a></div><div class="ttdeci">static unsigned getShifterImm(AArch64_AM::ShiftExtendType ST, unsigned Imm)</div><div class="ttdoc">getShifterImm - Encode the shift type and amount: imm: 6-bit shift amount shifter: 000 ==&gt; lsl 001 ==...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00099">AArch64AddressingModes.h:99</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_ac0ca0a03e016a6da0766af3c725a7c47"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#ac0ca0a03e016a6da0766af3c725a7c47">llvm::MachineIRBuilder::getMF</a></div><div class="ttdeci">MachineFunction &amp; getMF()</div><div class="ttdoc">Getter for the function we currently build.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00273">MachineIRBuilder.h:273</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a3989251b1a714fc8296685f77eac6e87"><div class="ttname"><a href="classllvm_1_1LLT.html#a3989251b1a714fc8296685f77eac6e87">llvm::LLT::isScalar</a></div><div class="ttdeci">constexpr bool isScalar() const</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00123">LowLevelTypeImpl.h:123</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1ae52597f63d00aac32d655ca8d67a689b"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1ae52597f63d00aac32d655ca8d67a689b">llvm::AArch64_AM::SXTH</a></div><div class="ttdeci">@ SXTH</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00047">AArch64AddressingModes.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64TargetMachine_html"><div class="ttname"><a href="classllvm_1_1AArch64TargetMachine.html">llvm::AArch64TargetMachine</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64TargetMachine_8h_source.html#l00024">AArch64TargetMachine.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_a217e0207d9cc8e046c2dccbf0e4bb198"><div class="ttname"><a href="classllvm_1_1APInt.html#a217e0207d9cc8e046c2dccbf0e4bb198">llvm::APInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Get zero extended value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l01494">APInt.h:1494</a></div></div>
<div class="ttc" id="alib_2XRay_2CMakeLists_8txt_html_aafdfebe14a06b834fe5fb0d10309d43c"><div class="ttname"><a href="lib_2XRay_2CMakeLists_8txt.html#aafdfebe14a06b834fe5fb0d10309d43c">include</a></div><div class="ttdeci">include(LLVM-Build) add_subdirectory(IR) add_subdirectory(FuzzMutate) add_subdirectory(FileCheck) add_subdirectory(InterfaceStub) add_subdirectory(IRPrinter) add_subdirectory(IRReader) add_subdirectory(CodeGen) add_subdirectory(BinaryFormat) add_subdirectory(Bitcode) add_subdirectory(Bitstream) add_subdirectory(DWARFLinker) add_subdirectory(DWARFLinkerParallel) add_subdirectory(Extensions) add_subdirectory(Frontend) add_subdirectory(Transforms) add_subdirectory(Linker) add_subdirectory(Analysis) add_subdirectory(LTO) add_subdirectory(MC) add_subdirectory(MCA) add_subdirectory(ObjCopy) add_subdirectory(Object) add_subdirectory(ObjectYAML) add_subdirectory(Option) add_subdirectory(Remarks) add_subdirectory(Debuginfod) add_subdirectory(DebugInfo) add_subdirectory(DWP) add_subdirectory(ExecutionEngine) add_subdirectory(Target) add_subdirectory(AsmParser) add_subdirectory(LineEditor) add_subdirectory(ProfileData) add_subdirectory(Passes) add_subdirectory(TargetParser) add_subdirectory(TextAPI) add_subdirectory(ToolDrivers) add_subdirectory(XRay) if(LLVM_INCLUDE_TESTS) add_subdirectory(Testing) endif() add_subdirectory(WindowsDriver) add_subdirectory(WindowsManifest) set(LLVMCONFIGLIBRARYDEPENDENCIESINC &quot;$</div><div class="ttdef"><b>Definition:</b> <a href="lib_2XRay_2CMakeLists_8txt_source.html#l00001">CMakeLists.txt:1</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFP_html"><div class="ttname"><a href="classllvm_1_1ConstantFP.html">llvm::ConstantFP</a></div><div class="ttdoc">ConstantFP - Floating Point Values [float, double].</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00256">Constants.h:256</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28aeb67eda6b42e3237bc28fb457347a1cb"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28aeb67eda6b42e3237bc28fb457347a1cb">llvm::AArch64CC::LE</a></div><div class="ttdeci">@ LE</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00268">AArch64BaseInfo.h:268</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegisterBank_html_abea60948498472cef86d66586ded919e"><div class="ttname"><a href="classllvm_1_1RegisterBank.html#abea60948498472cef86d66586ded919e">llvm::RegisterBank::getID</a></div><div class="ttdeci">unsigned getID() const</div><div class="ttdoc">Get the identifier of this register bank.</div><div class="ttdef"><b>Definition:</b> <a href="RegisterBank_8h_source.html#l00047">RegisterBank.h:47</a></div></div>
<div class="ttc" id="anamespacellvm_html_a19cdd6010b754ac90ebda5990b03cb40"><div class="ttname"><a href="namespacellvm.html#a19cdd6010b754ac90ebda5990b03cb40">llvm::getIConstantVRegVal</a></div><div class="ttdeci">std::optional&lt; APInt &gt; getIConstantVRegVal(Register VReg, const MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">If VReg is defined by a G_CONSTANT, return the corresponding value.</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00288">Utils.cpp:288</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64FunctionInfo_html_a6e56ab8686aecd83b84810e257d84b64"><div class="ttname"><a href="classllvm_1_1AArch64FunctionInfo.html#a6e56ab8686aecd83b84810e257d84b64">llvm::AArch64FunctionInfo::getVarArgsStackIndex</a></div><div class="ttdeci">int getVarArgsStackIndex() const</div><div class="ttdef"><b>Definition:</b> <a href="AArch64MachineFunctionInfo_8h_source.html#l00339">AArch64MachineFunctionInfo.h:339</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a5b3c2afaad5594cd0eedd58a78a91baf"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a5b3c2afaad5594cd0eedd58a78a91baf">llvm::AArch64CC::PL</a></div><div class="ttdeci">@ PL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00260">AArch64BaseInfo.h:260</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a27f29a27e5d3b0d6222ade8ab95e2be5"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a27f29a27e5d3b0d6222ade8ab95e2be5">llvm::MIPatternMatch::m_SpecificICst</a></div><div class="ttdeci">SpecificConstantMatch m_SpecificICst(int64_t RequestedValue)</div><div class="ttdoc">Matches a constant equal to RequestedValue.</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00195">MIPatternMatch.h:195</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a79aef281242f8877523e32b6a669356e"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a79aef281242f8877523e32b6a669356e">changeICMPPredToAArch64CC</a></div><div class="ttdeci">static AArch64CC::CondCode changeICMPPredToAArch64CC(CmpInst::Predicate P)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l01280">AArch64InstructionSelector.cpp:1280</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1APFloat_html_a9c5a2112c559ffbe2c7bbf5698b6482f"><div class="ttname"><a href="classllvm_1_1APFloat.html#a9c5a2112c559ffbe2c7bbf5698b6482f">llvm::APFloat::bitcastToAPInt</a></div><div class="ttdeci">APInt bitcastToAPInt() const</div><div class="ttdef"><b>Definition:</b> <a href="APFloat_8h_source.html#l01174">APFloat.h:1174</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_af01e8bd1c1aba89ed27081450bb0d9e8"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#af01e8bd1c1aba89ed27081450bb0d9e8">createQTuple</a></div><div class="ttdeci">static Register createQTuple(ArrayRef&lt; Register &gt; Regs, MachineIRBuilder &amp;MIB)</div><div class="ttdoc">Create a tuple of Q-registers using the registers in Regs.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00669">AArch64InstructionSelector.cpp:669</a></div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="aMem2Reg_8cpp_html_a6fde3eb6ca09ddf2fd76432176d817bb"><div class="ttname"><a href="Mem2Reg_8cpp.html#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a></div><div class="ttdeci">Promote Memory to Register</div><div class="ttdef"><b>Definition:</b> <a href="Mem2Reg_8cpp_source.html#l00110">Mem2Reg.cpp:110</a></div></div>
<div class="ttc" id="anamespacellvm_1_1NVPTX_1_1PTXLdStInstCode_html_a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217"><div class="ttname"><a href="namespacellvm_1_1NVPTX_1_1PTXLdStInstCode.html#a91119cbee2be000c528a690252aee07ca09c68d67f7dbfa6cc77eaf73aa535217">llvm::NVPTX::PTXLdStInstCode::Scalar</a></div><div class="ttdeci">@ Scalar</div><div class="ttdef"><b>Definition:</b> <a href="NVPTX_8h_source.html#l00123">NVPTX.h:123</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a5d1d3c98268fd4f6017b99e4bd9415ed"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a5d1d3c98268fd4f6017b99e4bd9415ed">llvm::AArch64_AM::getFP32Imm</a></div><div class="ttdeci">static int getFP32Imm(const APInt &amp;Imm)</div><div class="ttdoc">getFP32Imm - Return an 8-bit floating-point version of the 32-bit floating-point value.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00394">AArch64AddressingModes.h:394</a></div></div>
<div class="ttc" id="aclassllvm_1_1GLoadStore_html_a0a7fb170c5d3165c1a9f3cf5fee5b4ca"><div class="ttname"><a href="classllvm_1_1GLoadStore.html#a0a7fb170c5d3165c1a9f3cf5fee5b4ca">llvm::GLoadStore::getPointerReg</a></div><div class="ttdeci">Register getPointerReg() const</div><div class="ttdoc">Get the source register of the pointer value.</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00044">GenericMachineInstrs.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a40d954b9cf9ee8b545a78725f2549cba"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a40d954b9cf9ee8b545a78725f2549cba">llvm::MachineRegisterInfo::getVRegDef</a></div><div class="ttdeci">MachineInstr * getVRegDef(Register Reg) const</div><div class="ttdoc">getVRegDef - Return the machine instr that defines the specified virtual register or null if none is ...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00398">MachineRegisterInfo.cpp:398</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_acad8fe90886f92eabced0c2f9bd0e6f5"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#acad8fe90886f92eabced0c2f9bd0e6f5">llvm::MachineOperand::getParent</a></div><div class="ttdeci">MachineInstr * getParent()</div><div class="ttdoc">getParent - Return the instruction that this operand belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00243">MachineOperand.h:243</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023aabce0250d60b95b97ff41ff41ba030d6"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023aabce0250d60b95b97ff41ff41ba030d6">llvm::MCID::RegSequence</a></div><div class="ttdeci">@ RegSequence</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00182">MCInstrDesc.h:182</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1abb1fa5a6016bfee1580a7b989a454c9a"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1abb1fa5a6016bfee1580a7b989a454c9a">llvm::AArch64_AM::ROR</a></div><div class="ttdeci">@ ROR</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00038">AArch64AddressingModes.h:38</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegisterBankInfo_html_a03400563b62282df90443c4893d1f0e9"><div class="ttname"><a href="classllvm_1_1RegisterBankInfo.html#a03400563b62282df90443c4893d1f0e9">llvm::RegisterBankInfo::getSizeInBits</a></div><div class="ttdeci">unsigned getSizeInBits(Register Reg, const MachineRegisterInfo &amp;MRI, const TargetRegisterInfo &amp;TRI) const</div><div class="ttdoc">Get the size in bits of Reg.</div><div class="ttdef"><b>Definition:</b> <a href="RegisterBankInfo_8cpp_source.html#l00493">RegisterBankInfo.cpp:493</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegisterBankInfo_html_a1cfd8b1df608cb89b0acb94d29d447b3"><div class="ttname"><a href="classllvm_1_1RegisterBankInfo.html#a1cfd8b1df608cb89b0acb94d29d447b3">llvm::RegisterBankInfo::constrainGenericRegister</a></div><div class="ttdeci">static const TargetRegisterClass * constrainGenericRegister(Register Reg, const TargetRegisterClass &amp;RC, MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">Constrain the (possibly generic) virtual register Reg to RC.</div><div class="ttdef"><b>Definition:</b> <a href="RegisterBankInfo_8cpp_source.html#l00129">RegisterBankInfo.cpp:129</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a6042864e9bebb2bfd0c6bc834cddd7d0"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a6042864e9bebb2bfd0c6bc834cddd7d0">getImmedFromMO</a></div><div class="ttdeci">static std::optional&lt; uint64_t &gt; getImmedFromMO(const MachineOperand &amp;Root)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00677">AArch64InstructionSelector.cpp:677</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a1c5fadb14ff1d77faad0cb58a43252ab"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a1c5fadb14ff1d77faad0cb58a43252ab">llvm::MachineInstrBuilder::getReg</a></div><div class="ttdeci">Register getReg(unsigned Idx) const</div><div class="ttdoc">Get the register for the operand index.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00094">MachineInstrBuilder.h:94</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a956ffd0de93798f523683b447646dd92"><div class="ttname"><a href="classllvm_1_1LLT.html#a956ffd0de93798f523683b447646dd92">llvm::LLT::getSizeInBits</a></div><div class="ttdeci">constexpr TypeSize getSizeInBits() const</div><div class="ttdoc">Returns the total size of the type. Must only be called on sized types.</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00159">LowLevelTypeImpl.h:159</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html">llvm::MachineBasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00094">MachineBasicBlock.h:94</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_afb84ad0ad64ed2a34f473bbacc268501"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#afb84ad0ad64ed2a34f473bbacc268501">llvm::MachineInstrBuilder::cloneMemRefs</a></div><div class="ttdeci">const MachineInstrBuilder &amp; cloneMemRefs(const MachineInstr &amp;OtherMI) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00213">MachineInstrBuilder.h:213</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a4738a48912fcb1ca44fbe35b8c98ab50">llvm::AArch64_AM::InvalidShiftExtend</a></div><div class="ttdeci">@ InvalidShiftExtend</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00034">AArch64AddressingModes.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html">llvm::ProfileSummaryInfo</a></div><div class="ttdoc">Analysis providing profile information.</div><div class="ttdef"><b>Definition:</b> <a href="ProfileSummaryInfo_8h_source.html#l00040">ProfileSummaryInfo.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_aa363afffca4fc13a709673936b47fe33"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#aa363afffca4fc13a709673936b47fe33">llvm::MachineRegisterInfo::getRegClass</a></div><div class="ttdeci">const TargetRegisterClass * getRegClass(Register Reg) const</div><div class="ttdoc">Return the register class of the specified virtual register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00661">MachineRegisterInfo.h:661</a></div></div>
<div class="ttc" id="aADT_2tmp_8txt_html_a07ed0bfaa124c15897944fe3eaa971ab"><div class="ttname"><a href="ADT_2tmp_8txt.html#a07ed0bfaa124c15897944fe3eaa971ab">uint64_t</a></div><div class="ttdeci">Class for arbitrary precision integers APInt is a functional replacement for common case unsigned integer type like unsigned long or uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="ADT_2tmp_8txt_source.html#l00001">tmp.txt:1</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a13ed9069b0840f7eb3a47fce0878a5ad"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a13ed9069b0840f7eb3a47fce0878a5ad">llvm::AArch64_AM::SXTW</a></div><div class="ttdeci">@ SXTW</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00048">AArch64AddressingModes.h:48</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CodeModel_html_afc59396a9e5809fc92938e203d91a8df"><div class="ttname"><a href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8df">llvm::CodeModel::Model</a></div><div class="ttdeci">Model</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_8h_source.html#l00031">CodeGen.h:31</a></div></div>
<div class="ttc" id="aAArch64AddressingModes_8h_html"><div class="ttname"><a href="AArch64AddressingModes_8h.html">AArch64AddressingModes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MIMetadata_html"><div class="ttname"><a href="classllvm_1_1MIMetadata.html">llvm::MIMetadata</a></div><div class="ttdoc">Set of metadata that should be preserved when using BuildMI().</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00335">MachineInstrBuilder.h:335</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a03ac2c8c129b06df3ea6bc3bd65e871d"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a03ac2c8c129b06df3ea6bc3bd65e871d">getInsertVecEltOpInfo</a></div><div class="ttdeci">static std::pair&lt; unsigned, unsigned &gt; getInsertVecEltOpInfo(const RegisterBank &amp;RB, unsigned EltSize)</div><div class="ttdoc">Return an &lt;Opcode, SubregIndex&gt; pair to do an vector elt insert of a given size and RB.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l04445">AArch64InstructionSelector.cpp:4445</a></div></div>
<div class="ttc" id="aInstructionSelector_8h_html"><div class="ttname"><a href="InstructionSelector_8h.html">InstructionSelector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html_af9185c7e96873c6d2c13e1f1b6322cf6"><div class="ttname"><a href="classllvm_1_1DataLayout.html#af9185c7e96873c6d2c13e1f1b6322cf6">llvm::DataLayout::getPrefTypeAlign</a></div><div class="ttdeci">Align getPrefTypeAlign(Type *Ty) const</div><div class="ttdoc">Returns the preferred stack/global alignment for the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8cpp_source.html#l00857">DataLayout.cpp:857</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a325f6b611ef9ec06798d3b4eb9572093"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a325f6b611ef9ec06798d3b4eb9572093">llvm::MachineFunction::getSubtarget</a></div><div class="ttdeci">const TargetSubtargetInfo &amp; getSubtarget() const</div><div class="ttdoc">getSubtarget - Return the subtarget for which this machine code is being compiled.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00672">MachineFunction.h:672</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a03258ce69ceadb08e189389468f7fd0a"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a03258ce69ceadb08e189389468f7fd0a">llvm::MachineInstrBuilder::addFrameIndex</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addFrameIndex(int Idx) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00152">MachineInstrBuilder.h:152</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9bccbe67aaab722783ca4e7c504aaaa7"><div class="ttname"><a href="namespacellvm.html#a9bccbe67aaab722783ca4e7c504aaaa7">llvm::AtomicOrdering</a></div><div class="ttdeci">AtomicOrdering</div><div class="ttdoc">Atomic ordering for LLVM's memory model.</div><div class="ttdef"><b>Definition:</b> <a href="AtomicOrdering_8h_source.html#l00056">AtomicOrdering.h:56</a></div></div>
<div class="ttc" id="aAArch64GlobalISelUtils_8h_html"><div class="ttname"><a href="AArch64GlobalISelUtils_8h.html">AArch64GlobalISelUtils.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_afb28a4deafe2954b0534cc6399ce518b"><div class="ttname"><a href="classllvm_1_1Function.html#afb28a4deafe2954b0534cc6399ce518b">llvm::Function::hasFnAttribute</a></div><div class="ttdeci">bool hasFnAttribute(Attribute::AttrKind Kind) const</div><div class="ttdoc">Return true if the function has the attribute.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8cpp_source.html#l00640">Function.cpp:640</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_acc9e7924e2ef2b569d74df940b3dc0fb"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#acc9e7924e2ef2b569d74df940b3dc0fb">canEmitConjunction</a></div><div class="ttdeci">static bool canEmitConjunction(Register Val, bool &amp;CanNegate, bool &amp;MustBeFirst, bool WillNegate, MachineRegisterInfo &amp;MRI, unsigned Depth=0)</div><div class="ttdoc">Returns true if Val is a tree of AND/OR/CMP operations that can be expressed as a conjunction.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l04808">AArch64InstructionSelector.cpp:4808</a></div></div>
<div class="ttc" id="anamespacellvm_1_1PPC_html_a14028f7fe73a11dabc6583510cc0a355"><div class="ttname"><a href="namespacellvm_1_1PPC.html#a14028f7fe73a11dabc6583510cc0a355">llvm::PPC::Predicate</a></div><div class="ttdeci">Predicate</div><div class="ttdoc">Predicate - These are &quot;(BI &lt;&lt; 5) | BO&quot; for various predicates.</div><div class="ttdef"><b>Definition:</b> <a href="PPCPredicates_8h_source.html#l00026">PPCPredicates.h:26</a></div></div>
<div class="ttc" id="aclassllvm_1_1RegisterBankInfo_html"><div class="ttname"><a href="classllvm_1_1RegisterBankInfo.html">llvm::RegisterBankInfo</a></div><div class="ttdoc">Holds all the information related to register banks.</div><div class="ttdef"><b>Definition:</b> <a href="RegisterBankInfo_8h_source.html#l00039">RegisterBankInfo.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html"><div class="ttname"><a href="classllvm_1_1GlobalValue.html">llvm::GlobalValue</a></div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00044">GlobalValue.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionSelector_html"><div class="ttname"><a href="classllvm_1_1InstructionSelector.html">llvm::InstructionSelector</a></div><div class="ttdoc">Provides the logic to select generic machine instructions.</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSelector_8h_source.html#l00434">InstructionSelector.h:434</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69ba88a797f57846adb2c382b3732b471913">llvm::MipsISD::Ext</a></div><div class="ttdeci">@ Ext</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00159">MipsISelLowering.h:159</a></div></div>
<div class="ttc" id="aclassllvm_1_1Constant_html"><div class="ttname"><a href="classllvm_1_1Constant.html">llvm::Constant</a></div><div class="ttdoc">This is an important base class in LLVM.</div><div class="ttdef"><b>Definition:</b> <a href="Constant_8h_source.html#l00041">Constant.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_a0df93c0f752428162e14b54f8999172d"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#a0df93c0f752428162e14b54f8999172d">llvm::MachineIRBuilder::setInsertPt</a></div><div class="ttdeci">void setInsertPt(MachineBasicBlock &amp;MBB, MachineBasicBlock::iterator II)</div><div class="ttdoc">Set the insertion point before the specified position.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00317">MachineIRBuilder.h:317</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html">llvm::MachineIRBuilder</a></div><div class="ttdoc">Helper class to build MachineInstr.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00221">MachineIRBuilder.h:221</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_a55ad07e4cbe29bea4cb69b78472b690e"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a55ad07e4cbe29bea4cb69b78472b690e">llvm::TargetRegisterInfo::getRegClass</a></div><div class="ttdeci">const TargetRegisterClass * getRegClass(unsigned i) const</div><div class="ttdoc">Returns the register class associated with the enumeration value.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00778">TargetRegisterInfo.h:778</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a59b9fb63d37c3093adb39e83de07c3b7"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a59b9fb63d37c3093adb39e83de07c3b7">llvm::MIPatternMatch::m_GOr</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, TargetOpcode::G_OR, true &gt; m_GOr(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00517">MIPatternMatch.h:517</a></div></div>
<div class="ttc" id="aclassllvm_1_1CodeGenCoverage_html"><div class="ttname"><a href="classllvm_1_1CodeGenCoverage.html">llvm::CodeGenCoverage</a></div><div class="ttdef"><b>Definition:</b> <a href="CodeGenCoverage_8h_source.html#l00019">CodeGenCoverage.h:19</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a4c9594c955fec80c73ddd964b5efd554"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">llvm::MachineOperand::isReg</a></div><div class="ttdeci">bool isReg() const</div><div class="ttdoc">isReg - Tests if this is a MO_Register operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00329">MachineOperand.h:329</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_ac0af83aa690c458c5b3a8dc36ad3c3f9"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ac0af83aa690c458c5b3a8dc36ad3c3f9">llvm::MachineOperand::getCImm</a></div><div class="ttdeci">const ConstantInt * getCImm() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00561">MachineOperand.h:561</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html"><div class="ttname"><a href="classllvm_1_1MachineInstr.html">llvm::MachineInstr</a></div><div class="ttdoc">Representation of each machine instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00066">MachineInstr.h:66</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html">llvm::MachineInstrBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00069">MachineInstrBuilder.h:69</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a496c2822a80bc1f575e662e247f61d77"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a496c2822a80bc1f575e662e247f61d77">getMinSizeForRegBank</a></div><div class="ttdeci">static unsigned getMinSizeForRegBank(const RegisterBank &amp;RB)</div><div class="ttdoc">Returns the minimum size the given register bank can hold.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00614">AArch64InstructionSelector.cpp:614</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a5f494edc0a569c7fc9ff4181243be1ed"><div class="ttname"><a href="classllvm_1_1Function.html#a5f494edc0a569c7fc9ff4181243be1ed">llvm::Function::getCallingConv</a></div><div class="ttdeci">CallingConv::ID getCallingConv() const</div><div class="ttdoc">getCallingConv()/setCallingConv(CC) - These method get and set the calling convention of this functio...</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00237">Function.h:237</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a81763ced27ec9b0c42f8848f4ebe5bd1"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a81763ced27ec9b0c42f8848f4ebe5bd1">llvm::MachineRegisterInfo::setRegBank</a></div><div class="ttdeci">void setRegBank(Register Reg, const RegisterBank &amp;RegBank)</div><div class="ttdoc">Set the register bank to RegBank for Reg.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00062">MachineRegisterInfo.cpp:62</a></div></div>
<div class="ttc" id="aAArch64ISelLowering_8cpp_html_ade26f57722dfb847f2313d9674fa0cba"><div class="ttname"><a href="AArch64ISelLowering_8cpp.html#ade26f57722dfb847f2313d9674fa0cba">isCMN</a></div><div class="ttdeci">static bool isCMN(SDValue Op, ISD::CondCode CC)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8cpp_source.html#l03053">AArch64ISelLowering.cpp:3053</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a028a4adc46c746ba1501e1e6fefb54cc">llvm::AArch64II::MO_NC</a></div><div class="ttdeci">@ MO_NC</div><div class="ttdoc">MO_NC - Indicates whether the linker is expected to check the symbol reference for overflow.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00747">AArch64BaseInfo.h:747</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerUnion_html_a9147352f78d98ee246f25d3300e0aaba"><div class="ttname"><a href="classllvm_1_1PointerUnion.html#a9147352f78d98ee246f25d3300e0aaba">llvm::PointerUnion::dyn_cast</a></div><div class="ttdeci">T dyn_cast() const</div><div class="ttdoc">Returns the current pointer if it is of the specified pointer type, otherwise returns null.</div><div class="ttdef"><b>Definition:</b> <a href="PointerUnion_8h_source.html#l00162">PointerUnion.h:162</a></div></div>
<div class="ttc" id="astructllvm_1_1MachinePointerInfo_html"><div class="ttname"><a href="structllvm_1_1MachinePointerInfo.html">llvm::MachinePointerInfo</a></div><div class="ttdoc">This class contains a discriminated union of information about pointers in memory operands,...</div><div class="ttdef"><b>Definition:</b> <a href="MachineMemOperand_8h_source.html#l00039">MachineMemOperand.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00067">LLVMContext.h:67</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71a3a5053185998bdf24f3167c234915785"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a3a5053185998bdf24f3167c234915785">llvm::AArch64II::MO_PAGEOFF</a></div><div class="ttdeci">@ MO_PAGEOFF</div><div class="ttdoc">MO_PAGEOFF - A symbol operand with this flag represents the offset of that symbol within a 4K page.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00711">AArch64BaseInfo.h:711</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_ab24db762f0912a99f1e4d9e44eaeaa44"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#ab24db762f0912a99f1e4d9e44eaeaa44">llvm::MachineIRBuilder::setInstrAndDebugLoc</a></div><div class="ttdeci">void setInstrAndDebugLoc(MachineInstr &amp;MI)</div><div class="ttdoc">Set the insertion point to before MI, and set the debug loc to MI's loc.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00354">MachineIRBuilder.h:354</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineConstantPool_html"><div class="ttname"><a href="classllvm_1_1MachineConstantPool.html">llvm::MachineConstantPool</a></div><div class="ttdoc">The MachineConstantPool class keeps track of constants referenced by a function which must be spilled...</div><div class="ttdef"><b>Definition:</b> <a href="MachineConstantPool_8h_source.html#l00117">MachineConstantPool.h:117</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea"><div class="ttname"><a href="namespacellvm_1_1codeview.html#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">llvm::codeview::FrameCookieKind::Copy</a></div><div class="ttdeci">@ Copy</div></div>
<div class="ttc" id="aclassllvm_1_1AArch64FunctionInfo_html_a78ef05ed4db7991fa28264d76e8a5fc5"><div class="ttname"><a href="classllvm_1_1AArch64FunctionInfo.html#a78ef05ed4db7991fa28264d76e8a5fc5">llvm::AArch64FunctionInfo::getVarArgsGPRIndex</a></div><div class="ttdeci">int getVarArgsGPRIndex() const</div><div class="ttdef"><b>Definition:</b> <a href="AArch64MachineFunctionInfo_8h_source.html#l00345">AArch64MachineFunctionInfo.h:345</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64FunctionInfo_html"><div class="ttname"><a href="classllvm_1_1AArch64FunctionInfo.html">llvm::AArch64FunctionInfo</a></div><div class="ttdoc">AArch64FunctionInfo - This class is derived from MachineFunctionInfo and contains private AArch64-spe...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64MachineFunctionInfo_8h_source.html#l00039">AArch64MachineFunctionInfo.h:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RegState_html_aef4cc0c855dc833e2a9d58a50703320da0fec8ba6f4a4dc758b725205985eee99"><div class="ttname"><a href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da0fec8ba6f4a4dc758b725205985eee99">llvm::RegState::Implicit</a></div><div class="ttdeci">@ Implicit</div><div class="ttdoc">Not emitted register (e.g. carry, or temporary result).</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00046">MachineInstrBuilder.h:46</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_aa7dc7faaab4856b8f0014b8283e26c7b"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#aa7dc7faaab4856b8f0014b8283e26c7b">llvm::MachineBasicBlock::getFirstNonPHI</a></div><div class="ttdeci">iterator getFirstNonPHI()</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8cpp_source.html#l00198">MachineBasicBlock.cpp:198</a></div></div>
<div class="ttc" id="aMachineConstantPool_8h_html"><div class="ttname"><a href="MachineConstantPool_8h.html">MachineConstantPool.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1GLoadStore_html_a1833a6824522ac00595a007393c73f61"><div class="ttname"><a href="classllvm_1_1GLoadStore.html#a1833a6824522ac00595a007393c73f61">llvm::GLoadStore::getMemSize</a></div><div class="ttdeci">uint64_t getMemSize() const</div><div class="ttdoc">Returns the size in bytes of the memory access.</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00061">GenericMachineInstrs.h:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a878403638ab65500c736343a57678bdb"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a878403638ab65500c736343a57678bdb">llvm::MachineOperand::getFPImm</a></div><div class="ttdeci">const ConstantFP * getFPImm() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00566">MachineOperand.h:566</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_af0d32d967ac31c4e6149c2adb89aa947"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#af0d32d967ac31c4e6149c2adb89aa947">llvm::MachineOperand::getPredicate</a></div><div class="ttdeci">unsigned getPredicate() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00617">MachineOperand.h:617</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a3699f85cc3382ffc17d597837412b27d"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a3699f85cc3382ffc17d597837412b27d">llvm::MachineRegisterInfo::getRegClassOrNull</a></div><div class="ttdeci">const TargetRegisterClass * getRegClassOrNull(Register Reg) const</div><div class="ttdoc">Return the register class of Reg, or null if Reg has not been assigned a register class yet.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00678">MachineRegisterInfo.h:678</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a369074e730a24fabb4216cd37e789e35"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a369074e730a24fabb4216cd37e789e35">llvm::ISD::MEMBARRIER</a></div><div class="ttdeci">@ MEMBARRIER</div><div class="ttdoc">MEMBARRIER - Compiler barrier only; generate a no-op.</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l01152">ISDOpcodes.h:1152</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a71181d67d0bf68c3b8a535ec20463f90"><div class="ttname"><a href="classllvm_1_1LLT.html#a71181d67d0bf68c3b8a535ec20463f90">llvm::LLT::getNumElements</a></div><div class="ttdeci">constexpr uint16_t getNumElements() const</div><div class="ttdoc">Returns the number of elements in a vector LLT.</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00133">LowLevelTypeImpl.h:133</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_aa460158a4019a4043faf6ea76344cbd5"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#aa460158a4019a4043faf6ea76344cbd5">llvm::MachineFunction::getConstantPool</a></div><div class="ttdeci">MachineConstantPool * getConstantPool()</div><div class="ttdoc">getConstantPool - Return the constant pool object for the current function.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00704">MachineFunction.h:704</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantFP_html_a684130a8a53c04cbd92881243d6a5ae1"><div class="ttname"><a href="classllvm_1_1ConstantFP.html#a684130a8a53c04cbd92881243d6a5ae1">llvm::ConstantFP::isNegative</a></div><div class="ttdeci">bool isNegative() const</div><div class="ttdoc">Return true if the sign bit is set.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00304">Constants.h:304</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a1b622ba13b7a0005c33fd0d392df4e0a"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a1b622ba13b7a0005c33fd0d392df4e0a">getVectorShiftImm</a></div><div class="ttdeci">static std::optional&lt; int64_t &gt; getVectorShiftImm(Register Reg, MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">Returns the element immediate value of a vector shift operand if found.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l01785">AArch64InstructionSelector.cpp:1785</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_a448a4aa9f90dbde0f77fae45b1625d88"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#a448a4aa9f90dbde0f77fae45b1625d88">llvm::MachineIRBuilder::getMBB</a></div><div class="ttdeci">const MachineBasicBlock &amp; getMBB() const</div><div class="ttdoc">Getter for the basic block we currently build.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00298">MachineIRBuilder.h:298</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a2df7b57ad693f7a4fdec514222c5e24e"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a2df7b57ad693f7a4fdec514222c5e24e">getRegClassesForCopy</a></div><div class="ttdeci">static std::pair&lt; const TargetRegisterClass *, const TargetRegisterClass * &gt; getRegClassesForCopy(MachineInstr &amp;I, const TargetInstrInfo &amp;TII, MachineRegisterInfo &amp;MRI, const TargetRegisterInfo &amp;TRI, const RegisterBankInfo &amp;RBI)</div><div class="ttdoc">Helper function to get the source and destination register classes for a copy.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00885">AArch64InstructionSelector.cpp:885</a></div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00853">BitVector.h:853</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a18fcadd076ad53e6df94e0ca7a80a9ef"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a18fcadd076ad53e6df94e0ca7a80a9ef">llvm::MachineFunction::getFrameInfo</a></div><div class="ttdeci">MachineFrameInfo &amp; getFrameInfo()</div><div class="ttdoc">getFrameInfo - Return the frame info object for the current function.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00688">MachineFunction.h:688</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_a4e21760f681d6f97f95c8414e7b83ea5"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">llvm::MachineBasicBlock::getParent</a></div><div class="ttdeci">const MachineFunction * getParent() const</div><div class="ttdoc">Return the MachineFunction containing this basic block.</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00265">MachineBasicBlock.h:265</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineMemOperand_html_aaa45abfa63d76025a0e5b9a46e25dd8d"><div class="ttname"><a href="classllvm_1_1MachineMemOperand.html#aaa45abfa63d76025a0e5b9a46e25dd8d">llvm::MachineMemOperand::getSuccessOrdering</a></div><div class="ttdeci">AtomicOrdering getSuccessOrdering() const</div><div class="ttdoc">Return the atomic ordering requirements for this memory operation.</div><div class="ttdef"><b>Definition:</b> <a href="MachineMemOperand_8h_source.html#l00270">MachineMemOperand.h:270</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a47760ffd22a82283df0f5da521feca2a"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a47760ffd22a82283df0f5da521feca2a">llvm::MachineInstrBuilder::addMemOperand</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addMemOperand(MachineMemOperand *MMO) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00202">MachineInstrBuilder.h:202</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a239427c2c3a01e23bd15b29633696536"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a239427c2c3a01e23bd15b29633696536">llvm::GlobalValue::isThreadLocal</a></div><div class="ttdeci">bool isThreadLocal() const</div><div class="ttdoc">If the value is &quot;Thread Local&quot;, its value isn't shared by the threads.</div><div class="ttdef"><b>Definition:</b> <a href="GlobalValue_8h_source.html#l00259">GlobalValue.h:259</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8cpp_html_aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053"><div class="ttname"><a href="TargetLibraryInfo_8cpp.html#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a></div><div class="ttdeci">@ Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8cpp_source.html#l00062">TargetLibraryInfo.cpp:62</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_ac3c3cf58d6d631af6a172457304d3d07"><div class="ttname"><a href="namespacellvm_1_1ISD.html#ac3c3cf58d6d631af6a172457304d3d07">llvm::ISD::CondCode</a></div><div class="ttdeci">CondCode</div><div class="ttdoc">ISD::CondCode enum - These are ordered carefully to make the bitfields below work out,...</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l01434">ISDOpcodes.h:1434</a></div></div>
<div class="ttc" id="aclassllvm_1_1SelectInst_html"><div class="ttname"><a href="classllvm_1_1SelectInst.html">llvm::SelectInst</a></div><div class="ttdoc">This class represents the LLVM 'select' instruction.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01746">Instructions.h:1746</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64FunctionInfo_html_aae1cc37c03dc88bd71db86b6180b9d71"><div class="ttname"><a href="classllvm_1_1AArch64FunctionInfo.html#aae1cc37c03dc88bd71db86b6180b9d71">llvm::AArch64FunctionInfo::getVarArgsGPRSize</a></div><div class="ttdeci">unsigned getVarArgsGPRSize() const</div><div class="ttdef"><b>Definition:</b> <a href="AArch64MachineFunctionInfo_8h_source.html#l00348">AArch64MachineFunctionInfo.h:348</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64Subtarget_html_a8d38ac8f86a38869b906ed0e2947b9d2"><div class="ttname"><a href="classllvm_1_1AArch64Subtarget.html#a8d38ac8f86a38869b906ed0e2947b9d2">llvm::AArch64Subtarget::isCallingConvWin64</a></div><div class="ttdeci">bool isCallingConvWin64(CallingConv::ID CC) const</div><div class="ttdef"><b>Definition:</b> <a href="AArch64Subtarget_8h_source.html#l00325">AArch64Subtarget.h:325</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineMemOperand_html_a3e9d2a9063bce7f5b3d7dd21fd05c79d"><div class="ttname"><a href="classllvm_1_1MachineMemOperand.html#a3e9d2a9063bce7f5b3d7dd21fd05c79d">llvm::MachineMemOperand::getMemoryType</a></div><div class="ttdeci">LLT getMemoryType() const</div><div class="ttdoc">Return the memory type of the memory reference.</div><div class="ttdef"><b>Definition:</b> <a href="MachineMemOperand_8h_source.html#l00232">MachineMemOperand.h:232</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a9694f2906cfe1d6d35bbe6742c67dff0"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a9694f2906cfe1d6d35bbe6742c67dff0">llvm::MachineRegisterInfo::createGenericVirtualRegister</a></div><div class="ttdeci">Register createGenericVirtualRegister(LLT Ty, StringRef Name=&quot;&quot;)</div><div class="ttdoc">Create and return a new generic virtual register with low-level type Ty.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00185">MachineRegisterInfo.cpp:185</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_ad08ed580345a51c50d9477dec1e65818"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">llvm::MachineInstrBuilder::addReg</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addReg(Register RegNo, unsigned flags=0, unsigned SubReg=0) const</div><div class="ttdoc">Add a new virtual register operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00097">MachineInstrBuilder.h:97</a></div></div>
<div class="ttc" id="aARMInstructionSelector_8cpp_html_a0d70a38e8f0622515630e7e8672df270"><div class="ttname"><a href="ARMInstructionSelector_8cpp.html#a0d70a38e8f0622515630e7e8672df270">selectMergeValues</a></div><div class="ttdeci">static bool selectMergeValues(MachineInstrBuilder &amp;MIB, const ARMBaseInstrInfo &amp;TII, MachineRegisterInfo &amp;MRI, const TargetRegisterInfo &amp;TRI, const RegisterBankInfo &amp;RBI)</div><div class="ttdef"><b>Definition:</b> <a href="ARMInstructionSelector_8cpp_source.html#l00231">ARMInstructionSelector.cpp:231</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_aec748fa81e1488192450f0b2a8d1aeca"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#aec748fa81e1488192450f0b2a8d1aeca">llvm::MachineInstrBuilder::addUse</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addUse(Register RegNo, unsigned Flags=0, unsigned SubReg=0) const</div><div class="ttdoc">Add a virtual register use operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00123">MachineInstrBuilder.h:123</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_ac0035d7c1c860501c877c20e6e93297b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">llvm::MachineOperand::getReg</a></div><div class="ttdeci">Register getReg() const</div><div class="ttdoc">getReg - Returns the register number.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00369">MachineOperand.h:369</a></div></div>
<div class="ttc" id="aARCInstrInfo_8cpp_html_aab5329eaa9a958adfa2c8de4d24e16cc"><div class="ttname"><a href="ARCInstrInfo_8cpp.html#aab5329eaa9a958adfa2c8de4d24e16cc">isStore</a></div><div class="ttdeci">static bool isStore(int Opcode)</div><div class="ttdef"><b>Definition:</b> <a href="ARCInstrInfo_8cpp_source.html#l00058">ARCInstrInfo.cpp:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a68db11947d61455d62d75b86020362c9"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a68db11947d61455d62d75b86020362c9">llvm::MachineRegisterInfo::getRegClassOrRegBank</a></div><div class="ttdeci">const RegClassOrRegBank &amp; getRegClassOrRegBank(Register Reg) const</div><div class="ttdoc">Return the register bank or register class of Reg.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00695">MachineRegisterInfo.h:695</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html"><div class="ttname"><a href="classllvm_1_1MachineFunction.html">llvm::MachineFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00258">MachineFunction.h:258</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_a8bc92b8a902afb7675480ecc729a66d4"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#a8bc92b8a902afb7675480ecc729a66d4">llvm::MachineIRBuilder::buildInstr</a></div><div class="ttdeci">MachineInstrBuilder buildInstr(unsigned Opcode)</div><div class="ttdoc">Build and insert &lt;empty&gt; = Opcode &lt;empty&gt;.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00385">MachineIRBuilder.h:385</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a9ad70dffa73dcf15ca0495024b92a4c3"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a9ad70dffa73dcf15ca0495024b92a4c3">llvm::MachineInstrBuilder::addRegMask</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addRegMask(const uint32_t *Mask) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00197">MachineInstrBuilder.h:197</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a832ad315a355f4ddcc32f189f34e28a9"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a832ad315a355f4ddcc32f189f34e28a9">llvm::AArch64_AM::encodeLogicalImmediate</a></div><div class="ttdeci">static uint64_t encodeLogicalImmediate(uint64_t imm, unsigned regSize)</div><div class="ttdoc">encodeLogicalImmediate - Return the encoded immediate value for a logical immediate instruction of th...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00283">AArch64AddressingModes.h:283</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_ac3419b7821dce4fc2e3a6f4a96b7dbaa"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#ac3419b7821dce4fc2e3a6f4a96b7dbaa">unsupportedBinOp</a></div><div class="ttdeci">static bool unsupportedBinOp(const MachineInstr &amp;I, const AArch64RegisterBankInfo &amp;RBI, const MachineRegisterInfo &amp;MRI, const AArch64RegisterInfo &amp;TRI)</div><div class="ttdoc">Check whether I is a currently unsupported binary operation:</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00704">AArch64InstructionSelector.cpp:704</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a2f9f5539ad5eab7c3de9fb21766bc78b"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a2f9f5539ad5eab7c3de9fb21766bc78b">llvm::AArch64CC::GE</a></div><div class="ttdeci">@ GE</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00265">AArch64BaseInfo.h:265</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a9d825f5954d7bd527aea490668c624c6"><div class="ttname"><a href="classllvm_1_1LLT.html#a9d825f5954d7bd527aea490668c624c6">llvm::LLT::isPointer</a></div><div class="ttdeci">constexpr bool isPointer() const</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00125">LowLevelTypeImpl.h:125</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html"><div class="ttname"><a href="classllvm_1_1ArrayRef.html">llvm::ArrayRef</a></div><div class="ttdoc">ArrayRef - Represent a constant reference to an array (0 or more elements consecutively in memory),...</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00033">APInt.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_aa3b818e0d89b7804a311b48c18080a4f"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#aa3b818e0d89b7804a311b48c18080a4f">llvm::AArch64_AM::getFP64Imm</a></div><div class="ttdeci">static int getFP64Imm(const APInt &amp;Imm)</div><div class="ttdoc">getFP64Imm - Return an 8-bit floating-point version of the 64-bit floating-point value.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00422">AArch64AddressingModes.h:422</a></div></div>
<div class="ttc" id="aclassllvm_1_1SrcOp_html_ae229785d0c8a8ce25d34be18fe150a54"><div class="ttname"><a href="classllvm_1_1SrcOp.html#ae229785d0c8a8ce25d34be18fe150a54">llvm::SrcOp::getReg</a></div><div class="ttdeci">Register getReg() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00180">MachineIRBuilder.h:180</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a4f404daab6050b7a8e95bb247d4aefb2"><div class="ttname"><a href="classllvm_1_1LLT.html#a4f404daab6050b7a8e95bb247d4aefb2">llvm::LLT::changeElementType</a></div><div class="ttdeci">constexpr LLT changeElementType(LLT NewEltTy) const</div><div class="ttdoc">If this type is a vector, return a vector with the same number of elements but the new element type.</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00180">LowLevelTypeImpl.h:180</a></div></div>
<div class="ttc" id="aDwarf_8h_html"><div class="ttname"><a href="Dwarf_8h.html">Dwarf.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a0363204b5fbab08a46f5a7cd7f376f78"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">llvm::MachineInstr::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns the opcode of this MachineInstr.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00516">MachineInstr.h:516</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a01bf72631b0bc836a8c07fe840b13233"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a01bf72631b0bc836a8c07fe840b13233">llvm::MachineRegisterInfo::hasOneNonDBGUse</a></div><div class="ttdeci">bool hasOneNonDBGUse(Register RegNo) const</div><div class="ttdoc">hasOneNonDBGUse - Return true if there is exactly one non-Debug use of the specified register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00417">MachineRegisterInfo.cpp:417</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_ac2090a63769fa3e7ba2e0eadbe57309e"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#ac2090a63769fa3e7ba2e0eadbe57309e">llvm::MachineInstrBuilder::addJumpTableIndex</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addJumpTableIndex(unsigned Idx, unsigned TargetFlags=0) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00171">MachineInstrBuilder.h:171</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00255">Value.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineIRBuilder_html_ae32b6e2213ad3119a124e6e0673a5898"><div class="ttname"><a href="classllvm_1_1MachineIRBuilder.html#ae32b6e2213ad3119a124e6e0673a5898">llvm::MachineIRBuilder::buildCopy</a></div><div class="ttdeci">MachineInstrBuilder buildCopy(const DstOp &amp;Res, const SrcOp &amp;Op)</div><div class="ttdoc">Build and insert Res = COPY Op.</div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8cpp_source.html#l00297">MachineIRBuilder.cpp:297</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64ISD_html_a35ad1b8db0dfad0b69c9185c5fe24e19a8ee06ddad96ab8a83a8513e4b5b49717"><div class="ttname"><a href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19a8ee06ddad96ab8a83a8513e4b5b49717">llvm::AArch64ISD::ADR</a></div><div class="ttdeci">@ ADR</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00076">AArch64ISelLowering.h:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a6a9178212966aea2cd69dfb4c66411db"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a6a9178212966aea2cd69dfb4c66411db">llvm::MIPatternMatch::m_any_of</a></div><div class="ttdeci">Or&lt; Preds... &gt; m_any_of(Preds &amp;&amp;... preds)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00314">MIPatternMatch.h:314</a></div></div>
<div class="ttc" id="aRISCVRedundantCopyElimination_8cpp_html_a77c69067ae8279bc00ab8757731e90d7"><div class="ttname"><a href="RISCVRedundantCopyElimination_8cpp.html#a77c69067ae8279bc00ab8757731e90d7">CC</a></div><div class="ttdeci">auto CC</div><div class="ttdef"><b>Definition:</b> <a href="RISCVRedundantCopyElimination_8cpp_source.html#l00079">RISCVRedundantCopyElimination.cpp:79</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64RegisterInfo_html"><div class="ttname"><a href="classllvm_1_1AArch64RegisterInfo.html">llvm::AArch64RegisterInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64RegisterInfo_8h_source.html#l00026">AArch64RegisterInfo.h:26</a></div></div>
<div class="ttc" id="aclassllvm_1_1GenericMachineInstr_html_a2cdf10ff4f5fb865c6a669331aeb5846"><div class="ttname"><a href="classllvm_1_1GenericMachineInstr.html#a2cdf10ff4f5fb865c6a669331aeb5846">llvm::GenericMachineInstr::getReg</a></div><div class="ttdeci">Register getReg(unsigned Idx) const</div><div class="ttdoc">Access the Idx'th operand as a register and return it.</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00032">GenericMachineInstrs.h:32</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a834e9ac846bd81eaf3d3492ef7ea24da"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a834e9ac846bd81eaf3d3492ef7ea24da">llvm::MachineInstrBuilder::addBlockAddress</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addBlockAddress(const BlockAddress *BA, int64_t Offset=0, unsigned TargetFlags=0) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00190">MachineInstrBuilder.h:190</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa8f4be0661aa64f5b1f20b15e93bb403"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa8f4be0661aa64f5b1f20b15e93bb403">llvm::ConstantInt::getSExtValue</a></div><div class="ttdeci">int64_t getSExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit integer value after it has been sign extended as appropriate for the ...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00147">Constants.h:147</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPUISD_html_a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996"><div class="ttname"><a href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eafbca76f7875e080d97cee761de04d996">llvm::AMDGPUISD::BFI</a></div><div class="ttdeci">@ BFI</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUISelLowering_8h_source.html#l00441">AMDGPUISelLowering.h:441</a></div></div>
<div class="ttc" id="aInstructionSelectorImpl_8h_html"><div class="ttname"><a href="InstructionSelectorImpl_8h.html">InstructionSelectorImpl.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a002fd916e7206e01d512eeb06d405cf0"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">llvm::MachineInstr::getParent</a></div><div class="ttdeci">const MachineBasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00313">MachineInstr.h:313</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CodeModel_html_afc59396a9e5809fc92938e203d91a8dfa686bcdfaefdfe3f49acbfe6f680bc22d"><div class="ttname"><a href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfa686bcdfaefdfe3f49acbfe6f680bc22d">llvm::CodeModel::Tiny</a></div><div class="ttdeci">@ Tiny</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_8h_source.html#l00031">CodeGen.h:31</a></div></div>
<div class="ttc" id="aAArch64AdvSIMDScalarPass_8cpp_html_aacd2ab195054a3e6a74bfbb9d5d571c8"><div class="ttname"><a href="AArch64AdvSIMDScalarPass_8cpp.html#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a></div><div class="ttdeci">unsigned const MachineRegisterInfo * MRI</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AdvSIMDScalarPass_8cpp_source.html#l00105">AArch64AdvSIMDScalarPass.cpp:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1PointerUnion_html"><div class="ttname"><a href="classllvm_1_1PointerUnion.html">llvm::PointerUnion</a></div><div class="ttdoc">A discriminated union of two or more pointer types, with the discriminator in the low bit of the poin...</div><div class="ttdef"><b>Definition:</b> <a href="PointerUnion_8h_source.html#l00112">PointerUnion.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1Register_html"><div class="ttname"><a href="classllvm_1_1Register.html">llvm::Register</a></div><div class="ttdoc">Wrapper class representing virtual and physical registers.</div><div class="ttdef"><b>Definition:</b> <a href="Register_8h_source.html#l00019">Register.h:19</a></div></div>
<div class="ttc" id="aclassllvm_1_1InstructionSelector_html_ac7718e347de9828440edd7ceeab7b76a"><div class="ttname"><a href="classllvm_1_1InstructionSelector.html#ac7718e347de9828440edd7ceeab7b76a">llvm::InstructionSelector::ComplexRendererFns</a></div><div class="ttdeci">std::optional&lt; SmallVector&lt; std::function&lt; void(MachineInstrBuilder &amp;)&gt;, 4 &gt; &gt; ComplexRendererFns</div><div class="ttdef"><b>Definition:</b> <a href="InstructionSelector_8h_source.html#l00477">InstructionSelector.h:477</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a35905b769bf1afa2cc7e2a223191e57e"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a35905b769bf1afa2cc7e2a223191e57e">llvm::AArch64_AM::getArithExtendImm</a></div><div class="ttdeci">static unsigned getArithExtendImm(AArch64_AM::ShiftExtendType ET, unsigned Imm)</div><div class="ttdoc">getArithExtendImm - Encode the extend type and shift amount for an arithmetic instruction: imm: 3-bit...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00171">AArch64AddressingModes.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_ac09a21c371a9c535cbc13e8f82503aec"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#ac09a21c371a9c535cbc13e8f82503aec">llvm::ConstantInt::getZExtValue</a></div><div class="ttdeci">uint64_t getZExtValue() const</div><div class="ttdoc">Return the constant as a 64-bit unsigned integer value after it has been zero extended as appropriate...</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00141">Constants.h:141</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_a5958512eae2979bd2eb383977996a600"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a></div><div class="ttdeci">MachineBasicBlock &amp; MBB</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00074">AArch64SLSHardening.cpp:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1GSelect_html_aeda560c01a804707f60e96f3d9a9404a"><div class="ttname"><a href="classllvm_1_1GSelect.html#aeda560c01a804707f60e96f3d9a9404a">llvm::GSelect::getTrueReg</a></div><div class="ttdeci">Register getTrueReg() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00222">GenericMachineInstrs.h:222</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a2f11475361161d9ce95a2f7be74de342"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a2f11475361161d9ce95a2f7be74de342">llvm::AArch64_AM::ASR</a></div><div class="ttdeci">@ ASR</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00037">AArch64AddressingModes.h:37</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1">llvm::AArch64_AM::ShiftExtendType</a></div><div class="ttdeci">ShiftExtendType</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00033">AArch64AddressingModes.h:33</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a9f54e5976c204d779cee3d87cabf0b02"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a9f54e5976c204d779cee3d87cabf0b02">llvm::AArch64CC::VS</a></div><div class="ttdeci">@ VS</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00261">AArch64BaseInfo.h:261</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a4b21394c138cc5ae719510bb529ee099"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">llvm::MachineFunction::getFunction</a></div><div class="ttdeci">Function &amp; getFunction()</div><div class="ttdoc">Return the LLVM function that this machine code represents.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00638">MachineFunction.h:638</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a316dd9aa25d9ec9d6d21b56e4296e824"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a316dd9aa25d9ec9d6d21b56e4296e824">llvm::MIPatternMatch::m_ICst</a></div><div class="ttdeci">ConstantMatch&lt; APInt &gt; m_ICst(APInt &amp;Cst)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00093">MIPatternMatch.h:93</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPUISD_html_a739d53294bc38cd6b0b23332f9994c0eaa257ce6c70a5ceadfc079dfcd101db51"><div class="ttname"><a href="namespacellvm_1_1AMDGPUISD.html#a739d53294bc38cd6b0b23332f9994c0eaa257ce6c70a5ceadfc079dfcd101db51">llvm::AMDGPUISD::BFM</a></div><div class="ttdeci">@ BFM</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUISelLowering_8h_source.html#l00442">AMDGPUISelLowering.h:442</a></div></div>
<div class="ttc" id="anamespacellvm_1_1logicalview_html_a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04"><div class="ttname"><a href="namespacellvm_1_1logicalview.html#a67a0a9e98b6eba7815f33e0e25ab4a3da6e539d2ea7d82ed0e31c450e64ff8c04">llvm::logicalview::LVElementKind::Optimized</a></div><div class="ttdeci">@ Optimized</div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_a251557179fe64bb09bd7e327c60c6b24"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a251557179fe64bb09bd7e327c60c6b24">llvm::TargetRegisterInfo::getRegSizeInBits</a></div><div class="ttdeci">unsigned getRegSizeInBits(const TargetRegisterClass &amp;RC) const</div><div class="ttdoc">Return the size in bits of a register from class RC.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00279">TargetRegisterInfo.h:279</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a084265f50ae31dd0e36c2d0206c474f6"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a084265f50ae31dd0e36c2d0206c474f6">llvm::MIPatternMatch::m_GAdd</a></div><div class="ttdeci">BinaryOp_match&lt; LHS, RHS, TargetOpcode::G_ADD, true &gt; m_GAdd(const LHS &amp;L, const RHS &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00451">MIPatternMatch.h:451</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_ae68d159179d37dc7969439d842e2644f"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ae68d159179d37dc7969439d842e2644f">llvm::MachineFunction::getTarget</a></div><div class="ttdeci">const LLVMTargetMachine &amp; getTarget() const</div><div class="ttdoc">getTarget - Return the target machine this machine code is compiled with</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00668">MachineFunction.h:668</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_ae37687fd3e4b8a746f795bfcd64a70e7"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#ae37687fd3e4b8a746f795bfcd64a70e7">llvm::AArch64_AM::encodeAdvSIMDModImmType4</a></div><div class="ttdeci">static uint8_t encodeAdvSIMDModImmType4(uint64_t Imm)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00502">AArch64AddressingModes.h:502</a></div></div>
<div class="ttc" id="alib_2Target_2PowerPC_2README_8txt_html_aa91241c8c54738377749dc47ee489e0d"><div class="ttname"><a href="lib_2Target_2PowerPC_2README_8txt.html#aa91241c8c54738377749dc47ee489e0d">get</a></div><div class="ttdeci">Should compile to something r4 addze r3 instead we get</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2PowerPC_2README_8txt_source.html#l00024">README.txt:24</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00357">SIDefines.h:357</a></div></div>
<div class="ttc" id="aAArch64ISelDAGToDAG_8cpp_html_a8e2f5645552aa4df45a3046ed8a660ae"><div class="ttname"><a href="AArch64ISelDAGToDAG_8cpp.html#a8e2f5645552aa4df45a3046ed8a660ae">isPreferredADD</a></div><div class="ttdeci">static bool isPreferredADD(int64_t ImmOff)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelDAGToDAG_8cpp_source.html#l01359">AArch64ISelDAGToDAG.cpp:1359</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ISD_html_a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df"><div class="ttname"><a href="namespacellvm_1_1ISD.html#a22ea9cec080dd5f4f47ba234c2f59110a5be7fb35e0f523af6c939fba303403df">llvm::ISD::BR</a></div><div class="ttdeci">@ BR</div><div class="ttdoc">Control flow instructions. These all have token chains.</div><div class="ttdef"><b>Definition:</b> <a href="ISDOpcodes_8h_source.html#l00981">ISDOpcodes.h:981</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86_html_a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e"><div class="ttname"><a href="namespacellvm_1_1X86.html#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">llvm::X86::FirstMacroFusionInstKind::Cmp</a></div><div class="ttdeci">@ Cmp</div></div>
<div class="ttc" id="aMachineFrameInfo_8h_html"><div class="ttname"><a href="MachineFrameInfo_8h.html">MachineFrameInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64GISelUtils_html_afbd23de302bae474849243a215cb910c"><div class="ttname"><a href="namespacellvm_1_1AArch64GISelUtils.html#afbd23de302bae474849243a215cb910c">llvm::AArch64GISelUtils::getAArch64VectorSplatScalar</a></div><div class="ttdeci">std::optional&lt; int64_t &gt; getAArch64VectorSplatScalar(const MachineInstr &amp;MI, const MachineRegisterInfo &amp;MRI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64GlobalISelUtils_8cpp_source.html#l00035">AArch64GlobalISelUtils.cpp:35</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28afdd8238d6005774fe2bb9067de76eb8c">llvm::AArch64CC::LS</a></div><div class="ttdeci">@ LS</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00264">AArch64BaseInfo.h:264</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64ISD_html_a35ad1b8db0dfad0b69c9185c5fe24e19a4a963d58bfd84cd339df4a7c57f8764e"><div class="ttname"><a href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19a4a963d58bfd84cd339df4a7c57f8764e">llvm::AArch64ISD::CSINC</a></div><div class="ttdeci">@ CSINC</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00085">AArch64ISelLowering.h:85</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a0436abbe31ee5c71b5f06ce5d2ea1a4a"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a0436abbe31ee5c71b5f06ce5d2ea1a4a">llvm::MachineRegisterInfo::getRegBankOrNull</a></div><div class="ttdeci">const RegisterBank * getRegBankOrNull(Register Reg) const</div><div class="ttdoc">Return the register bank of Reg, or null if Reg has not been assigned a register bank or has been ass...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00687">MachineRegisterInfo.h:687</a></div></div>
<div class="ttc" id="aclassllvm_1_1GLoadStore_html"><div class="ttname"><a href="classllvm_1_1GLoadStore.html">llvm::GLoadStore</a></div><div class="ttdoc">Represents any type of generic load or store.</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00041">GenericMachineInstrs.h:41</a></div></div>
<div class="ttc" id="aAArch64MCTargetDesc_8h_html"><div class="ttname"><a href="AArch64MCTargetDesc_8h.html">AArch64MCTargetDesc.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_ac33fa4c8cfeb9287f51f95404a459de8"><div class="ttname"><a href="classllvm_1_1LLT.html#ac33fa4c8cfeb9287f51f95404a459de8">llvm::LLT::getAddressSpace</a></div><div class="ttdeci">constexpr unsigned getAddressSpace() const</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00247">LowLevelTypeImpl.h:247</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_afc2ebeb83373be407903e43096e4f7b9"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#afc2ebeb83373be407903e43096e4f7b9">llvm::AArch64CC::getInvertedCondCode</a></div><div class="ttdeci">static CondCode getInvertedCondCode(CondCode Code)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00303">AArch64BaseInfo.h:303</a></div></div>
<div class="ttc" id="aREADME__P9_8txt_html_a0afe4617fad145d6ced5a18fd739cf06"><div class="ttname"><a href="README__P9_8txt.html#a0afe4617fad145d6ced5a18fd739cf06">Unordered</a></div><div class="ttdeci">QP Compare Ordered Unordered</div><div class="ttdef"><b>Definition:</b> <a href="README__P9_8txt_source.html#l00299">README_P9.txt:299</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28a91a0c1b4eac415607c4ceb0a899c4629"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28a91a0c1b4eac415607c4ceb0a899c4629">llvm::AArch64CC::GT</a></div><div class="ttdeci">@ GT</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00267">AArch64BaseInfo.h:267</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a2620d8167a503c9942cc4afded7f830d"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a2620d8167a503c9942cc4afded7f830d">llvm::AArch64_AM::UXTW</a></div><div class="ttdeci">@ UXTW</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00043">AArch64AddressingModes.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a76f61c6784df6dc8402a8b9011041926"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a76f61c6784df6dc8402a8b9011041926">llvm::MachineOperand::isImm</a></div><div class="ttdeci">bool isImm() const</div><div class="ttdoc">isImm - Tests if this is a MO_Immediate operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00331">MachineOperand.h:331</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64ISD_html_a35ad1b8db0dfad0b69c9185c5fe24e19aa2e9d9d7c30818fd5ba551f8d3f0af34"><div class="ttname"><a href="namespacellvm_1_1AArch64ISD.html#a35ad1b8db0dfad0b69c9185c5fe24e19aa2e9d9d7c30818fd5ba551f8d3f0af34">llvm::AArch64ISD::ADRP</a></div><div class="ttdeci">@ ADRP</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00075">AArch64ISelLowering.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6467ebe1e09a75203dd5f14bdfe21d11"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">llvm::AMDGPU::Hwreg::Width</a></div><div class="ttdeci">Width</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00449">SIDefines.h:449</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVMatInt_html_a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c"><div class="ttname"><a href="namespacellvm_1_1RISCVMatInt.html#a3c9bceaea514f7c01e87dcb184d3c972a3b5b9d77cc1b7c08af3a3cdba0c6736c">llvm::RISCVMatInt::Imm</a></div><div class="ttdeci">@ Imm</div><div class="ttdef"><b>Definition:</b> <a href="RISCVMatInt_8h_source.html#l00023">RISCVMatInt.h:23</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a3fba722f44bac58d79e82bd232525152"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a3fba722f44bac58d79e82bd232525152">llvm::MachineInstrBuilder::addGlobalAddress</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addGlobalAddress(const GlobalValue *GV, int64_t Offset=0, unsigned TargetFlags=0) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00177">MachineInstrBuilder.h:177</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CodeModel_html_afc59396a9e5809fc92938e203d91a8dfa5208f558fccf9f63423fb5385bb3e75c"><div class="ttname"><a href="namespacellvm_1_1CodeModel.html#afc59396a9e5809fc92938e203d91a8dfa5208f558fccf9f63423fb5385bb3e75c">llvm::CodeModel::Large</a></div><div class="ttdeci">@ Large</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_8h_source.html#l00031">CodeGen.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFrameInfo_html"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html">llvm::MachineFrameInfo</a></div><div class="ttdoc">The MachineFrameInfo class represents an abstract stack frame until prolog/epilog code is inserted.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00106">MachineFrameInfo.h:106</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a18c672925e05a23b72838be961003fc7"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a18c672925e05a23b72838be961003fc7">selectFPConvOpc</a></div><div class="ttdeci">static unsigned selectFPConvOpc(unsigned GenericOpc, LLT DstTy, LLT SrcTy)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l01033">AArch64InstructionSelector.cpp:1033</a></div></div>
<div class="ttc" id="aAArch64Subtarget_8h_html"><div class="ttname"><a href="AArch64Subtarget_8h.html">AArch64Subtarget.h</a></div></div>
<div class="ttc" id="aAMDGPURegisterBankInfo_8cpp_html_af74ba83dde21c4eb9ced98ce5c77879f"><div class="ttname"><a href="AMDGPURegisterBankInfo_8cpp.html#af74ba83dde21c4eb9ced98ce5c77879f">getSrcRegIgnoringCopies</a></div><div class="ttdeci">static Register getSrcRegIgnoringCopies(const MachineRegisterInfo &amp;MRI, Register Reg)</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPURegisterBankInfo_8cpp_source.html#l01236">AMDGPURegisterBankInfo.cpp:1236</a></div></div>
<div class="ttc" id="anamespacellvm_html_a17e04afcf0c5efeb0eb6a9a45287b5e4"><div class="ttname"><a href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">llvm::BuildMI</a></div><div class="ttdeci">MachineInstrBuilder BuildMI(MachineFunction &amp;MF, const MIMetadata &amp;MIMD, const MCInstrDesc &amp;MCID)</div><div class="ttdoc">Builder interface. Specify how to create the initial instruction itself.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00357">MachineInstrBuilder.h:357</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a7dbb6b23df55633d29189da7a36cc350"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a7dbb6b23df55633d29189da7a36cc350">getMinClassForRegBank</a></div><div class="ttdeci">static const TargetRegisterClass * getMinClassForRegBank(const RegisterBank &amp;RB, unsigned SizeInBits, bool GetAllRegSet=false)</div><div class="ttdoc">Given a register bank, and size in bits, return the smallest register class that can represent that c...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00550">AArch64InstructionSelector.cpp:550</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a5dc0a32516ce31f495b440d47287028b"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a5dc0a32516ce31f495b440d47287028b">llvm::MachineRegisterInfo::getType</a></div><div class="ttdeci">LLT getType(Register Reg) const</div><div class="ttdoc">Get the low-level type of Reg or LLT{} if Reg is not a generic (target independent) virtual register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00759">MachineRegisterInfo.h:759</a></div></div>
<div class="ttc" id="aMachineInstrBuilder_8h_html"><div class="ttname"><a href="MachineInstrBuilder_8h.html">MachineInstrBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_ac27689339b95eeb89bc9e40aa1e394f9"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#ac27689339b95eeb89bc9e40aa1e394f9">llvm::MachineRegisterInfo::cloneVirtualRegister</a></div><div class="ttdeci">Register cloneVirtualRegister(Register VReg, StringRef Name=&quot;&quot;)</div><div class="ttdoc">Create and return a new virtual register in the function with the same attributes as the given regist...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00170">MachineRegisterInfo.cpp:170</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a860467662b17cef898ece774ab400235"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">llvm::MachineInstrBuilder::setMIFlags</a></div><div class="ttdeci">const MachineInstrBuilder &amp; setMIFlags(unsigned Flags) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00273">MachineInstrBuilder.h:273</a></div></div>
<div class="ttc" id="aclassllvm_1_1Register_html_a4a6966b99e305bd6f01fb17c645ae3da"><div class="ttname"><a href="classllvm_1_1Register.html#a4a6966b99e305bd6f01fb17c645ae3da">llvm::Register::isValid</a></div><div class="ttdeci">bool isValid() const</div><div class="ttdef"><b>Definition:</b> <a href="Register_8h_source.html#l00126">Register.h:126</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a682ba82f42f7903d0000ffbb13ea3b57"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">llvm::MachineOperand::setReg</a></div><div class="ttdeci">void setReg(Register Reg)</div><div class="ttdoc">Change the register this operand corresponds to.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8cpp_source.html#l00061">MachineOperand.cpp:61</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0de00f38864016881b1182ebac4b7b30"><div class="ttname"><a href="namespacellvm.html#a0de00f38864016881b1182ebac4b7b30">llvm::constrainOperandRegClass</a></div><div class="ttdeci">Register constrainOperandRegClass(const MachineFunction &amp;MF, const TargetRegisterInfo &amp;TRI, MachineRegisterInfo &amp;MRI, const TargetInstrInfo &amp;TII, const RegisterBankInfo &amp;RBI, MachineInstr &amp;InsertPt, const TargetRegisterClass &amp;RegClass, MachineOperand &amp;RegMO)</div><div class="ttdoc">Constrain the Register operand OpIdx, so that it is now constrained to the TargetRegisterClass passed...</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00053">Utils.cpp:53</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a469e271fba3a9b52dad4fa54eaf44e2b"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a469e271fba3a9b52dad4fa54eaf44e2b">llvm::MachineInstr::addOperand</a></div><div class="ttdeci">void addOperand(MachineFunction &amp;MF, const MachineOperand &amp;Op)</div><div class="ttdoc">Add the specified operand to the instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00187">MachineInstr.cpp:187</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_a2f20e789b5382825adc3f5fb87310c37"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#a2f20e789b5382825adc3f5fb87310c37">llvm::MIPatternMatch::m_Neg</a></div><div class="ttdeci">BinaryOp_match&lt; SpecificConstantMatch, SrcTy, TargetOpcode::G_SUB &gt; m_Neg(const SrcTy &amp;&amp;Src)</div><div class="ttdoc">Matches a register negated by a G_SUB.</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00766">MIPatternMatch.h:766</a></div></div>
<div class="ttc" id="aclassllvm_1_1ArrayRef_html_a85ffb6531d4cda988ea81f18d4e56fb7"><div class="ttname"><a href="classllvm_1_1ArrayRef.html#a85ffb6531d4cda988ea81f18d4e56fb7">llvm::ArrayRef::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">size - Get the array size.</div><div class="ttdef"><b>Definition:</b> <a href="ArrayRef_8h_source.html#l00163">ArrayRef.h:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_ae456a811703836ee5d9e32c3e51a15b6"><div class="ttname"><a href="classllvm_1_1LLT.html#ae456a811703836ee5d9e32c3e51a15b6">llvm::LLT::getSizeInBytes</a></div><div class="ttdeci">constexpr TypeSize getSizeInBytes() const</div><div class="ttdoc">Returns the total size of the type in bytes, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00169">LowLevelTypeImpl.h:169</a></div></div>
<div class="ttc" id="anamespacellvm_1_1tgtok_html_abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490"><div class="ttname"><a href="namespacellvm_1_1tgtok.html#abbc5259d649363016626e2529fabe0c5a1ef22e535a2fc701cdafaffe74fc7490">llvm::tgtok::Bit</a></div><div class="ttdeci">@ Bit</div><div class="ttdef"><b>Definition:</b> <a href="TGLexer_8h_source.html#l00050">TGLexer.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a82dd10b626a629b9bb7d32d53a8e0884"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a82dd10b626a629b9bb7d32d53a8e0884">llvm::MachineFunction::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Return the DataLayout attached to the Module associated to this MF.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8cpp_source.html#l00292">MachineFunction.cpp:292</a></div></div>
<div class="ttc" id="aclassllvm_1_1GLoadStore_html_a2aaf791aa3564d53adefabc2e145234c"><div class="ttname"><a href="classllvm_1_1GLoadStore.html#a2aaf791aa3564d53adefabc2e145234c">llvm::GLoadStore::getMMO</a></div><div class="ttdeci">MachineMemOperand &amp; getMMO() const</div><div class="ttdoc">Get the MachineMemOperand on this instruction.</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00047">GenericMachineInstrs.h:47</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a59dcdcd32661c3deea19d0b4c00aeb09"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a59dcdcd32661c3deea19d0b4c00aeb09">llvm::AArch64_AM::UXTB</a></div><div class="ttdeci">@ UXTB</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00041">AArch64AddressingModes.h:41</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MipsISD_html_a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363"><div class="ttname"><a href="namespacellvm_1_1MipsISD.html#a422daf9aa810935178671306b651d69bad5006873d15f9569d1cf09deef3c6363">llvm::MipsISD::Ins</a></div><div class="ttdeci">@ Ins</div><div class="ttdef"><b>Definition:</b> <a href="MipsISelLowering_8h_source.html#l00160">MipsISelLowering.h:160</a></div></div>
<div class="ttc" id="aMachineMemOperand_8h_html"><div class="ttname"><a href="MachineMemOperand_8h.html">MachineMemOperand.h</a></div></div>
<div class="ttc" id="aMachineOperand_8h_html"><div class="ttname"><a href="MachineOperand_8h.html">MachineOperand.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64CC_html_abfa1f7dce576430da99eed57807c7f28"><div class="ttname"><a href="namespacellvm_1_1AArch64CC.html#abfa1f7dce576430da99eed57807c7f28">llvm::AArch64CC::CondCode</a></div><div class="ttdeci">CondCode</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00254">AArch64BaseInfo.h:254</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_ac27317e513ca940053ef5778f920269f"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#ac27317e513ca940053ef5778f920269f">getShiftTypeForInst</a></div><div class="ttdeci">static AArch64_AM::ShiftExtendType getShiftTypeForInst(MachineInstr &amp;MI)</div><div class="ttdoc">Given a shift instruction, return the correct shift type for that instruction.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l06575">AArch64InstructionSelector.cpp:6575</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_ab76052bb166c65901edb603a3e1f03ab"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a></div><div class="ttdeci">const char LLVMTargetMachineRef TM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00047">PassBuilderBindings.cpp:47</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1175ca529ece1df77d922f75a8726f56"><div class="ttname"><a href="namespacellvm.html#a1175ca529ece1df77d922f75a8726f56">llvm::getConstantFPVRegVal</a></div><div class="ttdeci">const ConstantFP * getConstantFPVRegVal(Register VReg, const MachineRegisterInfo &amp;MRI)</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_2GlobalISel_2Utils_8cpp_source.html#l00434">Utils.cpp:434</a></div></div>
<div class="ttc" id="aAArch64ISelLowering_8cpp_html_a588e5dcf7ccf9ec2b6922f24c012a08a"><div class="ttname"><a href="AArch64ISelLowering_8cpp.html#a588e5dcf7ccf9ec2b6922f24c012a08a">emitConjunctionRec</a></div><div class="ttdeci">static SDValue emitConjunctionRec(SelectionDAG &amp;DAG, SDValue Val, AArch64CC::CondCode &amp;OutCC, bool Negate, SDValue CCOp, AArch64CC::CondCode Predicate)</div><div class="ttdoc">Emit conjunction or disjunction tree with the CMP/FCMP followed by a chain of CCMP/CFCMP ops.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8cpp_source.html#l03293">AArch64ISelLowering.cpp:3293</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_abfe88c5c35b927527bbf2475bbf28416"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#abfe88c5c35b927527bbf2475bbf28416">isSignExtendShiftType</a></div><div class="ttdeci">static bool isSignExtendShiftType(AArch64_AM::ShiftExtendType Type)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l06099">AArch64InstructionSelector.cpp:6099</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71ae048a7c85d8a27195ad9ce1e1282bda9"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71ae048a7c85d8a27195ad9ce1e1282bda9">llvm::AArch64II::MO_G2</a></div><div class="ttdeci">@ MO_G2</div><div class="ttdoc">MO_G2 - A symbol operand with this flag (granule 2) represents the bits 32-47 of a 64-bit address,...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00719">AArch64BaseInfo.h:719</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443"><div class="ttname"><a href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">llvm::omp::RTLDependInfoFields::Flags</a></div><div class="ttdeci">@ Flags</div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a902b09cfe1ad72267169b4f08909f680"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a902b09cfe1ad72267169b4f08909f680">getSubRegForClass</a></div><div class="ttdeci">static bool getSubRegForClass(const TargetRegisterClass *RC, const TargetRegisterInfo &amp;TRI, unsigned &amp;SubReg)</div><div class="ttdoc">Returns the correct subregister to use for a given register class.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00586">AArch64InstructionSelector.cpp:586</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetMachine_html_ae106f6c6362377b3016f0d174227e193"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#ae106f6c6362377b3016f0d174227e193">llvm::TargetMachine::getCodeModel</a></div><div class="ttdeci">CodeModel::Model getCodeModel() const</div><div class="ttdoc">Returns the code model.</div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00233">TargetMachine.h:233</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_abeed97c145aefd8b8974bb1947a19439"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#abeed97c145aefd8b8974bb1947a19439">llvm::MIPatternMatch::m_Not</a></div><div class="ttdeci">BinaryOp_match&lt; SrcTy, SpecificConstantMatch, TargetOpcode::G_XOR, true &gt; m_Not(const SrcTy &amp;&amp;Src)</div><div class="ttdoc">Matches a register not-ed by a G_XOR.</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00774">MIPatternMatch.h:774</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00051">AArch64InstructionSelector.cpp:51</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MIPatternMatch_html_aa9bd186f4281a367fb872d17d0e7728b"><div class="ttname"><a href="namespacellvm_1_1MIPatternMatch.html#aa9bd186f4281a367fb872d17d0e7728b">llvm::MIPatternMatch::mi_match</a></div><div class="ttdeci">bool mi_match(Reg R, const MachineRegisterInfo &amp;MRI, Pattern &amp;&amp;P)</div><div class="ttdef"><b>Definition:</b> <a href="MIPatternMatch_8h_source.html#l00025">MIPatternMatch.h:25</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a822b65b0f419881e5f0352e2f4f33d29"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a822b65b0f419881e5f0352e2f4f33d29">llvm::AArch64_AM::UXTH</a></div><div class="ttdeci">@ UXTH</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00042">AArch64AddressingModes.h:42</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a8e3929f9a80e9ff6d48e35bba3e2d600"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a8e3929f9a80e9ff6d48e35bba3e2d600">selectBinaryOp</a></div><div class="ttdeci">static unsigned selectBinaryOp(unsigned GenericOpc, unsigned RegBankID, unsigned OpSize)</div><div class="ttdoc">Select the AArch64 opcode for the basic binary operation GenericOpc (such as G_OR or G_SDIV),...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00750">AArch64InstructionSelector.cpp:750</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFrameInfo_html_a4b9a38005d95189db3246e0e4ec6088d"><div class="ttname"><a href="classllvm_1_1MachineFrameInfo.html#a4b9a38005d95189db3246e0e4ec6088d">llvm::MachineFrameInfo::setFrameAddressIsTaken</a></div><div class="ttdeci">void setFrameAddressIsTaken(bool T)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFrameInfo_8h_source.html#l00372">MachineFrameInfo.h:372</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_afb7df659747f14484e642788c2fe6788"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#afb7df659747f14484e642788c2fe6788">createTuple</a></div><div class="ttdeci">static Register createTuple(ArrayRef&lt; Register &gt; Regs, const unsigned RegClassIDs[], const unsigned SubRegs[], MachineIRBuilder &amp;MIB)</div><div class="ttdoc">Create a REG_SEQUENCE instruction using the registers in Regs.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00640">AArch64InstructionSelector.cpp:640</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64Subtarget_html"><div class="ttname"><a href="classllvm_1_1AArch64Subtarget.html">llvm::AArch64Subtarget</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64Subtarget_8h_source.html#l00038">AArch64Subtarget.h:38</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_aaea263c7a3c058db83a4d5a74562610e"><div class="ttname"><a href="namespacellvm.html#aaea263c7a3c058db83a4d5a74562610e">llvm::createAArch64InstructionSelector</a></div><div class="ttdeci">InstructionSelector * createAArch64InstructionSelector(const AArch64TargetMachine &amp;, AArch64Subtarget &amp;, AArch64RegisterBankInfo &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l06966">AArch64InstructionSelector.cpp:6966</a></div></div>
<div class="ttc" id="aMachineFunction_8h_html"><div class="ttname"><a href="MachineFunction_8h.html">MachineFunction.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_ac2421adbb9996e1b15f03a8abb6c70a8"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ac2421adbb9996e1b15f03a8abb6c70a8">llvm::MachineInstr::eraseFromParent</a></div><div class="ttdeci">void eraseFromParent()</div><div class="ttdoc">Unlink 'this' from the containing basic block and delete it.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00705">MachineInstr.cpp:705</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBundleIterator_html"><div class="ttname"><a href="classllvm_1_1MachineInstrBundleIterator.html">llvm::MachineInstrBundleIterator&lt; MachineInstr &gt;</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_a35ad100b6df3a31a99a57b0e7ebbac7a"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#a35ad100b6df3a31a99a57b0e7ebbac7a">changeFPCCToANDAArch64CC</a></div><div class="ttdeci">static void changeFPCCToANDAArch64CC(CmpInst::Predicate CC, AArch64CC::CondCode &amp;CondCode, AArch64CC::CondCode &amp;CondCode2)</div><div class="ttdoc">Convert an IR fp condition code to an AArch64 CC.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l01365">AArch64InstructionSelector.cpp:1365</a></div></div>
<div class="ttc" id="anamespacellvm_1_1mca_html_a9daeae4f77bbf637d7f5ed46c92ed5c5"><div class="ttname"><a href="namespacellvm_1_1mca.html#a9daeae4f77bbf637d7f5ed46c92ed5c5">llvm::mca::selectImpl</a></div><div class="ttdeci">static uint64_t selectImpl(uint64_t CandidateMask, uint64_t &amp;NextInSequenceMask)</div><div class="ttdef"><b>Definition:</b> <a href="ResourceManager_8cpp_source.html#l00026">ResourceManager.cpp:26</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_aaf99cc107633e8a3758a15b396e290e1"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#aaf99cc107633e8a3758a15b396e290e1">getVectorSHLImm</a></div><div class="ttdeci">static std::optional&lt; int64_t &gt; getVectorSHLImm(LLT SrcTy, Register Reg, MachineRegisterInfo &amp;MRI)</div><div class="ttdoc">Matches and returns the shift immediate value for a SHL instruction given a shift operand.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l01794">AArch64InstructionSelector.cpp:1794</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a69fb30748f1b3e8a0affd486a9f59f6d"><div class="ttname"><a href="classllvm_1_1LLT.html#a69fb30748f1b3e8a0affd486a9f59f6d">llvm::LLT::isValid</a></div><div class="ttdeci">constexpr bool isValid() const</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00121">LowLevelTypeImpl.h:121</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71a4144c2ee93286fba09bd8f14fb11f27a"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a4144c2ee93286fba09bd8f14fb11f27a">llvm::AArch64II::MO_GOT</a></div><div class="ttdeci">@ MO_GOT</div><div class="ttdoc">MO_GOT - This flag indicates that a symbol operand represents the address of the GOT entry for the sy...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00742">AArch64BaseInfo.h:742</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_adba6b0f5197cda6e31725e3309fb7cb0"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#adba6b0f5197cda6e31725e3309fb7cb0">getLaneCopyOpcode</a></div><div class="ttdeci">static bool getLaneCopyOpcode(unsigned &amp;CopyOpc, unsigned &amp;ExtractSubReg, const unsigned EltSize)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l04087">AArch64InstructionSelector.cpp:4087</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_acbc921830578e2741be6549db716c0ce"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">llvm::MachineBasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00311">MachineBasicBlock.h:311</a></div></div>
<div class="ttc" id="aAArch64AdvSIMDScalarPass_8cpp_html_a92a6b0a9b7228d190b0a7d8ae3ef03c7"><div class="ttname"><a href="AArch64AdvSIMDScalarPass_8cpp.html#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a></div><div class="ttdeci">unsigned SubReg</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AdvSIMDScalarPass_8cpp_source.html#l00104">AArch64AdvSIMDScalarPass.cpp:104</a></div></div>
<div class="ttc" id="aAArch64InstructionSelector_8cpp_html_ab328c242b91fe2bc4d6d0797761fdea1"><div class="ttname"><a href="AArch64InstructionSelector_8cpp.html#ab328c242b91fe2bc4d6d0797761fdea1">selectDebugInstr</a></div><div class="ttdeci">static bool selectDebugInstr(MachineInstr &amp;I, MachineRegisterInfo &amp;MRI, const RegisterBankInfo &amp;RBI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstructionSelector_8cpp_source.html#l00913">AArch64InstructionSelector.cpp:913</a></div></div>
<div class="ttc" id="aclassllvm_1_1SrcOp_html"><div class="ttname"><a href="classllvm_1_1SrcOp.html">llvm::SrcOp</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineIRBuilder_8h_source.html#l00128">MachineIRBuilder.h:128</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a965a15cef77a97f0e17f9f26fd5be53e"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a965a15cef77a97f0e17f9f26fd5be53e">llvm::MachineRegisterInfo::setRegClass</a></div><div class="ttdeci">void setRegClass(Register Reg, const TargetRegisterClass *RC)</div><div class="ttdoc">setRegClass - Set the register class of the specified virtual register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8cpp_source.html#l00057">MachineRegisterInfo.cpp:57</a></div></div>
<div class="ttc" id="aclassllvm_1_1GSelect_html_ac53d2f333a28421f2f18a7867d3053dc"><div class="ttname"><a href="classllvm_1_1GSelect.html#ac53d2f333a28421f2f18a7867d3053dc">llvm::GSelect::getFalseReg</a></div><div class="ttdeci">Register getFalseReg() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericMachineInstrs_8h_source.html#l00223">GenericMachineInstrs.h:223</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html_a32472b5afd0ae6edb4a233a25056a6aa"><div class="ttname"><a href="classllvm_1_1LLT.html#a32472b5afd0ae6edb4a233a25056a6aa">llvm::LLT::getScalarSizeInBits</a></div><div class="ttdeci">constexpr unsigned getScalarSizeInBits() const</div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00233">LowLevelTypeImpl.h:233</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">llvm::sampleprof::Base</a></div><div class="ttdeci">@ Base</div><div class="ttdef"><b>Definition:</b> <a href="Discriminator_8h_source.html#l00058">Discriminator.h:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64II_html_ae22a65863fdb02ce99abf9ee08bcbb71a7f04634c15a04a59d5f234002e613b5b"><div class="ttname"><a href="namespacellvm_1_1AArch64II.html#ae22a65863fdb02ce99abf9ee08bcbb71a7f04634c15a04a59d5f234002e613b5b">llvm::AArch64II::MO_PAGE</a></div><div class="ttdeci">@ MO_PAGE</div><div class="ttdoc">MO_PAGE - A symbol operand with this flag represents the pc-relative offset of the 4K page containing...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00706">AArch64BaseInfo.h:706</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00043">Use.h:43</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_a396fcfee6914c76974b73c3d203da6a5"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#a396fcfee6914c76974b73c3d203da6a5">llvm::SmallVectorImpl::emplace_back</a></div><div class="ttdeci">reference emplace_back(ArgTypes &amp;&amp;... Args)</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00941">SmallVector.h:941</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLT_html"><div class="ttname"><a href="classllvm_1_1LLT.html">llvm::LLT</a></div><div class="ttdef"><b>Definition:</b> <a href="LowLevelTypeImpl_8h_source.html#l00039">LowLevelTypeImpl.h:39</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:09:01 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
