<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Scalar/PlaceSafepoints.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_e6e1f1f37d351595fa984b942927b205.html">Scalar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PlaceSafepoints.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="PlaceSafepoints_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- PlaceSafepoints.cpp - Place GC Safepoints --------------------------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Place garbage collection safepoints at appropriate locations in the IR. This</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// does not make relocation semantics or variable liveness explicit.  That&#39;s</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// done by RewriteStatepointsForGC.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// Terminology:</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// - A call is said to be &quot;parseable&quot; if there is a stack map generated for the</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// return PC of the call.  A runtime can determine where values listed in the</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// deopt arguments and (after RewriteStatepointsForGC) gc arguments are located</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// on the stack when the code is suspended inside such a call.  Every parse</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// point is represented by a call wrapped in an gc.statepoint intrinsic.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// - A &quot;poll&quot; is an explicit check in the generated code to determine if the</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// runtime needs the generated code to cooperate by calling a helper routine</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// and thus suspending its execution at a known state. The call to the helper</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// routine will be parseable.  The (gc &amp; runtime specific) logic of a poll is</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// assumed to be provided in a function of the name &quot;gc.safepoint_poll&quot;.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// We aim to insert polls such that running code can quickly be brought to a</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// well defined state for inspection by the collector.  In the current</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// implementation, this is done via the insertion of poll sites at method entry</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// and the backedge of most loops.  We try to avoid inserting more polls than</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// are necessary to ensure a finite period between poll sites.  This is not</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// because the poll itself is expensive in the generated code; it&#39;s not.  Polls</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// do tend to impact the optimizer itself in negative ways; we&#39;d like to avoid</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// perturbing the optimization of the method as much as we can.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// We also need to make most call sites parseable.  The callee might execute a</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// poll (or otherwise be inspected by the GC).  If so, the entire stack</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// (including the suspended frame of the current method) must be parseable.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// This pass will insert:</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// - Call parse points (&quot;call safepoints&quot;) for any call which may need to</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// reach a safepoint during the execution of the callee function.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// - Backedge safepoint polls and entry safepoint polls to ensure that</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// executing code reaches a safepoint poll in a finite amount of time.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// We do not currently support return statepoints, but adding them would not</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// be hard.  They are not required for correctness - entry safepoints are an</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// alternative - but some GCs may prefer them.  Patches welcome.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SetVector_8h.html">llvm/ADT/SetVector.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Analysis_2CFG_8h.html">llvm/Analysis/CFG.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ScalarEvolution_8h.html">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LegacyPassManager_8h.html">llvm/IR/LegacyPassManager.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statepoint_8h.html">llvm/IR/Statepoint.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Cloning_8h.html">llvm/Transforms/Utils/Cloning.h</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   70</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;safepoint-placement&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a382f84ef1b61ce7798e971d73d497a0b">STATISTIC</a>(NumEntrySafepoints, <span class="stringliteral">&quot;Number of entry safepoints inserted&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a382f84ef1b61ce7798e971d73d497a0b">STATISTIC</a>(NumBackedgeSafepoints, <span class="stringliteral">&quot;Number of backedge safepoints inserted&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a382f84ef1b61ce7798e971d73d497a0b">STATISTIC</a>(CallInLoop,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="stringliteral">&quot;Number of loops without safepoints due to calls in loop&quot;</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a382f84ef1b61ce7798e971d73d497a0b">STATISTIC</a>(FiniteExecution,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          <span class="stringliteral">&quot;Number of loops without safepoints finite execution&quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// Ignore opportunities to avoid placing safepoints on backedges, useful for</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// validation</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PlaceSafepoints_8cpp.html#aaf7575d42eea6fea092cba5fc736b69c">AllBackedges</a>(<span class="stringliteral">&quot;spp-all-backedges&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                  <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/// How narrow does the trip count of a loop have to be to have to be considered</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">/// &quot;counted&quot;?  Counted loops do not get safepoints at backedges.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code" href="PlaceSafepoints_8cpp.html#a7d9efdccecd366fc94d04a5f79e6e9c9">CountedLoopTripWidth</a>(<span class="stringliteral">&quot;spp-counted-loop-trip-width&quot;</span>,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                         <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(32));</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// If true, split the backedge of a loop when placing the safepoint, otherwise</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// split the latch block itself.  Both are useful to support for</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">// experimentation, but in practice, it looks like splitting the backedge</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// optimizes better.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PlaceSafepoints_8cpp.html#ab29b055d837246403b4f421b83f00f3c">SplitBackedge</a>(<span class="stringliteral">&quot;spp-split-backedge&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                   <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">/// An analysis pass whose purpose is to identify each of the backedges in</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/// the function which require a safepoint poll to be inserted.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span><span class="keyword">struct </span>PlaceBackedgeSafepointsImpl : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  /// The output of the pass - gives a list of each backedge (described by</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  /// pointing at the branch) which need a poll inserted.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span>  std::vector&lt;Instruction *&gt; PollLocations;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">  /// True unless we&#39;re running spp-no-calls in which case we need to disable</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  /// the call-dependent placement opts.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> CallSafepointsEnabled;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="classllvm_1_1LoopInfo.html">LoopInfo</a> *LI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> *TLI = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  PlaceBackedgeSafepointsImpl(<span class="keywordtype">bool</span> CallSafepoints = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>), CallSafepointsEnabled(CallSafepoints) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="namespacellvm.html#ae186267c792346b2259084106ac18aa9">initializePlaceBackedgeSafepointsImplPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">bool</span> runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">void</span> runOnLoopAndSubLoops(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// Visit all the subloops</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *L)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      runOnLoopAndSubLoops(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    runOnLoop(L);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    SE = &amp;getAnalysis&lt;ScalarEvolutionWrapperPass&gt;().getSE();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    DT = &amp;getAnalysis&lt;DominatorTreeWrapperPass&gt;().getDomTree();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    LI = &amp;getAnalysis&lt;LoopInfoWrapperPass&gt;().getLoopInfo();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    TLI = &amp;getAnalysis&lt;TargetLibraryInfoWrapperPass&gt;().getTLI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Loop.html">Loop</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *LI) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      runOnLoopAndSubLoops(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1ScalarEvolutionWrapperPass.html">ScalarEvolutionWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// We no longer modify the IR at all in this pass.  Thus all</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// analysis are preserved.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af22b06a6a4f9df80454071685a0d6a02">setPreservesAll</a>();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;};</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PlaceSafepoints_8cpp.html#a9b667969c754fdd7469fe3e87b50383f">NoEntry</a>(<span class="stringliteral">&quot;spp-no-entry&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PlaceSafepoints_8cpp.html#a833913085fae7762e1bbc4480c34e565">NoCall</a>(<span class="stringliteral">&quot;spp-no-call&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="PlaceSafepoints_8cpp.html#aadc3e7f994eca45872ac1c256b4ebbc5">NoBackedge</a>(<span class="stringliteral">&quot;spp-no-backedge&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">false</span>));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">struct </span>PlaceSafepoints : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>; <span class="comment">// Pass identification, replacement for typeid</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  PlaceSafepoints() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="namespacellvm.html#a1c1822164a9db3fdad04d73d558f31ad">initializePlaceSafepointsPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// We modify the graph wholesale (inlining, block insertion, etc).  We</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// preserve nothing at the moment.  We could potentially preserve dom tree</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// if that was worth doing</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;};</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">// Insert a safepoint poll immediately before the given instruction.  Does</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">// not handle the parsability of state at the runtime call, that&#39;s the</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">// callers job.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a1a98793f564d1eb27533846241e7eba2">InsertSafepointPoll</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertBefore,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    std::vector&lt;CallBase *&gt; &amp;ParsePointsNeeded <span class="comment">/*rval*/</span>,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;TLI);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a798de004bec543c0f9059f8c5fc78f92">  185</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#a798de004bec543c0f9059f8c5fc78f92">needsStatepoint</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *Call, <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;TLI) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#af75ecbb2ce891821d146a047f17d4dd1">callsGCLeafFunction</a>(Call, TLI))</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CI = dyn_cast&lt;CallInst&gt;(Call)) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (CI-&gt;isInlineAsm())</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">return</span> !(isa&lt;GCStatepointInst&gt;(Call) || isa&lt;GCRelocateInst&gt;(Call) ||</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;           isa&lt;GCResultInst&gt;(Call));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/// Returns true if this loop is known to contain a call safepoint which</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">/// must unconditionally execute on any iteration of the loop which returns</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/// to the loop header via an edge from Pred.  Returns a conservative correct</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/// answer; i.e. false is always valid.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#aa2cbc07e426705bbdb98c0f6ae7e3f72">  201</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#aa2cbc07e426705bbdb98c0f6ae7e3f72">containsUnconditionalCallSafepoint</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                               <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                               <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;TLI) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// In general, we&#39;re looking for any cut of the graph which ensures</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// there&#39;s a call safepoint along every edge between Header and Pred.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// For the moment, we look only for the &#39;cuts&#39; that consist of a single call</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// instruction in a block which is dominated by the Header and dominates the</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// loop latch (Pred) block.  Somewhat surprisingly, walking the entire chain</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// of such dominating blocks gets substantially more occurrences than just</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// checking the Pred and Header blocks themselves.  This may be due to the</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// density of loop exit conditions caused by range and null checks.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// TODO: structure this as an analysis pass, cache the result for subloops,</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// avoid dom tree recalculations</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(Header, Pred) &amp;&amp; <span class="stringliteral">&quot;loop latch not dominated by header?&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Current = Pred;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : *Current) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Call = dyn_cast&lt;CallBase&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// Note: Technically, needing a safepoint isn&#39;t quite the right</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// condition here.  We should instead be checking if the target method</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">// has an</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">// unconditional poll. In practice, this is only a theoretical concern</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">// since we don&#39;t have any methods with conditional-only safepoint</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">// polls.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="PlaceSafepoints_8cpp.html#a798de004bec543c0f9059f8c5fc78f92">needsStatepoint</a>(Call, TLI))</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (Current == Header)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    Current = DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">getNode</a>(Current)-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#aa22cb3ff8c95bb05185acad8c569d4b6">getIDom</a>()-&gt;<a class="code" href="classllvm_1_1DomTreeNodeBase.html#a6a15a030098342e06ea73e1241d614c9">getBlock</a>();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">/// Returns true if this loop is known to terminate in a finite number of</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">/// iterations.  Note that this function may return false for a loop which</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">/// does actual terminate in a finite constant number of iterations due to</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">/// conservatism in the analysis.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a2003053288ba4f0e1cd9ebf82b6a1987">  243</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#a2003053288ba4f0e1cd9ebf82b6a1987">mustBeFiniteCountedLoop</a>(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L, <a class="code" href="classllvm_1_1ScalarEvolution.html">ScalarEvolution</a> *SE,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// A conservative bound on the loop as a whole.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *MaxTrips = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a80d7048687367a15d267ac5418b8a168">getConstantMaxBackedgeTakenCount</a>(L);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span> (!isa&lt;SCEVCouldNotCompute&gt;(MaxTrips) &amp;&amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a7593d52f91ebe342de9fa72846ebe755">getUnsignedRange</a>(MaxTrips).<a class="code" href="classllvm_1_1ConstantRange.html#ab7f67c2ed8b2799c64ec64ca31d75c60">getUnsignedMax</a>().<a class="code" href="classllvm_1_1APInt.html#ae00c35cb040107c05f3fe00c15bb3da0">isIntN</a>(</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          <a class="code" href="PlaceSafepoints_8cpp.html#a7d9efdccecd366fc94d04a5f79e6e9c9">CountedLoopTripWidth</a>))</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// If this is a conditional branch to the header with the alternate path</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// being outside the loop, we can ask questions about the execution frequency</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// of the exit block.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#af691775d5a45e28afbdb3e97cab22eee">isLoopExiting</a>(Pred)) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// This returns an exact expression only.  TODO: We really only need an</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// upper bound here, but SE doesn&#39;t expose that.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1SCEV.html">SCEV</a> *MaxExec = SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#ab24add5df0874cdfa47b47b1d9926e9e">getExitCount</a>(L, Pred);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (!isa&lt;SCEVCouldNotCompute&gt;(MaxExec) &amp;&amp;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        SE-&gt;<a class="code" href="classllvm_1_1ScalarEvolution.html#a7593d52f91ebe342de9fa72846ebe755">getUnsignedRange</a>(MaxExec).<a class="code" href="classllvm_1_1ConstantRange.html#ab7f67c2ed8b2799c64ec64ca31d75c60">getUnsignedMax</a>().<a class="code" href="classllvm_1_1APInt.html#ae00c35cb040107c05f3fe00c15bb3da0">isIntN</a>(</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <a class="code" href="PlaceSafepoints_8cpp.html#a7d9efdccecd366fc94d04a5f79e6e9c9">CountedLoopTripWidth</a>))</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">return</span> <span class="comment">/* not finite */</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#afe210701ce0a3abfea9278d2538a6470">  268</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="PlaceSafepoints_8cpp.html#afe210701ce0a3abfea9278d2538a6470">scanOneBB</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Start, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *End,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                      std::vector&lt;CallInst *&gt; &amp;Calls,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                      <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> &amp;Seen,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                      std::vector&lt;BasicBlock *&gt; &amp;Worklist) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> BBI(Start), BBE0 = Start-&gt;getParent()-&gt;end(),</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                        BBE1 = <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a>(End);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;       BBI != BBE0 &amp;&amp; BBI != BBE1; BBI++) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *CI = dyn_cast&lt;CallInst&gt;(&amp;*BBI))</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      Calls.push_back(CI);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// FIXME: This code does not handle invokes</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!isa&lt;InvokeInst&gt;(&amp;*BBI) &amp;&amp;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;           <span class="stringliteral">&quot;support for invokes in poll code needed&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// Only add the successor blocks if we reach the terminator instruction</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// without encountering end first</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (BBI-&gt;isTerminator()) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = BBI-&gt;getParent();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ : <a class="code" href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>)) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (Seen.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(Succ).second) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          Worklist.push_back(Succ);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a826d7a5a20d56ef31ee4111073700c93">  295</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="PlaceSafepoints_8cpp.html#a826d7a5a20d56ef31ee4111073700c93">scanInlinedCode</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Start, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *End,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                            std::vector&lt;CallInst *&gt; &amp;Calls,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                            <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> &amp;Seen) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  Calls.clear();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  std::vector&lt;BasicBlock *&gt; Worklist;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  Seen.<a class="code" href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">insert</a>(Start-&gt;getParent());</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="PlaceSafepoints_8cpp.html#afe210701ce0a3abfea9278d2538a6470">scanOneBB</a>(Start, End, Calls, Seen, Worklist);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = Worklist.back();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    Worklist.pop_back();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="PlaceSafepoints_8cpp.html#afe210701ce0a3abfea9278d2538a6470">scanOneBB</a>(&amp;*<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;begin(), End, Calls, Seen, Worklist);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordtype">bool</span> PlaceBackedgeSafepointsImpl::runOnLoop(<a class="code" href="classllvm_1_1Loop.html">Loop</a> *L) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// Loop through all loop latches (branches controlling backedges).  We need</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// to place a safepoint on every backedge (potentially).</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// Note: In common usage, there will be only one edge due to LoopSimplify</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// having run sometime earlier in the pipeline, but this code must be correct</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// w.r.t. loops with multiple backedges.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header = L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">getHeader</a>();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;BasicBlock*, 16&gt;</a> LoopLatches;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a542a6493b191eb84b5457d35ecd685c5">getLoopLatches</a>(LoopLatches);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Pred : LoopLatches) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L-&gt;<a class="code" href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">contains</a>(Pred));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// Make a policy decision about whether this loop needs a safepoint or</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// not.  Note that this is about unburdening the optimizer in loops, not</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// avoiding the runtime cost of the actual safepoint.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="PlaceSafepoints_8cpp.html#aaf7575d42eea6fea092cba5fc736b69c">AllBackedges</a>) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="PlaceSafepoints_8cpp.html#a2003053288ba4f0e1cd9ebf82b6a1987">mustBeFiniteCountedLoop</a>(L, SE, Pred)) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;skipping safepoint placement in finite loop\n&quot;</span>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        FiniteExecution++;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">if</span> (CallSafepointsEnabled &amp;&amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <a class="code" href="PlaceSafepoints_8cpp.html#aa2cbc07e426705bbdb98c0f6ae7e3f72">containsUnconditionalCallSafepoint</a>(L, Header, Pred, *DT, *TLI)) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">// Note: This is only semantically legal since we won&#39;t do any further</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">// IPO or inlining before the actual call insertion..  If we hadn&#39;t, we</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">// might latter loose this call safepoint.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;skipping safepoint placement due to unconditional call\n&quot;</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        CallInLoop++;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// TODO: We can create an inner loop which runs a finite number of</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// iterations with an outer loop which contains a safepoint.  This would</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// not help runtime performance that much, but it might help our ability to</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// optimize the inner loop.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// Safepoint insertion would involve creating a new basic block (as the</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// target of the current backedge) which does the safepoint (of all live</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// variables) and branches to the true header</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a> = Pred-&gt;getTerminator();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;[LSP] terminator instruction: &quot;</span> &lt;&lt; *<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    PollLocations.push_back(<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">/// Returns true if an entry safepoint is not required before this callsite in</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">/// the caller function.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#ab79294a2bb06a12d7f4dc32f80b8f935">  363</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#ab79294a2bb06a12d7f4dc32f80b8f935">doesNotRequireEntrySafepointBefore</a>(<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *Call) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = dyn_cast&lt;IntrinsicInst&gt;(Call)) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">switch</span> (II-&gt;getIntrinsicID()) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">case</span> Intrinsic::experimental_gc_statepoint:</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">case</span> Intrinsic::experimental_patchpoint_void:</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">case</span> Intrinsic::experimental_patchpoint_i64:</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="comment">// The can wrap an actual call which may grow the stack by an unbounded</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="comment">// amount or run forever.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">// Most LLVM intrinsics are things which do not expand to actual calls, or</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">// at least if they do, are leaf functions that cause only finite stack</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="comment">// growth.  In particular, the optimizer likes to form things like memsets</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">// out of stores in the original IR.  Another important example is</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="comment">// llvm.localescape which must occur in the entry block.  Inserting a</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">// safepoint before it is not legal since it could push the localescape</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">// out of the entry block.</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#afb263d90c05a5bc6b0c3fa2c9aeefaba">  386</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="PlaceSafepoints_8cpp.html#afb263d90c05a5bc6b0c3fa2c9aeefaba">findLocationForEntrySafepoint</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                                  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">// Conceptually, this poll needs to be on method entry, but in</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// practice, we place it as late in the entry block as possible.  We</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// can place it as late as we want as long as it dominates all calls</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// that can grow the stack.  This, combined with backedge polls,</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// give us all the progress guarantees we need.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// hasNextInstruction and nextInstruction are used to iterate</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// through a &quot;straight line&quot; execution sequence.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keyword">auto</span> HasNextInstruction = [](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isTerminator())</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *nextBB = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;getUniqueSuccessor();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">return</span> nextBB &amp;&amp; (nextBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">getUniquePredecessor</a>() != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  };</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keyword">auto</span> NextInstruction = [&amp;](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(HasNextInstruction(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;           <span class="stringliteral">&quot;first check if there is a next instruction!&quot;</span>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isTerminator())</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;getUniqueSuccessor()-&gt;front();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">return</span> &amp;*++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIterator();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  };</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Cursor = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">for</span> (Cursor = &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().front(); HasNextInstruction(Cursor);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;       Cursor = NextInstruction(Cursor)) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// We need to ensure a safepoint poll occurs before any &#39;real&#39; call.  The</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// easiest way to ensure finite execution between safepoints in the face of</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// recursive and mutually recursive functions is to enforce that each take</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// a safepoint.  Additionally, we need to ensure a poll before any call</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// which can grow the stack by an unbounded amount.  This isn&#39;t required</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// for GC semantics per se, but is a common requirement for languages</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// which detect stack overflow via guard pages and then throw exceptions.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Call = dyn_cast&lt;CallBase&gt;(Cursor)) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="PlaceSafepoints_8cpp.html#ab79294a2bb06a12d7f4dc32f80b8f935">doesNotRequireEntrySafepointBefore</a>(Call))</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((HasNextInstruction(Cursor) || Cursor-&gt;<a class="code" href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">isTerminator</a>()) &amp;&amp;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;         <span class="stringliteral">&quot;either we stopped because of a call, or because of terminator&quot;</span>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">return</span> Cursor;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a0d2900c2047fa60ef8138dae263123ff">  439</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="PlaceSafepoints_8cpp.html#a0d2900c2047fa60ef8138dae263123ff">GCSafepointPollName</a>[] = <span class="stringliteral">&quot;gc.safepoint_poll&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a61ab641b03f16e1f3ad916913ce89903">  441</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#a61ab641b03f16e1f3ad916913ce89903">isGCSafepointPoll</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName().equals(<a class="code" href="PlaceSafepoints_8cpp.html#a0d2900c2047fa60ef8138dae263123ff">GCSafepointPollName</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">/// Returns true if this function should be rewritten to include safepoint</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">/// polls and parseable call sites.  The main point of this function is to be</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">/// an extension point for custom logic.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a737f3181d1ae8ed5fe159b4003d024d1">  448</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#a737f3181d1ae8ed5fe159b4003d024d1">shouldRewriteFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// TODO: This should check the GCStrategy</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasGC()) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;FunctionGCName = <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getGC();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> StatepointExampleName(<span class="stringliteral">&quot;statepoint-example&quot;</span>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> CoreCLRName(<span class="stringliteral">&quot;coreclr&quot;</span>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">return</span> (StatepointExampleName == FunctionGCName) ||</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;           (CoreCLRName == FunctionGCName);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">// TODO: These should become properties of the GCStrategy, possibly with</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">// command line overrides.</span></div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a4021e064e9d2a5e5762d1d4a1dcd7db9">  462</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#a4021e064e9d2a5e5762d1d4a1dcd7db9">enableEntrySafepoints</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) { <span class="keywordflow">return</span> !<a class="code" href="PlaceSafepoints_8cpp.html#a9b667969c754fdd7469fe3e87b50383f">NoEntry</a>; }</div>
<div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#ade6d0f7cc42acd42e21c6154bd713afa">  463</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#ade6d0f7cc42acd42e21c6154bd713afa">enableBackedgeSafepoints</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) { <span class="keywordflow">return</span> !<a class="code" href="PlaceSafepoints_8cpp.html#aadc3e7f994eca45872ac1c256b4ebbc5">NoBackedge</a>; }</div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a3a3b930c659333a27bb598ea5960fe52">  464</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="PlaceSafepoints_8cpp.html#a3a3b930c659333a27bb598ea5960fe52">enableCallSafepoints</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) { <span class="keywordflow">return</span> !<a class="code" href="PlaceSafepoints_8cpp.html#a833913085fae7762e1bbc4480c34e565">NoCall</a>; }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">PlaceSafepoints::runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration() || <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.empty()) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// This is a declaration, nothing to do.  Must exit early to avoid crash in</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// dom tree calculation</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="PlaceSafepoints_8cpp.html#a61ab641b03f16e1f3ad916913ce89903">isGCSafepointPoll</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">// Given we&#39;re inlining this inside of safepoint poll insertion, this</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// doesn&#39;t make any sense.  Note that we do make any contained calls</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// parseable after we inline a poll.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="PlaceSafepoints_8cpp.html#a737f3181d1ae8ed5fe159b4003d024d1">shouldRewriteFunction</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;TLI =</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      getAnalysis&lt;TargetLibraryInfoWrapperPass&gt;().getTLI(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// In various bits below, we rely on the fact that uses are reachable from</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// defs.  When there are basic blocks unreachable from the entry, dominance</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// and reachablity queries return non-sensical results.  Thus, we preprocess</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// the function to ensure these properties hold.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> |= <a class="code" href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">removeUnreachableBlocks</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// STEP 1 - Insert the safepoint polling locations.  We do not need to</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// actually insert parse points yet.  That will be done for all polls and</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// calls in a single pass.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="classllvm_1_1DominatorTree.html">DominatorTree</a> DT;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#aa0641ae965656ff9988d67a35140e4d9">recalculate</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 16&gt;</a> PollsNeeded;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  std::vector&lt;CallBase *&gt; ParsePointNeeded;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="PlaceSafepoints_8cpp.html#ade6d0f7cc42acd42e21c6154bd713afa">enableBackedgeSafepoints</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">// Construct a pass manager to run the LoopPass backedge logic.  We</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// need the pass manager to handle scheduling all the loop passes</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// appropriately.  Doing this by hand is painful and just not worth messing</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// with for the moment.</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="classllvm_1_1legacy_1_1FunctionPassManager.html">legacy::FunctionPassManager</a> FPM(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent());</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">bool</span> CanAssumeCallSafepoints = <a class="code" href="PlaceSafepoints_8cpp.html#a3a3b930c659333a27bb598ea5960fe52">enableCallSafepoints</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keyword">auto</span> *PBS = <span class="keyword">new</span> PlaceBackedgeSafepointsImpl(CanAssumeCallSafepoints);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    FPM.add(PBS);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    FPM.run(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// We preserve dominance information when inserting the poll, otherwise</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// we&#39;d have to recalculate this on every insert</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    DT.<a class="code" href="classllvm_1_1DominatorTreeBase.html#aa0641ae965656ff9988d67a35140e4d9">recalculate</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keyword">auto</span> &amp;PollLocations = PBS-&gt;PollLocations;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keyword">auto</span> OrderByBBName = [](<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#a7ef4d3003047043a3de118adbb0570fd">a</a>, <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="lib_2Target_2ARM_2README_8txt.html#acdf5bf3bbc10f9331f56441a4d483bb1">b</a>) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#a7ef4d3003047043a3de118adbb0570fd">a</a>-&gt;getParent()-&gt;getName() &lt; <a class="code" href="lib_2Target_2ARM_2README_8txt.html#acdf5bf3bbc10f9331f56441a4d483bb1">b</a>-&gt;getParent()-&gt;getName();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    };</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// We need the order of list to be stable so that naming ends up stable</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// when we split edges.  This makes test cases much easier to write.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(PollLocations, OrderByBBName);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// We can sometimes end up with duplicate poll locations.  This happens if</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// a single loop is visited more than once.   The fact this happens seems</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// wrong, but it does happen for the split-backedge.ll test case.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    PollLocations.erase(<a class="code" href="namespacellvm.html#a92be87f8a371f277f7260fb99592d5f4">std::unique</a>(PollLocations.begin(),</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                    PollLocations.end()),</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                        PollLocations.end());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// Insert a poll at each point the analysis pass identified</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// The poll location must be the terminator of a loop latch block.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a> : PollLocations) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="comment">// We are inserting a poll, the function is modified</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="PlaceSafepoints_8cpp.html#ab29b055d837246403b4f421b83f00f3c">SplitBackedge</a>) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="comment">// Split the backedge of the loop and insert the poll within that new</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="comment">// basic block.  This creates a loop with two latches per original</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">// latch (which is non-ideal), but this appears to be easier to</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment">// optimize in practice than inserting the poll immediately before the</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="comment">// latch test.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="comment">// Since this is a latch, at least one of the successors must dominate</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">// it. Its possible that we have a) duplicate edges to the same header</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="comment">// and b) edges to distinct loop headers.  We need to insert pools on</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">// each.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;BasicBlock *&gt;</a> Headers;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;getNumSuccessors(); <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ = <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;getSuccessor(<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          <span class="keywordflow">if</span> (DT.<a class="code" href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">dominates</a>(Succ, <a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;getParent())) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            Headers.<a class="code" href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">insert</a>(Succ);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;          }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Headers.<a class="code" href="classllvm_1_1SetVector.html#aaf9ee38b9973681c1720aaf03af3a069">empty</a>() &amp;&amp; <span class="stringliteral">&quot;poll location is not a loop latch?&quot;</span>);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// The split loop structure here is so that we only need to recalculate</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="comment">// the dominator tree once.  Alternatively, we could just keep it up to</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">// date and use a more natural merged loop.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <a class="code" href="classllvm_1_1SetVector.html">SetVector&lt;BasicBlock *&gt;</a> SplitBackedges;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Header : Headers) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *NewBB = <a class="code" href="namespacellvm.html#adf83581f514774264d616eef5706cf6e">SplitEdge</a>(<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>-&gt;getParent(), Header, &amp;DT);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          PollsNeeded.push_back(NewBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">getTerminator</a>());</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;          NumBackedgeSafepoints++;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">// Split the latch block itself, right before the terminator.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        PollsNeeded.push_back(<a class="code" href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">Term</a>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        NumBackedgeSafepoints++;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="PlaceSafepoints_8cpp.html#a4021e064e9d2a5e5762d1d4a1dcd7db9">enableEntrySafepoints</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Location = <a class="code" href="PlaceSafepoints_8cpp.html#afb263d90c05a5bc6b0c3fa2c9aeefaba">findLocationForEntrySafepoint</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, DT)) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      PollsNeeded.push_back(Location);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      NumEntrySafepoints++;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// TODO: else we should assert that there was, in fact, a policy choice to</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// not insert a entry safepoint poll.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// Now that we&#39;ve identified all the needed safepoint poll locations, insert</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// safepoint polls themselves.</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PollLocation : PollsNeeded) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    std::vector&lt;CallBase *&gt; RuntimeCalls;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="PlaceSafepoints_8cpp.html#a1a98793f564d1eb27533846241e7eba2">InsertSafepointPoll</a>(PollLocation, RuntimeCalls, TLI);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a>(ParsePointNeeded, RuntimeCalls);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;}</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">PlaceBackedgeSafepointsImpl::ID</a> = 0;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">PlaceSafepoints::ID</a> = 0;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="namespacellvm.html#ae324659e4fe9aeb904f0dbc60343a367">  602</a></span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html#ae324659e4fe9aeb904f0dbc60343a367">llvm::createPlaceSafepointsPass</a>() {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> PlaceSafepoints();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;}</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a8896fe5c638a7d7b20f5fa9393b22f32">INITIALIZE_PASS_BEGIN</a>(PlaceBackedgeSafepointsImpl,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                      <span class="stringliteral">&quot;place-backedge-safepoints-impl&quot;</span>,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                      <span class="stringliteral">&quot;Place Backedge Safepoints&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1ScalarEvolutionWrapperPass.html">ScalarEvolutionWrapperPass</a>)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1DominatorTreeWrapperPass.html">DominatorTreeWrapperPass</a>)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1LoopInfoWrapperPass.html">LoopInfoWrapperPass</a>)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(PlaceBackedgeSafepointsImpl,</div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#abd1ccb1bf511e1965414eb1d2e137302">  613</a></span>&#160;                    &quot;<a class="code" href="lib_2CodeGen_2README_8txt.html#a134ffba8da3505dfab10eef1a9a8b1ef">place</a>-backedge-<a class="code" href="PlaceSafepoints_8cpp.html#ae18fd29bd3983963ebc7076104d82c3e">safepoints</a>-<a class="code" href="PlaceSafepoints_8cpp.html#abd1ccb1bf511e1965414eb1d2e137302">impl</a>&quot;,</div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#aebfacb04097b46feb1abd790cfd22658">  614</a></span>&#160;                    &quot;Place Backedge <a class="code" href="PlaceSafepoints_8cpp.html#aebfacb04097b46feb1abd790cfd22658">Safepoints</a>&quot;, <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a8896fe5c638a7d7b20f5fa9393b22f32">INITIALIZE_PASS_BEGIN</a>(PlaceSafepoints, &quot;<a class="code" href="lib_2CodeGen_2README_8txt.html#a134ffba8da3505dfab10eef1a9a8b1ef">place</a>-<a class="code" href="PlaceSafepoints_8cpp.html#ae18fd29bd3983963ebc7076104d82c3e">safepoints</a>&quot;, &quot;Place <a class="code" href="PlaceSafepoints_8cpp.html#aebfacb04097b46feb1abd790cfd22658">Safepoints</a>&quot;,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                      <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#ae18fd29bd3983963ebc7076104d82c3e">  618</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(PlaceSafepoints, &quot;<a class="code" href="lib_2CodeGen_2README_8txt.html#a134ffba8da3505dfab10eef1a9a8b1ef">place</a>-<a class="code" href="PlaceSafepoints_8cpp.html#ae18fd29bd3983963ebc7076104d82c3e">safepoints</a>&quot;, &quot;Place <a class="code" href="PlaceSafepoints_8cpp.html#aebfacb04097b46feb1abd790cfd22658">Safepoints</a>&quot;,</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    <a class="code" href="namespacefalse.html">false</a>, <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;static <span class="keywordtype">void</span></div>
<div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="PlaceSafepoints_8cpp.html#a1a98793f564d1eb27533846241e7eba2">  622</a></span>&#160;<a class="code" href="PlaceSafepoints_8cpp.html#a1a98793f564d1eb27533846241e7eba2">InsertSafepointPoll</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *InsertBefore,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    <a class="code" href="namespacestd.html">std</a>::vector&lt;<a class="code" href="classllvm_1_1CallBase.html">CallBase</a> *&gt; &amp;ParsePointsNeeded <span class="comment">/*rval*/</span>,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    <a class="code" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="code" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;TLI) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *OrigBB = InsertBefore-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">getParent</a>();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = InsertBefore-&gt;getModule();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> &amp;&amp; <span class="stringliteral">&quot;must be part of a module&quot;</span>);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">// Inline the safepoint poll implementation - this will get all the branch,</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">// control flow, etc..  Most importantly, it will introduce the actual slow</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// path call - where we need to insert a safepoint (parsepoint).</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getFunction(<a class="code" href="PlaceSafepoints_8cpp.html#a0d2900c2047fa60ef8138dae263123ff">GCSafepointPollName</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;&amp; <span class="stringliteral">&quot;gc.safepoint_poll function is missing&quot;</span>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getValueType() ==</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         <a class="code" href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">FunctionType::get</a>(<a class="code" href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">Type::getVoidTy</a>(<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getContext()), <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         <span class="stringliteral">&quot;gc.safepoint_poll declared with wrong type&quot;</span>);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;empty() &amp;&amp; <span class="stringliteral">&quot;gc.safepoint_poll must be a non-empty function&quot;</span>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="classllvm_1_1CallInst.html">CallInst</a> *PollCall = <a class="code" href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">CallInst::Create</a>(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;&quot;</span>, InsertBefore);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// Record some information about the call site we&#39;re replacing</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> Before(PollCall), After(PollCall);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordtype">bool</span> IsBegin = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">if</span> (Before == OrigBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>())</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    IsBegin = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    Before--;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  After++;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(After != OrigBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>() &amp;&amp; <span class="stringliteral">&quot;must have successor&quot;</span>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// Do the actual inlining</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="code" href="classllvm_1_1InlineFunctionInfo.html">InlineFunctionInfo</a> IFI;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordtype">bool</span> InlineStatus = <a class="code" href="namespacellvm.html#ab5a3ac0a249da0743dac1bd816d8e5d5">InlineFunction</a>(*PollCall, IFI).<a class="code" href="classllvm_1_1InlineResult.html#af279070ae6350a3acd0e80ba7da7d397">isSuccess</a>();</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InlineStatus &amp;&amp; <span class="stringliteral">&quot;inline must succeed&quot;</span>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  (void)InlineStatus; <span class="comment">// suppress warning in release-asserts</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// Check post-conditions</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IFI.<a class="code" href="classllvm_1_1InlineFunctionInfo.html#a9c259c76065eb3b4ce3697ce346008ce">StaticAllocas</a>.empty() &amp;&amp; <span class="stringliteral">&quot;can&#39;t have allocs&quot;</span>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  std::vector&lt;CallInst *&gt; Calls; <span class="comment">// new calls</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <a class="code" href="classllvm_1_1DenseSet.html">DenseSet&lt;BasicBlock *&gt;</a> BBs;    <span class="comment">// new BBs + insertee</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// Include only the newly inserted instructions, Note: begin may not be valid</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// if we inserted to the beginning of the basic block</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> Start = IsBegin ? OrigBB-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>() : std::next(Before);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// If your poll function includes an unreachable at the end, that&#39;s not</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// valid.  Bugpoint likes to create this, so check for it.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#affedc93ead6b25c57a7196d32ff11e89">isPotentiallyReachable</a>(&amp;*Start, &amp;*After) &amp;&amp;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;         <span class="stringliteral">&quot;malformed poll function&quot;</span>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <a class="code" href="PlaceSafepoints_8cpp.html#a826d7a5a20d56ef31ee4111073700c93">scanInlinedCode</a>(&amp;*Start, &amp;*After, Calls, BBs);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Calls.empty() &amp;&amp; <span class="stringliteral">&quot;slow path not found for safepoint poll&quot;</span>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// Record the fact we need a parsable state at the runtime call contained in</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// the poll function.  This is required so that the runtime knows how to</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">// parse the last frame when we actually take  the safepoint (i.e. execute</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// the slow path)</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ParsePointsNeeded.empty());</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CI : Calls) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">// No safepoint needed or wanted</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="PlaceSafepoints_8cpp.html#a798de004bec543c0f9059f8c5fc78f92">needsStatepoint</a>(CI, TLI))</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">// These are likely runtime calls.  Should we assert that via calling</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// convention or something?</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    ParsePointsNeeded.push_back(CI);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ParsePointsNeeded.size() &lt;= Calls.size());</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a7653277511df1034148a37520a585bb5"><div class="ttname"><a href="classllvm_1_1Instruction.html#a7653277511df1034148a37520a585bb5">llvm::Instruction::isTerminator</a></div><div class="ttdeci">bool isTerminator() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00171">Instruction.h:171</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0b4e7bee9b8575cc7db73329f1a561bd"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0b4e7bee9b8575cc7db73329f1a561bd">llvm::BasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00316">BasicBlock.h:316</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00087">BasicBlock.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a38bee869ad41aebfef3de2641b12004c"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a38bee869ad41aebfef3de2641b12004c">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00112">BasicBlock.h:112</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aTransforms_2Scalar_8h_html"><div class="ttname"><a href="Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00059">Function.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1Loop_html"><div class="ttname"><a href="classllvm_1_1Loop.html">llvm::Loop</a></div><div class="ttdoc">Represents a single loop in the control flow graph.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00547">LoopInfo.h:547</a></div></div>
<div class="ttc" id="anamespacellvm_html_af75ecbb2ce891821d146a047f17d4dd1"><div class="ttname"><a href="namespacellvm.html#af75ecbb2ce891821d146a047f17d4dd1">llvm::callsGCLeafFunction</a></div><div class="ttdeci">bool callsGCLeafFunction(const CallBase *Call, const TargetLibraryInfo &amp;TLI)</div><div class="ttdoc">Return true if this call calls a gc leaf function.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02889">Local.cpp:2889</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a04337b572d34ea413c35dbac5d75530b"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a04337b572d34ea413c35dbac5d75530b">llvm::LoopBase::contains</a></div><div class="ttdeci">bool contains(const LoopT *L) const</div><div class="ttdoc">Return true if the specified loop is contained within in this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00139">LoopInfo.h:139</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a826d7a5a20d56ef31ee4111073700c93"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a826d7a5a20d56ef31ee4111073700c93">scanInlinedCode</a></div><div class="ttdeci">static void scanInlinedCode(Instruction *Start, Instruction *End, std::vector&lt; CallInst * &gt; &amp;Calls, DenseSet&lt; BasicBlock * &gt; &amp;Seen)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00295">PlaceSafepoints.cpp:295</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a80d7048687367a15d267ac5418b8a168"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a80d7048687367a15d267ac5418b8a168">llvm::ScalarEvolution::getConstantMaxBackedgeTakenCount</a></div><div class="ttdeci">const SCEV * getConstantMaxBackedgeTakenCount(const Loop *L)</div><div class="ttdoc">When successful, this returns a SCEVConstant that is greater than or equal to (i.e.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00898">ScalarEvolution.h:898</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26e2a938b431eaa6eca2beaa96410c9d"><div class="ttname"><a href="namespacellvm.html#a26e2a938b431eaa6eca2beaa96410c9d">llvm::successors</a></div><div class="ttdeci">auto successors(const MachineBasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01265">MachineBasicBlock.h:1265</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab5a3ac0a249da0743dac1bd816d8e5d5"><div class="ttname"><a href="namespacellvm.html#ab5a3ac0a249da0743dac1bd816d8e5d5">llvm::InlineFunction</a></div><div class="ttdeci">InlineResult InlineFunction(CallBase &amp;CB, InlineFunctionInfo &amp;IFI, bool MergeAttributes=false, AAResults *CalleeAAR=nullptr, bool InsertLifetime=true, Function *ForwardVarArgsTo=nullptr)</div><div class="ttdoc">This function inlines the called function into the basic block of the caller.</div><div class="ttdef"><b>Definition:</b> <a href="InlineFunction_8cpp_source.html#l02008">InlineFunction.cpp:2008</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector</a></div><div class="ttdoc">This is a 'vector' (really, a variable-sized array), optimized for the case when the array is small.</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l01199">SmallVector.h:1199</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_aebfacb04097b46feb1abd790cfd22658"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#aebfacb04097b46feb1abd790cfd22658">Safepoints</a></div><div class="ttdeci">place backedge safepoints Place Backedge Safepoints</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00614">PlaceSafepoints.cpp:614</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_ab29b055d837246403b4f421b83f00f3c"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#ab29b055d837246403b4f421b83f00f3c">SplitBackedge</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; SplitBackedge(&quot;spp-split-backedge&quot;, cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_aadc3e7f994eca45872ac1c256b4ebbc5"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#aadc3e7f994eca45872ac1c256b4ebbc5">NoBackedge</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; NoBackedge(&quot;spp-no-backedge&quot;, cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="anamespacellvm_html_ae324659e4fe9aeb904f0dbc60343a367"><div class="ttname"><a href="namespacellvm.html#ae324659e4fe9aeb904f0dbc60343a367">llvm::createPlaceSafepointsPass</a></div><div class="ttdeci">FunctionPass * createPlaceSafepointsPass()</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00602">PlaceSafepoints.cpp:602</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html">llvm::ScalarEvolution</a></div><div class="ttdoc">The main scalar evolution driver.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00452">ScalarEvolution.h:452</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_a7e89b55242c964ae61b7850e99cacef0"><div class="ttname"><a href="classllvm_1_1FunctionType.html#a7e89b55242c964ae61b7850e99cacef0">llvm::FunctionType::get</a></div><div class="ttdeci">static FunctionType * get(Type *Result, ArrayRef&lt; Type * &gt; Params, bool isVarArg)</div><div class="ttdoc">This static method is the primary way of constructing a FunctionType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00363">Type.cpp:363</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html"><div class="ttname"><a href="classllvm_1_1DominatorTree.html">llvm::DominatorTree</a></div><div class="ttdoc">Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00166">Dominators.h:166</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_ab79294a2bb06a12d7f4dc32f80b8f935"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#ab79294a2bb06a12d7f4dc32f80b8f935">doesNotRequireEntrySafepointBefore</a></div><div class="ttdeci">static bool doesNotRequireEntrySafepointBefore(CallBase *Call)</div><div class="ttdoc">Returns true if an entry safepoint is not required before this callsite in the caller function.</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00363">PlaceSafepoints.cpp:363</a></div></div>
<div class="ttc" id="aScalarEvolution_8h_html"><div class="ttname"><a href="ScalarEvolution_8h.html">ScalarEvolution.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_aec88b7682025edff7984c3b6c8da8ac9"><div class="ttname"><a href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">llvm::removeUnreachableBlocks</a></div><div class="ttdeci">bool removeUnreachableBlocks(Function &amp;F, DomTreeUpdater *DTU=nullptr, MemorySSAUpdater *MSSAU=nullptr)</div><div class="ttdoc">Remove all blocks that can not be reached from the function's entry.</div><div class="ttdef"><b>Definition:</b> <a href="Transforms_2Utils_2Local_8cpp_source.html#l02614">Local.cpp:2614</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1LoopInfoWrapperPass.html">llvm::LoopInfoWrapperPass</a></div><div class="ttdoc">The legacy pass manager's analysis pass to compute loop information.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01293">LoopInfo.h:1293</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_a4344e66fb61ea313a85a9e054124ac55"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#a4344e66fb61ea313a85a9e054124ac55">llvm::DominatorTreeBase::getNode</a></div><div class="ttdeci">DomTreeNodeBase&lt; NodeT &gt; * getNode(const NodeT *BB) const</div><div class="ttdoc">getNode - return the (Post)DominatorTree node for the specified basic block.</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00367">GenericDomTree.h:367</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a382f84ef1b61ce7798e971d73d497a0b"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a382f84ef1b61ce7798e971d73d497a0b">STATISTIC</a></div><div class="ttdeci">STATISTIC(NumEntrySafepoints, &quot;Number of entry safepoints inserted&quot;)</div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_abd1ccb1bf511e1965414eb1d2e137302"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#abd1ccb1bf511e1965414eb1d2e137302">impl</a></div><div class="ttdeci">place backedge safepoints impl</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00613">PlaceSafepoints.cpp:613</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html_aa22cb3ff8c95bb05185acad8c569d4b6"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html#aa22cb3ff8c95bb05185acad8c569d4b6">llvm::DomTreeNodeBase::getIDom</a></div><div class="ttdeci">DomTreeNodeBase * getIDom() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00090">GenericDomTree.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1detail_1_1DenseSetImpl_html_a79eed48913651aeedda2eed25201ea84"><div class="ttname"><a href="classllvm_1_1detail_1_1DenseSetImpl.html#a79eed48913651aeedda2eed25201ea84">llvm::detail::DenseSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const ValueT &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="DenseSet_8h_source.html#l00206">DenseSet.h:206</a></div></div>
<div class="ttc" id="aLegacyPassManager_8h_html"><div class="ttname"><a href="LegacyPassManager_8h.html">LegacyPassManager.h</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_ade6d0f7cc42acd42e21c6154bd713afa"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#ade6d0f7cc42acd42e21c6154bd713afa">enableBackedgeSafepoints</a></div><div class="ttdeci">static bool enableBackedgeSafepoints(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00463">PlaceSafepoints.cpp:463</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00055">BasicBlock.h:55</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_a7ef4d3003047043a3de118adbb0570fd"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#a7ef4d3003047043a3de118adbb0570fd">a</a></div><div class="ttdeci">=0.0 ? 0.0 :(a &gt; 0.0 ? 1.0 :-1.0) a</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00489">README.txt:489</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a0d2900c2047fa60ef8138dae263123ff"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a0d2900c2047fa60ef8138dae263123ff">GCSafepointPollName</a></div><div class="ttdeci">const char GCSafepointPollName[]</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00439">PlaceSafepoints.cpp:439</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTree_html_a5c69311e8d44898dac36a155c3d8691d"><div class="ttname"><a href="classllvm_1_1DominatorTree.html#a5c69311e8d44898dac36a155c3d8691d">llvm::DominatorTree::dominates</a></div><div class="ttdeci">bool dominates(const BasicBlock *BB, const Use &amp;U) const</div><div class="ttdoc">Return true if the (end of the) basic block BB dominates the use U.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8cpp_source.html#l00122">Dominators.cpp:122</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_ae18fd29bd3983963ebc7076104d82c3e"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#ae18fd29bd3983963ebc7076104d82c3e">safepoints</a></div><div class="ttdeci">place backedge safepoints Place Backedge false place safepoints</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00618">PlaceSafepoints.cpp:618</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a798de004bec543c0f9059f8c5fc78f92"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a798de004bec543c0f9059f8c5fc78f92">needsStatepoint</a></div><div class="ttdeci">static bool needsStatepoint(CallBase *Call, const TargetLibraryInfo &amp;TLI)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00185">PlaceSafepoints.cpp:185</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a542a6493b191eb84b5457d35ecd685c5"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a542a6493b191eb84b5457d35ecd685c5">llvm::LoopBase::getLoopLatches</a></div><div class="ttdeci">void getLoopLatches(SmallVectorImpl&lt; BlockT * &gt; &amp;LoopLatches) const</div><div class="ttdoc">Return all loop latch blocks of this loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00351">LoopInfo.h:351</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a0ed5f3ab3c2e4196ee0cffffa080c062"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a0ed5f3ab3c2e4196ee0cffffa080c062">llvm::BasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Instruction iterator methods.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00314">BasicBlock.h:314</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_a850d8262cd900958b3153c4aa080b2bb"><div class="ttname"><a href="classllvm_1_1CallInst.html#a850d8262cd900958b3153c4aa080b2bb">llvm::CallInst::Create</a></div><div class="ttdeci">static CallInst * Create(FunctionType *Ty, Value *F, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01528">Instructions.h:1528</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="alib_2Target_2ARM_2README_8txt_html_acdf5bf3bbc10f9331f56441a4d483bb1"><div class="ttname"><a href="lib_2Target_2ARM_2README_8txt.html#acdf5bf3bbc10f9331f56441a4d483bb1">b</a></div><div class="ttdeci">the resulting code requires compare and branches when and if the revised code is with conditional branches instead of More there is a byte word extend before each where there should be only and the condition codes are not remembered when the same two values are compared twice More LSR enhancements i8 and i32 load store addressing modes are identical int b</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2ARM_2README_8txt_source.html#l00418">README.txt:418</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00141">StackSlotColoring.cpp:141</a></div></div>
<div class="ttc" id="anamespacellvm_html_affedc93ead6b25c57a7196d32ff11e89"><div class="ttname"><a href="namespacellvm.html#affedc93ead6b25c57a7196d32ff11e89">llvm::isPotentiallyReachable</a></div><div class="ttdeci">bool isPotentiallyReachable(const Instruction *From, const Instruction *To, const SmallPtrSetImpl&lt; BasicBlock * &gt; *ExclusionSet=nullptr, const DominatorTree *DT=nullptr, const LoopInfo *LI=nullptr)</div><div class="ttdoc">Determine whether instruction 'To' is reachable from 'From', without passing through any blocks in Ex...</div><div class="ttdef"><b>Definition:</b> <a href="CFG_8cpp_source.html#l00231">CFG.cpp:231</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00041">Instruction.h:41</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantRange_html_ab7f67c2ed8b2799c64ec64ca31d75c60"><div class="ttname"><a href="classllvm_1_1ConstantRange.html#ab7f67c2ed8b2799c64ec64ca31d75c60">llvm::ConstantRange::getUnsignedMax</a></div><div class="ttdeci">APInt getUnsignedMax() const</div><div class="ttdoc">Return the largest unsigned value contained in the ConstantRange.</div><div class="ttdef"><b>Definition:</b> <a href="ConstantRange_8cpp_source.html#l00422">ConstantRange.cpp:422</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeWrapperPass_html"><div class="ttname"><a href="classllvm_1_1DominatorTreeWrapperPass.html">llvm::DominatorTreeWrapperPass</a></div><div class="ttdoc">Legacy analysis pass which computes a DominatorTree.</div><div class="ttdef"><b>Definition:</b> <a href="Dominators_8h_source.html#l00314">Dominators.h:314</a></div></div>
<div class="ttc" id="aLoopDeletion_8cpp_html_a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64"><div class="ttname"><a href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">LoopDeletionResult::Modified</a></div><div class="ttdeci">@ Modified</div></div>
<div class="ttc" id="aclassllvm_1_1InlineResult_html_af279070ae6350a3acd0e80ba7da7d397"><div class="ttname"><a href="classllvm_1_1InlineResult.html#af279070ae6350a3acd0e80ba7da7d397">llvm::InlineResult::isSuccess</a></div><div class="ttdeci">bool isSuccess() const</div><div class="ttdef"><b>Definition:</b> <a href="InlineCost_8h_source.html#l00188">InlineCost.h:188</a></div></div>
<div class="ttc" id="aclassllvm_1_1APInt_html_ae00c35cb040107c05f3fe00c15bb3da0"><div class="ttname"><a href="classllvm_1_1APInt.html#ae00c35cb040107c05f3fe00c15bb3da0">llvm::APInt::isIntN</a></div><div class="ttdeci">bool isIntN(unsigned N) const</div><div class="ttdoc">Check if this APInt has an N-bits unsigned integer value.</div><div class="ttdef"><b>Definition:</b> <a href="APInt_8h_source.html#l00424">APInt.h:424</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolutionWrapperPass_html"><div class="ttname"><a href="classllvm_1_1ScalarEvolutionWrapperPass.html">llvm::ScalarEvolutionWrapperPass</a></div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l02249">ScalarEvolution.h:2249</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a61ab641b03f16e1f3ad916913ce89903"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a61ab641b03f16e1f3ad916913ce89903">isGCSafepointPoll</a></div><div class="ttdeci">static bool isGCSafepointPoll(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00441">PlaceSafepoints.cpp:441</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a134ffba8da3505dfab10eef1a9a8b1ef"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a134ffba8da3505dfab10eef1a9a8b1ef">place</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM ID Predecessors according to mbb&lt; bb27, 0x8b0a7c0 &gt; Note ADDri is not a two address instruction its result reg1037 is an operand of the PHI node in bb76 and its operand reg1039 is the result of the PHI node We should treat it as a two address code and make sure the ADDri is scheduled after any node that reads reg1039 Use info(i.e. register scavenger) to assign it a free register to allow reuse the collector could move the objects and invalidate the derived pointer This is bad enough in the first place</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00050">README.txt:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_aaf9ee38b9973681c1720aaf03af3a069"><div class="ttname"><a href="classllvm_1_1SetVector.html#aaf9ee38b9973681c1720aaf03af3a069">llvm::SetVector::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">Determine if the SetVector is empty or not.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00072">SetVector.h:72</a></div></div>
<div class="ttc" id="aStatepoint_8h_html"><div class="ttname"><a href="Statepoint_8h.html">Statepoint.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00059">PassSupport.h:59</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a74cdbd1e4f731e7d7cd83461b8b1de0b"><div class="ttname"><a href="namespacellvm.html#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a></div><div class="ttdeci">void sort(IteratorTy Start, IteratorTy End)</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01683">STLExtras.h:1683</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseSet_html"><div class="ttname"><a href="classllvm_1_1DenseSet.html">llvm::DenseSet&lt; BasicBlock * &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt&lt; bool &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1SCEV_html"><div class="ttname"><a href="classllvm_1_1SCEV.html">llvm::SCEV</a></div><div class="ttdoc">This class represents an analyzed expression in the program.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00075">ScalarEvolution.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1DomTreeNodeBase_html_a6a15a030098342e06ea73e1241d614c9"><div class="ttname"><a href="classllvm_1_1DomTreeNodeBase.html#a6a15a030098342e06ea73e1241d614c9">llvm::DomTreeNodeBase::getBlock</a></div><div class="ttdeci">NodeT * getBlock() const</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00089">GenericDomTree.h:89</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_afe210701ce0a3abfea9278d2538a6470"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#afe210701ce0a3abfea9278d2538a6470">scanOneBB</a></div><div class="ttdeci">static void scanOneBB(Instruction *Start, Instruction *End, std::vector&lt; CallInst * &gt; &amp;Calls, DenseSet&lt; BasicBlock * &gt; &amp;Seen, std::vector&lt; BasicBlock * &gt; &amp;Worklist)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00268">PlaceSafepoints.cpp:268</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfoWrapperPass.html">llvm::TargetLibraryInfoWrapperPass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00565">TargetLibraryInfo.h:565</a></div></div>
<div class="ttc" id="aAArch64PromoteConstant_8cpp_html_a90f8350fecae261c25be85d38b451bff"><div class="ttname"><a href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a></div><div class="ttdeci">aarch64 promote const</div><div class="ttdef"><b>Definition:</b> <a href="AArch64PromoteConstant_8cpp_source.html#l00232">AArch64PromoteConstant.cpp:232</a></div></div>
<div class="ttc" id="aSVEIntrinsicOpts_8cpp_html_a2bb87eb1bcbc74783a83ae945eb8fa36"><div class="ttname"><a href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(DominatorTreeWrapperPass)</div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_aaf7575d42eea6fea092cba5fc736b69c"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#aaf7575d42eea6fea092cba5fc736b69c">AllBackedges</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; AllBackedges(&quot;spp-all-backedges&quot;, cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aCloning_8h_html"><div class="ttname"><a href="Cloning_8h.html">Cloning.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_a7593d52f91ebe342de9fa72846ebe755"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#a7593d52f91ebe342de9fa72846ebe755">llvm::ScalarEvolution::getUnsignedRange</a></div><div class="ttdeci">ConstantRange getUnsignedRange(const SCEV *S)</div><div class="ttdoc">Determine the unsigned range for a particular SCEV.</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8h_source.html#l00964">ScalarEvolution.h:964</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a2003053288ba4f0e1cd9ebf82b6a1987"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a2003053288ba4f0e1cd9ebf82b6a1987">mustBeFiniteCountedLoop</a></div><div class="ttdeci">static bool mustBeFiniteCountedLoop(Loop *L, ScalarEvolution *SE, BasicBlock *Pred)</div><div class="ttdoc">Returns true if this loop is known to terminate in a finite number of iterations.</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00243">PlaceSafepoints.cpp:243</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html_a72d928b7fc2c5f2d56c6ac0265fd9c6e"><div class="ttname"><a href="classllvm_1_1SetVector.html#a72d928b7fc2c5f2d56c6ac0265fd9c6e">llvm::SetVector::insert</a></div><div class="ttdeci">bool insert(const value_type &amp;X)</div><div class="ttdoc">Insert a new element into the SetVector.</div><div class="ttdef"><b>Definition:</b> <a href="SetVector_8h_source.html#l00141">SetVector.h:141</a></div></div>
<div class="ttc" id="aAnalysis_2CFG_8h_html"><div class="ttname"><a href="Analysis_2CFG_8h.html">CFG.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1DominatorTreeBase_html_aa0641ae965656ff9988d67a35140e4d9"><div class="ttname"><a href="classllvm_1_1DominatorTreeBase.html#aa0641ae965656ff9988d67a35140e4d9">llvm::DominatorTreeBase::recalculate</a></div><div class="ttdeci">void recalculate(ParentType &amp;Func)</div><div class="ttdoc">recalculate - compute a dominator tree for the given function</div><div class="ttdef"><b>Definition:</b> <a href="GenericDomTree_8h_source.html#l00795">GenericDomTree.h:795</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopInfo_html"><div class="ttname"><a href="classllvm_1_1LoopInfo.html">llvm::LoopInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l01108">LoopInfo.h:1108</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a1a98793f564d1eb27533846241e7eba2"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a1a98793f564d1eb27533846241e7eba2">InsertSafepointPoll</a></div><div class="ttdeci">static void InsertSafepointPoll(Instruction *InsertBefore, std::vector&lt; CallBase * &gt; &amp;ParsePointsNeeded, const TargetLibraryInfo &amp;TLI)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00622">PlaceSafepoints.cpp:622</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a74aa9daea070e2ad3394a3ec58b7316a"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a74aa9daea070e2ad3394a3ec58b7316a">llvm::BasicBlock::getUniquePredecessor</a></div><div class="ttdeci">const BasicBlock * getUniquePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a unique predecessor block.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00292">BasicBlock.cpp:292</a></div></div>
<div class="ttc" id="anamespacellvm_html_a39d3d23a084c4544ee5903203db10e8a"><div class="ttname"><a href="namespacellvm.html#a39d3d23a084c4544ee5903203db10e8a">llvm::append_range</a></div><div class="ttdeci">void append_range(Container &amp;C, Range &amp;&amp;R)</div><div class="ttdoc">Wrapper function to append a range to a container.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l02014">STLExtras.h:2014</a></div></div>
<div class="ttc" id="anamespacellvm_html_a92be87f8a371f277f7260fb99592d5f4"><div class="ttname"><a href="namespacellvm.html#a92be87f8a371f277f7260fb99592d5f4">llvm::unique</a></div><div class="ttdeci">auto unique(Range &amp;&amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="GenericUniformityImpl_8h_source.html#l00056">GenericUniformityImpl.h:56</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a737f3181d1ae8ed5fe159b4003d024d1"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a737f3181d1ae8ed5fe159b4003d024d1">shouldRewriteFunction</a></div><div class="ttdeci">static bool shouldRewriteFunction(Function &amp;F)</div><div class="ttdoc">Returns true if this function should be rewritten to include safepoint polls and parseable call sites...</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00448">PlaceSafepoints.cpp:448</a></div></div>
<div class="ttc" id="aEntryExitInstrumenter_8cpp_html_a3985f1f39349428d17f0d2b81ebc6349"><div class="ttname"><a href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a></div><div class="ttdeci">static bool runOnFunction(Function &amp;F, bool PostInlining)</div><div class="ttdef"><b>Definition:</b> <a href="EntryExitInstrumenter_8cpp_source.html#l00085">EntryExitInstrumenter.cpp:85</a></div></div>
<div class="ttc" id="anamespacellvm_html_adf83581f514774264d616eef5706cf6e"><div class="ttname"><a href="namespacellvm.html#adf83581f514774264d616eef5706cf6e">llvm::SplitEdge</a></div><div class="ttdeci">BasicBlock * SplitEdge(BasicBlock *From, BasicBlock *To, DominatorTree *DT=nullptr, LoopInfo *LI=nullptr, MemorySSAUpdater *MSSAU=nullptr, const Twine &amp;BBName=&quot;&quot;)</div><div class="ttdoc">Split the edge connecting the specified blocks, and return the newly created basic block between From...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlockUtils_8cpp_source.html#l00615">BasicBlockUtils.cpp:615</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_afb263d90c05a5bc6b0c3fa2c9aeefaba"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#afb263d90c05a5bc6b0c3fa2c9aeefaba">findLocationForEntrySafepoint</a></div><div class="ttdeci">static Instruction * findLocationForEntrySafepoint(Function &amp;F, DominatorTree &amp;DT)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00386">PlaceSafepoints.cpp:386</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="BitVector_8h_source.html#l00851">BitVector.h:851</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a3a3b930c659333a27bb598ea5960fe52"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a3a3b930c659333a27bb598ea5960fe52">enableCallSafepoints</a></div><div class="ttdeci">static bool enableCallSafepoints(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00464">PlaceSafepoints.cpp:464</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_af22b06a6a4f9df80454071685a0d6a02"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af22b06a6a4f9df80454071685a0d6a02">llvm::AnalysisUsage::setPreservesAll</a></div><div class="ttdeci">void setPreservesAll()</div><div class="ttdoc">Set by analyses that do not transform their input at all.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00130">PassAnalysisSupport.h:130</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_a58c5b170ea68b41e94ebb0019523a68f"><div class="ttname"><a href="classllvm_1_1LoopBase.html#a58c5b170ea68b41e94ebb0019523a68f">llvm::LoopBase::getHeader</a></div><div class="ttdeci">BlockT * getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00105">LoopInfo.h:105</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdoc">Provides information about what library functions are available for the current target.</div><div class="ttdef"><b>Definition:</b> <a href="TargetLibraryInfo_8h_source.html#l00234">TargetLibraryInfo.h:234</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_aa2cbc07e426705bbdb98c0f6ae7e3f72"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#aa2cbc07e426705bbdb98c0f6ae7e3f72">containsUnconditionalCallSafepoint</a></div><div class="ttdeci">static bool containsUnconditionalCallSafepoint(Loop *L, BasicBlock *Header, BasicBlock *Pred, DominatorTree &amp;DT, const TargetLibraryInfo &amp;TLI)</div><div class="ttdoc">Returns true if this loop is known to contain a call safepoint which must unconditionally execute on ...</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00201">PlaceSafepoints.cpp:201</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineFunctionInfo_html"><div class="ttname"><a href="classllvm_1_1InlineFunctionInfo.html">llvm::InlineFunctionInfo</a></div><div class="ttdoc">This class captures the data input to the InlineFunction call, and records the auxiliary results prod...</div><div class="ttdef"><b>Definition:</b> <a href="Cloning_8h_source.html#l00203">Cloning.h:203</a></div></div>
<div class="ttc" id="anamespacellvm_html_a1c1822164a9db3fdad04d73d558f31ad"><div class="ttname"><a href="namespacellvm.html#a1c1822164a9db3fdad04d73d558f31ad">llvm::initializePlaceSafepointsPass</a></div><div class="ttdeci">void initializePlaceSafepointsPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00047">IntrinsicInst.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a6e20e76960d952de088354cbcd14c3ab"><div class="ttname"><a href="classllvm_1_1Type.html#a6e20e76960d952de088354cbcd14c3ab">llvm::Type::getVoidTy</a></div><div class="ttdeci">static Type * getVoidTy(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00224">Type.cpp:224</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineFunctionInfo_html_a9c259c76065eb3b4ce3697ce346008ce"><div class="ttname"><a href="classllvm_1_1InlineFunctionInfo.html#a9c259c76065eb3b4ce3697ce346008ce">llvm::InlineFunctionInfo::StaticAllocas</a></div><div class="ttdeci">SmallVector&lt; AllocaInst *, 4 &gt; StaticAllocas</div><div class="ttdoc">InlineFunction fills this in with all static allocas that get copied into the caller.</div><div class="ttdef"><b>Definition:</b> <a href="Cloning_8h_source.html#l00224">Cloning.h:224</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a7d9efdccecd366fc94d04a5f79e6e9c9"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a7d9efdccecd366fc94d04a5f79e6e9c9">CountedLoopTripWidth</a></div><div class="ttdeci">static cl::opt&lt; int &gt; CountedLoopTripWidth(&quot;spp-counted-loop-trip-width&quot;, cl::Hidden, cl::init(32))</div><div class="ttdoc">How narrow does the trip count of a loop have to be to have to be considered &quot;counted&quot;?...</div></div>
<div class="ttc" id="aclassllvm_1_1legacy_1_1FunctionPassManager_html"><div class="ttname"><a href="classllvm_1_1legacy_1_1FunctionPassManager.html">llvm::legacy::FunctionPassManager</a></div><div class="ttdoc">FunctionPassManager manages FunctionPasses.</div><div class="ttdef"><b>Definition:</b> <a href="LegacyPassManager_8h_source.html#l00071">LegacyPassManager.h:71</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a8de021e28a3c04c9216ad8decf104f02"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a8de021e28a3c04c9216ad8decf104f02">llvm::BasicBlock::getTerminator</a></div><div class="ttdeci">const Instruction * getTerminator() const LLVM_READONLY</div><div class="ttdoc">Returns the terminator instruction if the block is well formed or null if the block is not well forme...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00127">BasicBlock.h:127</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01184">InstrTypes.h:1184</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a9b667969c754fdd7469fe3e87b50383f"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a9b667969c754fdd7469fe3e87b50383f">NoEntry</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; NoEntry(&quot;spp-no-entry&quot;, cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00308">Pass.h:308</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoopBase_html_af691775d5a45e28afbdb3e97cab22eee"><div class="ttname"><a href="classllvm_1_1LoopBase.html#af691775d5a45e28afbdb3e97cab22eee">llvm::LoopBase::isLoopExiting</a></div><div class="ttdeci">bool isLoopExiting(const BlockT *BB) const</div><div class="ttdoc">True if terminator in the block can branch to another block that is outside of the current loop.</div><div class="ttdef"><b>Definition:</b> <a href="LoopInfo_8h_source.html#l00242">LoopInfo.h:242</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l01485">Instructions.h:1485</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1M68kBeads_html_a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd"><div class="ttname"><a href="namespacellvm_1_1M68kBeads.html#a7eeab1fe8f39bf89dcd7929b816ebfcca27d0e059322508a76f918503800ef1bd">llvm::M68kBeads::Term</a></div><div class="ttdeci">@ Term</div><div class="ttdef"><b>Definition:</b> <a href="M68kBaseInfo_8h_source.html#l00090">M68kBaseInfo.h:90</a></div></div>
<div class="ttc" id="aclassllvm_1_1SetVector_html"><div class="ttname"><a href="classllvm_1_1SetVector.html">llvm::SetVector&lt; BasicBlock * &gt;</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a8896fe5c638a7d7b20f5fa9393b22f32"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a8896fe5c638a7d7b20f5fa9393b22f32">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(PlaceBackedgeSafepointsImpl, &quot;place-backedge-safepoints-impl&quot;, &quot;Place Backedge Safepoints&quot;, false, false) INITIALIZE_PASS_END(PlaceBackedgeSafepointsImpl</div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a833913085fae7762e1bbc4480c34e565"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a833913085fae7762e1bbc4480c34e565">NoCall</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; NoCall(&quot;spp-no-call&quot;, cl::Hidden, cl::init(false))</div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1ScalarEvolution_html_ab24add5df0874cdfa47b47b1d9926e9e"><div class="ttname"><a href="classllvm_1_1ScalarEvolution.html#ab24add5df0874cdfa47b47b1d9926e9e">llvm::ScalarEvolution::getExitCount</a></div><div class="ttdeci">const SCEV * getExitCount(const Loop *L, const BasicBlock *ExitingBlock, ExitCountKind Kind=Exact)</div><div class="ttdoc">Return the number of times the backedge executes before the given exit would be taken; if not exactly...</div><div class="ttdef"><b>Definition:</b> <a href="ScalarEvolution_8cpp_source.html#l08311">ScalarEvolution.cpp:8311</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aSetVector_8h_html"><div class="ttname"><a href="SetVector_8h.html">SetVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae186267c792346b2259084106ac18aa9"><div class="ttname"><a href="namespacellvm.html#ae186267c792346b2259084106ac18aa9">llvm::initializePlaceBackedgeSafepointsImplPass</a></div><div class="ttdeci">void initializePlaceBackedgeSafepointsImplPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aPlaceSafepoints_8cpp_html_a4021e064e9d2a5e5762d1d4a1dcd7db9"><div class="ttname"><a href="PlaceSafepoints_8cpp.html#a4021e064e9d2a5e5762d1d4a1dcd7db9">enableEntrySafepoints</a></div><div class="ttdeci">static bool enableEntrySafepoints(Function &amp;F)</div><div class="ttdef"><b>Definition:</b> <a href="PlaceSafepoints_8cpp_source.html#l00462">PlaceSafepoints.cpp:462</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:34:40 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
