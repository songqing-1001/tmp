<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Target/AArch64/AArch64LoadStoreOptimizer.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">17.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_794e483eb1cc7921d35fd149d9cc325b.html">Target</a></li><li class="navelem"><a class="el" href="dir_b69b85499a0be7bec9dbd65569a12909.html">AArch64</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AArch64LoadStoreOptimizer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AArch64LoadStoreOptimizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- AArch64LoadStoreOptimizer.cpp - AArch64 load/store opt. pass -------===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This file contains a pass that performs load / store related peephole</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// optimizations. This pass should be run after register allocation.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// The pass runs after the PrologEpilogInserter where we emit the CFI</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// instructions. In order to preserve the correctness of the unwind informaiton,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// the pass should not change the order of any two instructions, one of which</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// has the FrameSetup/FrameDestroy flag or, alternatively, apply an add-hoc fix</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// to unwind information.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64InstrInfo_8h.html">AArch64InstrInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64MachineFunctionInfo_8h.html">AArch64MachineFunctionInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64Subtarget_8h.html">AArch64Subtarget.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AArch64AddressingModes_8h.html">MCTargetDesc/AArch64AddressingModes.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BitVector_8h.html">llvm/ADT/BitVector.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="iterator__range_8h.html">llvm/ADT/iterator_range.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AliasAnalysis_8h.html">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineBasicBlock_8h.html">llvm/CodeGen/MachineBasicBlock.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunction_8h.html">llvm/CodeGen/MachineFunction.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineFunctionPass_8h.html">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstr_8h.html">llvm/CodeGen/MachineInstr.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineInstrBuilder_8h.html">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineOperand_8h.html">llvm/CodeGen/MachineOperand.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MachineRegisterInfo_8h.html">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetRegisterInfo_8h.html">llvm/CodeGen/TargetRegisterInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DebugLoc_8h.html">llvm/IR/DebugLoc.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MCAsmInfo_8h.html">llvm/MC/MCAsmInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MCDwarf_8h.html">llvm/MC/MCDwarf.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MCRegisterInfo_8h.html">llvm/MC/MCRegisterInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DebugCounter_8h.html">llvm/Support/DebugCounter.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Support_2ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   57</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;aarch64-ldst-opt&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumPairCreated, <span class="stringliteral">&quot;Number of load/store pair instructions generated&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumPostFolded, <span class="stringliteral">&quot;Number of post-index updates folded&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumPreFolded, <span class="stringliteral">&quot;Number of pre-index updates folded&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumUnscaledPairCreated,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          <span class="stringliteral">&quot;Number of load/store from unscaled generated&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumZeroStoresPromoted, <span class="stringliteral">&quot;Number of narrow zero stores promoted&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<a class="code" href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">STATISTIC</a>(NumLoadsFromStoresPromoted, <span class="stringliteral">&quot;Number of loads from stores promoted&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#acc2131ae9988ee48d2c8d53735dd537b">DEBUG_COUNTER</a>(RegRenamingCounter, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a> <span class="stringliteral">&quot;-reg-renaming&quot;</span>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;              <span class="stringliteral">&quot;Controls which pairs are considered for renaming&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// The LdStLimit limits how far we search for load/store pairs.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a651f363be7841a2d798ed393b7d01a7d">LdStLimit</a>(<span class="stringliteral">&quot;aarch64-load-store-scan-limit&quot;</span>,</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                   <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(20), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// The UpdateLimit limits how far we search for update instructions when we form</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// pre-/post-index instructions.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#adf93253be357fe9cc086b28ae4b98841">UpdateLimit</a>(<span class="stringliteral">&quot;aarch64-update-scan-limit&quot;</span>, <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(100),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                     <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// Enable register renaming to find additional store pairing opportunities.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a297bc50d0b309b05e88b37479f9d6973">EnableRenaming</a>(<span class="stringliteral">&quot;aarch64-load-store-renaming&quot;</span>,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                    <a class="code" href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">cl::init</a>(<span class="keyword">true</span>), <a class="code" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a6fb7e237b1b1fe47144da84e1c2fd5b4">   83</a></span>&#160;<span class="preprocessor">#define AARCH64_LOAD_STORE_OPT_NAME &quot;AArch64 load / store optimization pass&quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">using</span> LdStPairFlags = <span class="keyword">struct </span>LdStPairFlags {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// If a matching instruction is found, MergeForward is set to true if the</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// merge is to remove the first instruction and replace the second with</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// a pair-wise insn, and false if the reverse is true.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">bool</span> MergeForward = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// SExtIdx gives the index of the result of the load pair that must be</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// extended. The value of SExtIdx assumes that the paired load produces the</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// value in this order: (I, returned iterator), i.e., -1 means no value has</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// to be extended, 0 means I, and 1 means the returned iterator.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">int</span> SExtIdx = -1;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// If not none, RenameReg can be used to rename the result register of the</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// first store in a pair. Currently this only works when merging stores</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">// forward.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  std::optional&lt;MCPhysReg&gt; RenameReg;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  LdStPairFlags() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">void</span> setMergeForward(<span class="keywordtype">bool</span> V = <span class="keyword">true</span>) { MergeForward = V; }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">bool</span> getMergeForward()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> MergeForward; }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">void</span> setSExtIdx(<span class="keywordtype">int</span> V) { SExtIdx = V; }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">int</span> getSExtIdx()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> SExtIdx; }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">void</span> setRenameReg(<a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> R) { RenameReg = R; }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">void</span> clearRenameReg() { RenameReg = std::nullopt; }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  std::optional&lt;MCPhysReg&gt; getRenameReg()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> RenameReg; }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;};</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">struct </span>AArch64LoadStoreOpt : <span class="keyword">public</span> <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a> {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  AArch64LoadStoreOpt() : <a class="code" href="classllvm_1_1MachineFunctionPass.html">MachineFunctionPass</a>(<a class="code" href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">ID</a>) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="namespacellvm.html#ac984e10b62f9eb21b5ffdd07c1a12fb2">initializeAArch64LoadStoreOptPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="classllvm_1_1AAResults.html">AliasAnalysis</a> *AA;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64InstrInfo.html">AArch64InstrInfo</a> *<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a> *Subtarget;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// Track which register units have been modified and used.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="classllvm_1_1LiveRegUnits.html">LiveRegUnits</a> ModifiedRegUnits, UsedRegUnits;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="classllvm_1_1LiveRegUnits.html">LiveRegUnits</a> DefinedInBB;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1AAResultsWrapperPass.html">AAResultsWrapperPass</a>&gt;();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="classllvm_1_1MachineFunctionPass.html#a864fd57b4304ef933b3281d0ef85a88e">MachineFunctionPass::getAnalysisUsage</a>(AU);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// Scan the instructions looking for a load/store that can be combined</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// with the current instruction into a load/store pair.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// Return the matching instruction if one is found, else MBB-&gt;end().</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> findMatchingInsn(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                               LdStPairFlags &amp;Flags,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                               <span class="keywordtype">unsigned</span> Limit,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                               <span class="keywordtype">bool</span> FindNarrowMerge);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// Scan the instructions looking for a store that writes to the address from</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// which the current load instruction reads. Return true if one is found.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">bool</span> findMatchingStore(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">unsigned</span> Limit,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                         <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;StoreI);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// Merge the two instructions indicated into a wider narrow store instruction.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  mergeNarrowZeroStores(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                        <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> MergeMI,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                        <span class="keyword">const</span> LdStPairFlags &amp;Flags);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// Merge the two instructions indicated into a single pair-wise instruction.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  mergePairedInsns(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                   <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> Paired,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                   <span class="keyword">const</span> LdStPairFlags &amp;Flags);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Promote the load that reads directly from the address stored to.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  promoteLoadFromStore(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> LoadI,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                       <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> StoreI);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// Scan the instruction list to find a base register update that can</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// be combined with the current instruction (a load or store) using</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// pre or post indexed addressing with writeback. Scan forwards.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  findMatchingUpdateInsnForward(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                <span class="keywordtype">int</span> UnscaledOffset, <span class="keywordtype">unsigned</span> Limit);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// Scan the instruction list to find a base register update that can</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// be combined with the current instruction (a load or store) using</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// pre or post indexed addressing with writeback. Scan backwards.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  findMatchingUpdateInsnBackward(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">unsigned</span> Limit);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// Find an instruction that updates the base register of the ld/st</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// instruction.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">bool</span> isMatchingUpdateInsn(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;MemMI, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                            <span class="keywordtype">unsigned</span> BaseReg, <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// Merge a pre- or post-index base register update into a ld/st instruction.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  mergeUpdateInsn(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> Update, <span class="keywordtype">bool</span> IsPreIdx);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// Find and merge zero store instructions.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">bool</span> tryToMergeZeroStInst(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// Find and pair ldr/str instructions.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">bool</span> tryToPairLdStInst(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// Find and promote load instructions which read directly from store.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">bool</span> tryToPromoteLoadFromStore(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// Find and merge a base register updates before or after a ld/st instruction.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">bool</span> tryToMergeLdStUpdate(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="ScalarizeMaskedMemIntrin_8cpp.html#a8f3425131aae6ea2275a052284a7c2dc">optimizeBlock</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, <span class="keywordtype">bool</span> EnableNarrowZeroStOpt);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">bool</span> runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;Fn) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="classllvm_1_1MachineFunctionProperties.html">MachineFunctionProperties</a> getRequiredProperties()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classllvm_1_1MachineFunctionProperties.html">MachineFunctionProperties</a>().<a class="code" href="classllvm_1_1MachineFunctionProperties.html#aa0f2b6097642894ce79ff3e15c896206">set</a>(</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="classllvm_1_1MachineFunctionProperties.html#ad85237c6c667e4713efe8921e9c32ac1a72f7d830dd5ddb30f06d8e9639558ac3">MachineFunctionProperties::Property::NoVRegs</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="classllvm_1_1StringRef.html">StringRef</a> getPassName()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a6fb7e237b1b1fe47144da84e1c2fd5b4">AARCH64_LOAD_STORE_OPT_NAME</a>; }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;};</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">AArch64LoadStoreOpt::ID</a> = 0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a09329b4e0eccb30fbf5726df9320d210">  219</a></span>&#160;<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a09329b4e0eccb30fbf5726df9320d210">INITIALIZE_PASS</a>(AArch64LoadStoreOpt, <span class="stringliteral">&quot;aarch64-ldst-opt&quot;</span>,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a6fb7e237b1b1fe47144da84e1c2fd5b4">AARCH64_LOAD_STORE_OPT_NAME</a>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;static <span class="keywordtype">bool</span> isNarrowStore(<span class="keywordtype">unsigned</span> Opc) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">case</span> AArch64::STRBBui:</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">case</span> AArch64::STURBBi:</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">case</span> AArch64::STRHHui:</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">case</span> AArch64::STURHHi:</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">// These instruction set memory tag and either keep memory contents unchanged or</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">// set it to zero, ignoring the address part of the source register.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a9dc8254630582aab188826a20ce95f36">  236</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a9dc8254630582aab188826a20ce95f36">isTagStore</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode()) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">case</span> AArch64::STGOffset:</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">case</span> AArch64::STZGOffset:</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">case</span> AArch64::ST2GOffset:</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">case</span> AArch64::STZ2GOffset:</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a8a865c8b5d774ded0806c199df5b3c06">  248</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a8a865c8b5d774ded0806c199df5b3c06">getMatchingNonSExtOpcode</a>(<span class="keywordtype">unsigned</span> Opc,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                         <span class="keywordtype">bool</span> *IsValidLdStrOpc = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span> (IsValidLdStrOpc)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    *IsValidLdStrOpc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span> (IsValidLdStrOpc)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      *IsValidLdStrOpc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">std::numeric_limits&lt;unsigned&gt;::max</a>();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDui:</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">case</span> AArch64::STURDi:</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDpre:</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQui:</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">case</span> AArch64::STURQi:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQpre:</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">case</span> AArch64::STRBBui:</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">case</span> AArch64::STURBBi:</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">case</span> AArch64::STRHHui:</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">case</span> AArch64::STURHHi:</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWui:</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWpre:</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">case</span> AArch64::STURWi:</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXui:</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXpre:</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">case</span> AArch64::STURXi:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDui:</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURDi:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDpre:</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQui:</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURQi:</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQpre:</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWui:</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURWi:</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWpre:</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXui:</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURXi:</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXpre:</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSui:</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">case</span> AArch64::STURSi:</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSpre:</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSui:</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURSi:</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSpre:</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> Opc;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSWui:</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRWui;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURSWi:</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">return</span> AArch64::LDURWi;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a834634558d65f592c08010de0e548343">  299</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a834634558d65f592c08010de0e548343">getMatchingWideOpcode</a>(<span class="keywordtype">unsigned</span> Opc) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Opcode has no wide equivalent!&quot;</span>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">case</span> AArch64::STRBBui:</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span> AArch64::STRHHui;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">case</span> AArch64::STRHHui:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> AArch64::STRWui;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">case</span> AArch64::STURBBi:</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">return</span> AArch64::STURHHi;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">case</span> AArch64::STURHHi:</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> AArch64::STURWi;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">case</span> AArch64::STURWi:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> AArch64::STURXi;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWui:</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">return</span> AArch64::STRXui;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a2891bebbb2a99d3d169b71fd68a0cd87">  318</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a2891bebbb2a99d3d169b71fd68a0cd87">getMatchingPairOpcode</a>(<span class="keywordtype">unsigned</span> Opc) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Opcode has no pairwise equivalent!&quot;</span>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSui:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">case</span> AArch64::STURSi:</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> AArch64::STPSi;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSpre:</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span> AArch64::STPSpre;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDui:</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">case</span> AArch64::STURDi:</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> AArch64::STPDi;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDpre:</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span> AArch64::STPDpre;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQui:</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">case</span> AArch64::STURQi:</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> AArch64::STPQi;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQpre:</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">return</span> AArch64::STPQpre;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWui:</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">case</span> AArch64::STURWi:</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">return</span> AArch64::STPWi;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWpre:</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">return</span> AArch64::STPWpre;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXui:</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">case</span> AArch64::STURXi:</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span> AArch64::STPXi;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXpre:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">return</span> AArch64::STPXpre;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSui:</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURSi:</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPSi;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSpre:</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPSpre;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDui:</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURDi:</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPDi;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDpre:</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPDpre;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQui:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURQi:</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPQi;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQpre:</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPQpre;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWui:</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURWi:</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPWi;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWpre:</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPWpre;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXui:</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURXi:</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPXi;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXpre:</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPXpre;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSWui:</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURSWi:</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPSWi;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a9e9873c963a7609d913c3420a97c0595">  378</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a9e9873c963a7609d913c3420a97c0595">isMatchingStore</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">unsigned</span> LdOpc = <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>.<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordtype">unsigned</span> StOpc = <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>.<a class="code" href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">switch</span> (LdOpc) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unsupported load instruction!&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRBBui:</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STRBBui || StOpc == AArch64::STRHHui ||</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;           StOpc == AArch64::STRWui || StOpc == AArch64::STRXui;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURBBi:</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STURBBi || StOpc == AArch64::STURHHi ||</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;           StOpc == AArch64::STURWi || StOpc == AArch64::STURXi;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRHHui:</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STRHHui || StOpc == AArch64::STRWui ||</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;           StOpc == AArch64::STRXui;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURHHi:</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STURHHi || StOpc == AArch64::STURWi ||</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;           StOpc == AArch64::STURXi;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWui:</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STRWui || StOpc == AArch64::STRXui;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURWi:</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STURWi || StOpc == AArch64::STURXi;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXui:</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STRXui;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURXi:</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span> StOpc == AArch64::STURXi;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a6cfadf0d2bf5ec4aa6119d058cf4623a">  408</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a6cfadf0d2bf5ec4aa6119d058cf4623a">getPreIndexedOpcode</a>(<span class="keywordtype">unsigned</span> Opc) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// FIXME: We don&#39;t currently support creating pre-indexed loads/stores when</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// the load or store is the unscaled version.  If we decide to perform such an</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// optimization in the future the cases for the unscaled loads/stores will</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// need to be added here.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Opcode has no pre-indexed equivalent!&quot;</span>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSui:</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span> AArch64::STRSpre;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDui:</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> AArch64::STRDpre;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQui:</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> AArch64::STRQpre;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">case</span> AArch64::STRBBui:</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span> AArch64::STRBBpre;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">case</span> AArch64::STRHHui:</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span> AArch64::STRHHpre;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWui:</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">return</span> AArch64::STRWpre;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXui:</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> AArch64::STRXpre;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSui:</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRSpre;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDui:</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRDpre;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQui:</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRQpre;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRBBui:</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRBBpre;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRHHui:</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRHHpre;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWui:</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRWpre;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXui:</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRXpre;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSWui:</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRSWpre;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPSi:</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPSpre;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPSWi:</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPSWpre;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPDi:</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPDpre;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPQi:</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPQpre;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPWi:</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPWpre;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPXi:</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPXpre;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">case</span> AArch64::STPSi:</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">return</span> AArch64::STPSpre;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">case</span> AArch64::STPDi:</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">return</span> AArch64::STPDpre;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">case</span> AArch64::STPQi:</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">return</span> AArch64::STPQpre;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">case</span> AArch64::STPWi:</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">return</span> AArch64::STPWpre;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordflow">case</span> AArch64::STPXi:</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> AArch64::STPXpre;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">case</span> AArch64::STGOffset:</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> AArch64::STGPreIndex;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">case</span> AArch64::STZGOffset:</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">return</span> AArch64::STZGPreIndex;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">case</span> AArch64::ST2GOffset:</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> AArch64::ST2GPreIndex;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">case</span> AArch64::STZ2GOffset:</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">return</span> AArch64::STZ2GPreIndex;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">case</span> AArch64::STGPi:</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> AArch64::STGPpre;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#ac03c5fd861f5d44077b3201b64495c9f">  481</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#ac03c5fd861f5d44077b3201b64495c9f">getPostIndexedOpcode</a>(<span class="keywordtype">unsigned</span> Opc) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Opcode has no post-indexed wise equivalent!&quot;</span>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSui:</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">case</span> AArch64::STURSi:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> AArch64::STRSpost;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDui:</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">case</span> AArch64::STURDi:</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">return</span> AArch64::STRDpost;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQui:</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">case</span> AArch64::STURQi:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> AArch64::STRQpost;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">case</span> AArch64::STRBBui:</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> AArch64::STRBBpost;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">case</span> AArch64::STRHHui:</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">return</span> AArch64::STRHHpost;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWui:</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">case</span> AArch64::STURWi:</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">return</span> AArch64::STRWpost;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXui:</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">case</span> AArch64::STURXi:</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">return</span> AArch64::STRXpost;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSui:</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURSi:</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRSpost;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDui:</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURDi:</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRDpost;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQui:</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURQi:</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRQpost;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRBBui:</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRBBpost;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRHHui:</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRHHpost;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWui:</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURWi:</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRWpost;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXui:</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURXi:</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRXpost;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSWui:</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">return</span> AArch64::LDRSWpost;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPSi:</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPSpost;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPSWi:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPSWpost;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPDi:</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPDpost;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPQi:</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPQpost;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPWi:</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPWpost;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPXi:</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">return</span> AArch64::LDPXpost;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">case</span> AArch64::STPSi:</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span> AArch64::STPSpost;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">case</span> AArch64::STPDi:</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">return</span> AArch64::STPDpost;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">case</span> AArch64::STPQi:</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">return</span> AArch64::STPQpost;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">case</span> AArch64::STPWi:</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">return</span> AArch64::STPWpost;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">case</span> AArch64::STPXi:</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">return</span> AArch64::STPXpost;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">case</span> AArch64::STGOffset:</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span> AArch64::STGPostIndex;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">case</span> AArch64::STZGOffset:</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">return</span> AArch64::STZGPostIndex;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">case</span> AArch64::ST2GOffset:</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">return</span> AArch64::ST2GPostIndex;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordflow">case</span> AArch64::STZ2GOffset:</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> AArch64::STZ2GPostIndex;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordflow">case</span> AArch64::STGPi:</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">return</span> AArch64::STGPpost;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#aef3719986b91bc4fac189135bd3795a8">  560</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#aef3719986b91bc4fac189135bd3795a8">isPreLdStPairCandidate</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;FirstMI, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordtype">unsigned</span> OpcA = FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordtype">unsigned</span> OpcB = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">switch</span> (OpcA) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSpre:</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::STRSui) || (OpcB == AArch64::STURSi);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDpre:</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::STRDui) || (OpcB == AArch64::STURDi);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQpre:</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::STRQui) || (OpcB == AArch64::STURQi);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWpre:</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::STRWui) || (OpcB == AArch64::STURWi);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXpre:</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::STRXui) || (OpcB == AArch64::STURXi);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSpre:</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::LDRSui) || (OpcB == AArch64::LDURSi);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDpre:</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::LDRDui) || (OpcB == AArch64::LDURDi);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQpre:</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::LDRQui) || (OpcB == AArch64::LDURQi);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWpre:</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::LDRWui) || (OpcB == AArch64::LDURWi);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXpre:</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span> (OpcB == AArch64::LDRXui) || (OpcB == AArch64::LDURXi);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">// Returns the scale and offset range of pre/post indexed variants of MI.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a15d6de941763b0ffe5b5737390f23a57">  592</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a15d6de941763b0ffe5b5737390f23a57">getPrePostIndexedMemOpInfo</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <span class="keywordtype">int</span> &amp;Scale,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                       <span class="keywordtype">int</span> &amp;MinOffset, <span class="keywordtype">int</span> &amp;MaxOffset) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordtype">bool</span> IsPaired = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a6ba8f62a5514943195111193dfd7ae08">AArch64InstrInfo::isPairedLdSt</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordtype">bool</span> IsTagStore = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a9dc8254630582aab188826a20ce95f36">isTagStore</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">// ST*G and all paired ldst have the same scale in pre/post-indexed variants</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">// as in the &quot;unsigned offset&quot; variant.</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// All other pre/post indexed ldst instructions are unscaled.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  Scale = (IsTagStore || IsPaired) ? <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af269ff6efde917e353e6652a11e473ec">AArch64InstrInfo::getMemScale</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) : 1;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">if</span> (IsPaired) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    MinOffset = -64;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    MaxOffset = 63;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    MinOffset = -256;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    MaxOffset = 255;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">  610</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                    <span class="keywordtype">unsigned</span> PairedRegOp = 0) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PairedRegOp &lt; 2 &amp;&amp; <span class="stringliteral">&quot;Unexpected register operand idx.&quot;</span>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordtype">bool</span> IsPreLdSt = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a482f66b2913dcfcc84a4cfeafc83e304">AArch64InstrInfo::isPreLdSt</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">if</span> (IsPreLdSt)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    PairedRegOp += 1;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordtype">unsigned</span> Idx =</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a6ba8f62a5514943195111193dfd7ae08">AArch64InstrInfo::isPairedLdSt</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) || IsPreLdSt ? PairedRegOp : 0;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(Idx);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#ae32b2c05b1bcc5413b940dd7d4d5701e">  621</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#ae32b2c05b1bcc5413b940dd7d4d5701e">isLdOffsetInRangeOfSt</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>,</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64InstrInfo.html">AArch64InstrInfo</a> *<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a9e9873c963a7609d913c3420a97c0595">isMatchingStore</a>(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>) &amp;&amp; <span class="stringliteral">&quot;Expect only matched ld/st.&quot;</span>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordtype">int</span> LoadSize = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordtype">int</span> StoreSize = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordtype">int</span> UnscaledStOffset =</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          ? <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>()</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          : <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() * StoreSize;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordtype">int</span> UnscaledLdOffset =</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          ? <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>()</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;          : <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() * LoadSize;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">return</span> (UnscaledStOffset &lt;= UnscaledLdOffset) &amp;&amp;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         (UnscaledLdOffset + LoadSize &lt;= (UnscaledStOffset + StoreSize));</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">  639</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">isPromotableZeroStoreInst</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordtype">unsigned</span> Opc = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">return</span> (Opc == AArch64::STRWui || Opc == AArch64::STURWi ||</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          isNarrowStore(Opc)) &amp;&amp;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == AArch64::WZR;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a131caae6e5e55eccd4efe928baa973ef">  646</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a131caae6e5e55eccd4efe928baa973ef">isPromotableLoadFromStore</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode()) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">// Scaled instructions.</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRBBui:</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRHHui:</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWui:</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXui:</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="comment">// Unscaled instructions.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURBBi:</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURHHi:</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURWi:</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURXi:</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a2b7547b8c84650083ef57c17c4ed4885">  664</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a2b7547b8c84650083ef57c17c4ed4885">isMergeableLdStUpdate</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordtype">unsigned</span> Opc = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">switch</span> (Opc) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// Scaled instructions.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">case</span> AArch64::STRSui:</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">case</span> AArch64::STRDui:</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">case</span> AArch64::STRQui:</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">case</span> AArch64::STRXui:</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">case</span> AArch64::STRWui:</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">case</span> AArch64::STRHHui:</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">case</span> AArch64::STRBBui:</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRSui:</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRDui:</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRQui:</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRXui:</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRWui:</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRHHui:</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">case</span> AArch64::LDRBBui:</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">case</span> AArch64::STGOffset:</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">case</span> AArch64::STZGOffset:</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">case</span> AArch64::ST2GOffset:</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">case</span> AArch64::STZ2GOffset:</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">case</span> AArch64::STGPi:</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// Unscaled instructions.</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">case</span> AArch64::STURSi:</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">case</span> AArch64::STURDi:</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">case</span> AArch64::STURQi:</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">case</span> AArch64::STURWi:</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordflow">case</span> AArch64::STURXi:</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURSi:</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURDi:</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURQi:</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURWi:</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">case</span> AArch64::LDURXi:</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// Paired instructions.</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPSi:</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPSWi:</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPDi:</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPQi:</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPWi:</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordflow">case</span> AArch64::LDPXi:</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">case</span> AArch64::STPSi:</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">case</span> AArch64::STPDi:</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">case</span> AArch64::STPQi:</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">case</span> AArch64::STPWi:</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">case</span> AArch64::STPXi:</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// Make sure this is a reg+imm (as opposed to an address reloc).</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="SPIRVInstructionSelector_8cpp.html#a6fe0144adffd7bad0aeca668f4468b28">isImm</a>())</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;AArch64LoadStoreOpt::mergeNarrowZeroStores(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                           <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> MergeMI,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                           <span class="keyword">const</span> LdStPairFlags &amp;Flags) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">isPromotableZeroStoreInst</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">isPromotableZeroStoreInst</a>(*MergeMI) &amp;&amp;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;         <span class="stringliteral">&quot;Expected promotable zero stores.&quot;</span>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;end();</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> NextI = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">// If NextI is the second of the two instructions to be merged, we need</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// to skip one further. Either way we merge will invalidate the iterator,</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// and we don&#39;t need to scan the new instruction, as it&#39;s a pairwise</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="comment">// instruction, which we&#39;re not considering for further action anyway.</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">if</span> (NextI == MergeMI)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    NextI = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(NextI, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordtype">unsigned</span> Opc = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordtype">bool</span> IsScaled = !<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(Opc);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordtype">int</span> OffsetStride = IsScaled ? 1 : <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordtype">bool</span> MergeForward = <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.getMergeForward();</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// Insert our new paired instruction after whichever of the paired</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// instructions MergeForward indicates.</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> InsertionPoint = MergeForward ? MergeMI : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// Also based on MergeForward is from where we copy the base register operand</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// so we get the flags compatible with the input code.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;BaseRegOp =</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      MergeForward ? <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(*MergeMI)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                   : <a class="code" href="classllvm_1_1AArch64InstrInfo.html">AArch64InstrInfo</a>::getLdStBaseOp(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="comment">// Which register is Rt and which is Rt2 depends on the offset order.</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *RtMI;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*I).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() ==</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*MergeMI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() + OffsetStride)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    RtMI = &amp;*MergeMI;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    RtMI = &amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordtype">int</span> OffsetImm = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*RtMI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="comment">// Change the scaled offset from small to large type.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">if</span> (IsScaled) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(((OffsetImm &amp; 1) == 0) &amp;&amp; <span class="stringliteral">&quot;Unexpected offset to merge&quot;</span>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    OffsetImm /= 2;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">// Construct the new instruction.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc();</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIB;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  MIB = <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, InsertionPoint, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a834634558d65f592c08010de0e548343">getMatchingWideOpcode</a>(Opc)))</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(isNarrowStore(Opc) ? AArch64::WZR : AArch64::XZR)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(BaseRegOp)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(OffsetImm)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a8ed3ca165cdb5bd4085f5f56a5795a85">cloneMergedMemRefs</a>({&amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, &amp;*MergeMI})</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            .setMIFlags(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;mergeFlagsWith(*MergeMI));</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  (void)MIB;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Creating wider store. Replacing instructions:\n    &quot;</span>);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(MergeMI-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  with instruction:\n    &quot;</span>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(((<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *)MIB)-&gt;<a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="comment">// Erase the old instructions.</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  MergeMI-&gt;eraseFromParent();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">return</span> NextI;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;}</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">// Apply Fn to all instructions between MI and the beginning of the block, until</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">// a def for DefReg is reached. Returns true, iff Fn returns true for all</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">// visited instructions. Stop after visiting Limit iterations.</span></div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#aae1f40fb1287aaa0c9bab009ba9802b3">  794</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#aae1f40fb1287aaa0c9bab009ba9802b3">forAllMIsUntilDef</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> DefReg,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <span class="keywordtype">unsigned</span> Limit,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                              <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;<span class="keywordtype">bool</span>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;, <span class="keywordtype">bool</span>)&gt; &amp;Fn) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keyword">auto</span> <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> :</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;       <a class="code" href="namespacellvm.html#a90f68a1fc5d44bb06164dc2188b8e486">instructionsWithoutDebug</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getReverseIterator(), <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab42a834f1ab8e65b6f525a5cb23a4fe7">instr_rend</a>())) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">if</span> (!Limit)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    --Limit;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordtype">bool</span> isDef = <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.operands(), [DefReg, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>](<a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MOP) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      return MOP.isReg() &amp;&amp; MOP.isDef() &amp;&amp; !MOP.isDebug() &amp;&amp; MOP.getReg() &amp;&amp;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;             TRI-&gt;regsOverlap(MOP.getReg(), DefReg);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    });</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">if</span> (!Fn(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, isDef))</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (isDef)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#af5fcd8a3114504b21e5f08a08e4fa512">  816</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#af5fcd8a3114504b21e5f08a08e4fa512">updateDefinedRegisters</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1LiveRegUnits.html">LiveRegUnits</a> &amp;Units,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MOP : <a class="code" href="namespacellvm.html#a3747b99818482ff4e375eeb25d09c143">phys_regs_and_masks</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">if</span> (MOP.isReg() &amp;&amp; MOP.isKill())</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      Units.<a class="code" href="classllvm_1_1LiveRegUnits.html#af27497ce6068478bb97765620191e351">removeReg</a>(MOP.getReg());</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MOP : <a class="code" href="namespacellvm.html#a3747b99818482ff4e375eeb25d09c143">phys_regs_and_masks</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (MOP.isReg() &amp;&amp; !MOP.isKill())</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      Units.<a class="code" href="classllvm_1_1LiveRegUnits.html#ab2909dfae74e60e8dfd886b92e5a33e3">addReg</a>(MOP.getReg());</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;}</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;AArch64LoadStoreOpt::mergePairedInsns(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                                      <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> Paired,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                      <span class="keyword">const</span> LdStPairFlags &amp;Flags) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;end();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> NextI = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">// If NextI is the second of the two instructions to be merged, we need</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// to skip one further. Either way we merge will invalidate the iterator,</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// and we don&#39;t need to scan the new instruction, as it&#39;s a pairwise</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// instruction, which we&#39;re not considering for further action anyway.</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">if</span> (NextI == Paired)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    NextI = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(NextI, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordtype">int</span> SExtIdx = <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.getSExtIdx();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">unsigned</span> Opc =</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      SExtIdx == -1 ? <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode() : <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a8a865c8b5d774ded0806c199df5b3c06">getMatchingNonSExtOpcode</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode());</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordtype">bool</span> IsUnscaled = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(Opc);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keywordtype">int</span> OffsetStride = IsUnscaled ? <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) : 1;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordtype">bool</span> MergeForward = <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.getMergeForward();</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  std::optional&lt;MCPhysReg&gt; RenameReg = <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.getRenameReg();</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span> (MergeForward &amp;&amp; RenameReg) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="classllvm_1_1MCRegister.html">MCRegister</a> RegToRename = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*I).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    DefinedInBB.addReg(*RenameReg);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">// Return the sub/super register for RenameReg, matching the size of</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// OriginalReg.</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keyword">auto</span> GetMatchingSubReg = [<span class="keyword">this</span>,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                              RenameReg](<a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> OriginalReg) -&gt; <a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> SubOrSuper : <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1MCRegisterInfo.html#adb90b36bb8dc9eb671c9611a9016b161">sub_and_superregs_inclusive</a>(*RenameReg))</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">getMinimalPhysRegClass</a>(OriginalReg) ==</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">getMinimalPhysRegClass</a>(SubOrSuper))</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          <span class="keywordflow">return</span> SubOrSuper;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <a class="code" href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Should have found matching sub or super register!&quot;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    };</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;bool(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;, <span class="keywordtype">bool</span>)&gt; UpdateMIs =</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        [<span class="keyword">this</span>, RegToRename, GetMatchingSubReg](<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <span class="keywordtype">bool</span> IsDef) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          <span class="keywordflow">if</span> (IsDef) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordtype">bool</span> SeenDef = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;MOP : <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands()) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;              <span class="comment">// Rename the first explicit definition and all implicit</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;              <span class="comment">// definitions matching RegToRename.</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;              <span class="keywordflow">if</span> (MOP.isReg() &amp;&amp; !MOP.isDebug() &amp;&amp; MOP.getReg() &amp;&amp;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                  (!SeenDef || (MOP.isDef() &amp;&amp; MOP.isImplicit())) &amp;&amp;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                  <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ab5dddfd4ef6db864a18ecdbe51331b92">regsOverlap</a>(MOP.getReg(), RegToRename)) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((MOP.isImplicit() ||</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                        (MOP.isRenamable() &amp;&amp; !MOP.isEarlyClobber())) &amp;&amp;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                       <span class="stringliteral">&quot;Need renamable operands&quot;</span>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                MOP.setReg(GetMatchingSubReg(MOP.getReg()));</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                SeenDef = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;              }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;MOP : <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands()) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;              <span class="keywordflow">if</span> (MOP.isReg() &amp;&amp; !MOP.isDebug() &amp;&amp; MOP.getReg() &amp;&amp;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                  <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ab5dddfd4ef6db864a18ecdbe51331b92">regsOverlap</a>(MOP.getReg(), RegToRename)) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((MOP.isImplicit() ||</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                        (MOP.isRenamable() &amp;&amp; !MOP.isEarlyClobber())) &amp;&amp;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                           <span class="stringliteral">&quot;Need renamable operands&quot;</span>);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                MOP.setReg(GetMatchingSubReg(MOP.getReg()));</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;              }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Renamed &quot;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        };</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#aae1f40fb1287aaa0c9bab009ba9802b3">forAllMIsUntilDef</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, RegToRename, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a651f363be7841a2d798ed393b7d01a7d">LdStLimit</a>, UpdateMIs);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// Make sure the register used for renaming is not used between the paired</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// instructions. That would trash the content before the new paired</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// instruction.</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> :</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;         <a class="code" href="classllvm_1_1iterator__range.html">iterator_range</a>&lt;<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineInstrBundleIterator&lt;llvm::MachineInstr&gt;</a>&gt;(</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;             std::next(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), std::next(Paired)))</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands(),</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                    [<span class="keyword">this</span>, &amp;RenameReg](<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MOP) {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                      return !MOP.isReg() || MOP.isDebug() || !MOP.getReg() ||</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                             MOP.isUndef() ||</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                             !TRI-&gt;regsOverlap(MOP.getReg(), *RenameReg);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    }) &amp;&amp;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;             <span class="stringliteral">&quot;Rename register used between paired instruction, trashing the &quot;</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;             <span class="stringliteral">&quot;content&quot;</span>);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// Insert our new paired instruction after whichever of the paired</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">// instructions MergeForward indicates.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> InsertionPoint = MergeForward ? Paired : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="comment">// Also based on MergeForward is from where we copy the base register operand</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">// so we get the flags compatible with the input code.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;BaseRegOp =</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      MergeForward ? <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(*Paired)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                   : <a class="code" href="classllvm_1_1AArch64InstrInfo.html">AArch64InstrInfo</a>::getLdStBaseOp(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*I).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordtype">int</span> PairedOffset = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*Paired).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordtype">bool</span> PairedIsUnscaled = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(Paired-&gt;getOpcode());</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">if</span> (IsUnscaled != PairedIsUnscaled) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// We&#39;re trying to pair instructions that differ in how they are scaled.  If</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">// I is scaled then scale the offset of Paired accordingly.  Otherwise, do</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// the opposite (i.e., make Paired&#39;s offset unscaled).</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordtype">int</span> MemSize = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*Paired);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">if</span> (PairedIsUnscaled) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="comment">// If the unscaled offset isn&#39;t a multiple of the MemSize, we can&#39;t</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="comment">// pair the operations together.</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!(PairedOffset % <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*Paired)) &amp;&amp;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;             <span class="stringliteral">&quot;Offset should be a multiple of the stride!&quot;</span>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      PairedOffset /= MemSize;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      PairedOffset *= MemSize;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">// Which register is Rt and which is Rt2 depends on the offset order.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">// However, for pre load/stores the Rt should be the one of the pre</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">// load/store.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *RtMI, *Rt2MI;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> == PairedOffset + OffsetStride &amp;&amp;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      !<a class="code" href="classllvm_1_1AArch64InstrInfo.html#a482f66b2913dcfcc84a4cfeafc83e304">AArch64InstrInfo::isPreLdSt</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    RtMI = &amp;*Paired;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    Rt2MI = &amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">// Here we swapped the assumption made for SExtIdx.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// I.e., we turn ldp I, Paired into ldp Paired, I.</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// Update the index accordingly.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> (SExtIdx != -1)</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      SExtIdx = (SExtIdx + 1) % 2;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    RtMI = &amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    Rt2MI = &amp;*Paired;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordtype">int</span> OffsetImm = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*RtMI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="comment">// Scale the immediate offset, if necessary.</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(RtMI-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>())) {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!(OffsetImm % <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*RtMI)) &amp;&amp;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;           <span class="stringliteral">&quot;Unscaled offset cannot be scaled.&quot;</span>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    OffsetImm /= <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*RtMI);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="comment">// Construct the new instruction.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIB;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="classllvm_1_1DebugLoc.html">DebugLoc</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc();</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> RegOp0 = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*RtMI);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> RegOp1 = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*Rt2MI);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// Kill flags may become invalid when moving stores for pairing.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">if</span> (RegOp0.<a class="code" href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">isUse</a>()) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span> (!MergeForward) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="comment">// Clear kill flags on store if moving upwards. Example:</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="comment">//   STRWui %w0, ...</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="comment">//   USE %w1</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="comment">//   STRWui kill %w1  ; need to clear kill flag when moving STRWui upwards</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      RegOp0.<a class="code" href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">setIsKill</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      RegOp1.<a class="code" href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">setIsKill</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="comment">// Clear kill flags of the first stores register. Example:</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="comment">//   STRWui %w1, ...</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="comment">//   USE kill %w1   ; need to clear kill flag when moving STRWui downwards</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="comment">//   STRW %w0</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*I).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(std::next(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>), Paired))</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.clearRegisterKills(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MatchPairOpcode = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a2891bebbb2a99d3d169b71fd68a0cd87">getMatchingPairOpcode</a>(Opc);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  MIB = <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, InsertionPoint, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(MatchPairOpcode));</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">// Adds the pre-index operand for pre-indexed ld/st pairs.</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1AArch64InstrInfo.html#a482f66b2913dcfcc84a4cfeafc83e304">AArch64InstrInfo::isPreLdSt</a>(*RtMI))</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(BaseRegOp.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da72c17e2ff2d5af62a30e56ac152aa8d5">RegState::Define</a>);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(RegOp0)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(RegOp1)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(BaseRegOp)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(OffsetImm)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a8ed3ca165cdb5bd4085f5f56a5795a85">cloneMergedMemRefs</a>({&amp;*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, &amp;*Paired})</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      .setMIFlags(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;mergeFlagsWith(*Paired));</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  (void)MIB;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Creating pair load/store. Replacing instructions:\n    &quot;</span>);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(Paired-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  with instruction:\n    &quot;</span>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordflow">if</span> (SExtIdx != -1) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">// Generate the sign extension for the proper result of the ldp.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="comment">// I.e., with X1, that would be:</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">// %w1 = KILL %w1, implicit-def %x1</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">// %x1 = SBFMXri killed %x1, 0, 31</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;DstMO = MIB-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(SExtIdx);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// Right now, DstMO has the extended register, since it comes from an</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// extended opcode.</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstRegX = DstMO.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">// Get the W variant of that register.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DstRegW = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ab2147cc6810c7774110ebed17d4a2242">getSubReg</a>(DstRegX, AArch64::sub_32);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// Update the result of LDP to use the W instead of the X variant.</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    DstMO.<a class="code" href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">setReg</a>(DstRegW);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(((<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *)MIB)-&gt;<a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">// Make the machine verifier happy by providing a definition for</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">// the X register.</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">// Insert this definition right after the generated LDP, i.e., before</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">// InsertionPoint.</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIBKill =</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, InsertionPoint, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(TargetOpcode::KILL), DstRegW)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(DstRegW)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(DstRegX, <a class="code" href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da72c17e2ff2d5af62a30e56ac152aa8d5">RegState::Define</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    MIBKill-&gt;<a class="code" href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">getOperand</a>(2).<a class="code" href="classllvm_1_1MachineOperand.html#a10e708480cdc97c951368e06c13eac92">setImplicit</a>();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="comment">// Create the sign extension.</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIBSXTW =</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, InsertionPoint, <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(AArch64::SBFMXri), DstRegX)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(DstRegX)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(0)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(31);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    (void)MIBSXTW;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Extend operand:\n    &quot;</span>);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(((<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *)MIBSXTW)-&gt;<a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(((<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *)MIB)-&gt;<a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordflow">if</span> (MergeForward)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MOP : <a class="code" href="namespacellvm.html#a3747b99818482ff4e375eeb25d09c143">phys_regs_and_masks</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">if</span> (MOP.isReg() &amp;&amp; MOP.isKill())</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        DefinedInBB.addReg(MOP.getReg());</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">// Erase the old instructions.</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  Paired-&gt;eraseFromParent();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">return</span> NextI;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;}</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;AArch64LoadStoreOpt::promoteLoadFromStore(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> LoadI,</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                          <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> StoreI) {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> NextI =</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(LoadI, LoadI-&gt;getParent()-&gt;end());</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordtype">int</span> LoadSize = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*LoadI);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordtype">int</span> StoreSize = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(*StoreI);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> LdRt = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*LoadI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;StMO = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*StoreI);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> StRt = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*StoreI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordtype">bool</span> IsStoreXReg = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a55ad07e4cbe29bea4cb69b78472b690e">getRegClass</a>(AArch64::GPR64RegClassID)-&gt;<a class="code" href="classllvm_1_1TargetRegisterClass.html#a60b6974966381f08079722f2258a0039">contains</a>(StRt);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IsStoreXReg ||</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;          <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a55ad07e4cbe29bea4cb69b78472b690e">getRegClass</a>(AArch64::GPR32RegClassID)-&gt;<a class="code" href="classllvm_1_1TargetRegisterClass.html#a60b6974966381f08079722f2258a0039">contains</a>(StRt)) &amp;&amp;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;         <span class="stringliteral">&quot;Unexpected RegClass&quot;</span>);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *BitExtMI;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="keywordflow">if</span> (LoadSize == StoreSize &amp;&amp; (LoadSize == 4 || LoadSize == 8)) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">// Remove the load, if the destination register of the loads is the same</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="comment">// register for stored value.</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">if</span> (StRt == LdRt &amp;&amp; LoadSize == 8) {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(StoreI-&gt;getIterator(),</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                         LoadI-&gt;getIterator())) {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.killsRegister(StRt, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;          <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.clearRegisterKills(StRt, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Remove load instruction:\n    &quot;</span>);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(LoadI-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      LoadI-&gt;eraseFromParent();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keywordflow">return</span> NextI;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// Replace the load with a mov if the load and store are in the same size.</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    BitExtMI =</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*LoadI-&gt;getParent(), LoadI, LoadI-&gt;getDebugLoc(),</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(IsStoreXReg ? AArch64::ORRXrs : AArch64::ORRWrs), LdRt)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">addReg</a>(IsStoreXReg ? AArch64::XZR : AArch64::WZR)</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(StMO)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="namespacellvm_1_1AArch64__AM.html#aeae88f12b667477f90db9b726556b337">AArch64_AM::getShifterImm</a>(<a class="code" href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a1d97e13eb9923037fe733eda83b7f938">AArch64_AM::LSL</a>, 0))</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">setMIFlags</a>(LoadI-&gt;getFlags());</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">// FIXME: Currently we disable this transformation in big-endian targets as</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// performance and correctness are verified only in little-endian.</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">if</span> (!Subtarget-&gt;isLittleEndian())</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordflow">return</span> NextI;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordtype">bool</span> IsUnscaled = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(*LoadI);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsUnscaled == <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(*StoreI) &amp;&amp;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;           <span class="stringliteral">&quot;Unsupported ld/st match&quot;</span>);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LoadSize &lt;= StoreSize &amp;&amp; <span class="stringliteral">&quot;Invalid load size&quot;</span>);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordtype">int</span> UnscaledLdOffset =</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        IsUnscaled</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            ? <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*LoadI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>()</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            : <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*LoadI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() * LoadSize;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordtype">int</span> UnscaledStOffset =</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        IsUnscaled</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            ? <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*StoreI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>()</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            : <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(*StoreI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() * StoreSize;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> = LoadSize * 8;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <a class="code" href="classllvm_1_1Register.html">Register</a> DestReg =</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        IsStoreXReg ? <a class="code" href="classllvm_1_1Register.html">Register</a>(<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#aa5aad3f9195b1fd331f449ce9a709da2">getMatchingSuperReg</a>(</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                          LdRt, AArch64::sub_32, &amp;AArch64::GPR64RegClass))</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    : LdRt;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((UnscaledLdOffset &gt;= UnscaledStOffset &amp;&amp;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            (UnscaledLdOffset + LoadSize) &lt;= UnscaledStOffset + StoreSize) &amp;&amp;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;           <span class="stringliteral">&quot;Invalid offset&quot;</span>);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordtype">int</span> Immr = 8 * (UnscaledLdOffset - UnscaledStOffset);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordtype">int</span> Imms = Immr + <a class="code" href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">Width</a> - 1;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">if</span> (UnscaledLdOffset == UnscaledStOffset) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <a class="code" href="classuint32__t.html">uint32_t</a> AndMaskEncoded = ((IsStoreXReg ? 1 : 0) &lt;&lt; 12) <span class="comment">// N</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                | ((Immr) &lt;&lt; 6)               <span class="comment">// immr</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                | ((Imms) &lt;&lt; 0)               <span class="comment">// imms</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          ;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      BitExtMI =</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*LoadI-&gt;getParent(), LoadI, LoadI-&gt;getDebugLoc(),</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                  <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(IsStoreXReg ? AArch64::ANDXri : AArch64::ANDWri),</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                  DestReg)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(StMO)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(AndMaskEncoded)</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">setMIFlags</a>(LoadI-&gt;getFlags());</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      BitExtMI =</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*LoadI-&gt;getParent(), LoadI, LoadI-&gt;getDebugLoc(),</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                  <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(IsStoreXReg ? AArch64::UBFMXri : AArch64::UBFMWri),</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                  DestReg)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(StMO)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(Immr)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(Imms)</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">setMIFlags</a>(LoadI-&gt;getFlags());</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="comment">// Clear kill flags between store and load.</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a class="code" href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">make_range</a>(StoreI-&gt;getIterator(),</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                     BitExtMI-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>()))</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.killsRegister(StRt, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.clearRegisterKills(StRt, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Promoting load by replacing :\n    &quot;</span>);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(StoreI-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(LoadI-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  with instructions:\n    &quot;</span>);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(StoreI-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>((BitExtMI)-&gt;<a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="comment">// Erase the old instructions.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  LoadI-&gt;eraseFromParent();</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordflow">return</span> NextI;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;}</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a200a5e0929ef13cb3e07c368f26f381b"> 1187</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a200a5e0929ef13cb3e07c368f26f381b">inBoundsForPair</a>(<span class="keywordtype">bool</span> IsUnscaled, <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <span class="keywordtype">int</span> OffsetStride) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">// Convert the byte-offset used by unscaled into an &quot;element&quot; offset used</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="comment">// by the scaled pair load/store instructions.</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">if</span> (IsUnscaled) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">// If the byte-offset isn&#39;t a multiple of the stride, there&#39;s no point</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">// trying to match it.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> % OffsetStride)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> /= OffsetStride;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keywordflow">return</span> Offset &lt;= 63 &amp;&amp; Offset &gt;= -64;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">// Do alignment, specialized to power of 2 and for signed ints,</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">// avoiding having to do a C-style cast from uint_64t to int when</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">// using alignTo from include/llvm/Support/MathExtras.h.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">// FIXME: Move this function to include/MathExtras.h?</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a96bc92416c8a38a3c4a275b9e6c0beca"> 1204</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(<span class="keywordtype">int</span> Num, <span class="keywordtype">int</span> PowOf2) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keywordflow">return</span> (Num + PowOf2 - 1) &amp; ~(PowOf2 - 1);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;}</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a55450149fa2fc8fb50d587023814ea69"> 1208</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a55450149fa2fc8fb50d587023814ea69">mayAlias</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;MIa,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                     <a class="code" href="classllvm_1_1SmallVectorImpl.html">SmallVectorImpl&lt;MachineInstr *&gt;</a> &amp;MemInsns,</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                     <a class="code" href="classllvm_1_1AAResults.html">AliasAnalysis</a> *AA) {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *MIb : MemInsns)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">if</span> (MIa.<a class="code" href="classllvm_1_1MachineInstr.html#a55aec6d9959470668bae2aeb8a7c0768">mayAlias</a>(AA, *MIb, <span class="comment">/*UseTBAA*/</span> <span class="keyword">false</span>))</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;}</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keywordtype">bool</span> AArch64LoadStoreOpt::findMatchingStore(</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">unsigned</span> Limit,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;StoreI) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;begin();</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;LoadMI = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> BaseReg = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(LoadMI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="comment">// If the load is the first instruction in the block, there&#39;s obviously</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="comment">// not any matching store.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> == <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>)</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="comment">// Track which register units have been modified and used between the first</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="comment">// insn and the second insn.</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  ModifiedRegUnits.clear();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  UsedRegUnits.clear();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordtype">unsigned</span> Count = 0;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="namespacellvm.html#ae74dcdb801fe44b3840dd93e6c395066">prev_nodbg</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">// Don&#39;t count transient instructions towards the search limit since there</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">// may be different numbers of them if e.g. debug information is present.</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isTransient())</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      ++Count;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">// If the load instruction reads directly from the address to which the</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">// store instruction writes and the stored value is not modified, we can</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="comment">// promote the load. Since we do not handle stores with pre-/post-index,</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="comment">// it&#39;s unnecessary to check if BaseReg is modified by the store itself.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">// Also we can&#39;t handle stores without an immediate offset operand,</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">// while the operand might be the address for a global variable.</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.mayStore() &amp;&amp; <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a9e9873c963a7609d913c3420a97c0595">isMatchingStore</a>(LoadMI, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &amp;&amp;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        BaseReg == <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>() &amp;&amp;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="SPIRVInstructionSelector_8cpp.html#a6fe0144adffd7bad0aeca668f4468b28">isImm</a>() &amp;&amp;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#ae32b2c05b1bcc5413b940dd7d4d5701e">isLdOffsetInRangeOfSt</a>(LoadMI, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>) &amp;&amp;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        ModifiedRegUnits.available(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>())) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      StoreI = <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCall())</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="comment">// Update modified / uses register units.</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits, UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="comment">// Otherwise, if the base register is modified, we have no match, so</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="comment">// return early.</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">if</span> (!ModifiedRegUnits.available(BaseReg))</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="comment">// If we encounter a store aliased with the load, return early.</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.mayStore() &amp;&amp; LoadMI.<a class="code" href="classllvm_1_1MachineInstr.html#a55aec6d9959470668bae2aeb8a7c0768">mayAlias</a>(AA, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <span class="comment">/*UseTBAA*/</span> <span class="keyword">false</span>))</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  } <span class="keywordflow">while</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> &amp;&amp; Count &lt; Limit);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;}</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a33a9bde0ee9fe5d047f5c84642436bb8"> 1279</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a33a9bde0ee9fe5d047f5c84642436bb8">needsWinCFI</a>(<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> *MF) {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">return</span> MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ae68d159179d37dc7969439d842e2644f">getTarget</a>().<a class="code" href="classllvm_1_1TargetMachine.html#a171c7253c2b03171bdf22c1bd910f674">getMCAsmInfo</a>()-&gt;<a class="code" href="classllvm_1_1MCAsmInfo.html#ac158349781823fe8ff9e02d3a3533d55">usesWindowsCFI</a>() &amp;&amp;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;         MF-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">getFunction</a>().<a class="code" href="classllvm_1_1Function.html#ad7332117b148c3f93c1d7e58306ee748">needsUnwindTableEntry</a>();</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;}</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">// Returns true if FirstMI and MI are candidates for merging or pairing.</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">// Otherwise, returns false.</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a30157a5020934199c281913d8d077f55"> 1286</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a30157a5020934199c281913d8d077f55">areCandidatesToMergeOrPair</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;FirstMI, <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                       LdStPairFlags &amp;Flags,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64InstrInfo.html">AArch64InstrInfo</a> *<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>) {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// If this is volatile or if pairing is suppressed, not a candidate.</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.hasOrderedMemoryRef() || <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;isLdStPairSuppressed(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">// We should have already checked FirstMI for pair suppression and volatility.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#aabc3917d917c6247778c88107945d13b">hasOrderedMemoryRef</a>() &amp;&amp;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;         !<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;isLdStPairSuppressed(FirstMI) &amp;&amp;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;         <span class="stringliteral">&quot;FirstMI shouldn&#39;t get here if either of these checks are true.&quot;</span>);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a33a9bde0ee9fe5d047f5c84642436bb8">needsWinCFI</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getMF()) &amp;&amp; (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getFlag(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>) ||</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                  <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getFlag(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a4e4e6764dc61dbf0e8f330644880480f">MachineInstr::FrameDestroy</a>)))</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordtype">unsigned</span> OpcA = FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordtype">unsigned</span> OpcB = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode();</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="comment">// Opcodes match: If the opcodes are pre ld/st there is nothing more to check.</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">if</span> (OpcA == OpcB)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="classllvm_1_1AArch64InstrInfo.html#a482f66b2913dcfcc84a4cfeafc83e304">AArch64InstrInfo::isPreLdSt</a>(FirstMI);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">// Try to match a sign-extended load/store with a zero-extended load/store.</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordtype">bool</span> IsValidLdStrOpc, PairIsValidLdStrOpc;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keywordtype">unsigned</span> NonSExtOpc = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a8a865c8b5d774ded0806c199df5b3c06">getMatchingNonSExtOpcode</a>(OpcA, &amp;IsValidLdStrOpc);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IsValidLdStrOpc &amp;&amp;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;         <span class="stringliteral">&quot;Given Opc should be a Load or Store with an immediate&quot;</span>);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">// OpcA will be the first instruction in the pair.</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">if</span> (NonSExtOpc == <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a8a865c8b5d774ded0806c199df5b3c06">getMatchingNonSExtOpcode</a>(OpcB, &amp;PairIsValidLdStrOpc)) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    Flags.setSExtIdx(NonSExtOpc == (<span class="keywordtype">unsigned</span>)OpcA ? 1 : 0);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="comment">// If the second instruction isn&#39;t even a mergable/pairable load/store, bail</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="comment">// out.</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">if</span> (!PairIsValidLdStrOpc)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="comment">// FIXME: We don&#39;t support merging narrow stores with mixed scaled/unscaled</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">// offsets.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">if</span> (isNarrowStore(OpcA) || isNarrowStore(OpcB))</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="comment">// The STR&lt;S,D,Q,W,X&gt;pre - STR&lt;S,D,Q,W,X&gt;ui and</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">// LDR&lt;S,D,Q,W,X&gt;pre-LDR&lt;S,D,Q,W,X&gt;ui</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">// are candidate pairs that can be merged.</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#aef3719986b91bc4fac189135bd3795a8">isPreLdStPairCandidate</a>(FirstMI, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="comment">// Try to match an unscaled load/store with a scaled load/store.</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(OpcA) != <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(OpcB) &amp;&amp;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;         <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a2891bebbb2a99d3d169b71fd68a0cd87">getMatchingPairOpcode</a>(OpcA) == <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a2891bebbb2a99d3d169b71fd68a0cd87">getMatchingPairOpcode</a>(OpcB);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="comment">// FIXME: Can we also match a mixed sext/zext unscaled/scaled pair?</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;}</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#af848272aaea9ac1f976aaf56fd31cb8d"> 1344</a></span>&#160;<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#af848272aaea9ac1f976aaf56fd31cb8d">canRenameUpToDef</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;FirstMI, <a class="code" href="classllvm_1_1LiveRegUnits.html">LiveRegUnits</a> &amp;UsedInBetween,</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                 <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;const TargetRegisterClass *&gt;</a> &amp;RequiredClasses,</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">if</span> (!FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#ab96f3235c18e659758517d0532d606c9">mayStore</a>())</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="comment">// Check if we can find an unused register which we can use to rename</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="comment">// the register used by the first load/store.</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keyword">auto</span> *RegClass = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">getMinimalPhysRegClass</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(FirstMI).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>());</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>();</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keywordflow">if</span> (!RegClass || !MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a218bf4a49a8808ebb854ec9b89907904">tracksLiveness</a>())</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="keyword">auto</span> RegToRename = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(FirstMI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="comment">// For now, we only rename if the store operand gets killed at the store.</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(FirstMI).isKill() &amp;&amp;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      !<a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#aef0e7e42e45e15f86b2a122b56ab829c">operands</a>(),</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;              [<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, RegToRename](<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MOP) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                return MOP.isReg() &amp;&amp; !MOP.isDebug() &amp;&amp; MOP.getReg() &amp;&amp;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                       MOP.isImplicit() &amp;&amp; MOP.isKill() &amp;&amp;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                       TRI-&gt;regsOverlap(RegToRename, MOP.getReg());</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;              })) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Operand not killed at &quot;</span> &lt;&lt; FirstMI &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keyword">auto</span> canRenameMOP = [<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>](<span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineOperand.html">MachineOperand</a> &amp;MOP) {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">if</span> (MOP.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>()) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keyword">auto</span> *RegClass = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">getMinimalPhysRegClass</a>(MOP.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="comment">// Renaming registers with multiple disjunct sub-registers (e.g. the</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="comment">// result of a LD3) means that all sub-registers are renamed, potentially</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="comment">// impacting other instructions we did not check. Bail out.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="comment">// Note that this relies on the structure of the AArch64 register file. In</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="comment">// particular, a subregister cannot be written without overwriting the</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="comment">// whole register.</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="keywordflow">if</span> (RegClass-&gt;HasDisjunctSubRegs) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;  Cannot rename operands with multiple disjunct subregisters (&quot;</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            &lt;&lt; MOP &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">return</span> MOP.<a class="code" href="classllvm_1_1MachineOperand.html#a3bf161859e1ad7fd3da485d3cb688d34">isImplicit</a>() ||</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;           (MOP.<a class="code" href="classllvm_1_1MachineOperand.html#a8be49bc86b5d01b52b90baf1b4477667">isRenamable</a>() &amp;&amp; !MOP.<a class="code" href="classllvm_1_1MachineOperand.html#abd6aa9da048ef7a4faeaac6484d5c9a6">isEarlyClobber</a>() &amp;&amp; !MOP.<a class="code" href="classllvm_1_1MachineOperand.html#a894030fbf6d0f6c70991f05fff650930">isTied</a>());</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  };</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordtype">bool</span> FoundDef = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="comment">// For each instruction between FirstMI and the previous def for RegToRename,</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="comment">// we</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="comment">// * check if we can rename RegToRename in this instruction</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="comment">// * collect the registers used and required register classes for RegToRename.</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <a class="code" href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">std::function</a>&lt;bool(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;, <span class="keywordtype">bool</span>)&gt; CheckMIs = [&amp;](<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                                                           <span class="keywordtype">bool</span> IsDef) {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Checking &quot;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">// Currently we do not try to rename across frame-setup instructions.</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getFlag(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>)) {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Cannot rename framesetup instructions currently (&quot;</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    }</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    UsedInBetween.<a class="code" href="classllvm_1_1LiveRegUnits.html#af7ea64c95b144306f76693d958be9741">accumulate</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">// For a definition, check that we can rename the definition and exit the</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">// loop.</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    FoundDef = IsDef;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">// For defs, check if we can rename the first def of RegToRename.</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="keywordflow">if</span> (FoundDef) {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="comment">// For some pseudo instructions, we might not generate code in the end</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="comment">// (e.g. KILL) and we would end up without a correct def for the rename</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="comment">// register.</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="comment">// TODO: This might be overly conservative and we could handle those cases</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="comment">// in multiple ways:</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="comment">//       1. Insert an extra copy, to materialize the def.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="comment">//       2. Skip pseudo-defs until we find an non-pseudo def.</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isPseudo()) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Cannot rename pseudo instruction &quot;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;MOP : <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands()) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">if</span> (!MOP.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() || !MOP.<a class="code" href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">isDef</a>() || MOP.<a class="code" href="classllvm_1_1MachineOperand.html#aa2d3a60e597b4a6cf24ee4ac12d2cdbf">isDebug</a>() || !MOP.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() ||</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            !<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ab5dddfd4ef6db864a18ecdbe51331b92">regsOverlap</a>(MOP.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), RegToRename))</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="keywordflow">if</span> (!canRenameMOP(MOP)) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;  Cannot rename &quot;</span> &lt;&lt; MOP &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        RequiredClasses.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">getMinimalPhysRegClass</a>(MOP.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()));</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;MOP : <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands()) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <span class="keywordflow">if</span> (!MOP.<a class="code" href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() || MOP.<a class="code" href="classllvm_1_1MachineOperand.html#aa2d3a60e597b4a6cf24ee4ac12d2cdbf">isDebug</a>() || !MOP.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() ||</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            !<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ab5dddfd4ef6db864a18ecdbe51331b92">regsOverlap</a>(MOP.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), RegToRename))</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">if</span> (!canRenameMOP(MOP)) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;          <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;  Cannot rename &quot;</span> &lt;&lt; MOP &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        RequiredClasses.<a class="code" href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">insert</a>(<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">getMinimalPhysRegClass</a>(MOP.<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()));</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  };</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#aae1f40fb1287aaa0c9bab009ba9802b3">forAllMIsUntilDef</a>(FirstMI, RegToRename, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a651f363be7841a2d798ed393b7d01a7d">LdStLimit</a>, CheckMIs))</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">if</span> (!FoundDef) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  Did not find definition for register in BB\n&quot;</span>);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;}</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">// Check if we can find a physical register for renaming \p Reg. This register</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">// must:</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">// * not be defined already in \p DefinedInBB; DefinedInBB must contain all</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">//   defined registers up to the point where the renamed register will be used,</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">// * not used in \p UsedInBetween; UsedInBetween must contain all accessed</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">//   registers in the range the rename register will be used,</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">// * is available in all used register classes (checked using RequiredClasses).</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a32cf4b907c8f032509e95774aeb994f8"> 1473</a></span>&#160;<span class="keyword">static</span> std::optional&lt;MCPhysReg&gt; <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a32cf4b907c8f032509e95774aeb994f8">tryToFindRegisterToRename</a>(</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF, <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="classllvm_1_1LiveRegUnits.html">LiveRegUnits</a> &amp;DefinedInBB,</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <a class="code" href="classllvm_1_1LiveRegUnits.html">LiveRegUnits</a> &amp;UsedInBetween,</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="classllvm_1_1SmallPtrSetImpl.html">SmallPtrSetImpl&lt;const TargetRegisterClass *&gt;</a> &amp;RequiredClasses,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterInfo.html">TargetRegisterInfo</a> *<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineRegisterInfo.html">MachineRegisterInfo</a> &amp;RegInfo = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>();</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">// Checks if any sub- or super-register of PR is callee saved.</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keyword">auto</span> AnySubOrSuperRegCalleePreserved = [&amp;MF, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>](<a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> PR) {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1MCRegisterInfo.html#adb90b36bb8dc9eb671c9611a9016b161">sub_and_superregs_inclusive</a>(PR),</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                  [&amp;MF, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>](<a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> SubOrSuper) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                    return TRI-&gt;isCalleeSavedPhysReg(SubOrSuper, MF);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                  });</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  };</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="comment">// Check if PR or one of its sub- or super-registers can be used for all</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="comment">// required register classes.</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keyword">auto</span> CanBeUsedForAllClasses = [&amp;RequiredClasses, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>](<a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> PR) {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">all_of</a>(RequiredClasses, [PR, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>](<span class="keyword">const</span> <a class="code" href="classllvm_1_1TargetRegisterClass.html">TargetRegisterClass</a> *<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>) {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">any_of</a>(<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1MCRegisterInfo.html#adb90b36bb8dc9eb671c9611a9016b161">sub_and_superregs_inclusive</a>(PR),</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                    [<a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>](<a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> SubOrSuper) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                      return C == TRI-&gt;getMinimalPhysRegClass(SubOrSuper);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                    });</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    });</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  };</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keyword">auto</span> *RegClass = <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">getMinimalPhysRegClass</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">MCPhysReg</a> &amp;PR : *RegClass) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">if</span> (DefinedInBB.<a class="code" href="classllvm_1_1LiveRegUnits.html#a3996f7c3774880bfe32422602fe34f9c">available</a>(PR) &amp;&amp; UsedInBetween.<a class="code" href="classllvm_1_1LiveRegUnits.html#a3996f7c3774880bfe32422602fe34f9c">available</a>(PR) &amp;&amp;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        !RegInfo.<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a53ca7cff9e929ba372da9780fdd44b02">isReserved</a>(PR) &amp;&amp; !AnySubOrSuperRegCalleePreserved(PR) &amp;&amp;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        CanBeUsedForAllClasses(PR)) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      DefinedInBB.<a class="code" href="classllvm_1_1LiveRegUnits.html#ab2909dfae74e60e8dfd886b92e5a33e3">addReg</a>(PR);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Found rename register &quot;</span> &lt;&lt; <a class="code" href="namespacellvm.html#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(PR, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordflow">return</span> {PR};</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;No rename register found from &quot;</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    &lt;&lt; <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ac80ef1b0f96f5df74292346277f0005b">getRegClassName</a>(RegClass) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;}</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">/// Scan the instructions looking for a load/store that can be combined with the</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">/// current instruction into a wider equivalent or a load/store pair.</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;AArch64LoadStoreOpt::findMatchingInsn(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                                      LdStPairFlags &amp;Flags, <span class="keywordtype">unsigned</span> Limit,</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                                      <span class="keywordtype">bool</span> FindNarrowMerge) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;end();</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> MBBIWithRenameReg;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;FirstMI = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a530d5e41c3cf67937c373da61c65acd4">MayLoad</a> = FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#a682028ac4a06c9e3550fa8e6e1909fa9">mayLoad</a>();</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordtype">bool</span> IsUnscaled = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(FirstMI);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(FirstMI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> BaseReg = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(FirstMI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(FirstMI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="keywordtype">int</span> OffsetStride = IsUnscaled ? <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(FirstMI) : 1;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordtype">bool</span> IsPromotableZeroStore = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">isPromotableZeroStoreInst</a>(FirstMI);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  std::optional&lt;bool&gt; MaybeCanRename;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a297bc50d0b309b05e88b37479f9d6973">EnableRenaming</a>)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    MaybeCanRename = {<span class="keyword">false</span>};</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <a class="code" href="classllvm_1_1SmallPtrSet.html">SmallPtrSet&lt;const TargetRegisterClass *, 5&gt;</a> RequiredClasses;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <a class="code" href="classllvm_1_1LiveRegUnits.html">LiveRegUnits</a> UsedInBetween;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  UsedInBetween.<a class="code" href="classllvm_1_1LiveRegUnits.html#a5e7fb90824f599580585b3b5c5116614">init</a>(*<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.clearRenameReg();</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="comment">// Track which register units have been modified and used between the first</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="comment">// insn (inclusive) and the second insn.</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  ModifiedRegUnits.clear();</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  UsedRegUnits.clear();</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="comment">// Remember any instructions that read/write memory between FirstMI and MI.</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;MachineInstr *, 4&gt;</a> MemInsns;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Count = 0; <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> &amp;&amp; Count &lt; Limit;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;       <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>)) {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    UsedInBetween.<a class="code" href="classllvm_1_1LiveRegUnits.html#af7ea64c95b144306f76693d958be9741">accumulate</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="comment">// Don&#39;t count transient instructions towards the search limit since there</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="comment">// may be different numbers of them if e.g. debug information is present.</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isTransient())</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      ++Count;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.setSExtIdx(-1);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a30157a5020934199c281913d8d077f55">areCandidatesToMergeOrPair</a>(FirstMI, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, Flags, <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>) &amp;&amp;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a76f61c6784df6dc8402a8b9011041926">isImm</a>()) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.mayLoadOrStore() &amp;&amp; <span class="stringliteral">&quot;Expected memory operation.&quot;</span>);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="comment">// If we&#39;ve found another instruction with the same opcode, check to see</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="comment">// if the base and offset are compatible with our starting instruction.</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <span class="comment">// These instructions all have scaled immediate operands, so we just</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="comment">// check for +1/-1. Make sure to check the new instruction offset is</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="comment">// actually an immediate and not a symbolic reference destined for</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <span class="comment">// a relocation.</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> MIBaseReg = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      <span class="keywordtype">int</span> MIOffset = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordtype">bool</span> MIIsUnscaled = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordflow">if</span> (IsUnscaled != MIIsUnscaled) {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <span class="comment">// We&#39;re trying to pair instructions that differ in how they are scaled.</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <span class="comment">// If FirstMI is scaled then scale the offset of MI accordingly.</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="comment">// Otherwise, do the opposite (i.e., make MI&#39;s offset unscaled).</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="keywordtype">int</span> MemSize = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">if</span> (MIIsUnscaled) {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          <span class="comment">// If the unscaled offset isn&#39;t a multiple of the MemSize, we can&#39;t</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;          <span class="comment">// pair the operations together: bail and keep looking.</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;          <span class="keywordflow">if</span> (MIOffset % MemSize) {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits,</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                                              UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;          }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;          MIOffset /= MemSize;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;          MIOffset *= MemSize;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        }</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordtype">bool</span> IsPreLdSt = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#aef3719986b91bc4fac189135bd3795a8">isPreLdStPairCandidate</a>(FirstMI, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">if</span> (BaseReg == MIBaseReg) {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="comment">// If the offset of the second ld/st is not equal to the size of the</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="comment">// destination register it can’t be paired with a pre-index ld/st</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="comment">// pair. Additionally if the base reg is used or modified the operations</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <span class="comment">// can&#39;t be paired: bail and keep looking.</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordflow">if</span> (IsPreLdSt) {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          <span class="keywordtype">bool</span> IsOutOfBounds = MIOffset != <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          <span class="keywordtype">bool</span> IsBaseRegUsed = !UsedRegUnits.available(</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;              <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>());</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          <span class="keywordtype">bool</span> IsBaseRegModified = !ModifiedRegUnits.available(</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;              <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>());</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          <span class="comment">// If the stored value and the address of the second instruction is</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;          <span class="comment">// the same, it needs to be using the updated register and therefore</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;          <span class="comment">// it must not be folded.</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;          <span class="keywordtype">bool</span> IsMIRegTheSame =</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;              <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1TargetRegisterInfo.html#ab5dddfd4ef6db864a18ecdbe51331b92">regsOverlap</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>(),</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                               <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>());</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;          <span class="keywordflow">if</span> (IsOutOfBounds || IsBaseRegUsed || IsBaseRegModified ||</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;              IsMIRegTheSame) {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits,</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                                              UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;          }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> != MIOffset + OffsetStride) &amp;&amp;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;              (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> + OffsetStride != MIOffset)) {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits,</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                                              UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;          }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordtype">int</span> MinOffset = <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> &lt; MIOffset ? <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> : MIOffset;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordflow">if</span> (FindNarrowMerge) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          <span class="comment">// If the alignment requirements of the scaled wide load/store</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          <span class="comment">// instruction can&#39;t express the offset of the scaled narrow input,</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;          <span class="comment">// bail and keep looking. For promotable zero stores, allow only when</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          <span class="comment">// the stored value is the same (i.e., WZR).</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          <span class="keywordflow">if</span> ((!IsUnscaled &amp;&amp; <a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(MinOffset, 2) != MinOffset) ||</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;              (IsPromotableZeroStore &amp;&amp; <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a> != <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>())) {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits,</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                              UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;          }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          <span class="comment">// Pairwise instructions have a 7-bit signed offset field. Single</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;          <span class="comment">// insns have a 12-bit unsigned offset field.  If the resultant</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;          <span class="comment">// immediate offset of merging these instructions is out of range for</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          <span class="comment">// a pairwise instruction, bail and keep looking.</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a200a5e0929ef13cb3e07c368f26f381b">inBoundsForPair</a>(IsUnscaled, MinOffset, OffsetStride)) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits,</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                              UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;          }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;          <span class="comment">// If the alignment requirements of the paired (scaled) instruction</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;          <span class="comment">// can&#39;t express the offset of the unscaled input, bail and keep</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;          <span class="comment">// looking.</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;          <span class="keywordflow">if</span> (IsUnscaled &amp;&amp; (<a class="code" href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">alignTo</a>(MinOffset, OffsetStride) != MinOffset)) {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits,</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                                              UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;          }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="comment">// If the destination register of one load is the same register or a</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="comment">// sub/super register of the other load, bail and keep looking. A</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="comment">// load-pair instruction with both destination registers the same is</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="comment">// UNPREDICTABLE and will result in an exception.</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a530d5e41c3cf67937c373da61c65acd4">MayLoad</a> &amp;&amp;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1MCRegisterInfo.html#a973016c591557c107018a0e6478b30a9">isSuperOrSubRegisterEq</a>(<a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>())) {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;          <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits, UsedRegUnits,</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                                            <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;          MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        }</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <span class="comment">// If the BaseReg has been modified, then we cannot do the optimization.</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="comment">// For example, in the following pattern</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="comment">//   ldr x1 [x2]</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <span class="comment">//   ldr x2 [x3]</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="comment">//   ldr x4 [x2, #8],</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <span class="comment">// the first and third ldr cannot be converted to ldp x1, x4, [x2]</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">if</span> (!ModifiedRegUnits.available(BaseReg))</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="comment">// If the Rt of the second instruction was not modified or used between</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="comment">// the two instructions and none of the instructions between the second</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="comment">// and first alias with the second, we can combine the second into the</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="comment">// first.</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="keywordflow">if</span> (ModifiedRegUnits.available(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>()) &amp;&amp;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            !(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.mayLoad() &amp;&amp;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;              !UsedRegUnits.available(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>())) &amp;&amp;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            !<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a55450149fa2fc8fb50d587023814ea69">mayAlias</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, MemInsns, AA)) {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;          <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.setMergeForward(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;          <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.clearRenameReg();</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="comment">// Likewise, if the Rt of the first instruction is not modified or used</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="comment">// between the two instructions and none of the instructions between the</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="comment">// first and the second alias with the first, we can combine the first</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="comment">// into the second.</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a530d5e41c3cf67937c373da61c65acd4">MayLoad</a> &amp;&amp;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;              !UsedRegUnits.available(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(FirstMI).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>())) &amp;&amp;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            !<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a55450149fa2fc8fb50d587023814ea69">mayAlias</a>(FirstMI, MemInsns, AA)) {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;          <span class="keywordflow">if</span> (ModifiedRegUnits.available(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(FirstMI).<a class="code" href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a>())) {</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.setMergeForward(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.clearRenameReg();</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;          }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classllvm_1_1DebugCounter.html#a5aace8653ce3726ef07194dcf6bce2bf">DebugCounter::shouldExecute</a>(RegRenamingCounter)) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            <span class="keywordflow">if</span> (!MaybeCanRename)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;              MaybeCanRename = {<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#af848272aaea9ac1f976aaf56fd31cb8d">canRenameUpToDef</a>(FirstMI, UsedInBetween,</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                                                 RequiredClasses, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)};</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            <span class="keywordflow">if</span> (*MaybeCanRename) {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;              std::optional&lt;MCPhysReg&gt; MaybeRenameReg =</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                  <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a32cf4b907c8f032509e95774aeb994f8">tryToFindRegisterToRename</a>(*FirstMI.<a class="code" href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>(),</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                            <a class="code" href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">Reg</a>, DefinedInBB, UsedInBetween,</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                            RequiredClasses, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;              <span class="keywordflow">if</span> (MaybeRenameReg) {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.setRenameReg(*MaybeRenameReg);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.setMergeForward(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                MBBIWithRenameReg = <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;              }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;          }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="comment">// Unable to combine these instructions due to interference in between.</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="comment">// Keep looking.</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>.getRenameReg())</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <span class="keywordflow">return</span> MBBIWithRenameReg;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// If the instruction wasn&#39;t a matching load or store.  Stop searching if we</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">// encounter a call instruction that might modify memory.</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCall())</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; </div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="comment">// Update modified / uses register units.</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits, UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">// Otherwise, if the base register is modified, we have no match, so</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">// return early.</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordflow">if</span> (!ModifiedRegUnits.available(BaseReg))</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">// Update list of instructions that read/write memory.</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.mayLoadOrStore())</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      MemInsns.push_back(&amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;}</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l01763"></a><span class="lineno"><a class="line" href="AArch64LoadStoreOptimizer_8cpp.html#a94c1ab02555b5022baf4e16d66032338"> 1763</a></span>&#160;<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a94c1ab02555b5022baf4e16d66032338">maybeMoveCFI</a>(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> MaybeCFI) {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keyword">auto</span> End = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;end();</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keywordflow">if</span> (MaybeCFI == End ||</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      MaybeCFI-&gt;getOpcode() != TargetOpcode::CFI_INSTRUCTION ||</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      !(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getFlag(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">MachineInstr::FrameSetup</a>) ||</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getFlag(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a4e4e6764dc61dbf0e8f330644880480f">MachineInstr::FrameDestroy</a>)) ||</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() != AArch64::SP)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordflow">return</span> End;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;getParent();</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="keywordtype">unsigned</span> CFIIndex = MaybeCFI-&gt;getOperand(0).getCFIIndex();</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1MCCFIInstruction.html">MCCFIInstruction</a> &amp;CFI = MF.<a class="code" href="classllvm_1_1MachineFunction.html#ac76c4d72f8d92470ab0936e03f66e67b">getFrameInstructions</a>()[CFIIndex];</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keywordflow">switch</span> (CFI.<a class="code" href="classllvm_1_1MCCFIInstruction.html#a9d7ee9c6eaabde95dd9695326a77f253">getOperation</a>()) {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MCCFIInstruction.html#a26347ad83355eafb75fecd4bce9d7abbacbbd41f459c6cea155b66a7ba10f1058">MCCFIInstruction::OpDefCfa</a>:</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="classllvm_1_1MCCFIInstruction.html#a26347ad83355eafb75fecd4bce9d7abba5822faf65b27795cd48bd44712d48927">MCCFIInstruction::OpDefCfaOffset</a>:</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordflow">return</span> MaybeCFI;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">return</span> End;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;}</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;AArch64LoadStoreOpt::mergeUpdateInsn(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                                     <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> Update,</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                                     <span class="keywordtype">bool</span> IsPreIdx) {</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((Update-&gt;getOpcode() == AArch64::ADDXri ||</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;          Update-&gt;getOpcode() == AArch64::SUBXri) &amp;&amp;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;         <span class="stringliteral">&quot;Unexpected base register update instruction to merge!&quot;</span>);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;end();</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> NextI = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="comment">// If updating the SP and the following instruction is CFA offset related CFI</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="comment">// instruction move it after the merged instruction.</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> CFI =</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      IsPreIdx ? <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a94c1ab02555b5022baf4e16d66032338">maybeMoveCFI</a>(*Update, <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(Update, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>)) : <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="comment">// Return the instruction following the merged instruction, which is</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="comment">// the instruction following our unmerged load. Unless that&#39;s the add/sub</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="comment">// instruction we&#39;re merging, in which case it&#39;s the one after that.</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="keywordflow">if</span> (NextI == Update)</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    NextI = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(NextI, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classllvm_1_1Value.html">Value</a> = Update-&gt;getOperand(2).getImm();</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="namespacellvm_1_1AArch64__AM.html#a22f623563f43de6d1aabcdfa9d341031">AArch64_AM::getShiftValue</a>(Update-&gt;getOperand(3).getImm()) == 0 &amp;&amp;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;         <span class="stringliteral">&quot;Can&#39;t merge 1 &lt;&lt; 12 offset into pre-/post-indexed load / store&quot;</span>);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="keywordflow">if</span> (Update-&gt;getOpcode() == AArch64::SUBXri)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> = -<a class="code" href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">Value</a>;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordtype">unsigned</span> NewOpc = IsPreIdx ? <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a6cfadf0d2bf5ec4aa6119d058cf4623a">getPreIndexedOpcode</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getOpcode())</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                             : <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#ac03c5fd861f5d44077b3201b64495c9f">getPostIndexedOpcode</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;<a class="code" href="VPlanSLP_8cpp.html#af04704e906a9654777e92a4612c58c13">getOpcode</a>());</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBuilder.html">MachineInstrBuilder</a> MIB;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="keywordtype">int</span> Scale, MinOffset, MaxOffset;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a15d6de941763b0ffe5b5737390f23a57">getPrePostIndexedMemOpInfo</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Scale, MinOffset, MaxOffset);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1AArch64InstrInfo.html#a6ba8f62a5514943195111193dfd7ae08">AArch64InstrInfo::isPairedLdSt</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">// Non-paired instruction.</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    MIB = <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(NewOpc))</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*Update))</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(<a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> / Scale)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a6d96c0781817d38b57f91432dd85d28f">setMemRefs</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;memoperands())</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">setMIFlags</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;mergeFlagsWith(*Update));</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// Paired instruction.</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    MIB = <a class="code" href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent(), <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc(), <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(NewOpc))</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*Update))</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, 0))</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, 1))</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">add</a>(<a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">addImm</a>(<a class="code" href="classllvm_1_1Value.html">Value</a> / Scale)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a6d96c0781817d38b57f91432dd85d28f">setMemRefs</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;memoperands())</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;              .<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">setMIFlags</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;mergeFlagsWith(*Update));</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  }</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordflow">if</span> (CFI != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> *<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a class="code" href="classllvm_1_1MachineBasicBlock.html#adf0023bdc4f05a7849c35b1c859580d8">splice</a>(std::next(MIB.<a class="code" href="classllvm_1_1MachineInstrBuilder.html#a54ce61c9315f4d35304a86cb34388921">getInstr</a>()-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>()), <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, CFI);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">if</span> (IsPreIdx) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    ++NumPreFolded;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Creating pre-indexed load/store.&quot;</span>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    ++NumPostFolded;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Creating post-indexed load/store.&quot;</span>);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    Replacing instructions:\n    &quot;</span>);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span>);</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(Update-&gt;print(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;  with instruction:\n    &quot;</span>);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(((<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> *)MIB)-&gt;<a class="code" href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">print</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <a class="code" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <span class="comment">// Erase the old instructions for the block.</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  Update-&gt;eraseFromParent();</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="keywordflow">return</span> NextI;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;}</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="keywordtype">bool</span> AArch64LoadStoreOpt::isMatchingUpdateInsn(<a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;MemMI,</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                                               <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                                               <span class="keywordtype">unsigned</span> BaseReg, <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode()) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="keywordflow">case</span> AArch64::SUBXri:</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <span class="keywordflow">case</span> AArch64::ADDXri:</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="comment">// Make sure it&#39;s a vanilla immediate operand, not a relocation or</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="comment">// anything else we can&#39;t handle.</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(2).isImm())</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="comment">// Watch out for 1 &lt;&lt; 12 shifted value.</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1AArch64__AM.html#a22f623563f43de6d1aabcdfa9d341031">AArch64_AM::getShiftValue</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(3).getImm()))</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="comment">// The update instruction source and destination register must be the</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="comment">// same as the load/store base register.</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg() != BaseReg ||</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getReg() != BaseReg)</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordtype">int</span> UpdateOffset = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(2).getImm();</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == AArch64::SUBXri)</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      UpdateOffset = -UpdateOffset;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">// The immediate must be a multiple of the scaling factor of the pre/post</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">// indexed instruction.</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordtype">int</span> Scale, MinOffset, MaxOffset;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a15d6de941763b0ffe5b5737390f23a57">getPrePostIndexedMemOpInfo</a>(MemMI, Scale, MinOffset, MaxOffset);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="keywordflow">if</span> (UpdateOffset % Scale != 0)</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="comment">// Scaled offset must fit in the instruction immediate.</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordtype">int</span> ScaledOffset = UpdateOffset / Scale;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">if</span> (ScaledOffset &gt; MaxOffset || ScaledOffset &lt; MinOffset)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="comment">// If we have a non-zero Offset, we check that it matches the amount</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="comment">// we&#39;re adding to the register.</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> || <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> == UpdateOffset)</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;}</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> AArch64LoadStoreOpt::findMatchingUpdateInsnForward(</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">int</span> UnscaledOffset, <span class="keywordtype">unsigned</span> Limit) {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;end();</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;MemMI = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> BaseReg = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(MemMI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="keywordtype">int</span> MIUnscaledOffset = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(MemMI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() *</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                         <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(MemMI);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="comment">// Scan forward looking for post-index opportunities.  Updating instructions</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="comment">// can&#39;t be formed if the memory instruction doesn&#39;t have the offset we&#39;re</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <span class="comment">// looking for.</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <span class="keywordflow">if</span> (MIUnscaledOffset != UnscaledOffset)</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="comment">// If the base register overlaps a source/destination register, we can&#39;t</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <span class="comment">// merge the update. This does not apply to tag store instructions which</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="comment">// ignore the address part of the source register.</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="comment">// This does not apply to STGPi as well, which does not have unpredictable</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  <span class="comment">// behavior in this case unlike normal stores, and always performs writeback</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <span class="comment">// after reading the source register value.</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a9dc8254630582aab188826a20ce95f36">isTagStore</a>(MemMI) &amp;&amp; MemMI.<a class="code" href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() != AArch64::STGPi) {</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordtype">bool</span> IsPairedInsn = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a6ba8f62a5514943195111193dfd7ae08">AArch64InstrInfo::isPairedLdSt</a>(MemMI);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = IsPairedInsn ? 2 : 1; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> DestReg = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(MemMI, <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keywordflow">if</span> (DestReg == BaseReg || <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1MCRegisterInfo.html#a97b138b96791a09a0d9b9c77f0fb6e85">isSubRegister</a>(BaseReg, DestReg))</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="comment">// Track which register units have been modified and used between the first</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="comment">// insn (inclusive) and the second insn.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  ModifiedRegUnits.clear();</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  UsedRegUnits.clear();</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="comment">// We can&#39;t post-increment the stack pointer if any instruction between</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="comment">// the memory access (I) and the increment (MBBI) can access the memory</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="comment">// region defined by [SP, MBBI].</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> BaseRegSP = BaseReg == AArch64::SP;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keywordflow">if</span> (BaseRegSP &amp;&amp; <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a33a9bde0ee9fe5d047f5c84642436bb8">needsWinCFI</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getMF())) {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">// FIXME: For now, we always block the optimization over SP in windows</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">// targets as it requires to adjust the unwind/debug info, messing up</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="comment">// the unwind info can actually cause a miscompile.</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> Count = 0; <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> &amp;&amp; Count &lt; Limit;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;       <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">next_nodbg</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>)) {</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">// Don&#39;t count transient instructions towards the search limit since there</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="comment">// may be different numbers of them if e.g. debug information is present.</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isTransient())</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      ++Count;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="comment">// If we found a match, return it.</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordflow">if</span> (isMatchingUpdateInsn(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, BaseReg, UnscaledOffset))</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">// Update the status of what the instruction clobbered and used.</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits, UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">// Otherwise, if the base register is used or modified, we have no match, so</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="comment">// return early.</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// If we are optimizing SP, do not allow instructions that may load or store</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="comment">// in between the load and the optimized value update.</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> (!ModifiedRegUnits.available(BaseReg) ||</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        !UsedRegUnits.available(BaseReg) ||</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        (BaseRegSP &amp;&amp; <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>-&gt;mayLoadOrStore()))</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;}</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> AArch64LoadStoreOpt::findMatchingUpdateInsnBackward(</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <span class="keywordtype">unsigned</span> Limit) {</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;begin();</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent()-&gt;end();</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;MemMI = *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;MF = *MemMI.<a class="code" href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">getMF</a>();</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <a class="code" href="classllvm_1_1Register.html">Register</a> BaseReg = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">AArch64InstrInfo::getLdStBaseOp</a>(MemMI).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(MemMI).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <span class="comment">// If the load/store is the first instruction in the block, there&#39;s obviously</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="comment">// not any matching update. Ditto if the memory offset isn&#39;t zero.</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> == <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> || <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> != 0)</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <span class="comment">// If the base register overlaps a destination register, we can&#39;t</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="comment">// merge the update.</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a9dc8254630582aab188826a20ce95f36">isTagStore</a>(MemMI)) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="keywordtype">bool</span> IsPairedInsn = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a6ba8f62a5514943195111193dfd7ae08">AArch64InstrInfo::isPairedLdSt</a>(MemMI);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = IsPairedInsn ? 2 : 1; <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">e</a>; ++<a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <a class="code" href="classllvm_1_1Register.html">Register</a> DestReg = <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a>(MemMI, <a class="code" href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a>).<a class="code" href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      <span class="keywordflow">if</span> (DestReg == BaseReg || <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;<a class="code" href="classllvm_1_1MCRegisterInfo.html#a97b138b96791a09a0d9b9c77f0fb6e85">isSubRegister</a>(BaseReg, DestReg))</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> BaseRegSP = BaseReg == AArch64::SP;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">if</span> (BaseRegSP &amp;&amp; <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a33a9bde0ee9fe5d047f5c84642436bb8">needsWinCFI</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getMF())) {</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="comment">// FIXME: For now, we always block the optimization over SP in windows</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">// targets as it requires to adjust the unwind/debug info, messing up</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="comment">// the unwind info can actually cause a miscompile.</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a> &amp;Subtarget = MF.<a class="code" href="classllvm_1_1MachineFunction.html#a325f6b611ef9ec06798d3b4eb9572093">getSubtarget</a>&lt;<a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a>&gt;();</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordtype">unsigned</span> RedZoneSize =</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      Subtarget.<a class="code" href="classllvm_1_1AArch64Subtarget.html#aa4c9f6d9092cf5ca3819973f4b297050">getTargetLowering</a>()-&gt;<a class="code" href="classllvm_1_1AArch64TargetLowering.html#aa4502ed00aa357af2b923730584885d7">getRedZoneSize</a>(MF.<a class="code" href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">getFunction</a>());</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="comment">// Track which register units have been modified and used between the first</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="comment">// insn (inclusive) and the second insn.</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  ModifiedRegUnits.clear();</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  UsedRegUnits.clear();</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordtype">unsigned</span> Count = 0;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="keywordtype">bool</span> MemAcessBeforeSPPreInc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="namespacellvm.html#ae74dcdb801fe44b3840dd93e6c395066">prev_nodbg</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a>);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="comment">// Don&#39;t count transient instructions towards the search limit since there</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">// may be different numbers of them if e.g. debug information is present.</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isTransient())</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      ++Count;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">// If we found a match, return it.</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordflow">if</span> (isMatchingUpdateInsn(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, BaseReg, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>)) {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      <span class="comment">// Check that the update value is within our red zone limit (which may be</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="comment">// zero).</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <span class="keywordflow">if</span> (MemAcessBeforeSPPreInc &amp;&amp; <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>-&gt;getOperand(2).getImm() &gt; RedZoneSize)</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">// Update the status of what the instruction clobbered and used.</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <a class="code" href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">LiveRegUnits::accumulateUsedDefed</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, ModifiedRegUnits, UsedRegUnits, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="comment">// Otherwise, if the base register is used or modified, we have no match, so</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="comment">// return early.</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">if</span> (!ModifiedRegUnits.available(BaseReg) ||</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        !UsedRegUnits.available(BaseReg))</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="comment">// Keep track if we have a memory access before an SP pre-increment, in this</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="comment">// case we need to validate later that the update amount respects the red</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">// zone.</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">if</span> (BaseRegSP &amp;&amp; <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>-&gt;mayLoadOrStore())</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      MemAcessBeforeSPPreInc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  } <span class="keywordflow">while</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a> &amp;&amp; Count &lt; Limit);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;}</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="keywordtype">bool</span> AArch64LoadStoreOpt::tryToPromoteLoadFromStore(</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="comment">// If this is a volatile load, don&#39;t mess with it.</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.hasOrderedMemoryRef())</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a33a9bde0ee9fe5d047f5c84642436bb8">needsWinCFI</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getMF()) &amp;&amp; <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getFlag(<a class="code" href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a4e4e6764dc61dbf0e8f330644880480f">MachineInstr::FrameDestroy</a>))</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="comment">// Make sure this is a reg+imm.</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="comment">// FIXME: It is possible to extend it to handle reg+reg cases.</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="SPIRVInstructionSelector_8cpp.html#a6fe0144adffd7bad0aeca668f4468b28">isImm</a>())</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="comment">// Look backward up to LdStLimit instructions.</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> StoreI;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keywordflow">if</span> (findMatchingStore(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a651f363be7841a2d798ed393b7d01a7d">LdStLimit</a>, StoreI)) {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    ++NumLoadsFromStoresPromoted;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="comment">// Promote the load. Keeping the iterator straight is a</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="comment">// pain, so we let the merge routine tell us what the next instruction</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <span class="comment">// is after it&#39;s done mucking about.</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = promoteLoadFromStore(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, StoreI);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  }</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;}</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">// Merge adjacent zero stores into a wider store.</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="keywordtype">bool</span> AArch64LoadStoreOpt::tryToMergeZeroStInst(</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">isPromotableZeroStoreInst</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) &amp;&amp; <span class="stringliteral">&quot;Expected narrow store.&quot;</span>);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;end();</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;isCandidateToMergeOrPair(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="comment">// Look ahead up to LdStLimit instructions for a mergable instruction.</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  LdStPairFlags <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> MergeMI =</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      findMatchingInsn(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, Flags, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a651f363be7841a2d798ed393b7d01a7d">LdStLimit</a>, <span class="comment">/* FindNarrowMerge = */</span> <span class="keyword">true</span>);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="keywordflow">if</span> (MergeMI != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>) {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    ++NumZeroStoresPromoted;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="comment">// Keeping the iterator straight is a pain, so we let the merge routine tell</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <span class="comment">// us what the next instruction is after it&#39;s done mucking about.</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = mergeNarrowZeroStores(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, MergeMI, Flags);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;}</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">// Find loads and stores that can be merged into a single load or store pair</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">// instruction.</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="keywordtype">bool</span> AArch64LoadStoreOpt::tryToPairLdStInst(<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;end();</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;isCandidateToMergeOrPair(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="comment">// Early exit if the offset is not possible to match. (6 bits of positive</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="comment">// range, plus allow an extra one in case we find a later insn that matches</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="comment">// with Offset-1)</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <span class="keywordtype">bool</span> IsUnscaled = <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>();</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="keywordtype">int</span> OffsetStride = IsUnscaled ? <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) : 1;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="comment">// Allow one more for offset.</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> &gt; 0)</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> -= OffsetStride;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a200a5e0929ef13cb3e07c368f26f381b">inBoundsForPair</a>(IsUnscaled, <a class="code" href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, OffsetStride))</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="comment">// Look ahead up to LdStLimit instructions for a pairable instruction.</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  LdStPairFlags <a class="code" href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> Paired =</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      findMatchingInsn(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, Flags, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a651f363be7841a2d798ed393b7d01a7d">LdStLimit</a>, <span class="comment">/* FindNarrowMerge = */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keywordflow">if</span> (Paired != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>) {</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    ++NumPairCreated;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      ++NumUnscaledPairCreated;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">// Keeping the iterator straight is a pain, so we let the merge routine tell</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="comment">// us what the next instruction is after it&#39;s done mucking about.</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keyword">auto</span> Prev = std::prev(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = mergePairedInsns(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, Paired, Flags);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="comment">// Collect liveness info for instructions between Prev and the new position</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="comment">// MBBI.</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = std::next(Prev); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>; <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++)</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#af5fcd8a3114504b21e5f08a08e4fa512">updateDefinedRegisters</a>(*<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, DefinedInBB, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;}</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="keywordtype">bool</span> AArch64LoadStoreOpt::tryToMergeLdStUpdate</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    (<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <a class="code" href="classllvm_1_1MachineInstr.html">MachineInstr</a> &amp;<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = *<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;end();</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> Update;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="comment">// Look forward to try to form a post-index instruction. For example,</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="comment">// ldr x0, [x20]</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="comment">// add x20, x20, #32</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="comment">//   merged into:</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="comment">// ldr x0, [x20], #32</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  Update = findMatchingUpdateInsnForward(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, 0, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#adf93253be357fe9cc086b28ae4b98841">UpdateLimit</a>);</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="keywordflow">if</span> (Update != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>) {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">// Merge the update into the ld/st.</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = mergeUpdateInsn(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, Update, <span class="comment">/*IsPreIdx=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160; </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <span class="comment">// Don&#39;t know how to handle unscaled pre/post-index versions below, so bail.</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;hasUnscaledLdStOffset(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode()))</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="comment">// Look back to try to find a pre-index instruction. For example,</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <span class="comment">// add x0, x0, #8</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <span class="comment">// ldr x1, [x0]</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  <span class="comment">//   merged into:</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <span class="comment">// ldr x1, [x0, #8]!</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  Update = findMatchingUpdateInsnBackward(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#adf93253be357fe9cc086b28ae4b98841">UpdateLimit</a>);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  <span class="keywordflow">if</span> (Update != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>) {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">// Merge the update into the ld/st.</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = mergeUpdateInsn(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, Update, <span class="comment">/*IsPreIdx=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  }</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="comment">// The immediate in the load/store is scaled by the size of the memory</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="comment">// operation. The immediate in the add we&#39;re looking for,</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="comment">// however, is not, so adjust here.</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="keywordtype">int</span> UnscaledOffset =</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      <a class="code" href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">AArch64InstrInfo::getLdStOffsetOp</a>(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a class="code" href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">getImm</a>() * <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getMemScale(<a class="code" href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="comment">// Look forward to try to find a pre-index instruction. For example,</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="comment">// ldr x1, [x0, #64]</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="comment">// add x0, x0, #64</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="comment">//   merged into:</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="comment">// ldr x1, [x0, #64]!</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  Update = findMatchingUpdateInsnForward(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, UnscaledOffset, <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#adf93253be357fe9cc086b28ae4b98841">UpdateLimit</a>);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  <span class="keywordflow">if</span> (Update != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>) {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="comment">// Merge the update into the ld/st.</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = mergeUpdateInsn(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, Update, <span class="comment">/*IsPreIdx=*/</span><span class="keyword">true</span>);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;}</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="ScalarizeMaskedMemIntrin_8cpp.html#a8f3425131aae6ea2275a052284a7c2dc">AArch64LoadStoreOpt::optimizeBlock</a>(<a class="code" href="classllvm_1_1MachineBasicBlock.html">MachineBasicBlock</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>,</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                        <span class="keywordtype">bool</span> EnableNarrowZeroStOpt) {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; </div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  <span class="comment">// Four tranformations to do here:</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <span class="comment">// 1) Find loads that directly read from stores and promote them by</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="comment">//    replacing with mov instructions. If the store is wider than the load,</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <span class="comment">//    the load will be replaced with a bitfield extract.</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="comment">//      e.g.,</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="comment">//        str w1, [x0, #4]</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="comment">//        ldrh w2, [x0, #6]</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  <span class="comment">//        ; becomes</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="comment">//        str w1, [x0, #4]</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <span class="comment">//        lsr w2, w1, #16</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;       <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;) {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a131caae6e5e55eccd4efe928baa973ef">isPromotableLoadFromStore</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) &amp;&amp; tryToPromoteLoadFromStore(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>))</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      ++<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="comment">// 2) Merge adjacent zero stores into a wider store.</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">//      e.g.,</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="comment">//        strh wzr, [x0]</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <span class="comment">//        strh wzr, [x0, #2]</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  <span class="comment">//        ; becomes</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="comment">//        str wzr, [x0]</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <span class="comment">//      e.g.,</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <span class="comment">//        str wzr, [x0]</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="comment">//        str wzr, [x0, #4]</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="comment">//        ; becomes</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="comment">//        str xzr, [x0]</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="keywordflow">if</span> (EnableNarrowZeroStOpt)</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;         <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;) {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">isPromotableZeroStoreInst</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) &amp;&amp; tryToMergeZeroStInst(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>))</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        ++<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="comment">// 3) Find loads and stores that can be merged into a single load or store</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="comment">//    pair instruction.</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="comment">//      e.g.,</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="comment">//        ldr x0, [x2]</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="comment">//        ldr x1, [x2, #8]</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="comment">//        ; becomes</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  <span class="comment">//        ldp x0, x1, [x2]</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">getParent</a>()-&gt;<a class="code" href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">getRegInfo</a>().<a class="code" href="classllvm_1_1MachineRegisterInfo.html#a218bf4a49a8808ebb854ec9b89907904">tracksLiveness</a>()) {</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    DefinedInBB.<a class="code" href="classllvm_1_1MachineBasicBlock.html#a2be0839c1c2ac22d7c65f8a175105959">clear</a>();</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    DefinedInBB.addLiveIns(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;       <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;) {</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="comment">// Track currently live registers up to this point, to help with</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="comment">// searching for a rename register on demand.</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#af5fcd8a3114504b21e5f08a08e4fa512">updateDefinedRegisters</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>, DefinedInBB, <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a>-&gt;isPairableLdStInst(*<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) &amp;&amp; tryToPairLdStInst(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>))</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      ++<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  }</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="comment">// 4) Find base register updates that can be merged into the load or store</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="comment">//    as a base-reg writeback.</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  <span class="comment">//      e.g.,</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <span class="comment">//        ldr x0, [x2]</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="comment">//        add x2, x2, #4</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <span class="comment">//        ; becomes</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <span class="comment">//        ldr x0, [x2], #4</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1MachineInstrBundleIterator.html">MachineBasicBlock::iterator</a> <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">begin</a>(), <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = <a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>.<a class="code" href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">end</a>();</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;       <a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>;) {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AArch64LoadStoreOptimizer_8cpp.html#a2b7547b8c84650083ef57c17c4ed4885">isMergeableLdStUpdate</a>(*<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>) &amp;&amp; tryToMergeLdStUpdate(<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>))</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      ++<a class="code" href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a>;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a>;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;}</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="keywordtype">bool</span> AArch64LoadStoreOpt::runOnMachineFunction(<a class="code" href="classllvm_1_1MachineFunction.html">MachineFunction</a> &amp;Fn) {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  <span class="keywordflow">if</span> (skipFunction(Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">getFunction</a>()))</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  Subtarget = &amp;Fn.<a class="code" href="classllvm_1_1MachineFunction.html#a325f6b611ef9ec06798d3b4eb9572093">getSubtarget</a>&lt;<a class="code" href="classllvm_1_1AArch64Subtarget.html">AArch64Subtarget</a>&gt;();</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <a class="code" href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a> = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classllvm_1_1AArch64InstrInfo.html">AArch64InstrInfo</a> *<span class="keyword">&gt;</span>(Subtarget-&gt;<a class="code" href="classllvm_1_1AArch64Subtarget.html#a39505e1fb9837807a81c02bd1eef7418">getInstrInfo</a>());</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a> = Subtarget-&gt;<a class="code" href="classllvm_1_1AArch64Subtarget.html#a69f50b8c0a70f57950c142ca963e1cb5">getRegisterInfo</a>();</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  AA = &amp;getAnalysis&lt;AAResultsWrapperPass&gt;().getAAResults();</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <span class="comment">// Resize the modified and used register unit trackers.  We do this once</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  <span class="comment">// per function and then clear the register units each time we optimize a load</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  <span class="comment">// or store.</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  ModifiedRegUnits.init(*<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  UsedRegUnits.init(*<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  DefinedInBB.init(*<a class="code" href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="keywordtype">bool</span> enableNarrowZeroStOpt = !Subtarget-&gt;requiresStrictAlign();</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a> : Fn) {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keyword">auto</span> <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="ScalarizeMaskedMemIntrin_8cpp.html#a8f3425131aae6ea2275a052284a7c2dc">optimizeBlock</a>(<a class="code" href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a>, enableNarrowZeroStOpt);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a> |= <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">Modified</a>;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;}</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment">// FIXME: Do we need/want a pre-alloc pass like ARM has to try to keep loads and</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">// stores near one another?  Note: The pre-RA instruction scheduler already has</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment">// hooks to try and schedule pairable loads/stores together to improve pairing</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">// opportunities.  Thus, pre-RA pairing pass may not be worth the effort.</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="comment">// FIXME: When pairing store instructions it&#39;s very possible for this pass to</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="comment">// hoist a store with a KILL marker above another use (without a KILL marker).</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment">// The resulting IR is invalid, but nothing uses the KILL markers after this</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="comment">// pass, so it&#39;s never caused a problem in practice.</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment">/// createAArch64LoadStoreOptimizationPass - returns an instance of the</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment">/// load / store optimization pass.</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"><a class="line" href="namespacellvm.html#a8fac7522195671ed678db745338eb462"> 2335</a></span>&#160;<span class="comment"></span><a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html#a8fac7522195671ed678db745338eb462">llvm::createAArch64LoadStoreOptimizationPass</a>() {</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> AArch64LoadStoreOpt();</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alib_2Target_2README_8txt_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lib_2Target_2README_8txt.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">i</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2README_8txt_source.html#l00029">README.txt:29</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0270bdca4aeb43f39bf91c900a398057"><div class="ttname"><a href="namespacellvm.html#a0270bdca4aeb43f39bf91c900a398057">llvm::next_nodbg</a></div><div class="ttdeci">IterT next_nodbg(IterT It, IterT End, bool SkipPseudoOp=true)</div><div class="ttdoc">Increment It, then continue incrementing it while it points to a debug instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01323">MachineBasicBlock.h:1323</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab102f0f12dd38aeea5906b1d80c792ff"><div class="ttname"><a href="namespacellvm.html#ab102f0f12dd38aeea5906b1d80c792ff">llvm::alignTo</a></div><div class="ttdeci">uint64_t alignTo(uint64_t Size, Align A)</div><div class="ttdoc">Returns a multiple of A needed to store Size bytes.</div><div class="ttdef"><b>Definition:</b> <a href="Alignment_8h_source.html#l00155">Alignment.h:155</a></div></div>
<div class="ttc" id="aMCDwarf_8h_html"><div class="ttname"><a href="MCDwarf_8h.html">MCDwarf.h</a></div></div>
<div class="ttc" id="aIRTranslator_8cpp_html_abe44dfdea65b4f7e11e0a608ab708b76"><div class="ttname"><a href="IRTranslator_8cpp.html#abe44dfdea65b4f7e11e0a608ab708b76">MI</a></div><div class="ttdeci">IRTranslator LLVM IR MI</div><div class="ttdef"><b>Definition:</b> <a href="IRTranslator_8cpp_source.html#l00109">IRTranslator.cpp:109</a></div></div>
<div class="ttc" id="aMachineInstr_8h_html"><div class="ttname"><a href="MachineInstr_8h.html">MachineInstr.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a4f1ceb770fe3446bfb2b3fa26858098f"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a4f1ceb770fe3446bfb2b3fa26858098f">llvm::MachineInstrBuilder::addImm</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addImm(int64_t Val) const</div><div class="ttdoc">Add a new immediate operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00131">MachineInstrBuilder.h:131</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This is an optimization pass for GlobalISel generic memory operations.</div><div class="ttdef"><b>Definition:</b> <a href="AddressRanges_8h_source.html#l00018">AddressRanges.h:18</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a2b7547b8c84650083ef57c17c4ed4885"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a2b7547b8c84650083ef57c17c4ed4885">isMergeableLdStUpdate</a></div><div class="ttdeci">static bool isMergeableLdStUpdate(MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00664">AArch64LoadStoreOptimizer.cpp:664</a></div></div>
<div class="ttc" id="aAArch64MachineFunctionInfo_8h_html"><div class="ttname"><a href="AArch64MachineFunctionInfo_8h.html">AArch64MachineFunctionInfo.h</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="anamespacellvm_html_ad1a91b49e0c092818a0b82f6cc130a1b"><div class="ttname"><a href="namespacellvm.html#ad1a91b49e0c092818a0b82f6cc130a1b">llvm::make_range</a></div><div class="ttdeci">iterator_range&lt; T &gt; make_range(T x, T y)</div><div class="ttdoc">Convenience function for iterating over sub-ranges.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00053">iterator_range.h:53</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64PACKey_html_abf4394f452bde3f544999858d71e4b46"><div class="ttname"><a href="namespacellvm_1_1AArch64PACKey.html#abf4394f452bde3f544999858d71e4b46">llvm::AArch64PACKey::ID</a></div><div class="ttdeci">ID</div><div class="ttdef"><b>Definition:</b> <a href="AArch64BaseInfo_8h_source.html#l00790">AArch64BaseInfo.h:790</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a7e75394a33f6a5897d7a14c0ba5d44f1a1d97e13eb9923037fe733eda83b7f938"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a7e75394a33f6a5897d7a14c0ba5d44f1a1d97e13eb9923037fe733eda83b7f938">llvm::AArch64_AM::LSL</a></div><div class="ttdeci">@ LSL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00035">AArch64AddressingModes.h:35</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html">llvm::MachineRegisterInfo</a></div><div class="ttdoc">MachineRegisterInfo - Keep track of information for virtual and physical registers,...</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00051">MachineRegisterInfo.h:51</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRegUnits_html_a06c3c14971a6414e21bf3a0a2652de0f"><div class="ttname"><a href="classllvm_1_1LiveRegUnits.html#a06c3c14971a6414e21bf3a0a2652de0f">llvm::LiveRegUnits::accumulateUsedDefed</a></div><div class="ttdeci">static void accumulateUsedDefed(const MachineInstr &amp;MI, LiveRegUnits &amp;ModifiedRegUnits, LiveRegUnits &amp;UsedRegUnits, const TargetRegisterInfo *TRI)</div><div class="ttdoc">For a machine instruction MI, adds all register units used in UsedRegUnits and defined or clobbered i...</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8h_source.html#l00047">LiveRegUnits.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a1ac8d27532cfd1d1f032ecbff2ba3611"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a1ac8d27532cfd1d1f032ecbff2ba3611">llvm::MachineInstrBuilder::add</a></div><div class="ttdeci">const MachineInstrBuilder &amp; add(const MachineOperand &amp;MO) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00224">MachineInstrBuilder.h:224</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_a2be0839c1c2ac22d7c65f8a175105959"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a2be0839c1c2ac22d7c65f8a175105959">llvm::MachineBasicBlock::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01029">MachineBasicBlock.h:1029</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a682028ac4a06c9e3550fa8e6e1909fa9"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a682028ac4a06c9e3550fa8e6e1909fa9">llvm::MachineInstr::mayLoad</a></div><div class="ttdeci">bool mayLoad(QueryType Type=AnyInBundle) const</div><div class="ttdoc">Return true if this instruction could possibly read memory.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l01056">MachineInstr.h:1056</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a8a82683fccdef8a5ef772ef03277aee7"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a8a82683fccdef8a5ef772ef03277aee7">llvm::MachineOperand::setIsKill</a></div><div class="ttdeci">void setIsKill(bool Val=true)</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00519">MachineOperand.h:519</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt; MachineInstr *, 4 &gt;</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_af5fcd8a3114504b21e5f08a08e4fa512"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#af5fcd8a3114504b21e5f08a08e4fa512">updateDefinedRegisters</a></div><div class="ttdeci">static void updateDefinedRegisters(MachineInstr &amp;MI, LiveRegUnits &amp;Units, const TargetRegisterInfo *TRI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00816">AArch64LoadStoreOptimizer.cpp:816</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a6fb7e237b1b1fe47144da84e1c2fd5b4"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a6fb7e237b1b1fe47144da84e1c2fd5b4">AARCH64_LOAD_STORE_OPT_NAME</a></div><div class="ttdeci">#define AARCH64_LOAD_STORE_OPT_NAME</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00083">AArch64LoadStoreOptimizer.cpp:83</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html"><div class="ttname"><a href="Support_2ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a894030fbf6d0f6c70991f05fff650930"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a894030fbf6d0f6c70991f05fff650930">llvm::MachineOperand::isTied</a></div><div class="ttdeci">bool isTied() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00450">MachineOperand.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86Disassembler_html_a1e59b79e1d09149912cad9c0ef2809ad"><div class="ttname"><a href="namespacellvm_1_1X86Disassembler.html#a1e59b79e1d09149912cad9c0ef2809ad">llvm::X86Disassembler::Reg</a></div><div class="ttdeci">Reg</div><div class="ttdoc">All possible values of the reg field in the ModR/M byte.</div><div class="ttdef"><b>Definition:</b> <a href="X86DisassemblerDecoder_8h_source.html#l00462">X86DisassemblerDecoder.h:462</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00057">AArch64LoadStoreOptimizer.cpp:57</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunctionPass_html"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html">llvm::MachineFunctionPass</a></div><div class="ttdoc">MachineFunctionPass - This class adapts the FunctionPass interface to allow convenient creation of pa...</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8h_source.html#l00030">MachineFunctionPass.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64InstrInfo_html_a482f66b2913dcfcc84a4cfeafc83e304"><div class="ttname"><a href="classllvm_1_1AArch64InstrInfo.html#a482f66b2913dcfcc84a4cfeafc83e304">llvm::AArch64InstrInfo::isPreLdSt</a></div><div class="ttdeci">static bool isPreLdSt(const MachineInstr &amp;MI)</div><div class="ttdoc">Returns whether the instruction is a pre-indexed load/store.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8cpp_source.html#l03189">AArch64InstrInfo.cpp:3189</a></div></div>
<div class="ttc" id="aMachineBasicBlock_8h_html"><div class="ttname"><a href="MachineBasicBlock_8h.html">MachineBasicBlock.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRegUnits_html_a3996f7c3774880bfe32422602fe34f9c"><div class="ttname"><a href="classllvm_1_1LiveRegUnits.html#a3996f7c3774880bfe32422602fe34f9c">llvm::LiveRegUnits::available</a></div><div class="ttdeci">bool available(MCPhysReg Reg) const</div><div class="ttdoc">Returns true if no part of physical register Reg is live.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8h_source.html#l00116">LiveRegUnits.h:116</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00138">CommandLine.h:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html">llvm::TargetRegisterInfo</a></div><div class="ttdoc">TargetRegisterInfo base class - We assume that the target defines a static array of TargetRegisterDes...</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00236">TargetRegisterInfo.h:236</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRegUnits_html_ab2909dfae74e60e8dfd886b92e5a33e3"><div class="ttname"><a href="classllvm_1_1LiveRegUnits.html#ab2909dfae74e60e8dfd886b92e5a33e3">llvm::LiveRegUnits::addReg</a></div><div class="ttdeci">void addReg(MCPhysReg Reg)</div><div class="ttdoc">Adds register units covered by physical register Reg.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8h_source.html#l00086">LiveRegUnits.h:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64Subtarget_html_a39505e1fb9837807a81c02bd1eef7418"><div class="ttname"><a href="classllvm_1_1AArch64Subtarget.html#a39505e1fb9837807a81c02bd1eef7418">llvm::AArch64Subtarget::getInstrInfo</a></div><div class="ttdeci">const AArch64InstrInfo * getInstrInfo() const override</div><div class="ttdef"><b>Definition:</b> <a href="AArch64Subtarget_8h_source.html#l00181">AArch64Subtarget.h:181</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCRegisterInfo_html_adb90b36bb8dc9eb671c9611a9016b161"><div class="ttname"><a href="classllvm_1_1MCRegisterInfo.html#adb90b36bb8dc9eb671c9611a9016b161">llvm::MCRegisterInfo::sub_and_superregs_inclusive</a></div><div class="ttdeci">detail::concat_range&lt; const MCPhysReg, iterator_range&lt; mc_subreg_iterator &gt;, iterator_range&lt; mc_superreg_iterator &gt; &gt; sub_and_superregs_inclusive(MCRegister Reg) const</div><div class="ttdoc">Return an iterator range over all sub- and super-registers of Reg, including Reg.</div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00338">MCRegisterInfo.h:338</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_ab05719438bdf4b46871e5ecd9730caeb"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ab05719438bdf4b46871e5ecd9730caeb">llvm::MachineInstr::getMF</a></div><div class="ttdeci">const MachineFunction * getMF() const</div><div class="ttdoc">Return the function that contains the basic block that this instruction belongs to.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l00691">MachineInstr.cpp:691</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a7cf619a6fa8097611add0bd3cc2014d8"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a7cf619a6fa8097611add0bd3cc2014d8">isPromotableZeroStoreInst</a></div><div class="ttdeci">static bool isPromotableZeroStoreInst(MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00639">AArch64LoadStoreOptimizer.cpp:639</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a834634558d65f592c08010de0e548343"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a834634558d65f592c08010de0e548343">getMatchingWideOpcode</a></div><div class="ttdeci">static unsigned getMatchingWideOpcode(unsigned Opc)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00299">AArch64LoadStoreOptimizer.cpp:299</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunctionProperties_html"><div class="ttname"><a href="classllvm_1_1MachineFunctionProperties.html">llvm::MachineFunctionProperties</a></div><div class="ttdoc">Properties which a MachineFunction may have at a given point in time.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00128">MachineFunction.h:128</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSet_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSet.html">llvm::SmallPtrSet</a></div><div class="ttdoc">SmallPtrSet - This class implements a set which is optimized for holding SmallSize or less elements.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00450">SmallPtrSet.h:450</a></div></div>
<div class="ttc" id="anamespacellvm_html_ab4d4bc901fedd8857f647dcc2c0d71de"><div class="ttname"><a href="namespacellvm.html#ab4d4bc901fedd8857f647dcc2c0d71de">llvm::max</a></div><div class="ttdeci">Expected&lt; ExpressionValue &gt; max(const ExpressionValue &amp;Lhs, const ExpressionValue &amp;Rhs)</div><div class="ttdef"><b>Definition:</b> <a href="FileCheck_8cpp_source.html#l00337">FileCheck.cpp:337</a></div></div>
<div class="ttc" id="aMachineSink_8cpp_html_a0f36ed1bc17fc1aa97fe291c439a0698"><div class="ttname"><a href="MachineSink_8cpp.html#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a></div><div class="ttdeci">unsigned const TargetRegisterInfo * TRI</div><div class="ttdef"><b>Definition:</b> <a href="MachineSink_8cpp_source.html#l01628">MachineSink.cpp:1628</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8fac7522195671ed678db745338eb462"><div class="ttname"><a href="namespacellvm.html#a8fac7522195671ed678db745338eb462">llvm::createAArch64LoadStoreOptimizationPass</a></div><div class="ttdeci">FunctionPass * createAArch64LoadStoreOptimizationPass()</div><div class="ttdoc">createAArch64LoadStoreOptimizationPass - returns an instance of the load / store optimization pass.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l02335">AArch64LoadStoreOptimizer.cpp:2335</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunctionPass_html_a864fd57b4304ef933b3281d0ef85a88e"><div class="ttname"><a href="classllvm_1_1MachineFunctionPass.html#a864fd57b4304ef933b3281d0ef85a88e">llvm::MachineFunctionPass::getAnalysisUsage</a></div><div class="ttdeci">void getAnalysisUsage(AnalysisUsage &amp;AU) const override</div><div class="ttdoc">getAnalysisUsage - Subclasses that override getAnalysisUsage must call this.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunctionPass_8cpp_source.html#l00167">MachineFunctionPass.cpp:167</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64Subtarget_html_aa4c9f6d9092cf5ca3819973f4b297050"><div class="ttname"><a href="classllvm_1_1AArch64Subtarget.html#aa4c9f6d9092cf5ca3819973f4b297050">llvm::AArch64Subtarget::getTargetLowering</a></div><div class="ttdeci">const AArch64TargetLowering * getTargetLowering() const override</div><div class="ttdef"><b>Definition:</b> <a href="AArch64Subtarget_8h_source.html#l00178">AArch64Subtarget.h:178</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aSPIRVInstructionSelector_8cpp_html_a6fe0144adffd7bad0aeca668f4468b28"><div class="ttname"><a href="SPIRVInstructionSelector_8cpp.html#a6fe0144adffd7bad0aeca668f4468b28">isImm</a></div><div class="ttdeci">static bool isImm(const MachineOperand &amp;MO, MachineRegisterInfo *MRI)</div><div class="ttdef"><b>Definition:</b> <a href="SPIRVInstructionSelector_8cpp_source.html#l01218">SPIRVInstructionSelector.cpp:1218</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_aabc3917d917c6247778c88107945d13b"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aabc3917d917c6247778c88107945d13b">llvm::MachineInstr::hasOrderedMemoryRef</a></div><div class="ttdeci">bool hasOrderedMemoryRef() const</div><div class="ttdoc">Return true if this instruction may have an ordered or volatile memory reference, or if the informati...</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l01384">MachineInstr.cpp:1384</a></div></div>
<div class="ttc" id="aMachineRegisterInfo_8h_html"><div class="ttname"><a href="MachineRegisterInfo_8h.html">MachineRegisterInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_aafacf84de1cb994a92dc045f4aa1d518a4e4e6764dc61dbf0e8f330644880480f"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a4e4e6764dc61dbf0e8f330644880480f">llvm::MachineInstr::FrameDestroy</a></div><div class="ttdeci">@ FrameDestroy</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00086">MachineInstr.h:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_ac76c4d72f8d92470ab0936e03f66e67b"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ac76c4d72f8d92470ab0936e03f66e67b">llvm::MachineFunction::getFrameInstructions</a></div><div class="ttdeci">const std::vector&lt; MCCFIInstruction &gt; &amp; getFrameInstructions() const</div><div class="ttdoc">Returns a reference to a list of cfi instructions in the function's prologue.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l01072">MachineFunction.h:1072</a></div></div>
<div class="ttc" id="aAliasAnalysis_8h_html"><div class="ttname"><a href="AliasAnalysis_8h.html">AliasAnalysis.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a218bf4a49a8808ebb854ec9b89907904"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a218bf4a49a8808ebb854ec9b89907904">llvm::MachineRegisterInfo::tracksLiveness</a></div><div class="ttdeci">bool tracksLiveness() const</div><div class="ttdoc">tracksLiveness - Returns true when tracking register liveness accurately.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00209">MachineRegisterInfo.h:209</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a09329b4e0eccb30fbf5726df9320d210"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a09329b4e0eccb30fbf5726df9320d210">INITIALIZE_PASS</a></div><div class="ttdeci">INITIALIZE_PASS(AArch64LoadStoreOpt, &quot;aarch64-ldst-opt&quot;, AARCH64_LOAD_STORE_OPT_NAME, false, false) static bool isNarrowStore(unsigned Opc)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00219">AArch64LoadStoreOptimizer.cpp:219</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition:</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCCFIInstruction_html_a26347ad83355eafb75fecd4bce9d7abbacbbd41f459c6cea155b66a7ba10f1058"><div class="ttname"><a href="classllvm_1_1MCCFIInstruction.html#a26347ad83355eafb75fecd4bce9d7abbacbbd41f459c6cea155b66a7ba10f1058">llvm::MCCFIInstruction::OpDefCfa</a></div><div class="ttdeci">@ OpDefCfa</div><div class="ttdef"><b>Definition:</b> <a href="MCDwarf_8h_source.html#l00489">MCDwarf.h:489</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a8be49bc86b5d01b52b90baf1b4477667"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a8be49bc86b5d01b52b90baf1b4477667">llvm::MachineOperand::isRenamable</a></div><div class="ttdeci">bool isRenamable() const</div><div class="ttdoc">isRenamable - Returns true if this register may be renamed, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8cpp_source.html#l00124">MachineOperand.cpp:124</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterClass_html_a60b6974966381f08079722f2258a0039"><div class="ttname"><a href="classllvm_1_1TargetRegisterClass.html#a60b6974966381f08079722f2258a0039">llvm::TargetRegisterClass::contains</a></div><div class="ttdeci">bool contains(Register Reg) const</div><div class="ttdoc">Return true if the specified register is included in this register class.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00096">TargetRegisterInfo.h:96</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ab4e05d690df389b8b1477c90387b575f"><div class="ttname"><a href="classllvm_1_1Instruction.html#ab4e05d690df389b8b1477c90387b575f">llvm::Instruction::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns a member of one of the enums like Instruction::Add.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00168">Instruction.h:168</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0d10fe510ced2849a8074fe81e5d04ce"><div class="ttname"><a href="namespacellvm.html#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all_of</a></div><div class="ttdeci">bool all_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::all_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01735">STLExtras.h:1735</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_ab4a6ca428289b667dd691a00e9f7e334"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ab4a6ca428289b667dd691a00e9f7e334">llvm::MachineFunction::getRegInfo</a></div><div class="ttdeci">MachineRegisterInfo &amp; getRegInfo()</div><div class="ttdoc">getRegInfo - Return information about the registers currently in use.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00682">MachineFunction.h:682</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a3bf161859e1ad7fd3da485d3cb688d34"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a3bf161859e1ad7fd3da485d3cb688d34">llvm::MachineOperand::isImplicit</a></div><div class="ttdeci">bool isImplicit() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00389">MachineOperand.h:389</a></div></div>
<div class="ttc" id="aAArch64InstrInfo_8h_html"><div class="ttname"><a href="AArch64InstrInfo_8h.html">AArch64InstrInfo.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00024">PassRegistry.cpp:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRegUnits_html_af7ea64c95b144306f76693d958be9741"><div class="ttname"><a href="classllvm_1_1LiveRegUnits.html#af7ea64c95b144306f76693d958be9741">llvm::LiveRegUnits::accumulate</a></div><div class="ttdeci">void accumulate(const MachineInstr &amp;MI)</div><div class="ttdoc">Adds all register units used, defined or clobbered in MI.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8cpp_source.html#l00069">LiveRegUnits.cpp:69</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResults_html"><div class="ttname"><a href="classllvm_1_1AAResults.html">llvm::AAResults</a></div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00294">AliasAnalysis.h:294</a></div></div>
<div class="ttc" id="aMipsDisassembler_8cpp_html_a15b5b86944f6df97d2c3659d77f51f91"><div class="ttname"><a href="MipsDisassembler_8cpp.html#a15b5b86944f6df97d2c3659d77f51f91">getReg</a></div><div class="ttdeci">static unsigned getReg(const MCDisassembler *D, unsigned RC, unsigned RegNo)</div><div class="ttdef"><b>Definition:</b> <a href="MipsDisassembler_8cpp_source.html#l00521">MipsDisassembler.cpp:521</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64InstrInfo_html"><div class="ttname"><a href="classllvm_1_1AArch64InstrInfo.html">llvm::AArch64InstrInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8h_source.html#l00035">AArch64InstrInfo.h:35</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a38b28a85f818b49d8806c150b8a5b4f7"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a38b28a85f818b49d8806c150b8a5b4f7">llvm::MachineOperand::getImm</a></div><div class="ttdeci">int64_t getImm() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00556">MachineOperand.h:556</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a69544ec8658eadeed98245dc37c3a541"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a69544ec8658eadeed98245dc37c3a541">llvm::MachineOperand::isUse</a></div><div class="ttdeci">bool isUse() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00379">MachineOperand.h:379</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a3f7a45f6e10668a5f702e26bca80d18e"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a3f7a45f6e10668a5f702e26bca80d18e">llvm::MachineInstr::getOperand</a></div><div class="ttdeci">const MachineOperand &amp; getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00526">MachineInstr.h:526</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineRegisterInfo_html_a53ca7cff9e929ba372da9780fdd44b02"><div class="ttname"><a href="classllvm_1_1MachineRegisterInfo.html#a53ca7cff9e929ba372da9780fdd44b02">llvm::MachineRegisterInfo::isReserved</a></div><div class="ttdeci">bool isReserved(MCRegister PhysReg) const</div><div class="ttdoc">isReserved - Returns true when PhysReg is a reserved register.</div><div class="ttdef"><b>Definition:</b> <a href="MachineRegisterInfo_8h_source.html#l00956">MachineRegisterInfo.h:956</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_ac03c5fd861f5d44077b3201b64495c9f"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#ac03c5fd861f5d44077b3201b64495c9f">getPostIndexedOpcode</a></div><div class="ttdeci">static unsigned getPostIndexedOpcode(unsigned Opc)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00481">AArch64LoadStoreOptimizer.cpp:481</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a55aec6d9959470668bae2aeb8a7c0768"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a55aec6d9959470668bae2aeb8a7c0768">llvm::MachineInstr::mayAlias</a></div><div class="ttdeci">bool mayAlias(AAResults *AA, const MachineInstr &amp;Other, bool UseTBAA) const</div><div class="ttdoc">Returns true if this instruction's memory access aliases the memory access of Other.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8cpp_source.html#l01336">MachineInstr.cpp:1336</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterClass_html"><div class="ttname"><a href="classllvm_1_1TargetRegisterClass.html">llvm::TargetRegisterClass</a></div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00045">TargetRegisterInfo.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3747b99818482ff4e375eeb25d09c143"><div class="ttname"><a href="namespacellvm.html#a3747b99818482ff4e375eeb25d09c143">llvm::phys_regs_and_masks</a></div><div class="ttdeci">iterator_range&lt; filter_iterator&lt; ConstMIBundleOperands, std::function&lt; bool(const MachineOperand &amp;)&gt; &gt; &gt; phys_regs_and_masks(const MachineInstr &amp;MI)</div><div class="ttdoc">Returns an iterator range over all physical register and mask operands for MI and bundled instruction...</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8h_source.html#l00166">LiveRegUnits.h:166</a></div></div>
<div class="ttc" id="aHexagonCopyToCombine_8cpp_html_a1d40004718218dbdf06b496766299101"><div class="ttname"><a href="HexagonCopyToCombine_8cpp.html#a1d40004718218dbdf06b496766299101">TII</a></div><div class="ttdeci">const HexagonInstrInfo * TII</div><div class="ttdef"><b>Definition:</b> <a href="HexagonCopyToCombine_8cpp_source.html#l00125">HexagonCopyToCombine.cpp:125</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a7abf5fb4071cb25dbce06dfb5ee3c937"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a7abf5fb4071cb25dbce06dfb5ee3c937">B</a></div><div class="ttdeci">static GCRegistry::Add&lt; OcamlGC &gt; B(&quot;ocaml&quot;, &quot;ocaml 3.10-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html"><div class="ttname"><a href="classllvm_1_1MachineOperand.html">llvm::MachineOperand</a></div><div class="ttdoc">MachineOperand class - Representation of each machine instruction operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00048">MachineOperand.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunctionProperties_html_aa0f2b6097642894ce79ff3e15c896206"><div class="ttname"><a href="classllvm_1_1MachineFunctionProperties.html#aa0f2b6097642894ce79ff3e15c896206">llvm::MachineFunctionProperties::set</a></div><div class="ttdeci">MachineFunctionProperties &amp; set(Property P)</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00197">MachineFunction.h:197</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aafacf84de1cb994a92dc045f4aa1d518a78f1067d270179dff7915b90a03ce237">llvm::MachineInstr::FrameSetup</a></div><div class="ttdeci">@ FrameSetup</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00084">MachineInstr.h:84</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a55450149fa2fc8fb50d587023814ea69"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a55450149fa2fc8fb50d587023814ea69">mayAlias</a></div><div class="ttdeci">static bool mayAlias(MachineInstr &amp;MIa, SmallVectorImpl&lt; MachineInstr * &gt; &amp;MemInsns, AliasAnalysis *AA)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01208">AArch64LoadStoreOptimizer.cpp:1208</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_aeae88f12b667477f90db9b726556b337"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#aeae88f12b667477f90db9b726556b337">llvm::AArch64_AM::getShifterImm</a></div><div class="ttdeci">static unsigned getShifterImm(AArch64_AM::ShiftExtendType ST, unsigned Imm)</div><div class="ttdoc">getShifterImm - Encode the shift type and amount: imm: 6-bit shift amount shifter: 000 ==&gt; lsl 001 ==...</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00099">AArch64AddressingModes.h:99</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugCounter_html_a5aace8653ce3726ef07194dcf6bce2bf"><div class="ttname"><a href="classllvm_1_1DebugCounter.html#a5aace8653ce3726ef07194dcf6bce2bf">llvm::DebugCounter::shouldExecute</a></div><div class="ttdeci">static bool shouldExecute(unsigned CounterName)</div><div class="ttdef"><b>Definition:</b> <a href="DebugCounter_8h_source.html#l00072">DebugCounter.h:72</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a651f363be7841a2d798ed393b7d01a7d"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a651f363be7841a2d798ed393b7d01a7d">LdStLimit</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; LdStLimit(&quot;aarch64-load-store-scan-limit&quot;, cl::init(20), cl::Hidden)</div></div>
<div class="ttc" id="anamespacellvm_html_a0bf75467957937ad23ad7be19f489934"><div class="ttname"><a href="namespacellvm.html#a0bf75467957937ad23ad7be19f489934">llvm::STATISTIC</a></div><div class="ttdeci">STATISTIC(NumFunctions, &quot;Total number of functions&quot;)</div></div>
<div class="ttc" id="aLoopDeletion_8cpp_html_a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64"><div class="ttname"><a href="LoopDeletion_8cpp.html#a0f1c83c3d08d80b12c424962a5e94ce8a35e0c8c0b180c95d4e122e55ed62cc64">LoopDeletionResult::Modified</a></div><div class="ttdeci">@ Modified</div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_aae1f40fb1287aaa0c9bab009ba9802b3"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#aae1f40fb1287aaa0c9bab009ba9802b3">forAllMIsUntilDef</a></div><div class="ttdeci">static bool forAllMIsUntilDef(MachineInstr &amp;MI, MCPhysReg DefReg, const TargetRegisterInfo *TRI, unsigned Limit, std::function&lt; bool(MachineInstr &amp;, bool)&gt; &amp;Fn)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00794">AArch64LoadStoreOptimizer.cpp:794</a></div></div>
<div class="ttc" id="aBitVector_8h_html"><div class="ttname"><a href="BitVector_8h.html">BitVector.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AArch64__AM_html_a22f623563f43de6d1aabcdfa9d341031"><div class="ttname"><a href="namespacellvm_1_1AArch64__AM.html#a22f623563f43de6d1aabcdfa9d341031">llvm::AArch64_AM::getShiftValue</a></div><div class="ttdeci">static unsigned getShiftValue(unsigned Imm)</div><div class="ttdoc">getShiftValue - Extract the shift value.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64AddressingModes_8h_source.html#l00086">AArch64AddressingModes.h:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCCFIInstruction_html_a9d7ee9c6eaabde95dd9695326a77f253"><div class="ttname"><a href="classllvm_1_1MCCFIInstruction.html#a9d7ee9c6eaabde95dd9695326a77f253">llvm::MCCFIInstruction::getOperation</a></div><div class="ttdeci">OpType getOperation() const</div><div class="ttdef"><b>Definition:</b> <a href="MCDwarf_8h_source.html#l00642">MCDwarf.h:642</a></div></div>
<div class="ttc" id="aDebugLoc_8h_html"><div class="ttname"><a href="DebugLoc_8h.html">DebugLoc.h</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a30157a5020934199c281913d8d077f55"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a30157a5020934199c281913d8d077f55">areCandidatesToMergeOrPair</a></div><div class="ttdeci">static bool areCandidatesToMergeOrPair(MachineInstr &amp;FirstMI, MachineInstr &amp;MI, LdStPairFlags &amp;Flags, const AArch64InstrInfo *TII)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01286">AArch64LoadStoreOptimizer.cpp:1286</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a15d6de941763b0ffe5b5737390f23a57"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a15d6de941763b0ffe5b5737390f23a57">getPrePostIndexedMemOpInfo</a></div><div class="ttdeci">static void getPrePostIndexedMemOpInfo(const MachineInstr &amp;MI, int &amp;Scale, int &amp;MinOffset, int &amp;MaxOffset)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00592">AArch64LoadStoreOptimizer.cpp:592</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRegUnits_html"><div class="ttname"><a href="classllvm_1_1LiveRegUnits.html">llvm::LiveRegUnits</a></div><div class="ttdoc">A set of register units used to track register liveness.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8h_source.html#l00030">LiveRegUnits.h:30</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_acc2131ae9988ee48d2c8d53735dd537b"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#acc2131ae9988ee48d2c8d53735dd537b">DEBUG_COUNTER</a></div><div class="ttdeci">DEBUG_COUNTER(RegRenamingCounter, DEBUG_TYPE &quot;-reg-renaming&quot;, &quot;Controls which pairs are considered for renaming&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1LiveRegUnits_html_af27497ce6068478bb97765620191e351"><div class="ttname"><a href="classllvm_1_1LiveRegUnits.html#af27497ce6068478bb97765620191e351">llvm::LiveRegUnits::removeReg</a></div><div class="ttdeci">void removeReg(MCPhysReg Reg)</div><div class="ttdoc">Removes all register units covered by physical register Reg.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8h_source.html#l00102">LiveRegUnits.h:102</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a297bc50d0b309b05e88b37479f9d6973"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a297bc50d0b309b05e88b37479f9d6973">EnableRenaming</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; EnableRenaming(&quot;aarch64-load-store-renaming&quot;, cl::init(true), cl::Hidden)</div></div>
<div class="ttc" id="anamespacellvm_1_1CallingConv_html_a188c0836f8c3528401f1c236fd93b977"><div class="ttname"><a href="namespacellvm_1_1CallingConv.html#a188c0836f8c3528401f1c236fd93b977">llvm::CallingConv::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdoc">LLVM IR allows to use arbitrary numbers as calling convention identifiers.</div><div class="ttdef"><b>Definition:</b> <a href="CallingConv_8h_source.html#l00024">CallingConv.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCCFIInstruction_html"><div class="ttname"><a href="classllvm_1_1MCCFIInstruction.html">llvm::MCCFIInstruction</a></div><div class="ttdef"><b>Definition:</b> <a href="MCDwarf_8h_source.html#l00479">MCDwarf.h:479</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html">llvm::MachineBasicBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00094">MachineBasicBlock.h:94</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_aef3719986b91bc4fac189135bd3795a8"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#aef3719986b91bc4fac189135bd3795a8">isPreLdStPairCandidate</a></div><div class="ttdeci">static bool isPreLdStPairCandidate(MachineInstr &amp;FirstMI, MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00560">AArch64LoadStoreOptimizer.cpp:560</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a33a9bde0ee9fe5d047f5c84642436bb8"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a33a9bde0ee9fe5d047f5c84642436bb8">needsWinCFI</a></div><div class="ttdeci">static bool needsWinCFI(const MachineFunction *MF)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01279">AArch64LoadStoreOptimizer.cpp:1279</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a530d5e41c3cf67937c373da61c65acd4"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a530d5e41c3cf67937c373da61c65acd4">llvm::MCID::MayLoad</a></div><div class="ttdeci">@ MayLoad</div><div class="ttdef"><b>Definition:</b> <a href="MCInstrDesc_8h_source.html#l00168">MCInstrDesc.h:168</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunctionProperties_html_ad85237c6c667e4713efe8921e9c32ac1a72f7d830dd5ddb30f06d8e9639558ac3"><div class="ttname"><a href="classllvm_1_1MachineFunctionProperties.html#ad85237c6c667e4713efe8921e9c32ac1a72f7d830dd5ddb30f06d8e9639558ac3">llvm::MachineFunctionProperties::Property::NoVRegs</a></div><div class="ttdeci">@ NoVRegs</div></div>
<div class="ttc" id="aAArch64AddressingModes_8h_html"><div class="ttname"><a href="AArch64AddressingModes_8h.html">AArch64AddressingModes.h</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_adf93253be357fe9cc086b28ae4b98841"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#adf93253be357fe9cc086b28ae4b98841">UpdateLimit</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; UpdateLimit(&quot;aarch64-update-scan-limit&quot;, cl::init(100), cl::Hidden)</div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a325f6b611ef9ec06798d3b4eb9572093"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a325f6b611ef9ec06798d3b4eb9572093">llvm::MachineFunction::getSubtarget</a></div><div class="ttdeci">const TargetSubtargetInfo &amp; getSubtarget() const</div><div class="ttdoc">getSubtarget - Return the subtarget for which this machine code is being compiled.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00672">MachineFunction.h:672</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l01410">CommandLine.h:1410</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00301">Instructions.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_ab5dddfd4ef6db864a18ecdbe51331b92"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#ab5dddfd4ef6db864a18ecdbe51331b92">llvm::TargetRegisterInfo::regsOverlap</a></div><div class="ttdeci">bool regsOverlap(Register RegA, Register RegB) const</div><div class="ttdoc">Returns true if the two registers are equal or alias each other.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00421">TargetRegisterInfo.h:421</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_a55ad07e4cbe29bea4cb69b78472b690e"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a55ad07e4cbe29bea4cb69b78472b690e">llvm::TargetRegisterInfo::getRegClass</a></div><div class="ttdeci">const TargetRegisterClass * getRegClass(unsigned i) const</div><div class="ttdoc">Returns the register class associated with the enumeration value.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00778">TargetRegisterInfo.h:778</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCCFIInstruction_html_a26347ad83355eafb75fecd4bce9d7abba5822faf65b27795cd48bd44712d48927"><div class="ttname"><a href="classllvm_1_1MCCFIInstruction.html#a26347ad83355eafb75fecd4bce9d7abba5822faf65b27795cd48bd44712d48927">llvm::MCCFIInstruction::OpDefCfaOffset</a></div><div class="ttdeci">@ OpDefCfaOffset</div><div class="ttdef"><b>Definition:</b> <a href="MCDwarf_8h_source.html#l00488">MCDwarf.h:488</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_ab42a834f1ab8e65b6f525a5cb23a4fe7"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab42a834f1ab8e65b6f525a5cb23a4fe7">llvm::MachineBasicBlock::instr_rend</a></div><div class="ttdeci">reverse_instr_iterator instr_rend()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00299">MachineBasicBlock.h:299</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a4c9594c955fec80c73ddd964b5efd554"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a4c9594c955fec80c73ddd964b5efd554">llvm::MachineOperand::isReg</a></div><div class="ttdeci">bool isReg() const</div><div class="ttdoc">isReg - Tests if this is a MO_Register operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00329">MachineOperand.h:329</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html"><div class="ttname"><a href="classllvm_1_1MachineInstr.html">llvm::MachineInstr</a></div><div class="ttdoc">Representation of each machine instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00066">MachineInstr.h:66</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html">llvm::MachineInstrBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00069">MachineInstrBuilder.h:69</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a9dc8254630582aab188826a20ce95f36"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a9dc8254630582aab188826a20ce95f36">isTagStore</a></div><div class="ttdeci">static bool isTagStore(const MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00236">AArch64LoadStoreOptimizer.cpp:236</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_ac80ef1b0f96f5df74292346277f0005b"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#ac80ef1b0f96f5df74292346277f0005b">llvm::TargetRegisterInfo::getRegClassName</a></div><div class="ttdeci">const char * getRegClassName(const TargetRegisterClass *Class) const</div><div class="ttdoc">Returns the name of the register class.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00784">TargetRegisterInfo.h:784</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a6cfadf0d2bf5ec4aa6119d058cf4623a"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a6cfadf0d2bf5ec4aa6119d058cf4623a">getPreIndexedOpcode</a></div><div class="ttdeci">static unsigned getPreIndexedOpcode(unsigned Opc)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00408">AArch64LoadStoreOptimizer.cpp:408</a></div></div>
<div class="ttc" id="anamespacellvm_1_1numbers_html_a92f4283d4e0e2ea1776894b3ae93640f"><div class="ttname"><a href="namespacellvm_1_1numbers.html#a92f4283d4e0e2ea1776894b3ae93640f">llvm::numbers::e</a></div><div class="ttdeci">constexpr double e</div><div class="ttdef"><b>Definition:</b> <a href="MathExtras_8h_source.html#l00031">MathExtras.h:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_aa5aad3f9195b1fd331f449ce9a709da2"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#aa5aad3f9195b1fd331f449ce9a709da2">llvm::TargetRegisterInfo::getMatchingSuperReg</a></div><div class="ttdeci">MCRegister getMatchingSuperReg(MCRegister Reg, unsigned SubIdx, const TargetRegisterClass *RC) const</div><div class="ttdoc">Return a super-register of the specified register Reg so its sub-register of index SubIdx is Reg.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l00600">TargetRegisterInfo.h:600</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="anamespacellvm_html_a298184c9a0cd665d7cfc55f6a59204a4"><div class="ttname"><a href="namespacellvm.html#a298184c9a0cd665d7cfc55f6a59204a4">llvm::MCPhysReg</a></div><div class="ttdeci">uint16_t MCPhysReg</div><div class="ttdoc">An unsigned integer type large enough to represent all physical registers, but not necessarily virtua...</div><div class="ttdef"><b>Definition:</b> <a href="MCRegister_8h_source.html#l00021">MCRegister.h:21</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a10a041239ae1870cfcc064bfaa79fb65"><div class="ttname"><a href="namespacellvm_1_1cl.html#a10a041239ae1870cfcc064bfaa79fb65">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition:</b> <a href="CommandLine_8h_source.html#l00445">CommandLine.h:445</a></div></div>
<div class="ttc" id="aMCRegisterInfo_8h_html"><div class="ttname"><a href="MCRegisterInfo_8h.html">MCRegisterInfo.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae74dcdb801fe44b3840dd93e6c395066"><div class="ttname"><a href="namespacellvm.html#ae74dcdb801fe44b3840dd93e6c395066">llvm::prev_nodbg</a></div><div class="ttdeci">IterT prev_nodbg(IterT It, IterT Begin, bool SkipPseudoOp=true)</div><div class="ttdoc">Decrement It, then continue decrementing it while it points to a debug instruction.</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01330">MachineBasicBlock.h:1330</a></div></div>
<div class="ttc" id="aMachineFunctionPass_8h_html"><div class="ttname"><a href="MachineFunctionPass_8h.html">MachineFunctionPass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1LiveRegUnits_html_a5e7fb90824f599580585b3b5c5116614"><div class="ttname"><a href="classllvm_1_1LiveRegUnits.html#a5e7fb90824f599580585b3b5c5116614">llvm::LiveRegUnits::init</a></div><div class="ttdeci">void init(const TargetRegisterInfo &amp;TRI)</div><div class="ttdoc">Initialize and clear the set.</div><div class="ttdef"><b>Definition:</b> <a href="LiveRegUnits_8h_source.html#l00073">LiveRegUnits.h:73</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_abd6aa9da048ef7a4faeaac6484d5c9a6"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#abd6aa9da048ef7a4faeaac6484d5c9a6">llvm::MachineOperand::isEarlyClobber</a></div><div class="ttdeci">bool isEarlyClobber() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00445">MachineOperand.h:445</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_a4e21760f681d6f97f95c8414e7b83ea5"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#a4e21760f681d6f97f95c8414e7b83ea5">llvm::MachineBasicBlock::getParent</a></div><div class="ttdeci">const MachineFunction * getParent() const</div><div class="ttdoc">Return the MachineFunction containing this basic block.</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00265">MachineBasicBlock.h:265</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_af848272aaea9ac1f976aaf56fd31cb8d"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#af848272aaea9ac1f976aaf56fd31cb8d">canRenameUpToDef</a></div><div class="ttdeci">static bool canRenameUpToDef(MachineInstr &amp;FirstMI, LiveRegUnits &amp;UsedInBetween, SmallPtrSetImpl&lt; const TargetRegisterClass * &gt; &amp;RequiredClasses, const TargetRegisterInfo *TRI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01344">AArch64LoadStoreOptimizer.cpp:1344</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a94c1ab02555b5022baf4e16d66032338"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a94c1ab02555b5022baf4e16d66032338">maybeMoveCFI</a></div><div class="ttdeci">static MachineBasicBlock::iterator maybeMoveCFI(MachineInstr &amp;MI, MachineBasicBlock::iterator MaybeCFI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01763">AArch64LoadStoreOptimizer.cpp:1763</a></div></div>
<div class="ttc" id="aiterator__range_8h_html"><div class="ttname"><a href="iterator__range_8h.html">iterator_range.h</a></div></div>
<div class="ttc" id="aMemDepPrinter_8cpp_html_a470d8721ad7c3b718e9daeabdaeb4700"><div class="ttname"><a href="MemDepPrinter_8cpp.html#a470d8721ad7c3b718e9daeabdaeb4700">function</a></div><div class="ttdeci">print Print MemDeps of function</div><div class="ttdef"><b>Definition:</b> <a href="MemDepPrinter_8cpp_source.html#l00082">MemDepPrinter.cpp:82</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_ad08ed580345a51c50d9477dec1e65818"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#ad08ed580345a51c50d9477dec1e65818">llvm::MachineInstrBuilder::addReg</a></div><div class="ttdeci">const MachineInstrBuilder &amp; addReg(Register RegNo, unsigned flags=0, unsigned SubReg=0) const</div><div class="ttdoc">Add a new virtual register operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00097">MachineInstrBuilder.h:97</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_ac0035d7c1c860501c877c20e6e93297b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#ac0035d7c1c860501c877c20e6e93297b">llvm::MachineOperand::getReg</a></div><div class="ttdeci">Register getReg() const</div><div class="ttdoc">getReg - Returns the register number.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00369">MachineOperand.h:369</a></div></div>
<div class="ttc" id="aVPlanSLP_8cpp_html_af04704e906a9654777e92a4612c58c13"><div class="ttname"><a href="VPlanSLP_8cpp.html#af04704e906a9654777e92a4612c58c13">getOpcode</a></div><div class="ttdeci">static std::optional&lt; unsigned &gt; getOpcode(ArrayRef&lt; VPValue * &gt; Values)</div><div class="ttdoc">Returns the opcode of Values or ~0 if they do not all agree.</div><div class="ttdef"><b>Definition:</b> <a href="VPlanSLP_8cpp_source.html#l00191">VPlanSLP.cpp:191</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html"><div class="ttname"><a href="classllvm_1_1MachineFunction.html">llvm::MachineFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00258">MachineFunction.h:258</a></div></div>
<div class="ttc" id="anamespacellvm_html_a67980a8ae101d2fda845eb750ffb1942"><div class="ttname"><a href="namespacellvm.html#a67980a8ae101d2fda845eb750ffb1942">llvm::print</a></div><div class="ttdeci">Printable print(const GCNRegPressure &amp;RP, const GCNSubtarget *ST=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="GCNRegPressure_8cpp_source.html#l00138">GCNRegPressure.cpp:138</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetMachine_html_a171c7253c2b03171bdf22c1bd910f674"><div class="ttname"><a href="classllvm_1_1TargetMachine.html#a171c7253c2b03171bdf22c1bd910f674">llvm::TargetMachine::getMCAsmInfo</a></div><div class="ttdeci">const MCAsmInfo * getMCAsmInfo() const</div><div class="ttdoc">Return target specific asm information.</div><div class="ttdef"><b>Definition:</b> <a href="Target_2TargetMachine_8h_source.html#l00213">TargetMachine.h:213</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_ae32b2c05b1bcc5413b940dd7d4d5701e"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#ae32b2c05b1bcc5413b940dd7d4d5701e">isLdOffsetInRangeOfSt</a></div><div class="ttdeci">static bool isLdOffsetInRangeOfSt(MachineInstr &amp;LoadInst, MachineInstr &amp;StoreInst, const AArch64InstrInfo *TII)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00621">AArch64LoadStoreOptimizer.cpp:621</a></div></div>
<div class="ttc" id="aMCAsmInfo_8h_html"><div class="ttname"><a href="MCAsmInfo_8h.html">MCAsmInfo.h</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a200a5e0929ef13cb3e07c368f26f381b"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a200a5e0929ef13cb3e07c368f26f381b">inBoundsForPair</a></div><div class="ttdeci">static bool inBoundsForPair(bool IsUnscaled, int Offset, int OffsetStride)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01187">AArch64LoadStoreOptimizer.cpp:1187</a></div></div>
<div class="ttc" id="anamespacellvm_html_a61d13d6824ec46c31260a4fd0997eda0"><div class="ttname"><a href="namespacellvm.html#a61d13d6824ec46c31260a4fd0997eda0">llvm::any_of</a></div><div class="ttdeci">bool any_of(R &amp;&amp;range, UnaryPredicate P)</div><div class="ttdoc">Provide wrappers to std::any_of which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="STLExtras_8h_source.html#l01742">STLExtras.h:1742</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="StringRef_8h_source.html#l00050">StringRef.h:50</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_adf0023bdc4f05a7849c35b1c859580d8"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#adf0023bdc4f05a7849c35b1c859580d8">llvm::MachineBasicBlock::splice</a></div><div class="ttdeci">void splice(iterator Where, MachineBasicBlock *Other, iterator From)</div><div class="ttdoc">Take an instruction from MBB 'Other' at the position From, and insert it into this MBB right before '...</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01037">MachineBasicBlock.h:1037</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad5f691fdc1a09aaf6df5fef958b35a3d"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad5f691fdc1a09aaf6df5fef958b35a3d">MBBI</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator MBBI</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00075">AArch64SLSHardening.cpp:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a0363204b5fbab08a46f5a7cd7f376f78"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a0363204b5fbab08a46f5a7cd7f376f78">llvm::MachineInstr::getOpcode</a></div><div class="ttdeci">unsigned getOpcode() const</div><div class="ttdoc">Returns the opcode of this MachineInstr.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00516">MachineInstr.h:516</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a32cf4b907c8f032509e95774aeb994f8"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a32cf4b907c8f032509e95774aeb994f8">tryToFindRegisterToRename</a></div><div class="ttdeci">static std::optional&lt; MCPhysReg &gt; tryToFindRegisterToRename(const MachineFunction &amp;MF, Register Reg, LiveRegUnits &amp;DefinedInBB, LiveRegUnits &amp;UsedInBetween, SmallPtrSetImpl&lt; const TargetRegisterClass * &gt; &amp;RequiredClasses, const TargetRegisterInfo *TRI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l01473">AArch64LoadStoreOptimizer.cpp:1473</a></div></div>
<div class="ttc" id="anamespacellvm_html_a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4"><div class="ttname"><a href="namespacellvm.html#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">llvm::Offset</a></div><div class="ttdeci">@ Offset</div><div class="ttdef"><b>Definition:</b> <a href="DWP_8cpp_source.html#l00406">DWP.cpp:406</a></div></div>
<div class="ttc" id="aSupport_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="Support_2ErrorHandling_8h_source.html#l00143">ErrorHandling.h:143</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00082">ilist_node.h:82</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a75eb135014670ce946e78739cdc9b51b"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a75eb135014670ce946e78739cdc9b51b">llvm::MachineOperand::isDef</a></div><div class="ttdeci">bool isDef() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00384">MachineOperand.h:384</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_a002fd916e7206e01d512eeb06d405cf0"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#a002fd916e7206e01d512eeb06d405cf0">llvm::MachineInstr::getParent</a></div><div class="ttdeci">const MachineBasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00313">MachineInstr.h:313</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00177">Instructions.h:177</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a8ed3ca165cdb5bd4085f5f56a5795a85"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a8ed3ca165cdb5bd4085f5f56a5795a85">llvm::MachineInstrBuilder::cloneMergedMemRefs</a></div><div class="ttdeci">const MachineInstrBuilder &amp; cloneMergedMemRefs(ArrayRef&lt; const MachineInstr * &gt; OtherMIs) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00219">MachineInstrBuilder.h:219</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a54ce61c9315f4d35304a86cb34388921"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a54ce61c9315f4d35304a86cb34388921">llvm::MachineInstrBuilder::getInstr</a></div><div class="ttdeci">MachineInstr * getInstr() const</div><div class="ttdoc">If conversion operators fail, use this method to get the MachineInstr explicitly.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00089">MachineInstrBuilder.h:89</a></div></div>
<div class="ttc" id="aclassllvm_1_1Register_html"><div class="ttname"><a href="classllvm_1_1Register.html">llvm::Register</a></div><div class="ttdoc">Wrapper class representing virtual and physical registers.</div><div class="ttdef"><b>Definition:</b> <a href="Register_8h_source.html#l00019">Register.h:19</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_a5958512eae2979bd2eb383977996a600"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#a5958512eae2979bd2eb383977996a600">MBB</a></div><div class="ttdeci">MachineBasicBlock &amp; MBB</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00074">AArch64SLSHardening.cpp:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64Subtarget_html_a69f50b8c0a70f57950c142ca963e1cb5"><div class="ttname"><a href="classllvm_1_1AArch64Subtarget.html#a69f50b8c0a70f57950c142ca963e1cb5">llvm::AArch64Subtarget::getRegisterInfo</a></div><div class="ttdeci">const AArch64RegisterInfo * getRegisterInfo() const override</div><div class="ttdef"><b>Definition:</b> <a href="AArch64Subtarget_8h_source.html#l00182">AArch64Subtarget.h:182</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64InstrInfo_html_af66bca919a5501ae9f377298fd684864"><div class="ttname"><a href="classllvm_1_1AArch64InstrInfo.html#af66bca919a5501ae9f377298fd684864">llvm::AArch64InstrInfo::getLdStBaseOp</a></div><div class="ttdeci">static const MachineOperand &amp; getLdStBaseOp(const MachineInstr &amp;MI)</div><div class="ttdoc">Returns the base register operator of a load/store.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8cpp_source.html#l03213">AArch64InstrInfo.cpp:3213</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a131caae6e5e55eccd4efe928baa973ef"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a131caae6e5e55eccd4efe928baa973ef">isPromotableLoadFromStore</a></div><div class="ttdeci">static bool isPromotableLoadFromStore(MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00646">AArch64LoadStoreOptimizer.cpp:646</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a4b21394c138cc5ae719510bb529ee099"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a4b21394c138cc5ae719510bb529ee099">llvm::MachineFunction::getFunction</a></div><div class="ttdeci">Function &amp; getFunction()</div><div class="ttdoc">Return the LLVM function that this machine code represents.</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00638">MachineFunction.h:638</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64InstrInfo_html_a6ba8f62a5514943195111193dfd7ae08"><div class="ttname"><a href="classllvm_1_1AArch64InstrInfo.html#a6ba8f62a5514943195111193dfd7ae08">llvm::AArch64InstrInfo::isPairedLdSt</a></div><div class="ttdeci">static bool isPairedLdSt(const MachineInstr &amp;MI)</div><div class="ttdoc">Returns whether the instruction is a paired load/store.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8cpp_source.html#l03193">AArch64InstrInfo.cpp:3193</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_ae68d159179d37dc7969439d842e2644f"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#ae68d159179d37dc7969439d842e2644f">llvm::MachineFunction::getTarget</a></div><div class="ttdeci">const LLVMTargetMachine &amp; getTarget() const</div><div class="ttdoc">getTarget - Return the target machine this machine code is compiled with</div><div class="ttdef"><b>Definition:</b> <a href="MachineFunction_8h_source.html#l00668">MachineFunction.h:668</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac984e10b62f9eb21b5ffdd07c1a12fb2"><div class="ttname"><a href="namespacellvm.html#ac984e10b62f9eb21b5ffdd07c1a12fb2">llvm::initializeAArch64LoadStoreOptPass</a></div><div class="ttdeci">void initializeAArch64LoadStoreOptPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_ab96f3235c18e659758517d0532d606c9"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#ab96f3235c18e659758517d0532d606c9">llvm::MachineInstr::mayStore</a></div><div class="ttdeci">bool mayStore(QueryType Type=AnyInBundle) const</div><div class="ttdoc">Return true if this instruction could possibly modify memory.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l01069">MachineInstr.h:1069</a></div></div>
<div class="ttc" id="aScalarizeMaskedMemIntrin_8cpp_html_a8f3425131aae6ea2275a052284a7c2dc"><div class="ttname"><a href="ScalarizeMaskedMemIntrin_8cpp.html#a8f3425131aae6ea2275a052284a7c2dc">optimizeBlock</a></div><div class="ttdeci">static bool optimizeBlock(BasicBlock &amp;BB, bool &amp;ModifiedDT, const TargetTransformInfo &amp;TTI, const DataLayout &amp;DL, DomTreeUpdater *DTU)</div><div class="ttdef"><b>Definition:</b> <a href="ScalarizeMaskedMemIntrin_8cpp_source.html#l00909">ScalarizeMaskedMemIntrin.cpp:909</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a8a865c8b5d774ded0806c199df5b3c06"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a8a865c8b5d774ded0806c199df5b3c06">getMatchingNonSExtOpcode</a></div><div class="ttdeci">static unsigned getMatchingNonSExtOpcode(unsigned Opc, bool *IsValidLdStrOpc=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00248">AArch64LoadStoreOptimizer.cpp:248</a></div></div>
<div class="ttc" id="aDebugCounter_8h_html"><div class="ttname"><a href="DebugCounter_8h.html">DebugCounter.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1TargetStackID_html_a71392100eb15ba746b1f898986f5d8a5"><div class="ttname"><a href="namespacellvm_1_1TargetStackID.html#a71392100eb15ba746b1f898986f5d8a5">llvm::TargetStackID::Value</a></div><div class="ttdeci">Value</div><div class="ttdef"><b>Definition:</b> <a href="TargetFrameLowering_8h_source.html#l00027">TargetFrameLowering.h:27</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_ad7332117b148c3f93c1d7e58306ee748"><div class="ttname"><a href="classllvm_1_1Function.html#ad7332117b148c3f93c1d7e58306ee748">llvm::Function::needsUnwindTableEntry</a></div><div class="ttdeci">bool needsUnwindTableEntry() const</div><div class="ttdoc">True if this function needs an unwind table.</div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00619">Function.h:619</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a6d96c0781817d38b57f91432dd85d28f"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a6d96c0781817d38b57f91432dd85d28f">llvm::MachineInstrBuilder::setMemRefs</a></div><div class="ttdeci">const MachineInstrBuilder &amp; setMemRefs(ArrayRef&lt; MachineMemOperand * &gt; MMOs) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00208">MachineInstrBuilder.h:208</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCRegisterInfo_html_a97b138b96791a09a0d9b9c77f0fb6e85"><div class="ttname"><a href="classllvm_1_1MCRegisterInfo.html#a97b138b96791a09a0d9b9c77f0fb6e85">llvm::MCRegisterInfo::isSubRegister</a></div><div class="ttdeci">bool isSubRegister(MCRegister RegA, MCRegister RegB) const</div><div class="ttdoc">Returns true if RegB is a sub-register of RegA.</div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00560">MCRegisterInfo.h:560</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a9e9873c963a7609d913c3420a97c0595"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a9e9873c963a7609d913c3420a97c0595">isMatchingStore</a></div><div class="ttdeci">static unsigned isMatchingStore(MachineInstr &amp;LoadInst, MachineInstr &amp;StoreInst)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00378">AArch64LoadStoreOptimizer.cpp:378</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a10e708480cdc97c951368e06c13eac92"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a10e708480cdc97c951368e06c13eac92">llvm::MachineOperand::setImplicit</a></div><div class="ttdeci">void setImplicit(bool Val=true)</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00514">MachineOperand.h:514</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a76f61c6784df6dc8402a8b9011041926"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a76f61c6784df6dc8402a8b9011041926">llvm::MachineOperand::isImm</a></div><div class="ttdeci">bool isImm() const</div><div class="ttdoc">isImm - Tests if this is a MO_Immediate operand.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00331">MachineOperand.h:331</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1Hwreg_html_a6467ebe1e09a75203dd5f14bdfe21d11"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1Hwreg.html#a6467ebe1e09a75203dd5f14bdfe21d11">llvm::AMDGPU::Hwreg::Width</a></div><div class="ttdeci">Width</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00449">SIDefines.h:449</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_aa2d3a60e597b4a6cf24ee4ac12d2cdbf"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#aa2d3a60e597b4a6cf24ee4ac12d2cdbf">llvm::MachineOperand::isDebug</a></div><div class="ttdeci">bool isDebug() const</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8h_source.html#l00455">MachineOperand.h:455</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64TargetLowering_html_aa4502ed00aa357af2b923730584885d7"><div class="ttname"><a href="classllvm_1_1AArch64TargetLowering.html#aa4502ed00aa357af2b923730584885d7">llvm::AArch64TargetLowering::getRedZoneSize</a></div><div class="ttdeci">unsigned getRedZoneSize(const Function &amp;F) const</div><div class="ttdef"><b>Definition:</b> <a href="AArch64ISelLowering_8h_source.html#l00896">AArch64ISelLowering.h:896</a></div></div>
<div class="ttc" id="aAArch64Subtarget_8h_html"><div class="ttname"><a href="AArch64Subtarget_8h.html">AArch64Subtarget.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_a17e04afcf0c5efeb0eb6a9a45287b5e4"><div class="ttname"><a href="namespacellvm.html#a17e04afcf0c5efeb0eb6a9a45287b5e4">llvm::BuildMI</a></div><div class="ttdeci">MachineInstrBuilder BuildMI(MachineFunction &amp;MF, const MIMetadata &amp;MIMD, const MCInstrDesc &amp;MCID)</div><div class="ttdoc">Builder interface. Specify how to create the initial instruction itself.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00357">MachineInstrBuilder.h:357</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_ab2d91e7bec944efcbc39d8e30644f111"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#ab2d91e7bec944efcbc39d8e30644f111">llvm::MachineBasicBlock::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00309">MachineBasicBlock.h:309</a></div></div>
<div class="ttc" id="aMachineInstrBuilder_8h_html"><div class="ttname"><a href="MachineInstrBuilder_8h.html">MachineInstrBuilder.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBuilder_html_a860467662b17cef898ece774ab400235"><div class="ttname"><a href="classllvm_1_1MachineInstrBuilder.html#a860467662b17cef898ece774ab400235">llvm::MachineInstrBuilder::setMIFlags</a></div><div class="ttdeci">const MachineInstrBuilder &amp; setMIFlags(unsigned Flags) const</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00273">MachineInstrBuilder.h:273</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineOperand_html_a682ba82f42f7903d0000ffbb13ea3b57"><div class="ttname"><a href="classllvm_1_1MachineOperand.html#a682ba82f42f7903d0000ffbb13ea3b57">llvm::MachineOperand::setReg</a></div><div class="ttdeci">void setReg(Register Reg)</div><div class="ttdoc">Change the register this operand corresponds to.</div><div class="ttdef"><b>Definition:</b> <a href="MachineOperand_8cpp_source.html#l00061">MachineOperand.cpp:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1AAResultsWrapperPass_html"><div class="ttname"><a href="classllvm_1_1AAResultsWrapperPass.html">llvm::AAResultsWrapperPass</a></div><div class="ttdoc">A wrapper pass to provide the legacy pass manager access to a suitably prepared AAResults object.</div><div class="ttdef"><b>Definition:</b> <a href="AliasAnalysis_8h_source.html#l00933">AliasAnalysis.h:933</a></div></div>
<div class="ttc" id="aclassllvm_1_1iterator__range_html"><div class="ttname"><a href="classllvm_1_1iterator__range.html">llvm::iterator_range</a></div><div class="ttdoc">A range adaptor for a pair of iterators.</div><div class="ttdef"><b>Definition:</b> <a href="iterator__range_8h_source.html#l00030">iterator_range.h:30</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64InstrInfo_html_a3111bf1fd6e9282ec7a9b14b3a3cae3e"><div class="ttname"><a href="classllvm_1_1AArch64InstrInfo.html#a3111bf1fd6e9282ec7a9b14b3a3cae3e">llvm::AArch64InstrInfo::getLdStOffsetOp</a></div><div class="ttdeci">static const MachineOperand &amp; getLdStOffsetOp(const MachineInstr &amp;MI)</div><div class="ttdoc">Returns the the immediate offset operator of a load/store.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8cpp_source.html#l03221">AArch64InstrInfo.cpp:3221</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html">llvm::SmallVectorImpl&lt; MachineInstr * &gt;</a></div></div>
<div class="ttc" id="aMachineOperand_8h_html"><div class="ttname"><a href="MachineOperand_8h.html">MachineOperand.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_ab2147cc6810c7774110ebed17d4a2242"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#ab2147cc6810c7774110ebed17d4a2242">llvm::TargetRegisterInfo::getSubReg</a></div><div class="ttdeci">MCRegister getSubReg(MCRegister Reg, unsigned Idx) const</div><div class="ttdoc">Returns the physical register number of sub-register &quot;Index&quot; for physical register RegNo.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8h_source.html#l01149">TargetRegisterInfo.h:1149</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html">llvm::SmallPtrSetImpl</a></div><div class="ttdoc">A templated base class for SmallPtrSet which provides the typesafe interface that is common across al...</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00344">SmallPtrSet.h:344</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64InstrInfo_html_af269ff6efde917e353e6652a11e473ec"><div class="ttname"><a href="classllvm_1_1AArch64InstrInfo.html#af269ff6efde917e353e6652a11e473ec">llvm::AArch64InstrInfo::getMemScale</a></div><div class="ttdeci">static int getMemScale(unsigned Opc)</div><div class="ttdoc">Scaling factor for (scaled or unscaled) load or store.</div><div class="ttdef"><b>Definition:</b> <a href="AArch64InstrInfo_8cpp_source.html#l03091">AArch64InstrInfo.cpp:3091</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00308">Pass.h:308</a></div></div>
<div class="ttc" id="anamespacellvm_1_1omp_html_a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443"><div class="ttname"><a href="namespacellvm_1_1omp.html#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">llvm::omp::RTLDependInfoFields::Flags</a></div><div class="ttdeci">@ Flags</div></div>
<div class="ttc" id="aclassllvm_1_1MCRegisterInfo_html_a973016c591557c107018a0e6478b30a9"><div class="ttname"><a href="classllvm_1_1MCRegisterInfo.html#a973016c591557c107018a0e6478b30a9">llvm::MCRegisterInfo::isSuperOrSubRegisterEq</a></div><div class="ttdeci">bool isSuperOrSubRegisterEq(MCRegister RegA, MCRegister RegB) const</div><div class="ttdoc">Returns true if RegB is a super-register or sub-register of RegA or if RegB == RegA.</div><div class="ttdef"><b>Definition:</b> <a href="MCRegisterInfo_8h_source.html#l00580">MCRegisterInfo.h:580</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdoc">A debug info location.</div><div class="ttdef"><b>Definition:</b> <a href="DebugLoc_8h_source.html#l00033">DebugLoc.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetRegisterInfo_html_a17287afec9c4e572033dc4d1d6e11367"><div class="ttname"><a href="classllvm_1_1TargetRegisterInfo.html#a17287afec9c4e572033dc4d1d6e11367">llvm::TargetRegisterInfo::getMinimalPhysRegClass</a></div><div class="ttdeci">const TargetRegisterClass * getMinimalPhysRegClass(MCRegister Reg, MVT VT=MVT::Other) const</div><div class="ttdoc">Returns the Register Class of a physical register of the given type, picking the most sub register cl...</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8cpp_source.html#l00212">TargetRegisterInfo.cpp:212</a></div></div>
<div class="ttc" id="aclassllvm_1_1AArch64Subtarget_html"><div class="ttname"><a href="classllvm_1_1AArch64Subtarget.html">llvm::AArch64Subtarget</a></div><div class="ttdef"><b>Definition:</b> <a href="AArch64Subtarget_8h_source.html#l00038">AArch64Subtarget.h:38</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aMachineFunction_8h_html"><div class="ttname"><a href="MachineFunction_8h.html">MachineFunction.h</a></div></div>
<div class="ttc" id="anamespacellvm_html_af085ea923a328b9fa6a1975f1a4ff987"><div class="ttname"><a href="namespacellvm.html#af085ea923a328b9fa6a1975f1a4ff987">llvm::printReg</a></div><div class="ttdeci">Printable printReg(Register Reg, const TargetRegisterInfo *TRI=nullptr, unsigned SubIdx=0, const MachineRegisterInfo *MRI=nullptr)</div><div class="ttdoc">Prints virtual and physical registers with or without a TRI instance.</div><div class="ttdef"><b>Definition:</b> <a href="TargetRegisterInfo_8cpp_source.html#l00111">TargetRegisterInfo.cpp:111</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a2891bebbb2a99d3d169b71fd68a0cd87"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a2891bebbb2a99d3d169b71fd68a0cd87">getMatchingPairOpcode</a></div><div class="ttdeci">static unsigned getMatchingPairOpcode(unsigned Opc)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00318">AArch64LoadStoreOptimizer.cpp:318</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstrBundleIterator_html"><div class="ttname"><a href="classllvm_1_1MachineInstrBundleIterator.html">llvm::MachineInstrBundleIterator&lt; MachineInstr &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCAsmInfo_html_ac158349781823fe8ff9e02d3a3533d55"><div class="ttname"><a href="classllvm_1_1MCAsmInfo.html#ac158349781823fe8ff9e02d3a3533d55">llvm::MCAsmInfo::usesWindowsCFI</a></div><div class="ttdeci">bool usesWindowsCFI() const</div><div class="ttdef"><b>Definition:</b> <a href="MCAsmInfo_8h_source.html#l00797">MCAsmInfo.h:797</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RegState_html_aef4cc0c855dc833e2a9d58a50703320da72c17e2ff2d5af62a30e56ac152aa8d5"><div class="ttname"><a href="namespacellvm_1_1RegState.html#aef4cc0c855dc833e2a9d58a50703320da72c17e2ff2d5af62a30e56ac152aa8d5">llvm::RegState::Define</a></div><div class="ttdeci">@ Define</div><div class="ttdoc">Register definition.</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstrBuilder_8h_source.html#l00044">MachineInstrBuilder.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineInstr_html_aef0e7e42e45e15f86b2a122b56ab829c"><div class="ttname"><a href="classllvm_1_1MachineInstr.html#aef0e7e42e45e15f86b2a122b56ab829c">llvm::MachineInstr::operands</a></div><div class="ttdeci">iterator_range&lt; mop_iterator &gt; operands()</div><div class="ttdef"><b>Definition:</b> <a href="MachineInstr_8h_source.html#l00641">MachineInstr.h:641</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aTargetRegisterInfo_8h_html"><div class="ttname"><a href="TargetRegisterInfo_8h.html">TargetRegisterInfo.h</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_acbc921830578e2741be6549db716c0ce"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#acbc921830578e2741be6549db716c0ce">llvm::MachineBasicBlock::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l00311">MachineBasicBlock.h:311</a></div></div>
<div class="ttc" id="aAArch64LoadStoreOptimizer_8cpp_html_a478ccf0b258a018fdad2048e4fa42e8b"><div class="ttname"><a href="AArch64LoadStoreOptimizer_8cpp.html#a478ccf0b258a018fdad2048e4fa42e8b">getLdStRegOp</a></div><div class="ttdeci">static MachineOperand &amp; getLdStRegOp(MachineInstr &amp;MI, unsigned PairedRegOp=0)</div><div class="ttdef"><b>Definition:</b> <a href="AArch64LoadStoreOptimizer_8cpp_source.html#l00610">AArch64LoadStoreOptimizer.cpp:610</a></div></div>
<div class="ttc" id="anamespacellvm_html_a90f68a1fc5d44bb06164dc2188b8e486"><div class="ttname"><a href="namespacellvm.html#a90f68a1fc5d44bb06164dc2188b8e486">llvm::instructionsWithoutDebug</a></div><div class="ttdeci">auto instructionsWithoutDebug(IterT It, IterT End, bool SkipPseudoOp=true)</div><div class="ttdoc">Construct a range iterator which begins at It and moves forwards until End is reached,...</div><div class="ttdef"><b>Definition:</b> <a href="MachineBasicBlock_8h_source.html#l01337">MachineBasicBlock.h:1337</a></div></div>
<div class="ttc" id="aclassllvm_1_1MCRegister_html"><div class="ttname"><a href="classllvm_1_1MCRegister.html">llvm::MCRegister</a></div><div class="ttdoc">Wrapper class representing physical registers. Should be passed by value.</div><div class="ttdef"><b>Definition:</b> <a href="MCRegister_8h_source.html#l00024">MCRegister.h:24</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallPtrSetImpl_html_a6bc6fb89fe2e91c25559a8631f56e27e"><div class="ttname"><a href="classllvm_1_1SmallPtrSetImpl.html#a6bc6fb89fe2e91c25559a8631f56e27e">llvm::SmallPtrSetImpl::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(PtrType Ptr)</div><div class="ttdoc">Inserts Ptr if and only if there is no element in the container equal to Ptr.</div><div class="ttdef"><b>Definition:</b> <a href="SmallPtrSet_8h_source.html#l00365">SmallPtrSet.h:365</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 7 2023 10:08:54 for LLVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
